---
title: "Facility_B_Persistence"
author: "Cecil W. Barnett-Neefs"
date: "24/02/2021"
output: html_document
---

```{r setup}
#Packages
#Uncomment installation if missing packages
# install.packages('abind')
# install.packages('corrplot')
# install.packages('data.table')
# install.packages('DescTools')
# install.packages('dpylr')
# install.packages('epiR')
# install.packages('ff')
# install.packages('ffbase')
# install.packages('ggpattern)
# install.packages('ggplot2')
# install.packages('GGally')
# install.packages('ggpubr')
# install.packages('grid')
# install.packages('Hmisc')
# install.packages('FactoMineR')
# install.packages('factoextra')
# install.packages('matrixStats')
# install.packages('plotly')
# install.packages('plyr')
# install.packages('psych')
# install.packages('readxl')
# install.packages('reshape2')
# install.packages('sensitivity')
# install.packages('stringr')
# install.packages('survival')
# install.packages('vioplot')
library(abind)
library(corrplot)
library(data.table)
library(DescTools)
library(dplyr)
library(epiR)
library(FactoMineR)
library(factoextra)
library(ff)
library(ffbase)
library(ggpattern)
library(ggplot2)
library(GGally)
library(ggpubr)
library(grid)
library(Hmisc)
library(matrixStats)
library(plotly)
library(plyr)
library(psych)
library(readxl)
library(reshape2)
library(sensitivity)
library(stringr)
library(survival)
library(vioplot)

f_mode <- function(x) { 
  ta = table(x)
  tam = max(ta)
  #If all values appeared with the same frequency (i.e. no mod), return NA
  if (all(ta == tam)) {
    mod = NA
  }
  #Else if there is an "outlier", return that
  else {
    if(is.numeric(x)) {
      mod = as.numeric(names(ta)[ta == tam])
    }
    else {
      mod = names(ta)[ta == tam]
    }
  }
  return(mod)
}

vector_splitter <- function(x) {
  return(t(as.matrix(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(x)), "\\s+")[[1]])))))
}

# time_finder <- function(data,tick) {
#   return(data[max(which(data$total<=tick))+1,])
# }
time_finder <- function(data,tick) {
  print(typeof(data))
  return(data$total<=tick)
}

```

```{r import Baseline}
NL_table <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-24-08-27 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_Baseline_H_10E6_Maths-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table <- NL_table[NL_table$scenario==0,]

while (any(grepl('-', names(NL_table), fixed = TRUE))) {
  NL_table <- NL_table %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table), fixed = TRUE))) {
  NL_table <- NL_table %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table), fixed = TRUE))) {
  NL_table <- NL_table %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table), fixed = TRUE))) {
  NL_table <- NL_table %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table[ , ..list_columns]

NL_table[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table <- as.data.frame(NL_table)

NL_table[NL_table==-1] <- NA

NL_table <- subset(NL_table, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table)[names(NL_table)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table)[names(NL_table)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table$loading_w1wed_conc_list
vector <- vector[vector!='[]']
baseline_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_loading_w1wed_conc_list <- append(baseline_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_loading_w1wed_conc_matrix <- matrix(unlist(baseline_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
baseline_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_cleaning_w1wed_conc_list <- append(baseline_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_cleaning_w1wed_conc_matrix <- matrix(unlist(baseline_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# baseline_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   baseline_drying_w1wed_conc_list <- append(baseline_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
baseline_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_sorting_w1wed_conc_list <- append(baseline_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_sorting_w1wed_conc_matrix <- matrix(unlist(baseline_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
baseline_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_tray_packing_w1wed_conc_list <- append(baseline_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_tray_packing_w1wed_conc_matrix <- matrix(unlist(baseline_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table$reject_w1wed_conc_list
vector <- vector[vector!='[]']
baseline_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_reject_w1wed_conc_list <- append(baseline_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_reject_w1wed_conc_matrix <- matrix(unlist(baseline_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table$other_w1wed_conc_list
vector <- vector[vector!='[]']
baseline_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_other_w1wed_conc_list <- append(baseline_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_other_w1wed_conc_matrix <- matrix(unlist(baseline_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

baseline_loading_concs <- as.data.frame(baseline_loading_w1wed_conc_list)
baseline_loading_concs$area <- as.factor('loading')
baseline_loading_concs$scenario <- as.factor('Baseline')
baseline_loading_concs$water <- as.factor('Wet')
names(baseline_loading_concs) <- c('concentration','area','scenario','water')

baseline_cleaning_concs <- as.data.frame(baseline_cleaning_w1wed_conc_list)
baseline_cleaning_concs$area <- as.factor('cleaning')
baseline_cleaning_concs$scenario <- as.factor('Baseline')
baseline_cleaning_concs$water <- as.factor('Wet')
names(baseline_cleaning_concs) <- c('concentration','area','scenario','water')

baseline_sorting_concs <- as.data.frame(baseline_sorting_w1wed_conc_list)
baseline_sorting_concs$area <- as.factor('sorting')
baseline_sorting_concs$scenario <- as.factor('Baseline')
baseline_sorting_concs$water <- as.factor('Dry')
names(baseline_sorting_concs) <- c('concentration','area','scenario','water')

baseline_reject_concs <- as.data.frame(baseline_reject_w1wed_conc_list)
baseline_reject_concs$area <- as.factor('reject')
baseline_reject_concs$scenario <- as.factor('Baseline')
baseline_reject_concs$water <- as.factor('Dry')
names(baseline_reject_concs) <- c('concentration','area','scenario','water')

baseline_tray_packing_concs <- as.data.frame(baseline_tray_packing_w1wed_conc_list)
baseline_tray_packing_concs$area <- as.factor('tray packing')
baseline_tray_packing_concs$scenario <- as.factor('Baseline')
baseline_tray_packing_concs$water <- as.factor('Dry')
names(baseline_tray_packing_concs) <- c('concentration','area','scenario','water')

baseline_other_concs <- as.data.frame(baseline_other_w1wed_conc_list)
baseline_other_concs$area <- as.factor('other')
baseline_other_concs$scenario <- as.factor('Baseline')
baseline_other_concs$water <- as.factor('Dry')
names(baseline_other_concs) <- c('concentration','area','scenario','water')

baseline_w1wed_concs <- rbind(baseline_loading_concs,baseline_cleaning_concs,baseline_sorting_concs,baseline_tray_packing_concs,baseline_reject_concs,baseline_other_concs)

baseline_loading_prev <- as.data.frame(NL_table$loading_w1wed_prev[order(NL_table$local_seed)])
baseline_loading_prev$area <- as.factor('loading')
baseline_loading_prev$scenario <- as.factor('Baseline')
baseline_loading_prev$water <- as.factor('Wet')
names(baseline_loading_prev) <- c('prevalence','area','scenario','water')

baseline_cleaning_prev <- as.data.frame(NL_table$cleaning_w1wed_prev[order(NL_table$local_seed)])
baseline_cleaning_prev$area <- as.factor('cleaning')
baseline_cleaning_prev$scenario <- as.factor('Baseline')
baseline_cleaning_prev$water <- as.factor('Wet')
names(baseline_cleaning_prev) <- c('prevalence','area','scenario','water')

baseline_sorting_prev <- as.data.frame(NL_table$sorting_w1wed_prev[order(NL_table$local_seed)])
baseline_sorting_prev$area <- as.factor('sorting')
baseline_sorting_prev$scenario <- as.factor('Baseline')
baseline_sorting_prev$water <- as.factor('Dry')
names(baseline_sorting_prev) <- c('prevalence','area','scenario','water')

baseline_reject_prev <- as.data.frame(NL_table$reject_w1wed_prev[order(NL_table$local_seed)])
baseline_reject_prev$area <- as.factor('reject')
baseline_reject_prev$scenario <- as.factor('Baseline')
baseline_reject_prev$water <- as.factor('Dry')
names(baseline_reject_prev) <- c('prevalence','area','scenario','water')

baseline_tray_packing_prev <- as.data.frame(NL_table$tray_packing_w1wed_prev[order(NL_table$local_seed)])
baseline_tray_packing_prev$area <- as.factor('tray packing')
baseline_tray_packing_prev$scenario <- as.factor('Baseline')
baseline_tray_packing_prev$water <- as.factor('Dry')
names(baseline_tray_packing_prev) <- c('prevalence','area','scenario','water')

baseline_other_prev <- as.data.frame(NL_table$other_w1wed_prev[order(NL_table$local_seed)])
baseline_other_prev$area <- as.factor('other')
baseline_other_prev$scenario <- as.factor('Baseline')
baseline_other_prev$water <- as.factor('Dry')
names(baseline_other_prev) <- c('prevalence','area','scenario','water')

baseline_w1wed_prev <- rbind(baseline_loading_prev,baseline_cleaning_prev,baseline_sorting_prev,baseline_tray_packing_prev,baseline_reject_prev,baseline_other_prev)

baseline_w1wed_wet_prev <- as.data.frame(baseline_loading_prev$prevalence*21/100+baseline_cleaning_prev$prevalence*28/100)/49*100
baseline_w1wed_wet_prev$scenario <- as.factor('Baseline')
baseline_w1wed_wet_prev$water <- as.factor('Wet')
names(baseline_w1wed_wet_prev) <- c('prevalence','scenario','water')

baseline_w1wed_dry_prev <- as.data.frame(baseline_sorting_prev$prevalence*20/100+baseline_reject_prev$prevalence*23/100+baseline_tray_packing_prev$prevalence*123/100+baseline_other_prev$prevalence*10/100)/176*100
baseline_w1wed_dry_prev$scenario <- as.factor('Baseline')
baseline_w1wed_dry_prev$water <- as.factor('Dry')
names(baseline_w1wed_dry_prev) <- c('prevalence','scenario','water')

baseline_w1wed_recombined_prev <- rbind(baseline_w1wed_wet_prev, baseline_w1wed_dry_prev)

####W2Wed####
vector <- NL_table$loading_w2wed_conc_list
vector <- vector[vector!='[]']
baseline_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_loading_w2wed_conc_list <- append(baseline_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_loading_w2wed_conc_matrix <- matrix(unlist(baseline_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
baseline_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_cleaning_w2wed_conc_list <- append(baseline_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_cleaning_w2wed_conc_matrix <- matrix(unlist(baseline_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# baseline_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   baseline_drying_w2wed_conc_list <- append(baseline_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
baseline_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_sorting_w2wed_conc_list <- append(baseline_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_sorting_w2wed_conc_matrix <- matrix(unlist(baseline_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
baseline_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_tray_packing_w2wed_conc_list <- append(baseline_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_tray_packing_w2wed_conc_matrix <- matrix(unlist(baseline_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table$reject_w2wed_conc_list
vector <- vector[vector!='[]']
baseline_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_reject_w2wed_conc_list <- append(baseline_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_reject_w2wed_conc_matrix <- matrix(unlist(baseline_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table$other_w2wed_conc_list
vector <- vector[vector!='[]']
baseline_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_other_w2wed_conc_list <- append(baseline_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_other_w2wed_conc_matrix <- matrix(unlist(baseline_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

baseline_loading_concs <- as.data.frame(baseline_loading_w2wed_conc_list)
baseline_loading_concs$area <- as.factor('loading')
baseline_loading_concs$scenario <- as.factor('Baseline')
baseline_loading_concs$water <- as.factor('Wet')
names(baseline_loading_concs) <- c('concentration','area','scenario','water')

baseline_cleaning_concs <- as.data.frame(baseline_cleaning_w2wed_conc_list)
baseline_cleaning_concs$area <- as.factor('cleaning')
baseline_cleaning_concs$scenario <- as.factor('Baseline')
baseline_cleaning_concs$water <- as.factor('Wet')
names(baseline_cleaning_concs) <- c('concentration','area','scenario','water')

baseline_sorting_concs <- as.data.frame(baseline_sorting_w2wed_conc_list)
baseline_sorting_concs$area <- as.factor('sorting')
baseline_sorting_concs$scenario <- as.factor('Baseline')
baseline_sorting_concs$water <- as.factor('Dry')
names(baseline_sorting_concs) <- c('concentration','area','scenario','water')

baseline_reject_concs <- as.data.frame(baseline_reject_w2wed_conc_list)
baseline_reject_concs$area <- as.factor('reject')
baseline_reject_concs$scenario <- as.factor('Baseline')
baseline_reject_concs$water <- as.factor('Dry')
names(baseline_reject_concs) <- c('concentration','area','scenario','water')

baseline_tray_packing_concs <- as.data.frame(baseline_tray_packing_w2wed_conc_list)
baseline_tray_packing_concs$area <- as.factor('tray packing')
baseline_tray_packing_concs$scenario <- as.factor('Baseline')
baseline_tray_packing_concs$water <- as.factor('Dry')
names(baseline_tray_packing_concs) <- c('concentration','area','scenario','water')

baseline_other_concs <- as.data.frame(baseline_other_w2wed_conc_list)
baseline_other_concs$area <- as.factor('other')
baseline_other_concs$scenario <- as.factor('Baseline')
baseline_other_concs$water <- as.factor('Dry')
names(baseline_other_concs) <- c('concentration','area','scenario','water')

baseline_w2wed_concs <- rbind(baseline_loading_concs,baseline_cleaning_concs,baseline_sorting_concs,baseline_tray_packing_concs,baseline_reject_concs,baseline_other_concs)

baseline_loading_prev <- as.data.frame(NL_table$loading_w2wed_prev[order(NL_table$local_seed)])
baseline_loading_prev$area <- as.factor('loading')
baseline_loading_prev$scenario <- as.factor('Baseline')
baseline_loading_prev$water <- as.factor('Wet')
names(baseline_loading_prev) <- c('prevalence','area','scenario','water')

baseline_cleaning_prev <- as.data.frame(NL_table$cleaning_w2wed_prev[order(NL_table$local_seed)])
baseline_cleaning_prev$area <- as.factor('cleaning')
baseline_cleaning_prev$scenario <- as.factor('Baseline')
baseline_cleaning_prev$water <- as.factor('Wet')
names(baseline_cleaning_prev) <- c('prevalence','area','scenario','water')

baseline_sorting_prev <- as.data.frame(NL_table$sorting_w2wed_prev[order(NL_table$local_seed)])
baseline_sorting_prev$area <- as.factor('sorting')
baseline_sorting_prev$scenario <- as.factor('Baseline')
baseline_sorting_prev$water <- as.factor('Dry')
names(baseline_sorting_prev) <- c('prevalence','area','scenario','water')

baseline_reject_prev <- as.data.frame(NL_table$reject_w2wed_prev[order(NL_table$local_seed)])
baseline_reject_prev$area <- as.factor('reject')
baseline_reject_prev$scenario <- as.factor('Baseline')
baseline_reject_prev$water <- as.factor('Dry')
names(baseline_reject_prev) <- c('prevalence','area','scenario','water')

baseline_tray_packing_prev <- as.data.frame(NL_table$tray_packing_w2wed_prev[order(NL_table$local_seed)])
baseline_tray_packing_prev$area <- as.factor('tray packing')
baseline_tray_packing_prev$scenario <- as.factor('Baseline')
baseline_tray_packing_prev$water <- as.factor('Dry')
names(baseline_tray_packing_prev) <- c('prevalence','area','scenario','water')

baseline_other_prev <- as.data.frame(NL_table$other_w2wed_prev[order(NL_table$local_seed)])
baseline_other_prev$area <- as.factor('other')
baseline_other_prev$scenario <- as.factor('Baseline')
baseline_other_prev$water <- as.factor('Dry')
names(baseline_other_prev) <- c('prevalence','area','scenario','water')

baseline_w2wed_prev <- rbind(baseline_loading_prev,baseline_cleaning_prev,baseline_sorting_prev,baseline_tray_packing_prev,baseline_reject_prev,baseline_other_prev)

baseline_w2wed_wet_prev <- as.data.frame(baseline_loading_prev$prevalence*21/100+baseline_cleaning_prev$prevalence*28/100)/49*100
baseline_w2wed_wet_prev$scenario <- as.factor('Baseline')
baseline_w2wed_wet_prev$water <- as.factor('Wet')
names(baseline_w2wed_wet_prev) <- c('prevalence','scenario','water')

baseline_w2wed_dry_prev <- as.data.frame(baseline_sorting_prev$prevalence*20/100+baseline_reject_prev$prevalence*23/100+baseline_tray_packing_prev$prevalence*123/100+baseline_other_prev$prevalence*10/100)/176*100
baseline_w2wed_dry_prev$scenario <- as.factor('Baseline')
baseline_w2wed_dry_prev$water <- as.factor('Dry')
names(baseline_w2wed_dry_prev) <- c('prevalence','scenario','water')

baseline_w2wed_recombined_prev <- rbind(baseline_w2wed_wet_prev, baseline_w2wed_dry_prev)

####W3Wed####
vector <- NL_table$loading_w3wed_conc_list
vector <- vector[vector!='[]']
baseline_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_loading_w3wed_conc_list <- append(baseline_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_loading_w3wed_conc_matrix <- matrix(unlist(baseline_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
baseline_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_cleaning_w3wed_conc_list <- append(baseline_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_cleaning_w3wed_conc_matrix <- matrix(unlist(baseline_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# baseline_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   baseline_drying_w3wed_conc_list <- append(baseline_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
baseline_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_sorting_w3wed_conc_list <- append(baseline_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_sorting_w3wed_conc_matrix <- matrix(unlist(baseline_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
baseline_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_tray_packing_w3wed_conc_list <- append(baseline_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_tray_packing_w3wed_conc_matrix <- matrix(unlist(baseline_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table$reject_w3wed_conc_list
vector <- vector[vector!='[]']
baseline_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_reject_w3wed_conc_list <- append(baseline_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_reject_w3wed_conc_matrix <- matrix(unlist(baseline_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table$other_w3wed_conc_list
vector <- vector[vector!='[]']
baseline_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_other_w3wed_conc_list <- append(baseline_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_other_w3wed_conc_matrix <- matrix(unlist(baseline_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

baseline_loading_concs <- as.data.frame(baseline_loading_w3wed_conc_list)
baseline_loading_concs$area <- as.factor('loading')
baseline_loading_concs$scenario <- as.factor('Baseline')
baseline_loading_concs$water <- as.factor('Wet')
names(baseline_loading_concs) <- c('concentration','area','scenario','water')

baseline_cleaning_concs <- as.data.frame(baseline_cleaning_w3wed_conc_list)
baseline_cleaning_concs$area <- as.factor('cleaning')
baseline_cleaning_concs$scenario <- as.factor('Baseline')
baseline_cleaning_concs$water <- as.factor('Wet')
names(baseline_cleaning_concs) <- c('concentration','area','scenario','water')

baseline_sorting_concs <- as.data.frame(baseline_sorting_w3wed_conc_list)
baseline_sorting_concs$area <- as.factor('sorting')
baseline_sorting_concs$scenario <- as.factor('Baseline')
baseline_sorting_concs$water <- as.factor('Dry')
names(baseline_sorting_concs) <- c('concentration','area','scenario','water')

baseline_reject_concs <- as.data.frame(baseline_reject_w3wed_conc_list)
baseline_reject_concs$area <- as.factor('reject')
baseline_reject_concs$scenario <- as.factor('Baseline')
baseline_reject_concs$water <- as.factor('Dry')
names(baseline_reject_concs) <- c('concentration','area','scenario','water')

baseline_tray_packing_concs <- as.data.frame(baseline_tray_packing_w3wed_conc_list)
baseline_tray_packing_concs$area <- as.factor('tray packing')
baseline_tray_packing_concs$scenario <- as.factor('Baseline')
baseline_tray_packing_concs$water <- as.factor('Dry')
names(baseline_tray_packing_concs) <- c('concentration','area','scenario','water')

baseline_other_concs <- as.data.frame(baseline_other_w3wed_conc_list)
baseline_other_concs$area <- as.factor('other')
baseline_other_concs$scenario <- as.factor('Baseline')
baseline_other_concs$water <- as.factor('Dry')
names(baseline_other_concs) <- c('concentration','area','scenario','water')

baseline_w3wed_concs <- rbind(baseline_loading_concs,baseline_cleaning_concs,baseline_sorting_concs,baseline_tray_packing_concs,baseline_reject_concs,baseline_other_concs)

baseline_loading_prev <- as.data.frame(NL_table$loading_w3wed_prev[order(NL_table$local_seed)])
baseline_loading_prev$area <- as.factor('loading')
baseline_loading_prev$scenario <- as.factor('Baseline')
baseline_loading_prev$water <- as.factor('Wet')
names(baseline_loading_prev) <- c('prevalence','area','scenario','water')

baseline_cleaning_prev <- as.data.frame(NL_table$cleaning_w3wed_prev[order(NL_table$local_seed)])
baseline_cleaning_prev$area <- as.factor('cleaning')
baseline_cleaning_prev$scenario <- as.factor('Baseline')
baseline_cleaning_prev$water <- as.factor('Wet')
names(baseline_cleaning_prev) <- c('prevalence','area','scenario','water')

baseline_sorting_prev <- as.data.frame(NL_table$sorting_w3wed_prev[order(NL_table$local_seed)])
baseline_sorting_prev$area <- as.factor('sorting')
baseline_sorting_prev$scenario <- as.factor('Baseline')
baseline_sorting_prev$water <- as.factor('Dry')
names(baseline_sorting_prev) <- c('prevalence','area','scenario','water')

baseline_reject_prev <- as.data.frame(NL_table$reject_w3wed_prev[order(NL_table$local_seed)])
baseline_reject_prev$area <- as.factor('reject')
baseline_reject_prev$scenario <- as.factor('Baseline')
baseline_reject_prev$water <- as.factor('Dry')
names(baseline_reject_prev) <- c('prevalence','area','scenario','water')

baseline_tray_packing_prev <- as.data.frame(NL_table$tray_packing_w3wed_prev[order(NL_table$local_seed)])
baseline_tray_packing_prev$area <- as.factor('tray packing')
baseline_tray_packing_prev$scenario <- as.factor('Baseline')
baseline_tray_packing_prev$water <- as.factor('Dry')
names(baseline_tray_packing_prev) <- c('prevalence','area','scenario','water')

baseline_other_prev <- as.data.frame(NL_table$other_w3wed_prev[order(NL_table$local_seed)])
baseline_other_prev$area <- as.factor('other')
baseline_other_prev$scenario <- as.factor('Baseline')
baseline_other_prev$water <- as.factor('Dry')
names(baseline_other_prev) <- c('prevalence','area','scenario','water')

baseline_w3wed_prev <- rbind(baseline_loading_prev,baseline_cleaning_prev,baseline_sorting_prev,baseline_tray_packing_prev,baseline_reject_prev,baseline_other_prev)

baseline_w3wed_wet_prev <- as.data.frame(baseline_loading_prev$prevalence*21/100+baseline_cleaning_prev$prevalence*28/100)/49*100
baseline_w3wed_wet_prev$scenario <- as.factor('Baseline')
baseline_w3wed_wet_prev$water <- as.factor('Wet')
names(baseline_w3wed_wet_prev) <- c('prevalence','scenario','water')

baseline_w3wed_dry_prev <- as.data.frame(baseline_sorting_prev$prevalence*20/100+baseline_reject_prev$prevalence*23/100+baseline_tray_packing_prev$prevalence*123/100+baseline_other_prev$prevalence*10/100)/176*100
baseline_w3wed_dry_prev$scenario <- as.factor('Baseline')
baseline_w3wed_dry_prev$water <- as.factor('Dry')
names(baseline_w3wed_dry_prev) <- c('prevalence','scenario','water')

baseline_w3wed_recombined_prev <- rbind(baseline_w3wed_wet_prev, baseline_w3wed_dry_prev)

####W4Wed####
vector <- NL_table$loading_w4wed_conc_list
vector <- vector[vector!='[]']
baseline_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_loading_w4wed_conc_list <- append(baseline_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_loading_w4wed_conc_matrix <- matrix(unlist(baseline_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
baseline_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_cleaning_w4wed_conc_list <- append(baseline_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_cleaning_w4wed_conc_matrix <- matrix(unlist(baseline_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# baseline_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   baseline_drying_w4wed_conc_list <- append(baseline_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
baseline_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_sorting_w4wed_conc_list <- append(baseline_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_sorting_w4wed_conc_matrix <- matrix(unlist(baseline_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
baseline_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_tray_packing_w4wed_conc_list <- append(baseline_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_tray_packing_w4wed_conc_matrix <- matrix(unlist(baseline_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table$reject_w4wed_conc_list
vector <- vector[vector!='[]']
baseline_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_reject_w4wed_conc_list <- append(baseline_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_reject_w4wed_conc_matrix <- matrix(unlist(baseline_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table$other_w4wed_conc_list
vector <- vector[vector!='[]']
baseline_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_other_w4wed_conc_list <- append(baseline_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_other_w4wed_conc_matrix <- matrix(unlist(baseline_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

baseline_loading_concs <- as.data.frame(baseline_loading_w4wed_conc_list)
baseline_loading_concs$area <- as.factor('loading')
baseline_loading_concs$scenario <- as.factor('Baseline')
baseline_loading_concs$water <- as.factor('Wet')
names(baseline_loading_concs) <- c('concentration','area','scenario','water')

baseline_cleaning_concs <- as.data.frame(baseline_cleaning_w4wed_conc_list)
baseline_cleaning_concs$area <- as.factor('cleaning')
baseline_cleaning_concs$scenario <- as.factor('Baseline')
baseline_cleaning_concs$water <- as.factor('Wet')
names(baseline_cleaning_concs) <- c('concentration','area','scenario','water')

baseline_sorting_concs <- as.data.frame(baseline_sorting_w4wed_conc_list)
baseline_sorting_concs$area <- as.factor('sorting')
baseline_sorting_concs$scenario <- as.factor('Baseline')
baseline_sorting_concs$water <- as.factor('Dry')
names(baseline_sorting_concs) <- c('concentration','area','scenario','water')

baseline_reject_concs <- as.data.frame(baseline_reject_w4wed_conc_list)
baseline_reject_concs$area <- as.factor('reject')
baseline_reject_concs$scenario <- as.factor('Baseline')
baseline_reject_concs$water <- as.factor('Dry')
names(baseline_reject_concs) <- c('concentration','area','scenario','water')

baseline_tray_packing_concs <- as.data.frame(baseline_tray_packing_w4wed_conc_list)
baseline_tray_packing_concs$area <- as.factor('tray packing')
baseline_tray_packing_concs$scenario <- as.factor('Baseline')
baseline_tray_packing_concs$water <- as.factor('Dry')
names(baseline_tray_packing_concs) <- c('concentration','area','scenario','water')

baseline_other_concs <- as.data.frame(baseline_other_w4wed_conc_list)
baseline_other_concs$area <- as.factor('other')
baseline_other_concs$scenario <- as.factor('Baseline')
baseline_other_concs$water <- as.factor('Dry')
names(baseline_other_concs) <- c('concentration','area','scenario','water')

baseline_w4wed_concs <- rbind(baseline_loading_concs,baseline_cleaning_concs,baseline_sorting_concs,baseline_tray_packing_concs,baseline_reject_concs,baseline_other_concs)

baseline_loading_prev <- as.data.frame(NL_table$loading_w4wed_prev[order(NL_table$local_seed)])
baseline_loading_prev$area <- as.factor('loading')
baseline_loading_prev$scenario <- as.factor('Baseline')
baseline_loading_prev$water <- as.factor('Wet')
names(baseline_loading_prev) <- c('prevalence','area','scenario','water')

baseline_cleaning_prev <- as.data.frame(NL_table$cleaning_w4wed_prev[order(NL_table$local_seed)])
baseline_cleaning_prev$area <- as.factor('cleaning')
baseline_cleaning_prev$scenario <- as.factor('Baseline')
baseline_cleaning_prev$water <- as.factor('Wet')
names(baseline_cleaning_prev) <- c('prevalence','area','scenario','water')

baseline_sorting_prev <- as.data.frame(NL_table$sorting_w4wed_prev[order(NL_table$local_seed)])
baseline_sorting_prev$area <- as.factor('sorting')
baseline_sorting_prev$scenario <- as.factor('Baseline')
baseline_sorting_prev$water <- as.factor('Dry')
names(baseline_sorting_prev) <- c('prevalence','area','scenario','water')

baseline_reject_prev <- as.data.frame(NL_table$reject_w4wed_prev[order(NL_table$local_seed)])
baseline_reject_prev$area <- as.factor('reject')
baseline_reject_prev$scenario <- as.factor('Baseline')
baseline_reject_prev$water <- as.factor('Dry')
names(baseline_reject_prev) <- c('prevalence','area','scenario','water')

baseline_tray_packing_prev <- as.data.frame(NL_table$tray_packing_w4wed_prev[order(NL_table$local_seed)])
baseline_tray_packing_prev$area <- as.factor('tray packing')
baseline_tray_packing_prev$scenario <- as.factor('Baseline')
baseline_tray_packing_prev$water <- as.factor('Dry')
names(baseline_tray_packing_prev) <- c('prevalence','area','scenario','water')

baseline_other_prev <- as.data.frame(NL_table$other_w4wed_prev[order(NL_table$local_seed)])
baseline_other_prev$area <- as.factor('other')
baseline_other_prev$scenario <- as.factor('Baseline')
baseline_other_prev$water <- as.factor('Dry')
names(baseline_other_prev) <- c('prevalence','area','scenario','water')

baseline_w4wed_prev <- rbind(baseline_loading_prev,baseline_cleaning_prev,baseline_sorting_prev,baseline_tray_packing_prev,baseline_reject_prev,baseline_other_prev)

baseline_w4wed_wet_prev <- as.data.frame(baseline_loading_prev$prevalence*21/100+baseline_cleaning_prev$prevalence*28/100)/49*100
baseline_w4wed_wet_prev$scenario <- as.factor('Baseline')
baseline_w4wed_wet_prev$water <- as.factor('Wet')
names(baseline_w4wed_wet_prev) <- c('prevalence','scenario','water')

baseline_w4wed_dry_prev <- as.data.frame(baseline_sorting_prev$prevalence*20/100+baseline_reject_prev$prevalence*23/100+baseline_tray_packing_prev$prevalence*123/100+baseline_other_prev$prevalence*10/100)/176*100
baseline_w4wed_dry_prev$scenario <- as.factor('Baseline')
baseline_w4wed_dry_prev$water <- as.factor('Dry')
names(baseline_w4wed_dry_prev) <- c('prevalence','scenario','water')

baseline_w4wed_recombined_prev <- rbind(baseline_w4wed_wet_prev, baseline_w4wed_dry_prev)

####W5Wed####
vector <- NL_table$loading_w5wed_conc_list
vector <- vector[vector!='[]']
baseline_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_loading_w5wed_conc_list <- append(baseline_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_loading_w5wed_conc_matrix <- matrix(unlist(baseline_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
baseline_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_cleaning_w5wed_conc_list <- append(baseline_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_cleaning_w5wed_conc_matrix <- matrix(unlist(baseline_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# baseline_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   baseline_drying_w5wed_conc_list <- append(baseline_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
baseline_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_sorting_w5wed_conc_list <- append(baseline_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_sorting_w5wed_conc_matrix <- matrix(unlist(baseline_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
baseline_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_tray_packing_w5wed_conc_list <- append(baseline_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_tray_packing_w5wed_conc_matrix <- matrix(unlist(baseline_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table$reject_w5wed_conc_list
vector <- vector[vector!='[]']
baseline_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_reject_w5wed_conc_list <- append(baseline_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_reject_w5wed_conc_matrix <- matrix(unlist(baseline_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table$other_w5wed_conc_list
vector <- vector[vector!='[]']
baseline_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_other_w5wed_conc_list <- append(baseline_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_other_w5wed_conc_matrix <- matrix(unlist(baseline_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

baseline_loading_concs <- as.data.frame(baseline_loading_w5wed_conc_list)
baseline_loading_concs$area <- as.factor('loading')
baseline_loading_concs$scenario <- as.factor('Baseline')
baseline_loading_concs$water <- as.factor('Wet')
names(baseline_loading_concs) <- c('concentration','area','scenario','water')

baseline_cleaning_concs <- as.data.frame(baseline_cleaning_w5wed_conc_list)
baseline_cleaning_concs$area <- as.factor('cleaning')
baseline_cleaning_concs$scenario <- as.factor('Baseline')
baseline_cleaning_concs$water <- as.factor('Wet')
names(baseline_cleaning_concs) <- c('concentration','area','scenario','water')

baseline_sorting_concs <- as.data.frame(baseline_sorting_w5wed_conc_list)
baseline_sorting_concs$area <- as.factor('sorting')
baseline_sorting_concs$scenario <- as.factor('Baseline')
baseline_sorting_concs$water <- as.factor('Dry')
names(baseline_sorting_concs) <- c('concentration','area','scenario','water')

baseline_reject_concs <- as.data.frame(baseline_reject_w5wed_conc_list)
baseline_reject_concs$area <- as.factor('reject')
baseline_reject_concs$scenario <- as.factor('Baseline')
baseline_reject_concs$water <- as.factor('Dry')
names(baseline_reject_concs) <- c('concentration','area','scenario','water')

baseline_tray_packing_concs <- as.data.frame(baseline_tray_packing_w5wed_conc_list)
baseline_tray_packing_concs$area <- as.factor('tray packing')
baseline_tray_packing_concs$scenario <- as.factor('Baseline')
baseline_tray_packing_concs$water <- as.factor('Dry')
names(baseline_tray_packing_concs) <- c('concentration','area','scenario','water')

baseline_other_concs <- as.data.frame(baseline_other_w5wed_conc_list)
baseline_other_concs$area <- as.factor('other')
baseline_other_concs$scenario <- as.factor('Baseline')
baseline_other_concs$water <- as.factor('Dry')
names(baseline_other_concs) <- c('concentration','area','scenario','water')

baseline_w5wed_concs <- rbind(baseline_loading_concs,baseline_cleaning_concs,baseline_sorting_concs,baseline_tray_packing_concs,baseline_reject_concs,baseline_other_concs)

baseline_loading_prev <- as.data.frame(NL_table$loading_w5wed_prev[order(NL_table$local_seed)])
baseline_loading_prev$area <- as.factor('loading')
baseline_loading_prev$scenario <- as.factor('Baseline')
baseline_loading_prev$water <- as.factor('Wet')
names(baseline_loading_prev) <- c('prevalence','area','scenario','water')

baseline_cleaning_prev <- as.data.frame(NL_table$cleaning_w5wed_prev[order(NL_table$local_seed)])
baseline_cleaning_prev$area <- as.factor('cleaning')
baseline_cleaning_prev$scenario <- as.factor('Baseline')
baseline_cleaning_prev$water <- as.factor('Wet')
names(baseline_cleaning_prev) <- c('prevalence','area','scenario','water')

baseline_sorting_prev <- as.data.frame(NL_table$sorting_w5wed_prev[order(NL_table$local_seed)])
baseline_sorting_prev$area <- as.factor('sorting')
baseline_sorting_prev$scenario <- as.factor('Baseline')
baseline_sorting_prev$water <- as.factor('Dry')
names(baseline_sorting_prev) <- c('prevalence','area','scenario','water')

baseline_reject_prev <- as.data.frame(NL_table$reject_w5wed_prev[order(NL_table$local_seed)])
baseline_reject_prev$area <- as.factor('reject')
baseline_reject_prev$scenario <- as.factor('Baseline')
baseline_reject_prev$water <- as.factor('Dry')
names(baseline_reject_prev) <- c('prevalence','area','scenario','water')

baseline_tray_packing_prev <- as.data.frame(NL_table$tray_packing_w5wed_prev[order(NL_table$local_seed)])
baseline_tray_packing_prev$area <- as.factor('tray packing')
baseline_tray_packing_prev$scenario <- as.factor('Baseline')
baseline_tray_packing_prev$water <- as.factor('Dry')
names(baseline_tray_packing_prev) <- c('prevalence','area','scenario','water')

baseline_other_prev <- as.data.frame(NL_table$other_w5wed_prev[order(NL_table$local_seed)])
baseline_other_prev$area <- as.factor('other')
baseline_other_prev$scenario <- as.factor('Baseline')
baseline_other_prev$water <- as.factor('Dry')
names(baseline_other_prev) <- c('prevalence','area','scenario','water')

baseline_w5wed_prev <- rbind(baseline_loading_prev,baseline_cleaning_prev,baseline_sorting_prev,baseline_tray_packing_prev,baseline_reject_prev,baseline_other_prev)

baseline_w5wed_wet_prev <- as.data.frame(baseline_loading_prev$prevalence*21/100+baseline_cleaning_prev$prevalence*28/100)/49*100
baseline_w5wed_wet_prev$scenario <- as.factor('Baseline')
baseline_w5wed_wet_prev$water <- as.factor('Wet')
names(baseline_w5wed_wet_prev) <- c('prevalence','scenario','water')

baseline_w5wed_dry_prev <- as.data.frame(baseline_sorting_prev$prevalence*20/100+baseline_reject_prev$prevalence*23/100+baseline_tray_packing_prev$prevalence*123/100+baseline_other_prev$prevalence*10/100)/176*100
baseline_w5wed_dry_prev$scenario <- as.factor('Baseline')
baseline_w5wed_dry_prev$water <- as.factor('Dry')
names(baseline_w5wed_dry_prev) <- c('prevalence','scenario','water')

baseline_w5wed_recombined_prev <- rbind(baseline_w5wed_wet_prev, baseline_w5wed_dry_prev)

####W6Wed####
vector <- NL_table$loading_w6wed_conc_list
vector <- vector[vector!='[]']
baseline_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_loading_w6wed_conc_list <- append(baseline_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_loading_w6wed_conc_matrix <- matrix(unlist(baseline_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
baseline_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_cleaning_w6wed_conc_list <- append(baseline_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_cleaning_w6wed_conc_matrix <- matrix(unlist(baseline_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# baseline_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   baseline_drying_w6wed_conc_list <- append(baseline_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
baseline_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_sorting_w6wed_conc_list <- append(baseline_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_sorting_w6wed_conc_matrix <- matrix(unlist(baseline_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
baseline_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_tray_packing_w6wed_conc_list <- append(baseline_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_tray_packing_w6wed_conc_matrix <- matrix(unlist(baseline_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table$reject_w6wed_conc_list
vector <- vector[vector!='[]']
baseline_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_reject_w6wed_conc_list <- append(baseline_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_reject_w6wed_conc_matrix <- matrix(unlist(baseline_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table$other_w6wed_conc_list
vector <- vector[vector!='[]']
baseline_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_other_w6wed_conc_list <- append(baseline_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_other_w6wed_conc_matrix <- matrix(unlist(baseline_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

baseline_loading_concs <- as.data.frame(baseline_loading_w6wed_conc_list)
baseline_loading_concs$area <- as.factor('loading')
baseline_loading_concs$scenario <- as.factor('Baseline')
baseline_loading_concs$water <- as.factor('Wet')
names(baseline_loading_concs) <- c('concentration','area','scenario','water')

baseline_cleaning_concs <- as.data.frame(baseline_cleaning_w6wed_conc_list)
baseline_cleaning_concs$area <- as.factor('cleaning')
baseline_cleaning_concs$scenario <- as.factor('Baseline')
baseline_cleaning_concs$water <- as.factor('Wet')
names(baseline_cleaning_concs) <- c('concentration','area','scenario','water')

baseline_sorting_concs <- as.data.frame(baseline_sorting_w6wed_conc_list)
baseline_sorting_concs$area <- as.factor('sorting')
baseline_sorting_concs$scenario <- as.factor('Baseline')
baseline_sorting_concs$water <- as.factor('Dry')
names(baseline_sorting_concs) <- c('concentration','area','scenario','water')

baseline_reject_concs <- as.data.frame(baseline_reject_w6wed_conc_list)
baseline_reject_concs$area <- as.factor('reject')
baseline_reject_concs$scenario <- as.factor('Baseline')
baseline_reject_concs$water <- as.factor('Dry')
names(baseline_reject_concs) <- c('concentration','area','scenario','water')

baseline_tray_packing_concs <- as.data.frame(baseline_tray_packing_w6wed_conc_list)
baseline_tray_packing_concs$area <- as.factor('tray packing')
baseline_tray_packing_concs$scenario <- as.factor('Baseline')
baseline_tray_packing_concs$water <- as.factor('Dry')
names(baseline_tray_packing_concs) <- c('concentration','area','scenario','water')

baseline_other_concs <- as.data.frame(baseline_other_w6wed_conc_list)
baseline_other_concs$area <- as.factor('other')
baseline_other_concs$scenario <- as.factor('Baseline')
baseline_other_concs$water <- as.factor('Dry')
names(baseline_other_concs) <- c('concentration','area','scenario','water')

baseline_w6wed_concs <- rbind(baseline_loading_concs,baseline_cleaning_concs,baseline_sorting_concs,baseline_tray_packing_concs,baseline_reject_concs,baseline_other_concs)

baseline_loading_prev <- as.data.frame(NL_table$loading_w6wed_prev[order(NL_table$local_seed)])
baseline_loading_prev$area <- as.factor('loading')
baseline_loading_prev$scenario <- as.factor('Baseline')
baseline_loading_prev$water <- as.factor('Wet')
names(baseline_loading_prev) <- c('prevalence','area','scenario','water')

baseline_cleaning_prev <- as.data.frame(NL_table$cleaning_w6wed_prev[order(NL_table$local_seed)])
baseline_cleaning_prev$area <- as.factor('cleaning')
baseline_cleaning_prev$scenario <- as.factor('Baseline')
baseline_cleaning_prev$water <- as.factor('Wet')
names(baseline_cleaning_prev) <- c('prevalence','area','scenario','water')

baseline_sorting_prev <- as.data.frame(NL_table$sorting_w6wed_prev[order(NL_table$local_seed)])
baseline_sorting_prev$area <- as.factor('sorting')
baseline_sorting_prev$scenario <- as.factor('Baseline')
baseline_sorting_prev$water <- as.factor('Dry')
names(baseline_sorting_prev) <- c('prevalence','area','scenario','water')

baseline_reject_prev <- as.data.frame(NL_table$reject_w6wed_prev[order(NL_table$local_seed)])
baseline_reject_prev$area <- as.factor('reject')
baseline_reject_prev$scenario <- as.factor('Baseline')
baseline_reject_prev$water <- as.factor('Dry')
names(baseline_reject_prev) <- c('prevalence','area','scenario','water')

baseline_tray_packing_prev <- as.data.frame(NL_table$tray_packing_w6wed_prev[order(NL_table$local_seed)])
baseline_tray_packing_prev$area <- as.factor('tray packing')
baseline_tray_packing_prev$scenario <- as.factor('Baseline')
baseline_tray_packing_prev$water <- as.factor('Dry')
names(baseline_tray_packing_prev) <- c('prevalence','area','scenario','water')

baseline_other_prev <- as.data.frame(NL_table$other_w6wed_prev[order(NL_table$local_seed)])
baseline_other_prev$area <- as.factor('other')
baseline_other_prev$scenario <- as.factor('Baseline')
baseline_other_prev$water <- as.factor('Dry')
names(baseline_other_prev) <- c('prevalence','area','scenario','water')

baseline_w6wed_prev <- rbind(baseline_loading_prev,baseline_cleaning_prev,baseline_sorting_prev,baseline_tray_packing_prev,baseline_reject_prev,baseline_other_prev)

baseline_w6wed_wet_prev <- as.data.frame(baseline_loading_prev$prevalence*21/100+baseline_cleaning_prev$prevalence*28/100)/49*100
baseline_w6wed_wet_prev$scenario <- as.factor('Baseline')
baseline_w6wed_wet_prev$water <- as.factor('Wet')
names(baseline_w6wed_wet_prev) <- c('prevalence','scenario','water')

baseline_w6wed_dry_prev <- as.data.frame(baseline_sorting_prev$prevalence*20/100+baseline_reject_prev$prevalence*23/100+baseline_tray_packing_prev$prevalence*123/100+baseline_other_prev$prevalence*10/100)/176*100
baseline_w6wed_dry_prev$scenario <- as.factor('Baseline')
baseline_w6wed_dry_prev$water <- as.factor('Dry')
names(baseline_w6wed_dry_prev) <- c('prevalence','scenario','water')

baseline_w6wed_recombined_prev <- rbind(baseline_w6wed_wet_prev, baseline_w6wed_dry_prev)

####W7Wed####
vector <- NL_table$loading_w7wed_conc_list
vector <- vector[vector!='[]']
baseline_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_loading_w7wed_conc_list <- append(baseline_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_loading_w7wed_conc_matrix <- matrix(unlist(baseline_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
baseline_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_cleaning_w7wed_conc_list <- append(baseline_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_cleaning_w7wed_conc_matrix <- matrix(unlist(baseline_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# baseline_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   baseline_drying_w7wed_conc_list <- append(baseline_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
baseline_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_sorting_w7wed_conc_list <- append(baseline_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_sorting_w7wed_conc_matrix <- matrix(unlist(baseline_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
baseline_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_tray_packing_w7wed_conc_list <- append(baseline_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_tray_packing_w7wed_conc_matrix <- matrix(unlist(baseline_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table$reject_w7wed_conc_list
vector <- vector[vector!='[]']
baseline_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_reject_w7wed_conc_list <- append(baseline_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_reject_w7wed_conc_matrix <- matrix(unlist(baseline_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table$other_w7wed_conc_list
vector <- vector[vector!='[]']
baseline_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_other_w7wed_conc_list <- append(baseline_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_other_w7wed_conc_matrix <- matrix(unlist(baseline_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

baseline_loading_concs <- as.data.frame(baseline_loading_w7wed_conc_list)
baseline_loading_concs$area <- as.factor('loading')
baseline_loading_concs$scenario <- as.factor('Baseline')
baseline_loading_concs$water <- as.factor('Wet')
names(baseline_loading_concs) <- c('concentration','area','scenario','water')

baseline_cleaning_concs <- as.data.frame(baseline_cleaning_w7wed_conc_list)
baseline_cleaning_concs$area <- as.factor('cleaning')
baseline_cleaning_concs$scenario <- as.factor('Baseline')
baseline_cleaning_concs$water <- as.factor('Wet')
names(baseline_cleaning_concs) <- c('concentration','area','scenario','water')

baseline_sorting_concs <- as.data.frame(baseline_sorting_w7wed_conc_list)
baseline_sorting_concs$area <- as.factor('sorting')
baseline_sorting_concs$scenario <- as.factor('Baseline')
baseline_sorting_concs$water <- as.factor('Dry')
names(baseline_sorting_concs) <- c('concentration','area','scenario','water')

baseline_reject_concs <- as.data.frame(baseline_reject_w7wed_conc_list)
baseline_reject_concs$area <- as.factor('reject')
baseline_reject_concs$scenario <- as.factor('Baseline')
baseline_reject_concs$water <- as.factor('Dry')
names(baseline_reject_concs) <- c('concentration','area','scenario','water')

baseline_tray_packing_concs <- as.data.frame(baseline_tray_packing_w7wed_conc_list)
baseline_tray_packing_concs$area <- as.factor('tray packing')
baseline_tray_packing_concs$scenario <- as.factor('Baseline')
baseline_tray_packing_concs$water <- as.factor('Dry')
names(baseline_tray_packing_concs) <- c('concentration','area','scenario','water')

baseline_other_concs <- as.data.frame(baseline_other_w7wed_conc_list)
baseline_other_concs$area <- as.factor('other')
baseline_other_concs$scenario <- as.factor('Baseline')
baseline_other_concs$water <- as.factor('Dry')
names(baseline_other_concs) <- c('concentration','area','scenario','water')

baseline_w7wed_concs <- rbind(baseline_loading_concs,baseline_cleaning_concs,baseline_sorting_concs,baseline_tray_packing_concs,baseline_reject_concs,baseline_other_concs)

baseline_loading_prev <- as.data.frame(NL_table$loading_w7wed_prev[order(NL_table$local_seed)])
baseline_loading_prev$area <- as.factor('loading')
baseline_loading_prev$scenario <- as.factor('Baseline')
baseline_loading_prev$water <- as.factor('Wet')
names(baseline_loading_prev) <- c('prevalence','area','scenario','water')

baseline_cleaning_prev <- as.data.frame(NL_table$cleaning_w7wed_prev[order(NL_table$local_seed)])
baseline_cleaning_prev$area <- as.factor('cleaning')
baseline_cleaning_prev$scenario <- as.factor('Baseline')
baseline_cleaning_prev$water <- as.factor('Wet')
names(baseline_cleaning_prev) <- c('prevalence','area','scenario','water')

baseline_sorting_prev <- as.data.frame(NL_table$sorting_w7wed_prev[order(NL_table$local_seed)])
baseline_sorting_prev$area <- as.factor('sorting')
baseline_sorting_prev$scenario <- as.factor('Baseline')
baseline_sorting_prev$water <- as.factor('Dry')
names(baseline_sorting_prev) <- c('prevalence','area','scenario','water')

baseline_reject_prev <- as.data.frame(NL_table$reject_w7wed_prev[order(NL_table$local_seed)])
baseline_reject_prev$area <- as.factor('reject')
baseline_reject_prev$scenario <- as.factor('Baseline')
baseline_reject_prev$water <- as.factor('Dry')
names(baseline_reject_prev) <- c('prevalence','area','scenario','water')

baseline_tray_packing_prev <- as.data.frame(NL_table$tray_packing_w7wed_prev[order(NL_table$local_seed)])
baseline_tray_packing_prev$area <- as.factor('tray packing')
baseline_tray_packing_prev$scenario <- as.factor('Baseline')
baseline_tray_packing_prev$water <- as.factor('Dry')
names(baseline_tray_packing_prev) <- c('prevalence','area','scenario','water')

baseline_other_prev <- as.data.frame(NL_table$other_w7wed_prev[order(NL_table$local_seed)])
baseline_other_prev$area <- as.factor('other')
baseline_other_prev$scenario <- as.factor('Baseline')
baseline_other_prev$water <- as.factor('Dry')
names(baseline_other_prev) <- c('prevalence','area','scenario','water')

baseline_w7wed_prev <- rbind(baseline_loading_prev,baseline_cleaning_prev,baseline_sorting_prev,baseline_tray_packing_prev,baseline_reject_prev,baseline_other_prev)

baseline_w7wed_wet_prev <- as.data.frame(baseline_loading_prev$prevalence*21/100+baseline_cleaning_prev$prevalence*28/100)/49*100
baseline_w7wed_wet_prev$scenario <- as.factor('Baseline')
baseline_w7wed_wet_prev$water <- as.factor('Wet')
names(baseline_w7wed_wet_prev) <- c('prevalence','scenario','water')

baseline_w7wed_dry_prev <- as.data.frame(baseline_sorting_prev$prevalence*20/100+baseline_reject_prev$prevalence*23/100+baseline_tray_packing_prev$prevalence*123/100+baseline_other_prev$prevalence*10/100)/176*100
baseline_w7wed_dry_prev$scenario <- as.factor('Baseline')
baseline_w7wed_dry_prev$water <- as.factor('Dry')
names(baseline_w7wed_dry_prev) <- c('prevalence','scenario','water')

baseline_w7wed_recombined_prev <- rbind(baseline_w7wed_wet_prev, baseline_w7wed_dry_prev)

####W8Wed####
vector <- NL_table$loading_w8wed_conc_list
vector <- vector[vector!='[]']
baseline_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_loading_w8wed_conc_list <- append(baseline_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_loading_w8wed_conc_matrix <- matrix(unlist(baseline_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
baseline_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_cleaning_w8wed_conc_list <- append(baseline_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_cleaning_w8wed_conc_matrix <- matrix(unlist(baseline_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# baseline_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   baseline_drying_w8wed_conc_list <- append(baseline_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
baseline_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_sorting_w8wed_conc_list <- append(baseline_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_sorting_w8wed_conc_matrix <- matrix(unlist(baseline_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
baseline_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_tray_packing_w8wed_conc_list <- append(baseline_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_tray_packing_w8wed_conc_matrix <- matrix(unlist(baseline_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table$reject_w8wed_conc_list
vector <- vector[vector!='[]']
baseline_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_reject_w8wed_conc_list <- append(baseline_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_reject_w8wed_conc_matrix <- matrix(unlist(baseline_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table$other_w8wed_conc_list
vector <- vector[vector!='[]']
baseline_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  baseline_other_w8wed_conc_list <- append(baseline_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
baseline_other_w8wed_conc_matrix <- matrix(unlist(baseline_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

baseline_loading_concs <- as.data.frame(baseline_loading_w8wed_conc_list)
baseline_loading_concs$area <- as.factor('loading')
baseline_loading_concs$scenario <- as.factor('Baseline')
baseline_loading_concs$water <- as.factor('Wet')
names(baseline_loading_concs) <- c('concentration','area','scenario','water')

baseline_cleaning_concs <- as.data.frame(baseline_cleaning_w8wed_conc_list)
baseline_cleaning_concs$area <- as.factor('cleaning')
baseline_cleaning_concs$scenario <- as.factor('Baseline')
baseline_cleaning_concs$water <- as.factor('Wet')
names(baseline_cleaning_concs) <- c('concentration','area','scenario','water')

baseline_sorting_concs <- as.data.frame(baseline_sorting_w8wed_conc_list)
baseline_sorting_concs$area <- as.factor('sorting')
baseline_sorting_concs$scenario <- as.factor('Baseline')
baseline_sorting_concs$water <- as.factor('Dry')
names(baseline_sorting_concs) <- c('concentration','area','scenario','water')

baseline_reject_concs <- as.data.frame(baseline_reject_w8wed_conc_list)
baseline_reject_concs$area <- as.factor('reject')
baseline_reject_concs$scenario <- as.factor('Baseline')
baseline_reject_concs$water <- as.factor('Dry')
names(baseline_reject_concs) <- c('concentration','area','scenario','water')

baseline_tray_packing_concs <- as.data.frame(baseline_tray_packing_w8wed_conc_list)
baseline_tray_packing_concs$area <- as.factor('tray packing')
baseline_tray_packing_concs$scenario <- as.factor('Baseline')
baseline_tray_packing_concs$water <- as.factor('Dry')
names(baseline_tray_packing_concs) <- c('concentration','area','scenario','water')

baseline_other_concs <- as.data.frame(baseline_other_w8wed_conc_list)
baseline_other_concs$area <- as.factor('other')
baseline_other_concs$scenario <- as.factor('Baseline')
baseline_other_concs$water <- as.factor('Dry')
names(baseline_other_concs) <- c('concentration','area','scenario','water')

baseline_w8wed_concs <- rbind(baseline_loading_concs,baseline_cleaning_concs,baseline_sorting_concs,baseline_tray_packing_concs,baseline_reject_concs,baseline_other_concs)

baseline_w1wed_concs$week <- as.factor(1)
baseline_w2wed_concs$week <- as.factor(2)
baseline_w3wed_concs$week <- as.factor(3)
baseline_w4wed_concs$week <- as.factor(4)
baseline_w5wed_concs$week <- as.factor(5)
baseline_w6wed_concs$week <- as.factor(6)
baseline_w7wed_concs$week <- as.factor(7)
baseline_w8wed_concs$week <- as.factor(8)
baseline_allwed_concs <- rbind(baseline_w1wed_concs,baseline_w2wed_concs,baseline_w3wed_concs,baseline_w4wed_concs,baseline_w5wed_concs,baseline_w6wed_concs,baseline_w7wed_concs,baseline_w8wed_concs)

baseline_loading_prev <- as.data.frame(NL_table$loading_w8wed_prev[order(NL_table$local_seed)])
baseline_loading_prev$area <- as.factor('loading')
baseline_loading_prev$scenario <- as.factor('Baseline')
baseline_loading_prev$water <- as.factor('Wet')
names(baseline_loading_prev) <- c('prevalence','area','scenario','water')

baseline_cleaning_prev <- as.data.frame(NL_table$cleaning_w8wed_prev[order(NL_table$local_seed)])
baseline_cleaning_prev$area <- as.factor('cleaning')
baseline_cleaning_prev$scenario <- as.factor('Baseline')
baseline_cleaning_prev$water <- as.factor('Wet')
names(baseline_cleaning_prev) <- c('prevalence','area','scenario','water')

baseline_sorting_prev <- as.data.frame(NL_table$sorting_w8wed_prev[order(NL_table$local_seed)])
baseline_sorting_prev$area <- as.factor('sorting')
baseline_sorting_prev$scenario <- as.factor('Baseline')
baseline_sorting_prev$water <- as.factor('Dry')
names(baseline_sorting_prev) <- c('prevalence','area','scenario','water')

baseline_reject_prev <- as.data.frame(NL_table$reject_w8wed_prev[order(NL_table$local_seed)])
baseline_reject_prev$area <- as.factor('reject')
baseline_reject_prev$scenario <- as.factor('Baseline')
baseline_reject_prev$water <- as.factor('Dry')
names(baseline_reject_prev) <- c('prevalence','area','scenario','water')

baseline_tray_packing_prev <- as.data.frame(NL_table$tray_packing_w8wed_prev[order(NL_table$local_seed)])
baseline_tray_packing_prev$area <- as.factor('tray packing')
baseline_tray_packing_prev$scenario <- as.factor('Baseline')
baseline_tray_packing_prev$water <- as.factor('Dry')
names(baseline_tray_packing_prev) <- c('prevalence','area','scenario','water')

baseline_other_prev <- as.data.frame(NL_table$other_w8wed_prev[order(NL_table$local_seed)])
baseline_other_prev$area <- as.factor('other')
baseline_other_prev$scenario <- as.factor('Baseline')
baseline_other_prev$water <- as.factor('Dry')
names(baseline_other_prev) <- c('prevalence','area','scenario','water')

baseline_w8wed_prev <- rbind(baseline_loading_prev,baseline_cleaning_prev,baseline_sorting_prev,baseline_tray_packing_prev,baseline_reject_prev,baseline_other_prev)

baseline_w8wed_wet_prev <- as.data.frame(baseline_loading_prev$prevalence*21/100+baseline_cleaning_prev$prevalence*28/100)/49*100
baseline_w8wed_wet_prev$scenario <- as.factor('Baseline')
baseline_w8wed_wet_prev$water <- as.factor('Wet')
names(baseline_w8wed_wet_prev) <- c('prevalence','scenario','water')

baseline_w8wed_dry_prev <- as.data.frame(baseline_sorting_prev$prevalence*20/100+baseline_reject_prev$prevalence*23/100+baseline_tray_packing_prev$prevalence*123/100+baseline_other_prev$prevalence*10/100)/176*100
baseline_w8wed_dry_prev$scenario <- as.factor('Baseline')
baseline_w8wed_dry_prev$water <- as.factor('Dry')
names(baseline_w8wed_dry_prev) <- c('prevalence','scenario','water')

baseline_w8wed_recombined_prev <- rbind(baseline_w8wed_wet_prev, baseline_w8wed_dry_prev)

baseline_w1wed_prev$week <- as.factor(1)
baseline_w2wed_prev$week <- as.factor(2)
baseline_w3wed_prev$week <- as.factor(3)
baseline_w4wed_prev$week <- as.factor(4)
baseline_w5wed_prev$week <- as.factor(5)
baseline_w6wed_prev$week <- as.factor(6)
baseline_w7wed_prev$week <- as.factor(7)
baseline_w8wed_prev$week <- as.factor(8)

baseline_w1wed_recombined_prev$week <- as.factor(1)
baseline_w2wed_recombined_prev$week <- as.factor(2)
baseline_w3wed_recombined_prev$week <- as.factor(3)
baseline_w4wed_recombined_prev$week <- as.factor(4)
baseline_w5wed_recombined_prev$week <- as.factor(5)
baseline_w6wed_recombined_prev$week <- as.factor(6)
baseline_w7wed_recombined_prev$week <- as.factor(7)
baseline_w8wed_recombined_prev$week <- as.factor(8)
baseline_allwed_prev <- rbind(baseline_w1wed_recombined_prev,baseline_w2wed_recombined_prev,baseline_w3wed_recombined_prev,baseline_w4wed_recombined_prev,baseline_w5wed_recombined_prev,baseline_w6wed_recombined_prev,baseline_w7wed_recombined_prev,baseline_w8wed_recombined_prev)

vector <- NL_table$lifetime_conc_list[order(NL_table$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

baseline_w1wed_recombined_prev$week <- as.factor(1)
baseline_w2wed_recombined_prev$week <- as.factor(2)
baseline_w3wed_recombined_prev$week <- as.factor(3)
baseline_w4wed_recombined_prev$week <- as.factor(4)
baseline_w5wed_recombined_prev$week <- as.factor(5)
baseline_w6wed_recombined_prev$week <- as.factor(6)
baseline_w7wed_recombined_prev$week <- as.factor(7)
baseline_w8wed_recombined_prev$week <- as.factor(8)
baseline_allwed_prev <- rbind(baseline_w1wed_recombined_prev,baseline_w2wed_recombined_prev,baseline_w3wed_recombined_prev,baseline_w4wed_recombined_prev,baseline_w5wed_recombined_prev,baseline_w6wed_recombined_prev,baseline_w7wed_recombined_prev,baseline_w8wed_recombined_prev)

Facility_B_baseline_agents_melted <- melt(mdarray)
colnames(Facility_B_baseline_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_baseline_agents_melted$agent <- Facility_B_baseline_agents_melted$agent-1
Facility_B_baseline_agents_melted$logical <- Facility_B_baseline_agents_melted$value>0
Facility_B_baseline_agents_melted$binary <- as.numeric(Facility_B_baseline_agents_melted$logical)
Facility_B_baseline_agents_melted$log10value <- log10(Facility_B_baseline_agents_melted$value)
Facility_B_baseline_agents_melted$log10value[is.infinite(Facility_B_baseline_agents_melted$log10value)] <- 0

agent <- Facility_B_baseline_agents_melted$agent
iteration <- Facility_B_baseline_agents_melted$iteration
tick <- Facility_B_baseline_agents_melted$tick
rle_matrix <- tapply(Facility_B_baseline_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_baseline_mean_value_matrix <- tapply(Facility_B_baseline_agents_melted$value, list(agent, tick), mean)
Facility_B_baseline_median_value_matrix <- tapply(Facility_B_baseline_agents_melted$value, list(agent, tick), median)
x <- Facility_B_baseline_agents_melted
x$value[x$value==0] <- NA
Facility_B_baseline_pos_median_value_matrix <- tapply(x$value, list(agent, tick), median, na.rm=TRUE)
Facility_B_baseline_prob_value_matrix <- tapply(Facility_B_baseline_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

#Maximum sensitivity####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_baseline <- durations

agents_list_baseline <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_baseline <- agents_list_baseline[,c("V1","V7","V8","V9")]
colnames(agents_list_baseline) <- c("name","sanitation_status","schedule","area")
#Time to persistence
agents_list_baseline$time_to_persistence <- rep((168*2),225)
agents_list_baseline$time_to_persistence[agents_list_baseline$schedule=="daily"] <- (24*2)

persistent_short_durations_list_baseline <- data.frame()
persistent_long_durations_list_baseline <- data.frame()
persistent_uncleanable_durations_list_baseline <- data.frame()
transient_short_durations_list_baseline <- data.frame()
transient_long_durations_list_baseline <- data.frame()
transient_uncleanable_durations_list_baseline <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_baseline$min_duration[agent] <- ifelse(length(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent])==0,NA,min(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_baseline$mean_duration[agent] <- ifelse(length(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent])==0,NA,mean(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_baseline$median_duration[agent] <- ifelse(length(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent])==0,NA,median(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_baseline$max_duration[agent] <- ifelse(length(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent])==0,NA,max(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_baseline$contamination_events[agent] <- sum(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_baseline$times_persistent[agent] <- sum(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent]>agents_list_baseline$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_baseline$q1_duration[agent] <- quantile(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_baseline$q3_duration[agent] <- quantile(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_baseline$min_persistent_duration[agent] <- ifelse((length(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent])==0) || (agents_list_baseline$times_persistent[agent]==0),NA,min(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent & Facility_B_durations_baseline$duration>=agents_list_baseline$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_baseline$mean_persistent_duration[agent] <- ifelse((length(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent])==0) || (agents_list_baseline$times_persistent[agent]==0),NA,mean(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent & Facility_B_durations_baseline$duration>=agents_list_baseline$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_baseline$median_persistent_duration[agent] <- ifelse((length(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent])==0) || (agents_list_baseline$times_persistent[agent]==0),NA,median(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent & Facility_B_durations_baseline$duration>=agents_list_baseline$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_baseline$max_persistent_duration[agent] <- ifelse((length(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent])==0) || (agents_list_baseline$times_persistent[agent]==0),NA,max(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent & Facility_B_durations_baseline$duration>=agents_list_baseline$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_baseline$q1_persistent_duration[agent] <- ifelse((length(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent])==0) || (agents_list_baseline$times_persistent[agent]==0),NA,quantile(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent & Facility_B_durations_baseline$duration>=agents_list_baseline$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_baseline$q3_persistent_duration[agent] <- ifelse((length(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent])==0) || (agents_list_baseline$times_persistent[agent]==0),NA,quantile(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent & Facility_B_durations_baseline$duration>=agents_list_baseline$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations
  x <- Facility_B_durations_baseline[which(Facility_B_durations_baseline$agent==agent & Facility_B_durations_baseline$duration>agents_list_baseline$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean
  agents_list_baseline$mean_times_persistent[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_baseline$mean_times_persistent[which(is.na(agents_list_baseline$mean_times_persistent))] <- 0
  #Division by total number of iterations in simulation
  agents_list_baseline$balanced_times_persistent[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_baseline$duration[Facility_B_durations_baseline$agent==agent])!=0) || (agents_list_baseline$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_baseline$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_baseline <- rbind(
        persistent_short_durations_list_baseline,
        Facility_B_durations_baseline[Facility_B_durations_baseline$agent==agent & Facility_B_durations_baseline$duration>agents_list_baseline$time_to_persistence[agent],]
      )
    } else if(agents_list_baseline$time_to_persistence[agent]==336 && agents_list_baseline$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_baseline <- rbind(
        persistent_long_durations_list_baseline,
        Facility_B_durations_baseline[Facility_B_durations_baseline$agent==agent & Facility_B_durations_baseline$duration>agents_list_baseline$time_to_persistence[agent],]
      )
    } else if(agents_list_baseline$time_to_persistence[agent]==336 && agents_list_baseline$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_baseline <- rbind(
        persistent_uncleanable_durations_list_baseline,
        Facility_B_durations_baseline[Facility_B_durations_baseline$agent==agent & Facility_B_durations_baseline$duration>agents_list_baseline$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_baseline$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_baseline <- rbind(
      transient_short_durations_list_baseline,
      Facility_B_durations_baseline[Facility_B_durations_baseline$agent==agent & Facility_B_durations_baseline$duration<=agents_list_baseline$time_to_persistence[agent],]
    )
  } else if(agents_list_baseline$time_to_persistence[agent]==336 && agents_list_baseline$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_baseline <- rbind(
      transient_long_durations_list_baseline,
      Facility_B_durations_baseline[Facility_B_durations_baseline$agent==agent & Facility_B_durations_baseline$duration<=agents_list_baseline$time_to_persistence[agent],]
    )
  } else if(agents_list_baseline$time_to_persistence[agent]==336 && agents_list_baseline$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_baseline <- rbind(
      transient_uncleanable_durations_list_baseline,
      Facility_B_durations_baseline[Facility_B_durations_baseline$agent==agent & Facility_B_durations_baseline$duration<=agents_list_baseline$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

#10 cells minimum####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>9)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_baseline_10min <- durations

persistent_short_durations_list_baseline_10min <- data.frame()
persistent_long_durations_list_baseline_10min <- data.frame()
persistent_uncleanable_durations_list_baseline_10min <- data.frame()
transient_short_durations_list_baseline_10min <- data.frame()
transient_long_durations_list_baseline_10min <- data.frame()
transient_uncleanable_durations_list_baseline_10min <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_baseline$min_duration_10min[agent] <- ifelse(length(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent])==0,NA,min(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_baseline$mean_duration_10min[agent] <- ifelse(length(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent])==0,NA,mean(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_baseline$median_duration_10min[agent] <- ifelse(length(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent])==0,NA,median(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_baseline$max_duration_10min[agent] <- ifelse(length(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent])==0,NA,max(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_baseline$contamination_events_10min[agent] <- sum(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_baseline$times_persistent_10min[agent] <- sum(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent]>agents_list_baseline$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_baseline$q1_duration_10min[agent] <- quantile(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_baseline$q3_duration_10min[agent] <- quantile(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_baseline$min_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent])==0) || (agents_list_baseline$times_persistent_10min[agent]==0),NA,min(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent & Facility_B_durations_baseline_10min$duration>=agents_list_baseline$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_baseline$mean_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent])==0) || (agents_list_baseline$times_persistent_10min[agent]==0),NA,mean(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent & Facility_B_durations_baseline_10min$duration>=agents_list_baseline$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_baseline$median_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent])==0) || (agents_list_baseline$times_persistent_10min[agent]==0),NA,median(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent & Facility_B_durations_baseline_10min$duration>=agents_list_baseline$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_baseline$max_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent])==0) || (agents_list_baseline$times_persistent_10min[agent]==0),NA,max(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent & Facility_B_durations_baseline_10min$duration>=agents_list_baseline$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_baseline$q1_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent])==0) || (agents_list_baseline$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent & Facility_B_durations_baseline_10min$duration>=agents_list_baseline$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_baseline$q3_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent])==0) || (agents_list_baseline$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent & Facility_B_durations_baseline_10min$duration>=agents_list_baseline$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations (Does not account for iterations with 0 events)
  x <- Facility_B_durations_baseline_10min[which(Facility_B_durations_baseline_10min$agent==agent & Facility_B_durations_baseline_10min$duration>agents_list_baseline$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean (Does account for iterations with 0 events)
  agents_list_baseline$mean_times_persistent_10min[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_baseline$mean_times_persistent_10min[which(is.na(agents_list_baseline$mean_times_persistent_10min))] <- 0
  #Division by total number of iterations in simulation
  agents_list_baseline$balanced_times_persistent_10min[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_baseline_10min$duration[Facility_B_durations_baseline_10min$agent==agent])!=0) || (agents_list_baseline$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_baseline$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_baseline_10min <- rbind(
        persistent_short_durations_list_baseline_10min,
        Facility_B_durations_baseline_10min[Facility_B_durations_baseline_10min$agent==agent & Facility_B_durations_baseline_10min$duration>agents_list_baseline$time_to_persistence[agent],]
      )
    } else if(agents_list_baseline$time_to_persistence[agent]==336 && agents_list_baseline$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_baseline_10min <- rbind(
        persistent_long_durations_list_baseline_10min,
        Facility_B_durations_baseline_10min[Facility_B_durations_baseline_10min$agent==agent & Facility_B_durations_baseline_10min$duration>agents_list_baseline$time_to_persistence[agent],]
      )
    } else if(agents_list_baseline$time_to_persistence[agent]==336 && agents_list_baseline$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_baseline_10min <- rbind(
        persistent_uncleanable_durations_list_baseline_10min,
        Facility_B_durations_baseline_10min[Facility_B_durations_baseline_10min$agent==agent & Facility_B_durations_baseline_10min$duration>agents_list_baseline$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_baseline$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_baseline_10min <- rbind(
      transient_short_durations_list_baseline_10min,
      Facility_B_durations_baseline_10min[Facility_B_durations_baseline_10min$agent==agent & Facility_B_durations_baseline_10min$duration<=agents_list_baseline$time_to_persistence[agent],]
    )
  } else if(agents_list_baseline$time_to_persistence[agent]==336 && agents_list_baseline$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_baseline_10min <- rbind(
      transient_long_durations_list_baseline_10min,
      Facility_B_durations_baseline_10min[Facility_B_durations_baseline_10min$agent==agent & Facility_B_durations_baseline_10min$duration<=agents_list_baseline$time_to_persistence[agent],]
    )
  } else if(agents_list_baseline$time_to_persistence[agent]==336 && agents_list_baseline$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_baseline_10min <- rbind(
      transient_uncleanable_durations_list_baseline_10min,
      Facility_B_durations_baseline_10min[Facility_B_durations_baseline_10min$agent==agent & Facility_B_durations_baseline_10min$duration<=agents_list_baseline$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

# Facility_B_baseline_agents_melted_monday_preop <- Facility_B_baseline_agents_melted[which(Facility_B_baseline_agents_melted$tick==33|Facility_B_baseline_agents_melted$tick==201|Facility_B_baseline_agents_melted$tick==369|Facility_B_baseline_agents_melted$tick==537|Facility_B_baseline_agents_melted$tick==705|Facility_B_baseline_agents_melted$tick==873|Facility_B_baseline_agents_melted$tick==1041|Facility_B_baseline_agents_melted$tick==1209),]
# 
# Facility_B_baseline_agents_melted_tuesday_preop <- Facility_B_baseline_agents_melted[which(Facility_B_baseline_agents_melted$tick==57|Facility_B_baseline_agents_melted$tick==225|Facility_B_baseline_agents_melted$tick==393|Facility_B_baseline_agents_melted$tick==561|Facility_B_baseline_agents_melted$tick==729|Facility_B_baseline_agents_melted$tick==897|Facility_B_baseline_agents_melted$tick==1065|Facility_B_baseline_agents_melted$tick==1233),]
# 
# Facility_B_baseline_agents_melted_wednesday_preop <- Facility_B_baseline_agents_melted[which(Facility_B_baseline_agents_melted$tick==81|Facility_B_baseline_agents_melted$tick==249|Facility_B_baseline_agents_melted$tick==417|Facility_B_baseline_agents_melted$tick==585|Facility_B_baseline_agents_melted$tick==753|Facility_B_baseline_agents_melted$tick==921|Facility_B_baseline_agents_melted$tick==1089|Facility_B_baseline_agents_melted$tick==1257),]
# 
# Facility_B_baseline_agents_melted_thursday_preop <- Facility_B_baseline_agents_melted[which(Facility_B_baseline_agents_melted$tick==105|Facility_B_baseline_agents_melted$tick==273|Facility_B_baseline_agents_melted$tick==441|Facility_B_baseline_agents_melted$tick==609|Facility_B_baseline_agents_melted$tick==777|Facility_B_baseline_agents_melted$tick==945|Facility_B_baseline_agents_melted$tick==1113|Facility_B_baseline_agents_melted$tick==1281),]
# 
# Facility_B_baseline_agents_melted_friday_preop <- Facility_B_baseline_agents_melted[which(Facility_B_baseline_agents_melted$tick==129|Facility_B_baseline_agents_melted$tick==297|Facility_B_baseline_agents_melted$tick==465|Facility_B_baseline_agents_melted$tick==633|Facility_B_baseline_agents_melted$tick==801|Facility_B_baseline_agents_melted$tick==969|Facility_B_baseline_agents_melted$tick==1137|Facility_B_baseline_agents_melted$tick==1305),]

Facility_B_baseline_agents_melted_ff <- as.ffdf(Facility_B_baseline_agents_melted)
rm(Facility_B_baseline_agents_melted)
gc()
```

```{r import No Niches}
NL_table_No_Niches <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-24-09-38 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_No_Niches-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_No_Niches <- NL_table_No_Niches[NL_table_No_Niches$scenario==50,]

while (any(grepl('-', names(NL_table_No_Niches), fixed = TRUE))) {
  NL_table_No_Niches <- NL_table_No_Niches %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_No_Niches), fixed = TRUE))) {
  NL_table_No_Niches <- NL_table_No_Niches %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_No_Niches), fixed = TRUE))) {
  NL_table_No_Niches <- NL_table_No_Niches %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_No_Niches), fixed = TRUE))) {
  NL_table_No_Niches <- NL_table_No_Niches %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_No_Niches[ , ..list_columns]

NL_table_No_Niches[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_No_Niches <- as.data.frame(NL_table_No_Niches)

NL_table_No_Niches[NL_table_No_Niches==-1] <- NA

NL_table_No_Niches <- subset(NL_table_No_Niches, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_No_Niches)[names(NL_table_No_Niches)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_No_Niches)[names(NL_table_No_Niches)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_No_Niches$loading_w1wed_conc_list
vector <- vector[vector!='[]']
no_niches_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_loading_w1wed_conc_list <- append(no_niches_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_loading_w1wed_conc_matrix <- matrix(unlist(no_niches_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_No_Niches$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
no_niches_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_cleaning_w1wed_conc_list <- append(no_niches_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_cleaning_w1wed_conc_matrix <- matrix(unlist(no_niches_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_No_Niches$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# no_niches_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   no_niches_drying_w1wed_conc_list <- append(no_niches_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_No_Niches$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
no_niches_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_sorting_w1wed_conc_list <- append(no_niches_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_sorting_w1wed_conc_matrix <- matrix(unlist(no_niches_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_No_Niches$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
no_niches_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_tray_packing_w1wed_conc_list <- append(no_niches_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_tray_packing_w1wed_conc_matrix <- matrix(unlist(no_niches_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_No_Niches$reject_w1wed_conc_list
vector <- vector[vector!='[]']
no_niches_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_reject_w1wed_conc_list <- append(no_niches_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_reject_w1wed_conc_matrix <- matrix(unlist(no_niches_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_No_Niches$other_w1wed_conc_list
vector <- vector[vector!='[]']
no_niches_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_other_w1wed_conc_list <- append(no_niches_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_other_w1wed_conc_matrix <- matrix(unlist(no_niches_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

no_niches_loading_concs <- as.data.frame(no_niches_loading_w1wed_conc_list)
no_niches_loading_concs$area <- as.factor('loading')
no_niches_loading_concs$scenario <- as.factor('XI_01')
no_niches_loading_concs$water <- as.factor('Wet')
names(no_niches_loading_concs) <- c('concentration','area','scenario','water')

no_niches_cleaning_concs <- as.data.frame(no_niches_cleaning_w1wed_conc_list)
no_niches_cleaning_concs$area <- as.factor('cleaning')
no_niches_cleaning_concs$scenario <- as.factor('XI_01')
no_niches_cleaning_concs$water <- as.factor('Wet')
names(no_niches_cleaning_concs) <- c('concentration','area','scenario','water')

no_niches_sorting_concs <- as.data.frame(no_niches_sorting_w1wed_conc_list)
no_niches_sorting_concs$area <- as.factor('sorting')
no_niches_sorting_concs$scenario <- as.factor('XI_01')
no_niches_sorting_concs$water <- as.factor('Dry')
names(no_niches_sorting_concs) <- c('concentration','area','scenario','water')

no_niches_reject_concs <- as.data.frame(no_niches_reject_w1wed_conc_list)
no_niches_reject_concs$area <- as.factor('reject')
no_niches_reject_concs$scenario <- as.factor('XI_01')
no_niches_reject_concs$water <- as.factor('Dry')
names(no_niches_reject_concs) <- c('concentration','area','scenario','water')

no_niches_tray_packing_concs <- as.data.frame(no_niches_tray_packing_w1wed_conc_list)
no_niches_tray_packing_concs$area <- as.factor('tray packing')
no_niches_tray_packing_concs$scenario <- as.factor('XI_01')
no_niches_tray_packing_concs$water <- as.factor('Dry')
names(no_niches_tray_packing_concs) <- c('concentration','area','scenario','water')

no_niches_other_concs <- as.data.frame(no_niches_other_w1wed_conc_list)
no_niches_other_concs$area <- as.factor('other')
no_niches_other_concs$scenario <- as.factor('XI_01')
no_niches_other_concs$water <- as.factor('Dry')
names(no_niches_other_concs) <- c('concentration','area','scenario','water')

no_niches_w1wed_concs <- rbind(no_niches_loading_concs,no_niches_cleaning_concs,no_niches_sorting_concs,no_niches_tray_packing_concs,no_niches_reject_concs,no_niches_other_concs)

no_niches_loading_prev <- as.data.frame(NL_table_No_Niches$loading_w1wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_loading_prev$area <- as.factor('loading')
no_niches_loading_prev$scenario <- as.factor('XI_01')
no_niches_loading_prev$water <- as.factor('Wet')
names(no_niches_loading_prev) <- c('prevalence','area','scenario','water')

no_niches_cleaning_prev <- as.data.frame(NL_table_No_Niches$cleaning_w1wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_cleaning_prev$area <- as.factor('cleaning')
no_niches_cleaning_prev$scenario <- as.factor('XI_01')
no_niches_cleaning_prev$water <- as.factor('Wet')
names(no_niches_cleaning_prev) <- c('prevalence','area','scenario','water')

no_niches_sorting_prev <- as.data.frame(NL_table_No_Niches$sorting_w1wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_sorting_prev$area <- as.factor('sorting')
no_niches_sorting_prev$scenario <- as.factor('XI_01')
no_niches_sorting_prev$water <- as.factor('Dry')
names(no_niches_sorting_prev) <- c('prevalence','area','scenario','water')

no_niches_reject_prev <- as.data.frame(NL_table_No_Niches$reject_w1wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_reject_prev$area <- as.factor('reject')
no_niches_reject_prev$scenario <- as.factor('XI_01')
no_niches_reject_prev$water <- as.factor('Dry')
names(no_niches_reject_prev) <- c('prevalence','area','scenario','water')

no_niches_tray_packing_prev <- as.data.frame(NL_table_No_Niches$tray_packing_w1wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_tray_packing_prev$area <- as.factor('tray packing')
no_niches_tray_packing_prev$scenario <- as.factor('XI_01')
no_niches_tray_packing_prev$water <- as.factor('Dry')
names(no_niches_tray_packing_prev) <- c('prevalence','area','scenario','water')

no_niches_other_prev <- as.data.frame(NL_table_No_Niches$other_w1wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_other_prev$area <- as.factor('other')
no_niches_other_prev$scenario <- as.factor('XI_01')
no_niches_other_prev$water <- as.factor('Dry')
names(no_niches_other_prev) <- c('prevalence','area','scenario','water')

no_niches_w1wed_prev <- rbind(no_niches_loading_prev,no_niches_cleaning_prev,no_niches_sorting_prev,no_niches_tray_packing_prev,no_niches_reject_prev,no_niches_other_prev)

no_niches_w1wed_wet_prev <- as.data.frame(no_niches_loading_prev$prevalence*21/100+no_niches_cleaning_prev$prevalence*28/100)/49*100
no_niches_w1wed_wet_prev$scenario <- as.factor('XI_01')
no_niches_w1wed_wet_prev$water <- as.factor('Wet')
names(no_niches_w1wed_wet_prev) <- c('prevalence','scenario','water')

no_niches_w1wed_dry_prev <- as.data.frame(no_niches_sorting_prev$prevalence*20/100+no_niches_reject_prev$prevalence*23/100+no_niches_tray_packing_prev$prevalence*123/100+no_niches_other_prev$prevalence*10/100)/176*100
no_niches_w1wed_dry_prev$scenario <- as.factor('XI_01')
no_niches_w1wed_dry_prev$water <- as.factor('Dry')
names(no_niches_w1wed_dry_prev) <- c('prevalence','scenario','water')

no_niches_w1wed_recombined_prev <- rbind(no_niches_w1wed_wet_prev, no_niches_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_No_Niches$loading_w2wed_conc_list
vector <- vector[vector!='[]']
no_niches_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_loading_w2wed_conc_list <- append(no_niches_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_loading_w2wed_conc_matrix <- matrix(unlist(no_niches_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_No_Niches$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
no_niches_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_cleaning_w2wed_conc_list <- append(no_niches_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_cleaning_w2wed_conc_matrix <- matrix(unlist(no_niches_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_No_Niches$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# no_niches_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   no_niches_drying_w2wed_conc_list <- append(no_niches_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_No_Niches$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
no_niches_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_sorting_w2wed_conc_list <- append(no_niches_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_sorting_w2wed_conc_matrix <- matrix(unlist(no_niches_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_No_Niches$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
no_niches_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_tray_packing_w2wed_conc_list <- append(no_niches_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_tray_packing_w2wed_conc_matrix <- matrix(unlist(no_niches_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_No_Niches$reject_w2wed_conc_list
vector <- vector[vector!='[]']
no_niches_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_reject_w2wed_conc_list <- append(no_niches_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_reject_w2wed_conc_matrix <- matrix(unlist(no_niches_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_No_Niches$other_w2wed_conc_list
vector <- vector[vector!='[]']
no_niches_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_other_w2wed_conc_list <- append(no_niches_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_other_w2wed_conc_matrix <- matrix(unlist(no_niches_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

no_niches_loading_concs <- as.data.frame(no_niches_loading_w2wed_conc_list)
no_niches_loading_concs$area <- as.factor('loading')
no_niches_loading_concs$scenario <- as.factor('XI_01')
no_niches_loading_concs$water <- as.factor('Wet')
names(no_niches_loading_concs) <- c('concentration','area','scenario','water')

no_niches_cleaning_concs <- as.data.frame(no_niches_cleaning_w2wed_conc_list)
no_niches_cleaning_concs$area <- as.factor('cleaning')
no_niches_cleaning_concs$scenario <- as.factor('XI_01')
no_niches_cleaning_concs$water <- as.factor('Wet')
names(no_niches_cleaning_concs) <- c('concentration','area','scenario','water')

no_niches_sorting_concs <- as.data.frame(no_niches_sorting_w2wed_conc_list)
no_niches_sorting_concs$area <- as.factor('sorting')
no_niches_sorting_concs$scenario <- as.factor('XI_01')
no_niches_sorting_concs$water <- as.factor('Dry')
names(no_niches_sorting_concs) <- c('concentration','area','scenario','water')

no_niches_reject_concs <- as.data.frame(no_niches_reject_w2wed_conc_list)
no_niches_reject_concs$area <- as.factor('reject')
no_niches_reject_concs$scenario <- as.factor('XI_01')
no_niches_reject_concs$water <- as.factor('Dry')
names(no_niches_reject_concs) <- c('concentration','area','scenario','water')

no_niches_tray_packing_concs <- as.data.frame(no_niches_tray_packing_w2wed_conc_list)
no_niches_tray_packing_concs$area <- as.factor('tray packing')
no_niches_tray_packing_concs$scenario <- as.factor('XI_01')
no_niches_tray_packing_concs$water <- as.factor('Dry')
names(no_niches_tray_packing_concs) <- c('concentration','area','scenario','water')

no_niches_other_concs <- as.data.frame(no_niches_other_w2wed_conc_list)
no_niches_other_concs$area <- as.factor('other')
no_niches_other_concs$scenario <- as.factor('XI_01')
no_niches_other_concs$water <- as.factor('Dry')
names(no_niches_other_concs) <- c('concentration','area','scenario','water')

no_niches_w2wed_concs <- rbind(no_niches_loading_concs,no_niches_cleaning_concs,no_niches_sorting_concs,no_niches_tray_packing_concs,no_niches_reject_concs,no_niches_other_concs)

no_niches_loading_prev <- as.data.frame(NL_table_No_Niches$loading_w2wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_loading_prev$area <- as.factor('loading')
no_niches_loading_prev$scenario <- as.factor('XI_01')
no_niches_loading_prev$water <- as.factor('Wet')
names(no_niches_loading_prev) <- c('prevalence','area','scenario','water')

no_niches_cleaning_prev <- as.data.frame(NL_table_No_Niches$cleaning_w2wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_cleaning_prev$area <- as.factor('cleaning')
no_niches_cleaning_prev$scenario <- as.factor('XI_01')
no_niches_cleaning_prev$water <- as.factor('Wet')
names(no_niches_cleaning_prev) <- c('prevalence','area','scenario','water')

no_niches_sorting_prev <- as.data.frame(NL_table_No_Niches$sorting_w2wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_sorting_prev$area <- as.factor('sorting')
no_niches_sorting_prev$scenario <- as.factor('XI_01')
no_niches_sorting_prev$water <- as.factor('Dry')
names(no_niches_sorting_prev) <- c('prevalence','area','scenario','water')

no_niches_reject_prev <- as.data.frame(NL_table_No_Niches$reject_w2wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_reject_prev$area <- as.factor('reject')
no_niches_reject_prev$scenario <- as.factor('XI_01')
no_niches_reject_prev$water <- as.factor('Dry')
names(no_niches_reject_prev) <- c('prevalence','area','scenario','water')

no_niches_tray_packing_prev <- as.data.frame(NL_table_No_Niches$tray_packing_w2wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_tray_packing_prev$area <- as.factor('tray packing')
no_niches_tray_packing_prev$scenario <- as.factor('XI_01')
no_niches_tray_packing_prev$water <- as.factor('Dry')
names(no_niches_tray_packing_prev) <- c('prevalence','area','scenario','water')

no_niches_other_prev <- as.data.frame(NL_table_No_Niches$other_w2wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_other_prev$area <- as.factor('other')
no_niches_other_prev$scenario <- as.factor('XI_01')
no_niches_other_prev$water <- as.factor('Dry')
names(no_niches_other_prev) <- c('prevalence','area','scenario','water')

no_niches_w2wed_prev <- rbind(no_niches_loading_prev,no_niches_cleaning_prev,no_niches_sorting_prev,no_niches_tray_packing_prev,no_niches_reject_prev,no_niches_other_prev)

no_niches_w2wed_wet_prev <- as.data.frame(no_niches_loading_prev$prevalence*21/100+no_niches_cleaning_prev$prevalence*28/100)/49*100
no_niches_w2wed_wet_prev$scenario <- as.factor('XI_01')
no_niches_w2wed_wet_prev$water <- as.factor('Wet')
names(no_niches_w2wed_wet_prev) <- c('prevalence','scenario','water')

no_niches_w2wed_dry_prev <- as.data.frame(no_niches_sorting_prev$prevalence*20/100+no_niches_reject_prev$prevalence*23/100+no_niches_tray_packing_prev$prevalence*123/100+no_niches_other_prev$prevalence*10/100)/176*100
no_niches_w2wed_dry_prev$scenario <- as.factor('XI_01')
no_niches_w2wed_dry_prev$water <- as.factor('Dry')
names(no_niches_w2wed_dry_prev) <- c('prevalence','scenario','water')

no_niches_w2wed_recombined_prev <- rbind(no_niches_w2wed_wet_prev, no_niches_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_No_Niches$loading_w3wed_conc_list
vector <- vector[vector!='[]']
no_niches_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_loading_w3wed_conc_list <- append(no_niches_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_loading_w3wed_conc_matrix <- matrix(unlist(no_niches_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_No_Niches$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
no_niches_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_cleaning_w3wed_conc_list <- append(no_niches_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_cleaning_w3wed_conc_matrix <- matrix(unlist(no_niches_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_No_Niches$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# no_niches_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   no_niches_drying_w3wed_conc_list <- append(no_niches_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_No_Niches$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
no_niches_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_sorting_w3wed_conc_list <- append(no_niches_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_sorting_w3wed_conc_matrix <- matrix(unlist(no_niches_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_No_Niches$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
no_niches_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_tray_packing_w3wed_conc_list <- append(no_niches_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_tray_packing_w3wed_conc_matrix <- matrix(unlist(no_niches_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_No_Niches$reject_w3wed_conc_list
vector <- vector[vector!='[]']
no_niches_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_reject_w3wed_conc_list <- append(no_niches_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_reject_w3wed_conc_matrix <- matrix(unlist(no_niches_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_No_Niches$other_w3wed_conc_list
vector <- vector[vector!='[]']
no_niches_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_other_w3wed_conc_list <- append(no_niches_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_other_w3wed_conc_matrix <- matrix(unlist(no_niches_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

no_niches_loading_concs <- as.data.frame(no_niches_loading_w3wed_conc_list)
no_niches_loading_concs$area <- as.factor('loading')
no_niches_loading_concs$scenario <- as.factor('XI_01')
no_niches_loading_concs$water <- as.factor('Wet')
names(no_niches_loading_concs) <- c('concentration','area','scenario','water')

no_niches_cleaning_concs <- as.data.frame(no_niches_cleaning_w3wed_conc_list)
no_niches_cleaning_concs$area <- as.factor('cleaning')
no_niches_cleaning_concs$scenario <- as.factor('XI_01')
no_niches_cleaning_concs$water <- as.factor('Wet')
names(no_niches_cleaning_concs) <- c('concentration','area','scenario','water')

no_niches_sorting_concs <- as.data.frame(no_niches_sorting_w3wed_conc_list)
no_niches_sorting_concs$area <- as.factor('sorting')
no_niches_sorting_concs$scenario <- as.factor('XI_01')
no_niches_sorting_concs$water <- as.factor('Dry')
names(no_niches_sorting_concs) <- c('concentration','area','scenario','water')

no_niches_reject_concs <- as.data.frame(no_niches_reject_w3wed_conc_list)
no_niches_reject_concs$area <- as.factor('reject')
no_niches_reject_concs$scenario <- as.factor('XI_01')
no_niches_reject_concs$water <- as.factor('Dry')
names(no_niches_reject_concs) <- c('concentration','area','scenario','water')

no_niches_tray_packing_concs <- as.data.frame(no_niches_tray_packing_w3wed_conc_list)
no_niches_tray_packing_concs$area <- as.factor('tray packing')
no_niches_tray_packing_concs$scenario <- as.factor('XI_01')
no_niches_tray_packing_concs$water <- as.factor('Dry')
names(no_niches_tray_packing_concs) <- c('concentration','area','scenario','water')

no_niches_other_concs <- as.data.frame(no_niches_other_w3wed_conc_list)
no_niches_other_concs$area <- as.factor('other')
no_niches_other_concs$scenario <- as.factor('XI_01')
no_niches_other_concs$water <- as.factor('Dry')
names(no_niches_other_concs) <- c('concentration','area','scenario','water')

no_niches_w3wed_concs <- rbind(no_niches_loading_concs,no_niches_cleaning_concs,no_niches_sorting_concs,no_niches_tray_packing_concs,no_niches_reject_concs,no_niches_other_concs)

no_niches_loading_prev <- as.data.frame(NL_table_No_Niches$loading_w3wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_loading_prev$area <- as.factor('loading')
no_niches_loading_prev$scenario <- as.factor('XI_01')
no_niches_loading_prev$water <- as.factor('Wet')
names(no_niches_loading_prev) <- c('prevalence','area','scenario','water')

no_niches_cleaning_prev <- as.data.frame(NL_table_No_Niches$cleaning_w3wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_cleaning_prev$area <- as.factor('cleaning')
no_niches_cleaning_prev$scenario <- as.factor('XI_01')
no_niches_cleaning_prev$water <- as.factor('Wet')
names(no_niches_cleaning_prev) <- c('prevalence','area','scenario','water')

no_niches_sorting_prev <- as.data.frame(NL_table_No_Niches$sorting_w3wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_sorting_prev$area <- as.factor('sorting')
no_niches_sorting_prev$scenario <- as.factor('XI_01')
no_niches_sorting_prev$water <- as.factor('Dry')
names(no_niches_sorting_prev) <- c('prevalence','area','scenario','water')

no_niches_reject_prev <- as.data.frame(NL_table_No_Niches$reject_w3wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_reject_prev$area <- as.factor('reject')
no_niches_reject_prev$scenario <- as.factor('XI_01')
no_niches_reject_prev$water <- as.factor('Dry')
names(no_niches_reject_prev) <- c('prevalence','area','scenario','water')

no_niches_tray_packing_prev <- as.data.frame(NL_table_No_Niches$tray_packing_w3wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_tray_packing_prev$area <- as.factor('tray packing')
no_niches_tray_packing_prev$scenario <- as.factor('XI_01')
no_niches_tray_packing_prev$water <- as.factor('Dry')
names(no_niches_tray_packing_prev) <- c('prevalence','area','scenario','water')

no_niches_other_prev <- as.data.frame(NL_table_No_Niches$other_w3wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_other_prev$area <- as.factor('other')
no_niches_other_prev$scenario <- as.factor('XI_01')
no_niches_other_prev$water <- as.factor('Dry')
names(no_niches_other_prev) <- c('prevalence','area','scenario','water')

no_niches_w3wed_prev <- rbind(no_niches_loading_prev,no_niches_cleaning_prev,no_niches_sorting_prev,no_niches_tray_packing_prev,no_niches_reject_prev,no_niches_other_prev)

no_niches_w3wed_wet_prev <- as.data.frame(no_niches_loading_prev$prevalence*21/100+no_niches_cleaning_prev$prevalence*28/100)/49*100
no_niches_w3wed_wet_prev$scenario <- as.factor('XI_01')
no_niches_w3wed_wet_prev$water <- as.factor('Wet')
names(no_niches_w3wed_wet_prev) <- c('prevalence','scenario','water')

no_niches_w3wed_dry_prev <- as.data.frame(no_niches_sorting_prev$prevalence*20/100+no_niches_reject_prev$prevalence*23/100+no_niches_tray_packing_prev$prevalence*123/100+no_niches_other_prev$prevalence*10/100)/176*100
no_niches_w3wed_dry_prev$scenario <- as.factor('XI_01')
no_niches_w3wed_dry_prev$water <- as.factor('Dry')
names(no_niches_w3wed_dry_prev) <- c('prevalence','scenario','water')

no_niches_w3wed_recombined_prev <- rbind(no_niches_w3wed_wet_prev, no_niches_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_No_Niches$loading_w4wed_conc_list
vector <- vector[vector!='[]']
no_niches_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_loading_w4wed_conc_list <- append(no_niches_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_loading_w4wed_conc_matrix <- matrix(unlist(no_niches_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_No_Niches$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
no_niches_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_cleaning_w4wed_conc_list <- append(no_niches_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_cleaning_w4wed_conc_matrix <- matrix(unlist(no_niches_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_No_Niches$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# no_niches_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   no_niches_drying_w4wed_conc_list <- append(no_niches_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_No_Niches$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
no_niches_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_sorting_w4wed_conc_list <- append(no_niches_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_sorting_w4wed_conc_matrix <- matrix(unlist(no_niches_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_No_Niches$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
no_niches_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_tray_packing_w4wed_conc_list <- append(no_niches_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_tray_packing_w4wed_conc_matrix <- matrix(unlist(no_niches_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_No_Niches$reject_w4wed_conc_list
vector <- vector[vector!='[]']
no_niches_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_reject_w4wed_conc_list <- append(no_niches_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_reject_w4wed_conc_matrix <- matrix(unlist(no_niches_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_No_Niches$other_w4wed_conc_list
vector <- vector[vector!='[]']
no_niches_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_other_w4wed_conc_list <- append(no_niches_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_other_w4wed_conc_matrix <- matrix(unlist(no_niches_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

no_niches_loading_concs <- as.data.frame(no_niches_loading_w4wed_conc_list)
no_niches_loading_concs$area <- as.factor('loading')
no_niches_loading_concs$scenario <- as.factor('XI_01')
no_niches_loading_concs$water <- as.factor('Wet')
names(no_niches_loading_concs) <- c('concentration','area','scenario','water')

no_niches_cleaning_concs <- as.data.frame(no_niches_cleaning_w4wed_conc_list)
no_niches_cleaning_concs$area <- as.factor('cleaning')
no_niches_cleaning_concs$scenario <- as.factor('XI_01')
no_niches_cleaning_concs$water <- as.factor('Wet')
names(no_niches_cleaning_concs) <- c('concentration','area','scenario','water')

no_niches_sorting_concs <- as.data.frame(no_niches_sorting_w4wed_conc_list)
no_niches_sorting_concs$area <- as.factor('sorting')
no_niches_sorting_concs$scenario <- as.factor('XI_01')
no_niches_sorting_concs$water <- as.factor('Dry')
names(no_niches_sorting_concs) <- c('concentration','area','scenario','water')

no_niches_reject_concs <- as.data.frame(no_niches_reject_w4wed_conc_list)
no_niches_reject_concs$area <- as.factor('reject')
no_niches_reject_concs$scenario <- as.factor('XI_01')
no_niches_reject_concs$water <- as.factor('Dry')
names(no_niches_reject_concs) <- c('concentration','area','scenario','water')

no_niches_tray_packing_concs <- as.data.frame(no_niches_tray_packing_w4wed_conc_list)
no_niches_tray_packing_concs$area <- as.factor('tray packing')
no_niches_tray_packing_concs$scenario <- as.factor('XI_01')
no_niches_tray_packing_concs$water <- as.factor('Dry')
names(no_niches_tray_packing_concs) <- c('concentration','area','scenario','water')

no_niches_other_concs <- as.data.frame(no_niches_other_w4wed_conc_list)
no_niches_other_concs$area <- as.factor('other')
no_niches_other_concs$scenario <- as.factor('XI_01')
no_niches_other_concs$water <- as.factor('Dry')
names(no_niches_other_concs) <- c('concentration','area','scenario','water')

no_niches_w4wed_concs <- rbind(no_niches_loading_concs,no_niches_cleaning_concs,no_niches_sorting_concs,no_niches_tray_packing_concs,no_niches_reject_concs,no_niches_other_concs)

no_niches_loading_prev <- as.data.frame(NL_table_No_Niches$loading_w4wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_loading_prev$area <- as.factor('loading')
no_niches_loading_prev$scenario <- as.factor('XI_01')
no_niches_loading_prev$water <- as.factor('Wet')
names(no_niches_loading_prev) <- c('prevalence','area','scenario','water')

no_niches_cleaning_prev <- as.data.frame(NL_table_No_Niches$cleaning_w4wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_cleaning_prev$area <- as.factor('cleaning')
no_niches_cleaning_prev$scenario <- as.factor('XI_01')
no_niches_cleaning_prev$water <- as.factor('Wet')
names(no_niches_cleaning_prev) <- c('prevalence','area','scenario','water')

no_niches_sorting_prev <- as.data.frame(NL_table_No_Niches$sorting_w4wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_sorting_prev$area <- as.factor('sorting')
no_niches_sorting_prev$scenario <- as.factor('XI_01')
no_niches_sorting_prev$water <- as.factor('Dry')
names(no_niches_sorting_prev) <- c('prevalence','area','scenario','water')

no_niches_reject_prev <- as.data.frame(NL_table_No_Niches$reject_w4wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_reject_prev$area <- as.factor('reject')
no_niches_reject_prev$scenario <- as.factor('XI_01')
no_niches_reject_prev$water <- as.factor('Dry')
names(no_niches_reject_prev) <- c('prevalence','area','scenario','water')

no_niches_tray_packing_prev <- as.data.frame(NL_table_No_Niches$tray_packing_w4wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_tray_packing_prev$area <- as.factor('tray packing')
no_niches_tray_packing_prev$scenario <- as.factor('XI_01')
no_niches_tray_packing_prev$water <- as.factor('Dry')
names(no_niches_tray_packing_prev) <- c('prevalence','area','scenario','water')

no_niches_other_prev <- as.data.frame(NL_table_No_Niches$other_w4wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_other_prev$area <- as.factor('other')
no_niches_other_prev$scenario <- as.factor('XI_01')
no_niches_other_prev$water <- as.factor('Dry')
names(no_niches_other_prev) <- c('prevalence','area','scenario','water')

no_niches_w4wed_prev <- rbind(no_niches_loading_prev,no_niches_cleaning_prev,no_niches_sorting_prev,no_niches_tray_packing_prev,no_niches_reject_prev,no_niches_other_prev)

no_niches_w4wed_wet_prev <- as.data.frame(no_niches_loading_prev$prevalence*21/100+no_niches_cleaning_prev$prevalence*28/100)/49*100
no_niches_w4wed_wet_prev$scenario <- as.factor('XI_01')
no_niches_w4wed_wet_prev$water <- as.factor('Wet')
names(no_niches_w4wed_wet_prev) <- c('prevalence','scenario','water')

no_niches_w4wed_dry_prev <- as.data.frame(no_niches_sorting_prev$prevalence*20/100+no_niches_reject_prev$prevalence*23/100+no_niches_tray_packing_prev$prevalence*123/100+no_niches_other_prev$prevalence*10/100)/176*100
no_niches_w4wed_dry_prev$scenario <- as.factor('XI_01')
no_niches_w4wed_dry_prev$water <- as.factor('Dry')
names(no_niches_w4wed_dry_prev) <- c('prevalence','scenario','water')

no_niches_w4wed_recombined_prev <- rbind(no_niches_w4wed_wet_prev, no_niches_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_No_Niches$loading_w5wed_conc_list
vector <- vector[vector!='[]']
no_niches_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_loading_w5wed_conc_list <- append(no_niches_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_loading_w5wed_conc_matrix <- matrix(unlist(no_niches_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_No_Niches$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
no_niches_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_cleaning_w5wed_conc_list <- append(no_niches_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_cleaning_w5wed_conc_matrix <- matrix(unlist(no_niches_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_No_Niches$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# no_niches_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   no_niches_drying_w5wed_conc_list <- append(no_niches_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_No_Niches$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
no_niches_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_sorting_w5wed_conc_list <- append(no_niches_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_sorting_w5wed_conc_matrix <- matrix(unlist(no_niches_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_No_Niches$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
no_niches_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_tray_packing_w5wed_conc_list <- append(no_niches_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_tray_packing_w5wed_conc_matrix <- matrix(unlist(no_niches_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_No_Niches$reject_w5wed_conc_list
vector <- vector[vector!='[]']
no_niches_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_reject_w5wed_conc_list <- append(no_niches_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_reject_w5wed_conc_matrix <- matrix(unlist(no_niches_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_No_Niches$other_w5wed_conc_list
vector <- vector[vector!='[]']
no_niches_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_other_w5wed_conc_list <- append(no_niches_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_other_w5wed_conc_matrix <- matrix(unlist(no_niches_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

no_niches_loading_concs <- as.data.frame(no_niches_loading_w5wed_conc_list)
no_niches_loading_concs$area <- as.factor('loading')
no_niches_loading_concs$scenario <- as.factor('XI_01')
no_niches_loading_concs$water <- as.factor('Wet')
names(no_niches_loading_concs) <- c('concentration','area','scenario','water')

no_niches_cleaning_concs <- as.data.frame(no_niches_cleaning_w5wed_conc_list)
no_niches_cleaning_concs$area <- as.factor('cleaning')
no_niches_cleaning_concs$scenario <- as.factor('XI_01')
no_niches_cleaning_concs$water <- as.factor('Wet')
names(no_niches_cleaning_concs) <- c('concentration','area','scenario','water')

no_niches_sorting_concs <- as.data.frame(no_niches_sorting_w5wed_conc_list)
no_niches_sorting_concs$area <- as.factor('sorting')
no_niches_sorting_concs$scenario <- as.factor('XI_01')
no_niches_sorting_concs$water <- as.factor('Dry')
names(no_niches_sorting_concs) <- c('concentration','area','scenario','water')

no_niches_reject_concs <- as.data.frame(no_niches_reject_w5wed_conc_list)
no_niches_reject_concs$area <- as.factor('reject')
no_niches_reject_concs$scenario <- as.factor('XI_01')
no_niches_reject_concs$water <- as.factor('Dry')
names(no_niches_reject_concs) <- c('concentration','area','scenario','water')

no_niches_tray_packing_concs <- as.data.frame(no_niches_tray_packing_w5wed_conc_list)
no_niches_tray_packing_concs$area <- as.factor('tray packing')
no_niches_tray_packing_concs$scenario <- as.factor('XI_01')
no_niches_tray_packing_concs$water <- as.factor('Dry')
names(no_niches_tray_packing_concs) <- c('concentration','area','scenario','water')

no_niches_other_concs <- as.data.frame(no_niches_other_w5wed_conc_list)
no_niches_other_concs$area <- as.factor('other')
no_niches_other_concs$scenario <- as.factor('XI_01')
no_niches_other_concs$water <- as.factor('Dry')
names(no_niches_other_concs) <- c('concentration','area','scenario','water')

no_niches_w5wed_concs <- rbind(no_niches_loading_concs,no_niches_cleaning_concs,no_niches_sorting_concs,no_niches_tray_packing_concs,no_niches_reject_concs,no_niches_other_concs)

no_niches_loading_prev <- as.data.frame(NL_table_No_Niches$loading_w5wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_loading_prev$area <- as.factor('loading')
no_niches_loading_prev$scenario <- as.factor('XI_01')
no_niches_loading_prev$water <- as.factor('Wet')
names(no_niches_loading_prev) <- c('prevalence','area','scenario','water')

no_niches_cleaning_prev <- as.data.frame(NL_table_No_Niches$cleaning_w5wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_cleaning_prev$area <- as.factor('cleaning')
no_niches_cleaning_prev$scenario <- as.factor('XI_01')
no_niches_cleaning_prev$water <- as.factor('Wet')
names(no_niches_cleaning_prev) <- c('prevalence','area','scenario','water')

no_niches_sorting_prev <- as.data.frame(NL_table_No_Niches$sorting_w5wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_sorting_prev$area <- as.factor('sorting')
no_niches_sorting_prev$scenario <- as.factor('XI_01')
no_niches_sorting_prev$water <- as.factor('Dry')
names(no_niches_sorting_prev) <- c('prevalence','area','scenario','water')

no_niches_reject_prev <- as.data.frame(NL_table_No_Niches$reject_w5wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_reject_prev$area <- as.factor('reject')
no_niches_reject_prev$scenario <- as.factor('XI_01')
no_niches_reject_prev$water <- as.factor('Dry')
names(no_niches_reject_prev) <- c('prevalence','area','scenario','water')

no_niches_tray_packing_prev <- as.data.frame(NL_table_No_Niches$tray_packing_w5wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_tray_packing_prev$area <- as.factor('tray packing')
no_niches_tray_packing_prev$scenario <- as.factor('XI_01')
no_niches_tray_packing_prev$water <- as.factor('Dry')
names(no_niches_tray_packing_prev) <- c('prevalence','area','scenario','water')

no_niches_other_prev <- as.data.frame(NL_table_No_Niches$other_w5wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_other_prev$area <- as.factor('other')
no_niches_other_prev$scenario <- as.factor('XI_01')
no_niches_other_prev$water <- as.factor('Dry')
names(no_niches_other_prev) <- c('prevalence','area','scenario','water')

no_niches_w5wed_prev <- rbind(no_niches_loading_prev,no_niches_cleaning_prev,no_niches_sorting_prev,no_niches_tray_packing_prev,no_niches_reject_prev,no_niches_other_prev)

no_niches_w5wed_wet_prev <- as.data.frame(no_niches_loading_prev$prevalence*21/100+no_niches_cleaning_prev$prevalence*28/100)/49*100
no_niches_w5wed_wet_prev$scenario <- as.factor('XI_01')
no_niches_w5wed_wet_prev$water <- as.factor('Wet')
names(no_niches_w5wed_wet_prev) <- c('prevalence','scenario','water')

no_niches_w5wed_dry_prev <- as.data.frame(no_niches_sorting_prev$prevalence*20/100+no_niches_reject_prev$prevalence*23/100+no_niches_tray_packing_prev$prevalence*123/100+no_niches_other_prev$prevalence*10/100)/176*100
no_niches_w5wed_dry_prev$scenario <- as.factor('XI_01')
no_niches_w5wed_dry_prev$water <- as.factor('Dry')
names(no_niches_w5wed_dry_prev) <- c('prevalence','scenario','water')

no_niches_w5wed_recombined_prev <- rbind(no_niches_w5wed_wet_prev, no_niches_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_No_Niches$loading_w6wed_conc_list
vector <- vector[vector!='[]']
no_niches_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_loading_w6wed_conc_list <- append(no_niches_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_loading_w6wed_conc_matrix <- matrix(unlist(no_niches_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_No_Niches$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
no_niches_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_cleaning_w6wed_conc_list <- append(no_niches_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_cleaning_w6wed_conc_matrix <- matrix(unlist(no_niches_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_No_Niches$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# no_niches_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   no_niches_drying_w6wed_conc_list <- append(no_niches_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_No_Niches$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
no_niches_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_sorting_w6wed_conc_list <- append(no_niches_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_sorting_w6wed_conc_matrix <- matrix(unlist(no_niches_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_No_Niches$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
no_niches_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_tray_packing_w6wed_conc_list <- append(no_niches_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_tray_packing_w6wed_conc_matrix <- matrix(unlist(no_niches_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_No_Niches$reject_w6wed_conc_list
vector <- vector[vector!='[]']
no_niches_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_reject_w6wed_conc_list <- append(no_niches_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_reject_w6wed_conc_matrix <- matrix(unlist(no_niches_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_No_Niches$other_w6wed_conc_list
vector <- vector[vector!='[]']
no_niches_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_other_w6wed_conc_list <- append(no_niches_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_other_w6wed_conc_matrix <- matrix(unlist(no_niches_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

no_niches_loading_concs <- as.data.frame(no_niches_loading_w6wed_conc_list)
no_niches_loading_concs$area <- as.factor('loading')
no_niches_loading_concs$scenario <- as.factor('XI_01')
no_niches_loading_concs$water <- as.factor('Wet')
names(no_niches_loading_concs) <- c('concentration','area','scenario','water')

no_niches_cleaning_concs <- as.data.frame(no_niches_cleaning_w6wed_conc_list)
no_niches_cleaning_concs$area <- as.factor('cleaning')
no_niches_cleaning_concs$scenario <- as.factor('XI_01')
no_niches_cleaning_concs$water <- as.factor('Wet')
names(no_niches_cleaning_concs) <- c('concentration','area','scenario','water')

no_niches_sorting_concs <- as.data.frame(no_niches_sorting_w6wed_conc_list)
no_niches_sorting_concs$area <- as.factor('sorting')
no_niches_sorting_concs$scenario <- as.factor('XI_01')
no_niches_sorting_concs$water <- as.factor('Dry')
names(no_niches_sorting_concs) <- c('concentration','area','scenario','water')

no_niches_reject_concs <- as.data.frame(no_niches_reject_w6wed_conc_list)
no_niches_reject_concs$area <- as.factor('reject')
no_niches_reject_concs$scenario <- as.factor('XI_01')
no_niches_reject_concs$water <- as.factor('Dry')
names(no_niches_reject_concs) <- c('concentration','area','scenario','water')

no_niches_tray_packing_concs <- as.data.frame(no_niches_tray_packing_w6wed_conc_list)
no_niches_tray_packing_concs$area <- as.factor('tray packing')
no_niches_tray_packing_concs$scenario <- as.factor('XI_01')
no_niches_tray_packing_concs$water <- as.factor('Dry')
names(no_niches_tray_packing_concs) <- c('concentration','area','scenario','water')

no_niches_other_concs <- as.data.frame(no_niches_other_w6wed_conc_list)
no_niches_other_concs$area <- as.factor('other')
no_niches_other_concs$scenario <- as.factor('XI_01')
no_niches_other_concs$water <- as.factor('Dry')
names(no_niches_other_concs) <- c('concentration','area','scenario','water')

no_niches_w6wed_concs <- rbind(no_niches_loading_concs,no_niches_cleaning_concs,no_niches_sorting_concs,no_niches_tray_packing_concs,no_niches_reject_concs,no_niches_other_concs)

no_niches_loading_prev <- as.data.frame(NL_table_No_Niches$loading_w6wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_loading_prev$area <- as.factor('loading')
no_niches_loading_prev$scenario <- as.factor('XI_01')
no_niches_loading_prev$water <- as.factor('Wet')
names(no_niches_loading_prev) <- c('prevalence','area','scenario','water')

no_niches_cleaning_prev <- as.data.frame(NL_table_No_Niches$cleaning_w6wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_cleaning_prev$area <- as.factor('cleaning')
no_niches_cleaning_prev$scenario <- as.factor('XI_01')
no_niches_cleaning_prev$water <- as.factor('Wet')
names(no_niches_cleaning_prev) <- c('prevalence','area','scenario','water')

no_niches_sorting_prev <- as.data.frame(NL_table_No_Niches$sorting_w6wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_sorting_prev$area <- as.factor('sorting')
no_niches_sorting_prev$scenario <- as.factor('XI_01')
no_niches_sorting_prev$water <- as.factor('Dry')
names(no_niches_sorting_prev) <- c('prevalence','area','scenario','water')

no_niches_reject_prev <- as.data.frame(NL_table_No_Niches$reject_w6wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_reject_prev$area <- as.factor('reject')
no_niches_reject_prev$scenario <- as.factor('XI_01')
no_niches_reject_prev$water <- as.factor('Dry')
names(no_niches_reject_prev) <- c('prevalence','area','scenario','water')

no_niches_tray_packing_prev <- as.data.frame(NL_table_No_Niches$tray_packing_w6wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_tray_packing_prev$area <- as.factor('tray packing')
no_niches_tray_packing_prev$scenario <- as.factor('XI_01')
no_niches_tray_packing_prev$water <- as.factor('Dry')
names(no_niches_tray_packing_prev) <- c('prevalence','area','scenario','water')

no_niches_other_prev <- as.data.frame(NL_table_No_Niches$other_w6wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_other_prev$area <- as.factor('other')
no_niches_other_prev$scenario <- as.factor('XI_01')
no_niches_other_prev$water <- as.factor('Dry')
names(no_niches_other_prev) <- c('prevalence','area','scenario','water')

no_niches_w6wed_prev <- rbind(no_niches_loading_prev,no_niches_cleaning_prev,no_niches_sorting_prev,no_niches_tray_packing_prev,no_niches_reject_prev,no_niches_other_prev)

no_niches_w6wed_wet_prev <- as.data.frame(no_niches_loading_prev$prevalence*21/100+no_niches_cleaning_prev$prevalence*28/100)/49*100
no_niches_w6wed_wet_prev$scenario <- as.factor('XI_01')
no_niches_w6wed_wet_prev$water <- as.factor('Wet')
names(no_niches_w6wed_wet_prev) <- c('prevalence','scenario','water')

no_niches_w6wed_dry_prev <- as.data.frame(no_niches_sorting_prev$prevalence*20/100+no_niches_reject_prev$prevalence*23/100+no_niches_tray_packing_prev$prevalence*123/100+no_niches_other_prev$prevalence*10/100)/176*100
no_niches_w6wed_dry_prev$scenario <- as.factor('XI_01')
no_niches_w6wed_dry_prev$water <- as.factor('Dry')
names(no_niches_w6wed_dry_prev) <- c('prevalence','scenario','water')

no_niches_w6wed_recombined_prev <- rbind(no_niches_w6wed_wet_prev, no_niches_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_No_Niches$loading_w7wed_conc_list
vector <- vector[vector!='[]']
no_niches_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_loading_w7wed_conc_list <- append(no_niches_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_loading_w7wed_conc_matrix <- matrix(unlist(no_niches_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_No_Niches$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
no_niches_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_cleaning_w7wed_conc_list <- append(no_niches_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_cleaning_w7wed_conc_matrix <- matrix(unlist(no_niches_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_No_Niches$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# no_niches_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   no_niches_drying_w7wed_conc_list <- append(no_niches_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_No_Niches$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
no_niches_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_sorting_w7wed_conc_list <- append(no_niches_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_sorting_w7wed_conc_matrix <- matrix(unlist(no_niches_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_No_Niches$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
no_niches_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_tray_packing_w7wed_conc_list <- append(no_niches_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_tray_packing_w7wed_conc_matrix <- matrix(unlist(no_niches_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_No_Niches$reject_w7wed_conc_list
vector <- vector[vector!='[]']
no_niches_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_reject_w7wed_conc_list <- append(no_niches_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_reject_w7wed_conc_matrix <- matrix(unlist(no_niches_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_No_Niches$other_w7wed_conc_list
vector <- vector[vector!='[]']
no_niches_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_other_w7wed_conc_list <- append(no_niches_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_other_w7wed_conc_matrix <- matrix(unlist(no_niches_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

no_niches_loading_concs <- as.data.frame(no_niches_loading_w7wed_conc_list)
no_niches_loading_concs$area <- as.factor('loading')
no_niches_loading_concs$scenario <- as.factor('XI_01')
no_niches_loading_concs$water <- as.factor('Wet')
names(no_niches_loading_concs) <- c('concentration','area','scenario','water')

no_niches_cleaning_concs <- as.data.frame(no_niches_cleaning_w7wed_conc_list)
no_niches_cleaning_concs$area <- as.factor('cleaning')
no_niches_cleaning_concs$scenario <- as.factor('XI_01')
no_niches_cleaning_concs$water <- as.factor('Wet')
names(no_niches_cleaning_concs) <- c('concentration','area','scenario','water')

no_niches_sorting_concs <- as.data.frame(no_niches_sorting_w7wed_conc_list)
no_niches_sorting_concs$area <- as.factor('sorting')
no_niches_sorting_concs$scenario <- as.factor('XI_01')
no_niches_sorting_concs$water <- as.factor('Dry')
names(no_niches_sorting_concs) <- c('concentration','area','scenario','water')

no_niches_reject_concs <- as.data.frame(no_niches_reject_w7wed_conc_list)
no_niches_reject_concs$area <- as.factor('reject')
no_niches_reject_concs$scenario <- as.factor('XI_01')
no_niches_reject_concs$water <- as.factor('Dry')
names(no_niches_reject_concs) <- c('concentration','area','scenario','water')

no_niches_tray_packing_concs <- as.data.frame(no_niches_tray_packing_w7wed_conc_list)
no_niches_tray_packing_concs$area <- as.factor('tray packing')
no_niches_tray_packing_concs$scenario <- as.factor('XI_01')
no_niches_tray_packing_concs$water <- as.factor('Dry')
names(no_niches_tray_packing_concs) <- c('concentration','area','scenario','water')

no_niches_other_concs <- as.data.frame(no_niches_other_w7wed_conc_list)
no_niches_other_concs$area <- as.factor('other')
no_niches_other_concs$scenario <- as.factor('XI_01')
no_niches_other_concs$water <- as.factor('Dry')
names(no_niches_other_concs) <- c('concentration','area','scenario','water')

no_niches_w7wed_concs <- rbind(no_niches_loading_concs,no_niches_cleaning_concs,no_niches_sorting_concs,no_niches_tray_packing_concs,no_niches_reject_concs,no_niches_other_concs)

no_niches_loading_prev <- as.data.frame(NL_table_No_Niches$loading_w7wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_loading_prev$area <- as.factor('loading')
no_niches_loading_prev$scenario <- as.factor('XI_01')
no_niches_loading_prev$water <- as.factor('Wet')
names(no_niches_loading_prev) <- c('prevalence','area','scenario','water')

no_niches_cleaning_prev <- as.data.frame(NL_table_No_Niches$cleaning_w7wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_cleaning_prev$area <- as.factor('cleaning')
no_niches_cleaning_prev$scenario <- as.factor('XI_01')
no_niches_cleaning_prev$water <- as.factor('Wet')
names(no_niches_cleaning_prev) <- c('prevalence','area','scenario','water')

no_niches_sorting_prev <- as.data.frame(NL_table_No_Niches$sorting_w7wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_sorting_prev$area <- as.factor('sorting')
no_niches_sorting_prev$scenario <- as.factor('XI_01')
no_niches_sorting_prev$water <- as.factor('Dry')
names(no_niches_sorting_prev) <- c('prevalence','area','scenario','water')

no_niches_reject_prev <- as.data.frame(NL_table_No_Niches$reject_w7wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_reject_prev$area <- as.factor('reject')
no_niches_reject_prev$scenario <- as.factor('XI_01')
no_niches_reject_prev$water <- as.factor('Dry')
names(no_niches_reject_prev) <- c('prevalence','area','scenario','water')

no_niches_tray_packing_prev <- as.data.frame(NL_table_No_Niches$tray_packing_w7wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_tray_packing_prev$area <- as.factor('tray packing')
no_niches_tray_packing_prev$scenario <- as.factor('XI_01')
no_niches_tray_packing_prev$water <- as.factor('Dry')
names(no_niches_tray_packing_prev) <- c('prevalence','area','scenario','water')

no_niches_other_prev <- as.data.frame(NL_table_No_Niches$other_w7wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_other_prev$area <- as.factor('other')
no_niches_other_prev$scenario <- as.factor('XI_01')
no_niches_other_prev$water <- as.factor('Dry')
names(no_niches_other_prev) <- c('prevalence','area','scenario','water')

no_niches_w7wed_prev <- rbind(no_niches_loading_prev,no_niches_cleaning_prev,no_niches_sorting_prev,no_niches_tray_packing_prev,no_niches_reject_prev,no_niches_other_prev)

no_niches_w7wed_wet_prev <- as.data.frame(no_niches_loading_prev$prevalence*21/100+no_niches_cleaning_prev$prevalence*28/100)/49*100
no_niches_w7wed_wet_prev$scenario <- as.factor('XI_01')
no_niches_w7wed_wet_prev$water <- as.factor('Wet')
names(no_niches_w7wed_wet_prev) <- c('prevalence','scenario','water')

no_niches_w7wed_dry_prev <- as.data.frame(no_niches_sorting_prev$prevalence*20/100+no_niches_reject_prev$prevalence*23/100+no_niches_tray_packing_prev$prevalence*123/100+no_niches_other_prev$prevalence*10/100)/176*100
no_niches_w7wed_dry_prev$scenario <- as.factor('XI_01')
no_niches_w7wed_dry_prev$water <- as.factor('Dry')
names(no_niches_w7wed_dry_prev) <- c('prevalence','scenario','water')

no_niches_w7wed_recombined_prev <- rbind(no_niches_w7wed_wet_prev, no_niches_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_No_Niches$loading_w8wed_conc_list
vector <- vector[vector!='[]']
no_niches_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_loading_w8wed_conc_list <- append(no_niches_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_loading_w8wed_conc_matrix <- matrix(unlist(no_niches_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_No_Niches$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
no_niches_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_cleaning_w8wed_conc_list <- append(no_niches_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_cleaning_w8wed_conc_matrix <- matrix(unlist(no_niches_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_No_Niches$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# no_niches_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   no_niches_drying_w8wed_conc_list <- append(no_niches_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_No_Niches$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
no_niches_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_sorting_w8wed_conc_list <- append(no_niches_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_sorting_w8wed_conc_matrix <- matrix(unlist(no_niches_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_No_Niches$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
no_niches_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_tray_packing_w8wed_conc_list <- append(no_niches_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_tray_packing_w8wed_conc_matrix <- matrix(unlist(no_niches_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_No_Niches$reject_w8wed_conc_list
vector <- vector[vector!='[]']
no_niches_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_reject_w8wed_conc_list <- append(no_niches_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_reject_w8wed_conc_matrix <- matrix(unlist(no_niches_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_No_Niches$other_w8wed_conc_list
vector <- vector[vector!='[]']
no_niches_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  no_niches_other_w8wed_conc_list <- append(no_niches_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
no_niches_other_w8wed_conc_matrix <- matrix(unlist(no_niches_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

no_niches_loading_concs <- as.data.frame(no_niches_loading_w8wed_conc_list)
no_niches_loading_concs$area <- as.factor('loading')
no_niches_loading_concs$scenario <- as.factor('XI_01')
no_niches_loading_concs$water <- as.factor('Wet')
names(no_niches_loading_concs) <- c('concentration','area','scenario','water')

no_niches_cleaning_concs <- as.data.frame(no_niches_cleaning_w8wed_conc_list)
no_niches_cleaning_concs$area <- as.factor('cleaning')
no_niches_cleaning_concs$scenario <- as.factor('XI_01')
no_niches_cleaning_concs$water <- as.factor('Wet')
names(no_niches_cleaning_concs) <- c('concentration','area','scenario','water')

no_niches_sorting_concs <- as.data.frame(no_niches_sorting_w8wed_conc_list)
no_niches_sorting_concs$area <- as.factor('sorting')
no_niches_sorting_concs$scenario <- as.factor('XI_01')
no_niches_sorting_concs$water <- as.factor('Dry')
names(no_niches_sorting_concs) <- c('concentration','area','scenario','water')

no_niches_reject_concs <- as.data.frame(no_niches_reject_w8wed_conc_list)
no_niches_reject_concs$area <- as.factor('reject')
no_niches_reject_concs$scenario <- as.factor('XI_01')
no_niches_reject_concs$water <- as.factor('Dry')
names(no_niches_reject_concs) <- c('concentration','area','scenario','water')

no_niches_tray_packing_concs <- as.data.frame(no_niches_tray_packing_w8wed_conc_list)
no_niches_tray_packing_concs$area <- as.factor('tray packing')
no_niches_tray_packing_concs$scenario <- as.factor('XI_01')
no_niches_tray_packing_concs$water <- as.factor('Dry')
names(no_niches_tray_packing_concs) <- c('concentration','area','scenario','water')

no_niches_other_concs <- as.data.frame(no_niches_other_w8wed_conc_list)
no_niches_other_concs$area <- as.factor('other')
no_niches_other_concs$scenario <- as.factor('XI_01')
no_niches_other_concs$water <- as.factor('Dry')
names(no_niches_other_concs) <- c('concentration','area','scenario','water')

no_niches_w8wed_concs <- rbind(no_niches_loading_concs,no_niches_cleaning_concs,no_niches_sorting_concs,no_niches_tray_packing_concs,no_niches_reject_concs,no_niches_other_concs)

no_niches_loading_prev <- as.data.frame(NL_table_No_Niches$loading_w8wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_loading_prev$area <- as.factor('loading')
no_niches_loading_prev$scenario <- as.factor('XI_01')
no_niches_loading_prev$water <- as.factor('Wet')
names(no_niches_loading_prev) <- c('prevalence','area','scenario','water')

no_niches_cleaning_prev <- as.data.frame(NL_table_No_Niches$cleaning_w8wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_cleaning_prev$area <- as.factor('cleaning')
no_niches_cleaning_prev$scenario <- as.factor('XI_01')
no_niches_cleaning_prev$water <- as.factor('Wet')
names(no_niches_cleaning_prev) <- c('prevalence','area','scenario','water')

no_niches_sorting_prev <- as.data.frame(NL_table_No_Niches$sorting_w8wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_sorting_prev$area <- as.factor('sorting')
no_niches_sorting_prev$scenario <- as.factor('XI_01')
no_niches_sorting_prev$water <- as.factor('Dry')
names(no_niches_sorting_prev) <- c('prevalence','area','scenario','water')

no_niches_reject_prev <- as.data.frame(NL_table_No_Niches$reject_w8wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_reject_prev$area <- as.factor('reject')
no_niches_reject_prev$scenario <- as.factor('XI_01')
no_niches_reject_prev$water <- as.factor('Dry')
names(no_niches_reject_prev) <- c('prevalence','area','scenario','water')

no_niches_tray_packing_prev <- as.data.frame(NL_table_No_Niches$tray_packing_w8wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_tray_packing_prev$area <- as.factor('tray packing')
no_niches_tray_packing_prev$scenario <- as.factor('XI_01')
no_niches_tray_packing_prev$water <- as.factor('Dry')
names(no_niches_tray_packing_prev) <- c('prevalence','area','scenario','water')

no_niches_other_prev <- as.data.frame(NL_table_No_Niches$other_w8wed_prev[order(NL_table_No_Niches$local_seed)])
no_niches_other_prev$area <- as.factor('other')
no_niches_other_prev$scenario <- as.factor('XI_01')
no_niches_other_prev$water <- as.factor('Dry')
names(no_niches_other_prev) <- c('prevalence','area','scenario','water')

no_niches_w8wed_prev <- rbind(no_niches_loading_prev,no_niches_cleaning_prev,no_niches_sorting_prev,no_niches_tray_packing_prev,no_niches_reject_prev,no_niches_other_prev)

no_niches_w8wed_wet_prev <- as.data.frame(no_niches_loading_prev$prevalence*21/100+no_niches_cleaning_prev$prevalence*28/100)/49*100
no_niches_w8wed_wet_prev$scenario <- as.factor('XI_01')
no_niches_w8wed_wet_prev$water <- as.factor('Wet')
names(no_niches_w8wed_wet_prev) <- c('prevalence','scenario','water')

no_niches_w8wed_dry_prev <- as.data.frame(no_niches_sorting_prev$prevalence*20/100+no_niches_reject_prev$prevalence*23/100+no_niches_tray_packing_prev$prevalence*123/100+no_niches_other_prev$prevalence*10/100)/176*100
no_niches_w8wed_dry_prev$scenario <- as.factor('XI_01')
no_niches_w8wed_dry_prev$water <- as.factor('Dry')
names(no_niches_w8wed_dry_prev) <- c('prevalence','scenario','water')

no_niches_w8wed_recombined_prev <- rbind(no_niches_w8wed_wet_prev, no_niches_w8wed_dry_prev)

vector <- NL_table_No_Niches$lifetime_conc_list[order(NL_table_No_Niches$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

no_niches_w1wed_recombined_prev$week <- as.factor(1)
no_niches_w2wed_recombined_prev$week <- as.factor(2)
no_niches_w3wed_recombined_prev$week <- as.factor(3)
no_niches_w4wed_recombined_prev$week <- as.factor(4)
no_niches_w5wed_recombined_prev$week <- as.factor(5)
no_niches_w6wed_recombined_prev$week <- as.factor(6)
no_niches_w7wed_recombined_prev$week <- as.factor(7)
no_niches_w8wed_recombined_prev$week <- as.factor(8)
no_niches_allwed_prev <- rbind(no_niches_w1wed_recombined_prev,no_niches_w2wed_recombined_prev,no_niches_w3wed_recombined_prev,no_niches_w4wed_recombined_prev,no_niches_w5wed_recombined_prev,no_niches_w6wed_recombined_prev,no_niches_w7wed_recombined_prev,no_niches_w8wed_recombined_prev)

Facility_B_no_niches_agents_melted <- melt(mdarray)
colnames(Facility_B_no_niches_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_no_niches_agents_melted$agent <- Facility_B_no_niches_agents_melted$agent-1
Facility_B_no_niches_agents_melted$logical <- Facility_B_no_niches_agents_melted$value>0
Facility_B_no_niches_agents_melted$binary <- as.numeric(Facility_B_no_niches_agents_melted$logical)
Facility_B_no_niches_agents_melted$log10value <- log10(Facility_B_no_niches_agents_melted$value)
Facility_B_no_niches_agents_melted$log10value[is.infinite(Facility_B_no_niches_agents_melted$log10value)] <- 0

agent <- Facility_B_no_niches_agents_melted$agent
iteration <- Facility_B_no_niches_agents_melted$iteration
tick <- Facility_B_no_niches_agents_melted$tick
rle_matrix <- tapply(Facility_B_no_niches_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_no_niches_mean_value_matrix <- tapply(Facility_B_no_niches_agents_melted$value, list(agent, tick), mean)
Facility_B_no_niches_median_value_matrix <- tapply(Facility_B_no_niches_agents_melted$value, list(agent, tick), median)
x <- Facility_B_no_niches_agents_melted
x$value[x$value==0] <- NA
Facility_B_no_niches_pos_median_value_matrix <- tapply(x$value, list(agent, tick), median, na.rm=TRUE)
Facility_B_no_niches_prob_value_matrix <- tapply(Facility_B_no_niches_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

#Maximum sensitivity####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_no_niches <- durations

agents_list_no_niches <- read.table(paste0(getwd(),'/Data/Agents - No Niches.txt'))
agents_list_no_niches <- agents_list_no_niches[,c("V1","V7","V8","V9")]
colnames(agents_list_no_niches) <- c("name","sanitation_status","schedule","area")
#Time to persistence
agents_list_no_niches$time_to_persistence <- rep((168*2),225)
agents_list_no_niches$time_to_persistence[agents_list_no_niches$schedule=="daily"] <- (24*2)

persistent_short_durations_list_no_niches <- data.frame()
persistent_long_durations_list_no_niches <- data.frame()
persistent_uncleanable_durations_list_no_niches <- data.frame()
transient_short_durations_list_no_niches <- data.frame()
transient_long_durations_list_no_niches <- data.frame()
transient_uncleanable_durations_list_no_niches <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_no_niches$min_duration[agent] <- ifelse(length(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent])==0,NA,min(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_no_niches$mean_duration[agent] <- ifelse(length(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent])==0,NA,mean(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_no_niches$median_duration[agent] <- ifelse(length(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent])==0,NA,median(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_no_niches$max_duration[agent] <- ifelse(length(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent])==0,NA,max(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_no_niches$contamination_events[agent] <- sum(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_no_niches$times_persistent[agent] <- sum(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent]>agents_list_no_niches$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_no_niches$q1_duration[agent] <- quantile(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_no_niches$q3_duration[agent] <- quantile(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_no_niches$min_persistent_duration[agent] <- ifelse((length(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent])==0) || (agents_list_no_niches$times_persistent[agent]==0),NA,min(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent & Facility_B_durations_no_niches$duration>=agents_list_no_niches$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_no_niches$mean_persistent_duration[agent] <- ifelse((length(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent])==0) || (agents_list_no_niches$times_persistent[agent]==0),NA,mean(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent & Facility_B_durations_no_niches$duration>=agents_list_no_niches$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_no_niches$median_persistent_duration[agent] <- ifelse((length(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent])==0) || (agents_list_no_niches$times_persistent[agent]==0),NA,median(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent & Facility_B_durations_no_niches$duration>=agents_list_no_niches$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_no_niches$max_persistent_duration[agent] <- ifelse((length(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent])==0) || (agents_list_no_niches$times_persistent[agent]==0),NA,max(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent & Facility_B_durations_no_niches$duration>=agents_list_no_niches$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_no_niches$q1_persistent_duration[agent] <- ifelse((length(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent])==0) || (agents_list_no_niches$times_persistent[agent]==0),NA,quantile(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent & Facility_B_durations_no_niches$duration>=agents_list_no_niches$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_no_niches$q3_persistent_duration[agent] <- ifelse((length(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent])==0) || (agents_list_no_niches$times_persistent[agent]==0),NA,quantile(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent & Facility_B_durations_no_niches$duration>=agents_list_no_niches$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations
  x <- Facility_B_durations_no_niches[which(Facility_B_durations_no_niches$agent==agent & Facility_B_durations_no_niches$duration>agents_list_no_niches$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean
  agents_list_no_niches$mean_times_persistent[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_no_niches$mean_times_persistent[which(is.na(agents_list_no_niches$mean_times_persistent))] <- 0
  #Division by total number of iterations in simulation
  agents_list_no_niches$balanced_times_persistent[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_no_niches$duration[Facility_B_durations_no_niches$agent==agent])!=0) || (agents_list_no_niches$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_no_niches$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_no_niches <- rbind(
        persistent_short_durations_list_no_niches,
        Facility_B_durations_no_niches[Facility_B_durations_no_niches$agent==agent & Facility_B_durations_no_niches$duration>agents_list_no_niches$time_to_persistence[agent],]
      )
    } else if(agents_list_no_niches$time_to_persistence[agent]==336 && agents_list_no_niches$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_no_niches <- rbind(
        persistent_long_durations_list_no_niches,
        Facility_B_durations_no_niches[Facility_B_durations_no_niches$agent==agent & Facility_B_durations_no_niches$duration>agents_list_no_niches$time_to_persistence[agent],]
      )
    } else if(agents_list_no_niches$time_to_persistence[agent]==336 && agents_list_no_niches$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_no_niches <- rbind(
        persistent_uncleanable_durations_list_no_niches,
        Facility_B_durations_no_niches[Facility_B_durations_no_niches$agent==agent & Facility_B_durations_no_niches$duration>agents_list_no_niches$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_no_niches$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_no_niches <- rbind(
      transient_short_durations_list_no_niches,
      Facility_B_durations_no_niches[Facility_B_durations_no_niches$agent==agent & Facility_B_durations_no_niches$duration<=agents_list_no_niches$time_to_persistence[agent],]
    )
  } else if(agents_list_no_niches$time_to_persistence[agent]==336 && agents_list_no_niches$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_no_niches <- rbind(
      transient_long_durations_list_no_niches,
      Facility_B_durations_no_niches[Facility_B_durations_no_niches$agent==agent & Facility_B_durations_no_niches$duration<=agents_list_no_niches$time_to_persistence[agent],]
    )
  } else if(agents_list_no_niches$time_to_persistence[agent]==336 && agents_list_no_niches$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_no_niches <- rbind(
      transient_uncleanable_durations_list_no_niches,
      Facility_B_durations_no_niches[Facility_B_durations_no_niches$agent==agent & Facility_B_durations_no_niches$duration<=agents_list_no_niches$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

#10 cells minimum####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>9)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_no_niches_10min <- durations

persistent_short_durations_list_no_niches_10min <- data.frame()
persistent_long_durations_list_no_niches_10min <- data.frame()
persistent_uncleanable_durations_list_no_niches_10min <- data.frame()
transient_short_durations_list_no_niches_10min <- data.frame()
transient_long_durations_list_no_niches_10min <- data.frame()
transient_uncleanable_durations_list_no_niches_10min <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_no_niches$min_duration_10min[agent] <- ifelse(length(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent])==0,NA,min(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_no_niches$mean_duration_10min[agent] <- ifelse(length(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent])==0,NA,mean(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_no_niches$median_duration_10min[agent] <- ifelse(length(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent])==0,NA,median(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_no_niches$max_duration_10min[agent] <- ifelse(length(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent])==0,NA,max(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_no_niches$contamination_events_10min[agent] <- sum(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_no_niches$times_persistent_10min[agent] <- sum(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent]>agents_list_no_niches$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_no_niches$q1_duration_10min[agent] <- quantile(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_no_niches$q3_duration_10min[agent] <- quantile(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_no_niches$min_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent])==0) || (agents_list_no_niches$times_persistent_10min[agent]==0),NA,min(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent & Facility_B_durations_no_niches_10min$duration>=agents_list_no_niches$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_no_niches$mean_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent])==0) || (agents_list_no_niches$times_persistent_10min[agent]==0),NA,mean(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent & Facility_B_durations_no_niches_10min$duration>=agents_list_no_niches$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_no_niches$median_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent])==0) || (agents_list_no_niches$times_persistent_10min[agent]==0),NA,median(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent & Facility_B_durations_no_niches_10min$duration>=agents_list_no_niches$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_no_niches$max_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent])==0) || (agents_list_no_niches$times_persistent_10min[agent]==0),NA,max(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent & Facility_B_durations_no_niches_10min$duration>=agents_list_no_niches$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_no_niches$q1_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent])==0) || (agents_list_no_niches$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent & Facility_B_durations_no_niches_10min$duration>=agents_list_no_niches$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_no_niches$q3_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent])==0) || (agents_list_no_niches$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent & Facility_B_durations_no_niches_10min$duration>=agents_list_no_niches$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations (Does not account for iterations with 0 events)
  x <- Facility_B_durations_no_niches_10min[which(Facility_B_durations_no_niches_10min$agent==agent & Facility_B_durations_no_niches_10min$duration>agents_list_no_niches$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean (Does account for iterations with 0 events)
  agents_list_no_niches$mean_times_persistent_10min[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_no_niches$mean_times_persistent_10min[which(is.na(agents_list_no_niches$mean_times_persistent_10min))] <- 0
  #Division by total number of iterations in simulation
  agents_list_no_niches$balanced_times_persistent_10min[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_no_niches_10min$duration[Facility_B_durations_no_niches_10min$agent==agent])!=0) || (agents_list_no_niches$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_no_niches$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_no_niches_10min <- rbind(
        persistent_short_durations_list_no_niches_10min,
        Facility_B_durations_no_niches_10min[Facility_B_durations_no_niches_10min$agent==agent & Facility_B_durations_no_niches_10min$duration>agents_list_no_niches$time_to_persistence[agent],]
      )
    } else if(agents_list_no_niches$time_to_persistence[agent]==336 && agents_list_no_niches$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_no_niches_10min <- rbind(
        persistent_long_durations_list_no_niches_10min,
        Facility_B_durations_no_niches_10min[Facility_B_durations_no_niches_10min$agent==agent & Facility_B_durations_no_niches_10min$duration>agents_list_no_niches$time_to_persistence[agent],]
      )
    } else if(agents_list_no_niches$time_to_persistence[agent]==336 && agents_list_no_niches$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_no_niches_10min <- rbind(
        persistent_uncleanable_durations_list_no_niches_10min,
        Facility_B_durations_no_niches_10min[Facility_B_durations_no_niches_10min$agent==agent & Facility_B_durations_no_niches_10min$duration>agents_list_no_niches$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_no_niches$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_no_niches_10min <- rbind(
      transient_short_durations_list_no_niches_10min,
      Facility_B_durations_no_niches_10min[Facility_B_durations_no_niches_10min$agent==agent & Facility_B_durations_no_niches_10min$duration<=agents_list_no_niches$time_to_persistence[agent],]
    )
  } else if(agents_list_no_niches$time_to_persistence[agent]==336 && agents_list_no_niches$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_no_niches_10min <- rbind(
      transient_long_durations_list_no_niches_10min,
      Facility_B_durations_no_niches_10min[Facility_B_durations_no_niches_10min$agent==agent & Facility_B_durations_no_niches_10min$duration<=agents_list_no_niches$time_to_persistence[agent],]
    )
  } else if(agents_list_no_niches$time_to_persistence[agent]==336 && agents_list_no_niches$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_no_niches_10min <- rbind(
      transient_uncleanable_durations_list_no_niches_10min,
      Facility_B_durations_no_niches_10min[Facility_B_durations_no_niches_10min$agent==agent & Facility_B_durations_no_niches_10min$duration<=agents_list_no_niches$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

# Facility_B_no_niches_agents_melted_monday_preop <- Facility_B_no_niches_agents_melted[which(Facility_B_no_niches_agents_melted$tick==33|Facility_B_no_niches_agents_melted$tick==201|Facility_B_no_niches_agents_melted$tick==369|Facility_B_no_niches_agents_melted$tick==537|Facility_B_no_niches_agents_melted$tick==705|Facility_B_no_niches_agents_melted$tick==873|Facility_B_no_niches_agents_melted$tick==1041|Facility_B_no_niches_agents_melted$tick==1209),]
# 
# Facility_B_no_niches_agents_melted_tuesday_preop <- Facility_B_no_niches_agents_melted[which(Facility_B_no_niches_agents_melted$tick==57|Facility_B_no_niches_agents_melted$tick==225|Facility_B_no_niches_agents_melted$tick==393|Facility_B_no_niches_agents_melted$tick==561|Facility_B_no_niches_agents_melted$tick==729|Facility_B_no_niches_agents_melted$tick==897|Facility_B_no_niches_agents_melted$tick==1065|Facility_B_no_niches_agents_melted$tick==1233),]
# 
# Facility_B_no_niches_agents_melted_wednesday_preop <- Facility_B_no_niches_agents_melted[which(Facility_B_no_niches_agents_melted$tick==81|Facility_B_no_niches_agents_melted$tick==249|Facility_B_no_niches_agents_melted$tick==417|Facility_B_no_niches_agents_melted$tick==585|Facility_B_no_niches_agents_melted$tick==753|Facility_B_no_niches_agents_melted$tick==921|Facility_B_no_niches_agents_melted$tick==1089|Facility_B_no_niches_agents_melted$tick==1257),]
# 
# Facility_B_no_niches_agents_melted_thursday_preop <- Facility_B_no_niches_agents_melted[which(Facility_B_no_niches_agents_melted$tick==105|Facility_B_no_niches_agents_melted$tick==273|Facility_B_no_niches_agents_melted$tick==441|Facility_B_no_niches_agents_melted$tick==609|Facility_B_no_niches_agents_melted$tick==777|Facility_B_no_niches_agents_melted$tick==945|Facility_B_no_niches_agents_melted$tick==1113|Facility_B_no_niches_agents_melted$tick==1281),]
# 
# Facility_B_no_niches_agents_melted_friday_preop <- Facility_B_no_niches_agents_melted[which(Facility_B_no_niches_agents_melted$tick==129|Facility_B_no_niches_agents_melted$tick==297|Facility_B_no_niches_agents_melted$tick==465|Facility_B_no_niches_agents_melted$tick==633|Facility_B_no_niches_agents_melted$tick==801|Facility_B_no_niches_agents_melted$tick==969|Facility_B_no_niches_agents_melted$tick==1137|Facility_B_no_niches_agents_melted$tick==1305),]

Facility_B_no_niches_agents_melted_ff <- as.ffdf(Facility_B_no_niches_agents_melted)
rm(Facility_B_no_niches_agents_melted)
gc()
```

```{r import Crate Prevalence 75%}
NL_table_Crate_Prev_75pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-28-16-05 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_Crate_Prev_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Crate_Prev_75pc <- NL_table_Crate_Prev_75pc[NL_table_Crate_Prev_75pc$scenario==9,]

while (any(grepl('-', names(NL_table_Crate_Prev_75pc), fixed = TRUE))) {
  NL_table_Crate_Prev_75pc <- NL_table_Crate_Prev_75pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Crate_Prev_75pc), fixed = TRUE))) {
  NL_table_Crate_Prev_75pc <- NL_table_Crate_Prev_75pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Crate_Prev_75pc), fixed = TRUE))) {
  NL_table_Crate_Prev_75pc <- NL_table_Crate_Prev_75pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Crate_Prev_75pc), fixed = TRUE))) {
  NL_table_Crate_Prev_75pc <- NL_table_Crate_Prev_75pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Crate_Prev_75pc[ , ..list_columns]

NL_table_Crate_Prev_75pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Crate_Prev_75pc <- as.data.frame(NL_table_Crate_Prev_75pc)

NL_table_Crate_Prev_75pc[NL_table_Crate_Prev_75pc==-1] <- NA

NL_table_Crate_Prev_75pc <- subset(NL_table_Crate_Prev_75pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Crate_Prev_75pc)[names(NL_table_Crate_Prev_75pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Crate_Prev_75pc)[names(NL_table_Crate_Prev_75pc)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Crate_Prev_75pc$loading_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_loading_w1wed_conc_list <- append(crate_prev_75pc_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_loading_w1wed_conc_matrix <- matrix(unlist(crate_prev_75pc_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_cleaning_w1wed_conc_list <- append(crate_prev_75pc_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_cleaning_w1wed_conc_matrix <- matrix(unlist(crate_prev_75pc_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_75pc$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_75pc_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_75pc_drying_w1wed_conc_list <- append(crate_prev_75pc_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_75pc$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_sorting_w1wed_conc_list <- append(crate_prev_75pc_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_sorting_w1wed_conc_matrix <- matrix(unlist(crate_prev_75pc_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_tray_packing_w1wed_conc_list <- append(crate_prev_75pc_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_tray_packing_w1wed_conc_matrix <- matrix(unlist(crate_prev_75pc_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$reject_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_reject_w1wed_conc_list <- append(crate_prev_75pc_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_reject_w1wed_conc_matrix <- matrix(unlist(crate_prev_75pc_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$other_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_other_w1wed_conc_list <- append(crate_prev_75pc_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_other_w1wed_conc_matrix <- matrix(unlist(crate_prev_75pc_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_75pc_loading_concs <- as.data.frame(crate_prev_75pc_loading_w1wed_conc_list)
crate_prev_75pc_loading_concs$area <- as.factor('loading')
crate_prev_75pc_loading_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_75pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_cleaning_concs <- as.data.frame(crate_prev_75pc_cleaning_w1wed_conc_list)
crate_prev_75pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_75pc_cleaning_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_75pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_sorting_concs <- as.data.frame(crate_prev_75pc_sorting_w1wed_conc_list)
crate_prev_75pc_sorting_concs$area <- as.factor('sorting')
crate_prev_75pc_sorting_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_75pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_reject_concs <- as.data.frame(crate_prev_75pc_reject_w1wed_conc_list)
crate_prev_75pc_reject_concs$area <- as.factor('reject')
crate_prev_75pc_reject_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_75pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_tray_packing_concs <- as.data.frame(crate_prev_75pc_tray_packing_w1wed_conc_list)
crate_prev_75pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_75pc_tray_packing_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_75pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_other_concs <- as.data.frame(crate_prev_75pc_other_w1wed_conc_list)
crate_prev_75pc_other_concs$area <- as.factor('other')
crate_prev_75pc_other_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_other_concs$water <- as.factor('Dry')
names(crate_prev_75pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_w1wed_concs <- rbind(crate_prev_75pc_loading_concs,crate_prev_75pc_cleaning_concs,crate_prev_75pc_sorting_concs,crate_prev_75pc_tray_packing_concs,crate_prev_75pc_reject_concs,crate_prev_75pc_other_concs)

crate_prev_75pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_75pc$loading_w1wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_loading_prev$area <- as.factor('loading')
crate_prev_75pc_loading_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_75pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_75pc$cleaning_w1wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_75pc_cleaning_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_75pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_75pc$sorting_w1wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_sorting_prev$area <- as.factor('sorting')
crate_prev_75pc_sorting_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_75pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_75pc$reject_w1wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_reject_prev$area <- as.factor('reject')
crate_prev_75pc_reject_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_75pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_75pc$tray_packing_w1wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_75pc_tray_packing_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_75pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_other_prev <- as.data.frame(NL_table_Crate_Prev_75pc$other_w1wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_other_prev$area <- as.factor('other')
crate_prev_75pc_other_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_other_prev$water <- as.factor('Dry')
names(crate_prev_75pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_w1wed_prev <- rbind(crate_prev_75pc_loading_prev,crate_prev_75pc_cleaning_prev,crate_prev_75pc_sorting_prev,crate_prev_75pc_tray_packing_prev,crate_prev_75pc_reject_prev,crate_prev_75pc_other_prev)

crate_prev_75pc_w1wed_wet_prev <- as.data.frame(crate_prev_75pc_loading_prev$prevalence*21/100+crate_prev_75pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_75pc_w1wed_wet_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_w1wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_75pc_w1wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_75pc_w1wed_dry_prev <- as.data.frame(crate_prev_75pc_sorting_prev$prevalence*20/100+crate_prev_75pc_reject_prev$prevalence*23/100+crate_prev_75pc_tray_packing_prev$prevalence*123/100+crate_prev_75pc_other_prev$prevalence*10/100)/176*100
crate_prev_75pc_w1wed_dry_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_w1wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_75pc_w1wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_75pc_w1wed_recombined_prev <- rbind(crate_prev_75pc_w1wed_wet_prev, crate_prev_75pc_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Crate_Prev_75pc$loading_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_loading_w2wed_conc_list <- append(crate_prev_75pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_loading_w2wed_conc_matrix <- matrix(unlist(crate_prev_75pc_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_cleaning_w2wed_conc_list <- append(crate_prev_75pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_cleaning_w2wed_conc_matrix <- matrix(unlist(crate_prev_75pc_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_75pc$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_75pc_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_75pc_drying_w2wed_conc_list <- append(crate_prev_75pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_75pc$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_sorting_w2wed_conc_list <- append(crate_prev_75pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_sorting_w2wed_conc_matrix <- matrix(unlist(crate_prev_75pc_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_tray_packing_w2wed_conc_list <- append(crate_prev_75pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_tray_packing_w2wed_conc_matrix <- matrix(unlist(crate_prev_75pc_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$reject_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_reject_w2wed_conc_list <- append(crate_prev_75pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_reject_w2wed_conc_matrix <- matrix(unlist(crate_prev_75pc_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$other_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_other_w2wed_conc_list <- append(crate_prev_75pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_other_w2wed_conc_matrix <- matrix(unlist(crate_prev_75pc_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_75pc_loading_concs <- as.data.frame(crate_prev_75pc_loading_w2wed_conc_list)
crate_prev_75pc_loading_concs$area <- as.factor('loading')
crate_prev_75pc_loading_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_75pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_cleaning_concs <- as.data.frame(crate_prev_75pc_cleaning_w2wed_conc_list)
crate_prev_75pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_75pc_cleaning_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_75pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_sorting_concs <- as.data.frame(crate_prev_75pc_sorting_w2wed_conc_list)
crate_prev_75pc_sorting_concs$area <- as.factor('sorting')
crate_prev_75pc_sorting_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_75pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_reject_concs <- as.data.frame(crate_prev_75pc_reject_w2wed_conc_list)
crate_prev_75pc_reject_concs$area <- as.factor('reject')
crate_prev_75pc_reject_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_75pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_tray_packing_concs <- as.data.frame(crate_prev_75pc_tray_packing_w2wed_conc_list)
crate_prev_75pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_75pc_tray_packing_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_75pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_other_concs <- as.data.frame(crate_prev_75pc_other_w2wed_conc_list)
crate_prev_75pc_other_concs$area <- as.factor('other')
crate_prev_75pc_other_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_other_concs$water <- as.factor('Dry')
names(crate_prev_75pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_w2wed_concs <- rbind(crate_prev_75pc_loading_concs,crate_prev_75pc_cleaning_concs,crate_prev_75pc_sorting_concs,crate_prev_75pc_tray_packing_concs,crate_prev_75pc_reject_concs,crate_prev_75pc_other_concs)

crate_prev_75pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_75pc$loading_w2wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_loading_prev$area <- as.factor('loading')
crate_prev_75pc_loading_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_75pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_75pc$cleaning_w2wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_75pc_cleaning_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_75pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_75pc$sorting_w2wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_sorting_prev$area <- as.factor('sorting')
crate_prev_75pc_sorting_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_75pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_75pc$reject_w2wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_reject_prev$area <- as.factor('reject')
crate_prev_75pc_reject_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_75pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_75pc$tray_packing_w2wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_75pc_tray_packing_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_75pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_other_prev <- as.data.frame(NL_table_Crate_Prev_75pc$other_w2wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_other_prev$area <- as.factor('other')
crate_prev_75pc_other_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_other_prev$water <- as.factor('Dry')
names(crate_prev_75pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_w2wed_prev <- rbind(crate_prev_75pc_loading_prev,crate_prev_75pc_cleaning_prev,crate_prev_75pc_sorting_prev,crate_prev_75pc_tray_packing_prev,crate_prev_75pc_reject_prev,crate_prev_75pc_other_prev)

crate_prev_75pc_w2wed_wet_prev <- as.data.frame(crate_prev_75pc_loading_prev$prevalence*21/100+crate_prev_75pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_75pc_w2wed_wet_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_w2wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_75pc_w2wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_75pc_w2wed_dry_prev <- as.data.frame(crate_prev_75pc_sorting_prev$prevalence*20/100+crate_prev_75pc_reject_prev$prevalence*23/100+crate_prev_75pc_tray_packing_prev$prevalence*123/100+crate_prev_75pc_other_prev$prevalence*10/100)/176*100
crate_prev_75pc_w2wed_dry_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_w2wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_75pc_w2wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_75pc_w2wed_recombined_prev <- rbind(crate_prev_75pc_w2wed_wet_prev, crate_prev_75pc_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Crate_Prev_75pc$loading_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_loading_w3wed_conc_list <- append(crate_prev_75pc_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_loading_w3wed_conc_matrix <- matrix(unlist(crate_prev_75pc_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_cleaning_w3wed_conc_list <- append(crate_prev_75pc_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_cleaning_w3wed_conc_matrix <- matrix(unlist(crate_prev_75pc_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_75pc$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_75pc_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_75pc_drying_w3wed_conc_list <- append(crate_prev_75pc_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_75pc$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_sorting_w3wed_conc_list <- append(crate_prev_75pc_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_sorting_w3wed_conc_matrix <- matrix(unlist(crate_prev_75pc_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_tray_packing_w3wed_conc_list <- append(crate_prev_75pc_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_tray_packing_w3wed_conc_matrix <- matrix(unlist(crate_prev_75pc_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$reject_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_reject_w3wed_conc_list <- append(crate_prev_75pc_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_reject_w3wed_conc_matrix <- matrix(unlist(crate_prev_75pc_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$other_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_other_w3wed_conc_list <- append(crate_prev_75pc_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_other_w3wed_conc_matrix <- matrix(unlist(crate_prev_75pc_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_75pc_loading_concs <- as.data.frame(crate_prev_75pc_loading_w3wed_conc_list)
crate_prev_75pc_loading_concs$area <- as.factor('loading')
crate_prev_75pc_loading_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_75pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_cleaning_concs <- as.data.frame(crate_prev_75pc_cleaning_w3wed_conc_list)
crate_prev_75pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_75pc_cleaning_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_75pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_sorting_concs <- as.data.frame(crate_prev_75pc_sorting_w3wed_conc_list)
crate_prev_75pc_sorting_concs$area <- as.factor('sorting')
crate_prev_75pc_sorting_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_75pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_reject_concs <- as.data.frame(crate_prev_75pc_reject_w3wed_conc_list)
crate_prev_75pc_reject_concs$area <- as.factor('reject')
crate_prev_75pc_reject_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_75pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_tray_packing_concs <- as.data.frame(crate_prev_75pc_tray_packing_w3wed_conc_list)
crate_prev_75pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_75pc_tray_packing_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_75pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_other_concs <- as.data.frame(crate_prev_75pc_other_w3wed_conc_list)
crate_prev_75pc_other_concs$area <- as.factor('other')
crate_prev_75pc_other_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_other_concs$water <- as.factor('Dry')
names(crate_prev_75pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_w3wed_concs <- rbind(crate_prev_75pc_loading_concs,crate_prev_75pc_cleaning_concs,crate_prev_75pc_sorting_concs,crate_prev_75pc_tray_packing_concs,crate_prev_75pc_reject_concs,crate_prev_75pc_other_concs)

crate_prev_75pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_75pc$loading_w3wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_loading_prev$area <- as.factor('loading')
crate_prev_75pc_loading_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_75pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_75pc$cleaning_w3wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_75pc_cleaning_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_75pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_75pc$sorting_w3wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_sorting_prev$area <- as.factor('sorting')
crate_prev_75pc_sorting_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_75pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_75pc$reject_w3wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_reject_prev$area <- as.factor('reject')
crate_prev_75pc_reject_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_75pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_75pc$tray_packing_w3wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_75pc_tray_packing_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_75pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_other_prev <- as.data.frame(NL_table_Crate_Prev_75pc$other_w3wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_other_prev$area <- as.factor('other')
crate_prev_75pc_other_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_other_prev$water <- as.factor('Dry')
names(crate_prev_75pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_w3wed_prev <- rbind(crate_prev_75pc_loading_prev,crate_prev_75pc_cleaning_prev,crate_prev_75pc_sorting_prev,crate_prev_75pc_tray_packing_prev,crate_prev_75pc_reject_prev,crate_prev_75pc_other_prev)

crate_prev_75pc_w3wed_wet_prev <- as.data.frame(crate_prev_75pc_loading_prev$prevalence*21/100+crate_prev_75pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_75pc_w3wed_wet_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_w3wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_75pc_w3wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_75pc_w3wed_dry_prev <- as.data.frame(crate_prev_75pc_sorting_prev$prevalence*20/100+crate_prev_75pc_reject_prev$prevalence*23/100+crate_prev_75pc_tray_packing_prev$prevalence*123/100+crate_prev_75pc_other_prev$prevalence*10/100)/176*100
crate_prev_75pc_w3wed_dry_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_w3wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_75pc_w3wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_75pc_w3wed_recombined_prev <- rbind(crate_prev_75pc_w3wed_wet_prev, crate_prev_75pc_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Crate_Prev_75pc$loading_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_loading_w4wed_conc_list <- append(crate_prev_75pc_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_loading_w4wed_conc_matrix <- matrix(unlist(crate_prev_75pc_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_cleaning_w4wed_conc_list <- append(crate_prev_75pc_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_cleaning_w4wed_conc_matrix <- matrix(unlist(crate_prev_75pc_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_75pc$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_75pc_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_75pc_drying_w4wed_conc_list <- append(crate_prev_75pc_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_75pc$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_sorting_w4wed_conc_list <- append(crate_prev_75pc_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_sorting_w4wed_conc_matrix <- matrix(unlist(crate_prev_75pc_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_tray_packing_w4wed_conc_list <- append(crate_prev_75pc_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_tray_packing_w4wed_conc_matrix <- matrix(unlist(crate_prev_75pc_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$reject_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_reject_w4wed_conc_list <- append(crate_prev_75pc_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_reject_w4wed_conc_matrix <- matrix(unlist(crate_prev_75pc_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$other_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_other_w4wed_conc_list <- append(crate_prev_75pc_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_other_w4wed_conc_matrix <- matrix(unlist(crate_prev_75pc_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_75pc_loading_concs <- as.data.frame(crate_prev_75pc_loading_w4wed_conc_list)
crate_prev_75pc_loading_concs$area <- as.factor('loading')
crate_prev_75pc_loading_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_75pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_cleaning_concs <- as.data.frame(crate_prev_75pc_cleaning_w4wed_conc_list)
crate_prev_75pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_75pc_cleaning_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_75pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_sorting_concs <- as.data.frame(crate_prev_75pc_sorting_w4wed_conc_list)
crate_prev_75pc_sorting_concs$area <- as.factor('sorting')
crate_prev_75pc_sorting_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_75pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_reject_concs <- as.data.frame(crate_prev_75pc_reject_w4wed_conc_list)
crate_prev_75pc_reject_concs$area <- as.factor('reject')
crate_prev_75pc_reject_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_75pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_tray_packing_concs <- as.data.frame(crate_prev_75pc_tray_packing_w4wed_conc_list)
crate_prev_75pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_75pc_tray_packing_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_75pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_other_concs <- as.data.frame(crate_prev_75pc_other_w4wed_conc_list)
crate_prev_75pc_other_concs$area <- as.factor('other')
crate_prev_75pc_other_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_other_concs$water <- as.factor('Dry')
names(crate_prev_75pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_w4wed_concs <- rbind(crate_prev_75pc_loading_concs,crate_prev_75pc_cleaning_concs,crate_prev_75pc_sorting_concs,crate_prev_75pc_tray_packing_concs,crate_prev_75pc_reject_concs,crate_prev_75pc_other_concs)

crate_prev_75pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_75pc$loading_w4wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_loading_prev$area <- as.factor('loading')
crate_prev_75pc_loading_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_75pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_75pc$cleaning_w4wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_75pc_cleaning_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_75pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_75pc$sorting_w4wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_sorting_prev$area <- as.factor('sorting')
crate_prev_75pc_sorting_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_75pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_75pc$reject_w4wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_reject_prev$area <- as.factor('reject')
crate_prev_75pc_reject_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_75pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_75pc$tray_packing_w4wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_75pc_tray_packing_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_75pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_other_prev <- as.data.frame(NL_table_Crate_Prev_75pc$other_w4wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_other_prev$area <- as.factor('other')
crate_prev_75pc_other_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_other_prev$water <- as.factor('Dry')
names(crate_prev_75pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_w4wed_prev <- rbind(crate_prev_75pc_loading_prev,crate_prev_75pc_cleaning_prev,crate_prev_75pc_sorting_prev,crate_prev_75pc_tray_packing_prev,crate_prev_75pc_reject_prev,crate_prev_75pc_other_prev)

crate_prev_75pc_w4wed_wet_prev <- as.data.frame(crate_prev_75pc_loading_prev$prevalence*21/100+crate_prev_75pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_75pc_w4wed_wet_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_w4wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_75pc_w4wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_75pc_w4wed_dry_prev <- as.data.frame(crate_prev_75pc_sorting_prev$prevalence*20/100+crate_prev_75pc_reject_prev$prevalence*23/100+crate_prev_75pc_tray_packing_prev$prevalence*123/100+crate_prev_75pc_other_prev$prevalence*10/100)/176*100
crate_prev_75pc_w4wed_dry_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_w4wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_75pc_w4wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_75pc_w4wed_recombined_prev <- rbind(crate_prev_75pc_w4wed_wet_prev, crate_prev_75pc_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Crate_Prev_75pc$loading_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_loading_w5wed_conc_list <- append(crate_prev_75pc_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_loading_w5wed_conc_matrix <- matrix(unlist(crate_prev_75pc_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_cleaning_w5wed_conc_list <- append(crate_prev_75pc_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_cleaning_w5wed_conc_matrix <- matrix(unlist(crate_prev_75pc_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_75pc$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_75pc_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_75pc_drying_w5wed_conc_list <- append(crate_prev_75pc_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_75pc$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_sorting_w5wed_conc_list <- append(crate_prev_75pc_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_sorting_w5wed_conc_matrix <- matrix(unlist(crate_prev_75pc_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_tray_packing_w5wed_conc_list <- append(crate_prev_75pc_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_tray_packing_w5wed_conc_matrix <- matrix(unlist(crate_prev_75pc_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$reject_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_reject_w5wed_conc_list <- append(crate_prev_75pc_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_reject_w5wed_conc_matrix <- matrix(unlist(crate_prev_75pc_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$other_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_other_w5wed_conc_list <- append(crate_prev_75pc_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_other_w5wed_conc_matrix <- matrix(unlist(crate_prev_75pc_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_75pc_loading_concs <- as.data.frame(crate_prev_75pc_loading_w5wed_conc_list)
crate_prev_75pc_loading_concs$area <- as.factor('loading')
crate_prev_75pc_loading_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_75pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_cleaning_concs <- as.data.frame(crate_prev_75pc_cleaning_w5wed_conc_list)
crate_prev_75pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_75pc_cleaning_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_75pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_sorting_concs <- as.data.frame(crate_prev_75pc_sorting_w5wed_conc_list)
crate_prev_75pc_sorting_concs$area <- as.factor('sorting')
crate_prev_75pc_sorting_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_75pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_reject_concs <- as.data.frame(crate_prev_75pc_reject_w5wed_conc_list)
crate_prev_75pc_reject_concs$area <- as.factor('reject')
crate_prev_75pc_reject_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_75pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_tray_packing_concs <- as.data.frame(crate_prev_75pc_tray_packing_w5wed_conc_list)
crate_prev_75pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_75pc_tray_packing_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_75pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_other_concs <- as.data.frame(crate_prev_75pc_other_w5wed_conc_list)
crate_prev_75pc_other_concs$area <- as.factor('other')
crate_prev_75pc_other_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_other_concs$water <- as.factor('Dry')
names(crate_prev_75pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_w5wed_concs <- rbind(crate_prev_75pc_loading_concs,crate_prev_75pc_cleaning_concs,crate_prev_75pc_sorting_concs,crate_prev_75pc_tray_packing_concs,crate_prev_75pc_reject_concs,crate_prev_75pc_other_concs)

crate_prev_75pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_75pc$loading_w5wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_loading_prev$area <- as.factor('loading')
crate_prev_75pc_loading_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_75pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_75pc$cleaning_w5wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_75pc_cleaning_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_75pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_75pc$sorting_w5wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_sorting_prev$area <- as.factor('sorting')
crate_prev_75pc_sorting_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_75pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_75pc$reject_w5wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_reject_prev$area <- as.factor('reject')
crate_prev_75pc_reject_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_75pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_75pc$tray_packing_w5wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_75pc_tray_packing_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_75pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_other_prev <- as.data.frame(NL_table_Crate_Prev_75pc$other_w5wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_other_prev$area <- as.factor('other')
crate_prev_75pc_other_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_other_prev$water <- as.factor('Dry')
names(crate_prev_75pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_w5wed_prev <- rbind(crate_prev_75pc_loading_prev,crate_prev_75pc_cleaning_prev,crate_prev_75pc_sorting_prev,crate_prev_75pc_tray_packing_prev,crate_prev_75pc_reject_prev,crate_prev_75pc_other_prev)

crate_prev_75pc_w5wed_wet_prev <- as.data.frame(crate_prev_75pc_loading_prev$prevalence*21/100+crate_prev_75pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_75pc_w5wed_wet_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_w5wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_75pc_w5wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_75pc_w5wed_dry_prev <- as.data.frame(crate_prev_75pc_sorting_prev$prevalence*20/100+crate_prev_75pc_reject_prev$prevalence*23/100+crate_prev_75pc_tray_packing_prev$prevalence*123/100+crate_prev_75pc_other_prev$prevalence*10/100)/176*100
crate_prev_75pc_w5wed_dry_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_w5wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_75pc_w5wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_75pc_w5wed_recombined_prev <- rbind(crate_prev_75pc_w5wed_wet_prev, crate_prev_75pc_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Crate_Prev_75pc$loading_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_loading_w6wed_conc_list <- append(crate_prev_75pc_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_loading_w6wed_conc_matrix <- matrix(unlist(crate_prev_75pc_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_cleaning_w6wed_conc_list <- append(crate_prev_75pc_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_cleaning_w6wed_conc_matrix <- matrix(unlist(crate_prev_75pc_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_75pc$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_75pc_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_75pc_drying_w6wed_conc_list <- append(crate_prev_75pc_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_75pc$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_sorting_w6wed_conc_list <- append(crate_prev_75pc_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_sorting_w6wed_conc_matrix <- matrix(unlist(crate_prev_75pc_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_tray_packing_w6wed_conc_list <- append(crate_prev_75pc_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_tray_packing_w6wed_conc_matrix <- matrix(unlist(crate_prev_75pc_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$reject_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_reject_w6wed_conc_list <- append(crate_prev_75pc_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_reject_w6wed_conc_matrix <- matrix(unlist(crate_prev_75pc_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$other_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_other_w6wed_conc_list <- append(crate_prev_75pc_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_other_w6wed_conc_matrix <- matrix(unlist(crate_prev_75pc_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_75pc_loading_concs <- as.data.frame(crate_prev_75pc_loading_w6wed_conc_list)
crate_prev_75pc_loading_concs$area <- as.factor('loading')
crate_prev_75pc_loading_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_75pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_cleaning_concs <- as.data.frame(crate_prev_75pc_cleaning_w6wed_conc_list)
crate_prev_75pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_75pc_cleaning_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_75pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_sorting_concs <- as.data.frame(crate_prev_75pc_sorting_w6wed_conc_list)
crate_prev_75pc_sorting_concs$area <- as.factor('sorting')
crate_prev_75pc_sorting_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_75pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_reject_concs <- as.data.frame(crate_prev_75pc_reject_w6wed_conc_list)
crate_prev_75pc_reject_concs$area <- as.factor('reject')
crate_prev_75pc_reject_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_75pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_tray_packing_concs <- as.data.frame(crate_prev_75pc_tray_packing_w6wed_conc_list)
crate_prev_75pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_75pc_tray_packing_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_75pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_other_concs <- as.data.frame(crate_prev_75pc_other_w6wed_conc_list)
crate_prev_75pc_other_concs$area <- as.factor('other')
crate_prev_75pc_other_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_other_concs$water <- as.factor('Dry')
names(crate_prev_75pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_w6wed_concs <- rbind(crate_prev_75pc_loading_concs,crate_prev_75pc_cleaning_concs,crate_prev_75pc_sorting_concs,crate_prev_75pc_tray_packing_concs,crate_prev_75pc_reject_concs,crate_prev_75pc_other_concs)

crate_prev_75pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_75pc$loading_w6wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_loading_prev$area <- as.factor('loading')
crate_prev_75pc_loading_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_75pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_75pc$cleaning_w6wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_75pc_cleaning_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_75pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_75pc$sorting_w6wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_sorting_prev$area <- as.factor('sorting')
crate_prev_75pc_sorting_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_75pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_75pc$reject_w6wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_reject_prev$area <- as.factor('reject')
crate_prev_75pc_reject_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_75pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_75pc$tray_packing_w6wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_75pc_tray_packing_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_75pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_other_prev <- as.data.frame(NL_table_Crate_Prev_75pc$other_w6wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_other_prev$area <- as.factor('other')
crate_prev_75pc_other_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_other_prev$water <- as.factor('Dry')
names(crate_prev_75pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_w6wed_prev <- rbind(crate_prev_75pc_loading_prev,crate_prev_75pc_cleaning_prev,crate_prev_75pc_sorting_prev,crate_prev_75pc_tray_packing_prev,crate_prev_75pc_reject_prev,crate_prev_75pc_other_prev)

crate_prev_75pc_w6wed_wet_prev <- as.data.frame(crate_prev_75pc_loading_prev$prevalence*21/100+crate_prev_75pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_75pc_w6wed_wet_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_w6wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_75pc_w6wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_75pc_w6wed_dry_prev <- as.data.frame(crate_prev_75pc_sorting_prev$prevalence*20/100+crate_prev_75pc_reject_prev$prevalence*23/100+crate_prev_75pc_tray_packing_prev$prevalence*123/100+crate_prev_75pc_other_prev$prevalence*10/100)/176*100
crate_prev_75pc_w6wed_dry_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_w6wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_75pc_w6wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_75pc_w6wed_recombined_prev <- rbind(crate_prev_75pc_w6wed_wet_prev, crate_prev_75pc_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Crate_Prev_75pc$loading_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_loading_w7wed_conc_list <- append(crate_prev_75pc_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_loading_w7wed_conc_matrix <- matrix(unlist(crate_prev_75pc_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_cleaning_w7wed_conc_list <- append(crate_prev_75pc_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_cleaning_w7wed_conc_matrix <- matrix(unlist(crate_prev_75pc_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_75pc$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_75pc_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_75pc_drying_w7wed_conc_list <- append(crate_prev_75pc_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_75pc$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_sorting_w7wed_conc_list <- append(crate_prev_75pc_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_sorting_w7wed_conc_matrix <- matrix(unlist(crate_prev_75pc_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_tray_packing_w7wed_conc_list <- append(crate_prev_75pc_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_tray_packing_w7wed_conc_matrix <- matrix(unlist(crate_prev_75pc_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$reject_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_reject_w7wed_conc_list <- append(crate_prev_75pc_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_reject_w7wed_conc_matrix <- matrix(unlist(crate_prev_75pc_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$other_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_other_w7wed_conc_list <- append(crate_prev_75pc_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_other_w7wed_conc_matrix <- matrix(unlist(crate_prev_75pc_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_75pc_loading_concs <- as.data.frame(crate_prev_75pc_loading_w7wed_conc_list)
crate_prev_75pc_loading_concs$area <- as.factor('loading')
crate_prev_75pc_loading_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_75pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_cleaning_concs <- as.data.frame(crate_prev_75pc_cleaning_w7wed_conc_list)
crate_prev_75pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_75pc_cleaning_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_75pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_sorting_concs <- as.data.frame(crate_prev_75pc_sorting_w7wed_conc_list)
crate_prev_75pc_sorting_concs$area <- as.factor('sorting')
crate_prev_75pc_sorting_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_75pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_reject_concs <- as.data.frame(crate_prev_75pc_reject_w7wed_conc_list)
crate_prev_75pc_reject_concs$area <- as.factor('reject')
crate_prev_75pc_reject_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_75pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_tray_packing_concs <- as.data.frame(crate_prev_75pc_tray_packing_w7wed_conc_list)
crate_prev_75pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_75pc_tray_packing_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_75pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_other_concs <- as.data.frame(crate_prev_75pc_other_w7wed_conc_list)
crate_prev_75pc_other_concs$area <- as.factor('other')
crate_prev_75pc_other_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_other_concs$water <- as.factor('Dry')
names(crate_prev_75pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_w7wed_concs <- rbind(crate_prev_75pc_loading_concs,crate_prev_75pc_cleaning_concs,crate_prev_75pc_sorting_concs,crate_prev_75pc_tray_packing_concs,crate_prev_75pc_reject_concs,crate_prev_75pc_other_concs)

crate_prev_75pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_75pc$loading_w7wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_loading_prev$area <- as.factor('loading')
crate_prev_75pc_loading_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_75pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_75pc$cleaning_w7wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_75pc_cleaning_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_75pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_75pc$sorting_w7wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_sorting_prev$area <- as.factor('sorting')
crate_prev_75pc_sorting_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_75pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_75pc$reject_w7wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_reject_prev$area <- as.factor('reject')
crate_prev_75pc_reject_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_75pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_75pc$tray_packing_w7wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_75pc_tray_packing_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_75pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_other_prev <- as.data.frame(NL_table_Crate_Prev_75pc$other_w7wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_other_prev$area <- as.factor('other')
crate_prev_75pc_other_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_other_prev$water <- as.factor('Dry')
names(crate_prev_75pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_w7wed_prev <- rbind(crate_prev_75pc_loading_prev,crate_prev_75pc_cleaning_prev,crate_prev_75pc_sorting_prev,crate_prev_75pc_tray_packing_prev,crate_prev_75pc_reject_prev,crate_prev_75pc_other_prev)

crate_prev_75pc_w7wed_wet_prev <- as.data.frame(crate_prev_75pc_loading_prev$prevalence*21/100+crate_prev_75pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_75pc_w7wed_wet_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_w7wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_75pc_w7wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_75pc_w7wed_dry_prev <- as.data.frame(crate_prev_75pc_sorting_prev$prevalence*20/100+crate_prev_75pc_reject_prev$prevalence*23/100+crate_prev_75pc_tray_packing_prev$prevalence*123/100+crate_prev_75pc_other_prev$prevalence*10/100)/176*100
crate_prev_75pc_w7wed_dry_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_w7wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_75pc_w7wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_75pc_w7wed_recombined_prev <- rbind(crate_prev_75pc_w7wed_wet_prev, crate_prev_75pc_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Crate_Prev_75pc$loading_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_loading_w8wed_conc_list <- append(crate_prev_75pc_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_loading_w8wed_conc_matrix <- matrix(unlist(crate_prev_75pc_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_cleaning_w8wed_conc_list <- append(crate_prev_75pc_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_cleaning_w8wed_conc_matrix <- matrix(unlist(crate_prev_75pc_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_75pc$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_75pc_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_75pc_drying_w8wed_conc_list <- append(crate_prev_75pc_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_75pc$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_sorting_w8wed_conc_list <- append(crate_prev_75pc_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_sorting_w8wed_conc_matrix <- matrix(unlist(crate_prev_75pc_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_tray_packing_w8wed_conc_list <- append(crate_prev_75pc_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_tray_packing_w8wed_conc_matrix <- matrix(unlist(crate_prev_75pc_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$reject_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_reject_w8wed_conc_list <- append(crate_prev_75pc_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_reject_w8wed_conc_matrix <- matrix(unlist(crate_prev_75pc_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_75pc$other_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_75pc_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_75pc_other_w8wed_conc_list <- append(crate_prev_75pc_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_75pc_other_w8wed_conc_matrix <- matrix(unlist(crate_prev_75pc_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_75pc_loading_concs <- as.data.frame(crate_prev_75pc_loading_w8wed_conc_list)
crate_prev_75pc_loading_concs$area <- as.factor('loading')
crate_prev_75pc_loading_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_75pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_cleaning_concs <- as.data.frame(crate_prev_75pc_cleaning_w8wed_conc_list)
crate_prev_75pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_75pc_cleaning_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_75pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_sorting_concs <- as.data.frame(crate_prev_75pc_sorting_w8wed_conc_list)
crate_prev_75pc_sorting_concs$area <- as.factor('sorting')
crate_prev_75pc_sorting_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_75pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_reject_concs <- as.data.frame(crate_prev_75pc_reject_w8wed_conc_list)
crate_prev_75pc_reject_concs$area <- as.factor('reject')
crate_prev_75pc_reject_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_75pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_tray_packing_concs <- as.data.frame(crate_prev_75pc_tray_packing_w8wed_conc_list)
crate_prev_75pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_75pc_tray_packing_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_75pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_other_concs <- as.data.frame(crate_prev_75pc_other_w8wed_conc_list)
crate_prev_75pc_other_concs$area <- as.factor('other')
crate_prev_75pc_other_concs$scenario <- as.factor('EC_01')
crate_prev_75pc_other_concs$water <- as.factor('Dry')
names(crate_prev_75pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_75pc_w8wed_concs <- rbind(crate_prev_75pc_loading_concs,crate_prev_75pc_cleaning_concs,crate_prev_75pc_sorting_concs,crate_prev_75pc_tray_packing_concs,crate_prev_75pc_reject_concs,crate_prev_75pc_other_concs)

crate_prev_75pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_75pc$loading_w8wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_loading_prev$area <- as.factor('loading')
crate_prev_75pc_loading_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_75pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_75pc$cleaning_w8wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_75pc_cleaning_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_75pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_75pc$sorting_w8wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_sorting_prev$area <- as.factor('sorting')
crate_prev_75pc_sorting_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_75pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_75pc$reject_w8wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_reject_prev$area <- as.factor('reject')
crate_prev_75pc_reject_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_75pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_75pc$tray_packing_w8wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_75pc_tray_packing_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_75pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_other_prev <- as.data.frame(NL_table_Crate_Prev_75pc$other_w8wed_prev[order(NL_table_Crate_Prev_75pc$local_seed)])
crate_prev_75pc_other_prev$area <- as.factor('other')
crate_prev_75pc_other_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_other_prev$water <- as.factor('Dry')
names(crate_prev_75pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_75pc_w8wed_prev <- rbind(crate_prev_75pc_loading_prev,crate_prev_75pc_cleaning_prev,crate_prev_75pc_sorting_prev,crate_prev_75pc_tray_packing_prev,crate_prev_75pc_reject_prev,crate_prev_75pc_other_prev)

crate_prev_75pc_w8wed_wet_prev <- as.data.frame(crate_prev_75pc_loading_prev$prevalence*21/100+crate_prev_75pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_75pc_w8wed_wet_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_w8wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_75pc_w8wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_75pc_w8wed_dry_prev <- as.data.frame(crate_prev_75pc_sorting_prev$prevalence*20/100+crate_prev_75pc_reject_prev$prevalence*23/100+crate_prev_75pc_tray_packing_prev$prevalence*123/100+crate_prev_75pc_other_prev$prevalence*10/100)/176*100
crate_prev_75pc_w8wed_dry_prev$scenario <- as.factor('EC_01')
crate_prev_75pc_w8wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_75pc_w8wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_75pc_w8wed_recombined_prev <- rbind(crate_prev_75pc_w8wed_wet_prev, crate_prev_75pc_w8wed_dry_prev)

crate_prev_75pc_w1wed_prev$week <- as.factor(1)
crate_prev_75pc_w2wed_prev$week <- as.factor(2)
crate_prev_75pc_w3wed_prev$week <- as.factor(3)
crate_prev_75pc_w4wed_prev$week <- as.factor(4)
crate_prev_75pc_w5wed_prev$week <- as.factor(5)
crate_prev_75pc_w6wed_prev$week <- as.factor(6)
crate_prev_75pc_w7wed_prev$week <- as.factor(7)
crate_prev_75pc_w8wed_prev$week <- as.factor(8)

crate_prev_75pc_w1wed_recombined_prev$week <- as.factor(1)
crate_prev_75pc_w2wed_recombined_prev$week <- as.factor(2)
crate_prev_75pc_w3wed_recombined_prev$week <- as.factor(3)
crate_prev_75pc_w4wed_recombined_prev$week <- as.factor(4)
crate_prev_75pc_w5wed_recombined_prev$week <- as.factor(5)
crate_prev_75pc_w6wed_recombined_prev$week <- as.factor(6)
crate_prev_75pc_w7wed_recombined_prev$week <- as.factor(7)
crate_prev_75pc_w8wed_recombined_prev$week <- as.factor(8)
crate_prev_75pc_allwed_prev <- rbind(crate_prev_75pc_w1wed_recombined_prev,crate_prev_75pc_w2wed_recombined_prev,crate_prev_75pc_w3wed_recombined_prev,crate_prev_75pc_w4wed_recombined_prev,crate_prev_75pc_w5wed_recombined_prev,crate_prev_75pc_w6wed_recombined_prev,crate_prev_75pc_w7wed_recombined_prev,crate_prev_75pc_w8wed_recombined_prev)

vector <- NL_table_Crate_Prev_75pc$lifetime_conc_list[order(NL_table_Crate_Prev_75pc$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

crate_prev_75pc_w1wed_recombined_prev$week <- as.factor(1)
crate_prev_75pc_w2wed_recombined_prev$week <- as.factor(2)
crate_prev_75pc_w3wed_recombined_prev$week <- as.factor(3)
crate_prev_75pc_w4wed_recombined_prev$week <- as.factor(4)
crate_prev_75pc_w5wed_recombined_prev$week <- as.factor(5)
crate_prev_75pc_w6wed_recombined_prev$week <- as.factor(6)
crate_prev_75pc_w7wed_recombined_prev$week <- as.factor(7)
crate_prev_75pc_w8wed_recombined_prev$week <- as.factor(8)
crate_prev_75pc_allwed_prev <- rbind(crate_prev_75pc_w1wed_recombined_prev,crate_prev_75pc_w2wed_recombined_prev,crate_prev_75pc_w3wed_recombined_prev,crate_prev_75pc_w4wed_recombined_prev,crate_prev_75pc_w5wed_recombined_prev,crate_prev_75pc_w6wed_recombined_prev,crate_prev_75pc_w7wed_recombined_prev,crate_prev_75pc_w8wed_recombined_prev)

Facility_B_crate_prev_75pc_agents_melted <- melt(mdarray)
colnames(Facility_B_crate_prev_75pc_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_crate_prev_75pc_agents_melted$agent <- Facility_B_crate_prev_75pc_agents_melted$agent-1
Facility_B_crate_prev_75pc_agents_melted$logical <- Facility_B_crate_prev_75pc_agents_melted$value>0
Facility_B_crate_prev_75pc_agents_melted$binary <- as.numeric(Facility_B_crate_prev_75pc_agents_melted$logical)
Facility_B_crate_prev_75pc_agents_melted$log10value <- log10(Facility_B_crate_prev_75pc_agents_melted$value)
Facility_B_crate_prev_75pc_agents_melted$log10value[is.infinite(Facility_B_crate_prev_75pc_agents_melted$log10value)] <- 0

agent <- Facility_B_crate_prev_75pc_agents_melted$agent
iteration <- Facility_B_crate_prev_75pc_agents_melted$iteration
tick <- Facility_B_crate_prev_75pc_agents_melted$tick
rle_matrix <- tapply(Facility_B_crate_prev_75pc_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_crate_prev_75pc_mean_value_matrix <- tapply(Facility_B_crate_prev_75pc_agents_melted$value, list(agent, tick), mean)
Facility_B_crate_prev_75pc_median_value_matrix <- tapply(Facility_B_crate_prev_75pc_agents_melted$value, list(agent, tick), median)
x <- Facility_B_crate_prev_75pc_agents_melted
x$value[x$value==0] <- NA
Facility_B_crate_prev_75pc_pos_median_value_matrix <- tapply(x$value, list(agent, tick), median, na.rm=TRUE)
Facility_B_crate_prev_75pc_prob_value_matrix <- tapply(Facility_B_crate_prev_75pc_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

#Maximum sensitivity####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_crate_prev_75pc <- durations

agents_list_crate_prev_75pc <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_crate_prev_75pc <- agents_list_crate_prev_75pc[,c("V1","V7","V8","V9")]
colnames(agents_list_crate_prev_75pc) <- c("name","sanitation_status","schedule","area")
#Time to persistence
agents_list_crate_prev_75pc$time_to_persistence <- rep((168*2),225)
agents_list_crate_prev_75pc$time_to_persistence[agents_list_crate_prev_75pc$schedule=="daily"] <- (24*2)

persistent_short_durations_list_crate_prev_75pc <- data.frame()
persistent_long_durations_list_crate_prev_75pc <- data.frame()
persistent_uncleanable_durations_list_crate_prev_75pc <- data.frame()
transient_short_durations_list_crate_prev_75pc <- data.frame()
transient_long_durations_list_crate_prev_75pc <- data.frame()
transient_uncleanable_durations_list_crate_prev_75pc <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_crate_prev_75pc$min_duration[agent] <- ifelse(length(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent])==0,NA,min(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_crate_prev_75pc$mean_duration[agent] <- ifelse(length(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent])==0,NA,mean(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_crate_prev_75pc$median_duration[agent] <- ifelse(length(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent])==0,NA,median(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_crate_prev_75pc$max_duration[agent] <- ifelse(length(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent])==0,NA,max(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_crate_prev_75pc$contamination_events[agent] <- sum(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_crate_prev_75pc$times_persistent[agent] <- sum(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent]>agents_list_crate_prev_75pc$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_crate_prev_75pc$q1_duration[agent] <- quantile(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_crate_prev_75pc$q3_duration[agent] <- quantile(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_crate_prev_75pc$min_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent])==0) || (agents_list_crate_prev_75pc$times_persistent[agent]==0),NA,min(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent & Facility_B_durations_crate_prev_75pc$duration>=agents_list_crate_prev_75pc$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_crate_prev_75pc$mean_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent])==0) || (agents_list_crate_prev_75pc$times_persistent[agent]==0),NA,mean(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent & Facility_B_durations_crate_prev_75pc$duration>=agents_list_crate_prev_75pc$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_crate_prev_75pc$median_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent])==0) || (agents_list_crate_prev_75pc$times_persistent[agent]==0),NA,median(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent & Facility_B_durations_crate_prev_75pc$duration>=agents_list_crate_prev_75pc$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_crate_prev_75pc$max_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent])==0) || (agents_list_crate_prev_75pc$times_persistent[agent]==0),NA,max(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent & Facility_B_durations_crate_prev_75pc$duration>=agents_list_crate_prev_75pc$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_crate_prev_75pc$q1_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent])==0) || (agents_list_crate_prev_75pc$times_persistent[agent]==0),NA,quantile(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent & Facility_B_durations_crate_prev_75pc$duration>=agents_list_crate_prev_75pc$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_crate_prev_75pc$q3_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent])==0) || (agents_list_crate_prev_75pc$times_persistent[agent]==0),NA,quantile(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent & Facility_B_durations_crate_prev_75pc$duration>=agents_list_crate_prev_75pc$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations
  x <- Facility_B_durations_crate_prev_75pc[which(Facility_B_durations_crate_prev_75pc$agent==agent & Facility_B_durations_crate_prev_75pc$duration>agents_list_crate_prev_75pc$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean
  agents_list_crate_prev_75pc$mean_times_persistent[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_crate_prev_75pc$mean_times_persistent[which(is.na(agents_list_crate_prev_75pc$mean_times_persistent))] <- 0
  #Division by total number of iterations in simulation
  agents_list_crate_prev_75pc$balanced_times_persistent[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_crate_prev_75pc$duration[Facility_B_durations_crate_prev_75pc$agent==agent])!=0) || (agents_list_crate_prev_75pc$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_crate_prev_75pc$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_crate_prev_75pc <- rbind(
        persistent_short_durations_list_crate_prev_75pc,
        Facility_B_durations_crate_prev_75pc[Facility_B_durations_crate_prev_75pc$agent==agent & Facility_B_durations_crate_prev_75pc$duration>agents_list_crate_prev_75pc$time_to_persistence[agent],]
      )
    } else if(agents_list_crate_prev_75pc$time_to_persistence[agent]==336 && agents_list_crate_prev_75pc$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_crate_prev_75pc <- rbind(
        persistent_long_durations_list_crate_prev_75pc,
        Facility_B_durations_crate_prev_75pc[Facility_B_durations_crate_prev_75pc$agent==agent & Facility_B_durations_crate_prev_75pc$duration>agents_list_crate_prev_75pc$time_to_persistence[agent],]
      )
    } else if(agents_list_crate_prev_75pc$time_to_persistence[agent]==336 && agents_list_crate_prev_75pc$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_crate_prev_75pc <- rbind(
        persistent_uncleanable_durations_list_crate_prev_75pc,
        Facility_B_durations_crate_prev_75pc[Facility_B_durations_crate_prev_75pc$agent==agent & Facility_B_durations_crate_prev_75pc$duration>agents_list_crate_prev_75pc$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_crate_prev_75pc$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_crate_prev_75pc <- rbind(
      transient_short_durations_list_crate_prev_75pc,
      Facility_B_durations_crate_prev_75pc[Facility_B_durations_crate_prev_75pc$agent==agent & Facility_B_durations_crate_prev_75pc$duration<=agents_list_crate_prev_75pc$time_to_persistence[agent],]
    )
  } else if(agents_list_crate_prev_75pc$time_to_persistence[agent]==336 && agents_list_crate_prev_75pc$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_crate_prev_75pc <- rbind(
      transient_long_durations_list_crate_prev_75pc,
      Facility_B_durations_crate_prev_75pc[Facility_B_durations_crate_prev_75pc$agent==agent & Facility_B_durations_crate_prev_75pc$duration<=agents_list_crate_prev_75pc$time_to_persistence[agent],]
    )
  } else if(agents_list_crate_prev_75pc$time_to_persistence[agent]==336 && agents_list_crate_prev_75pc$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_crate_prev_75pc <- rbind(
      transient_uncleanable_durations_list_crate_prev_75pc,
      Facility_B_durations_crate_prev_75pc[Facility_B_durations_crate_prev_75pc$agent==agent & Facility_B_durations_crate_prev_75pc$duration<=agents_list_crate_prev_75pc$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

#10 cells minimum####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>9)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_crate_prev_75pc_10min <- durations

agents_list_crate_prev_75pc <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_crate_prev_75pc <- agents_list_crate_prev_75pc[,c("V1","V7","V8","V9")]
colnames(agents_list_crate_prev_75pc) <- c("name","sanitation_status","schedule","area")
#Time to persistence
agents_list_crate_prev_75pc$time_to_persistence <- rep((168*2),225)
agents_list_crate_prev_75pc$time_to_persistence[agents_list_crate_prev_75pc$schedule=="daily"] <- (24*2)

persistent_short_durations_list_crate_prev_75pc_10min <- data.frame()
persistent_long_durations_list_crate_prev_75pc_10min <- data.frame()
persistent_uncleanable_durations_list_crate_prev_75pc_10min <- data.frame()
transient_short_durations_list_crate_prev_75pc_10min <- data.frame()
transient_long_durations_list_crate_prev_75pc_10min <- data.frame()
transient_uncleanable_durations_list_crate_prev_75pc_10min <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_crate_prev_75pc$min_duration_10min[agent] <- ifelse(length(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent])==0,NA,min(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_crate_prev_75pc$mean_duration_10min[agent] <- ifelse(length(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent])==0,NA,mean(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_crate_prev_75pc$median_duration_10min[agent] <- ifelse(length(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent])==0,NA,median(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_crate_prev_75pc$max_duration_10min[agent] <- ifelse(length(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent])==0,NA,max(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_crate_prev_75pc$contamination_events_10min[agent] <- sum(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_crate_prev_75pc$times_persistent_10min[agent] <- sum(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent]>agents_list_crate_prev_75pc$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_crate_prev_75pc$q1_duration_10min[agent] <- quantile(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_crate_prev_75pc$q3_duration_10min[agent] <- quantile(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_crate_prev_75pc$min_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent])==0) || (agents_list_crate_prev_75pc$times_persistent_10min[agent]==0),NA,min(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent & Facility_B_durations_crate_prev_75pc_10min$duration>=agents_list_crate_prev_75pc$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_crate_prev_75pc$mean_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent])==0) || (agents_list_crate_prev_75pc$times_persistent_10min[agent]==0),NA,mean(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent & Facility_B_durations_crate_prev_75pc_10min$duration>=agents_list_crate_prev_75pc$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_crate_prev_75pc$median_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent])==0) || (agents_list_crate_prev_75pc$times_persistent_10min[agent]==0),NA,median(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent & Facility_B_durations_crate_prev_75pc_10min$duration>=agents_list_crate_prev_75pc$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_crate_prev_75pc$max_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent])==0) || (agents_list_crate_prev_75pc$times_persistent_10min[agent]==0),NA,max(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent & Facility_B_durations_crate_prev_75pc_10min$duration>=agents_list_crate_prev_75pc$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_crate_prev_75pc$q1_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent])==0) || (agents_list_crate_prev_75pc$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent & Facility_B_durations_crate_prev_75pc_10min$duration>=agents_list_crate_prev_75pc$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_crate_prev_75pc$q3_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent])==0) || (agents_list_crate_prev_75pc$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent & Facility_B_durations_crate_prev_75pc_10min$duration>=agents_list_crate_prev_75pc$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations (Does not account for iterations with 0 events)
  x <- Facility_B_durations_crate_prev_75pc_10min[which(Facility_B_durations_crate_prev_75pc_10min$agent==agent & Facility_B_durations_crate_prev_75pc_10min$duration>agents_list_crate_prev_75pc$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean (Does account for iterations with 0 events)
  agents_list_crate_prev_75pc$mean_times_persistent_10min[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_crate_prev_75pc$mean_times_persistent_10min[which(is.na(agents_list_crate_prev_75pc$mean_times_persistent_10min))] <- 0
  #Division by total number of iterations in simulation
  agents_list_crate_prev_75pc$balanced_times_persistent_10min[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_crate_prev_75pc_10min$duration[Facility_B_durations_crate_prev_75pc_10min$agent==agent])!=0) || (agents_list_crate_prev_75pc$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_crate_prev_75pc$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_crate_prev_75pc_10min <- rbind(
        persistent_short_durations_list_crate_prev_75pc_10min,
        Facility_B_durations_crate_prev_75pc_10min[Facility_B_durations_crate_prev_75pc_10min$agent==agent & Facility_B_durations_crate_prev_75pc_10min$duration>agents_list_crate_prev_75pc$time_to_persistence[agent],]
      )
    } else if(agents_list_crate_prev_75pc$time_to_persistence[agent]==336 && agents_list_crate_prev_75pc$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_crate_prev_75pc_10min <- rbind(
        persistent_long_durations_list_crate_prev_75pc_10min,
        Facility_B_durations_crate_prev_75pc_10min[Facility_B_durations_crate_prev_75pc_10min$agent==agent & Facility_B_durations_crate_prev_75pc_10min$duration>agents_list_crate_prev_75pc$time_to_persistence[agent],]
      )
    } else if(agents_list_crate_prev_75pc$time_to_persistence[agent]==336 && agents_list_crate_prev_75pc$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_crate_prev_75pc_10min <- rbind(
        persistent_uncleanable_durations_list_crate_prev_75pc_10min,
        Facility_B_durations_crate_prev_75pc_10min[Facility_B_durations_crate_prev_75pc_10min$agent==agent & Facility_B_durations_crate_prev_75pc_10min$duration>agents_list_crate_prev_75pc$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_crate_prev_75pc$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_crate_prev_75pc_10min <- rbind(
      transient_short_durations_list_crate_prev_75pc_10min,
      Facility_B_durations_crate_prev_75pc_10min[Facility_B_durations_crate_prev_75pc_10min$agent==agent & Facility_B_durations_crate_prev_75pc_10min$duration<=agents_list_crate_prev_75pc$time_to_persistence[agent],]
    )
  } else if(agents_list_crate_prev_75pc$time_to_persistence[agent]==336 && agents_list_crate_prev_75pc$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_crate_prev_75pc_10min <- rbind(
      transient_long_durations_list_crate_prev_75pc_10min,
      Facility_B_durations_crate_prev_75pc_10min[Facility_B_durations_crate_prev_75pc_10min$agent==agent & Facility_B_durations_crate_prev_75pc_10min$duration<=agents_list_crate_prev_75pc$time_to_persistence[agent],]
    )
  } else if(agents_list_crate_prev_75pc$time_to_persistence[agent]==336 && agents_list_crate_prev_75pc$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_crate_prev_75pc_10min <- rbind(
      transient_uncleanable_durations_list_crate_prev_75pc_10min,
      Facility_B_durations_crate_prev_75pc_10min[Facility_B_durations_crate_prev_75pc_10min$agent==agent & Facility_B_durations_crate_prev_75pc_10min$duration<=agents_list_crate_prev_75pc$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

# Facility_B_crate_prev_75pc_agents_melted_monday_preop <- Facility_B_crate_prev_75pc_agents_melted[which(Facility_B_crate_prev_75pc_agents_melted$tick==33|Facility_B_crate_prev_75pc_agents_melted$tick==201|Facility_B_crate_prev_75pc_agents_melted$tick==369|Facility_B_crate_prev_75pc_agents_melted$tick==537|Facility_B_crate_prev_75pc_agents_melted$tick==705|Facility_B_crate_prev_75pc_agents_melted$tick==873|Facility_B_crate_prev_75pc_agents_melted$tick==1041|Facility_B_crate_prev_75pc_agents_melted$tick==1209),]
# 
# Facility_B_crate_prev_75pc_agents_melted_tuesday_preop <- Facility_B_crate_prev_75pc_agents_melted[which(Facility_B_crate_prev_75pc_agents_melted$tick==57|Facility_B_crate_prev_75pc_agents_melted$tick==225|Facility_B_crate_prev_75pc_agents_melted$tick==393|Facility_B_crate_prev_75pc_agents_melted$tick==561|Facility_B_crate_prev_75pc_agents_melted$tick==729|Facility_B_crate_prev_75pc_agents_melted$tick==897|Facility_B_crate_prev_75pc_agents_melted$tick==1065|Facility_B_crate_prev_75pc_agents_melted$tick==1233),]
# 
# Facility_B_crate_prev_75pc_agents_melted_wednesday_preop <- Facility_B_crate_prev_75pc_agents_melted[which(Facility_B_crate_prev_75pc_agents_melted$tick==81|Facility_B_crate_prev_75pc_agents_melted$tick==249|Facility_B_crate_prev_75pc_agents_melted$tick==417|Facility_B_crate_prev_75pc_agents_melted$tick==585|Facility_B_crate_prev_75pc_agents_melted$tick==753|Facility_B_crate_prev_75pc_agents_melted$tick==921|Facility_B_crate_prev_75pc_agents_melted$tick==1089|Facility_B_crate_prev_75pc_agents_melted$tick==1257),]
# 
# Facility_B_crate_prev_75pc_agents_melted_thursday_preop <- Facility_B_crate_prev_75pc_agents_melted[which(Facility_B_crate_prev_75pc_agents_melted$tick==105|Facility_B_crate_prev_75pc_agents_melted$tick==273|Facility_B_crate_prev_75pc_agents_melted$tick==441|Facility_B_crate_prev_75pc_agents_melted$tick==609|Facility_B_crate_prev_75pc_agents_melted$tick==777|Facility_B_crate_prev_75pc_agents_melted$tick==945|Facility_B_crate_prev_75pc_agents_melted$tick==1113|Facility_B_crate_prev_75pc_agents_melted$tick==1281),]
# 
# Facility_B_crate_prev_75pc_agents_melted_friday_preop <- Facility_B_crate_prev_75pc_agents_melted[which(Facility_B_crate_prev_75pc_agents_melted$tick==129|Facility_B_crate_prev_75pc_agents_melted$tick==297|Facility_B_crate_prev_75pc_agents_melted$tick==465|Facility_B_crate_prev_75pc_agents_melted$tick==633|Facility_B_crate_prev_75pc_agents_melted$tick==801|Facility_B_crate_prev_75pc_agents_melted$tick==969|Facility_B_crate_prev_75pc_agents_melted$tick==1137|Facility_B_crate_prev_75pc_agents_melted$tick==1305),]

Facility_B_crate_prev_75pc_agents_melted_ff <- as.ffdf(Facility_B_crate_prev_75pc_agents_melted)
rm(Facility_B_crate_prev_75pc_agents_melted)
gc()
```

```{r import Crate Prevalence 50%}
NL_table_Crate_Prev_50pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-28-16-05 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_Crate_Prev_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Crate_Prev_50pc <- NL_table_Crate_Prev_50pc[NL_table_Crate_Prev_50pc$scenario==10,]

while (any(grepl('-', names(NL_table_Crate_Prev_50pc), fixed = TRUE))) {
  NL_table_Crate_Prev_50pc <- NL_table_Crate_Prev_50pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Crate_Prev_50pc), fixed = TRUE))) {
  NL_table_Crate_Prev_50pc <- NL_table_Crate_Prev_50pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Crate_Prev_50pc), fixed = TRUE))) {
  NL_table_Crate_Prev_50pc <- NL_table_Crate_Prev_50pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Crate_Prev_50pc), fixed = TRUE))) {
  NL_table_Crate_Prev_50pc <- NL_table_Crate_Prev_50pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Crate_Prev_50pc[ , ..list_columns]

NL_table_Crate_Prev_50pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Crate_Prev_50pc <- as.data.frame(NL_table_Crate_Prev_50pc)

NL_table_Crate_Prev_50pc[NL_table_Crate_Prev_50pc==-1] <- NA

NL_table_Crate_Prev_50pc <- subset(NL_table_Crate_Prev_50pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Crate_Prev_50pc)[names(NL_table_Crate_Prev_50pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Crate_Prev_50pc)[names(NL_table_Crate_Prev_50pc)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Crate_Prev_50pc$loading_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_loading_w1wed_conc_list <- append(crate_prev_50pc_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_loading_w1wed_conc_matrix <- matrix(unlist(crate_prev_50pc_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_cleaning_w1wed_conc_list <- append(crate_prev_50pc_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_cleaning_w1wed_conc_matrix <- matrix(unlist(crate_prev_50pc_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_50pc$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_50pc_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_50pc_drying_w1wed_conc_list <- append(crate_prev_50pc_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_50pc$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_sorting_w1wed_conc_list <- append(crate_prev_50pc_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_sorting_w1wed_conc_matrix <- matrix(unlist(crate_prev_50pc_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_tray_packing_w1wed_conc_list <- append(crate_prev_50pc_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_tray_packing_w1wed_conc_matrix <- matrix(unlist(crate_prev_50pc_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$reject_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_reject_w1wed_conc_list <- append(crate_prev_50pc_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_reject_w1wed_conc_matrix <- matrix(unlist(crate_prev_50pc_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$other_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_other_w1wed_conc_list <- append(crate_prev_50pc_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_other_w1wed_conc_matrix <- matrix(unlist(crate_prev_50pc_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_50pc_loading_concs <- as.data.frame(crate_prev_50pc_loading_w1wed_conc_list)
crate_prev_50pc_loading_concs$area <- as.factor('loading')
crate_prev_50pc_loading_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_50pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_cleaning_concs <- as.data.frame(crate_prev_50pc_cleaning_w1wed_conc_list)
crate_prev_50pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_50pc_cleaning_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_50pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_sorting_concs <- as.data.frame(crate_prev_50pc_sorting_w1wed_conc_list)
crate_prev_50pc_sorting_concs$area <- as.factor('sorting')
crate_prev_50pc_sorting_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_50pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_reject_concs <- as.data.frame(crate_prev_50pc_reject_w1wed_conc_list)
crate_prev_50pc_reject_concs$area <- as.factor('reject')
crate_prev_50pc_reject_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_50pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_tray_packing_concs <- as.data.frame(crate_prev_50pc_tray_packing_w1wed_conc_list)
crate_prev_50pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_50pc_tray_packing_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_50pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_other_concs <- as.data.frame(crate_prev_50pc_other_w1wed_conc_list)
crate_prev_50pc_other_concs$area <- as.factor('other')
crate_prev_50pc_other_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_other_concs$water <- as.factor('Dry')
names(crate_prev_50pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w1wed_concs <- rbind(crate_prev_50pc_loading_concs,crate_prev_50pc_cleaning_concs,crate_prev_50pc_sorting_concs,crate_prev_50pc_tray_packing_concs,crate_prev_50pc_reject_concs,crate_prev_50pc_other_concs)

crate_prev_50pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_50pc$loading_w1wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_loading_prev$area <- as.factor('loading')
crate_prev_50pc_loading_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_50pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_50pc$cleaning_w1wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_50pc_cleaning_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_50pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_50pc$sorting_w1wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_sorting_prev$area <- as.factor('sorting')
crate_prev_50pc_sorting_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_50pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_50pc$reject_w1wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_reject_prev$area <- as.factor('reject')
crate_prev_50pc_reject_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_50pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_50pc$tray_packing_w1wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_50pc_tray_packing_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_50pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_other_prev <- as.data.frame(NL_table_Crate_Prev_50pc$other_w1wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_other_prev$area <- as.factor('other')
crate_prev_50pc_other_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_other_prev$water <- as.factor('Dry')
names(crate_prev_50pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w1wed_prev <- rbind(crate_prev_50pc_loading_prev,crate_prev_50pc_cleaning_prev,crate_prev_50pc_sorting_prev,crate_prev_50pc_tray_packing_prev,crate_prev_50pc_reject_prev,crate_prev_50pc_other_prev)

crate_prev_50pc_w1wed_wet_prev <- as.data.frame(crate_prev_50pc_loading_prev$prevalence*21/100+crate_prev_50pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_50pc_w1wed_wet_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_w1wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_50pc_w1wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w1wed_dry_prev <- as.data.frame(crate_prev_50pc_sorting_prev$prevalence*20/100+crate_prev_50pc_reject_prev$prevalence*23/100+crate_prev_50pc_tray_packing_prev$prevalence*123/100+crate_prev_50pc_other_prev$prevalence*10/100)/176*100
crate_prev_50pc_w1wed_dry_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_w1wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_50pc_w1wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w1wed_recombined_prev <- rbind(crate_prev_50pc_w1wed_wet_prev, crate_prev_50pc_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Crate_Prev_50pc$loading_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_loading_w2wed_conc_list <- append(crate_prev_50pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_loading_w2wed_conc_matrix <- matrix(unlist(crate_prev_50pc_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_cleaning_w2wed_conc_list <- append(crate_prev_50pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_cleaning_w2wed_conc_matrix <- matrix(unlist(crate_prev_50pc_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_50pc$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_50pc_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_50pc_drying_w2wed_conc_list <- append(crate_prev_50pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_50pc$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_sorting_w2wed_conc_list <- append(crate_prev_50pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_sorting_w2wed_conc_matrix <- matrix(unlist(crate_prev_50pc_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_tray_packing_w2wed_conc_list <- append(crate_prev_50pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_tray_packing_w2wed_conc_matrix <- matrix(unlist(crate_prev_50pc_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$reject_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_reject_w2wed_conc_list <- append(crate_prev_50pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_reject_w2wed_conc_matrix <- matrix(unlist(crate_prev_50pc_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$other_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_other_w2wed_conc_list <- append(crate_prev_50pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_other_w2wed_conc_matrix <- matrix(unlist(crate_prev_50pc_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_50pc_loading_concs <- as.data.frame(crate_prev_50pc_loading_w2wed_conc_list)
crate_prev_50pc_loading_concs$area <- as.factor('loading')
crate_prev_50pc_loading_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_50pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_cleaning_concs <- as.data.frame(crate_prev_50pc_cleaning_w2wed_conc_list)
crate_prev_50pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_50pc_cleaning_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_50pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_sorting_concs <- as.data.frame(crate_prev_50pc_sorting_w2wed_conc_list)
crate_prev_50pc_sorting_concs$area <- as.factor('sorting')
crate_prev_50pc_sorting_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_50pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_reject_concs <- as.data.frame(crate_prev_50pc_reject_w2wed_conc_list)
crate_prev_50pc_reject_concs$area <- as.factor('reject')
crate_prev_50pc_reject_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_50pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_tray_packing_concs <- as.data.frame(crate_prev_50pc_tray_packing_w2wed_conc_list)
crate_prev_50pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_50pc_tray_packing_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_50pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_other_concs <- as.data.frame(crate_prev_50pc_other_w2wed_conc_list)
crate_prev_50pc_other_concs$area <- as.factor('other')
crate_prev_50pc_other_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_other_concs$water <- as.factor('Dry')
names(crate_prev_50pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w2wed_concs <- rbind(crate_prev_50pc_loading_concs,crate_prev_50pc_cleaning_concs,crate_prev_50pc_sorting_concs,crate_prev_50pc_tray_packing_concs,crate_prev_50pc_reject_concs,crate_prev_50pc_other_concs)

crate_prev_50pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_50pc$loading_w2wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_loading_prev$area <- as.factor('loading')
crate_prev_50pc_loading_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_50pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_50pc$cleaning_w2wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_50pc_cleaning_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_50pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_50pc$sorting_w2wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_sorting_prev$area <- as.factor('sorting')
crate_prev_50pc_sorting_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_50pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_50pc$reject_w2wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_reject_prev$area <- as.factor('reject')
crate_prev_50pc_reject_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_50pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_50pc$tray_packing_w2wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_50pc_tray_packing_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_50pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_other_prev <- as.data.frame(NL_table_Crate_Prev_50pc$other_w2wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_other_prev$area <- as.factor('other')
crate_prev_50pc_other_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_other_prev$water <- as.factor('Dry')
names(crate_prev_50pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w2wed_prev <- rbind(crate_prev_50pc_loading_prev,crate_prev_50pc_cleaning_prev,crate_prev_50pc_sorting_prev,crate_prev_50pc_tray_packing_prev,crate_prev_50pc_reject_prev,crate_prev_50pc_other_prev)

crate_prev_50pc_w2wed_wet_prev <- as.data.frame(crate_prev_50pc_loading_prev$prevalence*21/100+crate_prev_50pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_50pc_w2wed_wet_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_w2wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_50pc_w2wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w2wed_dry_prev <- as.data.frame(crate_prev_50pc_sorting_prev$prevalence*20/100+crate_prev_50pc_reject_prev$prevalence*23/100+crate_prev_50pc_tray_packing_prev$prevalence*123/100+crate_prev_50pc_other_prev$prevalence*10/100)/176*100
crate_prev_50pc_w2wed_dry_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_w2wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_50pc_w2wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w2wed_recombined_prev <- rbind(crate_prev_50pc_w2wed_wet_prev, crate_prev_50pc_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Crate_Prev_50pc$loading_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_loading_w3wed_conc_list <- append(crate_prev_50pc_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_loading_w3wed_conc_matrix <- matrix(unlist(crate_prev_50pc_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_cleaning_w3wed_conc_list <- append(crate_prev_50pc_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_cleaning_w3wed_conc_matrix <- matrix(unlist(crate_prev_50pc_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_50pc$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_50pc_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_50pc_drying_w3wed_conc_list <- append(crate_prev_50pc_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_50pc$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_sorting_w3wed_conc_list <- append(crate_prev_50pc_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_sorting_w3wed_conc_matrix <- matrix(unlist(crate_prev_50pc_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_tray_packing_w3wed_conc_list <- append(crate_prev_50pc_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_tray_packing_w3wed_conc_matrix <- matrix(unlist(crate_prev_50pc_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$reject_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_reject_w3wed_conc_list <- append(crate_prev_50pc_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_reject_w3wed_conc_matrix <- matrix(unlist(crate_prev_50pc_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$other_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_other_w3wed_conc_list <- append(crate_prev_50pc_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_other_w3wed_conc_matrix <- matrix(unlist(crate_prev_50pc_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_50pc_loading_concs <- as.data.frame(crate_prev_50pc_loading_w3wed_conc_list)
crate_prev_50pc_loading_concs$area <- as.factor('loading')
crate_prev_50pc_loading_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_50pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_cleaning_concs <- as.data.frame(crate_prev_50pc_cleaning_w3wed_conc_list)
crate_prev_50pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_50pc_cleaning_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_50pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_sorting_concs <- as.data.frame(crate_prev_50pc_sorting_w3wed_conc_list)
crate_prev_50pc_sorting_concs$area <- as.factor('sorting')
crate_prev_50pc_sorting_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_50pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_reject_concs <- as.data.frame(crate_prev_50pc_reject_w3wed_conc_list)
crate_prev_50pc_reject_concs$area <- as.factor('reject')
crate_prev_50pc_reject_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_50pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_tray_packing_concs <- as.data.frame(crate_prev_50pc_tray_packing_w3wed_conc_list)
crate_prev_50pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_50pc_tray_packing_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_50pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_other_concs <- as.data.frame(crate_prev_50pc_other_w3wed_conc_list)
crate_prev_50pc_other_concs$area <- as.factor('other')
crate_prev_50pc_other_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_other_concs$water <- as.factor('Dry')
names(crate_prev_50pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w3wed_concs <- rbind(crate_prev_50pc_loading_concs,crate_prev_50pc_cleaning_concs,crate_prev_50pc_sorting_concs,crate_prev_50pc_tray_packing_concs,crate_prev_50pc_reject_concs,crate_prev_50pc_other_concs)

crate_prev_50pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_50pc$loading_w3wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_loading_prev$area <- as.factor('loading')
crate_prev_50pc_loading_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_50pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_50pc$cleaning_w3wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_50pc_cleaning_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_50pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_50pc$sorting_w3wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_sorting_prev$area <- as.factor('sorting')
crate_prev_50pc_sorting_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_50pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_50pc$reject_w3wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_reject_prev$area <- as.factor('reject')
crate_prev_50pc_reject_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_50pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_50pc$tray_packing_w3wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_50pc_tray_packing_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_50pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_other_prev <- as.data.frame(NL_table_Crate_Prev_50pc$other_w3wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_other_prev$area <- as.factor('other')
crate_prev_50pc_other_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_other_prev$water <- as.factor('Dry')
names(crate_prev_50pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w3wed_prev <- rbind(crate_prev_50pc_loading_prev,crate_prev_50pc_cleaning_prev,crate_prev_50pc_sorting_prev,crate_prev_50pc_tray_packing_prev,crate_prev_50pc_reject_prev,crate_prev_50pc_other_prev)

crate_prev_50pc_w3wed_wet_prev <- as.data.frame(crate_prev_50pc_loading_prev$prevalence*21/100+crate_prev_50pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_50pc_w3wed_wet_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_w3wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_50pc_w3wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w3wed_dry_prev <- as.data.frame(crate_prev_50pc_sorting_prev$prevalence*20/100+crate_prev_50pc_reject_prev$prevalence*23/100+crate_prev_50pc_tray_packing_prev$prevalence*123/100+crate_prev_50pc_other_prev$prevalence*10/100)/176*100
crate_prev_50pc_w3wed_dry_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_w3wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_50pc_w3wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w3wed_recombined_prev <- rbind(crate_prev_50pc_w3wed_wet_prev, crate_prev_50pc_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Crate_Prev_50pc$loading_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_loading_w4wed_conc_list <- append(crate_prev_50pc_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_loading_w4wed_conc_matrix <- matrix(unlist(crate_prev_50pc_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_cleaning_w4wed_conc_list <- append(crate_prev_50pc_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_cleaning_w4wed_conc_matrix <- matrix(unlist(crate_prev_50pc_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_50pc$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_50pc_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_50pc_drying_w4wed_conc_list <- append(crate_prev_50pc_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_50pc$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_sorting_w4wed_conc_list <- append(crate_prev_50pc_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_sorting_w4wed_conc_matrix <- matrix(unlist(crate_prev_50pc_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_tray_packing_w4wed_conc_list <- append(crate_prev_50pc_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_tray_packing_w4wed_conc_matrix <- matrix(unlist(crate_prev_50pc_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$reject_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_reject_w4wed_conc_list <- append(crate_prev_50pc_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_reject_w4wed_conc_matrix <- matrix(unlist(crate_prev_50pc_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$other_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_other_w4wed_conc_list <- append(crate_prev_50pc_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_other_w4wed_conc_matrix <- matrix(unlist(crate_prev_50pc_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_50pc_loading_concs <- as.data.frame(crate_prev_50pc_loading_w4wed_conc_list)
crate_prev_50pc_loading_concs$area <- as.factor('loading')
crate_prev_50pc_loading_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_50pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_cleaning_concs <- as.data.frame(crate_prev_50pc_cleaning_w4wed_conc_list)
crate_prev_50pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_50pc_cleaning_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_50pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_sorting_concs <- as.data.frame(crate_prev_50pc_sorting_w4wed_conc_list)
crate_prev_50pc_sorting_concs$area <- as.factor('sorting')
crate_prev_50pc_sorting_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_50pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_reject_concs <- as.data.frame(crate_prev_50pc_reject_w4wed_conc_list)
crate_prev_50pc_reject_concs$area <- as.factor('reject')
crate_prev_50pc_reject_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_50pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_tray_packing_concs <- as.data.frame(crate_prev_50pc_tray_packing_w4wed_conc_list)
crate_prev_50pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_50pc_tray_packing_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_50pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_other_concs <- as.data.frame(crate_prev_50pc_other_w4wed_conc_list)
crate_prev_50pc_other_concs$area <- as.factor('other')
crate_prev_50pc_other_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_other_concs$water <- as.factor('Dry')
names(crate_prev_50pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w4wed_concs <- rbind(crate_prev_50pc_loading_concs,crate_prev_50pc_cleaning_concs,crate_prev_50pc_sorting_concs,crate_prev_50pc_tray_packing_concs,crate_prev_50pc_reject_concs,crate_prev_50pc_other_concs)

crate_prev_50pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_50pc$loading_w4wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_loading_prev$area <- as.factor('loading')
crate_prev_50pc_loading_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_50pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_50pc$cleaning_w4wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_50pc_cleaning_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_50pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_50pc$sorting_w4wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_sorting_prev$area <- as.factor('sorting')
crate_prev_50pc_sorting_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_50pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_50pc$reject_w4wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_reject_prev$area <- as.factor('reject')
crate_prev_50pc_reject_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_50pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_50pc$tray_packing_w4wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_50pc_tray_packing_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_50pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_other_prev <- as.data.frame(NL_table_Crate_Prev_50pc$other_w4wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_other_prev$area <- as.factor('other')
crate_prev_50pc_other_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_other_prev$water <- as.factor('Dry')
names(crate_prev_50pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w4wed_prev <- rbind(crate_prev_50pc_loading_prev,crate_prev_50pc_cleaning_prev,crate_prev_50pc_sorting_prev,crate_prev_50pc_tray_packing_prev,crate_prev_50pc_reject_prev,crate_prev_50pc_other_prev)

crate_prev_50pc_w4wed_wet_prev <- as.data.frame(crate_prev_50pc_loading_prev$prevalence*21/100+crate_prev_50pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_50pc_w4wed_wet_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_w4wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_50pc_w4wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w4wed_dry_prev <- as.data.frame(crate_prev_50pc_sorting_prev$prevalence*20/100+crate_prev_50pc_reject_prev$prevalence*23/100+crate_prev_50pc_tray_packing_prev$prevalence*123/100+crate_prev_50pc_other_prev$prevalence*10/100)/176*100
crate_prev_50pc_w4wed_dry_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_w4wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_50pc_w4wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w4wed_recombined_prev <- rbind(crate_prev_50pc_w4wed_wet_prev, crate_prev_50pc_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Crate_Prev_50pc$loading_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_loading_w5wed_conc_list <- append(crate_prev_50pc_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_loading_w5wed_conc_matrix <- matrix(unlist(crate_prev_50pc_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_cleaning_w5wed_conc_list <- append(crate_prev_50pc_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_cleaning_w5wed_conc_matrix <- matrix(unlist(crate_prev_50pc_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_50pc$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_50pc_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_50pc_drying_w5wed_conc_list <- append(crate_prev_50pc_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_50pc$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_sorting_w5wed_conc_list <- append(crate_prev_50pc_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_sorting_w5wed_conc_matrix <- matrix(unlist(crate_prev_50pc_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_tray_packing_w5wed_conc_list <- append(crate_prev_50pc_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_tray_packing_w5wed_conc_matrix <- matrix(unlist(crate_prev_50pc_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$reject_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_reject_w5wed_conc_list <- append(crate_prev_50pc_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_reject_w5wed_conc_matrix <- matrix(unlist(crate_prev_50pc_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$other_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_other_w5wed_conc_list <- append(crate_prev_50pc_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_other_w5wed_conc_matrix <- matrix(unlist(crate_prev_50pc_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_50pc_loading_concs <- as.data.frame(crate_prev_50pc_loading_w5wed_conc_list)
crate_prev_50pc_loading_concs$area <- as.factor('loading')
crate_prev_50pc_loading_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_50pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_cleaning_concs <- as.data.frame(crate_prev_50pc_cleaning_w5wed_conc_list)
crate_prev_50pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_50pc_cleaning_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_50pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_sorting_concs <- as.data.frame(crate_prev_50pc_sorting_w5wed_conc_list)
crate_prev_50pc_sorting_concs$area <- as.factor('sorting')
crate_prev_50pc_sorting_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_50pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_reject_concs <- as.data.frame(crate_prev_50pc_reject_w5wed_conc_list)
crate_prev_50pc_reject_concs$area <- as.factor('reject')
crate_prev_50pc_reject_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_50pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_tray_packing_concs <- as.data.frame(crate_prev_50pc_tray_packing_w5wed_conc_list)
crate_prev_50pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_50pc_tray_packing_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_50pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_other_concs <- as.data.frame(crate_prev_50pc_other_w5wed_conc_list)
crate_prev_50pc_other_concs$area <- as.factor('other')
crate_prev_50pc_other_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_other_concs$water <- as.factor('Dry')
names(crate_prev_50pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w5wed_concs <- rbind(crate_prev_50pc_loading_concs,crate_prev_50pc_cleaning_concs,crate_prev_50pc_sorting_concs,crate_prev_50pc_tray_packing_concs,crate_prev_50pc_reject_concs,crate_prev_50pc_other_concs)

crate_prev_50pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_50pc$loading_w5wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_loading_prev$area <- as.factor('loading')
crate_prev_50pc_loading_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_50pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_50pc$cleaning_w5wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_50pc_cleaning_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_50pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_50pc$sorting_w5wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_sorting_prev$area <- as.factor('sorting')
crate_prev_50pc_sorting_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_50pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_50pc$reject_w5wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_reject_prev$area <- as.factor('reject')
crate_prev_50pc_reject_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_50pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_50pc$tray_packing_w5wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_50pc_tray_packing_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_50pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_other_prev <- as.data.frame(NL_table_Crate_Prev_50pc$other_w5wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_other_prev$area <- as.factor('other')
crate_prev_50pc_other_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_other_prev$water <- as.factor('Dry')
names(crate_prev_50pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w5wed_prev <- rbind(crate_prev_50pc_loading_prev,crate_prev_50pc_cleaning_prev,crate_prev_50pc_sorting_prev,crate_prev_50pc_tray_packing_prev,crate_prev_50pc_reject_prev,crate_prev_50pc_other_prev)

crate_prev_50pc_w5wed_wet_prev <- as.data.frame(crate_prev_50pc_loading_prev$prevalence*21/100+crate_prev_50pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_50pc_w5wed_wet_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_w5wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_50pc_w5wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w5wed_dry_prev <- as.data.frame(crate_prev_50pc_sorting_prev$prevalence*20/100+crate_prev_50pc_reject_prev$prevalence*23/100+crate_prev_50pc_tray_packing_prev$prevalence*123/100+crate_prev_50pc_other_prev$prevalence*10/100)/176*100
crate_prev_50pc_w5wed_dry_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_w5wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_50pc_w5wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w5wed_recombined_prev <- rbind(crate_prev_50pc_w5wed_wet_prev, crate_prev_50pc_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Crate_Prev_50pc$loading_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_loading_w6wed_conc_list <- append(crate_prev_50pc_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_loading_w6wed_conc_matrix <- matrix(unlist(crate_prev_50pc_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_cleaning_w6wed_conc_list <- append(crate_prev_50pc_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_cleaning_w6wed_conc_matrix <- matrix(unlist(crate_prev_50pc_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_50pc$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_50pc_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_50pc_drying_w6wed_conc_list <- append(crate_prev_50pc_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_50pc$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_sorting_w6wed_conc_list <- append(crate_prev_50pc_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_sorting_w6wed_conc_matrix <- matrix(unlist(crate_prev_50pc_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_tray_packing_w6wed_conc_list <- append(crate_prev_50pc_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_tray_packing_w6wed_conc_matrix <- matrix(unlist(crate_prev_50pc_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$reject_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_reject_w6wed_conc_list <- append(crate_prev_50pc_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_reject_w6wed_conc_matrix <- matrix(unlist(crate_prev_50pc_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$other_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_other_w6wed_conc_list <- append(crate_prev_50pc_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_other_w6wed_conc_matrix <- matrix(unlist(crate_prev_50pc_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_50pc_loading_concs <- as.data.frame(crate_prev_50pc_loading_w6wed_conc_list)
crate_prev_50pc_loading_concs$area <- as.factor('loading')
crate_prev_50pc_loading_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_50pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_cleaning_concs <- as.data.frame(crate_prev_50pc_cleaning_w6wed_conc_list)
crate_prev_50pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_50pc_cleaning_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_50pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_sorting_concs <- as.data.frame(crate_prev_50pc_sorting_w6wed_conc_list)
crate_prev_50pc_sorting_concs$area <- as.factor('sorting')
crate_prev_50pc_sorting_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_50pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_reject_concs <- as.data.frame(crate_prev_50pc_reject_w6wed_conc_list)
crate_prev_50pc_reject_concs$area <- as.factor('reject')
crate_prev_50pc_reject_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_50pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_tray_packing_concs <- as.data.frame(crate_prev_50pc_tray_packing_w6wed_conc_list)
crate_prev_50pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_50pc_tray_packing_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_50pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_other_concs <- as.data.frame(crate_prev_50pc_other_w6wed_conc_list)
crate_prev_50pc_other_concs$area <- as.factor('other')
crate_prev_50pc_other_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_other_concs$water <- as.factor('Dry')
names(crate_prev_50pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w6wed_concs <- rbind(crate_prev_50pc_loading_concs,crate_prev_50pc_cleaning_concs,crate_prev_50pc_sorting_concs,crate_prev_50pc_tray_packing_concs,crate_prev_50pc_reject_concs,crate_prev_50pc_other_concs)

crate_prev_50pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_50pc$loading_w6wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_loading_prev$area <- as.factor('loading')
crate_prev_50pc_loading_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_50pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_50pc$cleaning_w6wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_50pc_cleaning_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_50pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_50pc$sorting_w6wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_sorting_prev$area <- as.factor('sorting')
crate_prev_50pc_sorting_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_50pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_50pc$reject_w6wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_reject_prev$area <- as.factor('reject')
crate_prev_50pc_reject_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_50pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_50pc$tray_packing_w6wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_50pc_tray_packing_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_50pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_other_prev <- as.data.frame(NL_table_Crate_Prev_50pc$other_w6wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_other_prev$area <- as.factor('other')
crate_prev_50pc_other_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_other_prev$water <- as.factor('Dry')
names(crate_prev_50pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w6wed_prev <- rbind(crate_prev_50pc_loading_prev,crate_prev_50pc_cleaning_prev,crate_prev_50pc_sorting_prev,crate_prev_50pc_tray_packing_prev,crate_prev_50pc_reject_prev,crate_prev_50pc_other_prev)

crate_prev_50pc_w6wed_wet_prev <- as.data.frame(crate_prev_50pc_loading_prev$prevalence*21/100+crate_prev_50pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_50pc_w6wed_wet_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_w6wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_50pc_w6wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w6wed_dry_prev <- as.data.frame(crate_prev_50pc_sorting_prev$prevalence*20/100+crate_prev_50pc_reject_prev$prevalence*23/100+crate_prev_50pc_tray_packing_prev$prevalence*123/100+crate_prev_50pc_other_prev$prevalence*10/100)/176*100
crate_prev_50pc_w6wed_dry_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_w6wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_50pc_w6wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w6wed_recombined_prev <- rbind(crate_prev_50pc_w6wed_wet_prev, crate_prev_50pc_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Crate_Prev_50pc$loading_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_loading_w7wed_conc_list <- append(crate_prev_50pc_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_loading_w7wed_conc_matrix <- matrix(unlist(crate_prev_50pc_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_cleaning_w7wed_conc_list <- append(crate_prev_50pc_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_cleaning_w7wed_conc_matrix <- matrix(unlist(crate_prev_50pc_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_50pc$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_50pc_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_50pc_drying_w7wed_conc_list <- append(crate_prev_50pc_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_50pc$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_sorting_w7wed_conc_list <- append(crate_prev_50pc_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_sorting_w7wed_conc_matrix <- matrix(unlist(crate_prev_50pc_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_tray_packing_w7wed_conc_list <- append(crate_prev_50pc_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_tray_packing_w7wed_conc_matrix <- matrix(unlist(crate_prev_50pc_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$reject_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_reject_w7wed_conc_list <- append(crate_prev_50pc_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_reject_w7wed_conc_matrix <- matrix(unlist(crate_prev_50pc_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$other_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_other_w7wed_conc_list <- append(crate_prev_50pc_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_other_w7wed_conc_matrix <- matrix(unlist(crate_prev_50pc_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_50pc_loading_concs <- as.data.frame(crate_prev_50pc_loading_w7wed_conc_list)
crate_prev_50pc_loading_concs$area <- as.factor('loading')
crate_prev_50pc_loading_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_50pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_cleaning_concs <- as.data.frame(crate_prev_50pc_cleaning_w7wed_conc_list)
crate_prev_50pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_50pc_cleaning_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_50pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_sorting_concs <- as.data.frame(crate_prev_50pc_sorting_w7wed_conc_list)
crate_prev_50pc_sorting_concs$area <- as.factor('sorting')
crate_prev_50pc_sorting_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_50pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_reject_concs <- as.data.frame(crate_prev_50pc_reject_w7wed_conc_list)
crate_prev_50pc_reject_concs$area <- as.factor('reject')
crate_prev_50pc_reject_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_50pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_tray_packing_concs <- as.data.frame(crate_prev_50pc_tray_packing_w7wed_conc_list)
crate_prev_50pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_50pc_tray_packing_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_50pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_other_concs <- as.data.frame(crate_prev_50pc_other_w7wed_conc_list)
crate_prev_50pc_other_concs$area <- as.factor('other')
crate_prev_50pc_other_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_other_concs$water <- as.factor('Dry')
names(crate_prev_50pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w7wed_concs <- rbind(crate_prev_50pc_loading_concs,crate_prev_50pc_cleaning_concs,crate_prev_50pc_sorting_concs,crate_prev_50pc_tray_packing_concs,crate_prev_50pc_reject_concs,crate_prev_50pc_other_concs)

crate_prev_50pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_50pc$loading_w7wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_loading_prev$area <- as.factor('loading')
crate_prev_50pc_loading_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_50pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_50pc$cleaning_w7wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_50pc_cleaning_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_50pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_50pc$sorting_w7wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_sorting_prev$area <- as.factor('sorting')
crate_prev_50pc_sorting_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_50pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_50pc$reject_w7wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_reject_prev$area <- as.factor('reject')
crate_prev_50pc_reject_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_50pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_50pc$tray_packing_w7wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_50pc_tray_packing_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_50pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_other_prev <- as.data.frame(NL_table_Crate_Prev_50pc$other_w7wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_other_prev$area <- as.factor('other')
crate_prev_50pc_other_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_other_prev$water <- as.factor('Dry')
names(crate_prev_50pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w7wed_prev <- rbind(crate_prev_50pc_loading_prev,crate_prev_50pc_cleaning_prev,crate_prev_50pc_sorting_prev,crate_prev_50pc_tray_packing_prev,crate_prev_50pc_reject_prev,crate_prev_50pc_other_prev)

crate_prev_50pc_w7wed_wet_prev <- as.data.frame(crate_prev_50pc_loading_prev$prevalence*21/100+crate_prev_50pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_50pc_w7wed_wet_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_w7wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_50pc_w7wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w7wed_dry_prev <- as.data.frame(crate_prev_50pc_sorting_prev$prevalence*20/100+crate_prev_50pc_reject_prev$prevalence*23/100+crate_prev_50pc_tray_packing_prev$prevalence*123/100+crate_prev_50pc_other_prev$prevalence*10/100)/176*100
crate_prev_50pc_w7wed_dry_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_w7wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_50pc_w7wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w7wed_recombined_prev <- rbind(crate_prev_50pc_w7wed_wet_prev, crate_prev_50pc_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Crate_Prev_50pc$loading_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_loading_w8wed_conc_list <- append(crate_prev_50pc_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_loading_w8wed_conc_matrix <- matrix(unlist(crate_prev_50pc_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_cleaning_w8wed_conc_list <- append(crate_prev_50pc_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_cleaning_w8wed_conc_matrix <- matrix(unlist(crate_prev_50pc_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_50pc$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_50pc_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_50pc_drying_w8wed_conc_list <- append(crate_prev_50pc_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_50pc$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_sorting_w8wed_conc_list <- append(crate_prev_50pc_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_sorting_w8wed_conc_matrix <- matrix(unlist(crate_prev_50pc_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_tray_packing_w8wed_conc_list <- append(crate_prev_50pc_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_tray_packing_w8wed_conc_matrix <- matrix(unlist(crate_prev_50pc_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$reject_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_reject_w8wed_conc_list <- append(crate_prev_50pc_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_reject_w8wed_conc_matrix <- matrix(unlist(crate_prev_50pc_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_50pc$other_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_50pc_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_50pc_other_w8wed_conc_list <- append(crate_prev_50pc_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_50pc_other_w8wed_conc_matrix <- matrix(unlist(crate_prev_50pc_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_50pc_loading_concs <- as.data.frame(crate_prev_50pc_loading_w8wed_conc_list)
crate_prev_50pc_loading_concs$area <- as.factor('loading')
crate_prev_50pc_loading_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_50pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_cleaning_concs <- as.data.frame(crate_prev_50pc_cleaning_w8wed_conc_list)
crate_prev_50pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_50pc_cleaning_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_50pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_sorting_concs <- as.data.frame(crate_prev_50pc_sorting_w8wed_conc_list)
crate_prev_50pc_sorting_concs$area <- as.factor('sorting')
crate_prev_50pc_sorting_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_50pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_reject_concs <- as.data.frame(crate_prev_50pc_reject_w8wed_conc_list)
crate_prev_50pc_reject_concs$area <- as.factor('reject')
crate_prev_50pc_reject_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_50pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_tray_packing_concs <- as.data.frame(crate_prev_50pc_tray_packing_w8wed_conc_list)
crate_prev_50pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_50pc_tray_packing_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_50pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_other_concs <- as.data.frame(crate_prev_50pc_other_w8wed_conc_list)
crate_prev_50pc_other_concs$area <- as.factor('other')
crate_prev_50pc_other_concs$scenario <- as.factor('EC_02')
crate_prev_50pc_other_concs$water <- as.factor('Dry')
names(crate_prev_50pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_50pc_w8wed_concs <- rbind(crate_prev_50pc_loading_concs,crate_prev_50pc_cleaning_concs,crate_prev_50pc_sorting_concs,crate_prev_50pc_tray_packing_concs,crate_prev_50pc_reject_concs,crate_prev_50pc_other_concs)

crate_prev_50pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_50pc$loading_w8wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_loading_prev$area <- as.factor('loading')
crate_prev_50pc_loading_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_50pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_50pc$cleaning_w8wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_50pc_cleaning_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_50pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_50pc$sorting_w8wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_sorting_prev$area <- as.factor('sorting')
crate_prev_50pc_sorting_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_50pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_50pc$reject_w8wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_reject_prev$area <- as.factor('reject')
crate_prev_50pc_reject_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_50pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_50pc$tray_packing_w8wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_50pc_tray_packing_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_50pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_other_prev <- as.data.frame(NL_table_Crate_Prev_50pc$other_w8wed_prev[order(NL_table_Crate_Prev_50pc$local_seed)])
crate_prev_50pc_other_prev$area <- as.factor('other')
crate_prev_50pc_other_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_other_prev$water <- as.factor('Dry')
names(crate_prev_50pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_50pc_w8wed_prev <- rbind(crate_prev_50pc_loading_prev,crate_prev_50pc_cleaning_prev,crate_prev_50pc_sorting_prev,crate_prev_50pc_tray_packing_prev,crate_prev_50pc_reject_prev,crate_prev_50pc_other_prev)

crate_prev_50pc_w8wed_wet_prev <- as.data.frame(crate_prev_50pc_loading_prev$prevalence*21/100+crate_prev_50pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_50pc_w8wed_wet_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_w8wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_50pc_w8wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w8wed_dry_prev <- as.data.frame(crate_prev_50pc_sorting_prev$prevalence*20/100+crate_prev_50pc_reject_prev$prevalence*23/100+crate_prev_50pc_tray_packing_prev$prevalence*123/100+crate_prev_50pc_other_prev$prevalence*10/100)/176*100
crate_prev_50pc_w8wed_dry_prev$scenario <- as.factor('EC_02')
crate_prev_50pc_w8wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_50pc_w8wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_50pc_w8wed_recombined_prev <- rbind(crate_prev_50pc_w8wed_wet_prev, crate_prev_50pc_w8wed_dry_prev)

crate_prev_50pc_w1wed_prev$week <- as.factor(1)
crate_prev_50pc_w2wed_prev$week <- as.factor(2)
crate_prev_50pc_w3wed_prev$week <- as.factor(3)
crate_prev_50pc_w4wed_prev$week <- as.factor(4)
crate_prev_50pc_w5wed_prev$week <- as.factor(5)
crate_prev_50pc_w6wed_prev$week <- as.factor(6)
crate_prev_50pc_w7wed_prev$week <- as.factor(7)
crate_prev_50pc_w8wed_prev$week <- as.factor(8)

crate_prev_50pc_w1wed_recombined_prev$week <- as.factor(1)
crate_prev_50pc_w2wed_recombined_prev$week <- as.factor(2)
crate_prev_50pc_w3wed_recombined_prev$week <- as.factor(3)
crate_prev_50pc_w4wed_recombined_prev$week <- as.factor(4)
crate_prev_50pc_w5wed_recombined_prev$week <- as.factor(5)
crate_prev_50pc_w6wed_recombined_prev$week <- as.factor(6)
crate_prev_50pc_w7wed_recombined_prev$week <- as.factor(7)
crate_prev_50pc_w8wed_recombined_prev$week <- as.factor(8)
crate_prev_50pc_allwed_prev <- rbind(crate_prev_50pc_w1wed_recombined_prev,crate_prev_50pc_w2wed_recombined_prev,crate_prev_50pc_w3wed_recombined_prev,crate_prev_50pc_w4wed_recombined_prev,crate_prev_50pc_w5wed_recombined_prev,crate_prev_50pc_w6wed_recombined_prev,crate_prev_50pc_w7wed_recombined_prev,crate_prev_50pc_w8wed_recombined_prev)

vector <- NL_table_Crate_Prev_50pc$lifetime_conc_list[order(NL_table_Crate_Prev_50pc$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

crate_prev_50pc_w1wed_recombined_prev$week <- as.factor(1)
crate_prev_50pc_w2wed_recombined_prev$week <- as.factor(2)
crate_prev_50pc_w3wed_recombined_prev$week <- as.factor(3)
crate_prev_50pc_w4wed_recombined_prev$week <- as.factor(4)
crate_prev_50pc_w5wed_recombined_prev$week <- as.factor(5)
crate_prev_50pc_w6wed_recombined_prev$week <- as.factor(6)
crate_prev_50pc_w7wed_recombined_prev$week <- as.factor(7)
crate_prev_50pc_w8wed_recombined_prev$week <- as.factor(8)
crate_prev_50pc_allwed_prev <- rbind(crate_prev_50pc_w1wed_recombined_prev,crate_prev_50pc_w2wed_recombined_prev,crate_prev_50pc_w3wed_recombined_prev,crate_prev_50pc_w4wed_recombined_prev,crate_prev_50pc_w5wed_recombined_prev,crate_prev_50pc_w6wed_recombined_prev,crate_prev_50pc_w7wed_recombined_prev,crate_prev_50pc_w8wed_recombined_prev)

Facility_B_crate_prev_50pc_agents_melted <- melt(mdarray)
colnames(Facility_B_crate_prev_50pc_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_crate_prev_50pc_agents_melted$agent <- Facility_B_crate_prev_50pc_agents_melted$agent-1
Facility_B_crate_prev_50pc_agents_melted$logical <- Facility_B_crate_prev_50pc_agents_melted$value>0
Facility_B_crate_prev_50pc_agents_melted$binary <- as.numeric(Facility_B_crate_prev_50pc_agents_melted$logical)
Facility_B_crate_prev_50pc_agents_melted$log10value <- log10(Facility_B_crate_prev_50pc_agents_melted$value)
Facility_B_crate_prev_50pc_agents_melted$log10value[is.infinite(Facility_B_crate_prev_50pc_agents_melted$log10value)] <- 0

agent <- Facility_B_crate_prev_50pc_agents_melted$agent
iteration <- Facility_B_crate_prev_50pc_agents_melted$iteration
tick <- Facility_B_crate_prev_50pc_agents_melted$tick
rle_matrix <- tapply(Facility_B_crate_prev_50pc_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_crate_prev_50pc_mean_value_matrix <- tapply(Facility_B_crate_prev_50pc_agents_melted$value, list(agent, tick), mean)
Facility_B_crate_prev_50pc_median_value_matrix <- tapply(Facility_B_crate_prev_50pc_agents_melted$value, list(agent, tick), median)
x <- Facility_B_crate_prev_50pc_agents_melted
x$value[x$value==0] <- NA
Facility_B_crate_prev_50pc_pos_median_value_matrix <- tapply(x$value, list(agent, tick), median, na.rm=TRUE)
Facility_B_crate_prev_50pc_prob_value_matrix <- tapply(Facility_B_crate_prev_50pc_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

#Maximum sensitivity####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_crate_prev_50pc <- durations

agents_list_crate_prev_50pc <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_crate_prev_50pc <- agents_list_crate_prev_50pc[,c("V1","V7","V8","V9")]
colnames(agents_list_crate_prev_50pc) <- c("name","sanitation_status","schedule","area")
#Time to persistence
agents_list_crate_prev_50pc$time_to_persistence <- rep((168*2),225)
agents_list_crate_prev_50pc$time_to_persistence[agents_list_crate_prev_50pc$schedule=="daily"] <- (24*2)

persistent_short_durations_list_crate_prev_50pc <- data.frame()
persistent_long_durations_list_crate_prev_50pc <- data.frame()
persistent_uncleanable_durations_list_crate_prev_50pc <- data.frame()
transient_short_durations_list_crate_prev_50pc <- data.frame()
transient_long_durations_list_crate_prev_50pc <- data.frame()
transient_uncleanable_durations_list_crate_prev_50pc <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_crate_prev_50pc$min_duration[agent] <- ifelse(length(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent])==0,NA,min(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_crate_prev_50pc$mean_duration[agent] <- ifelse(length(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent])==0,NA,mean(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_crate_prev_50pc$median_duration[agent] <- ifelse(length(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent])==0,NA,median(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_crate_prev_50pc$max_duration[agent] <- ifelse(length(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent])==0,NA,max(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_crate_prev_50pc$contamination_events[agent] <- sum(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_crate_prev_50pc$times_persistent[agent] <- sum(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent]>agents_list_crate_prev_50pc$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_crate_prev_50pc$q1_duration[agent] <- quantile(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_crate_prev_50pc$q3_duration[agent] <- quantile(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_crate_prev_50pc$min_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent])==0) || (agents_list_crate_prev_50pc$times_persistent[agent]==0),NA,min(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent & Facility_B_durations_crate_prev_50pc$duration>=agents_list_crate_prev_50pc$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_crate_prev_50pc$mean_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent])==0) || (agents_list_crate_prev_50pc$times_persistent[agent]==0),NA,mean(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent & Facility_B_durations_crate_prev_50pc$duration>=agents_list_crate_prev_50pc$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_crate_prev_50pc$median_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent])==0) || (agents_list_crate_prev_50pc$times_persistent[agent]==0),NA,median(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent & Facility_B_durations_crate_prev_50pc$duration>=agents_list_crate_prev_50pc$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_crate_prev_50pc$max_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent])==0) || (agents_list_crate_prev_50pc$times_persistent[agent]==0),NA,max(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent & Facility_B_durations_crate_prev_50pc$duration>=agents_list_crate_prev_50pc$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_crate_prev_50pc$q1_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent])==0) || (agents_list_crate_prev_50pc$times_persistent[agent]==0),NA,quantile(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent & Facility_B_durations_crate_prev_50pc$duration>=agents_list_crate_prev_50pc$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_crate_prev_50pc$q3_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent])==0) || (agents_list_crate_prev_50pc$times_persistent[agent]==0),NA,quantile(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent & Facility_B_durations_crate_prev_50pc$duration>=agents_list_crate_prev_50pc$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations
  x <- Facility_B_durations_crate_prev_50pc[which(Facility_B_durations_crate_prev_50pc$agent==agent & Facility_B_durations_crate_prev_50pc$duration>agents_list_crate_prev_50pc$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean
  agents_list_crate_prev_50pc$mean_times_persistent[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_crate_prev_50pc$mean_times_persistent[which(is.na(agents_list_crate_prev_50pc$mean_times_persistent))] <- 0
  #Division by total number of iterations in simulation
  agents_list_crate_prev_50pc$balanced_times_persistent[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_crate_prev_50pc$duration[Facility_B_durations_crate_prev_50pc$agent==agent])!=0) || (agents_list_crate_prev_50pc$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_crate_prev_50pc$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_crate_prev_50pc <- rbind(
        persistent_short_durations_list_crate_prev_50pc,
        Facility_B_durations_crate_prev_50pc[Facility_B_durations_crate_prev_50pc$agent==agent & Facility_B_durations_crate_prev_50pc$duration>agents_list_crate_prev_50pc$time_to_persistence[agent],]
      )
    } else if(agents_list_crate_prev_50pc$time_to_persistence[agent]==336 && agents_list_crate_prev_50pc$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_crate_prev_50pc <- rbind(
        persistent_long_durations_list_crate_prev_50pc,
        Facility_B_durations_crate_prev_50pc[Facility_B_durations_crate_prev_50pc$agent==agent & Facility_B_durations_crate_prev_50pc$duration>agents_list_crate_prev_50pc$time_to_persistence[agent],]
      )
    } else if(agents_list_crate_prev_50pc$time_to_persistence[agent]==336 && agents_list_crate_prev_50pc$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_crate_prev_50pc <- rbind(
        persistent_uncleanable_durations_list_crate_prev_50pc,
        Facility_B_durations_crate_prev_50pc[Facility_B_durations_crate_prev_50pc$agent==agent & Facility_B_durations_crate_prev_50pc$duration>agents_list_crate_prev_50pc$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_crate_prev_50pc$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_crate_prev_50pc <- rbind(
      transient_short_durations_list_crate_prev_50pc,
      Facility_B_durations_crate_prev_50pc[Facility_B_durations_crate_prev_50pc$agent==agent & Facility_B_durations_crate_prev_50pc$duration<=agents_list_crate_prev_50pc$time_to_persistence[agent],]
    )
  } else if(agents_list_crate_prev_50pc$time_to_persistence[agent]==336 && agents_list_crate_prev_50pc$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_crate_prev_50pc <- rbind(
      transient_long_durations_list_crate_prev_50pc,
      Facility_B_durations_crate_prev_50pc[Facility_B_durations_crate_prev_50pc$agent==agent & Facility_B_durations_crate_prev_50pc$duration<=agents_list_crate_prev_50pc$time_to_persistence[agent],]
    )
  } else if(agents_list_crate_prev_50pc$time_to_persistence[agent]==336 && agents_list_crate_prev_50pc$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_crate_prev_50pc <- rbind(
      transient_uncleanable_durations_list_crate_prev_50pc,
      Facility_B_durations_crate_prev_50pc[Facility_B_durations_crate_prev_50pc$agent==agent & Facility_B_durations_crate_prev_50pc$duration<=agents_list_crate_prev_50pc$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

#10 cells minimum####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>9)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_crate_prev_50pc_10min <- durations

agents_list_crate_prev_50pc <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_crate_prev_50pc <- agents_list_crate_prev_50pc[,c("V1","V7","V8","V9")]
colnames(agents_list_crate_prev_50pc) <- c("name","sanitation_status","schedule","area")
#Time to persistence
agents_list_crate_prev_50pc$time_to_persistence <- rep((168*2),225)
agents_list_crate_prev_50pc$time_to_persistence[agents_list_crate_prev_50pc$schedule=="daily"] <- (24*2)

persistent_short_durations_list_crate_prev_50pc_10min <- data.frame()
persistent_long_durations_list_crate_prev_50pc_10min <- data.frame()
persistent_uncleanable_durations_list_crate_prev_50pc_10min <- data.frame()
transient_short_durations_list_crate_prev_50pc_10min <- data.frame()
transient_long_durations_list_crate_prev_50pc_10min <- data.frame()
transient_uncleanable_durations_list_crate_prev_50pc_10min <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_crate_prev_50pc$min_duration_10min[agent] <- ifelse(length(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent])==0,NA,min(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_crate_prev_50pc$mean_duration_10min[agent] <- ifelse(length(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent])==0,NA,mean(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_crate_prev_50pc$median_duration_10min[agent] <- ifelse(length(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent])==0,NA,median(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_crate_prev_50pc$max_duration_10min[agent] <- ifelse(length(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent])==0,NA,max(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_crate_prev_50pc$contamination_events_10min[agent] <- sum(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_crate_prev_50pc$times_persistent_10min[agent] <- sum(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent]>agents_list_crate_prev_50pc$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_crate_prev_50pc$q1_duration_10min[agent] <- quantile(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_crate_prev_50pc$q3_duration_10min[agent] <- quantile(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_crate_prev_50pc$min_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent])==0) || (agents_list_crate_prev_50pc$times_persistent_10min[agent]==0),NA,min(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent & Facility_B_durations_crate_prev_50pc_10min$duration>=agents_list_crate_prev_50pc$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_crate_prev_50pc$mean_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent])==0) || (agents_list_crate_prev_50pc$times_persistent_10min[agent]==0),NA,mean(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent & Facility_B_durations_crate_prev_50pc_10min$duration>=agents_list_crate_prev_50pc$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_crate_prev_50pc$median_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent])==0) || (agents_list_crate_prev_50pc$times_persistent_10min[agent]==0),NA,median(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent & Facility_B_durations_crate_prev_50pc_10min$duration>=agents_list_crate_prev_50pc$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_crate_prev_50pc$max_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent])==0) || (agents_list_crate_prev_50pc$times_persistent_10min[agent]==0),NA,max(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent & Facility_B_durations_crate_prev_50pc_10min$duration>=agents_list_crate_prev_50pc$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_crate_prev_50pc$q1_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent])==0) || (agents_list_crate_prev_50pc$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent & Facility_B_durations_crate_prev_50pc_10min$duration>=agents_list_crate_prev_50pc$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_crate_prev_50pc$q3_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent])==0) || (agents_list_crate_prev_50pc$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent & Facility_B_durations_crate_prev_50pc_10min$duration>=agents_list_crate_prev_50pc$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations (Does not account for iterations with 0 events)
  x <- Facility_B_durations_crate_prev_50pc_10min[which(Facility_B_durations_crate_prev_50pc_10min$agent==agent & Facility_B_durations_crate_prev_50pc_10min$duration>agents_list_crate_prev_50pc$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean (Does account for iterations with 0 events)
  agents_list_crate_prev_50pc$mean_times_persistent_10min[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_crate_prev_50pc$mean_times_persistent_10min[which(is.na(agents_list_crate_prev_50pc$mean_times_persistent_10min))] <- 0
  #Division by total number of iterations in simulation
  agents_list_crate_prev_50pc$balanced_times_persistent_10min[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_crate_prev_50pc_10min$duration[Facility_B_durations_crate_prev_50pc_10min$agent==agent])!=0) || (agents_list_crate_prev_50pc$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_crate_prev_50pc$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_crate_prev_50pc_10min <- rbind(
        persistent_short_durations_list_crate_prev_50pc_10min,
        Facility_B_durations_crate_prev_50pc_10min[Facility_B_durations_crate_prev_50pc_10min$agent==agent & Facility_B_durations_crate_prev_50pc_10min$duration>agents_list_crate_prev_50pc$time_to_persistence[agent],]
      )
    } else if(agents_list_crate_prev_50pc$time_to_persistence[agent]==336 && agents_list_crate_prev_50pc$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_crate_prev_50pc_10min <- rbind(
        persistent_long_durations_list_crate_prev_50pc_10min,
        Facility_B_durations_crate_prev_50pc_10min[Facility_B_durations_crate_prev_50pc_10min$agent==agent & Facility_B_durations_crate_prev_50pc_10min$duration>agents_list_crate_prev_50pc$time_to_persistence[agent],]
      )
    } else if(agents_list_crate_prev_50pc$time_to_persistence[agent]==336 && agents_list_crate_prev_50pc$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_crate_prev_50pc_10min <- rbind(
        persistent_uncleanable_durations_list_crate_prev_50pc_10min,
        Facility_B_durations_crate_prev_50pc_10min[Facility_B_durations_crate_prev_50pc_10min$agent==agent & Facility_B_durations_crate_prev_50pc_10min$duration>agents_list_crate_prev_50pc$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_crate_prev_50pc$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_crate_prev_50pc_10min <- rbind(
      transient_short_durations_list_crate_prev_50pc_10min,
      Facility_B_durations_crate_prev_50pc_10min[Facility_B_durations_crate_prev_50pc_10min$agent==agent & Facility_B_durations_crate_prev_50pc_10min$duration<=agents_list_crate_prev_50pc$time_to_persistence[agent],]
    )
  } else if(agents_list_crate_prev_50pc$time_to_persistence[agent]==336 && agents_list_crate_prev_50pc$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_crate_prev_50pc_10min <- rbind(
      transient_long_durations_list_crate_prev_50pc_10min,
      Facility_B_durations_crate_prev_50pc_10min[Facility_B_durations_crate_prev_50pc_10min$agent==agent & Facility_B_durations_crate_prev_50pc_10min$duration<=agents_list_crate_prev_50pc$time_to_persistence[agent],]
    )
  } else if(agents_list_crate_prev_50pc$time_to_persistence[agent]==336 && agents_list_crate_prev_50pc$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_crate_prev_50pc_10min <- rbind(
      transient_uncleanable_durations_list_crate_prev_50pc_10min,
      Facility_B_durations_crate_prev_50pc_10min[Facility_B_durations_crate_prev_50pc_10min$agent==agent & Facility_B_durations_crate_prev_50pc_10min$duration<=agents_list_crate_prev_50pc$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

# Facility_B_crate_prev_50pc_agents_melted_monday_preop <- Facility_B_crate_prev_50pc_agents_melted[which(Facility_B_crate_prev_50pc_agents_melted$tick==33|Facility_B_crate_prev_50pc_agents_melted$tick==201|Facility_B_crate_prev_50pc_agents_melted$tick==369|Facility_B_crate_prev_50pc_agents_melted$tick==537|Facility_B_crate_prev_50pc_agents_melted$tick==705|Facility_B_crate_prev_50pc_agents_melted$tick==873|Facility_B_crate_prev_50pc_agents_melted$tick==1041|Facility_B_crate_prev_50pc_agents_melted$tick==1209),]
# 
# Facility_B_crate_prev_50pc_agents_melted_tuesday_preop <- Facility_B_crate_prev_50pc_agents_melted[which(Facility_B_crate_prev_50pc_agents_melted$tick==57|Facility_B_crate_prev_50pc_agents_melted$tick==225|Facility_B_crate_prev_50pc_agents_melted$tick==393|Facility_B_crate_prev_50pc_agents_melted$tick==561|Facility_B_crate_prev_50pc_agents_melted$tick==729|Facility_B_crate_prev_50pc_agents_melted$tick==897|Facility_B_crate_prev_50pc_agents_melted$tick==1065|Facility_B_crate_prev_50pc_agents_melted$tick==1233),]
# 
# Facility_B_crate_prev_50pc_agents_melted_wednesday_preop <- Facility_B_crate_prev_50pc_agents_melted[which(Facility_B_crate_prev_50pc_agents_melted$tick==81|Facility_B_crate_prev_50pc_agents_melted$tick==249|Facility_B_crate_prev_50pc_agents_melted$tick==417|Facility_B_crate_prev_50pc_agents_melted$tick==585|Facility_B_crate_prev_50pc_agents_melted$tick==753|Facility_B_crate_prev_50pc_agents_melted$tick==921|Facility_B_crate_prev_50pc_agents_melted$tick==1089|Facility_B_crate_prev_50pc_agents_melted$tick==1257),]
# 
# Facility_B_crate_prev_50pc_agents_melted_thursday_preop <- Facility_B_crate_prev_50pc_agents_melted[which(Facility_B_crate_prev_50pc_agents_melted$tick==105|Facility_B_crate_prev_50pc_agents_melted$tick==273|Facility_B_crate_prev_50pc_agents_melted$tick==441|Facility_B_crate_prev_50pc_agents_melted$tick==609|Facility_B_crate_prev_50pc_agents_melted$tick==777|Facility_B_crate_prev_50pc_agents_melted$tick==945|Facility_B_crate_prev_50pc_agents_melted$tick==1113|Facility_B_crate_prev_50pc_agents_melted$tick==1281),]
# 
# Facility_B_crate_prev_50pc_agents_melted_friday_preop <- Facility_B_crate_prev_50pc_agents_melted[which(Facility_B_crate_prev_50pc_agents_melted$tick==129|Facility_B_crate_prev_50pc_agents_melted$tick==297|Facility_B_crate_prev_50pc_agents_melted$tick==465|Facility_B_crate_prev_50pc_agents_melted$tick==633|Facility_B_crate_prev_50pc_agents_melted$tick==801|Facility_B_crate_prev_50pc_agents_melted$tick==969|Facility_B_crate_prev_50pc_agents_melted$tick==1137|Facility_B_crate_prev_50pc_agents_melted$tick==1305),]

Facility_B_crate_prev_50pc_agents_melted_ff <- as.ffdf(Facility_B_crate_prev_50pc_agents_melted)
rm(Facility_B_crate_prev_50pc_agents_melted)
gc()
```

```{r import Crate Prevalence 25%}
NL_table_Crate_Prev_25pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-28-16-05 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_Crate_Prev_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Crate_Prev_25pc <- NL_table_Crate_Prev_25pc[NL_table_Crate_Prev_25pc$scenario==11,]

while (any(grepl('-', names(NL_table_Crate_Prev_25pc), fixed = TRUE))) {
  NL_table_Crate_Prev_25pc <- NL_table_Crate_Prev_25pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Crate_Prev_25pc), fixed = TRUE))) {
  NL_table_Crate_Prev_25pc <- NL_table_Crate_Prev_25pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Crate_Prev_25pc), fixed = TRUE))) {
  NL_table_Crate_Prev_25pc <- NL_table_Crate_Prev_25pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Crate_Prev_25pc), fixed = TRUE))) {
  NL_table_Crate_Prev_25pc <- NL_table_Crate_Prev_25pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Crate_Prev_25pc[ , ..list_columns]

NL_table_Crate_Prev_25pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Crate_Prev_25pc <- as.data.frame(NL_table_Crate_Prev_25pc)

NL_table_Crate_Prev_25pc[NL_table_Crate_Prev_25pc==-1] <- NA

NL_table_Crate_Prev_25pc <- subset(NL_table_Crate_Prev_25pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Crate_Prev_25pc)[names(NL_table_Crate_Prev_25pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Crate_Prev_25pc)[names(NL_table_Crate_Prev_25pc)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Crate_Prev_25pc$loading_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_loading_w1wed_conc_list <- append(crate_prev_25pc_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_loading_w1wed_conc_matrix <- matrix(unlist(crate_prev_25pc_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_cleaning_w1wed_conc_list <- append(crate_prev_25pc_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_cleaning_w1wed_conc_matrix <- matrix(unlist(crate_prev_25pc_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_25pc$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_25pc_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_25pc_drying_w1wed_conc_list <- append(crate_prev_25pc_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_25pc$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_sorting_w1wed_conc_list <- append(crate_prev_25pc_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_sorting_w1wed_conc_matrix <- matrix(unlist(crate_prev_25pc_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_tray_packing_w1wed_conc_list <- append(crate_prev_25pc_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_tray_packing_w1wed_conc_matrix <- matrix(unlist(crate_prev_25pc_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$reject_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_reject_w1wed_conc_list <- append(crate_prev_25pc_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_reject_w1wed_conc_matrix <- matrix(unlist(crate_prev_25pc_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$other_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_other_w1wed_conc_list <- append(crate_prev_25pc_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_other_w1wed_conc_matrix <- matrix(unlist(crate_prev_25pc_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_25pc_loading_concs <- as.data.frame(crate_prev_25pc_loading_w1wed_conc_list)
crate_prev_25pc_loading_concs$area <- as.factor('loading')
crate_prev_25pc_loading_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_25pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_cleaning_concs <- as.data.frame(crate_prev_25pc_cleaning_w1wed_conc_list)
crate_prev_25pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_25pc_cleaning_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_25pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_sorting_concs <- as.data.frame(crate_prev_25pc_sorting_w1wed_conc_list)
crate_prev_25pc_sorting_concs$area <- as.factor('sorting')
crate_prev_25pc_sorting_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_25pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_reject_concs <- as.data.frame(crate_prev_25pc_reject_w1wed_conc_list)
crate_prev_25pc_reject_concs$area <- as.factor('reject')
crate_prev_25pc_reject_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_25pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_tray_packing_concs <- as.data.frame(crate_prev_25pc_tray_packing_w1wed_conc_list)
crate_prev_25pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_25pc_tray_packing_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_25pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_other_concs <- as.data.frame(crate_prev_25pc_other_w1wed_conc_list)
crate_prev_25pc_other_concs$area <- as.factor('other')
crate_prev_25pc_other_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_other_concs$water <- as.factor('Dry')
names(crate_prev_25pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_w1wed_concs <- rbind(crate_prev_25pc_loading_concs,crate_prev_25pc_cleaning_concs,crate_prev_25pc_sorting_concs,crate_prev_25pc_tray_packing_concs,crate_prev_25pc_reject_concs,crate_prev_25pc_other_concs)

crate_prev_25pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_25pc$loading_w1wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_loading_prev$area <- as.factor('loading')
crate_prev_25pc_loading_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_25pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_25pc$cleaning_w1wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_25pc_cleaning_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_25pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_25pc$sorting_w1wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_sorting_prev$area <- as.factor('sorting')
crate_prev_25pc_sorting_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_25pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_25pc$reject_w1wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_reject_prev$area <- as.factor('reject')
crate_prev_25pc_reject_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_25pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_25pc$tray_packing_w1wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_25pc_tray_packing_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_25pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_other_prev <- as.data.frame(NL_table_Crate_Prev_25pc$other_w1wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_other_prev$area <- as.factor('other')
crate_prev_25pc_other_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_other_prev$water <- as.factor('Dry')
names(crate_prev_25pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_w1wed_prev <- rbind(crate_prev_25pc_loading_prev,crate_prev_25pc_cleaning_prev,crate_prev_25pc_sorting_prev,crate_prev_25pc_tray_packing_prev,crate_prev_25pc_reject_prev,crate_prev_25pc_other_prev)

crate_prev_25pc_w1wed_wet_prev <- as.data.frame(crate_prev_25pc_loading_prev$prevalence*21/100+crate_prev_25pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_25pc_w1wed_wet_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_w1wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_25pc_w1wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_25pc_w1wed_dry_prev <- as.data.frame(crate_prev_25pc_sorting_prev$prevalence*20/100+crate_prev_25pc_reject_prev$prevalence*23/100+crate_prev_25pc_tray_packing_prev$prevalence*123/100+crate_prev_25pc_other_prev$prevalence*10/100)/176*100
crate_prev_25pc_w1wed_dry_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_w1wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_25pc_w1wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_25pc_w1wed_recombined_prev <- rbind(crate_prev_25pc_w1wed_wet_prev, crate_prev_25pc_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Crate_Prev_25pc$loading_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_loading_w2wed_conc_list <- append(crate_prev_25pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_loading_w2wed_conc_matrix <- matrix(unlist(crate_prev_25pc_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_cleaning_w2wed_conc_list <- append(crate_prev_25pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_cleaning_w2wed_conc_matrix <- matrix(unlist(crate_prev_25pc_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_25pc$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_25pc_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_25pc_drying_w2wed_conc_list <- append(crate_prev_25pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_25pc$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_sorting_w2wed_conc_list <- append(crate_prev_25pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_sorting_w2wed_conc_matrix <- matrix(unlist(crate_prev_25pc_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_tray_packing_w2wed_conc_list <- append(crate_prev_25pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_tray_packing_w2wed_conc_matrix <- matrix(unlist(crate_prev_25pc_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$reject_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_reject_w2wed_conc_list <- append(crate_prev_25pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_reject_w2wed_conc_matrix <- matrix(unlist(crate_prev_25pc_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$other_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_other_w2wed_conc_list <- append(crate_prev_25pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_other_w2wed_conc_matrix <- matrix(unlist(crate_prev_25pc_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_25pc_loading_concs <- as.data.frame(crate_prev_25pc_loading_w2wed_conc_list)
crate_prev_25pc_loading_concs$area <- as.factor('loading')
crate_prev_25pc_loading_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_25pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_cleaning_concs <- as.data.frame(crate_prev_25pc_cleaning_w2wed_conc_list)
crate_prev_25pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_25pc_cleaning_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_25pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_sorting_concs <- as.data.frame(crate_prev_25pc_sorting_w2wed_conc_list)
crate_prev_25pc_sorting_concs$area <- as.factor('sorting')
crate_prev_25pc_sorting_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_25pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_reject_concs <- as.data.frame(crate_prev_25pc_reject_w2wed_conc_list)
crate_prev_25pc_reject_concs$area <- as.factor('reject')
crate_prev_25pc_reject_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_25pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_tray_packing_concs <- as.data.frame(crate_prev_25pc_tray_packing_w2wed_conc_list)
crate_prev_25pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_25pc_tray_packing_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_25pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_other_concs <- as.data.frame(crate_prev_25pc_other_w2wed_conc_list)
crate_prev_25pc_other_concs$area <- as.factor('other')
crate_prev_25pc_other_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_other_concs$water <- as.factor('Dry')
names(crate_prev_25pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_w2wed_concs <- rbind(crate_prev_25pc_loading_concs,crate_prev_25pc_cleaning_concs,crate_prev_25pc_sorting_concs,crate_prev_25pc_tray_packing_concs,crate_prev_25pc_reject_concs,crate_prev_25pc_other_concs)

crate_prev_25pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_25pc$loading_w2wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_loading_prev$area <- as.factor('loading')
crate_prev_25pc_loading_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_25pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_25pc$cleaning_w2wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_25pc_cleaning_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_25pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_25pc$sorting_w2wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_sorting_prev$area <- as.factor('sorting')
crate_prev_25pc_sorting_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_25pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_25pc$reject_w2wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_reject_prev$area <- as.factor('reject')
crate_prev_25pc_reject_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_25pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_25pc$tray_packing_w2wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_25pc_tray_packing_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_25pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_other_prev <- as.data.frame(NL_table_Crate_Prev_25pc$other_w2wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_other_prev$area <- as.factor('other')
crate_prev_25pc_other_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_other_prev$water <- as.factor('Dry')
names(crate_prev_25pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_w2wed_prev <- rbind(crate_prev_25pc_loading_prev,crate_prev_25pc_cleaning_prev,crate_prev_25pc_sorting_prev,crate_prev_25pc_tray_packing_prev,crate_prev_25pc_reject_prev,crate_prev_25pc_other_prev)

crate_prev_25pc_w2wed_wet_prev <- as.data.frame(crate_prev_25pc_loading_prev$prevalence*21/100+crate_prev_25pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_25pc_w2wed_wet_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_w2wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_25pc_w2wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_25pc_w2wed_dry_prev <- as.data.frame(crate_prev_25pc_sorting_prev$prevalence*20/100+crate_prev_25pc_reject_prev$prevalence*23/100+crate_prev_25pc_tray_packing_prev$prevalence*123/100+crate_prev_25pc_other_prev$prevalence*10/100)/176*100
crate_prev_25pc_w2wed_dry_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_w2wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_25pc_w2wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_25pc_w2wed_recombined_prev <- rbind(crate_prev_25pc_w2wed_wet_prev, crate_prev_25pc_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Crate_Prev_25pc$loading_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_loading_w3wed_conc_list <- append(crate_prev_25pc_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_loading_w3wed_conc_matrix <- matrix(unlist(crate_prev_25pc_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_cleaning_w3wed_conc_list <- append(crate_prev_25pc_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_cleaning_w3wed_conc_matrix <- matrix(unlist(crate_prev_25pc_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_25pc$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_25pc_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_25pc_drying_w3wed_conc_list <- append(crate_prev_25pc_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_25pc$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_sorting_w3wed_conc_list <- append(crate_prev_25pc_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_sorting_w3wed_conc_matrix <- matrix(unlist(crate_prev_25pc_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_tray_packing_w3wed_conc_list <- append(crate_prev_25pc_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_tray_packing_w3wed_conc_matrix <- matrix(unlist(crate_prev_25pc_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$reject_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_reject_w3wed_conc_list <- append(crate_prev_25pc_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_reject_w3wed_conc_matrix <- matrix(unlist(crate_prev_25pc_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$other_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_other_w3wed_conc_list <- append(crate_prev_25pc_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_other_w3wed_conc_matrix <- matrix(unlist(crate_prev_25pc_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_25pc_loading_concs <- as.data.frame(crate_prev_25pc_loading_w3wed_conc_list)
crate_prev_25pc_loading_concs$area <- as.factor('loading')
crate_prev_25pc_loading_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_25pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_cleaning_concs <- as.data.frame(crate_prev_25pc_cleaning_w3wed_conc_list)
crate_prev_25pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_25pc_cleaning_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_25pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_sorting_concs <- as.data.frame(crate_prev_25pc_sorting_w3wed_conc_list)
crate_prev_25pc_sorting_concs$area <- as.factor('sorting')
crate_prev_25pc_sorting_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_25pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_reject_concs <- as.data.frame(crate_prev_25pc_reject_w3wed_conc_list)
crate_prev_25pc_reject_concs$area <- as.factor('reject')
crate_prev_25pc_reject_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_25pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_tray_packing_concs <- as.data.frame(crate_prev_25pc_tray_packing_w3wed_conc_list)
crate_prev_25pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_25pc_tray_packing_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_25pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_other_concs <- as.data.frame(crate_prev_25pc_other_w3wed_conc_list)
crate_prev_25pc_other_concs$area <- as.factor('other')
crate_prev_25pc_other_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_other_concs$water <- as.factor('Dry')
names(crate_prev_25pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_w3wed_concs <- rbind(crate_prev_25pc_loading_concs,crate_prev_25pc_cleaning_concs,crate_prev_25pc_sorting_concs,crate_prev_25pc_tray_packing_concs,crate_prev_25pc_reject_concs,crate_prev_25pc_other_concs)

crate_prev_25pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_25pc$loading_w3wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_loading_prev$area <- as.factor('loading')
crate_prev_25pc_loading_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_25pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_25pc$cleaning_w3wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_25pc_cleaning_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_25pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_25pc$sorting_w3wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_sorting_prev$area <- as.factor('sorting')
crate_prev_25pc_sorting_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_25pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_25pc$reject_w3wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_reject_prev$area <- as.factor('reject')
crate_prev_25pc_reject_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_25pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_25pc$tray_packing_w3wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_25pc_tray_packing_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_25pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_other_prev <- as.data.frame(NL_table_Crate_Prev_25pc$other_w3wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_other_prev$area <- as.factor('other')
crate_prev_25pc_other_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_other_prev$water <- as.factor('Dry')
names(crate_prev_25pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_w3wed_prev <- rbind(crate_prev_25pc_loading_prev,crate_prev_25pc_cleaning_prev,crate_prev_25pc_sorting_prev,crate_prev_25pc_tray_packing_prev,crate_prev_25pc_reject_prev,crate_prev_25pc_other_prev)

crate_prev_25pc_w3wed_wet_prev <- as.data.frame(crate_prev_25pc_loading_prev$prevalence*21/100+crate_prev_25pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_25pc_w3wed_wet_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_w3wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_25pc_w3wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_25pc_w3wed_dry_prev <- as.data.frame(crate_prev_25pc_sorting_prev$prevalence*20/100+crate_prev_25pc_reject_prev$prevalence*23/100+crate_prev_25pc_tray_packing_prev$prevalence*123/100+crate_prev_25pc_other_prev$prevalence*10/100)/176*100
crate_prev_25pc_w3wed_dry_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_w3wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_25pc_w3wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_25pc_w3wed_recombined_prev <- rbind(crate_prev_25pc_w3wed_wet_prev, crate_prev_25pc_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Crate_Prev_25pc$loading_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_loading_w4wed_conc_list <- append(crate_prev_25pc_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_loading_w4wed_conc_matrix <- matrix(unlist(crate_prev_25pc_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_cleaning_w4wed_conc_list <- append(crate_prev_25pc_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_cleaning_w4wed_conc_matrix <- matrix(unlist(crate_prev_25pc_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_25pc$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_25pc_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_25pc_drying_w4wed_conc_list <- append(crate_prev_25pc_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_25pc$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_sorting_w4wed_conc_list <- append(crate_prev_25pc_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_sorting_w4wed_conc_matrix <- matrix(unlist(crate_prev_25pc_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_tray_packing_w4wed_conc_list <- append(crate_prev_25pc_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_tray_packing_w4wed_conc_matrix <- matrix(unlist(crate_prev_25pc_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$reject_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_reject_w4wed_conc_list <- append(crate_prev_25pc_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_reject_w4wed_conc_matrix <- matrix(unlist(crate_prev_25pc_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$other_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_other_w4wed_conc_list <- append(crate_prev_25pc_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_other_w4wed_conc_matrix <- matrix(unlist(crate_prev_25pc_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_25pc_loading_concs <- as.data.frame(crate_prev_25pc_loading_w4wed_conc_list)
crate_prev_25pc_loading_concs$area <- as.factor('loading')
crate_prev_25pc_loading_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_25pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_cleaning_concs <- as.data.frame(crate_prev_25pc_cleaning_w4wed_conc_list)
crate_prev_25pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_25pc_cleaning_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_25pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_sorting_concs <- as.data.frame(crate_prev_25pc_sorting_w4wed_conc_list)
crate_prev_25pc_sorting_concs$area <- as.factor('sorting')
crate_prev_25pc_sorting_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_25pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_reject_concs <- as.data.frame(crate_prev_25pc_reject_w4wed_conc_list)
crate_prev_25pc_reject_concs$area <- as.factor('reject')
crate_prev_25pc_reject_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_25pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_tray_packing_concs <- as.data.frame(crate_prev_25pc_tray_packing_w4wed_conc_list)
crate_prev_25pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_25pc_tray_packing_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_25pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_other_concs <- as.data.frame(crate_prev_25pc_other_w4wed_conc_list)
crate_prev_25pc_other_concs$area <- as.factor('other')
crate_prev_25pc_other_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_other_concs$water <- as.factor('Dry')
names(crate_prev_25pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_w4wed_concs <- rbind(crate_prev_25pc_loading_concs,crate_prev_25pc_cleaning_concs,crate_prev_25pc_sorting_concs,crate_prev_25pc_tray_packing_concs,crate_prev_25pc_reject_concs,crate_prev_25pc_other_concs)

crate_prev_25pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_25pc$loading_w4wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_loading_prev$area <- as.factor('loading')
crate_prev_25pc_loading_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_25pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_25pc$cleaning_w4wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_25pc_cleaning_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_25pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_25pc$sorting_w4wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_sorting_prev$area <- as.factor('sorting')
crate_prev_25pc_sorting_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_25pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_25pc$reject_w4wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_reject_prev$area <- as.factor('reject')
crate_prev_25pc_reject_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_25pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_25pc$tray_packing_w4wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_25pc_tray_packing_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_25pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_other_prev <- as.data.frame(NL_table_Crate_Prev_25pc$other_w4wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_other_prev$area <- as.factor('other')
crate_prev_25pc_other_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_other_prev$water <- as.factor('Dry')
names(crate_prev_25pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_w4wed_prev <- rbind(crate_prev_25pc_loading_prev,crate_prev_25pc_cleaning_prev,crate_prev_25pc_sorting_prev,crate_prev_25pc_tray_packing_prev,crate_prev_25pc_reject_prev,crate_prev_25pc_other_prev)

crate_prev_25pc_w4wed_wet_prev <- as.data.frame(crate_prev_25pc_loading_prev$prevalence*21/100+crate_prev_25pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_25pc_w4wed_wet_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_w4wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_25pc_w4wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_25pc_w4wed_dry_prev <- as.data.frame(crate_prev_25pc_sorting_prev$prevalence*20/100+crate_prev_25pc_reject_prev$prevalence*23/100+crate_prev_25pc_tray_packing_prev$prevalence*123/100+crate_prev_25pc_other_prev$prevalence*10/100)/176*100
crate_prev_25pc_w4wed_dry_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_w4wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_25pc_w4wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_25pc_w4wed_recombined_prev <- rbind(crate_prev_25pc_w4wed_wet_prev, crate_prev_25pc_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Crate_Prev_25pc$loading_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_loading_w5wed_conc_list <- append(crate_prev_25pc_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_loading_w5wed_conc_matrix <- matrix(unlist(crate_prev_25pc_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_cleaning_w5wed_conc_list <- append(crate_prev_25pc_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_cleaning_w5wed_conc_matrix <- matrix(unlist(crate_prev_25pc_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_25pc$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_25pc_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_25pc_drying_w5wed_conc_list <- append(crate_prev_25pc_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_25pc$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_sorting_w5wed_conc_list <- append(crate_prev_25pc_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_sorting_w5wed_conc_matrix <- matrix(unlist(crate_prev_25pc_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_tray_packing_w5wed_conc_list <- append(crate_prev_25pc_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_tray_packing_w5wed_conc_matrix <- matrix(unlist(crate_prev_25pc_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$reject_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_reject_w5wed_conc_list <- append(crate_prev_25pc_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_reject_w5wed_conc_matrix <- matrix(unlist(crate_prev_25pc_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$other_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_other_w5wed_conc_list <- append(crate_prev_25pc_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_other_w5wed_conc_matrix <- matrix(unlist(crate_prev_25pc_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_25pc_loading_concs <- as.data.frame(crate_prev_25pc_loading_w5wed_conc_list)
crate_prev_25pc_loading_concs$area <- as.factor('loading')
crate_prev_25pc_loading_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_25pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_cleaning_concs <- as.data.frame(crate_prev_25pc_cleaning_w5wed_conc_list)
crate_prev_25pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_25pc_cleaning_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_25pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_sorting_concs <- as.data.frame(crate_prev_25pc_sorting_w5wed_conc_list)
crate_prev_25pc_sorting_concs$area <- as.factor('sorting')
crate_prev_25pc_sorting_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_25pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_reject_concs <- as.data.frame(crate_prev_25pc_reject_w5wed_conc_list)
crate_prev_25pc_reject_concs$area <- as.factor('reject')
crate_prev_25pc_reject_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_25pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_tray_packing_concs <- as.data.frame(crate_prev_25pc_tray_packing_w5wed_conc_list)
crate_prev_25pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_25pc_tray_packing_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_25pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_other_concs <- as.data.frame(crate_prev_25pc_other_w5wed_conc_list)
crate_prev_25pc_other_concs$area <- as.factor('other')
crate_prev_25pc_other_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_other_concs$water <- as.factor('Dry')
names(crate_prev_25pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_w5wed_concs <- rbind(crate_prev_25pc_loading_concs,crate_prev_25pc_cleaning_concs,crate_prev_25pc_sorting_concs,crate_prev_25pc_tray_packing_concs,crate_prev_25pc_reject_concs,crate_prev_25pc_other_concs)

crate_prev_25pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_25pc$loading_w5wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_loading_prev$area <- as.factor('loading')
crate_prev_25pc_loading_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_25pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_25pc$cleaning_w5wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_25pc_cleaning_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_25pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_25pc$sorting_w5wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_sorting_prev$area <- as.factor('sorting')
crate_prev_25pc_sorting_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_25pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_25pc$reject_w5wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_reject_prev$area <- as.factor('reject')
crate_prev_25pc_reject_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_25pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_25pc$tray_packing_w5wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_25pc_tray_packing_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_25pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_other_prev <- as.data.frame(NL_table_Crate_Prev_25pc$other_w5wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_other_prev$area <- as.factor('other')
crate_prev_25pc_other_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_other_prev$water <- as.factor('Dry')
names(crate_prev_25pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_w5wed_prev <- rbind(crate_prev_25pc_loading_prev,crate_prev_25pc_cleaning_prev,crate_prev_25pc_sorting_prev,crate_prev_25pc_tray_packing_prev,crate_prev_25pc_reject_prev,crate_prev_25pc_other_prev)

crate_prev_25pc_w5wed_wet_prev <- as.data.frame(crate_prev_25pc_loading_prev$prevalence*21/100+crate_prev_25pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_25pc_w5wed_wet_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_w5wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_25pc_w5wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_25pc_w5wed_dry_prev <- as.data.frame(crate_prev_25pc_sorting_prev$prevalence*20/100+crate_prev_25pc_reject_prev$prevalence*23/100+crate_prev_25pc_tray_packing_prev$prevalence*123/100+crate_prev_25pc_other_prev$prevalence*10/100)/176*100
crate_prev_25pc_w5wed_dry_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_w5wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_25pc_w5wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_25pc_w5wed_recombined_prev <- rbind(crate_prev_25pc_w5wed_wet_prev, crate_prev_25pc_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Crate_Prev_25pc$loading_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_loading_w6wed_conc_list <- append(crate_prev_25pc_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_loading_w6wed_conc_matrix <- matrix(unlist(crate_prev_25pc_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_cleaning_w6wed_conc_list <- append(crate_prev_25pc_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_cleaning_w6wed_conc_matrix <- matrix(unlist(crate_prev_25pc_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_25pc$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_25pc_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_25pc_drying_w6wed_conc_list <- append(crate_prev_25pc_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_25pc$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_sorting_w6wed_conc_list <- append(crate_prev_25pc_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_sorting_w6wed_conc_matrix <- matrix(unlist(crate_prev_25pc_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_tray_packing_w6wed_conc_list <- append(crate_prev_25pc_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_tray_packing_w6wed_conc_matrix <- matrix(unlist(crate_prev_25pc_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$reject_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_reject_w6wed_conc_list <- append(crate_prev_25pc_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_reject_w6wed_conc_matrix <- matrix(unlist(crate_prev_25pc_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$other_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_other_w6wed_conc_list <- append(crate_prev_25pc_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_other_w6wed_conc_matrix <- matrix(unlist(crate_prev_25pc_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_25pc_loading_concs <- as.data.frame(crate_prev_25pc_loading_w6wed_conc_list)
crate_prev_25pc_loading_concs$area <- as.factor('loading')
crate_prev_25pc_loading_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_25pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_cleaning_concs <- as.data.frame(crate_prev_25pc_cleaning_w6wed_conc_list)
crate_prev_25pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_25pc_cleaning_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_25pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_sorting_concs <- as.data.frame(crate_prev_25pc_sorting_w6wed_conc_list)
crate_prev_25pc_sorting_concs$area <- as.factor('sorting')
crate_prev_25pc_sorting_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_25pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_reject_concs <- as.data.frame(crate_prev_25pc_reject_w6wed_conc_list)
crate_prev_25pc_reject_concs$area <- as.factor('reject')
crate_prev_25pc_reject_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_25pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_tray_packing_concs <- as.data.frame(crate_prev_25pc_tray_packing_w6wed_conc_list)
crate_prev_25pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_25pc_tray_packing_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_25pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_other_concs <- as.data.frame(crate_prev_25pc_other_w6wed_conc_list)
crate_prev_25pc_other_concs$area <- as.factor('other')
crate_prev_25pc_other_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_other_concs$water <- as.factor('Dry')
names(crate_prev_25pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_w6wed_concs <- rbind(crate_prev_25pc_loading_concs,crate_prev_25pc_cleaning_concs,crate_prev_25pc_sorting_concs,crate_prev_25pc_tray_packing_concs,crate_prev_25pc_reject_concs,crate_prev_25pc_other_concs)

crate_prev_25pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_25pc$loading_w6wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_loading_prev$area <- as.factor('loading')
crate_prev_25pc_loading_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_25pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_25pc$cleaning_w6wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_25pc_cleaning_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_25pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_25pc$sorting_w6wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_sorting_prev$area <- as.factor('sorting')
crate_prev_25pc_sorting_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_25pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_25pc$reject_w6wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_reject_prev$area <- as.factor('reject')
crate_prev_25pc_reject_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_25pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_25pc$tray_packing_w6wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_25pc_tray_packing_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_25pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_other_prev <- as.data.frame(NL_table_Crate_Prev_25pc$other_w6wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_other_prev$area <- as.factor('other')
crate_prev_25pc_other_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_other_prev$water <- as.factor('Dry')
names(crate_prev_25pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_w6wed_prev <- rbind(crate_prev_25pc_loading_prev,crate_prev_25pc_cleaning_prev,crate_prev_25pc_sorting_prev,crate_prev_25pc_tray_packing_prev,crate_prev_25pc_reject_prev,crate_prev_25pc_other_prev)

crate_prev_25pc_w6wed_wet_prev <- as.data.frame(crate_prev_25pc_loading_prev$prevalence*21/100+crate_prev_25pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_25pc_w6wed_wet_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_w6wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_25pc_w6wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_25pc_w6wed_dry_prev <- as.data.frame(crate_prev_25pc_sorting_prev$prevalence*20/100+crate_prev_25pc_reject_prev$prevalence*23/100+crate_prev_25pc_tray_packing_prev$prevalence*123/100+crate_prev_25pc_other_prev$prevalence*10/100)/176*100
crate_prev_25pc_w6wed_dry_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_w6wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_25pc_w6wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_25pc_w6wed_recombined_prev <- rbind(crate_prev_25pc_w6wed_wet_prev, crate_prev_25pc_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Crate_Prev_25pc$loading_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_loading_w7wed_conc_list <- append(crate_prev_25pc_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_loading_w7wed_conc_matrix <- matrix(unlist(crate_prev_25pc_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_cleaning_w7wed_conc_list <- append(crate_prev_25pc_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_cleaning_w7wed_conc_matrix <- matrix(unlist(crate_prev_25pc_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_25pc$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_25pc_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_25pc_drying_w7wed_conc_list <- append(crate_prev_25pc_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_25pc$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_sorting_w7wed_conc_list <- append(crate_prev_25pc_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_sorting_w7wed_conc_matrix <- matrix(unlist(crate_prev_25pc_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_tray_packing_w7wed_conc_list <- append(crate_prev_25pc_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_tray_packing_w7wed_conc_matrix <- matrix(unlist(crate_prev_25pc_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$reject_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_reject_w7wed_conc_list <- append(crate_prev_25pc_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_reject_w7wed_conc_matrix <- matrix(unlist(crate_prev_25pc_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$other_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_other_w7wed_conc_list <- append(crate_prev_25pc_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_other_w7wed_conc_matrix <- matrix(unlist(crate_prev_25pc_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_25pc_loading_concs <- as.data.frame(crate_prev_25pc_loading_w7wed_conc_list)
crate_prev_25pc_loading_concs$area <- as.factor('loading')
crate_prev_25pc_loading_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_25pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_cleaning_concs <- as.data.frame(crate_prev_25pc_cleaning_w7wed_conc_list)
crate_prev_25pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_25pc_cleaning_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_25pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_sorting_concs <- as.data.frame(crate_prev_25pc_sorting_w7wed_conc_list)
crate_prev_25pc_sorting_concs$area <- as.factor('sorting')
crate_prev_25pc_sorting_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_25pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_reject_concs <- as.data.frame(crate_prev_25pc_reject_w7wed_conc_list)
crate_prev_25pc_reject_concs$area <- as.factor('reject')
crate_prev_25pc_reject_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_25pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_tray_packing_concs <- as.data.frame(crate_prev_25pc_tray_packing_w7wed_conc_list)
crate_prev_25pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_25pc_tray_packing_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_25pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_other_concs <- as.data.frame(crate_prev_25pc_other_w7wed_conc_list)
crate_prev_25pc_other_concs$area <- as.factor('other')
crate_prev_25pc_other_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_other_concs$water <- as.factor('Dry')
names(crate_prev_25pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_w7wed_concs <- rbind(crate_prev_25pc_loading_concs,crate_prev_25pc_cleaning_concs,crate_prev_25pc_sorting_concs,crate_prev_25pc_tray_packing_concs,crate_prev_25pc_reject_concs,crate_prev_25pc_other_concs)

crate_prev_25pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_25pc$loading_w7wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_loading_prev$area <- as.factor('loading')
crate_prev_25pc_loading_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_25pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_25pc$cleaning_w7wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_25pc_cleaning_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_25pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_25pc$sorting_w7wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_sorting_prev$area <- as.factor('sorting')
crate_prev_25pc_sorting_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_25pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_25pc$reject_w7wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_reject_prev$area <- as.factor('reject')
crate_prev_25pc_reject_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_25pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_25pc$tray_packing_w7wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_25pc_tray_packing_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_25pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_other_prev <- as.data.frame(NL_table_Crate_Prev_25pc$other_w7wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_other_prev$area <- as.factor('other')
crate_prev_25pc_other_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_other_prev$water <- as.factor('Dry')
names(crate_prev_25pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_w7wed_prev <- rbind(crate_prev_25pc_loading_prev,crate_prev_25pc_cleaning_prev,crate_prev_25pc_sorting_prev,crate_prev_25pc_tray_packing_prev,crate_prev_25pc_reject_prev,crate_prev_25pc_other_prev)

crate_prev_25pc_w7wed_wet_prev <- as.data.frame(crate_prev_25pc_loading_prev$prevalence*21/100+crate_prev_25pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_25pc_w7wed_wet_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_w7wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_25pc_w7wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_25pc_w7wed_dry_prev <- as.data.frame(crate_prev_25pc_sorting_prev$prevalence*20/100+crate_prev_25pc_reject_prev$prevalence*23/100+crate_prev_25pc_tray_packing_prev$prevalence*123/100+crate_prev_25pc_other_prev$prevalence*10/100)/176*100
crate_prev_25pc_w7wed_dry_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_w7wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_25pc_w7wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_25pc_w7wed_recombined_prev <- rbind(crate_prev_25pc_w7wed_wet_prev, crate_prev_25pc_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Crate_Prev_25pc$loading_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_loading_w8wed_conc_list <- append(crate_prev_25pc_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_loading_w8wed_conc_matrix <- matrix(unlist(crate_prev_25pc_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_cleaning_w8wed_conc_list <- append(crate_prev_25pc_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_cleaning_w8wed_conc_matrix <- matrix(unlist(crate_prev_25pc_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_25pc$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_25pc_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_25pc_drying_w8wed_conc_list <- append(crate_prev_25pc_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_25pc$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_sorting_w8wed_conc_list <- append(crate_prev_25pc_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_sorting_w8wed_conc_matrix <- matrix(unlist(crate_prev_25pc_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_tray_packing_w8wed_conc_list <- append(crate_prev_25pc_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_tray_packing_w8wed_conc_matrix <- matrix(unlist(crate_prev_25pc_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$reject_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_reject_w8wed_conc_list <- append(crate_prev_25pc_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_reject_w8wed_conc_matrix <- matrix(unlist(crate_prev_25pc_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_25pc$other_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_25pc_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_25pc_other_w8wed_conc_list <- append(crate_prev_25pc_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_25pc_other_w8wed_conc_matrix <- matrix(unlist(crate_prev_25pc_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_25pc_loading_concs <- as.data.frame(crate_prev_25pc_loading_w8wed_conc_list)
crate_prev_25pc_loading_concs$area <- as.factor('loading')
crate_prev_25pc_loading_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_25pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_cleaning_concs <- as.data.frame(crate_prev_25pc_cleaning_w8wed_conc_list)
crate_prev_25pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_25pc_cleaning_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_25pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_sorting_concs <- as.data.frame(crate_prev_25pc_sorting_w8wed_conc_list)
crate_prev_25pc_sorting_concs$area <- as.factor('sorting')
crate_prev_25pc_sorting_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_25pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_reject_concs <- as.data.frame(crate_prev_25pc_reject_w8wed_conc_list)
crate_prev_25pc_reject_concs$area <- as.factor('reject')
crate_prev_25pc_reject_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_25pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_tray_packing_concs <- as.data.frame(crate_prev_25pc_tray_packing_w8wed_conc_list)
crate_prev_25pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_25pc_tray_packing_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_25pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_other_concs <- as.data.frame(crate_prev_25pc_other_w8wed_conc_list)
crate_prev_25pc_other_concs$area <- as.factor('other')
crate_prev_25pc_other_concs$scenario <- as.factor('EC_03')
crate_prev_25pc_other_concs$water <- as.factor('Dry')
names(crate_prev_25pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_25pc_w8wed_concs <- rbind(crate_prev_25pc_loading_concs,crate_prev_25pc_cleaning_concs,crate_prev_25pc_sorting_concs,crate_prev_25pc_tray_packing_concs,crate_prev_25pc_reject_concs,crate_prev_25pc_other_concs)

crate_prev_25pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_25pc$loading_w8wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_loading_prev$area <- as.factor('loading')
crate_prev_25pc_loading_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_25pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_25pc$cleaning_w8wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_25pc_cleaning_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_25pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_25pc$sorting_w8wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_sorting_prev$area <- as.factor('sorting')
crate_prev_25pc_sorting_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_25pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_25pc$reject_w8wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_reject_prev$area <- as.factor('reject')
crate_prev_25pc_reject_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_25pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_25pc$tray_packing_w8wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_25pc_tray_packing_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_25pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_other_prev <- as.data.frame(NL_table_Crate_Prev_25pc$other_w8wed_prev[order(NL_table_Crate_Prev_25pc$local_seed)])
crate_prev_25pc_other_prev$area <- as.factor('other')
crate_prev_25pc_other_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_other_prev$water <- as.factor('Dry')
names(crate_prev_25pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_25pc_w8wed_prev <- rbind(crate_prev_25pc_loading_prev,crate_prev_25pc_cleaning_prev,crate_prev_25pc_sorting_prev,crate_prev_25pc_tray_packing_prev,crate_prev_25pc_reject_prev,crate_prev_25pc_other_prev)

crate_prev_25pc_w8wed_wet_prev <- as.data.frame(crate_prev_25pc_loading_prev$prevalence*21/100+crate_prev_25pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_25pc_w8wed_wet_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_w8wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_25pc_w8wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_25pc_w8wed_dry_prev <- as.data.frame(crate_prev_25pc_sorting_prev$prevalence*20/100+crate_prev_25pc_reject_prev$prevalence*23/100+crate_prev_25pc_tray_packing_prev$prevalence*123/100+crate_prev_25pc_other_prev$prevalence*10/100)/176*100
crate_prev_25pc_w8wed_dry_prev$scenario <- as.factor('EC_03')
crate_prev_25pc_w8wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_25pc_w8wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_25pc_w8wed_recombined_prev <- rbind(crate_prev_25pc_w8wed_wet_prev, crate_prev_25pc_w8wed_dry_prev)

crate_prev_25pc_w1wed_prev$week <- as.factor(1)
crate_prev_25pc_w2wed_prev$week <- as.factor(2)
crate_prev_25pc_w3wed_prev$week <- as.factor(3)
crate_prev_25pc_w4wed_prev$week <- as.factor(4)
crate_prev_25pc_w5wed_prev$week <- as.factor(5)
crate_prev_25pc_w6wed_prev$week <- as.factor(6)
crate_prev_25pc_w7wed_prev$week <- as.factor(7)
crate_prev_25pc_w8wed_prev$week <- as.factor(8)

crate_prev_25pc_w1wed_recombined_prev$week <- as.factor(1)
crate_prev_25pc_w2wed_recombined_prev$week <- as.factor(2)
crate_prev_25pc_w3wed_recombined_prev$week <- as.factor(3)
crate_prev_25pc_w4wed_recombined_prev$week <- as.factor(4)
crate_prev_25pc_w5wed_recombined_prev$week <- as.factor(5)
crate_prev_25pc_w6wed_recombined_prev$week <- as.factor(6)
crate_prev_25pc_w7wed_recombined_prev$week <- as.factor(7)
crate_prev_25pc_w8wed_recombined_prev$week <- as.factor(8)
crate_prev_25pc_allwed_prev <- rbind(crate_prev_25pc_w1wed_recombined_prev,crate_prev_25pc_w2wed_recombined_prev,crate_prev_25pc_w3wed_recombined_prev,crate_prev_25pc_w4wed_recombined_prev,crate_prev_25pc_w5wed_recombined_prev,crate_prev_25pc_w6wed_recombined_prev,crate_prev_25pc_w7wed_recombined_prev,crate_prev_25pc_w8wed_recombined_prev)

vector <- NL_table_Crate_Prev_25pc$lifetime_conc_list[order(NL_table_Crate_Prev_25pc$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

crate_prev_25pc_w1wed_recombined_prev$week <- as.factor(1)
crate_prev_25pc_w2wed_recombined_prev$week <- as.factor(2)
crate_prev_25pc_w3wed_recombined_prev$week <- as.factor(3)
crate_prev_25pc_w4wed_recombined_prev$week <- as.factor(4)
crate_prev_25pc_w5wed_recombined_prev$week <- as.factor(5)
crate_prev_25pc_w6wed_recombined_prev$week <- as.factor(6)
crate_prev_25pc_w7wed_recombined_prev$week <- as.factor(7)
crate_prev_25pc_w8wed_recombined_prev$week <- as.factor(8)
crate_prev_25pc_allwed_prev <- rbind(crate_prev_25pc_w1wed_recombined_prev,crate_prev_25pc_w2wed_recombined_prev,crate_prev_25pc_w3wed_recombined_prev,crate_prev_25pc_w4wed_recombined_prev,crate_prev_25pc_w5wed_recombined_prev,crate_prev_25pc_w6wed_recombined_prev,crate_prev_25pc_w7wed_recombined_prev,crate_prev_25pc_w8wed_recombined_prev)

Facility_B_crate_prev_25pc_agents_melted <- melt(mdarray)
colnames(Facility_B_crate_prev_25pc_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_crate_prev_25pc_agents_melted$agent <- Facility_B_crate_prev_25pc_agents_melted$agent-1
Facility_B_crate_prev_25pc_agents_melted$logical <- Facility_B_crate_prev_25pc_agents_melted$value>0
Facility_B_crate_prev_25pc_agents_melted$binary <- as.numeric(Facility_B_crate_prev_25pc_agents_melted$logical)
Facility_B_crate_prev_25pc_agents_melted$log10value <- log10(Facility_B_crate_prev_25pc_agents_melted$value)
Facility_B_crate_prev_25pc_agents_melted$log10value[is.infinite(Facility_B_crate_prev_25pc_agents_melted$log10value)] <- 0

agent <- Facility_B_crate_prev_25pc_agents_melted$agent
iteration <- Facility_B_crate_prev_25pc_agents_melted$iteration
tick <- Facility_B_crate_prev_25pc_agents_melted$tick
rle_matrix <- tapply(Facility_B_crate_prev_25pc_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_crate_prev_25pc_mean_value_matrix <- tapply(Facility_B_crate_prev_25pc_agents_melted$value, list(agent, tick), mean)
Facility_B_crate_prev_25pc_median_value_matrix <- tapply(Facility_B_crate_prev_25pc_agents_melted$value, list(agent, tick), median)
x <- Facility_B_crate_prev_25pc_agents_melted
x$value[x$value==0] <- NA
Facility_B_crate_prev_25pc_pos_median_value_matrix <- tapply(x$value, list(agent, tick), median, na.rm=TRUE)
Facility_B_crate_prev_25pc_prob_value_matrix <- tapply(Facility_B_crate_prev_25pc_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

#Maximum sensitivity####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_crate_prev_25pc <- durations

agents_list_crate_prev_25pc <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_crate_prev_25pc <- agents_list_crate_prev_25pc[,c("V1","V7","V8","V9")]
colnames(agents_list_crate_prev_25pc) <- c("name","sanitation_status","schedule","area")
#Time to persistence
agents_list_crate_prev_25pc$time_to_persistence <- rep((168*2),225)
agents_list_crate_prev_25pc$time_to_persistence[agents_list_crate_prev_25pc$schedule=="daily"] <- (24*2)

persistent_short_durations_list_crate_prev_25pc <- data.frame()
persistent_long_durations_list_crate_prev_25pc <- data.frame()
persistent_uncleanable_durations_list_crate_prev_25pc <- data.frame()
transient_short_durations_list_crate_prev_25pc <- data.frame()
transient_long_durations_list_crate_prev_25pc <- data.frame()
transient_uncleanable_durations_list_crate_prev_25pc <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_crate_prev_25pc$min_duration[agent] <- ifelse(length(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent])==0,NA,min(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_crate_prev_25pc$mean_duration[agent] <- ifelse(length(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent])==0,NA,mean(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_crate_prev_25pc$median_duration[agent] <- ifelse(length(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent])==0,NA,median(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_crate_prev_25pc$max_duration[agent] <- ifelse(length(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent])==0,NA,max(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_crate_prev_25pc$contamination_events[agent] <- sum(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_crate_prev_25pc$times_persistent[agent] <- sum(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent]>agents_list_crate_prev_25pc$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_crate_prev_25pc$q1_duration[agent] <- quantile(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_crate_prev_25pc$q3_duration[agent] <- quantile(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_crate_prev_25pc$min_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent])==0) || (agents_list_crate_prev_25pc$times_persistent[agent]==0),NA,min(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent & Facility_B_durations_crate_prev_25pc$duration>=agents_list_crate_prev_25pc$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_crate_prev_25pc$mean_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent])==0) || (agents_list_crate_prev_25pc$times_persistent[agent]==0),NA,mean(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent & Facility_B_durations_crate_prev_25pc$duration>=agents_list_crate_prev_25pc$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_crate_prev_25pc$median_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent])==0) || (agents_list_crate_prev_25pc$times_persistent[agent]==0),NA,median(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent & Facility_B_durations_crate_prev_25pc$duration>=agents_list_crate_prev_25pc$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_crate_prev_25pc$max_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent])==0) || (agents_list_crate_prev_25pc$times_persistent[agent]==0),NA,max(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent & Facility_B_durations_crate_prev_25pc$duration>=agents_list_crate_prev_25pc$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_crate_prev_25pc$q1_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent])==0) || (agents_list_crate_prev_25pc$times_persistent[agent]==0),NA,quantile(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent & Facility_B_durations_crate_prev_25pc$duration>=agents_list_crate_prev_25pc$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_crate_prev_25pc$q3_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent])==0) || (agents_list_crate_prev_25pc$times_persistent[agent]==0),NA,quantile(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent & Facility_B_durations_crate_prev_25pc$duration>=agents_list_crate_prev_25pc$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations
  x <- Facility_B_durations_crate_prev_25pc[which(Facility_B_durations_crate_prev_25pc$agent==agent & Facility_B_durations_crate_prev_25pc$duration>agents_list_crate_prev_25pc$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean
  agents_list_crate_prev_25pc$mean_times_persistent[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_crate_prev_25pc$mean_times_persistent[which(is.na(agents_list_crate_prev_25pc$mean_times_persistent))] <- 0
  #Division by total number of iterations in simulation
  agents_list_crate_prev_25pc$balanced_times_persistent[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_crate_prev_25pc$duration[Facility_B_durations_crate_prev_25pc$agent==agent])!=0) || (agents_list_crate_prev_25pc$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_crate_prev_25pc$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_crate_prev_25pc <- rbind(
        persistent_short_durations_list_crate_prev_25pc,
        Facility_B_durations_crate_prev_25pc[Facility_B_durations_crate_prev_25pc$agent==agent & Facility_B_durations_crate_prev_25pc$duration>agents_list_crate_prev_25pc$time_to_persistence[agent],]
      )
    } else if(agents_list_crate_prev_25pc$time_to_persistence[agent]==336 && agents_list_crate_prev_25pc$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_crate_prev_25pc <- rbind(
        persistent_long_durations_list_crate_prev_25pc,
        Facility_B_durations_crate_prev_25pc[Facility_B_durations_crate_prev_25pc$agent==agent & Facility_B_durations_crate_prev_25pc$duration>agents_list_crate_prev_25pc$time_to_persistence[agent],]
      )
    } else if(agents_list_crate_prev_25pc$time_to_persistence[agent]==336 && agents_list_crate_prev_25pc$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_crate_prev_25pc <- rbind(
        persistent_uncleanable_durations_list_crate_prev_25pc,
        Facility_B_durations_crate_prev_25pc[Facility_B_durations_crate_prev_25pc$agent==agent & Facility_B_durations_crate_prev_25pc$duration>agents_list_crate_prev_25pc$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_crate_prev_25pc$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_crate_prev_25pc <- rbind(
      transient_short_durations_list_crate_prev_25pc,
      Facility_B_durations_crate_prev_25pc[Facility_B_durations_crate_prev_25pc$agent==agent & Facility_B_durations_crate_prev_25pc$duration<=agents_list_crate_prev_25pc$time_to_persistence[agent],]
    )
  } else if(agents_list_crate_prev_25pc$time_to_persistence[agent]==336 && agents_list_crate_prev_25pc$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_crate_prev_25pc <- rbind(
      transient_long_durations_list_crate_prev_25pc,
      Facility_B_durations_crate_prev_25pc[Facility_B_durations_crate_prev_25pc$agent==agent & Facility_B_durations_crate_prev_25pc$duration<=agents_list_crate_prev_25pc$time_to_persistence[agent],]
    )
  } else if(agents_list_crate_prev_25pc$time_to_persistence[agent]==336 && agents_list_crate_prev_25pc$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_crate_prev_25pc <- rbind(
      transient_uncleanable_durations_list_crate_prev_25pc,
      Facility_B_durations_crate_prev_25pc[Facility_B_durations_crate_prev_25pc$agent==agent & Facility_B_durations_crate_prev_25pc$duration<=agents_list_crate_prev_25pc$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

#10 cells minimum####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>9)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_crate_prev_25pc_10min <- durations

agents_list_crate_prev_25pc <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_crate_prev_25pc <- agents_list_crate_prev_25pc[,c("V1","V7","V8","V9")]
colnames(agents_list_crate_prev_25pc) <- c("name","sanitation_status","schedule","area")
#Time to persistence
agents_list_crate_prev_25pc$time_to_persistence <- rep((168*2),225)
agents_list_crate_prev_25pc$time_to_persistence[agents_list_crate_prev_25pc$schedule=="daily"] <- (24*2)

persistent_short_durations_list_crate_prev_25pc_10min <- data.frame()
persistent_long_durations_list_crate_prev_25pc_10min <- data.frame()
persistent_uncleanable_durations_list_crate_prev_25pc_10min <- data.frame()
transient_short_durations_list_crate_prev_25pc_10min <- data.frame()
transient_long_durations_list_crate_prev_25pc_10min <- data.frame()
transient_uncleanable_durations_list_crate_prev_25pc_10min <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_crate_prev_25pc$min_duration_10min[agent] <- ifelse(length(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent])==0,NA,min(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_crate_prev_25pc$mean_duration_10min[agent] <- ifelse(length(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent])==0,NA,mean(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_crate_prev_25pc$median_duration_10min[agent] <- ifelse(length(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent])==0,NA,median(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_crate_prev_25pc$max_duration_10min[agent] <- ifelse(length(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent])==0,NA,max(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_crate_prev_25pc$contamination_events_10min[agent] <- sum(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_crate_prev_25pc$times_persistent_10min[agent] <- sum(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent]>agents_list_crate_prev_25pc$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_crate_prev_25pc$q1_duration_10min[agent] <- quantile(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_crate_prev_25pc$q3_duration_10min[agent] <- quantile(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_crate_prev_25pc$min_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent])==0) || (agents_list_crate_prev_25pc$times_persistent_10min[agent]==0),NA,min(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent & Facility_B_durations_crate_prev_25pc_10min$duration>=agents_list_crate_prev_25pc$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_crate_prev_25pc$mean_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent])==0) || (agents_list_crate_prev_25pc$times_persistent_10min[agent]==0),NA,mean(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent & Facility_B_durations_crate_prev_25pc_10min$duration>=agents_list_crate_prev_25pc$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_crate_prev_25pc$median_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent])==0) || (agents_list_crate_prev_25pc$times_persistent_10min[agent]==0),NA,median(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent & Facility_B_durations_crate_prev_25pc_10min$duration>=agents_list_crate_prev_25pc$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_crate_prev_25pc$max_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent])==0) || (agents_list_crate_prev_25pc$times_persistent_10min[agent]==0),NA,max(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent & Facility_B_durations_crate_prev_25pc_10min$duration>=agents_list_crate_prev_25pc$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_crate_prev_25pc$q1_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent])==0) || (agents_list_crate_prev_25pc$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent & Facility_B_durations_crate_prev_25pc_10min$duration>=agents_list_crate_prev_25pc$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_crate_prev_25pc$q3_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent])==0) || (agents_list_crate_prev_25pc$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent & Facility_B_durations_crate_prev_25pc_10min$duration>=agents_list_crate_prev_25pc$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations (Does not account for iterations with 0 events)
  x <- Facility_B_durations_crate_prev_25pc_10min[which(Facility_B_durations_crate_prev_25pc_10min$agent==agent & Facility_B_durations_crate_prev_25pc_10min$duration>agents_list_crate_prev_25pc$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean (Does account for iterations with 0 events)
  agents_list_crate_prev_25pc$mean_times_persistent_10min[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_crate_prev_25pc$mean_times_persistent_10min[which(is.na(agents_list_crate_prev_25pc$mean_times_persistent_10min))] <- 0
  #Division by total number of iterations in simulation
  agents_list_crate_prev_25pc$balanced_times_persistent_10min[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_crate_prev_25pc_10min$duration[Facility_B_durations_crate_prev_25pc_10min$agent==agent])!=0) || (agents_list_crate_prev_25pc$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_crate_prev_25pc$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_crate_prev_25pc_10min <- rbind(
        persistent_short_durations_list_crate_prev_25pc_10min,
        Facility_B_durations_crate_prev_25pc_10min[Facility_B_durations_crate_prev_25pc_10min$agent==agent & Facility_B_durations_crate_prev_25pc_10min$duration>agents_list_crate_prev_25pc$time_to_persistence[agent],]
      )
    } else if(agents_list_crate_prev_25pc$time_to_persistence[agent]==336 && agents_list_crate_prev_25pc$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_crate_prev_25pc_10min <- rbind(
        persistent_long_durations_list_crate_prev_25pc_10min,
        Facility_B_durations_crate_prev_25pc_10min[Facility_B_durations_crate_prev_25pc_10min$agent==agent & Facility_B_durations_crate_prev_25pc_10min$duration>agents_list_crate_prev_25pc$time_to_persistence[agent],]
      )
    } else if(agents_list_crate_prev_25pc$time_to_persistence[agent]==336 && agents_list_crate_prev_25pc$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_crate_prev_25pc_10min <- rbind(
        persistent_uncleanable_durations_list_crate_prev_25pc_10min,
        Facility_B_durations_crate_prev_25pc_10min[Facility_B_durations_crate_prev_25pc_10min$agent==agent & Facility_B_durations_crate_prev_25pc_10min$duration>agents_list_crate_prev_25pc$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_crate_prev_25pc$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_crate_prev_25pc_10min <- rbind(
      transient_short_durations_list_crate_prev_25pc_10min,
      Facility_B_durations_crate_prev_25pc_10min[Facility_B_durations_crate_prev_25pc_10min$agent==agent & Facility_B_durations_crate_prev_25pc_10min$duration<=agents_list_crate_prev_25pc$time_to_persistence[agent],]
    )
  } else if(agents_list_crate_prev_25pc$time_to_persistence[agent]==336 && agents_list_crate_prev_25pc$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_crate_prev_25pc_10min <- rbind(
      transient_long_durations_list_crate_prev_25pc_10min,
      Facility_B_durations_crate_prev_25pc_10min[Facility_B_durations_crate_prev_25pc_10min$agent==agent & Facility_B_durations_crate_prev_25pc_10min$duration<=agents_list_crate_prev_25pc$time_to_persistence[agent],]
    )
  } else if(agents_list_crate_prev_25pc$time_to_persistence[agent]==336 && agents_list_crate_prev_25pc$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_crate_prev_25pc_10min <- rbind(
      transient_uncleanable_durations_list_crate_prev_25pc_10min,
      Facility_B_durations_crate_prev_25pc_10min[Facility_B_durations_crate_prev_25pc_10min$agent==agent & Facility_B_durations_crate_prev_25pc_10min$duration<=agents_list_crate_prev_25pc$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

# Facility_B_crate_prev_25pc_agents_melted_monday_preop <- Facility_B_crate_prev_25pc_agents_melted[which(Facility_B_crate_prev_25pc_agents_melted$tick==33|Facility_B_crate_prev_25pc_agents_melted$tick==201|Facility_B_crate_prev_25pc_agents_melted$tick==369|Facility_B_crate_prev_25pc_agents_melted$tick==537|Facility_B_crate_prev_25pc_agents_melted$tick==705|Facility_B_crate_prev_25pc_agents_melted$tick==873|Facility_B_crate_prev_25pc_agents_melted$tick==1041|Facility_B_crate_prev_25pc_agents_melted$tick==1209),]
# 
# Facility_B_crate_prev_25pc_agents_melted_tuesday_preop <- Facility_B_crate_prev_25pc_agents_melted[which(Facility_B_crate_prev_25pc_agents_melted$tick==57|Facility_B_crate_prev_25pc_agents_melted$tick==225|Facility_B_crate_prev_25pc_agents_melted$tick==393|Facility_B_crate_prev_25pc_agents_melted$tick==561|Facility_B_crate_prev_25pc_agents_melted$tick==729|Facility_B_crate_prev_25pc_agents_melted$tick==897|Facility_B_crate_prev_25pc_agents_melted$tick==1065|Facility_B_crate_prev_25pc_agents_melted$tick==1233),]
# 
# Facility_B_crate_prev_25pc_agents_melted_wednesday_preop <- Facility_B_crate_prev_25pc_agents_melted[which(Facility_B_crate_prev_25pc_agents_melted$tick==81|Facility_B_crate_prev_25pc_agents_melted$tick==249|Facility_B_crate_prev_25pc_agents_melted$tick==417|Facility_B_crate_prev_25pc_agents_melted$tick==585|Facility_B_crate_prev_25pc_agents_melted$tick==753|Facility_B_crate_prev_25pc_agents_melted$tick==921|Facility_B_crate_prev_25pc_agents_melted$tick==1089|Facility_B_crate_prev_25pc_agents_melted$tick==1257),]
# 
# Facility_B_crate_prev_25pc_agents_melted_thursday_preop <- Facility_B_crate_prev_25pc_agents_melted[which(Facility_B_crate_prev_25pc_agents_melted$tick==105|Facility_B_crate_prev_25pc_agents_melted$tick==273|Facility_B_crate_prev_25pc_agents_melted$tick==441|Facility_B_crate_prev_25pc_agents_melted$tick==609|Facility_B_crate_prev_25pc_agents_melted$tick==777|Facility_B_crate_prev_25pc_agents_melted$tick==945|Facility_B_crate_prev_25pc_agents_melted$tick==1113|Facility_B_crate_prev_25pc_agents_melted$tick==1281),]
# 
# Facility_B_crate_prev_25pc_agents_melted_friday_preop <- Facility_B_crate_prev_25pc_agents_melted[which(Facility_B_crate_prev_25pc_agents_melted$tick==129|Facility_B_crate_prev_25pc_agents_melted$tick==297|Facility_B_crate_prev_25pc_agents_melted$tick==465|Facility_B_crate_prev_25pc_agents_melted$tick==633|Facility_B_crate_prev_25pc_agents_melted$tick==801|Facility_B_crate_prev_25pc_agents_melted$tick==969|Facility_B_crate_prev_25pc_agents_melted$tick==1137|Facility_B_crate_prev_25pc_agents_melted$tick==1305),]

Facility_B_crate_prev_25pc_agents_melted_ff <- as.ffdf(Facility_B_crate_prev_25pc_agents_melted)
rm(Facility_B_crate_prev_25pc_agents_melted)
gc()
```

```{r import Crate Prevalence 0%}
NL_table_Crate_Prev_0pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-28-16-05 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_Crate_Prev_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Crate_Prev_0pc <- NL_table_Crate_Prev_0pc[NL_table_Crate_Prev_0pc$scenario==5,]

while (any(grepl('-', names(NL_table_Crate_Prev_0pc), fixed = TRUE))) {
  NL_table_Crate_Prev_0pc <- NL_table_Crate_Prev_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Crate_Prev_0pc), fixed = TRUE))) {
  NL_table_Crate_Prev_0pc <- NL_table_Crate_Prev_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Crate_Prev_0pc), fixed = TRUE))) {
  NL_table_Crate_Prev_0pc <- NL_table_Crate_Prev_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Crate_Prev_0pc), fixed = TRUE))) {
  NL_table_Crate_Prev_0pc <- NL_table_Crate_Prev_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Crate_Prev_0pc[ , ..list_columns]

NL_table_Crate_Prev_0pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Crate_Prev_0pc <- as.data.frame(NL_table_Crate_Prev_0pc)

NL_table_Crate_Prev_0pc[NL_table_Crate_Prev_0pc==-1] <- NA

NL_table_Crate_Prev_0pc <- subset(NL_table_Crate_Prev_0pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Crate_Prev_0pc)[names(NL_table_Crate_Prev_0pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Crate_Prev_0pc)[names(NL_table_Crate_Prev_0pc)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Crate_Prev_0pc$loading_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_loading_w1wed_conc_list <- append(crate_prev_0pc_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_loading_w1wed_conc_matrix <- matrix(unlist(crate_prev_0pc_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_cleaning_w1wed_conc_list <- append(crate_prev_0pc_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_cleaning_w1wed_conc_matrix <- matrix(unlist(crate_prev_0pc_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_0pc$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_0pc_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_0pc_drying_w1wed_conc_list <- append(crate_prev_0pc_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_0pc$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_sorting_w1wed_conc_list <- append(crate_prev_0pc_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_sorting_w1wed_conc_matrix <- matrix(unlist(crate_prev_0pc_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_tray_packing_w1wed_conc_list <- append(crate_prev_0pc_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_tray_packing_w1wed_conc_matrix <- matrix(unlist(crate_prev_0pc_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$reject_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_reject_w1wed_conc_list <- append(crate_prev_0pc_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_reject_w1wed_conc_matrix <- matrix(unlist(crate_prev_0pc_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$other_w1wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_other_w1wed_conc_list <- append(crate_prev_0pc_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_other_w1wed_conc_matrix <- matrix(unlist(crate_prev_0pc_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_0pc_loading_concs <- as.data.frame(crate_prev_0pc_loading_w1wed_conc_list)
crate_prev_0pc_loading_concs$area <- as.factor('loading')
crate_prev_0pc_loading_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_0pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_cleaning_concs <- as.data.frame(crate_prev_0pc_cleaning_w1wed_conc_list)
crate_prev_0pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_0pc_cleaning_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_sorting_concs <- as.data.frame(crate_prev_0pc_sorting_w1wed_conc_list)
crate_prev_0pc_sorting_concs$area <- as.factor('sorting')
crate_prev_0pc_sorting_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_0pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_reject_concs <- as.data.frame(crate_prev_0pc_reject_w1wed_conc_list)
crate_prev_0pc_reject_concs$area <- as.factor('reject')
crate_prev_0pc_reject_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_0pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_tray_packing_concs <- as.data.frame(crate_prev_0pc_tray_packing_w1wed_conc_list)
crate_prev_0pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_0pc_tray_packing_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_other_concs <- as.data.frame(crate_prev_0pc_other_w1wed_conc_list)
crate_prev_0pc_other_concs$area <- as.factor('other')
crate_prev_0pc_other_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_other_concs$water <- as.factor('Dry')
names(crate_prev_0pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_w1wed_concs <- rbind(crate_prev_0pc_loading_concs,crate_prev_0pc_cleaning_concs,crate_prev_0pc_sorting_concs,crate_prev_0pc_tray_packing_concs,crate_prev_0pc_reject_concs,crate_prev_0pc_other_concs)

crate_prev_0pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_0pc$loading_w1wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_loading_prev$area <- as.factor('loading')
crate_prev_0pc_loading_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_0pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_0pc$cleaning_w1wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_0pc_cleaning_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_0pc$sorting_w1wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_sorting_prev$area <- as.factor('sorting')
crate_prev_0pc_sorting_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_0pc$reject_w1wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_reject_prev$area <- as.factor('reject')
crate_prev_0pc_reject_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_0pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_0pc$tray_packing_w1wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_0pc_tray_packing_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_other_prev <- as.data.frame(NL_table_Crate_Prev_0pc$other_w1wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_other_prev$area <- as.factor('other')
crate_prev_0pc_other_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_other_prev$water <- as.factor('Dry')
names(crate_prev_0pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_w1wed_prev <- rbind(crate_prev_0pc_loading_prev,crate_prev_0pc_cleaning_prev,crate_prev_0pc_sorting_prev,crate_prev_0pc_tray_packing_prev,crate_prev_0pc_reject_prev,crate_prev_0pc_other_prev)

crate_prev_0pc_w1wed_wet_prev <- as.data.frame(crate_prev_0pc_loading_prev$prevalence*21/100+crate_prev_0pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_0pc_w1wed_wet_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_w1wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_0pc_w1wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_0pc_w1wed_dry_prev <- as.data.frame(crate_prev_0pc_sorting_prev$prevalence*20/100+crate_prev_0pc_reject_prev$prevalence*23/100+crate_prev_0pc_tray_packing_prev$prevalence*123/100+crate_prev_0pc_other_prev$prevalence*10/100)/176*100
crate_prev_0pc_w1wed_dry_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_w1wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_0pc_w1wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_0pc_w1wed_recombined_prev <- rbind(crate_prev_0pc_w1wed_wet_prev, crate_prev_0pc_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Crate_Prev_0pc$loading_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_loading_w2wed_conc_list <- append(crate_prev_0pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_loading_w2wed_conc_matrix <- matrix(unlist(crate_prev_0pc_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_cleaning_w2wed_conc_list <- append(crate_prev_0pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_cleaning_w2wed_conc_matrix <- matrix(unlist(crate_prev_0pc_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_0pc$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_0pc_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_0pc_drying_w2wed_conc_list <- append(crate_prev_0pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_0pc$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_sorting_w2wed_conc_list <- append(crate_prev_0pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_sorting_w2wed_conc_matrix <- matrix(unlist(crate_prev_0pc_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_tray_packing_w2wed_conc_list <- append(crate_prev_0pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_tray_packing_w2wed_conc_matrix <- matrix(unlist(crate_prev_0pc_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$reject_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_reject_w2wed_conc_list <- append(crate_prev_0pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_reject_w2wed_conc_matrix <- matrix(unlist(crate_prev_0pc_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$other_w2wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_other_w2wed_conc_list <- append(crate_prev_0pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_other_w2wed_conc_matrix <- matrix(unlist(crate_prev_0pc_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_0pc_loading_concs <- as.data.frame(crate_prev_0pc_loading_w2wed_conc_list)
crate_prev_0pc_loading_concs$area <- as.factor('loading')
crate_prev_0pc_loading_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_0pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_cleaning_concs <- as.data.frame(crate_prev_0pc_cleaning_w2wed_conc_list)
crate_prev_0pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_0pc_cleaning_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_sorting_concs <- as.data.frame(crate_prev_0pc_sorting_w2wed_conc_list)
crate_prev_0pc_sorting_concs$area <- as.factor('sorting')
crate_prev_0pc_sorting_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_0pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_reject_concs <- as.data.frame(crate_prev_0pc_reject_w2wed_conc_list)
crate_prev_0pc_reject_concs$area <- as.factor('reject')
crate_prev_0pc_reject_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_0pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_tray_packing_concs <- as.data.frame(crate_prev_0pc_tray_packing_w2wed_conc_list)
crate_prev_0pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_0pc_tray_packing_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_other_concs <- as.data.frame(crate_prev_0pc_other_w2wed_conc_list)
crate_prev_0pc_other_concs$area <- as.factor('other')
crate_prev_0pc_other_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_other_concs$water <- as.factor('Dry')
names(crate_prev_0pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_w2wed_concs <- rbind(crate_prev_0pc_loading_concs,crate_prev_0pc_cleaning_concs,crate_prev_0pc_sorting_concs,crate_prev_0pc_tray_packing_concs,crate_prev_0pc_reject_concs,crate_prev_0pc_other_concs)

crate_prev_0pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_0pc$loading_w2wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_loading_prev$area <- as.factor('loading')
crate_prev_0pc_loading_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_0pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_0pc$cleaning_w2wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_0pc_cleaning_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_0pc$sorting_w2wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_sorting_prev$area <- as.factor('sorting')
crate_prev_0pc_sorting_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_0pc$reject_w2wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_reject_prev$area <- as.factor('reject')
crate_prev_0pc_reject_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_0pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_0pc$tray_packing_w2wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_0pc_tray_packing_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_other_prev <- as.data.frame(NL_table_Crate_Prev_0pc$other_w2wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_other_prev$area <- as.factor('other')
crate_prev_0pc_other_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_other_prev$water <- as.factor('Dry')
names(crate_prev_0pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_w2wed_prev <- rbind(crate_prev_0pc_loading_prev,crate_prev_0pc_cleaning_prev,crate_prev_0pc_sorting_prev,crate_prev_0pc_tray_packing_prev,crate_prev_0pc_reject_prev,crate_prev_0pc_other_prev)

crate_prev_0pc_w2wed_wet_prev <- as.data.frame(crate_prev_0pc_loading_prev$prevalence*21/100+crate_prev_0pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_0pc_w2wed_wet_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_w2wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_0pc_w2wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_0pc_w2wed_dry_prev <- as.data.frame(crate_prev_0pc_sorting_prev$prevalence*20/100+crate_prev_0pc_reject_prev$prevalence*23/100+crate_prev_0pc_tray_packing_prev$prevalence*123/100+crate_prev_0pc_other_prev$prevalence*10/100)/176*100
crate_prev_0pc_w2wed_dry_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_w2wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_0pc_w2wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_0pc_w2wed_recombined_prev <- rbind(crate_prev_0pc_w2wed_wet_prev, crate_prev_0pc_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Crate_Prev_0pc$loading_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_loading_w3wed_conc_list <- append(crate_prev_0pc_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_loading_w3wed_conc_matrix <- matrix(unlist(crate_prev_0pc_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_cleaning_w3wed_conc_list <- append(crate_prev_0pc_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_cleaning_w3wed_conc_matrix <- matrix(unlist(crate_prev_0pc_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_0pc$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_0pc_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_0pc_drying_w3wed_conc_list <- append(crate_prev_0pc_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_0pc$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_sorting_w3wed_conc_list <- append(crate_prev_0pc_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_sorting_w3wed_conc_matrix <- matrix(unlist(crate_prev_0pc_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_tray_packing_w3wed_conc_list <- append(crate_prev_0pc_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_tray_packing_w3wed_conc_matrix <- matrix(unlist(crate_prev_0pc_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$reject_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_reject_w3wed_conc_list <- append(crate_prev_0pc_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_reject_w3wed_conc_matrix <- matrix(unlist(crate_prev_0pc_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$other_w3wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_other_w3wed_conc_list <- append(crate_prev_0pc_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_other_w3wed_conc_matrix <- matrix(unlist(crate_prev_0pc_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_0pc_loading_concs <- as.data.frame(crate_prev_0pc_loading_w3wed_conc_list)
crate_prev_0pc_loading_concs$area <- as.factor('loading')
crate_prev_0pc_loading_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_0pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_cleaning_concs <- as.data.frame(crate_prev_0pc_cleaning_w3wed_conc_list)
crate_prev_0pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_0pc_cleaning_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_sorting_concs <- as.data.frame(crate_prev_0pc_sorting_w3wed_conc_list)
crate_prev_0pc_sorting_concs$area <- as.factor('sorting')
crate_prev_0pc_sorting_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_0pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_reject_concs <- as.data.frame(crate_prev_0pc_reject_w3wed_conc_list)
crate_prev_0pc_reject_concs$area <- as.factor('reject')
crate_prev_0pc_reject_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_0pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_tray_packing_concs <- as.data.frame(crate_prev_0pc_tray_packing_w3wed_conc_list)
crate_prev_0pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_0pc_tray_packing_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_other_concs <- as.data.frame(crate_prev_0pc_other_w3wed_conc_list)
crate_prev_0pc_other_concs$area <- as.factor('other')
crate_prev_0pc_other_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_other_concs$water <- as.factor('Dry')
names(crate_prev_0pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_w3wed_concs <- rbind(crate_prev_0pc_loading_concs,crate_prev_0pc_cleaning_concs,crate_prev_0pc_sorting_concs,crate_prev_0pc_tray_packing_concs,crate_prev_0pc_reject_concs,crate_prev_0pc_other_concs)

crate_prev_0pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_0pc$loading_w3wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_loading_prev$area <- as.factor('loading')
crate_prev_0pc_loading_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_0pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_0pc$cleaning_w3wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_0pc_cleaning_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_0pc$sorting_w3wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_sorting_prev$area <- as.factor('sorting')
crate_prev_0pc_sorting_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_0pc$reject_w3wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_reject_prev$area <- as.factor('reject')
crate_prev_0pc_reject_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_0pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_0pc$tray_packing_w3wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_0pc_tray_packing_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_other_prev <- as.data.frame(NL_table_Crate_Prev_0pc$other_w3wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_other_prev$area <- as.factor('other')
crate_prev_0pc_other_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_other_prev$water <- as.factor('Dry')
names(crate_prev_0pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_w3wed_prev <- rbind(crate_prev_0pc_loading_prev,crate_prev_0pc_cleaning_prev,crate_prev_0pc_sorting_prev,crate_prev_0pc_tray_packing_prev,crate_prev_0pc_reject_prev,crate_prev_0pc_other_prev)

crate_prev_0pc_w3wed_wet_prev <- as.data.frame(crate_prev_0pc_loading_prev$prevalence*21/100+crate_prev_0pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_0pc_w3wed_wet_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_w3wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_0pc_w3wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_0pc_w3wed_dry_prev <- as.data.frame(crate_prev_0pc_sorting_prev$prevalence*20/100+crate_prev_0pc_reject_prev$prevalence*23/100+crate_prev_0pc_tray_packing_prev$prevalence*123/100+crate_prev_0pc_other_prev$prevalence*10/100)/176*100
crate_prev_0pc_w3wed_dry_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_w3wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_0pc_w3wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_0pc_w3wed_recombined_prev <- rbind(crate_prev_0pc_w3wed_wet_prev, crate_prev_0pc_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Crate_Prev_0pc$loading_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_loading_w4wed_conc_list <- append(crate_prev_0pc_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_loading_w4wed_conc_matrix <- matrix(unlist(crate_prev_0pc_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_cleaning_w4wed_conc_list <- append(crate_prev_0pc_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_cleaning_w4wed_conc_matrix <- matrix(unlist(crate_prev_0pc_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_0pc$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_0pc_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_0pc_drying_w4wed_conc_list <- append(crate_prev_0pc_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_0pc$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_sorting_w4wed_conc_list <- append(crate_prev_0pc_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_sorting_w4wed_conc_matrix <- matrix(unlist(crate_prev_0pc_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_tray_packing_w4wed_conc_list <- append(crate_prev_0pc_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_tray_packing_w4wed_conc_matrix <- matrix(unlist(crate_prev_0pc_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$reject_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_reject_w4wed_conc_list <- append(crate_prev_0pc_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_reject_w4wed_conc_matrix <- matrix(unlist(crate_prev_0pc_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$other_w4wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_other_w4wed_conc_list <- append(crate_prev_0pc_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_other_w4wed_conc_matrix <- matrix(unlist(crate_prev_0pc_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_0pc_loading_concs <- as.data.frame(crate_prev_0pc_loading_w4wed_conc_list)
crate_prev_0pc_loading_concs$area <- as.factor('loading')
crate_prev_0pc_loading_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_0pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_cleaning_concs <- as.data.frame(crate_prev_0pc_cleaning_w4wed_conc_list)
crate_prev_0pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_0pc_cleaning_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_sorting_concs <- as.data.frame(crate_prev_0pc_sorting_w4wed_conc_list)
crate_prev_0pc_sorting_concs$area <- as.factor('sorting')
crate_prev_0pc_sorting_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_0pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_reject_concs <- as.data.frame(crate_prev_0pc_reject_w4wed_conc_list)
crate_prev_0pc_reject_concs$area <- as.factor('reject')
crate_prev_0pc_reject_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_0pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_tray_packing_concs <- as.data.frame(crate_prev_0pc_tray_packing_w4wed_conc_list)
crate_prev_0pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_0pc_tray_packing_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_other_concs <- as.data.frame(crate_prev_0pc_other_w4wed_conc_list)
crate_prev_0pc_other_concs$area <- as.factor('other')
crate_prev_0pc_other_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_other_concs$water <- as.factor('Dry')
names(crate_prev_0pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_w4wed_concs <- rbind(crate_prev_0pc_loading_concs,crate_prev_0pc_cleaning_concs,crate_prev_0pc_sorting_concs,crate_prev_0pc_tray_packing_concs,crate_prev_0pc_reject_concs,crate_prev_0pc_other_concs)

crate_prev_0pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_0pc$loading_w4wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_loading_prev$area <- as.factor('loading')
crate_prev_0pc_loading_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_0pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_0pc$cleaning_w4wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_0pc_cleaning_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_0pc$sorting_w4wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_sorting_prev$area <- as.factor('sorting')
crate_prev_0pc_sorting_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_0pc$reject_w4wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_reject_prev$area <- as.factor('reject')
crate_prev_0pc_reject_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_0pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_0pc$tray_packing_w4wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_0pc_tray_packing_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_other_prev <- as.data.frame(NL_table_Crate_Prev_0pc$other_w4wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_other_prev$area <- as.factor('other')
crate_prev_0pc_other_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_other_prev$water <- as.factor('Dry')
names(crate_prev_0pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_w4wed_prev <- rbind(crate_prev_0pc_loading_prev,crate_prev_0pc_cleaning_prev,crate_prev_0pc_sorting_prev,crate_prev_0pc_tray_packing_prev,crate_prev_0pc_reject_prev,crate_prev_0pc_other_prev)

crate_prev_0pc_w4wed_wet_prev <- as.data.frame(crate_prev_0pc_loading_prev$prevalence*21/100+crate_prev_0pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_0pc_w4wed_wet_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_w4wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_0pc_w4wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_0pc_w4wed_dry_prev <- as.data.frame(crate_prev_0pc_sorting_prev$prevalence*20/100+crate_prev_0pc_reject_prev$prevalence*23/100+crate_prev_0pc_tray_packing_prev$prevalence*123/100+crate_prev_0pc_other_prev$prevalence*10/100)/176*100
crate_prev_0pc_w4wed_dry_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_w4wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_0pc_w4wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_0pc_w4wed_recombined_prev <- rbind(crate_prev_0pc_w4wed_wet_prev, crate_prev_0pc_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Crate_Prev_0pc$loading_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_loading_w5wed_conc_list <- append(crate_prev_0pc_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_loading_w5wed_conc_matrix <- matrix(unlist(crate_prev_0pc_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_cleaning_w5wed_conc_list <- append(crate_prev_0pc_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_cleaning_w5wed_conc_matrix <- matrix(unlist(crate_prev_0pc_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_0pc$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_0pc_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_0pc_drying_w5wed_conc_list <- append(crate_prev_0pc_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_0pc$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_sorting_w5wed_conc_list <- append(crate_prev_0pc_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_sorting_w5wed_conc_matrix <- matrix(unlist(crate_prev_0pc_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_tray_packing_w5wed_conc_list <- append(crate_prev_0pc_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_tray_packing_w5wed_conc_matrix <- matrix(unlist(crate_prev_0pc_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$reject_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_reject_w5wed_conc_list <- append(crate_prev_0pc_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_reject_w5wed_conc_matrix <- matrix(unlist(crate_prev_0pc_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$other_w5wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_other_w5wed_conc_list <- append(crate_prev_0pc_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_other_w5wed_conc_matrix <- matrix(unlist(crate_prev_0pc_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_0pc_loading_concs <- as.data.frame(crate_prev_0pc_loading_w5wed_conc_list)
crate_prev_0pc_loading_concs$area <- as.factor('loading')
crate_prev_0pc_loading_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_0pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_cleaning_concs <- as.data.frame(crate_prev_0pc_cleaning_w5wed_conc_list)
crate_prev_0pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_0pc_cleaning_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_sorting_concs <- as.data.frame(crate_prev_0pc_sorting_w5wed_conc_list)
crate_prev_0pc_sorting_concs$area <- as.factor('sorting')
crate_prev_0pc_sorting_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_0pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_reject_concs <- as.data.frame(crate_prev_0pc_reject_w5wed_conc_list)
crate_prev_0pc_reject_concs$area <- as.factor('reject')
crate_prev_0pc_reject_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_0pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_tray_packing_concs <- as.data.frame(crate_prev_0pc_tray_packing_w5wed_conc_list)
crate_prev_0pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_0pc_tray_packing_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_other_concs <- as.data.frame(crate_prev_0pc_other_w5wed_conc_list)
crate_prev_0pc_other_concs$area <- as.factor('other')
crate_prev_0pc_other_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_other_concs$water <- as.factor('Dry')
names(crate_prev_0pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_w5wed_concs <- rbind(crate_prev_0pc_loading_concs,crate_prev_0pc_cleaning_concs,crate_prev_0pc_sorting_concs,crate_prev_0pc_tray_packing_concs,crate_prev_0pc_reject_concs,crate_prev_0pc_other_concs)

crate_prev_0pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_0pc$loading_w5wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_loading_prev$area <- as.factor('loading')
crate_prev_0pc_loading_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_0pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_0pc$cleaning_w5wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_0pc_cleaning_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_0pc$sorting_w5wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_sorting_prev$area <- as.factor('sorting')
crate_prev_0pc_sorting_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_0pc$reject_w5wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_reject_prev$area <- as.factor('reject')
crate_prev_0pc_reject_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_0pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_0pc$tray_packing_w5wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_0pc_tray_packing_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_other_prev <- as.data.frame(NL_table_Crate_Prev_0pc$other_w5wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_other_prev$area <- as.factor('other')
crate_prev_0pc_other_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_other_prev$water <- as.factor('Dry')
names(crate_prev_0pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_w5wed_prev <- rbind(crate_prev_0pc_loading_prev,crate_prev_0pc_cleaning_prev,crate_prev_0pc_sorting_prev,crate_prev_0pc_tray_packing_prev,crate_prev_0pc_reject_prev,crate_prev_0pc_other_prev)

crate_prev_0pc_w5wed_wet_prev <- as.data.frame(crate_prev_0pc_loading_prev$prevalence*21/100+crate_prev_0pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_0pc_w5wed_wet_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_w5wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_0pc_w5wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_0pc_w5wed_dry_prev <- as.data.frame(crate_prev_0pc_sorting_prev$prevalence*20/100+crate_prev_0pc_reject_prev$prevalence*23/100+crate_prev_0pc_tray_packing_prev$prevalence*123/100+crate_prev_0pc_other_prev$prevalence*10/100)/176*100
crate_prev_0pc_w5wed_dry_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_w5wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_0pc_w5wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_0pc_w5wed_recombined_prev <- rbind(crate_prev_0pc_w5wed_wet_prev, crate_prev_0pc_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Crate_Prev_0pc$loading_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_loading_w6wed_conc_list <- append(crate_prev_0pc_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_loading_w6wed_conc_matrix <- matrix(unlist(crate_prev_0pc_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_cleaning_w6wed_conc_list <- append(crate_prev_0pc_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_cleaning_w6wed_conc_matrix <- matrix(unlist(crate_prev_0pc_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_0pc$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_0pc_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_0pc_drying_w6wed_conc_list <- append(crate_prev_0pc_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_0pc$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_sorting_w6wed_conc_list <- append(crate_prev_0pc_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_sorting_w6wed_conc_matrix <- matrix(unlist(crate_prev_0pc_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_tray_packing_w6wed_conc_list <- append(crate_prev_0pc_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_tray_packing_w6wed_conc_matrix <- matrix(unlist(crate_prev_0pc_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$reject_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_reject_w6wed_conc_list <- append(crate_prev_0pc_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_reject_w6wed_conc_matrix <- matrix(unlist(crate_prev_0pc_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$other_w6wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_other_w6wed_conc_list <- append(crate_prev_0pc_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_other_w6wed_conc_matrix <- matrix(unlist(crate_prev_0pc_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_0pc_loading_concs <- as.data.frame(crate_prev_0pc_loading_w6wed_conc_list)
crate_prev_0pc_loading_concs$area <- as.factor('loading')
crate_prev_0pc_loading_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_0pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_cleaning_concs <- as.data.frame(crate_prev_0pc_cleaning_w6wed_conc_list)
crate_prev_0pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_0pc_cleaning_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_sorting_concs <- as.data.frame(crate_prev_0pc_sorting_w6wed_conc_list)
crate_prev_0pc_sorting_concs$area <- as.factor('sorting')
crate_prev_0pc_sorting_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_0pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_reject_concs <- as.data.frame(crate_prev_0pc_reject_w6wed_conc_list)
crate_prev_0pc_reject_concs$area <- as.factor('reject')
crate_prev_0pc_reject_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_0pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_tray_packing_concs <- as.data.frame(crate_prev_0pc_tray_packing_w6wed_conc_list)
crate_prev_0pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_0pc_tray_packing_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_other_concs <- as.data.frame(crate_prev_0pc_other_w6wed_conc_list)
crate_prev_0pc_other_concs$area <- as.factor('other')
crate_prev_0pc_other_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_other_concs$water <- as.factor('Dry')
names(crate_prev_0pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_w6wed_concs <- rbind(crate_prev_0pc_loading_concs,crate_prev_0pc_cleaning_concs,crate_prev_0pc_sorting_concs,crate_prev_0pc_tray_packing_concs,crate_prev_0pc_reject_concs,crate_prev_0pc_other_concs)

crate_prev_0pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_0pc$loading_w6wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_loading_prev$area <- as.factor('loading')
crate_prev_0pc_loading_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_0pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_0pc$cleaning_w6wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_0pc_cleaning_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_0pc$sorting_w6wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_sorting_prev$area <- as.factor('sorting')
crate_prev_0pc_sorting_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_0pc$reject_w6wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_reject_prev$area <- as.factor('reject')
crate_prev_0pc_reject_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_0pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_0pc$tray_packing_w6wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_0pc_tray_packing_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_other_prev <- as.data.frame(NL_table_Crate_Prev_0pc$other_w6wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_other_prev$area <- as.factor('other')
crate_prev_0pc_other_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_other_prev$water <- as.factor('Dry')
names(crate_prev_0pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_w6wed_prev <- rbind(crate_prev_0pc_loading_prev,crate_prev_0pc_cleaning_prev,crate_prev_0pc_sorting_prev,crate_prev_0pc_tray_packing_prev,crate_prev_0pc_reject_prev,crate_prev_0pc_other_prev)

crate_prev_0pc_w6wed_wet_prev <- as.data.frame(crate_prev_0pc_loading_prev$prevalence*21/100+crate_prev_0pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_0pc_w6wed_wet_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_w6wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_0pc_w6wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_0pc_w6wed_dry_prev <- as.data.frame(crate_prev_0pc_sorting_prev$prevalence*20/100+crate_prev_0pc_reject_prev$prevalence*23/100+crate_prev_0pc_tray_packing_prev$prevalence*123/100+crate_prev_0pc_other_prev$prevalence*10/100)/176*100
crate_prev_0pc_w6wed_dry_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_w6wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_0pc_w6wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_0pc_w6wed_recombined_prev <- rbind(crate_prev_0pc_w6wed_wet_prev, crate_prev_0pc_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Crate_Prev_0pc$loading_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_loading_w7wed_conc_list <- append(crate_prev_0pc_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_loading_w7wed_conc_matrix <- matrix(unlist(crate_prev_0pc_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_cleaning_w7wed_conc_list <- append(crate_prev_0pc_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_cleaning_w7wed_conc_matrix <- matrix(unlist(crate_prev_0pc_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_0pc$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_0pc_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_0pc_drying_w7wed_conc_list <- append(crate_prev_0pc_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_0pc$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_sorting_w7wed_conc_list <- append(crate_prev_0pc_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_sorting_w7wed_conc_matrix <- matrix(unlist(crate_prev_0pc_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_tray_packing_w7wed_conc_list <- append(crate_prev_0pc_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_tray_packing_w7wed_conc_matrix <- matrix(unlist(crate_prev_0pc_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$reject_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_reject_w7wed_conc_list <- append(crate_prev_0pc_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_reject_w7wed_conc_matrix <- matrix(unlist(crate_prev_0pc_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$other_w7wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_other_w7wed_conc_list <- append(crate_prev_0pc_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_other_w7wed_conc_matrix <- matrix(unlist(crate_prev_0pc_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_0pc_loading_concs <- as.data.frame(crate_prev_0pc_loading_w7wed_conc_list)
crate_prev_0pc_loading_concs$area <- as.factor('loading')
crate_prev_0pc_loading_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_0pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_cleaning_concs <- as.data.frame(crate_prev_0pc_cleaning_w7wed_conc_list)
crate_prev_0pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_0pc_cleaning_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_sorting_concs <- as.data.frame(crate_prev_0pc_sorting_w7wed_conc_list)
crate_prev_0pc_sorting_concs$area <- as.factor('sorting')
crate_prev_0pc_sorting_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_0pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_reject_concs <- as.data.frame(crate_prev_0pc_reject_w7wed_conc_list)
crate_prev_0pc_reject_concs$area <- as.factor('reject')
crate_prev_0pc_reject_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_0pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_tray_packing_concs <- as.data.frame(crate_prev_0pc_tray_packing_w7wed_conc_list)
crate_prev_0pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_0pc_tray_packing_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_other_concs <- as.data.frame(crate_prev_0pc_other_w7wed_conc_list)
crate_prev_0pc_other_concs$area <- as.factor('other')
crate_prev_0pc_other_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_other_concs$water <- as.factor('Dry')
names(crate_prev_0pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_w7wed_concs <- rbind(crate_prev_0pc_loading_concs,crate_prev_0pc_cleaning_concs,crate_prev_0pc_sorting_concs,crate_prev_0pc_tray_packing_concs,crate_prev_0pc_reject_concs,crate_prev_0pc_other_concs)

crate_prev_0pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_0pc$loading_w7wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_loading_prev$area <- as.factor('loading')
crate_prev_0pc_loading_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_0pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_0pc$cleaning_w7wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_0pc_cleaning_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_0pc$sorting_w7wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_sorting_prev$area <- as.factor('sorting')
crate_prev_0pc_sorting_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_0pc$reject_w7wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_reject_prev$area <- as.factor('reject')
crate_prev_0pc_reject_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_0pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_0pc$tray_packing_w7wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_0pc_tray_packing_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_other_prev <- as.data.frame(NL_table_Crate_Prev_0pc$other_w7wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_other_prev$area <- as.factor('other')
crate_prev_0pc_other_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_other_prev$water <- as.factor('Dry')
names(crate_prev_0pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_w7wed_prev <- rbind(crate_prev_0pc_loading_prev,crate_prev_0pc_cleaning_prev,crate_prev_0pc_sorting_prev,crate_prev_0pc_tray_packing_prev,crate_prev_0pc_reject_prev,crate_prev_0pc_other_prev)

crate_prev_0pc_w7wed_wet_prev <- as.data.frame(crate_prev_0pc_loading_prev$prevalence*21/100+crate_prev_0pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_0pc_w7wed_wet_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_w7wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_0pc_w7wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_0pc_w7wed_dry_prev <- as.data.frame(crate_prev_0pc_sorting_prev$prevalence*20/100+crate_prev_0pc_reject_prev$prevalence*23/100+crate_prev_0pc_tray_packing_prev$prevalence*123/100+crate_prev_0pc_other_prev$prevalence*10/100)/176*100
crate_prev_0pc_w7wed_dry_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_w7wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_0pc_w7wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_0pc_w7wed_recombined_prev <- rbind(crate_prev_0pc_w7wed_wet_prev, crate_prev_0pc_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Crate_Prev_0pc$loading_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_loading_w8wed_conc_list <- append(crate_prev_0pc_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_loading_w8wed_conc_matrix <- matrix(unlist(crate_prev_0pc_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_cleaning_w8wed_conc_list <- append(crate_prev_0pc_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_cleaning_w8wed_conc_matrix <- matrix(unlist(crate_prev_0pc_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Crate_Prev_0pc$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# crate_prev_0pc_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   crate_prev_0pc_drying_w8wed_conc_list <- append(crate_prev_0pc_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Crate_Prev_0pc$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_sorting_w8wed_conc_list <- append(crate_prev_0pc_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_sorting_w8wed_conc_matrix <- matrix(unlist(crate_prev_0pc_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_tray_packing_w8wed_conc_list <- append(crate_prev_0pc_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_tray_packing_w8wed_conc_matrix <- matrix(unlist(crate_prev_0pc_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$reject_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_reject_w8wed_conc_list <- append(crate_prev_0pc_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_reject_w8wed_conc_matrix <- matrix(unlist(crate_prev_0pc_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Crate_Prev_0pc$other_w8wed_conc_list
vector <- vector[vector!='[]']
crate_prev_0pc_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  crate_prev_0pc_other_w8wed_conc_list <- append(crate_prev_0pc_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
crate_prev_0pc_other_w8wed_conc_matrix <- matrix(unlist(crate_prev_0pc_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

crate_prev_0pc_loading_concs <- as.data.frame(crate_prev_0pc_loading_w8wed_conc_list)
crate_prev_0pc_loading_concs$area <- as.factor('loading')
crate_prev_0pc_loading_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_loading_concs$water <- as.factor('Wet')
names(crate_prev_0pc_loading_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_cleaning_concs <- as.data.frame(crate_prev_0pc_cleaning_w8wed_conc_list)
crate_prev_0pc_cleaning_concs$area <- as.factor('cleaning')
crate_prev_0pc_cleaning_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_cleaning_concs$water <- as.factor('Wet')
names(crate_prev_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_sorting_concs <- as.data.frame(crate_prev_0pc_sorting_w8wed_conc_list)
crate_prev_0pc_sorting_concs$area <- as.factor('sorting')
crate_prev_0pc_sorting_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_sorting_concs$water <- as.factor('Dry')
names(crate_prev_0pc_sorting_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_reject_concs <- as.data.frame(crate_prev_0pc_reject_w8wed_conc_list)
crate_prev_0pc_reject_concs$area <- as.factor('reject')
crate_prev_0pc_reject_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_reject_concs$water <- as.factor('Dry')
names(crate_prev_0pc_reject_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_tray_packing_concs <- as.data.frame(crate_prev_0pc_tray_packing_w8wed_conc_list)
crate_prev_0pc_tray_packing_concs$area <- as.factor('tray packing')
crate_prev_0pc_tray_packing_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_tray_packing_concs$water <- as.factor('Dry')
names(crate_prev_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_other_concs <- as.data.frame(crate_prev_0pc_other_w8wed_conc_list)
crate_prev_0pc_other_concs$area <- as.factor('other')
crate_prev_0pc_other_concs$scenario <- as.factor('EC_04')
crate_prev_0pc_other_concs$water <- as.factor('Dry')
names(crate_prev_0pc_other_concs) <- c('concentration','area','scenario','water')

crate_prev_0pc_w8wed_concs <- rbind(crate_prev_0pc_loading_concs,crate_prev_0pc_cleaning_concs,crate_prev_0pc_sorting_concs,crate_prev_0pc_tray_packing_concs,crate_prev_0pc_reject_concs,crate_prev_0pc_other_concs)

crate_prev_0pc_loading_prev <- as.data.frame(NL_table_Crate_Prev_0pc$loading_w8wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_loading_prev$area <- as.factor('loading')
crate_prev_0pc_loading_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_loading_prev$water <- as.factor('Wet')
names(crate_prev_0pc_loading_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_cleaning_prev <- as.data.frame(NL_table_Crate_Prev_0pc$cleaning_w8wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_cleaning_prev$area <- as.factor('cleaning')
crate_prev_0pc_cleaning_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_cleaning_prev$water <- as.factor('Wet')
names(crate_prev_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_sorting_prev <- as.data.frame(NL_table_Crate_Prev_0pc$sorting_w8wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_sorting_prev$area <- as.factor('sorting')
crate_prev_0pc_sorting_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_sorting_prev$water <- as.factor('Dry')
names(crate_prev_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_reject_prev <- as.data.frame(NL_table_Crate_Prev_0pc$reject_w8wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_reject_prev$area <- as.factor('reject')
crate_prev_0pc_reject_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_reject_prev$water <- as.factor('Dry')
names(crate_prev_0pc_reject_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_tray_packing_prev <- as.data.frame(NL_table_Crate_Prev_0pc$tray_packing_w8wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_tray_packing_prev$area <- as.factor('tray packing')
crate_prev_0pc_tray_packing_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_tray_packing_prev$water <- as.factor('Dry')
names(crate_prev_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_other_prev <- as.data.frame(NL_table_Crate_Prev_0pc$other_w8wed_prev[order(NL_table_Crate_Prev_0pc$local_seed)])
crate_prev_0pc_other_prev$area <- as.factor('other')
crate_prev_0pc_other_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_other_prev$water <- as.factor('Dry')
names(crate_prev_0pc_other_prev) <- c('prevalence','area','scenario','water')

crate_prev_0pc_w8wed_prev <- rbind(crate_prev_0pc_loading_prev,crate_prev_0pc_cleaning_prev,crate_prev_0pc_sorting_prev,crate_prev_0pc_tray_packing_prev,crate_prev_0pc_reject_prev,crate_prev_0pc_other_prev)

crate_prev_0pc_w8wed_wet_prev <- as.data.frame(crate_prev_0pc_loading_prev$prevalence*21/100+crate_prev_0pc_cleaning_prev$prevalence*28/100)/49*100
crate_prev_0pc_w8wed_wet_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_w8wed_wet_prev$water <- as.factor('Wet')
names(crate_prev_0pc_w8wed_wet_prev) <- c('prevalence','scenario','water')

crate_prev_0pc_w8wed_dry_prev <- as.data.frame(crate_prev_0pc_sorting_prev$prevalence*20/100+crate_prev_0pc_reject_prev$prevalence*23/100+crate_prev_0pc_tray_packing_prev$prevalence*123/100+crate_prev_0pc_other_prev$prevalence*10/100)/176*100
crate_prev_0pc_w8wed_dry_prev$scenario <- as.factor('EC_04')
crate_prev_0pc_w8wed_dry_prev$water <- as.factor('Dry')
names(crate_prev_0pc_w8wed_dry_prev) <- c('prevalence','scenario','water')

crate_prev_0pc_w8wed_recombined_prev <- rbind(crate_prev_0pc_w8wed_wet_prev, crate_prev_0pc_w8wed_dry_prev)

crate_prev_0pc_w1wed_prev$week <- as.factor(1)
crate_prev_0pc_w2wed_prev$week <- as.factor(2)
crate_prev_0pc_w3wed_prev$week <- as.factor(3)
crate_prev_0pc_w4wed_prev$week <- as.factor(4)
crate_prev_0pc_w5wed_prev$week <- as.factor(5)
crate_prev_0pc_w6wed_prev$week <- as.factor(6)
crate_prev_0pc_w7wed_prev$week <- as.factor(7)
crate_prev_0pc_w8wed_prev$week <- as.factor(8)

crate_prev_0pc_w1wed_recombined_prev$week <- as.factor(1)
crate_prev_0pc_w2wed_recombined_prev$week <- as.factor(2)
crate_prev_0pc_w3wed_recombined_prev$week <- as.factor(3)
crate_prev_0pc_w4wed_recombined_prev$week <- as.factor(4)
crate_prev_0pc_w5wed_recombined_prev$week <- as.factor(5)
crate_prev_0pc_w6wed_recombined_prev$week <- as.factor(6)
crate_prev_0pc_w7wed_recombined_prev$week <- as.factor(7)
crate_prev_0pc_w8wed_recombined_prev$week <- as.factor(8)
crate_prev_0pc_allwed_prev <- rbind(crate_prev_0pc_w1wed_recombined_prev,crate_prev_0pc_w2wed_recombined_prev,crate_prev_0pc_w3wed_recombined_prev,crate_prev_0pc_w4wed_recombined_prev,crate_prev_0pc_w5wed_recombined_prev,crate_prev_0pc_w6wed_recombined_prev,crate_prev_0pc_w7wed_recombined_prev,crate_prev_0pc_w8wed_recombined_prev)

vector <- NL_table_Crate_Prev_0pc$lifetime_conc_list[order(NL_table_Crate_Prev_0pc$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

crate_prev_0pc_w1wed_recombined_prev$week <- as.factor(1)
crate_prev_0pc_w2wed_recombined_prev$week <- as.factor(2)
crate_prev_0pc_w3wed_recombined_prev$week <- as.factor(3)
crate_prev_0pc_w4wed_recombined_prev$week <- as.factor(4)
crate_prev_0pc_w5wed_recombined_prev$week <- as.factor(5)
crate_prev_0pc_w6wed_recombined_prev$week <- as.factor(6)
crate_prev_0pc_w7wed_recombined_prev$week <- as.factor(7)
crate_prev_0pc_w8wed_recombined_prev$week <- as.factor(8)
crate_prev_0pc_allwed_prev <- rbind(crate_prev_0pc_w1wed_recombined_prev,crate_prev_0pc_w2wed_recombined_prev,crate_prev_0pc_w3wed_recombined_prev,crate_prev_0pc_w4wed_recombined_prev,crate_prev_0pc_w5wed_recombined_prev,crate_prev_0pc_w6wed_recombined_prev,crate_prev_0pc_w7wed_recombined_prev,crate_prev_0pc_w8wed_recombined_prev)

Facility_B_crate_prev_0pc_agents_melted <- melt(mdarray)
colnames(Facility_B_crate_prev_0pc_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_crate_prev_0pc_agents_melted$agent <- Facility_B_crate_prev_0pc_agents_melted$agent-1
Facility_B_crate_prev_0pc_agents_melted$logical <- Facility_B_crate_prev_0pc_agents_melted$value>0
Facility_B_crate_prev_0pc_agents_melted$binary <- as.numeric(Facility_B_crate_prev_0pc_agents_melted$logical)
Facility_B_crate_prev_0pc_agents_melted$log10value <- log10(Facility_B_crate_prev_0pc_agents_melted$value)
Facility_B_crate_prev_0pc_agents_melted$log10value[is.infinite(Facility_B_crate_prev_0pc_agents_melted$log10value)] <- 0

agent <- Facility_B_crate_prev_0pc_agents_melted$agent
iteration <- Facility_B_crate_prev_0pc_agents_melted$iteration
tick <- Facility_B_crate_prev_0pc_agents_melted$tick
rle_matrix <- tapply(Facility_B_crate_prev_0pc_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_crate_prev_0pc_mean_value_matrix <- tapply(Facility_B_crate_prev_0pc_agents_melted$value, list(agent, tick), mean)
Facility_B_crate_prev_0pc_median_value_matrix <- tapply(Facility_B_crate_prev_0pc_agents_melted$value, list(agent, tick), median)
x <- Facility_B_crate_prev_0pc_agents_melted
x$value[x$value==0] <- NA
Facility_B_crate_prev_0pc_pos_median_value_matrix <- tapply(x$value, list(agent, tick), median, na.rm=TRUE)
Facility_B_crate_prev_0pc_prob_value_matrix <- tapply(Facility_B_crate_prev_0pc_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

#Maximum sensitivity####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_crate_prev_0pc <- durations

agents_list_crate_prev_0pc <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_crate_prev_0pc <- agents_list_crate_prev_0pc[,c("V1","V7","V8","V9")]
colnames(agents_list_crate_prev_0pc) <- c("name","sanitation_status","schedule","area")
#Time to persistence
agents_list_crate_prev_0pc$time_to_persistence <- rep((168*2),225)
agents_list_crate_prev_0pc$time_to_persistence[agents_list_crate_prev_0pc$schedule=="daily"] <- (24*2)

persistent_short_durations_list_crate_prev_0pc <- data.frame()
persistent_long_durations_list_crate_prev_0pc <- data.frame()
persistent_uncleanable_durations_list_crate_prev_0pc <- data.frame()
transient_short_durations_list_crate_prev_0pc <- data.frame()
transient_long_durations_list_crate_prev_0pc <- data.frame()
transient_uncleanable_durations_list_crate_prev_0pc <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_crate_prev_0pc$min_duration[agent] <- ifelse(length(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent])==0,NA,min(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_crate_prev_0pc$mean_duration[agent] <- ifelse(length(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent])==0,NA,mean(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_crate_prev_0pc$median_duration[agent] <- ifelse(length(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent])==0,NA,median(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_crate_prev_0pc$max_duration[agent] <- ifelse(length(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent])==0,NA,max(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_crate_prev_0pc$contamination_events[agent] <- sum(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_crate_prev_0pc$times_persistent[agent] <- sum(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent]>agents_list_crate_prev_0pc$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_crate_prev_0pc$q1_duration[agent] <- quantile(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_crate_prev_0pc$q3_duration[agent] <- quantile(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_crate_prev_0pc$min_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent])==0) || (agents_list_crate_prev_0pc$times_persistent[agent]==0),NA,min(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent & Facility_B_durations_crate_prev_0pc$duration>=agents_list_crate_prev_0pc$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_crate_prev_0pc$mean_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent])==0) || (agents_list_crate_prev_0pc$times_persistent[agent]==0),NA,mean(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent & Facility_B_durations_crate_prev_0pc$duration>=agents_list_crate_prev_0pc$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_crate_prev_0pc$median_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent])==0) || (agents_list_crate_prev_0pc$times_persistent[agent]==0),NA,median(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent & Facility_B_durations_crate_prev_0pc$duration>=agents_list_crate_prev_0pc$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_crate_prev_0pc$max_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent])==0) || (agents_list_crate_prev_0pc$times_persistent[agent]==0),NA,max(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent & Facility_B_durations_crate_prev_0pc$duration>=agents_list_crate_prev_0pc$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_crate_prev_0pc$q1_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent])==0) || (agents_list_crate_prev_0pc$times_persistent[agent]==0),NA,quantile(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent & Facility_B_durations_crate_prev_0pc$duration>=agents_list_crate_prev_0pc$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_crate_prev_0pc$q3_persistent_duration[agent] <- ifelse((length(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent])==0) || (agents_list_crate_prev_0pc$times_persistent[agent]==0),NA,quantile(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent & Facility_B_durations_crate_prev_0pc$duration>=agents_list_crate_prev_0pc$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations
  x <- Facility_B_durations_crate_prev_0pc[which(Facility_B_durations_crate_prev_0pc$agent==agent & Facility_B_durations_crate_prev_0pc$duration>agents_list_crate_prev_0pc$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean
  agents_list_crate_prev_0pc$mean_times_persistent[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_crate_prev_0pc$mean_times_persistent[which(is.na(agents_list_crate_prev_0pc$mean_times_persistent))] <- 0
  #Division by total number of iterations in simulation
  agents_list_crate_prev_0pc$balanced_times_persistent[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_crate_prev_0pc$duration[Facility_B_durations_crate_prev_0pc$agent==agent])!=0) || (agents_list_crate_prev_0pc$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_crate_prev_0pc$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_crate_prev_0pc <- rbind(
        persistent_short_durations_list_crate_prev_0pc,
        Facility_B_durations_crate_prev_0pc[Facility_B_durations_crate_prev_0pc$agent==agent & Facility_B_durations_crate_prev_0pc$duration>agents_list_crate_prev_0pc$time_to_persistence[agent],]
      )
    } else if(agents_list_crate_prev_0pc$time_to_persistence[agent]==336 && agents_list_crate_prev_0pc$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_crate_prev_0pc <- rbind(
        persistent_long_durations_list_crate_prev_0pc,
        Facility_B_durations_crate_prev_0pc[Facility_B_durations_crate_prev_0pc$agent==agent & Facility_B_durations_crate_prev_0pc$duration>agents_list_crate_prev_0pc$time_to_persistence[agent],]
      )
    } else if(agents_list_crate_prev_0pc$time_to_persistence[agent]==336 && agents_list_crate_prev_0pc$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_crate_prev_0pc <- rbind(
        persistent_uncleanable_durations_list_crate_prev_0pc,
        Facility_B_durations_crate_prev_0pc[Facility_B_durations_crate_prev_0pc$agent==agent & Facility_B_durations_crate_prev_0pc$duration>agents_list_crate_prev_0pc$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_crate_prev_0pc$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_crate_prev_0pc <- rbind(
      transient_short_durations_list_crate_prev_0pc,
      Facility_B_durations_crate_prev_0pc[Facility_B_durations_crate_prev_0pc$agent==agent & Facility_B_durations_crate_prev_0pc$duration<=agents_list_crate_prev_0pc$time_to_persistence[agent],]
    )
  } else if(agents_list_crate_prev_0pc$time_to_persistence[agent]==336 && agents_list_crate_prev_0pc$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_crate_prev_0pc <- rbind(
      transient_long_durations_list_crate_prev_0pc,
      Facility_B_durations_crate_prev_0pc[Facility_B_durations_crate_prev_0pc$agent==agent & Facility_B_durations_crate_prev_0pc$duration<=agents_list_crate_prev_0pc$time_to_persistence[agent],]
    )
  } else if(agents_list_crate_prev_0pc$time_to_persistence[agent]==336 && agents_list_crate_prev_0pc$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_crate_prev_0pc <- rbind(
      transient_uncleanable_durations_list_crate_prev_0pc,
      Facility_B_durations_crate_prev_0pc[Facility_B_durations_crate_prev_0pc$agent==agent & Facility_B_durations_crate_prev_0pc$duration<=agents_list_crate_prev_0pc$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

#10 cells minimum####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>9)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_crate_prev_0pc_10min <- durations

persistent_short_durations_list_crate_prev_0pc_10min <- data.frame()
persistent_long_durations_list_crate_prev_0pc_10min <- data.frame()
persistent_uncleanable_durations_list_crate_prev_0pc_10min <- data.frame()
transient_short_durations_list_crate_prev_0pc_10min <- data.frame()
transient_long_durations_list_crate_prev_0pc_10min <- data.frame()
transient_uncleanable_durations_list_crate_prev_0pc_10min <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_crate_prev_0pc$min_duration_10min[agent] <- ifelse(length(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent])==0,NA,min(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_crate_prev_0pc$mean_duration_10min[agent] <- ifelse(length(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent])==0,NA,mean(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_crate_prev_0pc$median_duration_10min[agent] <- ifelse(length(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent])==0,NA,median(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_crate_prev_0pc$max_duration_10min[agent] <- ifelse(length(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent])==0,NA,max(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_crate_prev_0pc$contamination_events_10min[agent] <- sum(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_crate_prev_0pc$times_persistent_10min[agent] <- sum(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent]>agents_list_crate_prev_0pc$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_crate_prev_0pc$q1_duration_10min[agent] <- quantile(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_crate_prev_0pc$q3_duration_10min[agent] <- quantile(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_crate_prev_0pc$min_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent])==0) || (agents_list_crate_prev_0pc$times_persistent_10min[agent]==0),NA,min(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent & Facility_B_durations_crate_prev_0pc_10min$duration>=agents_list_crate_prev_0pc$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_crate_prev_0pc$mean_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent])==0) || (agents_list_crate_prev_0pc$times_persistent_10min[agent]==0),NA,mean(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent & Facility_B_durations_crate_prev_0pc_10min$duration>=agents_list_crate_prev_0pc$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_crate_prev_0pc$median_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent])==0) || (agents_list_crate_prev_0pc$times_persistent_10min[agent]==0),NA,median(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent & Facility_B_durations_crate_prev_0pc_10min$duration>=agents_list_crate_prev_0pc$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_crate_prev_0pc$max_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent])==0) || (agents_list_crate_prev_0pc$times_persistent_10min[agent]==0),NA,max(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent & Facility_B_durations_crate_prev_0pc_10min$duration>=agents_list_crate_prev_0pc$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_crate_prev_0pc$q1_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent])==0) || (agents_list_crate_prev_0pc$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent & Facility_B_durations_crate_prev_0pc_10min$duration>=agents_list_crate_prev_0pc$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_crate_prev_0pc$q3_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent])==0) || (agents_list_crate_prev_0pc$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent & Facility_B_durations_crate_prev_0pc_10min$duration>=agents_list_crate_prev_0pc$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations (Does not account for iterations with 0 events)
  x <- Facility_B_durations_crate_prev_0pc_10min[which(Facility_B_durations_crate_prev_0pc_10min$agent==agent & Facility_B_durations_crate_prev_0pc_10min$duration>agents_list_crate_prev_0pc$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean (Does account for iterations with 0 events)
  agents_list_crate_prev_0pc$mean_times_persistent_10min[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_crate_prev_0pc$mean_times_persistent_10min[which(is.na(agents_list_crate_prev_0pc$mean_times_persistent_10min))] <- 0
  #Division by total number of iterations in simulation
  agents_list_crate_prev_0pc$balanced_times_persistent_10min[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_crate_prev_0pc_10min$duration[Facility_B_durations_crate_prev_0pc_10min$agent==agent])!=0) || (agents_list_crate_prev_0pc$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_crate_prev_0pc$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_crate_prev_0pc_10min <- rbind(
        persistent_short_durations_list_crate_prev_0pc_10min,
        Facility_B_durations_crate_prev_0pc_10min[Facility_B_durations_crate_prev_0pc_10min$agent==agent & Facility_B_durations_crate_prev_0pc_10min$duration>agents_list_crate_prev_0pc$time_to_persistence[agent],]
      )
    } else if(agents_list_crate_prev_0pc$time_to_persistence[agent]==336 && agents_list_crate_prev_0pc$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_crate_prev_0pc_10min <- rbind(
        persistent_long_durations_list_crate_prev_0pc_10min,
        Facility_B_durations_crate_prev_0pc_10min[Facility_B_durations_crate_prev_0pc_10min$agent==agent & Facility_B_durations_crate_prev_0pc_10min$duration>agents_list_crate_prev_0pc$time_to_persistence[agent],]
      )
    } else if(agents_list_crate_prev_0pc$time_to_persistence[agent]==336 && agents_list_crate_prev_0pc$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_crate_prev_0pc_10min <- rbind(
        persistent_uncleanable_durations_list_crate_prev_0pc_10min,
        Facility_B_durations_crate_prev_0pc_10min[Facility_B_durations_crate_prev_0pc_10min$agent==agent & Facility_B_durations_crate_prev_0pc_10min$duration>agents_list_crate_prev_0pc$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_crate_prev_0pc$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_crate_prev_0pc_10min <- rbind(
      transient_short_durations_list_crate_prev_0pc_10min,
      Facility_B_durations_crate_prev_0pc_10min[Facility_B_durations_crate_prev_0pc_10min$agent==agent & Facility_B_durations_crate_prev_0pc_10min$duration<=agents_list_crate_prev_0pc$time_to_persistence[agent],]
    )
  } else if(agents_list_crate_prev_0pc$time_to_persistence[agent]==336 && agents_list_crate_prev_0pc$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_crate_prev_0pc_10min <- rbind(
      transient_long_durations_list_crate_prev_0pc_10min,
      Facility_B_durations_crate_prev_0pc_10min[Facility_B_durations_crate_prev_0pc_10min$agent==agent & Facility_B_durations_crate_prev_0pc_10min$duration<=agents_list_crate_prev_0pc$time_to_persistence[agent],]
    )
  } else if(agents_list_crate_prev_0pc$time_to_persistence[agent]==336 && agents_list_crate_prev_0pc$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_crate_prev_0pc_10min <- rbind(
      transient_uncleanable_durations_list_crate_prev_0pc_10min,
      Facility_B_durations_crate_prev_0pc_10min[Facility_B_durations_crate_prev_0pc_10min$agent==agent & Facility_B_durations_crate_prev_0pc_10min$duration<=agents_list_crate_prev_0pc$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

# Facility_B_crate_prev_0pc_agents_melted_monday_preop <- Facility_B_crate_prev_0pc_agents_melted[which(Facility_B_crate_prev_0pc_agents_melted$tick==33|Facility_B_crate_prev_0pc_agents_melted$tick==201|Facility_B_crate_prev_0pc_agents_melted$tick==369|Facility_B_crate_prev_0pc_agents_melted$tick==537|Facility_B_crate_prev_0pc_agents_melted$tick==705|Facility_B_crate_prev_0pc_agents_melted$tick==873|Facility_B_crate_prev_0pc_agents_melted$tick==1041|Facility_B_crate_prev_0pc_agents_melted$tick==1209),]
# 
# Facility_B_crate_prev_0pc_agents_melted_tuesday_preop <- Facility_B_crate_prev_0pc_agents_melted[which(Facility_B_crate_prev_0pc_agents_melted$tick==57|Facility_B_crate_prev_0pc_agents_melted$tick==225|Facility_B_crate_prev_0pc_agents_melted$tick==393|Facility_B_crate_prev_0pc_agents_melted$tick==561|Facility_B_crate_prev_0pc_agents_melted$tick==729|Facility_B_crate_prev_0pc_agents_melted$tick==897|Facility_B_crate_prev_0pc_agents_melted$tick==1065|Facility_B_crate_prev_0pc_agents_melted$tick==1233),]
# 
# Facility_B_crate_prev_0pc_agents_melted_wednesday_preop <- Facility_B_crate_prev_0pc_agents_melted[which(Facility_B_crate_prev_0pc_agents_melted$tick==81|Facility_B_crate_prev_0pc_agents_melted$tick==249|Facility_B_crate_prev_0pc_agents_melted$tick==417|Facility_B_crate_prev_0pc_agents_melted$tick==585|Facility_B_crate_prev_0pc_agents_melted$tick==753|Facility_B_crate_prev_0pc_agents_melted$tick==921|Facility_B_crate_prev_0pc_agents_melted$tick==1089|Facility_B_crate_prev_0pc_agents_melted$tick==1257),]
# 
# Facility_B_crate_prev_0pc_agents_melted_thursday_preop <- Facility_B_crate_prev_0pc_agents_melted[which(Facility_B_crate_prev_0pc_agents_melted$tick==105|Facility_B_crate_prev_0pc_agents_melted$tick==273|Facility_B_crate_prev_0pc_agents_melted$tick==441|Facility_B_crate_prev_0pc_agents_melted$tick==609|Facility_B_crate_prev_0pc_agents_melted$tick==777|Facility_B_crate_prev_0pc_agents_melted$tick==945|Facility_B_crate_prev_0pc_agents_melted$tick==1113|Facility_B_crate_prev_0pc_agents_melted$tick==1281),]
# 
# Facility_B_crate_prev_0pc_agents_melted_friday_preop <- Facility_B_crate_prev_0pc_agents_melted[which(Facility_B_crate_prev_0pc_agents_melted$tick==129|Facility_B_crate_prev_0pc_agents_melted$tick==297|Facility_B_crate_prev_0pc_agents_melted$tick==465|Facility_B_crate_prev_0pc_agents_melted$tick==633|Facility_B_crate_prev_0pc_agents_melted$tick==801|Facility_B_crate_prev_0pc_agents_melted$tick==969|Facility_B_crate_prev_0pc_agents_melted$tick==1137|Facility_B_crate_prev_0pc_agents_melted$tick==1305),]

Facility_B_crate_prev_0pc_agents_melted_ff <- as.ffdf(Facility_B_crate_prev_0pc_agents_melted)
rm(Facility_B_crate_prev_0pc_agents_melted)
gc()
```

```{r import Random Load 1 Log Reduction}
NL_table_Random_Load_1_Log_Red <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-28-03-36 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_Random_Load_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Random_Load_1_Log_Red <- NL_table_Random_Load_1_Log_Red[NL_table_Random_Load_1_Log_Red$scenario==12,]

while (any(grepl('-', names(NL_table_Random_Load_1_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_1_Log_Red <- NL_table_Random_Load_1_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Random_Load_1_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_1_Log_Red <- NL_table_Random_Load_1_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Random_Load_1_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_1_Log_Red <- NL_table_Random_Load_1_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Random_Load_1_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_1_Log_Red <- NL_table_Random_Load_1_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Random_Load_1_Log_Red[ , ..list_columns]

NL_table_Random_Load_1_Log_Red[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Random_Load_1_Log_Red <- as.data.frame(NL_table_Random_Load_1_Log_Red)

NL_table_Random_Load_1_Log_Red[NL_table_Random_Load_1_Log_Red==-1] <- NA

NL_table_Random_Load_1_Log_Red <- subset(NL_table_Random_Load_1_Log_Red, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Random_Load_1_Log_Red)[names(NL_table_Random_Load_1_Log_Red)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Random_Load_1_Log_Red)[names(NL_table_Random_Load_1_Log_Red)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Random_Load_1_Log_Red$loading_w1wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_loading_w1wed_conc_list <- append(random_load_1_log_red_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_loading_w1wed_conc_matrix <- matrix(unlist(random_load_1_log_red_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_cleaning_w1wed_conc_list <- append(random_load_1_log_red_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_cleaning_w1wed_conc_matrix <- matrix(unlist(random_load_1_log_red_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_1_Log_Red$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# random_load_1_log_red_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_1_log_red_drying_w1wed_conc_list <- append(random_load_1_log_red_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_1_Log_Red$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_sorting_w1wed_conc_list <- append(random_load_1_log_red_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_sorting_w1wed_conc_matrix <- matrix(unlist(random_load_1_log_red_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_tray_packing_w1wed_conc_list <- append(random_load_1_log_red_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_tray_packing_w1wed_conc_matrix <- matrix(unlist(random_load_1_log_red_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$reject_w1wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_reject_w1wed_conc_list <- append(random_load_1_log_red_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_reject_w1wed_conc_matrix <- matrix(unlist(random_load_1_log_red_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$other_w1wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_other_w1wed_conc_list <- append(random_load_1_log_red_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_other_w1wed_conc_matrix <- matrix(unlist(random_load_1_log_red_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

random_load_1_log_red_loading_concs <- as.data.frame(random_load_1_log_red_loading_w1wed_conc_list)
random_load_1_log_red_loading_concs$area <- as.factor('loading')
random_load_1_log_red_loading_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_1_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_cleaning_concs <- as.data.frame(random_load_1_log_red_cleaning_w1wed_conc_list)
random_load_1_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_1_log_red_cleaning_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_1_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_sorting_concs <- as.data.frame(random_load_1_log_red_sorting_w1wed_conc_list)
random_load_1_log_red_sorting_concs$area <- as.factor('sorting')
random_load_1_log_red_sorting_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_1_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_reject_concs <- as.data.frame(random_load_1_log_red_reject_w1wed_conc_list)
random_load_1_log_red_reject_concs$area <- as.factor('reject')
random_load_1_log_red_reject_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_1_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_tray_packing_concs <- as.data.frame(random_load_1_log_red_tray_packing_w1wed_conc_list)
random_load_1_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_1_log_red_tray_packing_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_1_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_other_concs <- as.data.frame(random_load_1_log_red_other_w1wed_conc_list)
random_load_1_log_red_other_concs$area <- as.factor('other')
random_load_1_log_red_other_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_other_concs$water <- as.factor('Dry')
names(random_load_1_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_w1wed_concs <- rbind(random_load_1_log_red_loading_concs,random_load_1_log_red_cleaning_concs,random_load_1_log_red_sorting_concs,random_load_1_log_red_tray_packing_concs,random_load_1_log_red_reject_concs,random_load_1_log_red_other_concs)

random_load_1_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$loading_w1wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_loading_prev$area <- as.factor('loading')
random_load_1_log_red_loading_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_1_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$cleaning_w1wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_1_log_red_cleaning_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_1_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$sorting_w1wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_sorting_prev$area <- as.factor('sorting')
random_load_1_log_red_sorting_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_1_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$reject_w1wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_reject_prev$area <- as.factor('reject')
random_load_1_log_red_reject_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_1_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$tray_packing_w1wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_1_log_red_tray_packing_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_1_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_other_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$other_w1wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_other_prev$area <- as.factor('other')
random_load_1_log_red_other_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_other_prev$water <- as.factor('Dry')
names(random_load_1_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_w1wed_prev <- rbind(random_load_1_log_red_loading_prev,random_load_1_log_red_cleaning_prev,random_load_1_log_red_sorting_prev,random_load_1_log_red_tray_packing_prev,random_load_1_log_red_reject_prev,random_load_1_log_red_other_prev)

random_load_1_log_red_w1wed_wet_prev <- as.data.frame(random_load_1_log_red_loading_prev$prevalence*21/100+random_load_1_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_1_log_red_w1wed_wet_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_w1wed_wet_prev$water <- as.factor('Wet')
names(random_load_1_log_red_w1wed_wet_prev) <- c('prevalence','scenario','water')

random_load_1_log_red_w1wed_dry_prev <- as.data.frame(random_load_1_log_red_sorting_prev$prevalence*20/100+random_load_1_log_red_reject_prev$prevalence*23/100+random_load_1_log_red_tray_packing_prev$prevalence*123/100+random_load_1_log_red_other_prev$prevalence*10/100)/176*100
random_load_1_log_red_w1wed_dry_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_w1wed_dry_prev$water <- as.factor('Dry')
names(random_load_1_log_red_w1wed_dry_prev) <- c('prevalence','scenario','water')

random_load_1_log_red_w1wed_recombined_prev <- rbind(random_load_1_log_red_w1wed_wet_prev, random_load_1_log_red_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Random_Load_1_Log_Red$loading_w2wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_loading_w2wed_conc_list <- append(random_load_1_log_red_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_loading_w2wed_conc_matrix <- matrix(unlist(random_load_1_log_red_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_cleaning_w2wed_conc_list <- append(random_load_1_log_red_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_cleaning_w2wed_conc_matrix <- matrix(unlist(random_load_1_log_red_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_1_Log_Red$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# random_load_1_log_red_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_1_log_red_drying_w2wed_conc_list <- append(random_load_1_log_red_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_1_Log_Red$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_sorting_w2wed_conc_list <- append(random_load_1_log_red_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_sorting_w2wed_conc_matrix <- matrix(unlist(random_load_1_log_red_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_tray_packing_w2wed_conc_list <- append(random_load_1_log_red_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_tray_packing_w2wed_conc_matrix <- matrix(unlist(random_load_1_log_red_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$reject_w2wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_reject_w2wed_conc_list <- append(random_load_1_log_red_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_reject_w2wed_conc_matrix <- matrix(unlist(random_load_1_log_red_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$other_w2wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_other_w2wed_conc_list <- append(random_load_1_log_red_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_other_w2wed_conc_matrix <- matrix(unlist(random_load_1_log_red_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

random_load_1_log_red_loading_concs <- as.data.frame(random_load_1_log_red_loading_w2wed_conc_list)
random_load_1_log_red_loading_concs$area <- as.factor('loading')
random_load_1_log_red_loading_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_1_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_cleaning_concs <- as.data.frame(random_load_1_log_red_cleaning_w2wed_conc_list)
random_load_1_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_1_log_red_cleaning_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_1_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_sorting_concs <- as.data.frame(random_load_1_log_red_sorting_w2wed_conc_list)
random_load_1_log_red_sorting_concs$area <- as.factor('sorting')
random_load_1_log_red_sorting_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_1_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_reject_concs <- as.data.frame(random_load_1_log_red_reject_w2wed_conc_list)
random_load_1_log_red_reject_concs$area <- as.factor('reject')
random_load_1_log_red_reject_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_1_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_tray_packing_concs <- as.data.frame(random_load_1_log_red_tray_packing_w2wed_conc_list)
random_load_1_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_1_log_red_tray_packing_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_1_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_other_concs <- as.data.frame(random_load_1_log_red_other_w2wed_conc_list)
random_load_1_log_red_other_concs$area <- as.factor('other')
random_load_1_log_red_other_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_other_concs$water <- as.factor('Dry')
names(random_load_1_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_w2wed_concs <- rbind(random_load_1_log_red_loading_concs,random_load_1_log_red_cleaning_concs,random_load_1_log_red_sorting_concs,random_load_1_log_red_tray_packing_concs,random_load_1_log_red_reject_concs,random_load_1_log_red_other_concs)

random_load_1_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$loading_w2wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_loading_prev$area <- as.factor('loading')
random_load_1_log_red_loading_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_1_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$cleaning_w2wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_1_log_red_cleaning_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_1_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$sorting_w2wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_sorting_prev$area <- as.factor('sorting')
random_load_1_log_red_sorting_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_1_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$reject_w2wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_reject_prev$area <- as.factor('reject')
random_load_1_log_red_reject_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_1_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$tray_packing_w2wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_1_log_red_tray_packing_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_1_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_other_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$other_w2wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_other_prev$area <- as.factor('other')
random_load_1_log_red_other_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_other_prev$water <- as.factor('Dry')
names(random_load_1_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_w2wed_prev <- rbind(random_load_1_log_red_loading_prev,random_load_1_log_red_cleaning_prev,random_load_1_log_red_sorting_prev,random_load_1_log_red_tray_packing_prev,random_load_1_log_red_reject_prev,random_load_1_log_red_other_prev)

random_load_1_log_red_w2wed_wet_prev <- as.data.frame(random_load_1_log_red_loading_prev$prevalence*21/100+random_load_1_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_1_log_red_w2wed_wet_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_w2wed_wet_prev$water <- as.factor('Wet')
names(random_load_1_log_red_w2wed_wet_prev) <- c('prevalence','scenario','water')

random_load_1_log_red_w2wed_dry_prev <- as.data.frame(random_load_1_log_red_sorting_prev$prevalence*20/100+random_load_1_log_red_reject_prev$prevalence*23/100+random_load_1_log_red_tray_packing_prev$prevalence*123/100+random_load_1_log_red_other_prev$prevalence*10/100)/176*100
random_load_1_log_red_w2wed_dry_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_w2wed_dry_prev$water <- as.factor('Dry')
names(random_load_1_log_red_w2wed_dry_prev) <- c('prevalence','scenario','water')

random_load_1_log_red_w2wed_recombined_prev <- rbind(random_load_1_log_red_w2wed_wet_prev, random_load_1_log_red_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Random_Load_1_Log_Red$loading_w3wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_loading_w3wed_conc_list <- append(random_load_1_log_red_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_loading_w3wed_conc_matrix <- matrix(unlist(random_load_1_log_red_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_cleaning_w3wed_conc_list <- append(random_load_1_log_red_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_cleaning_w3wed_conc_matrix <- matrix(unlist(random_load_1_log_red_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_1_Log_Red$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# random_load_1_log_red_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_1_log_red_drying_w3wed_conc_list <- append(random_load_1_log_red_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_1_Log_Red$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_sorting_w3wed_conc_list <- append(random_load_1_log_red_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_sorting_w3wed_conc_matrix <- matrix(unlist(random_load_1_log_red_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_tray_packing_w3wed_conc_list <- append(random_load_1_log_red_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_tray_packing_w3wed_conc_matrix <- matrix(unlist(random_load_1_log_red_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$reject_w3wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_reject_w3wed_conc_list <- append(random_load_1_log_red_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_reject_w3wed_conc_matrix <- matrix(unlist(random_load_1_log_red_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$other_w3wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_other_w3wed_conc_list <- append(random_load_1_log_red_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_other_w3wed_conc_matrix <- matrix(unlist(random_load_1_log_red_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

random_load_1_log_red_loading_concs <- as.data.frame(random_load_1_log_red_loading_w3wed_conc_list)
random_load_1_log_red_loading_concs$area <- as.factor('loading')
random_load_1_log_red_loading_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_1_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_cleaning_concs <- as.data.frame(random_load_1_log_red_cleaning_w3wed_conc_list)
random_load_1_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_1_log_red_cleaning_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_1_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_sorting_concs <- as.data.frame(random_load_1_log_red_sorting_w3wed_conc_list)
random_load_1_log_red_sorting_concs$area <- as.factor('sorting')
random_load_1_log_red_sorting_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_1_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_reject_concs <- as.data.frame(random_load_1_log_red_reject_w3wed_conc_list)
random_load_1_log_red_reject_concs$area <- as.factor('reject')
random_load_1_log_red_reject_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_1_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_tray_packing_concs <- as.data.frame(random_load_1_log_red_tray_packing_w3wed_conc_list)
random_load_1_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_1_log_red_tray_packing_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_1_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_other_concs <- as.data.frame(random_load_1_log_red_other_w3wed_conc_list)
random_load_1_log_red_other_concs$area <- as.factor('other')
random_load_1_log_red_other_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_other_concs$water <- as.factor('Dry')
names(random_load_1_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_w3wed_concs <- rbind(random_load_1_log_red_loading_concs,random_load_1_log_red_cleaning_concs,random_load_1_log_red_sorting_concs,random_load_1_log_red_tray_packing_concs,random_load_1_log_red_reject_concs,random_load_1_log_red_other_concs)

random_load_1_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$loading_w3wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_loading_prev$area <- as.factor('loading')
random_load_1_log_red_loading_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_1_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$cleaning_w3wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_1_log_red_cleaning_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_1_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$sorting_w3wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_sorting_prev$area <- as.factor('sorting')
random_load_1_log_red_sorting_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_1_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$reject_w3wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_reject_prev$area <- as.factor('reject')
random_load_1_log_red_reject_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_1_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$tray_packing_w3wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_1_log_red_tray_packing_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_1_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_other_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$other_w3wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_other_prev$area <- as.factor('other')
random_load_1_log_red_other_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_other_prev$water <- as.factor('Dry')
names(random_load_1_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_w3wed_prev <- rbind(random_load_1_log_red_loading_prev,random_load_1_log_red_cleaning_prev,random_load_1_log_red_sorting_prev,random_load_1_log_red_tray_packing_prev,random_load_1_log_red_reject_prev,random_load_1_log_red_other_prev)

random_load_1_log_red_w3wed_wet_prev <- as.data.frame(random_load_1_log_red_loading_prev$prevalence*21/100+random_load_1_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_1_log_red_w3wed_wet_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_w3wed_wet_prev$water <- as.factor('Wet')
names(random_load_1_log_red_w3wed_wet_prev) <- c('prevalence','scenario','water')

random_load_1_log_red_w3wed_dry_prev <- as.data.frame(random_load_1_log_red_sorting_prev$prevalence*20/100+random_load_1_log_red_reject_prev$prevalence*23/100+random_load_1_log_red_tray_packing_prev$prevalence*123/100+random_load_1_log_red_other_prev$prevalence*10/100)/176*100
random_load_1_log_red_w3wed_dry_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_w3wed_dry_prev$water <- as.factor('Dry')
names(random_load_1_log_red_w3wed_dry_prev) <- c('prevalence','scenario','water')

random_load_1_log_red_w3wed_recombined_prev <- rbind(random_load_1_log_red_w3wed_wet_prev, random_load_1_log_red_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Random_Load_1_Log_Red$loading_w4wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_loading_w4wed_conc_list <- append(random_load_1_log_red_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_loading_w4wed_conc_matrix <- matrix(unlist(random_load_1_log_red_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_cleaning_w4wed_conc_list <- append(random_load_1_log_red_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_cleaning_w4wed_conc_matrix <- matrix(unlist(random_load_1_log_red_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_1_Log_Red$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# random_load_1_log_red_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_1_log_red_drying_w4wed_conc_list <- append(random_load_1_log_red_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_1_Log_Red$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_sorting_w4wed_conc_list <- append(random_load_1_log_red_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_sorting_w4wed_conc_matrix <- matrix(unlist(random_load_1_log_red_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_tray_packing_w4wed_conc_list <- append(random_load_1_log_red_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_tray_packing_w4wed_conc_matrix <- matrix(unlist(random_load_1_log_red_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$reject_w4wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_reject_w4wed_conc_list <- append(random_load_1_log_red_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_reject_w4wed_conc_matrix <- matrix(unlist(random_load_1_log_red_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$other_w4wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_other_w4wed_conc_list <- append(random_load_1_log_red_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_other_w4wed_conc_matrix <- matrix(unlist(random_load_1_log_red_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

random_load_1_log_red_loading_concs <- as.data.frame(random_load_1_log_red_loading_w4wed_conc_list)
random_load_1_log_red_loading_concs$area <- as.factor('loading')
random_load_1_log_red_loading_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_1_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_cleaning_concs <- as.data.frame(random_load_1_log_red_cleaning_w4wed_conc_list)
random_load_1_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_1_log_red_cleaning_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_1_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_sorting_concs <- as.data.frame(random_load_1_log_red_sorting_w4wed_conc_list)
random_load_1_log_red_sorting_concs$area <- as.factor('sorting')
random_load_1_log_red_sorting_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_1_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_reject_concs <- as.data.frame(random_load_1_log_red_reject_w4wed_conc_list)
random_load_1_log_red_reject_concs$area <- as.factor('reject')
random_load_1_log_red_reject_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_1_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_tray_packing_concs <- as.data.frame(random_load_1_log_red_tray_packing_w4wed_conc_list)
random_load_1_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_1_log_red_tray_packing_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_1_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_other_concs <- as.data.frame(random_load_1_log_red_other_w4wed_conc_list)
random_load_1_log_red_other_concs$area <- as.factor('other')
random_load_1_log_red_other_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_other_concs$water <- as.factor('Dry')
names(random_load_1_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_w4wed_concs <- rbind(random_load_1_log_red_loading_concs,random_load_1_log_red_cleaning_concs,random_load_1_log_red_sorting_concs,random_load_1_log_red_tray_packing_concs,random_load_1_log_red_reject_concs,random_load_1_log_red_other_concs)

random_load_1_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$loading_w4wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_loading_prev$area <- as.factor('loading')
random_load_1_log_red_loading_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_1_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$cleaning_w4wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_1_log_red_cleaning_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_1_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$sorting_w4wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_sorting_prev$area <- as.factor('sorting')
random_load_1_log_red_sorting_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_1_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$reject_w4wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_reject_prev$area <- as.factor('reject')
random_load_1_log_red_reject_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_1_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$tray_packing_w4wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_1_log_red_tray_packing_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_1_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_other_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$other_w4wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_other_prev$area <- as.factor('other')
random_load_1_log_red_other_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_other_prev$water <- as.factor('Dry')
names(random_load_1_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_w4wed_prev <- rbind(random_load_1_log_red_loading_prev,random_load_1_log_red_cleaning_prev,random_load_1_log_red_sorting_prev,random_load_1_log_red_tray_packing_prev,random_load_1_log_red_reject_prev,random_load_1_log_red_other_prev)

random_load_1_log_red_w4wed_wet_prev <- as.data.frame(random_load_1_log_red_loading_prev$prevalence*21/100+random_load_1_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_1_log_red_w4wed_wet_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_w4wed_wet_prev$water <- as.factor('Wet')
names(random_load_1_log_red_w4wed_wet_prev) <- c('prevalence','scenario','water')

random_load_1_log_red_w4wed_dry_prev <- as.data.frame(random_load_1_log_red_sorting_prev$prevalence*20/100+random_load_1_log_red_reject_prev$prevalence*23/100+random_load_1_log_red_tray_packing_prev$prevalence*123/100+random_load_1_log_red_other_prev$prevalence*10/100)/176*100
random_load_1_log_red_w4wed_dry_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_w4wed_dry_prev$water <- as.factor('Dry')
names(random_load_1_log_red_w4wed_dry_prev) <- c('prevalence','scenario','water')

random_load_1_log_red_w4wed_recombined_prev <- rbind(random_load_1_log_red_w4wed_wet_prev, random_load_1_log_red_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Random_Load_1_Log_Red$loading_w5wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_loading_w5wed_conc_list <- append(random_load_1_log_red_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_loading_w5wed_conc_matrix <- matrix(unlist(random_load_1_log_red_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_cleaning_w5wed_conc_list <- append(random_load_1_log_red_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_cleaning_w5wed_conc_matrix <- matrix(unlist(random_load_1_log_red_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_1_Log_Red$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# random_load_1_log_red_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_1_log_red_drying_w5wed_conc_list <- append(random_load_1_log_red_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_1_Log_Red$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_sorting_w5wed_conc_list <- append(random_load_1_log_red_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_sorting_w5wed_conc_matrix <- matrix(unlist(random_load_1_log_red_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_tray_packing_w5wed_conc_list <- append(random_load_1_log_red_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_tray_packing_w5wed_conc_matrix <- matrix(unlist(random_load_1_log_red_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$reject_w5wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_reject_w5wed_conc_list <- append(random_load_1_log_red_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_reject_w5wed_conc_matrix <- matrix(unlist(random_load_1_log_red_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$other_w5wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_other_w5wed_conc_list <- append(random_load_1_log_red_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_other_w5wed_conc_matrix <- matrix(unlist(random_load_1_log_red_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

random_load_1_log_red_loading_concs <- as.data.frame(random_load_1_log_red_loading_w5wed_conc_list)
random_load_1_log_red_loading_concs$area <- as.factor('loading')
random_load_1_log_red_loading_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_1_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_cleaning_concs <- as.data.frame(random_load_1_log_red_cleaning_w5wed_conc_list)
random_load_1_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_1_log_red_cleaning_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_1_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_sorting_concs <- as.data.frame(random_load_1_log_red_sorting_w5wed_conc_list)
random_load_1_log_red_sorting_concs$area <- as.factor('sorting')
random_load_1_log_red_sorting_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_1_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_reject_concs <- as.data.frame(random_load_1_log_red_reject_w5wed_conc_list)
random_load_1_log_red_reject_concs$area <- as.factor('reject')
random_load_1_log_red_reject_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_1_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_tray_packing_concs <- as.data.frame(random_load_1_log_red_tray_packing_w5wed_conc_list)
random_load_1_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_1_log_red_tray_packing_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_1_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_other_concs <- as.data.frame(random_load_1_log_red_other_w5wed_conc_list)
random_load_1_log_red_other_concs$area <- as.factor('other')
random_load_1_log_red_other_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_other_concs$water <- as.factor('Dry')
names(random_load_1_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_w5wed_concs <- rbind(random_load_1_log_red_loading_concs,random_load_1_log_red_cleaning_concs,random_load_1_log_red_sorting_concs,random_load_1_log_red_tray_packing_concs,random_load_1_log_red_reject_concs,random_load_1_log_red_other_concs)

random_load_1_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$loading_w5wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_loading_prev$area <- as.factor('loading')
random_load_1_log_red_loading_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_1_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$cleaning_w5wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_1_log_red_cleaning_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_1_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$sorting_w5wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_sorting_prev$area <- as.factor('sorting')
random_load_1_log_red_sorting_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_1_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$reject_w5wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_reject_prev$area <- as.factor('reject')
random_load_1_log_red_reject_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_1_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$tray_packing_w5wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_1_log_red_tray_packing_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_1_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_other_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$other_w5wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_other_prev$area <- as.factor('other')
random_load_1_log_red_other_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_other_prev$water <- as.factor('Dry')
names(random_load_1_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_w5wed_prev <- rbind(random_load_1_log_red_loading_prev,random_load_1_log_red_cleaning_prev,random_load_1_log_red_sorting_prev,random_load_1_log_red_tray_packing_prev,random_load_1_log_red_reject_prev,random_load_1_log_red_other_prev)

random_load_1_log_red_w5wed_wet_prev <- as.data.frame(random_load_1_log_red_loading_prev$prevalence*21/100+random_load_1_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_1_log_red_w5wed_wet_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_w5wed_wet_prev$water <- as.factor('Wet')
names(random_load_1_log_red_w5wed_wet_prev) <- c('prevalence','scenario','water')

random_load_1_log_red_w5wed_dry_prev <- as.data.frame(random_load_1_log_red_sorting_prev$prevalence*20/100+random_load_1_log_red_reject_prev$prevalence*23/100+random_load_1_log_red_tray_packing_prev$prevalence*123/100+random_load_1_log_red_other_prev$prevalence*10/100)/176*100
random_load_1_log_red_w5wed_dry_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_w5wed_dry_prev$water <- as.factor('Dry')
names(random_load_1_log_red_w5wed_dry_prev) <- c('prevalence','scenario','water')

random_load_1_log_red_w5wed_recombined_prev <- rbind(random_load_1_log_red_w5wed_wet_prev, random_load_1_log_red_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Random_Load_1_Log_Red$loading_w6wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_loading_w6wed_conc_list <- append(random_load_1_log_red_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_loading_w6wed_conc_matrix <- matrix(unlist(random_load_1_log_red_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_cleaning_w6wed_conc_list <- append(random_load_1_log_red_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_cleaning_w6wed_conc_matrix <- matrix(unlist(random_load_1_log_red_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_1_Log_Red$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# random_load_1_log_red_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_1_log_red_drying_w6wed_conc_list <- append(random_load_1_log_red_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_1_Log_Red$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_sorting_w6wed_conc_list <- append(random_load_1_log_red_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_sorting_w6wed_conc_matrix <- matrix(unlist(random_load_1_log_red_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_tray_packing_w6wed_conc_list <- append(random_load_1_log_red_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_tray_packing_w6wed_conc_matrix <- matrix(unlist(random_load_1_log_red_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$reject_w6wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_reject_w6wed_conc_list <- append(random_load_1_log_red_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_reject_w6wed_conc_matrix <- matrix(unlist(random_load_1_log_red_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$other_w6wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_other_w6wed_conc_list <- append(random_load_1_log_red_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_other_w6wed_conc_matrix <- matrix(unlist(random_load_1_log_red_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

random_load_1_log_red_loading_concs <- as.data.frame(random_load_1_log_red_loading_w6wed_conc_list)
random_load_1_log_red_loading_concs$area <- as.factor('loading')
random_load_1_log_red_loading_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_1_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_cleaning_concs <- as.data.frame(random_load_1_log_red_cleaning_w6wed_conc_list)
random_load_1_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_1_log_red_cleaning_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_1_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_sorting_concs <- as.data.frame(random_load_1_log_red_sorting_w6wed_conc_list)
random_load_1_log_red_sorting_concs$area <- as.factor('sorting')
random_load_1_log_red_sorting_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_1_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_reject_concs <- as.data.frame(random_load_1_log_red_reject_w6wed_conc_list)
random_load_1_log_red_reject_concs$area <- as.factor('reject')
random_load_1_log_red_reject_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_1_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_tray_packing_concs <- as.data.frame(random_load_1_log_red_tray_packing_w6wed_conc_list)
random_load_1_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_1_log_red_tray_packing_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_1_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_other_concs <- as.data.frame(random_load_1_log_red_other_w6wed_conc_list)
random_load_1_log_red_other_concs$area <- as.factor('other')
random_load_1_log_red_other_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_other_concs$water <- as.factor('Dry')
names(random_load_1_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_w6wed_concs <- rbind(random_load_1_log_red_loading_concs,random_load_1_log_red_cleaning_concs,random_load_1_log_red_sorting_concs,random_load_1_log_red_tray_packing_concs,random_load_1_log_red_reject_concs,random_load_1_log_red_other_concs)

random_load_1_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$loading_w6wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_loading_prev$area <- as.factor('loading')
random_load_1_log_red_loading_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_1_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$cleaning_w6wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_1_log_red_cleaning_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_1_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$sorting_w6wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_sorting_prev$area <- as.factor('sorting')
random_load_1_log_red_sorting_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_1_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$reject_w6wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_reject_prev$area <- as.factor('reject')
random_load_1_log_red_reject_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_1_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$tray_packing_w6wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_1_log_red_tray_packing_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_1_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_other_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$other_w6wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_other_prev$area <- as.factor('other')
random_load_1_log_red_other_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_other_prev$water <- as.factor('Dry')
names(random_load_1_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_w6wed_prev <- rbind(random_load_1_log_red_loading_prev,random_load_1_log_red_cleaning_prev,random_load_1_log_red_sorting_prev,random_load_1_log_red_tray_packing_prev,random_load_1_log_red_reject_prev,random_load_1_log_red_other_prev)

random_load_1_log_red_w6wed_wet_prev <- as.data.frame(random_load_1_log_red_loading_prev$prevalence*21/100+random_load_1_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_1_log_red_w6wed_wet_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_w6wed_wet_prev$water <- as.factor('Wet')
names(random_load_1_log_red_w6wed_wet_prev) <- c('prevalence','scenario','water')

random_load_1_log_red_w6wed_dry_prev <- as.data.frame(random_load_1_log_red_sorting_prev$prevalence*20/100+random_load_1_log_red_reject_prev$prevalence*23/100+random_load_1_log_red_tray_packing_prev$prevalence*123/100+random_load_1_log_red_other_prev$prevalence*10/100)/176*100
random_load_1_log_red_w6wed_dry_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_w6wed_dry_prev$water <- as.factor('Dry')
names(random_load_1_log_red_w6wed_dry_prev) <- c('prevalence','scenario','water')

random_load_1_log_red_w6wed_recombined_prev <- rbind(random_load_1_log_red_w6wed_wet_prev, random_load_1_log_red_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Random_Load_1_Log_Red$loading_w7wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_loading_w7wed_conc_list <- append(random_load_1_log_red_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_loading_w7wed_conc_matrix <- matrix(unlist(random_load_1_log_red_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_cleaning_w7wed_conc_list <- append(random_load_1_log_red_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_cleaning_w7wed_conc_matrix <- matrix(unlist(random_load_1_log_red_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_1_Log_Red$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# random_load_1_log_red_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_1_log_red_drying_w7wed_conc_list <- append(random_load_1_log_red_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_1_Log_Red$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_sorting_w7wed_conc_list <- append(random_load_1_log_red_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_sorting_w7wed_conc_matrix <- matrix(unlist(random_load_1_log_red_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_tray_packing_w7wed_conc_list <- append(random_load_1_log_red_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_tray_packing_w7wed_conc_matrix <- matrix(unlist(random_load_1_log_red_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$reject_w7wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_reject_w7wed_conc_list <- append(random_load_1_log_red_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_reject_w7wed_conc_matrix <- matrix(unlist(random_load_1_log_red_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$other_w7wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_other_w7wed_conc_list <- append(random_load_1_log_red_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_other_w7wed_conc_matrix <- matrix(unlist(random_load_1_log_red_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

random_load_1_log_red_loading_concs <- as.data.frame(random_load_1_log_red_loading_w7wed_conc_list)
random_load_1_log_red_loading_concs$area <- as.factor('loading')
random_load_1_log_red_loading_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_1_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_cleaning_concs <- as.data.frame(random_load_1_log_red_cleaning_w7wed_conc_list)
random_load_1_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_1_log_red_cleaning_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_1_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_sorting_concs <- as.data.frame(random_load_1_log_red_sorting_w7wed_conc_list)
random_load_1_log_red_sorting_concs$area <- as.factor('sorting')
random_load_1_log_red_sorting_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_1_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_reject_concs <- as.data.frame(random_load_1_log_red_reject_w7wed_conc_list)
random_load_1_log_red_reject_concs$area <- as.factor('reject')
random_load_1_log_red_reject_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_1_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_tray_packing_concs <- as.data.frame(random_load_1_log_red_tray_packing_w7wed_conc_list)
random_load_1_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_1_log_red_tray_packing_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_1_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_other_concs <- as.data.frame(random_load_1_log_red_other_w7wed_conc_list)
random_load_1_log_red_other_concs$area <- as.factor('other')
random_load_1_log_red_other_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_other_concs$water <- as.factor('Dry')
names(random_load_1_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_w7wed_concs <- rbind(random_load_1_log_red_loading_concs,random_load_1_log_red_cleaning_concs,random_load_1_log_red_sorting_concs,random_load_1_log_red_tray_packing_concs,random_load_1_log_red_reject_concs,random_load_1_log_red_other_concs)

random_load_1_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$loading_w7wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_loading_prev$area <- as.factor('loading')
random_load_1_log_red_loading_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_1_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$cleaning_w7wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_1_log_red_cleaning_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_1_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$sorting_w7wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_sorting_prev$area <- as.factor('sorting')
random_load_1_log_red_sorting_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_1_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$reject_w7wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_reject_prev$area <- as.factor('reject')
random_load_1_log_red_reject_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_1_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$tray_packing_w7wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_1_log_red_tray_packing_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_1_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_other_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$other_w7wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_other_prev$area <- as.factor('other')
random_load_1_log_red_other_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_other_prev$water <- as.factor('Dry')
names(random_load_1_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_w7wed_prev <- rbind(random_load_1_log_red_loading_prev,random_load_1_log_red_cleaning_prev,random_load_1_log_red_sorting_prev,random_load_1_log_red_tray_packing_prev,random_load_1_log_red_reject_prev,random_load_1_log_red_other_prev)

random_load_1_log_red_w7wed_wet_prev <- as.data.frame(random_load_1_log_red_loading_prev$prevalence*21/100+random_load_1_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_1_log_red_w7wed_wet_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_w7wed_wet_prev$water <- as.factor('Wet')
names(random_load_1_log_red_w7wed_wet_prev) <- c('prevalence','scenario','water')

random_load_1_log_red_w7wed_dry_prev <- as.data.frame(random_load_1_log_red_sorting_prev$prevalence*20/100+random_load_1_log_red_reject_prev$prevalence*23/100+random_load_1_log_red_tray_packing_prev$prevalence*123/100+random_load_1_log_red_other_prev$prevalence*10/100)/176*100
random_load_1_log_red_w7wed_dry_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_w7wed_dry_prev$water <- as.factor('Dry')
names(random_load_1_log_red_w7wed_dry_prev) <- c('prevalence','scenario','water')

random_load_1_log_red_w7wed_recombined_prev <- rbind(random_load_1_log_red_w7wed_wet_prev, random_load_1_log_red_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Random_Load_1_Log_Red$loading_w8wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_loading_w8wed_conc_list <- append(random_load_1_log_red_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_loading_w8wed_conc_matrix <- matrix(unlist(random_load_1_log_red_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_cleaning_w8wed_conc_list <- append(random_load_1_log_red_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_cleaning_w8wed_conc_matrix <- matrix(unlist(random_load_1_log_red_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_1_Log_Red$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# random_load_1_log_red_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_1_log_red_drying_w8wed_conc_list <- append(random_load_1_log_red_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_1_Log_Red$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_sorting_w8wed_conc_list <- append(random_load_1_log_red_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_sorting_w8wed_conc_matrix <- matrix(unlist(random_load_1_log_red_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_tray_packing_w8wed_conc_list <- append(random_load_1_log_red_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_tray_packing_w8wed_conc_matrix <- matrix(unlist(random_load_1_log_red_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$reject_w8wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_reject_w8wed_conc_list <- append(random_load_1_log_red_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_reject_w8wed_conc_matrix <- matrix(unlist(random_load_1_log_red_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_1_Log_Red$other_w8wed_conc_list
vector <- vector[vector!='[]']
random_load_1_log_red_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_1_log_red_other_w8wed_conc_list <- append(random_load_1_log_red_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_1_log_red_other_w8wed_conc_matrix <- matrix(unlist(random_load_1_log_red_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

random_load_1_log_red_loading_concs <- as.data.frame(random_load_1_log_red_loading_w8wed_conc_list)
random_load_1_log_red_loading_concs$area <- as.factor('loading')
random_load_1_log_red_loading_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_1_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_cleaning_concs <- as.data.frame(random_load_1_log_red_cleaning_w8wed_conc_list)
random_load_1_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_1_log_red_cleaning_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_1_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_sorting_concs <- as.data.frame(random_load_1_log_red_sorting_w8wed_conc_list)
random_load_1_log_red_sorting_concs$area <- as.factor('sorting')
random_load_1_log_red_sorting_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_1_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_reject_concs <- as.data.frame(random_load_1_log_red_reject_w8wed_conc_list)
random_load_1_log_red_reject_concs$area <- as.factor('reject')
random_load_1_log_red_reject_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_1_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_tray_packing_concs <- as.data.frame(random_load_1_log_red_tray_packing_w8wed_conc_list)
random_load_1_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_1_log_red_tray_packing_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_1_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_other_concs <- as.data.frame(random_load_1_log_red_other_w8wed_conc_list)
random_load_1_log_red_other_concs$area <- as.factor('other')
random_load_1_log_red_other_concs$scenario <- as.factor('LR_01')
random_load_1_log_red_other_concs$water <- as.factor('Dry')
names(random_load_1_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_1_log_red_w8wed_concs <- rbind(random_load_1_log_red_loading_concs,random_load_1_log_red_cleaning_concs,random_load_1_log_red_sorting_concs,random_load_1_log_red_tray_packing_concs,random_load_1_log_red_reject_concs,random_load_1_log_red_other_concs)

random_load_1_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$loading_w8wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_loading_prev$area <- as.factor('loading')
random_load_1_log_red_loading_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_1_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$cleaning_w8wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_1_log_red_cleaning_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_1_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$sorting_w8wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_sorting_prev$area <- as.factor('sorting')
random_load_1_log_red_sorting_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_1_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$reject_w8wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_reject_prev$area <- as.factor('reject')
random_load_1_log_red_reject_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_1_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$tray_packing_w8wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_1_log_red_tray_packing_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_1_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_other_prev <- as.data.frame(NL_table_Random_Load_1_Log_Red$other_w8wed_prev[order(NL_table_Random_Load_1_Log_Red$local_seed)])
random_load_1_log_red_other_prev$area <- as.factor('other')
random_load_1_log_red_other_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_other_prev$water <- as.factor('Dry')
names(random_load_1_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_1_log_red_w8wed_prev <- rbind(random_load_1_log_red_loading_prev,random_load_1_log_red_cleaning_prev,random_load_1_log_red_sorting_prev,random_load_1_log_red_tray_packing_prev,random_load_1_log_red_reject_prev,random_load_1_log_red_other_prev)

random_load_1_log_red_w8wed_wet_prev <- as.data.frame(random_load_1_log_red_loading_prev$prevalence*21/100+random_load_1_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_1_log_red_w8wed_wet_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_w8wed_wet_prev$water <- as.factor('Wet')
names(random_load_1_log_red_w8wed_wet_prev) <- c('prevalence','scenario','water')

random_load_1_log_red_w8wed_dry_prev <- as.data.frame(random_load_1_log_red_sorting_prev$prevalence*20/100+random_load_1_log_red_reject_prev$prevalence*23/100+random_load_1_log_red_tray_packing_prev$prevalence*123/100+random_load_1_log_red_other_prev$prevalence*10/100)/176*100
random_load_1_log_red_w8wed_dry_prev$scenario <- as.factor('LR_01')
random_load_1_log_red_w8wed_dry_prev$water <- as.factor('Dry')
names(random_load_1_log_red_w8wed_dry_prev) <- c('prevalence','scenario','water')

random_load_1_log_red_w8wed_recombined_prev <- rbind(random_load_1_log_red_w8wed_wet_prev, random_load_1_log_red_w8wed_dry_prev)

vector <- NL_table_Random_Load_1_Log_Red$lifetime_conc_list[order(NL_table_Random_Load_1_Log_Red$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

random_load_1_log_red_w1wed_recombined_prev$week <- as.factor(1)
random_load_1_log_red_w2wed_recombined_prev$week <- as.factor(2)
random_load_1_log_red_w3wed_recombined_prev$week <- as.factor(3)
random_load_1_log_red_w4wed_recombined_prev$week <- as.factor(4)
random_load_1_log_red_w5wed_recombined_prev$week <- as.factor(5)
random_load_1_log_red_w6wed_recombined_prev$week <- as.factor(6)
random_load_1_log_red_w7wed_recombined_prev$week <- as.factor(7)
random_load_1_log_red_w8wed_recombined_prev$week <- as.factor(8)
random_load_1_log_red_allwed_prev <- rbind(random_load_1_log_red_w1wed_recombined_prev,random_load_1_log_red_w2wed_recombined_prev,random_load_1_log_red_w3wed_recombined_prev,random_load_1_log_red_w4wed_recombined_prev,random_load_1_log_red_w5wed_recombined_prev,random_load_1_log_red_w6wed_recombined_prev,random_load_1_log_red_w7wed_recombined_prev,random_load_1_log_red_w8wed_recombined_prev)

Facility_B_random_load_1_log_red_agents_melted <- melt(mdarray)
colnames(Facility_B_random_load_1_log_red_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_random_load_1_log_red_agents_melted$agent <- Facility_B_random_load_1_log_red_agents_melted$agent-1
Facility_B_random_load_1_log_red_agents_melted$logical <- Facility_B_random_load_1_log_red_agents_melted$value>0
Facility_B_random_load_1_log_red_agents_melted$binary <- as.numeric(Facility_B_random_load_1_log_red_agents_melted$logical)
Facility_B_random_load_1_log_red_agents_melted$log10value <- log10(Facility_B_random_load_1_log_red_agents_melted$value)
Facility_B_random_load_1_log_red_agents_melted$log10value[is.infinite(Facility_B_random_load_1_log_red_agents_melted$log10value)] <- 0

agent <- Facility_B_random_load_1_log_red_agents_melted$agent
iteration <- Facility_B_random_load_1_log_red_agents_melted$iteration
tick <- Facility_B_random_load_1_log_red_agents_melted$tick
rle_matrix <- tapply(Facility_B_random_load_1_log_red_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_load_1_log_red_mean_value_matrix <- tapply(Facility_B_random_load_1_log_red_agents_melted$value, list(agent, tick), mean)
Facility_B_load_1_log_red_median_value_matrix <- tapply(Facility_B_random_load_1_log_red_agents_melted$value, list(agent, tick), median)
Facility_B_load_1_log_red_prob_value_matrix <- tapply(Facility_B_random_load_1_log_red_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}
# durations$agent <- durations$agent-1

Facility_B_durations_random_load_1_log_red <- durations

agents_list_random_load_1_log_red <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_random_load_1_log_red <- agents_list_random_load_1_log_red[,c("V1","V7","V8","V9")]
colnames(agents_list_random_load_1_log_red) <- c("name","sanitation_status","schedule","area")
agents_list_random_load_1_log_red$ttp <- rep((168*2),225)
agents_list_random_load_1_log_red$ttp[agents_list_random_load_1_log_red$schedule=="daily"] <- (24*2)

agent <- 1
while(agent<=225) {
  agents_list_random_load_1_log_red$min_duration[agent] <- ifelse(length(Facility_B_durations_random_load_1_log_red$duration[Facility_B_durations_random_load_1_log_red$agent==agent])==0,NA,min(Facility_B_durations_random_load_1_log_red$duration[Facility_B_durations_random_load_1_log_red$agent==agent], na.rm = TRUE))
  agents_list_random_load_1_log_red$mean_duration[agent] <- ifelse(length(Facility_B_durations_random_load_1_log_red$duration[Facility_B_durations_random_load_1_log_red$agent==agent])==0,NA,mean(Facility_B_durations_random_load_1_log_red$duration[Facility_B_durations_random_load_1_log_red$agent==agent], na.rm = TRUE))
  agents_list_random_load_1_log_red$median_duration[agent] <- ifelse(length(Facility_B_durations_random_load_1_log_red$duration[Facility_B_durations_random_load_1_log_red$agent==agent])==0,NA,median(Facility_B_durations_random_load_1_log_red$duration[Facility_B_durations_random_load_1_log_red$agent==agent], na.rm = TRUE))
  agents_list_random_load_1_log_red$max_duration[agent] <- ifelse(length(Facility_B_durations_random_load_1_log_red$duration[Facility_B_durations_random_load_1_log_red$agent==agent])==0,NA,max(Facility_B_durations_random_load_1_log_red$duration[Facility_B_durations_random_load_1_log_red$agent==agent], na.rm = TRUE))
  agents_list_random_load_1_log_red$times_persistent[agent] <- sum(Facility_B_durations_random_load_1_log_red$duration[Facility_B_durations_random_load_1_log_red$agent==agent]>agents_list_random_load_1_log_red$ttp[agent])
  agent <- agent+1 
}

Facility_B_random_load_1_log_red_agents_melted_monday_preop <- Facility_B_random_load_1_log_red_agents_melted[which(Facility_B_random_load_1_log_red_agents_melted$tick==33|Facility_B_random_load_1_log_red_agents_melted$tick==201|Facility_B_random_load_1_log_red_agents_melted$tick==369|Facility_B_random_load_1_log_red_agents_melted$tick==537|Facility_B_random_load_1_log_red_agents_melted$tick==705|Facility_B_random_load_1_log_red_agents_melted$tick==873|Facility_B_random_load_1_log_red_agents_melted$tick==1041|Facility_B_random_load_1_log_red_agents_melted$tick==1209),]

Facility_B_random_load_1_log_red_agents_melted_tuesday_preop <- Facility_B_random_load_1_log_red_agents_melted[which(Facility_B_random_load_1_log_red_agents_melted$tick==57|Facility_B_random_load_1_log_red_agents_melted$tick==225|Facility_B_random_load_1_log_red_agents_melted$tick==393|Facility_B_random_load_1_log_red_agents_melted$tick==561|Facility_B_random_load_1_log_red_agents_melted$tick==729|Facility_B_random_load_1_log_red_agents_melted$tick==897|Facility_B_random_load_1_log_red_agents_melted$tick==1065|Facility_B_random_load_1_log_red_agents_melted$tick==1233),]

Facility_B_random_load_1_log_red_agents_melted_wednesday_preop <- Facility_B_random_load_1_log_red_agents_melted[which(Facility_B_random_load_1_log_red_agents_melted$tick==81|Facility_B_random_load_1_log_red_agents_melted$tick==249|Facility_B_random_load_1_log_red_agents_melted$tick==417|Facility_B_random_load_1_log_red_agents_melted$tick==585|Facility_B_random_load_1_log_red_agents_melted$tick==753|Facility_B_random_load_1_log_red_agents_melted$tick==921|Facility_B_random_load_1_log_red_agents_melted$tick==1089|Facility_B_random_load_1_log_red_agents_melted$tick==1257),]

Facility_B_random_load_1_log_red_agents_melted_thursday_preop <- Facility_B_random_load_1_log_red_agents_melted[which(Facility_B_random_load_1_log_red_agents_melted$tick==105|Facility_B_random_load_1_log_red_agents_melted$tick==273|Facility_B_random_load_1_log_red_agents_melted$tick==441|Facility_B_random_load_1_log_red_agents_melted$tick==609|Facility_B_random_load_1_log_red_agents_melted$tick==777|Facility_B_random_load_1_log_red_agents_melted$tick==945|Facility_B_random_load_1_log_red_agents_melted$tick==1113|Facility_B_random_load_1_log_red_agents_melted$tick==1281),]

Facility_B_random_load_1_log_red_agents_melted_friday_preop <- Facility_B_random_load_1_log_red_agents_melted[which(Facility_B_random_load_1_log_red_agents_melted$tick==129|Facility_B_random_load_1_log_red_agents_melted$tick==297|Facility_B_random_load_1_log_red_agents_melted$tick==465|Facility_B_random_load_1_log_red_agents_melted$tick==633|Facility_B_random_load_1_log_red_agents_melted$tick==801|Facility_B_random_load_1_log_red_agents_melted$tick==969|Facility_B_random_load_1_log_red_agents_melted$tick==1137|Facility_B_random_load_1_log_red_agents_melted$tick==1305),]

Facility_B_random_load_1_log_red_agents_melted_ff <- as.ffdf(Facility_B_random_load_1_log_red_agents_melted)
rm(Facility_B_random_load_1_log_red_agents_melted)
gc()
```

```{r import Random Load 2 Log Reduction}
NL_table_Random_Load_2_Log_Red <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-28-03-36 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_Random_Load_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Random_Load_2_Log_Red <- NL_table_Random_Load_2_Log_Red[NL_table_Random_Load_2_Log_Red$scenario==13,]

while (any(grepl('-', names(NL_table_Random_Load_2_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_2_Log_Red <- NL_table_Random_Load_2_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Random_Load_2_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_2_Log_Red <- NL_table_Random_Load_2_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Random_Load_2_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_2_Log_Red <- NL_table_Random_Load_2_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Random_Load_2_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_2_Log_Red <- NL_table_Random_Load_2_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Random_Load_2_Log_Red[ , ..list_columns]

NL_table_Random_Load_2_Log_Red[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Random_Load_2_Log_Red <- as.data.frame(NL_table_Random_Load_2_Log_Red)

NL_table_Random_Load_2_Log_Red[NL_table_Random_Load_2_Log_Red==-1] <- NA

NL_table_Random_Load_2_Log_Red <- subset(NL_table_Random_Load_2_Log_Red, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Random_Load_2_Log_Red)[names(NL_table_Random_Load_2_Log_Red)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Random_Load_2_Log_Red)[names(NL_table_Random_Load_2_Log_Red)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Random_Load_2_Log_Red$loading_w1wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_loading_w1wed_conc_list <- append(random_load_2_log_red_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_loading_w1wed_conc_matrix <- matrix(unlist(random_load_2_log_red_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_cleaning_w1wed_conc_list <- append(random_load_2_log_red_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_cleaning_w1wed_conc_matrix <- matrix(unlist(random_load_2_log_red_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_2_Log_Red$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# random_load_2_log_red_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_2_log_red_drying_w1wed_conc_list <- append(random_load_2_log_red_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_2_Log_Red$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_sorting_w1wed_conc_list <- append(random_load_2_log_red_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_sorting_w1wed_conc_matrix <- matrix(unlist(random_load_2_log_red_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_tray_packing_w1wed_conc_list <- append(random_load_2_log_red_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_tray_packing_w1wed_conc_matrix <- matrix(unlist(random_load_2_log_red_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$reject_w1wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_reject_w1wed_conc_list <- append(random_load_2_log_red_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_reject_w1wed_conc_matrix <- matrix(unlist(random_load_2_log_red_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$other_w1wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_other_w1wed_conc_list <- append(random_load_2_log_red_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_other_w1wed_conc_matrix <- matrix(unlist(random_load_2_log_red_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

random_load_2_log_red_loading_concs <- as.data.frame(random_load_2_log_red_loading_w1wed_conc_list)
random_load_2_log_red_loading_concs$area <- as.factor('loading')
random_load_2_log_red_loading_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_2_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_cleaning_concs <- as.data.frame(random_load_2_log_red_cleaning_w1wed_conc_list)
random_load_2_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_2_log_red_cleaning_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_2_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_sorting_concs <- as.data.frame(random_load_2_log_red_sorting_w1wed_conc_list)
random_load_2_log_red_sorting_concs$area <- as.factor('sorting')
random_load_2_log_red_sorting_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_2_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_reject_concs <- as.data.frame(random_load_2_log_red_reject_w1wed_conc_list)
random_load_2_log_red_reject_concs$area <- as.factor('reject')
random_load_2_log_red_reject_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_2_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_tray_packing_concs <- as.data.frame(random_load_2_log_red_tray_packing_w1wed_conc_list)
random_load_2_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_2_log_red_tray_packing_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_2_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_other_concs <- as.data.frame(random_load_2_log_red_other_w1wed_conc_list)
random_load_2_log_red_other_concs$area <- as.factor('other')
random_load_2_log_red_other_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_other_concs$water <- as.factor('Dry')
names(random_load_2_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_w1wed_concs <- rbind(random_load_2_log_red_loading_concs,random_load_2_log_red_cleaning_concs,random_load_2_log_red_sorting_concs,random_load_2_log_red_tray_packing_concs,random_load_2_log_red_reject_concs,random_load_2_log_red_other_concs)

random_load_2_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$loading_w1wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_loading_prev$area <- as.factor('loading')
random_load_2_log_red_loading_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_2_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$cleaning_w1wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_2_log_red_cleaning_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_2_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$sorting_w1wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_sorting_prev$area <- as.factor('sorting')
random_load_2_log_red_sorting_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_2_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$reject_w1wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_reject_prev$area <- as.factor('reject')
random_load_2_log_red_reject_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_2_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$tray_packing_w1wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_2_log_red_tray_packing_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_2_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_other_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$other_w1wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_other_prev$area <- as.factor('other')
random_load_2_log_red_other_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_other_prev$water <- as.factor('Dry')
names(random_load_2_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_w1wed_prev <- rbind(random_load_2_log_red_loading_prev,random_load_2_log_red_cleaning_prev,random_load_2_log_red_sorting_prev,random_load_2_log_red_tray_packing_prev,random_load_2_log_red_reject_prev,random_load_2_log_red_other_prev)

random_load_2_log_red_w1wed_wet_prev <- as.data.frame(random_load_2_log_red_loading_prev$prevalence*21/100+random_load_2_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_2_log_red_w1wed_wet_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_w1wed_wet_prev$water <- as.factor('Wet')
names(random_load_2_log_red_w1wed_wet_prev) <- c('prevalence','scenario','water')

random_load_2_log_red_w1wed_dry_prev <- as.data.frame(random_load_2_log_red_sorting_prev$prevalence*20/100+random_load_2_log_red_reject_prev$prevalence*23/100+random_load_2_log_red_tray_packing_prev$prevalence*123/100+random_load_2_log_red_other_prev$prevalence*10/100)/176*100
random_load_2_log_red_w1wed_dry_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_w1wed_dry_prev$water <- as.factor('Dry')
names(random_load_2_log_red_w1wed_dry_prev) <- c('prevalence','scenario','water')

random_load_2_log_red_w1wed_recombined_prev <- rbind(random_load_2_log_red_w1wed_wet_prev, random_load_2_log_red_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Random_Load_2_Log_Red$loading_w2wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_loading_w2wed_conc_list <- append(random_load_2_log_red_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_loading_w2wed_conc_matrix <- matrix(unlist(random_load_2_log_red_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_cleaning_w2wed_conc_list <- append(random_load_2_log_red_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_cleaning_w2wed_conc_matrix <- matrix(unlist(random_load_2_log_red_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_2_Log_Red$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# random_load_2_log_red_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_2_log_red_drying_w2wed_conc_list <- append(random_load_2_log_red_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_2_Log_Red$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_sorting_w2wed_conc_list <- append(random_load_2_log_red_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_sorting_w2wed_conc_matrix <- matrix(unlist(random_load_2_log_red_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_tray_packing_w2wed_conc_list <- append(random_load_2_log_red_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_tray_packing_w2wed_conc_matrix <- matrix(unlist(random_load_2_log_red_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$reject_w2wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_reject_w2wed_conc_list <- append(random_load_2_log_red_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_reject_w2wed_conc_matrix <- matrix(unlist(random_load_2_log_red_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$other_w2wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_other_w2wed_conc_list <- append(random_load_2_log_red_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_other_w2wed_conc_matrix <- matrix(unlist(random_load_2_log_red_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

random_load_2_log_red_loading_concs <- as.data.frame(random_load_2_log_red_loading_w2wed_conc_list)
random_load_2_log_red_loading_concs$area <- as.factor('loading')
random_load_2_log_red_loading_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_2_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_cleaning_concs <- as.data.frame(random_load_2_log_red_cleaning_w2wed_conc_list)
random_load_2_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_2_log_red_cleaning_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_2_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_sorting_concs <- as.data.frame(random_load_2_log_red_sorting_w2wed_conc_list)
random_load_2_log_red_sorting_concs$area <- as.factor('sorting')
random_load_2_log_red_sorting_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_2_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_reject_concs <- as.data.frame(random_load_2_log_red_reject_w2wed_conc_list)
random_load_2_log_red_reject_concs$area <- as.factor('reject')
random_load_2_log_red_reject_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_2_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_tray_packing_concs <- as.data.frame(random_load_2_log_red_tray_packing_w2wed_conc_list)
random_load_2_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_2_log_red_tray_packing_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_2_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_other_concs <- as.data.frame(random_load_2_log_red_other_w2wed_conc_list)
random_load_2_log_red_other_concs$area <- as.factor('other')
random_load_2_log_red_other_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_other_concs$water <- as.factor('Dry')
names(random_load_2_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_w2wed_concs <- rbind(random_load_2_log_red_loading_concs,random_load_2_log_red_cleaning_concs,random_load_2_log_red_sorting_concs,random_load_2_log_red_tray_packing_concs,random_load_2_log_red_reject_concs,random_load_2_log_red_other_concs)

random_load_2_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$loading_w2wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_loading_prev$area <- as.factor('loading')
random_load_2_log_red_loading_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_2_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$cleaning_w2wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_2_log_red_cleaning_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_2_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$sorting_w2wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_sorting_prev$area <- as.factor('sorting')
random_load_2_log_red_sorting_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_2_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$reject_w2wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_reject_prev$area <- as.factor('reject')
random_load_2_log_red_reject_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_2_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$tray_packing_w2wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_2_log_red_tray_packing_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_2_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_other_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$other_w2wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_other_prev$area <- as.factor('other')
random_load_2_log_red_other_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_other_prev$water <- as.factor('Dry')
names(random_load_2_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_w2wed_prev <- rbind(random_load_2_log_red_loading_prev,random_load_2_log_red_cleaning_prev,random_load_2_log_red_sorting_prev,random_load_2_log_red_tray_packing_prev,random_load_2_log_red_reject_prev,random_load_2_log_red_other_prev)

random_load_2_log_red_w2wed_wet_prev <- as.data.frame(random_load_2_log_red_loading_prev$prevalence*21/100+random_load_2_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_2_log_red_w2wed_wet_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_w2wed_wet_prev$water <- as.factor('Wet')
names(random_load_2_log_red_w2wed_wet_prev) <- c('prevalence','scenario','water')

random_load_2_log_red_w2wed_dry_prev <- as.data.frame(random_load_2_log_red_sorting_prev$prevalence*20/100+random_load_2_log_red_reject_prev$prevalence*23/100+random_load_2_log_red_tray_packing_prev$prevalence*123/100+random_load_2_log_red_other_prev$prevalence*10/100)/176*100
random_load_2_log_red_w2wed_dry_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_w2wed_dry_prev$water <- as.factor('Dry')
names(random_load_2_log_red_w2wed_dry_prev) <- c('prevalence','scenario','water')

random_load_2_log_red_w2wed_recombined_prev <- rbind(random_load_2_log_red_w2wed_wet_prev, random_load_2_log_red_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Random_Load_2_Log_Red$loading_w3wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_loading_w3wed_conc_list <- append(random_load_2_log_red_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_loading_w3wed_conc_matrix <- matrix(unlist(random_load_2_log_red_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_cleaning_w3wed_conc_list <- append(random_load_2_log_red_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_cleaning_w3wed_conc_matrix <- matrix(unlist(random_load_2_log_red_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_2_Log_Red$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# random_load_2_log_red_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_2_log_red_drying_w3wed_conc_list <- append(random_load_2_log_red_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_2_Log_Red$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_sorting_w3wed_conc_list <- append(random_load_2_log_red_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_sorting_w3wed_conc_matrix <- matrix(unlist(random_load_2_log_red_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_tray_packing_w3wed_conc_list <- append(random_load_2_log_red_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_tray_packing_w3wed_conc_matrix <- matrix(unlist(random_load_2_log_red_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$reject_w3wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_reject_w3wed_conc_list <- append(random_load_2_log_red_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_reject_w3wed_conc_matrix <- matrix(unlist(random_load_2_log_red_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$other_w3wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_other_w3wed_conc_list <- append(random_load_2_log_red_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_other_w3wed_conc_matrix <- matrix(unlist(random_load_2_log_red_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

random_load_2_log_red_loading_concs <- as.data.frame(random_load_2_log_red_loading_w3wed_conc_list)
random_load_2_log_red_loading_concs$area <- as.factor('loading')
random_load_2_log_red_loading_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_2_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_cleaning_concs <- as.data.frame(random_load_2_log_red_cleaning_w3wed_conc_list)
random_load_2_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_2_log_red_cleaning_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_2_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_sorting_concs <- as.data.frame(random_load_2_log_red_sorting_w3wed_conc_list)
random_load_2_log_red_sorting_concs$area <- as.factor('sorting')
random_load_2_log_red_sorting_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_2_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_reject_concs <- as.data.frame(random_load_2_log_red_reject_w3wed_conc_list)
random_load_2_log_red_reject_concs$area <- as.factor('reject')
random_load_2_log_red_reject_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_2_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_tray_packing_concs <- as.data.frame(random_load_2_log_red_tray_packing_w3wed_conc_list)
random_load_2_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_2_log_red_tray_packing_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_2_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_other_concs <- as.data.frame(random_load_2_log_red_other_w3wed_conc_list)
random_load_2_log_red_other_concs$area <- as.factor('other')
random_load_2_log_red_other_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_other_concs$water <- as.factor('Dry')
names(random_load_2_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_w3wed_concs <- rbind(random_load_2_log_red_loading_concs,random_load_2_log_red_cleaning_concs,random_load_2_log_red_sorting_concs,random_load_2_log_red_tray_packing_concs,random_load_2_log_red_reject_concs,random_load_2_log_red_other_concs)

random_load_2_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$loading_w3wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_loading_prev$area <- as.factor('loading')
random_load_2_log_red_loading_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_2_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$cleaning_w3wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_2_log_red_cleaning_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_2_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$sorting_w3wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_sorting_prev$area <- as.factor('sorting')
random_load_2_log_red_sorting_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_2_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$reject_w3wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_reject_prev$area <- as.factor('reject')
random_load_2_log_red_reject_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_2_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$tray_packing_w3wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_2_log_red_tray_packing_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_2_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_other_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$other_w3wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_other_prev$area <- as.factor('other')
random_load_2_log_red_other_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_other_prev$water <- as.factor('Dry')
names(random_load_2_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_w3wed_prev <- rbind(random_load_2_log_red_loading_prev,random_load_2_log_red_cleaning_prev,random_load_2_log_red_sorting_prev,random_load_2_log_red_tray_packing_prev,random_load_2_log_red_reject_prev,random_load_2_log_red_other_prev)

random_load_2_log_red_w3wed_wet_prev <- as.data.frame(random_load_2_log_red_loading_prev$prevalence*21/100+random_load_2_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_2_log_red_w3wed_wet_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_w3wed_wet_prev$water <- as.factor('Wet')
names(random_load_2_log_red_w3wed_wet_prev) <- c('prevalence','scenario','water')

random_load_2_log_red_w3wed_dry_prev <- as.data.frame(random_load_2_log_red_sorting_prev$prevalence*20/100+random_load_2_log_red_reject_prev$prevalence*23/100+random_load_2_log_red_tray_packing_prev$prevalence*123/100+random_load_2_log_red_other_prev$prevalence*10/100)/176*100
random_load_2_log_red_w3wed_dry_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_w3wed_dry_prev$water <- as.factor('Dry')
names(random_load_2_log_red_w3wed_dry_prev) <- c('prevalence','scenario','water')

random_load_2_log_red_w3wed_recombined_prev <- rbind(random_load_2_log_red_w3wed_wet_prev, random_load_2_log_red_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Random_Load_2_Log_Red$loading_w4wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_loading_w4wed_conc_list <- append(random_load_2_log_red_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_loading_w4wed_conc_matrix <- matrix(unlist(random_load_2_log_red_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_cleaning_w4wed_conc_list <- append(random_load_2_log_red_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_cleaning_w4wed_conc_matrix <- matrix(unlist(random_load_2_log_red_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_2_Log_Red$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# random_load_2_log_red_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_2_log_red_drying_w4wed_conc_list <- append(random_load_2_log_red_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_2_Log_Red$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_sorting_w4wed_conc_list <- append(random_load_2_log_red_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_sorting_w4wed_conc_matrix <- matrix(unlist(random_load_2_log_red_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_tray_packing_w4wed_conc_list <- append(random_load_2_log_red_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_tray_packing_w4wed_conc_matrix <- matrix(unlist(random_load_2_log_red_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$reject_w4wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_reject_w4wed_conc_list <- append(random_load_2_log_red_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_reject_w4wed_conc_matrix <- matrix(unlist(random_load_2_log_red_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$other_w4wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_other_w4wed_conc_list <- append(random_load_2_log_red_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_other_w4wed_conc_matrix <- matrix(unlist(random_load_2_log_red_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

random_load_2_log_red_loading_concs <- as.data.frame(random_load_2_log_red_loading_w4wed_conc_list)
random_load_2_log_red_loading_concs$area <- as.factor('loading')
random_load_2_log_red_loading_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_2_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_cleaning_concs <- as.data.frame(random_load_2_log_red_cleaning_w4wed_conc_list)
random_load_2_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_2_log_red_cleaning_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_2_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_sorting_concs <- as.data.frame(random_load_2_log_red_sorting_w4wed_conc_list)
random_load_2_log_red_sorting_concs$area <- as.factor('sorting')
random_load_2_log_red_sorting_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_2_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_reject_concs <- as.data.frame(random_load_2_log_red_reject_w4wed_conc_list)
random_load_2_log_red_reject_concs$area <- as.factor('reject')
random_load_2_log_red_reject_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_2_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_tray_packing_concs <- as.data.frame(random_load_2_log_red_tray_packing_w4wed_conc_list)
random_load_2_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_2_log_red_tray_packing_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_2_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_other_concs <- as.data.frame(random_load_2_log_red_other_w4wed_conc_list)
random_load_2_log_red_other_concs$area <- as.factor('other')
random_load_2_log_red_other_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_other_concs$water <- as.factor('Dry')
names(random_load_2_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_w4wed_concs <- rbind(random_load_2_log_red_loading_concs,random_load_2_log_red_cleaning_concs,random_load_2_log_red_sorting_concs,random_load_2_log_red_tray_packing_concs,random_load_2_log_red_reject_concs,random_load_2_log_red_other_concs)

random_load_2_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$loading_w4wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_loading_prev$area <- as.factor('loading')
random_load_2_log_red_loading_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_2_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$cleaning_w4wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_2_log_red_cleaning_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_2_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$sorting_w4wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_sorting_prev$area <- as.factor('sorting')
random_load_2_log_red_sorting_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_2_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$reject_w4wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_reject_prev$area <- as.factor('reject')
random_load_2_log_red_reject_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_2_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$tray_packing_w4wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_2_log_red_tray_packing_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_2_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_other_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$other_w4wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_other_prev$area <- as.factor('other')
random_load_2_log_red_other_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_other_prev$water <- as.factor('Dry')
names(random_load_2_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_w4wed_prev <- rbind(random_load_2_log_red_loading_prev,random_load_2_log_red_cleaning_prev,random_load_2_log_red_sorting_prev,random_load_2_log_red_tray_packing_prev,random_load_2_log_red_reject_prev,random_load_2_log_red_other_prev)

random_load_2_log_red_w4wed_wet_prev <- as.data.frame(random_load_2_log_red_loading_prev$prevalence*21/100+random_load_2_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_2_log_red_w4wed_wet_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_w4wed_wet_prev$water <- as.factor('Wet')
names(random_load_2_log_red_w4wed_wet_prev) <- c('prevalence','scenario','water')

random_load_2_log_red_w4wed_dry_prev <- as.data.frame(random_load_2_log_red_sorting_prev$prevalence*20/100+random_load_2_log_red_reject_prev$prevalence*23/100+random_load_2_log_red_tray_packing_prev$prevalence*123/100+random_load_2_log_red_other_prev$prevalence*10/100)/176*100
random_load_2_log_red_w4wed_dry_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_w4wed_dry_prev$water <- as.factor('Dry')
names(random_load_2_log_red_w4wed_dry_prev) <- c('prevalence','scenario','water')

random_load_2_log_red_w4wed_recombined_prev <- rbind(random_load_2_log_red_w4wed_wet_prev, random_load_2_log_red_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Random_Load_2_Log_Red$loading_w5wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_loading_w5wed_conc_list <- append(random_load_2_log_red_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_loading_w5wed_conc_matrix <- matrix(unlist(random_load_2_log_red_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_cleaning_w5wed_conc_list <- append(random_load_2_log_red_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_cleaning_w5wed_conc_matrix <- matrix(unlist(random_load_2_log_red_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_2_Log_Red$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# random_load_2_log_red_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_2_log_red_drying_w5wed_conc_list <- append(random_load_2_log_red_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_2_Log_Red$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_sorting_w5wed_conc_list <- append(random_load_2_log_red_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_sorting_w5wed_conc_matrix <- matrix(unlist(random_load_2_log_red_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_tray_packing_w5wed_conc_list <- append(random_load_2_log_red_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_tray_packing_w5wed_conc_matrix <- matrix(unlist(random_load_2_log_red_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$reject_w5wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_reject_w5wed_conc_list <- append(random_load_2_log_red_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_reject_w5wed_conc_matrix <- matrix(unlist(random_load_2_log_red_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$other_w5wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_other_w5wed_conc_list <- append(random_load_2_log_red_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_other_w5wed_conc_matrix <- matrix(unlist(random_load_2_log_red_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

random_load_2_log_red_loading_concs <- as.data.frame(random_load_2_log_red_loading_w5wed_conc_list)
random_load_2_log_red_loading_concs$area <- as.factor('loading')
random_load_2_log_red_loading_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_2_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_cleaning_concs <- as.data.frame(random_load_2_log_red_cleaning_w5wed_conc_list)
random_load_2_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_2_log_red_cleaning_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_2_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_sorting_concs <- as.data.frame(random_load_2_log_red_sorting_w5wed_conc_list)
random_load_2_log_red_sorting_concs$area <- as.factor('sorting')
random_load_2_log_red_sorting_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_2_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_reject_concs <- as.data.frame(random_load_2_log_red_reject_w5wed_conc_list)
random_load_2_log_red_reject_concs$area <- as.factor('reject')
random_load_2_log_red_reject_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_2_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_tray_packing_concs <- as.data.frame(random_load_2_log_red_tray_packing_w5wed_conc_list)
random_load_2_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_2_log_red_tray_packing_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_2_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_other_concs <- as.data.frame(random_load_2_log_red_other_w5wed_conc_list)
random_load_2_log_red_other_concs$area <- as.factor('other')
random_load_2_log_red_other_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_other_concs$water <- as.factor('Dry')
names(random_load_2_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_w5wed_concs <- rbind(random_load_2_log_red_loading_concs,random_load_2_log_red_cleaning_concs,random_load_2_log_red_sorting_concs,random_load_2_log_red_tray_packing_concs,random_load_2_log_red_reject_concs,random_load_2_log_red_other_concs)

random_load_2_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$loading_w5wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_loading_prev$area <- as.factor('loading')
random_load_2_log_red_loading_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_2_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$cleaning_w5wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_2_log_red_cleaning_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_2_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$sorting_w5wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_sorting_prev$area <- as.factor('sorting')
random_load_2_log_red_sorting_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_2_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$reject_w5wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_reject_prev$area <- as.factor('reject')
random_load_2_log_red_reject_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_2_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$tray_packing_w5wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_2_log_red_tray_packing_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_2_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_other_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$other_w5wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_other_prev$area <- as.factor('other')
random_load_2_log_red_other_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_other_prev$water <- as.factor('Dry')
names(random_load_2_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_w5wed_prev <- rbind(random_load_2_log_red_loading_prev,random_load_2_log_red_cleaning_prev,random_load_2_log_red_sorting_prev,random_load_2_log_red_tray_packing_prev,random_load_2_log_red_reject_prev,random_load_2_log_red_other_prev)

random_load_2_log_red_w5wed_wet_prev <- as.data.frame(random_load_2_log_red_loading_prev$prevalence*21/100+random_load_2_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_2_log_red_w5wed_wet_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_w5wed_wet_prev$water <- as.factor('Wet')
names(random_load_2_log_red_w5wed_wet_prev) <- c('prevalence','scenario','water')

random_load_2_log_red_w5wed_dry_prev <- as.data.frame(random_load_2_log_red_sorting_prev$prevalence*20/100+random_load_2_log_red_reject_prev$prevalence*23/100+random_load_2_log_red_tray_packing_prev$prevalence*123/100+random_load_2_log_red_other_prev$prevalence*10/100)/176*100
random_load_2_log_red_w5wed_dry_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_w5wed_dry_prev$water <- as.factor('Dry')
names(random_load_2_log_red_w5wed_dry_prev) <- c('prevalence','scenario','water')

random_load_2_log_red_w5wed_recombined_prev <- rbind(random_load_2_log_red_w5wed_wet_prev, random_load_2_log_red_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Random_Load_2_Log_Red$loading_w6wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_loading_w6wed_conc_list <- append(random_load_2_log_red_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_loading_w6wed_conc_matrix <- matrix(unlist(random_load_2_log_red_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_cleaning_w6wed_conc_list <- append(random_load_2_log_red_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_cleaning_w6wed_conc_matrix <- matrix(unlist(random_load_2_log_red_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_2_Log_Red$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# random_load_2_log_red_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_2_log_red_drying_w6wed_conc_list <- append(random_load_2_log_red_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_2_Log_Red$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_sorting_w6wed_conc_list <- append(random_load_2_log_red_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_sorting_w6wed_conc_matrix <- matrix(unlist(random_load_2_log_red_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_tray_packing_w6wed_conc_list <- append(random_load_2_log_red_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_tray_packing_w6wed_conc_matrix <- matrix(unlist(random_load_2_log_red_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$reject_w6wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_reject_w6wed_conc_list <- append(random_load_2_log_red_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_reject_w6wed_conc_matrix <- matrix(unlist(random_load_2_log_red_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$other_w6wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_other_w6wed_conc_list <- append(random_load_2_log_red_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_other_w6wed_conc_matrix <- matrix(unlist(random_load_2_log_red_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

random_load_2_log_red_loading_concs <- as.data.frame(random_load_2_log_red_loading_w6wed_conc_list)
random_load_2_log_red_loading_concs$area <- as.factor('loading')
random_load_2_log_red_loading_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_2_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_cleaning_concs <- as.data.frame(random_load_2_log_red_cleaning_w6wed_conc_list)
random_load_2_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_2_log_red_cleaning_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_2_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_sorting_concs <- as.data.frame(random_load_2_log_red_sorting_w6wed_conc_list)
random_load_2_log_red_sorting_concs$area <- as.factor('sorting')
random_load_2_log_red_sorting_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_2_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_reject_concs <- as.data.frame(random_load_2_log_red_reject_w6wed_conc_list)
random_load_2_log_red_reject_concs$area <- as.factor('reject')
random_load_2_log_red_reject_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_2_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_tray_packing_concs <- as.data.frame(random_load_2_log_red_tray_packing_w6wed_conc_list)
random_load_2_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_2_log_red_tray_packing_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_2_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_other_concs <- as.data.frame(random_load_2_log_red_other_w6wed_conc_list)
random_load_2_log_red_other_concs$area <- as.factor('other')
random_load_2_log_red_other_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_other_concs$water <- as.factor('Dry')
names(random_load_2_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_w6wed_concs <- rbind(random_load_2_log_red_loading_concs,random_load_2_log_red_cleaning_concs,random_load_2_log_red_sorting_concs,random_load_2_log_red_tray_packing_concs,random_load_2_log_red_reject_concs,random_load_2_log_red_other_concs)

random_load_2_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$loading_w6wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_loading_prev$area <- as.factor('loading')
random_load_2_log_red_loading_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_2_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$cleaning_w6wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_2_log_red_cleaning_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_2_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$sorting_w6wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_sorting_prev$area <- as.factor('sorting')
random_load_2_log_red_sorting_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_2_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$reject_w6wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_reject_prev$area <- as.factor('reject')
random_load_2_log_red_reject_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_2_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$tray_packing_w6wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_2_log_red_tray_packing_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_2_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_other_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$other_w6wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_other_prev$area <- as.factor('other')
random_load_2_log_red_other_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_other_prev$water <- as.factor('Dry')
names(random_load_2_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_w6wed_prev <- rbind(random_load_2_log_red_loading_prev,random_load_2_log_red_cleaning_prev,random_load_2_log_red_sorting_prev,random_load_2_log_red_tray_packing_prev,random_load_2_log_red_reject_prev,random_load_2_log_red_other_prev)

random_load_2_log_red_w6wed_wet_prev <- as.data.frame(random_load_2_log_red_loading_prev$prevalence*21/100+random_load_2_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_2_log_red_w6wed_wet_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_w6wed_wet_prev$water <- as.factor('Wet')
names(random_load_2_log_red_w6wed_wet_prev) <- c('prevalence','scenario','water')

random_load_2_log_red_w6wed_dry_prev <- as.data.frame(random_load_2_log_red_sorting_prev$prevalence*20/100+random_load_2_log_red_reject_prev$prevalence*23/100+random_load_2_log_red_tray_packing_prev$prevalence*123/100+random_load_2_log_red_other_prev$prevalence*10/100)/176*100
random_load_2_log_red_w6wed_dry_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_w6wed_dry_prev$water <- as.factor('Dry')
names(random_load_2_log_red_w6wed_dry_prev) <- c('prevalence','scenario','water')

random_load_2_log_red_w6wed_recombined_prev <- rbind(random_load_2_log_red_w6wed_wet_prev, random_load_2_log_red_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Random_Load_2_Log_Red$loading_w7wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_loading_w7wed_conc_list <- append(random_load_2_log_red_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_loading_w7wed_conc_matrix <- matrix(unlist(random_load_2_log_red_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_cleaning_w7wed_conc_list <- append(random_load_2_log_red_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_cleaning_w7wed_conc_matrix <- matrix(unlist(random_load_2_log_red_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_2_Log_Red$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# random_load_2_log_red_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_2_log_red_drying_w7wed_conc_list <- append(random_load_2_log_red_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_2_Log_Red$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_sorting_w7wed_conc_list <- append(random_load_2_log_red_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_sorting_w7wed_conc_matrix <- matrix(unlist(random_load_2_log_red_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_tray_packing_w7wed_conc_list <- append(random_load_2_log_red_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_tray_packing_w7wed_conc_matrix <- matrix(unlist(random_load_2_log_red_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$reject_w7wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_reject_w7wed_conc_list <- append(random_load_2_log_red_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_reject_w7wed_conc_matrix <- matrix(unlist(random_load_2_log_red_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$other_w7wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_other_w7wed_conc_list <- append(random_load_2_log_red_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_other_w7wed_conc_matrix <- matrix(unlist(random_load_2_log_red_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

random_load_2_log_red_loading_concs <- as.data.frame(random_load_2_log_red_loading_w7wed_conc_list)
random_load_2_log_red_loading_concs$area <- as.factor('loading')
random_load_2_log_red_loading_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_2_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_cleaning_concs <- as.data.frame(random_load_2_log_red_cleaning_w7wed_conc_list)
random_load_2_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_2_log_red_cleaning_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_2_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_sorting_concs <- as.data.frame(random_load_2_log_red_sorting_w7wed_conc_list)
random_load_2_log_red_sorting_concs$area <- as.factor('sorting')
random_load_2_log_red_sorting_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_2_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_reject_concs <- as.data.frame(random_load_2_log_red_reject_w7wed_conc_list)
random_load_2_log_red_reject_concs$area <- as.factor('reject')
random_load_2_log_red_reject_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_2_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_tray_packing_concs <- as.data.frame(random_load_2_log_red_tray_packing_w7wed_conc_list)
random_load_2_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_2_log_red_tray_packing_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_2_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_other_concs <- as.data.frame(random_load_2_log_red_other_w7wed_conc_list)
random_load_2_log_red_other_concs$area <- as.factor('other')
random_load_2_log_red_other_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_other_concs$water <- as.factor('Dry')
names(random_load_2_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_w7wed_concs <- rbind(random_load_2_log_red_loading_concs,random_load_2_log_red_cleaning_concs,random_load_2_log_red_sorting_concs,random_load_2_log_red_tray_packing_concs,random_load_2_log_red_reject_concs,random_load_2_log_red_other_concs)

random_load_2_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$loading_w7wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_loading_prev$area <- as.factor('loading')
random_load_2_log_red_loading_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_2_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$cleaning_w7wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_2_log_red_cleaning_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_2_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$sorting_w7wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_sorting_prev$area <- as.factor('sorting')
random_load_2_log_red_sorting_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_2_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$reject_w7wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_reject_prev$area <- as.factor('reject')
random_load_2_log_red_reject_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_2_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$tray_packing_w7wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_2_log_red_tray_packing_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_2_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_other_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$other_w7wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_other_prev$area <- as.factor('other')
random_load_2_log_red_other_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_other_prev$water <- as.factor('Dry')
names(random_load_2_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_w7wed_prev <- rbind(random_load_2_log_red_loading_prev,random_load_2_log_red_cleaning_prev,random_load_2_log_red_sorting_prev,random_load_2_log_red_tray_packing_prev,random_load_2_log_red_reject_prev,random_load_2_log_red_other_prev)

random_load_2_log_red_w7wed_wet_prev <- as.data.frame(random_load_2_log_red_loading_prev$prevalence*21/100+random_load_2_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_2_log_red_w7wed_wet_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_w7wed_wet_prev$water <- as.factor('Wet')
names(random_load_2_log_red_w7wed_wet_prev) <- c('prevalence','scenario','water')

random_load_2_log_red_w7wed_dry_prev <- as.data.frame(random_load_2_log_red_sorting_prev$prevalence*20/100+random_load_2_log_red_reject_prev$prevalence*23/100+random_load_2_log_red_tray_packing_prev$prevalence*123/100+random_load_2_log_red_other_prev$prevalence*10/100)/176*100
random_load_2_log_red_w7wed_dry_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_w7wed_dry_prev$water <- as.factor('Dry')
names(random_load_2_log_red_w7wed_dry_prev) <- c('prevalence','scenario','water')

random_load_2_log_red_w7wed_recombined_prev <- rbind(random_load_2_log_red_w7wed_wet_prev, random_load_2_log_red_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Random_Load_2_Log_Red$loading_w8wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_loading_w8wed_conc_list <- append(random_load_2_log_red_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_loading_w8wed_conc_matrix <- matrix(unlist(random_load_2_log_red_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_cleaning_w8wed_conc_list <- append(random_load_2_log_red_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_cleaning_w8wed_conc_matrix <- matrix(unlist(random_load_2_log_red_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_2_Log_Red$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# random_load_2_log_red_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_2_log_red_drying_w8wed_conc_list <- append(random_load_2_log_red_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_2_Log_Red$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_sorting_w8wed_conc_list <- append(random_load_2_log_red_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_sorting_w8wed_conc_matrix <- matrix(unlist(random_load_2_log_red_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_tray_packing_w8wed_conc_list <- append(random_load_2_log_red_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_tray_packing_w8wed_conc_matrix <- matrix(unlist(random_load_2_log_red_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$reject_w8wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_reject_w8wed_conc_list <- append(random_load_2_log_red_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_reject_w8wed_conc_matrix <- matrix(unlist(random_load_2_log_red_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_2_Log_Red$other_w8wed_conc_list
vector <- vector[vector!='[]']
random_load_2_log_red_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_2_log_red_other_w8wed_conc_list <- append(random_load_2_log_red_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_2_log_red_other_w8wed_conc_matrix <- matrix(unlist(random_load_2_log_red_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

random_load_2_log_red_loading_concs <- as.data.frame(random_load_2_log_red_loading_w8wed_conc_list)
random_load_2_log_red_loading_concs$area <- as.factor('loading')
random_load_2_log_red_loading_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_2_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_cleaning_concs <- as.data.frame(random_load_2_log_red_cleaning_w8wed_conc_list)
random_load_2_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_2_log_red_cleaning_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_2_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_sorting_concs <- as.data.frame(random_load_2_log_red_sorting_w8wed_conc_list)
random_load_2_log_red_sorting_concs$area <- as.factor('sorting')
random_load_2_log_red_sorting_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_2_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_reject_concs <- as.data.frame(random_load_2_log_red_reject_w8wed_conc_list)
random_load_2_log_red_reject_concs$area <- as.factor('reject')
random_load_2_log_red_reject_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_2_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_tray_packing_concs <- as.data.frame(random_load_2_log_red_tray_packing_w8wed_conc_list)
random_load_2_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_2_log_red_tray_packing_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_2_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_other_concs <- as.data.frame(random_load_2_log_red_other_w8wed_conc_list)
random_load_2_log_red_other_concs$area <- as.factor('other')
random_load_2_log_red_other_concs$scenario <- as.factor('LR_02')
random_load_2_log_red_other_concs$water <- as.factor('Dry')
names(random_load_2_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_2_log_red_w8wed_concs <- rbind(random_load_2_log_red_loading_concs,random_load_2_log_red_cleaning_concs,random_load_2_log_red_sorting_concs,random_load_2_log_red_tray_packing_concs,random_load_2_log_red_reject_concs,random_load_2_log_red_other_concs)

random_load_2_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$loading_w8wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_loading_prev$area <- as.factor('loading')
random_load_2_log_red_loading_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_2_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$cleaning_w8wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_2_log_red_cleaning_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_2_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$sorting_w8wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_sorting_prev$area <- as.factor('sorting')
random_load_2_log_red_sorting_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_2_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$reject_w8wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_reject_prev$area <- as.factor('reject')
random_load_2_log_red_reject_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_2_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$tray_packing_w8wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_2_log_red_tray_packing_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_2_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_other_prev <- as.data.frame(NL_table_Random_Load_2_Log_Red$other_w8wed_prev[order(NL_table_Random_Load_2_Log_Red$local_seed)])
random_load_2_log_red_other_prev$area <- as.factor('other')
random_load_2_log_red_other_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_other_prev$water <- as.factor('Dry')
names(random_load_2_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_2_log_red_w8wed_prev <- rbind(random_load_2_log_red_loading_prev,random_load_2_log_red_cleaning_prev,random_load_2_log_red_sorting_prev,random_load_2_log_red_tray_packing_prev,random_load_2_log_red_reject_prev,random_load_2_log_red_other_prev)

random_load_2_log_red_w8wed_wet_prev <- as.data.frame(random_load_2_log_red_loading_prev$prevalence*21/100+random_load_2_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_2_log_red_w8wed_wet_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_w8wed_wet_prev$water <- as.factor('Wet')
names(random_load_2_log_red_w8wed_wet_prev) <- c('prevalence','scenario','water')

random_load_2_log_red_w8wed_dry_prev <- as.data.frame(random_load_2_log_red_sorting_prev$prevalence*20/100+random_load_2_log_red_reject_prev$prevalence*23/100+random_load_2_log_red_tray_packing_prev$prevalence*123/100+random_load_2_log_red_other_prev$prevalence*10/100)/176*100
random_load_2_log_red_w8wed_dry_prev$scenario <- as.factor('LR_02')
random_load_2_log_red_w8wed_dry_prev$water <- as.factor('Dry')
names(random_load_2_log_red_w8wed_dry_prev) <- c('prevalence','scenario','water')

random_load_2_log_red_w8wed_recombined_prev <- rbind(random_load_2_log_red_w8wed_wet_prev, random_load_2_log_red_w8wed_dry_prev)

vector <- NL_table_Random_Load_2_Log_Red$lifetime_conc_list[order(NL_table_Random_Load_2_Log_Red$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

random_load_2_log_red_w1wed_recombined_prev$week <- as.factor(1)
random_load_2_log_red_w2wed_recombined_prev$week <- as.factor(2)
random_load_2_log_red_w3wed_recombined_prev$week <- as.factor(3)
random_load_2_log_red_w4wed_recombined_prev$week <- as.factor(4)
random_load_2_log_red_w5wed_recombined_prev$week <- as.factor(5)
random_load_2_log_red_w6wed_recombined_prev$week <- as.factor(6)
random_load_2_log_red_w7wed_recombined_prev$week <- as.factor(7)
random_load_2_log_red_w8wed_recombined_prev$week <- as.factor(8)
random_load_2_log_red_allwed_prev <- rbind(random_load_2_log_red_w1wed_recombined_prev,random_load_2_log_red_w2wed_recombined_prev,random_load_2_log_red_w3wed_recombined_prev,random_load_2_log_red_w4wed_recombined_prev,random_load_2_log_red_w5wed_recombined_prev,random_load_2_log_red_w6wed_recombined_prev,random_load_2_log_red_w7wed_recombined_prev,random_load_2_log_red_w8wed_recombined_prev)

Facility_B_random_load_2_log_red_agents_melted <- melt(mdarray)
colnames(Facility_B_random_load_2_log_red_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_random_load_2_log_red_agents_melted$agent <- Facility_B_random_load_2_log_red_agents_melted$agent-1
Facility_B_random_load_2_log_red_agents_melted$logical <- Facility_B_random_load_2_log_red_agents_melted$value>0
Facility_B_random_load_2_log_red_agents_melted$binary <- as.numeric(Facility_B_random_load_2_log_red_agents_melted$logical)
Facility_B_random_load_2_log_red_agents_melted$log10value <- log10(Facility_B_random_load_2_log_red_agents_melted$value)
Facility_B_random_load_2_log_red_agents_melted$log10value[is.infinite(Facility_B_random_load_2_log_red_agents_melted$log10value)] <- 0

agent <- Facility_B_random_load_2_log_red_agents_melted$agent
iteration <- Facility_B_random_load_2_log_red_agents_melted$iteration
tick <- Facility_B_random_load_2_log_red_agents_melted$tick
rle_matrix <- tapply(Facility_B_random_load_2_log_red_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_load_2_log_red_mean_value_matrix <- tapply(Facility_B_random_load_2_log_red_agents_melted$value, list(agent, tick), mean)
Facility_B_load_2_log_red_median_value_matrix <- tapply(Facility_B_random_load_2_log_red_agents_melted$value, list(agent, tick), median)
Facility_B_load_2_log_red_prob_value_matrix <- tapply(Facility_B_random_load_2_log_red_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}
# durations$agent <- durations$agent-1

Facility_B_durations_random_load_2_log_red <- durations

agents_list_random_load_2_log_red <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_random_load_2_log_red <- agents_list_random_load_2_log_red[,c("V1","V7","V8","V9")]
colnames(agents_list_random_load_2_log_red) <- c("name","sanitation_status","schedule","area")
agents_list_random_load_2_log_red$ttp <- rep((168*2),225)
agents_list_random_load_2_log_red$ttp[agents_list_random_load_2_log_red$schedule=="daily"] <- (24*2)

agent <- 1
while(agent<=225) {
  agents_list_random_load_2_log_red$min_duration[agent] <- ifelse(length(Facility_B_durations_random_load_2_log_red$duration[Facility_B_durations_random_load_2_log_red$agent==agent])==0,NA,min(Facility_B_durations_random_load_2_log_red$duration[Facility_B_durations_random_load_2_log_red$agent==agent], na.rm = TRUE))
  agents_list_random_load_2_log_red$mean_duration[agent] <- ifelse(length(Facility_B_durations_random_load_2_log_red$duration[Facility_B_durations_random_load_2_log_red$agent==agent])==0,NA,mean(Facility_B_durations_random_load_2_log_red$duration[Facility_B_durations_random_load_2_log_red$agent==agent], na.rm = TRUE))
  agents_list_random_load_2_log_red$median_duration[agent] <- ifelse(length(Facility_B_durations_random_load_2_log_red$duration[Facility_B_durations_random_load_2_log_red$agent==agent])==0,NA,median(Facility_B_durations_random_load_2_log_red$duration[Facility_B_durations_random_load_2_log_red$agent==agent], na.rm = TRUE))
  agents_list_random_load_2_log_red$max_duration[agent] <- ifelse(length(Facility_B_durations_random_load_2_log_red$duration[Facility_B_durations_random_load_2_log_red$agent==agent])==0,NA,max(Facility_B_durations_random_load_2_log_red$duration[Facility_B_durations_random_load_2_log_red$agent==agent], na.rm = TRUE))
  agents_list_random_load_2_log_red$times_persistent[agent] <- sum(Facility_B_durations_random_load_2_log_red$duration[Facility_B_durations_random_load_2_log_red$agent==agent]>agents_list_random_load_2_log_red$ttp[agent])
  agent <- agent+1 
}

Facility_B_random_load_2_log_red_agents_melted_monday_preop <- Facility_B_random_load_2_log_red_agents_melted[which(Facility_B_random_load_2_log_red_agents_melted$tick==33|Facility_B_random_load_2_log_red_agents_melted$tick==201|Facility_B_random_load_2_log_red_agents_melted$tick==369|Facility_B_random_load_2_log_red_agents_melted$tick==537|Facility_B_random_load_2_log_red_agents_melted$tick==705|Facility_B_random_load_2_log_red_agents_melted$tick==873|Facility_B_random_load_2_log_red_agents_melted$tick==1041|Facility_B_random_load_2_log_red_agents_melted$tick==1209),]

Facility_B_random_load_2_log_red_agents_melted_tuesday_preop <- Facility_B_random_load_2_log_red_agents_melted[which(Facility_B_random_load_2_log_red_agents_melted$tick==57|Facility_B_random_load_2_log_red_agents_melted$tick==225|Facility_B_random_load_2_log_red_agents_melted$tick==393|Facility_B_random_load_2_log_red_agents_melted$tick==561|Facility_B_random_load_2_log_red_agents_melted$tick==729|Facility_B_random_load_2_log_red_agents_melted$tick==897|Facility_B_random_load_2_log_red_agents_melted$tick==1065|Facility_B_random_load_2_log_red_agents_melted$tick==1233),]

Facility_B_random_load_2_log_red_agents_melted_wednesday_preop <- Facility_B_random_load_2_log_red_agents_melted[which(Facility_B_random_load_2_log_red_agents_melted$tick==81|Facility_B_random_load_2_log_red_agents_melted$tick==249|Facility_B_random_load_2_log_red_agents_melted$tick==417|Facility_B_random_load_2_log_red_agents_melted$tick==585|Facility_B_random_load_2_log_red_agents_melted$tick==753|Facility_B_random_load_2_log_red_agents_melted$tick==921|Facility_B_random_load_2_log_red_agents_melted$tick==1089|Facility_B_random_load_2_log_red_agents_melted$tick==1257),]

Facility_B_random_load_2_log_red_agents_melted_thursday_preop <- Facility_B_random_load_2_log_red_agents_melted[which(Facility_B_random_load_2_log_red_agents_melted$tick==105|Facility_B_random_load_2_log_red_agents_melted$tick==273|Facility_B_random_load_2_log_red_agents_melted$tick==441|Facility_B_random_load_2_log_red_agents_melted$tick==609|Facility_B_random_load_2_log_red_agents_melted$tick==777|Facility_B_random_load_2_log_red_agents_melted$tick==945|Facility_B_random_load_2_log_red_agents_melted$tick==1113|Facility_B_random_load_2_log_red_agents_melted$tick==1281),]

Facility_B_random_load_2_log_red_agents_melted_friday_preop <- Facility_B_random_load_2_log_red_agents_melted[which(Facility_B_random_load_2_log_red_agents_melted$tick==129|Facility_B_random_load_2_log_red_agents_melted$tick==297|Facility_B_random_load_2_log_red_agents_melted$tick==465|Facility_B_random_load_2_log_red_agents_melted$tick==633|Facility_B_random_load_2_log_red_agents_melted$tick==801|Facility_B_random_load_2_log_red_agents_melted$tick==969|Facility_B_random_load_2_log_red_agents_melted$tick==1137|Facility_B_random_load_2_log_red_agents_melted$tick==1305),]

Facility_B_random_load_2_log_red_agents_melted_ff <- as.ffdf(Facility_B_random_load_2_log_red_agents_melted)
rm(Facility_B_random_load_2_log_red_agents_melted)
gc()
```

```{r import Random Load 3 Log Reduction}
NL_table_Random_Load_3_Log_Red <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-28-03-36 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_Random_Load_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Random_Load_3_Log_Red <- NL_table_Random_Load_3_Log_Red[NL_table_Random_Load_3_Log_Red$scenario==14,]

while (any(grepl('-', names(NL_table_Random_Load_3_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_3_Log_Red <- NL_table_Random_Load_3_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Random_Load_3_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_3_Log_Red <- NL_table_Random_Load_3_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Random_Load_3_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_3_Log_Red <- NL_table_Random_Load_3_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Random_Load_3_Log_Red), fixed = TRUE))) {
  NL_table_Random_Load_3_Log_Red <- NL_table_Random_Load_3_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Random_Load_3_Log_Red[ , ..list_columns]

NL_table_Random_Load_3_Log_Red[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Random_Load_3_Log_Red <- as.data.frame(NL_table_Random_Load_3_Log_Red)

NL_table_Random_Load_3_Log_Red[NL_table_Random_Load_3_Log_Red==-1] <- NA

NL_table_Random_Load_3_Log_Red <- subset(NL_table_Random_Load_3_Log_Red, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Random_Load_3_Log_Red)[names(NL_table_Random_Load_3_Log_Red)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Random_Load_3_Log_Red)[names(NL_table_Random_Load_3_Log_Red)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Random_Load_3_Log_Red$loading_w1wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_loading_w1wed_conc_list <- append(random_load_3_log_red_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_loading_w1wed_conc_matrix <- matrix(unlist(random_load_3_log_red_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_cleaning_w1wed_conc_list <- append(random_load_3_log_red_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_cleaning_w1wed_conc_matrix <- matrix(unlist(random_load_3_log_red_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_3_Log_Red$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# random_load_3_log_red_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_3_log_red_drying_w1wed_conc_list <- append(random_load_3_log_red_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_3_Log_Red$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_sorting_w1wed_conc_list <- append(random_load_3_log_red_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_sorting_w1wed_conc_matrix <- matrix(unlist(random_load_3_log_red_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_tray_packing_w1wed_conc_list <- append(random_load_3_log_red_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_tray_packing_w1wed_conc_matrix <- matrix(unlist(random_load_3_log_red_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$reject_w1wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_reject_w1wed_conc_list <- append(random_load_3_log_red_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_reject_w1wed_conc_matrix <- matrix(unlist(random_load_3_log_red_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$other_w1wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_other_w1wed_conc_list <- append(random_load_3_log_red_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_other_w1wed_conc_matrix <- matrix(unlist(random_load_3_log_red_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

random_load_3_log_red_loading_concs <- as.data.frame(random_load_3_log_red_loading_w1wed_conc_list)
random_load_3_log_red_loading_concs$area <- as.factor('loading')
random_load_3_log_red_loading_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_3_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_cleaning_concs <- as.data.frame(random_load_3_log_red_cleaning_w1wed_conc_list)
random_load_3_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_3_log_red_cleaning_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_3_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_sorting_concs <- as.data.frame(random_load_3_log_red_sorting_w1wed_conc_list)
random_load_3_log_red_sorting_concs$area <- as.factor('sorting')
random_load_3_log_red_sorting_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_3_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_reject_concs <- as.data.frame(random_load_3_log_red_reject_w1wed_conc_list)
random_load_3_log_red_reject_concs$area <- as.factor('reject')
random_load_3_log_red_reject_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_3_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_tray_packing_concs <- as.data.frame(random_load_3_log_red_tray_packing_w1wed_conc_list)
random_load_3_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_3_log_red_tray_packing_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_3_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_other_concs <- as.data.frame(random_load_3_log_red_other_w1wed_conc_list)
random_load_3_log_red_other_concs$area <- as.factor('other')
random_load_3_log_red_other_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_other_concs$water <- as.factor('Dry')
names(random_load_3_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_w1wed_concs <- rbind(random_load_3_log_red_loading_concs,random_load_3_log_red_cleaning_concs,random_load_3_log_red_sorting_concs,random_load_3_log_red_tray_packing_concs,random_load_3_log_red_reject_concs,random_load_3_log_red_other_concs)

random_load_3_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$loading_w1wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_loading_prev$area <- as.factor('loading')
random_load_3_log_red_loading_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_3_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$cleaning_w1wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_3_log_red_cleaning_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_3_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$sorting_w1wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_sorting_prev$area <- as.factor('sorting')
random_load_3_log_red_sorting_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_3_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$reject_w1wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_reject_prev$area <- as.factor('reject')
random_load_3_log_red_reject_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_3_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$tray_packing_w1wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_3_log_red_tray_packing_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_3_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_other_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$other_w1wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_other_prev$area <- as.factor('other')
random_load_3_log_red_other_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_other_prev$water <- as.factor('Dry')
names(random_load_3_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_w1wed_prev <- rbind(random_load_3_log_red_loading_prev,random_load_3_log_red_cleaning_prev,random_load_3_log_red_sorting_prev,random_load_3_log_red_tray_packing_prev,random_load_3_log_red_reject_prev,random_load_3_log_red_other_prev)

random_load_3_log_red_w1wed_wet_prev <- as.data.frame(random_load_3_log_red_loading_prev$prevalence*21/100+random_load_3_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_3_log_red_w1wed_wet_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_w1wed_wet_prev$water <- as.factor('Wet')
names(random_load_3_log_red_w1wed_wet_prev) <- c('prevalence','scenario','water')

random_load_3_log_red_w1wed_dry_prev <- as.data.frame(random_load_3_log_red_sorting_prev$prevalence*20/100+random_load_3_log_red_reject_prev$prevalence*23/100+random_load_3_log_red_tray_packing_prev$prevalence*123/100+random_load_3_log_red_other_prev$prevalence*10/100)/176*100
random_load_3_log_red_w1wed_dry_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_w1wed_dry_prev$water <- as.factor('Dry')
names(random_load_3_log_red_w1wed_dry_prev) <- c('prevalence','scenario','water')

random_load_3_log_red_w1wed_recombined_prev <- rbind(random_load_3_log_red_w1wed_wet_prev, random_load_3_log_red_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Random_Load_3_Log_Red$loading_w2wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_loading_w2wed_conc_list <- append(random_load_3_log_red_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_loading_w2wed_conc_matrix <- matrix(unlist(random_load_3_log_red_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_cleaning_w2wed_conc_list <- append(random_load_3_log_red_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_cleaning_w2wed_conc_matrix <- matrix(unlist(random_load_3_log_red_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_3_Log_Red$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# random_load_3_log_red_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_3_log_red_drying_w2wed_conc_list <- append(random_load_3_log_red_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_3_Log_Red$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_sorting_w2wed_conc_list <- append(random_load_3_log_red_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_sorting_w2wed_conc_matrix <- matrix(unlist(random_load_3_log_red_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_tray_packing_w2wed_conc_list <- append(random_load_3_log_red_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_tray_packing_w2wed_conc_matrix <- matrix(unlist(random_load_3_log_red_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$reject_w2wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_reject_w2wed_conc_list <- append(random_load_3_log_red_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_reject_w2wed_conc_matrix <- matrix(unlist(random_load_3_log_red_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$other_w2wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_other_w2wed_conc_list <- append(random_load_3_log_red_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_other_w2wed_conc_matrix <- matrix(unlist(random_load_3_log_red_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

random_load_3_log_red_loading_concs <- as.data.frame(random_load_3_log_red_loading_w2wed_conc_list)
random_load_3_log_red_loading_concs$area <- as.factor('loading')
random_load_3_log_red_loading_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_3_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_cleaning_concs <- as.data.frame(random_load_3_log_red_cleaning_w2wed_conc_list)
random_load_3_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_3_log_red_cleaning_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_3_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_sorting_concs <- as.data.frame(random_load_3_log_red_sorting_w2wed_conc_list)
random_load_3_log_red_sorting_concs$area <- as.factor('sorting')
random_load_3_log_red_sorting_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_3_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_reject_concs <- as.data.frame(random_load_3_log_red_reject_w2wed_conc_list)
random_load_3_log_red_reject_concs$area <- as.factor('reject')
random_load_3_log_red_reject_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_3_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_tray_packing_concs <- as.data.frame(random_load_3_log_red_tray_packing_w2wed_conc_list)
random_load_3_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_3_log_red_tray_packing_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_3_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_other_concs <- as.data.frame(random_load_3_log_red_other_w2wed_conc_list)
random_load_3_log_red_other_concs$area <- as.factor('other')
random_load_3_log_red_other_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_other_concs$water <- as.factor('Dry')
names(random_load_3_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_w2wed_concs <- rbind(random_load_3_log_red_loading_concs,random_load_3_log_red_cleaning_concs,random_load_3_log_red_sorting_concs,random_load_3_log_red_tray_packing_concs,random_load_3_log_red_reject_concs,random_load_3_log_red_other_concs)

random_load_3_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$loading_w2wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_loading_prev$area <- as.factor('loading')
random_load_3_log_red_loading_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_3_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$cleaning_w2wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_3_log_red_cleaning_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_3_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$sorting_w2wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_sorting_prev$area <- as.factor('sorting')
random_load_3_log_red_sorting_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_3_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$reject_w2wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_reject_prev$area <- as.factor('reject')
random_load_3_log_red_reject_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_3_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$tray_packing_w2wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_3_log_red_tray_packing_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_3_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_other_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$other_w2wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_other_prev$area <- as.factor('other')
random_load_3_log_red_other_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_other_prev$water <- as.factor('Dry')
names(random_load_3_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_w2wed_prev <- rbind(random_load_3_log_red_loading_prev,random_load_3_log_red_cleaning_prev,random_load_3_log_red_sorting_prev,random_load_3_log_red_tray_packing_prev,random_load_3_log_red_reject_prev,random_load_3_log_red_other_prev)

random_load_3_log_red_w2wed_wet_prev <- as.data.frame(random_load_3_log_red_loading_prev$prevalence*21/100+random_load_3_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_3_log_red_w2wed_wet_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_w2wed_wet_prev$water <- as.factor('Wet')
names(random_load_3_log_red_w2wed_wet_prev) <- c('prevalence','scenario','water')

random_load_3_log_red_w2wed_dry_prev <- as.data.frame(random_load_3_log_red_sorting_prev$prevalence*20/100+random_load_3_log_red_reject_prev$prevalence*23/100+random_load_3_log_red_tray_packing_prev$prevalence*123/100+random_load_3_log_red_other_prev$prevalence*10/100)/176*100
random_load_3_log_red_w2wed_dry_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_w2wed_dry_prev$water <- as.factor('Dry')
names(random_load_3_log_red_w2wed_dry_prev) <- c('prevalence','scenario','water')

random_load_3_log_red_w2wed_recombined_prev <- rbind(random_load_3_log_red_w2wed_wet_prev, random_load_3_log_red_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Random_Load_3_Log_Red$loading_w3wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_loading_w3wed_conc_list <- append(random_load_3_log_red_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_loading_w3wed_conc_matrix <- matrix(unlist(random_load_3_log_red_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_cleaning_w3wed_conc_list <- append(random_load_3_log_red_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_cleaning_w3wed_conc_matrix <- matrix(unlist(random_load_3_log_red_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_3_Log_Red$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# random_load_3_log_red_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_3_log_red_drying_w3wed_conc_list <- append(random_load_3_log_red_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_3_Log_Red$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_sorting_w3wed_conc_list <- append(random_load_3_log_red_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_sorting_w3wed_conc_matrix <- matrix(unlist(random_load_3_log_red_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_tray_packing_w3wed_conc_list <- append(random_load_3_log_red_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_tray_packing_w3wed_conc_matrix <- matrix(unlist(random_load_3_log_red_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$reject_w3wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_reject_w3wed_conc_list <- append(random_load_3_log_red_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_reject_w3wed_conc_matrix <- matrix(unlist(random_load_3_log_red_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$other_w3wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_other_w3wed_conc_list <- append(random_load_3_log_red_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_other_w3wed_conc_matrix <- matrix(unlist(random_load_3_log_red_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

random_load_3_log_red_loading_concs <- as.data.frame(random_load_3_log_red_loading_w3wed_conc_list)
random_load_3_log_red_loading_concs$area <- as.factor('loading')
random_load_3_log_red_loading_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_3_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_cleaning_concs <- as.data.frame(random_load_3_log_red_cleaning_w3wed_conc_list)
random_load_3_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_3_log_red_cleaning_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_3_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_sorting_concs <- as.data.frame(random_load_3_log_red_sorting_w3wed_conc_list)
random_load_3_log_red_sorting_concs$area <- as.factor('sorting')
random_load_3_log_red_sorting_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_3_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_reject_concs <- as.data.frame(random_load_3_log_red_reject_w3wed_conc_list)
random_load_3_log_red_reject_concs$area <- as.factor('reject')
random_load_3_log_red_reject_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_3_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_tray_packing_concs <- as.data.frame(random_load_3_log_red_tray_packing_w3wed_conc_list)
random_load_3_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_3_log_red_tray_packing_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_3_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_other_concs <- as.data.frame(random_load_3_log_red_other_w3wed_conc_list)
random_load_3_log_red_other_concs$area <- as.factor('other')
random_load_3_log_red_other_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_other_concs$water <- as.factor('Dry')
names(random_load_3_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_w3wed_concs <- rbind(random_load_3_log_red_loading_concs,random_load_3_log_red_cleaning_concs,random_load_3_log_red_sorting_concs,random_load_3_log_red_tray_packing_concs,random_load_3_log_red_reject_concs,random_load_3_log_red_other_concs)

random_load_3_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$loading_w3wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_loading_prev$area <- as.factor('loading')
random_load_3_log_red_loading_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_3_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$cleaning_w3wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_3_log_red_cleaning_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_3_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$sorting_w3wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_sorting_prev$area <- as.factor('sorting')
random_load_3_log_red_sorting_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_3_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$reject_w3wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_reject_prev$area <- as.factor('reject')
random_load_3_log_red_reject_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_3_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$tray_packing_w3wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_3_log_red_tray_packing_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_3_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_other_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$other_w3wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_other_prev$area <- as.factor('other')
random_load_3_log_red_other_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_other_prev$water <- as.factor('Dry')
names(random_load_3_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_w3wed_prev <- rbind(random_load_3_log_red_loading_prev,random_load_3_log_red_cleaning_prev,random_load_3_log_red_sorting_prev,random_load_3_log_red_tray_packing_prev,random_load_3_log_red_reject_prev,random_load_3_log_red_other_prev)

random_load_3_log_red_w3wed_wet_prev <- as.data.frame(random_load_3_log_red_loading_prev$prevalence*21/100+random_load_3_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_3_log_red_w3wed_wet_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_w3wed_wet_prev$water <- as.factor('Wet')
names(random_load_3_log_red_w3wed_wet_prev) <- c('prevalence','scenario','water')

random_load_3_log_red_w3wed_dry_prev <- as.data.frame(random_load_3_log_red_sorting_prev$prevalence*20/100+random_load_3_log_red_reject_prev$prevalence*23/100+random_load_3_log_red_tray_packing_prev$prevalence*123/100+random_load_3_log_red_other_prev$prevalence*10/100)/176*100
random_load_3_log_red_w3wed_dry_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_w3wed_dry_prev$water <- as.factor('Dry')
names(random_load_3_log_red_w3wed_dry_prev) <- c('prevalence','scenario','water')

random_load_3_log_red_w3wed_recombined_prev <- rbind(random_load_3_log_red_w3wed_wet_prev, random_load_3_log_red_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Random_Load_3_Log_Red$loading_w4wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_loading_w4wed_conc_list <- append(random_load_3_log_red_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_loading_w4wed_conc_matrix <- matrix(unlist(random_load_3_log_red_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_cleaning_w4wed_conc_list <- append(random_load_3_log_red_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_cleaning_w4wed_conc_matrix <- matrix(unlist(random_load_3_log_red_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_3_Log_Red$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# random_load_3_log_red_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_3_log_red_drying_w4wed_conc_list <- append(random_load_3_log_red_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_3_Log_Red$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_sorting_w4wed_conc_list <- append(random_load_3_log_red_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_sorting_w4wed_conc_matrix <- matrix(unlist(random_load_3_log_red_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_tray_packing_w4wed_conc_list <- append(random_load_3_log_red_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_tray_packing_w4wed_conc_matrix <- matrix(unlist(random_load_3_log_red_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$reject_w4wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_reject_w4wed_conc_list <- append(random_load_3_log_red_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_reject_w4wed_conc_matrix <- matrix(unlist(random_load_3_log_red_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$other_w4wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_other_w4wed_conc_list <- append(random_load_3_log_red_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_other_w4wed_conc_matrix <- matrix(unlist(random_load_3_log_red_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

random_load_3_log_red_loading_concs <- as.data.frame(random_load_3_log_red_loading_w4wed_conc_list)
random_load_3_log_red_loading_concs$area <- as.factor('loading')
random_load_3_log_red_loading_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_3_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_cleaning_concs <- as.data.frame(random_load_3_log_red_cleaning_w4wed_conc_list)
random_load_3_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_3_log_red_cleaning_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_3_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_sorting_concs <- as.data.frame(random_load_3_log_red_sorting_w4wed_conc_list)
random_load_3_log_red_sorting_concs$area <- as.factor('sorting')
random_load_3_log_red_sorting_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_3_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_reject_concs <- as.data.frame(random_load_3_log_red_reject_w4wed_conc_list)
random_load_3_log_red_reject_concs$area <- as.factor('reject')
random_load_3_log_red_reject_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_3_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_tray_packing_concs <- as.data.frame(random_load_3_log_red_tray_packing_w4wed_conc_list)
random_load_3_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_3_log_red_tray_packing_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_3_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_other_concs <- as.data.frame(random_load_3_log_red_other_w4wed_conc_list)
random_load_3_log_red_other_concs$area <- as.factor('other')
random_load_3_log_red_other_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_other_concs$water <- as.factor('Dry')
names(random_load_3_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_w4wed_concs <- rbind(random_load_3_log_red_loading_concs,random_load_3_log_red_cleaning_concs,random_load_3_log_red_sorting_concs,random_load_3_log_red_tray_packing_concs,random_load_3_log_red_reject_concs,random_load_3_log_red_other_concs)

random_load_3_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$loading_w4wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_loading_prev$area <- as.factor('loading')
random_load_3_log_red_loading_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_3_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$cleaning_w4wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_3_log_red_cleaning_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_3_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$sorting_w4wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_sorting_prev$area <- as.factor('sorting')
random_load_3_log_red_sorting_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_3_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$reject_w4wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_reject_prev$area <- as.factor('reject')
random_load_3_log_red_reject_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_3_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$tray_packing_w4wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_3_log_red_tray_packing_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_3_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_other_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$other_w4wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_other_prev$area <- as.factor('other')
random_load_3_log_red_other_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_other_prev$water <- as.factor('Dry')
names(random_load_3_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_w4wed_prev <- rbind(random_load_3_log_red_loading_prev,random_load_3_log_red_cleaning_prev,random_load_3_log_red_sorting_prev,random_load_3_log_red_tray_packing_prev,random_load_3_log_red_reject_prev,random_load_3_log_red_other_prev)

random_load_3_log_red_w4wed_wet_prev <- as.data.frame(random_load_3_log_red_loading_prev$prevalence*21/100+random_load_3_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_3_log_red_w4wed_wet_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_w4wed_wet_prev$water <- as.factor('Wet')
names(random_load_3_log_red_w4wed_wet_prev) <- c('prevalence','scenario','water')

random_load_3_log_red_w4wed_dry_prev <- as.data.frame(random_load_3_log_red_sorting_prev$prevalence*20/100+random_load_3_log_red_reject_prev$prevalence*23/100+random_load_3_log_red_tray_packing_prev$prevalence*123/100+random_load_3_log_red_other_prev$prevalence*10/100)/176*100
random_load_3_log_red_w4wed_dry_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_w4wed_dry_prev$water <- as.factor('Dry')
names(random_load_3_log_red_w4wed_dry_prev) <- c('prevalence','scenario','water')

random_load_3_log_red_w4wed_recombined_prev <- rbind(random_load_3_log_red_w4wed_wet_prev, random_load_3_log_red_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Random_Load_3_Log_Red$loading_w5wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_loading_w5wed_conc_list <- append(random_load_3_log_red_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_loading_w5wed_conc_matrix <- matrix(unlist(random_load_3_log_red_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_cleaning_w5wed_conc_list <- append(random_load_3_log_red_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_cleaning_w5wed_conc_matrix <- matrix(unlist(random_load_3_log_red_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_3_Log_Red$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# random_load_3_log_red_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_3_log_red_drying_w5wed_conc_list <- append(random_load_3_log_red_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_3_Log_Red$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_sorting_w5wed_conc_list <- append(random_load_3_log_red_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_sorting_w5wed_conc_matrix <- matrix(unlist(random_load_3_log_red_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_tray_packing_w5wed_conc_list <- append(random_load_3_log_red_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_tray_packing_w5wed_conc_matrix <- matrix(unlist(random_load_3_log_red_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$reject_w5wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_reject_w5wed_conc_list <- append(random_load_3_log_red_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_reject_w5wed_conc_matrix <- matrix(unlist(random_load_3_log_red_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$other_w5wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_other_w5wed_conc_list <- append(random_load_3_log_red_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_other_w5wed_conc_matrix <- matrix(unlist(random_load_3_log_red_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

random_load_3_log_red_loading_concs <- as.data.frame(random_load_3_log_red_loading_w5wed_conc_list)
random_load_3_log_red_loading_concs$area <- as.factor('loading')
random_load_3_log_red_loading_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_3_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_cleaning_concs <- as.data.frame(random_load_3_log_red_cleaning_w5wed_conc_list)
random_load_3_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_3_log_red_cleaning_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_3_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_sorting_concs <- as.data.frame(random_load_3_log_red_sorting_w5wed_conc_list)
random_load_3_log_red_sorting_concs$area <- as.factor('sorting')
random_load_3_log_red_sorting_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_3_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_reject_concs <- as.data.frame(random_load_3_log_red_reject_w5wed_conc_list)
random_load_3_log_red_reject_concs$area <- as.factor('reject')
random_load_3_log_red_reject_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_3_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_tray_packing_concs <- as.data.frame(random_load_3_log_red_tray_packing_w5wed_conc_list)
random_load_3_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_3_log_red_tray_packing_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_3_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_other_concs <- as.data.frame(random_load_3_log_red_other_w5wed_conc_list)
random_load_3_log_red_other_concs$area <- as.factor('other')
random_load_3_log_red_other_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_other_concs$water <- as.factor('Dry')
names(random_load_3_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_w5wed_concs <- rbind(random_load_3_log_red_loading_concs,random_load_3_log_red_cleaning_concs,random_load_3_log_red_sorting_concs,random_load_3_log_red_tray_packing_concs,random_load_3_log_red_reject_concs,random_load_3_log_red_other_concs)

random_load_3_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$loading_w5wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_loading_prev$area <- as.factor('loading')
random_load_3_log_red_loading_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_3_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$cleaning_w5wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_3_log_red_cleaning_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_3_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$sorting_w5wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_sorting_prev$area <- as.factor('sorting')
random_load_3_log_red_sorting_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_3_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$reject_w5wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_reject_prev$area <- as.factor('reject')
random_load_3_log_red_reject_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_3_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$tray_packing_w5wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_3_log_red_tray_packing_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_3_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_other_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$other_w5wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_other_prev$area <- as.factor('other')
random_load_3_log_red_other_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_other_prev$water <- as.factor('Dry')
names(random_load_3_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_w5wed_prev <- rbind(random_load_3_log_red_loading_prev,random_load_3_log_red_cleaning_prev,random_load_3_log_red_sorting_prev,random_load_3_log_red_tray_packing_prev,random_load_3_log_red_reject_prev,random_load_3_log_red_other_prev)

random_load_3_log_red_w5wed_wet_prev <- as.data.frame(random_load_3_log_red_loading_prev$prevalence*21/100+random_load_3_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_3_log_red_w5wed_wet_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_w5wed_wet_prev$water <- as.factor('Wet')
names(random_load_3_log_red_w5wed_wet_prev) <- c('prevalence','scenario','water')

random_load_3_log_red_w5wed_dry_prev <- as.data.frame(random_load_3_log_red_sorting_prev$prevalence*20/100+random_load_3_log_red_reject_prev$prevalence*23/100+random_load_3_log_red_tray_packing_prev$prevalence*123/100+random_load_3_log_red_other_prev$prevalence*10/100)/176*100
random_load_3_log_red_w5wed_dry_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_w5wed_dry_prev$water <- as.factor('Dry')
names(random_load_3_log_red_w5wed_dry_prev) <- c('prevalence','scenario','water')

random_load_3_log_red_w5wed_recombined_prev <- rbind(random_load_3_log_red_w5wed_wet_prev, random_load_3_log_red_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Random_Load_3_Log_Red$loading_w6wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_loading_w6wed_conc_list <- append(random_load_3_log_red_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_loading_w6wed_conc_matrix <- matrix(unlist(random_load_3_log_red_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_cleaning_w6wed_conc_list <- append(random_load_3_log_red_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_cleaning_w6wed_conc_matrix <- matrix(unlist(random_load_3_log_red_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_3_Log_Red$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# random_load_3_log_red_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_3_log_red_drying_w6wed_conc_list <- append(random_load_3_log_red_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_3_Log_Red$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_sorting_w6wed_conc_list <- append(random_load_3_log_red_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_sorting_w6wed_conc_matrix <- matrix(unlist(random_load_3_log_red_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_tray_packing_w6wed_conc_list <- append(random_load_3_log_red_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_tray_packing_w6wed_conc_matrix <- matrix(unlist(random_load_3_log_red_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$reject_w6wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_reject_w6wed_conc_list <- append(random_load_3_log_red_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_reject_w6wed_conc_matrix <- matrix(unlist(random_load_3_log_red_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$other_w6wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_other_w6wed_conc_list <- append(random_load_3_log_red_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_other_w6wed_conc_matrix <- matrix(unlist(random_load_3_log_red_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

random_load_3_log_red_loading_concs <- as.data.frame(random_load_3_log_red_loading_w6wed_conc_list)
random_load_3_log_red_loading_concs$area <- as.factor('loading')
random_load_3_log_red_loading_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_3_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_cleaning_concs <- as.data.frame(random_load_3_log_red_cleaning_w6wed_conc_list)
random_load_3_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_3_log_red_cleaning_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_3_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_sorting_concs <- as.data.frame(random_load_3_log_red_sorting_w6wed_conc_list)
random_load_3_log_red_sorting_concs$area <- as.factor('sorting')
random_load_3_log_red_sorting_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_3_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_reject_concs <- as.data.frame(random_load_3_log_red_reject_w6wed_conc_list)
random_load_3_log_red_reject_concs$area <- as.factor('reject')
random_load_3_log_red_reject_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_3_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_tray_packing_concs <- as.data.frame(random_load_3_log_red_tray_packing_w6wed_conc_list)
random_load_3_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_3_log_red_tray_packing_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_3_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_other_concs <- as.data.frame(random_load_3_log_red_other_w6wed_conc_list)
random_load_3_log_red_other_concs$area <- as.factor('other')
random_load_3_log_red_other_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_other_concs$water <- as.factor('Dry')
names(random_load_3_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_w6wed_concs <- rbind(random_load_3_log_red_loading_concs,random_load_3_log_red_cleaning_concs,random_load_3_log_red_sorting_concs,random_load_3_log_red_tray_packing_concs,random_load_3_log_red_reject_concs,random_load_3_log_red_other_concs)

random_load_3_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$loading_w6wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_loading_prev$area <- as.factor('loading')
random_load_3_log_red_loading_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_3_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$cleaning_w6wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_3_log_red_cleaning_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_3_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$sorting_w6wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_sorting_prev$area <- as.factor('sorting')
random_load_3_log_red_sorting_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_3_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$reject_w6wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_reject_prev$area <- as.factor('reject')
random_load_3_log_red_reject_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_3_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$tray_packing_w6wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_3_log_red_tray_packing_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_3_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_other_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$other_w6wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_other_prev$area <- as.factor('other')
random_load_3_log_red_other_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_other_prev$water <- as.factor('Dry')
names(random_load_3_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_w6wed_prev <- rbind(random_load_3_log_red_loading_prev,random_load_3_log_red_cleaning_prev,random_load_3_log_red_sorting_prev,random_load_3_log_red_tray_packing_prev,random_load_3_log_red_reject_prev,random_load_3_log_red_other_prev)

random_load_3_log_red_w6wed_wet_prev <- as.data.frame(random_load_3_log_red_loading_prev$prevalence*21/100+random_load_3_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_3_log_red_w6wed_wet_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_w6wed_wet_prev$water <- as.factor('Wet')
names(random_load_3_log_red_w6wed_wet_prev) <- c('prevalence','scenario','water')

random_load_3_log_red_w6wed_dry_prev <- as.data.frame(random_load_3_log_red_sorting_prev$prevalence*20/100+random_load_3_log_red_reject_prev$prevalence*23/100+random_load_3_log_red_tray_packing_prev$prevalence*123/100+random_load_3_log_red_other_prev$prevalence*10/100)/176*100
random_load_3_log_red_w6wed_dry_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_w6wed_dry_prev$water <- as.factor('Dry')
names(random_load_3_log_red_w6wed_dry_prev) <- c('prevalence','scenario','water')

random_load_3_log_red_w6wed_recombined_prev <- rbind(random_load_3_log_red_w6wed_wet_prev, random_load_3_log_red_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Random_Load_3_Log_Red$loading_w7wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_loading_w7wed_conc_list <- append(random_load_3_log_red_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_loading_w7wed_conc_matrix <- matrix(unlist(random_load_3_log_red_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_cleaning_w7wed_conc_list <- append(random_load_3_log_red_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_cleaning_w7wed_conc_matrix <- matrix(unlist(random_load_3_log_red_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_3_Log_Red$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# random_load_3_log_red_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_3_log_red_drying_w7wed_conc_list <- append(random_load_3_log_red_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_3_Log_Red$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_sorting_w7wed_conc_list <- append(random_load_3_log_red_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_sorting_w7wed_conc_matrix <- matrix(unlist(random_load_3_log_red_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_tray_packing_w7wed_conc_list <- append(random_load_3_log_red_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_tray_packing_w7wed_conc_matrix <- matrix(unlist(random_load_3_log_red_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$reject_w7wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_reject_w7wed_conc_list <- append(random_load_3_log_red_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_reject_w7wed_conc_matrix <- matrix(unlist(random_load_3_log_red_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$other_w7wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_other_w7wed_conc_list <- append(random_load_3_log_red_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_other_w7wed_conc_matrix <- matrix(unlist(random_load_3_log_red_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

random_load_3_log_red_loading_concs <- as.data.frame(random_load_3_log_red_loading_w7wed_conc_list)
random_load_3_log_red_loading_concs$area <- as.factor('loading')
random_load_3_log_red_loading_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_3_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_cleaning_concs <- as.data.frame(random_load_3_log_red_cleaning_w7wed_conc_list)
random_load_3_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_3_log_red_cleaning_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_3_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_sorting_concs <- as.data.frame(random_load_3_log_red_sorting_w7wed_conc_list)
random_load_3_log_red_sorting_concs$area <- as.factor('sorting')
random_load_3_log_red_sorting_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_3_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_reject_concs <- as.data.frame(random_load_3_log_red_reject_w7wed_conc_list)
random_load_3_log_red_reject_concs$area <- as.factor('reject')
random_load_3_log_red_reject_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_3_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_tray_packing_concs <- as.data.frame(random_load_3_log_red_tray_packing_w7wed_conc_list)
random_load_3_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_3_log_red_tray_packing_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_3_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_other_concs <- as.data.frame(random_load_3_log_red_other_w7wed_conc_list)
random_load_3_log_red_other_concs$area <- as.factor('other')
random_load_3_log_red_other_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_other_concs$water <- as.factor('Dry')
names(random_load_3_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_w7wed_concs <- rbind(random_load_3_log_red_loading_concs,random_load_3_log_red_cleaning_concs,random_load_3_log_red_sorting_concs,random_load_3_log_red_tray_packing_concs,random_load_3_log_red_reject_concs,random_load_3_log_red_other_concs)

random_load_3_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$loading_w7wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_loading_prev$area <- as.factor('loading')
random_load_3_log_red_loading_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_3_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$cleaning_w7wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_3_log_red_cleaning_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_3_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$sorting_w7wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_sorting_prev$area <- as.factor('sorting')
random_load_3_log_red_sorting_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_3_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$reject_w7wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_reject_prev$area <- as.factor('reject')
random_load_3_log_red_reject_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_3_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$tray_packing_w7wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_3_log_red_tray_packing_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_3_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_other_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$other_w7wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_other_prev$area <- as.factor('other')
random_load_3_log_red_other_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_other_prev$water <- as.factor('Dry')
names(random_load_3_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_w7wed_prev <- rbind(random_load_3_log_red_loading_prev,random_load_3_log_red_cleaning_prev,random_load_3_log_red_sorting_prev,random_load_3_log_red_tray_packing_prev,random_load_3_log_red_reject_prev,random_load_3_log_red_other_prev)

random_load_3_log_red_w7wed_wet_prev <- as.data.frame(random_load_3_log_red_loading_prev$prevalence*21/100+random_load_3_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_3_log_red_w7wed_wet_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_w7wed_wet_prev$water <- as.factor('Wet')
names(random_load_3_log_red_w7wed_wet_prev) <- c('prevalence','scenario','water')

random_load_3_log_red_w7wed_dry_prev <- as.data.frame(random_load_3_log_red_sorting_prev$prevalence*20/100+random_load_3_log_red_reject_prev$prevalence*23/100+random_load_3_log_red_tray_packing_prev$prevalence*123/100+random_load_3_log_red_other_prev$prevalence*10/100)/176*100
random_load_3_log_red_w7wed_dry_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_w7wed_dry_prev$water <- as.factor('Dry')
names(random_load_3_log_red_w7wed_dry_prev) <- c('prevalence','scenario','water')

random_load_3_log_red_w7wed_recombined_prev <- rbind(random_load_3_log_red_w7wed_wet_prev, random_load_3_log_red_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Random_Load_3_Log_Red$loading_w8wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_loading_w8wed_conc_list <- append(random_load_3_log_red_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_loading_w8wed_conc_matrix <- matrix(unlist(random_load_3_log_red_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_cleaning_w8wed_conc_list <- append(random_load_3_log_red_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_cleaning_w8wed_conc_matrix <- matrix(unlist(random_load_3_log_red_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Load_3_Log_Red$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# random_load_3_log_red_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_load_3_log_red_drying_w8wed_conc_list <- append(random_load_3_log_red_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Load_3_Log_Red$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_sorting_w8wed_conc_list <- append(random_load_3_log_red_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_sorting_w8wed_conc_matrix <- matrix(unlist(random_load_3_log_red_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_tray_packing_w8wed_conc_list <- append(random_load_3_log_red_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_tray_packing_w8wed_conc_matrix <- matrix(unlist(random_load_3_log_red_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$reject_w8wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_reject_w8wed_conc_list <- append(random_load_3_log_red_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_reject_w8wed_conc_matrix <- matrix(unlist(random_load_3_log_red_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Load_3_Log_Red$other_w8wed_conc_list
vector <- vector[vector!='[]']
random_load_3_log_red_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_load_3_log_red_other_w8wed_conc_list <- append(random_load_3_log_red_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_load_3_log_red_other_w8wed_conc_matrix <- matrix(unlist(random_load_3_log_red_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

random_load_3_log_red_loading_concs <- as.data.frame(random_load_3_log_red_loading_w8wed_conc_list)
random_load_3_log_red_loading_concs$area <- as.factor('loading')
random_load_3_log_red_loading_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_loading_concs$water <- as.factor('Wet')
names(random_load_3_log_red_loading_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_cleaning_concs <- as.data.frame(random_load_3_log_red_cleaning_w8wed_conc_list)
random_load_3_log_red_cleaning_concs$area <- as.factor('cleaning')
random_load_3_log_red_cleaning_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_cleaning_concs$water <- as.factor('Wet')
names(random_load_3_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_sorting_concs <- as.data.frame(random_load_3_log_red_sorting_w8wed_conc_list)
random_load_3_log_red_sorting_concs$area <- as.factor('sorting')
random_load_3_log_red_sorting_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_sorting_concs$water <- as.factor('Dry')
names(random_load_3_log_red_sorting_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_reject_concs <- as.data.frame(random_load_3_log_red_reject_w8wed_conc_list)
random_load_3_log_red_reject_concs$area <- as.factor('reject')
random_load_3_log_red_reject_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_reject_concs$water <- as.factor('Dry')
names(random_load_3_log_red_reject_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_tray_packing_concs <- as.data.frame(random_load_3_log_red_tray_packing_w8wed_conc_list)
random_load_3_log_red_tray_packing_concs$area <- as.factor('tray packing')
random_load_3_log_red_tray_packing_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_tray_packing_concs$water <- as.factor('Dry')
names(random_load_3_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_other_concs <- as.data.frame(random_load_3_log_red_other_w8wed_conc_list)
random_load_3_log_red_other_concs$area <- as.factor('other')
random_load_3_log_red_other_concs$scenario <- as.factor('LR_03')
random_load_3_log_red_other_concs$water <- as.factor('Dry')
names(random_load_3_log_red_other_concs) <- c('concentration','area','scenario','water')

random_load_3_log_red_w8wed_concs <- rbind(random_load_3_log_red_loading_concs,random_load_3_log_red_cleaning_concs,random_load_3_log_red_sorting_concs,random_load_3_log_red_tray_packing_concs,random_load_3_log_red_reject_concs,random_load_3_log_red_other_concs)

random_load_3_log_red_loading_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$loading_w8wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_loading_prev$area <- as.factor('loading')
random_load_3_log_red_loading_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_loading_prev$water <- as.factor('Wet')
names(random_load_3_log_red_loading_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_cleaning_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$cleaning_w8wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_cleaning_prev$area <- as.factor('cleaning')
random_load_3_log_red_cleaning_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_cleaning_prev$water <- as.factor('Wet')
names(random_load_3_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_sorting_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$sorting_w8wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_sorting_prev$area <- as.factor('sorting')
random_load_3_log_red_sorting_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_sorting_prev$water <- as.factor('Dry')
names(random_load_3_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_reject_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$reject_w8wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_reject_prev$area <- as.factor('reject')
random_load_3_log_red_reject_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_reject_prev$water <- as.factor('Dry')
names(random_load_3_log_red_reject_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_tray_packing_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$tray_packing_w8wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_tray_packing_prev$area <- as.factor('tray packing')
random_load_3_log_red_tray_packing_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_tray_packing_prev$water <- as.factor('Dry')
names(random_load_3_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_other_prev <- as.data.frame(NL_table_Random_Load_3_Log_Red$other_w8wed_prev[order(NL_table_Random_Load_3_Log_Red$local_seed)])
random_load_3_log_red_other_prev$area <- as.factor('other')
random_load_3_log_red_other_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_other_prev$water <- as.factor('Dry')
names(random_load_3_log_red_other_prev) <- c('prevalence','area','scenario','water')

random_load_3_log_red_w8wed_prev <- rbind(random_load_3_log_red_loading_prev,random_load_3_log_red_cleaning_prev,random_load_3_log_red_sorting_prev,random_load_3_log_red_tray_packing_prev,random_load_3_log_red_reject_prev,random_load_3_log_red_other_prev)

random_load_3_log_red_w8wed_wet_prev <- as.data.frame(random_load_3_log_red_loading_prev$prevalence*21/100+random_load_3_log_red_cleaning_prev$prevalence*28/100)/49*100
random_load_3_log_red_w8wed_wet_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_w8wed_wet_prev$water <- as.factor('Wet')
names(random_load_3_log_red_w8wed_wet_prev) <- c('prevalence','scenario','water')

random_load_3_log_red_w8wed_dry_prev <- as.data.frame(random_load_3_log_red_sorting_prev$prevalence*20/100+random_load_3_log_red_reject_prev$prevalence*23/100+random_load_3_log_red_tray_packing_prev$prevalence*123/100+random_load_3_log_red_other_prev$prevalence*10/100)/176*100
random_load_3_log_red_w8wed_dry_prev$scenario <- as.factor('LR_03')
random_load_3_log_red_w8wed_dry_prev$water <- as.factor('Dry')
names(random_load_3_log_red_w8wed_dry_prev) <- c('prevalence','scenario','water')

random_load_3_log_red_w8wed_recombined_prev <- rbind(random_load_3_log_red_w8wed_wet_prev, random_load_3_log_red_w8wed_dry_prev)

vector <- NL_table_Random_Load_3_Log_Red$lifetime_conc_list[order(NL_table_Random_Load_3_Log_Red$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

random_load_3_log_red_w1wed_recombined_prev$week <- as.factor(1)
random_load_3_log_red_w2wed_recombined_prev$week <- as.factor(2)
random_load_3_log_red_w3wed_recombined_prev$week <- as.factor(3)
random_load_3_log_red_w4wed_recombined_prev$week <- as.factor(4)
random_load_3_log_red_w5wed_recombined_prev$week <- as.factor(5)
random_load_3_log_red_w6wed_recombined_prev$week <- as.factor(6)
random_load_3_log_red_w7wed_recombined_prev$week <- as.factor(7)
random_load_3_log_red_w8wed_recombined_prev$week <- as.factor(8)
random_load_3_log_red_allwed_prev <- rbind(random_load_3_log_red_w1wed_recombined_prev,random_load_3_log_red_w2wed_recombined_prev,random_load_3_log_red_w3wed_recombined_prev,random_load_3_log_red_w4wed_recombined_prev,random_load_3_log_red_w5wed_recombined_prev,random_load_3_log_red_w6wed_recombined_prev,random_load_3_log_red_w7wed_recombined_prev,random_load_3_log_red_w8wed_recombined_prev)

Facility_B_random_load_3_log_red_agents_melted <- melt(mdarray)
colnames(Facility_B_random_load_3_log_red_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_random_load_3_log_red_agents_melted$agent <- Facility_B_random_load_3_log_red_agents_melted$agent-1
Facility_B_random_load_3_log_red_agents_melted$logical <- Facility_B_random_load_3_log_red_agents_melted$value>0
Facility_B_random_load_3_log_red_agents_melted$binary <- as.numeric(Facility_B_random_load_3_log_red_agents_melted$logical)
Facility_B_random_load_3_log_red_agents_melted$log10value <- log10(Facility_B_random_load_3_log_red_agents_melted$value)
Facility_B_random_load_3_log_red_agents_melted$log10value[is.infinite(Facility_B_random_load_3_log_red_agents_melted$log10value)] <- 0

agent <- Facility_B_random_load_3_log_red_agents_melted$agent
iteration <- Facility_B_random_load_3_log_red_agents_melted$iteration
tick <- Facility_B_random_load_3_log_red_agents_melted$tick
rle_matrix <- tapply(Facility_B_random_load_3_log_red_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_load_3_log_red_mean_value_matrix <- tapply(Facility_B_random_load_3_log_red_agents_melted$value, list(agent, tick), mean)
Facility_B_load_3_log_red_median_value_matrix <- tapply(Facility_B_random_load_3_log_red_agents_melted$value, list(agent, tick), median)
Facility_B_load_3_log_red_prob_value_matrix <- tapply(Facility_B_random_load_3_log_red_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}
# durations$agent <- durations$agent-1

Facility_B_durations_random_load_3_log_red <- durations

agents_list_random_load_3_log_red <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_random_load_3_log_red <- agents_list_random_load_3_log_red[,c("V1","V7","V8","V9")]
colnames(agents_list_random_load_3_log_red) <- c("name","sanitation_status","schedule","area")
agents_list_random_load_3_log_red$ttp <- rep((168*2),225)
agents_list_random_load_3_log_red$ttp[agents_list_random_load_3_log_red$schedule=="daily"] <- (24*2)

agent <- 1
while(agent<=225) {
  agents_list_random_load_3_log_red$min_duration[agent] <- ifelse(length(Facility_B_durations_random_load_3_log_red$duration[Facility_B_durations_random_load_3_log_red$agent==agent])==0,NA,min(Facility_B_durations_random_load_3_log_red$duration[Facility_B_durations_random_load_3_log_red$agent==agent], na.rm = TRUE))
  agents_list_random_load_3_log_red$mean_duration[agent] <- ifelse(length(Facility_B_durations_random_load_3_log_red$duration[Facility_B_durations_random_load_3_log_red$agent==agent])==0,NA,mean(Facility_B_durations_random_load_3_log_red$duration[Facility_B_durations_random_load_3_log_red$agent==agent], na.rm = TRUE))
  agents_list_random_load_3_log_red$median_duration[agent] <- ifelse(length(Facility_B_durations_random_load_3_log_red$duration[Facility_B_durations_random_load_3_log_red$agent==agent])==0,NA,median(Facility_B_durations_random_load_3_log_red$duration[Facility_B_durations_random_load_3_log_red$agent==agent], na.rm = TRUE))
  agents_list_random_load_3_log_red$max_duration[agent] <- ifelse(length(Facility_B_durations_random_load_3_log_red$duration[Facility_B_durations_random_load_3_log_red$agent==agent])==0,NA,max(Facility_B_durations_random_load_3_log_red$duration[Facility_B_durations_random_load_3_log_red$agent==agent], na.rm = TRUE))
  agents_list_random_load_3_log_red$times_persistent[agent] <- sum(Facility_B_durations_random_load_3_log_red$duration[Facility_B_durations_random_load_3_log_red$agent==agent]>agents_list_random_load_3_log_red$ttp[agent])
  agent <- agent+1 
}

Facility_B_random_load_3_log_red_agents_melted_monday_preop <- Facility_B_random_load_3_log_red_agents_melted[which(Facility_B_random_load_3_log_red_agents_melted$tick==33|Facility_B_random_load_3_log_red_agents_melted$tick==201|Facility_B_random_load_3_log_red_agents_melted$tick==369|Facility_B_random_load_3_log_red_agents_melted$tick==537|Facility_B_random_load_3_log_red_agents_melted$tick==705|Facility_B_random_load_3_log_red_agents_melted$tick==873|Facility_B_random_load_3_log_red_agents_melted$tick==1041|Facility_B_random_load_3_log_red_agents_melted$tick==1209),]

Facility_B_random_load_3_log_red_agents_melted_tuesday_preop <- Facility_B_random_load_3_log_red_agents_melted[which(Facility_B_random_load_3_log_red_agents_melted$tick==57|Facility_B_random_load_3_log_red_agents_melted$tick==225|Facility_B_random_load_3_log_red_agents_melted$tick==393|Facility_B_random_load_3_log_red_agents_melted$tick==561|Facility_B_random_load_3_log_red_agents_melted$tick==729|Facility_B_random_load_3_log_red_agents_melted$tick==897|Facility_B_random_load_3_log_red_agents_melted$tick==1065|Facility_B_random_load_3_log_red_agents_melted$tick==1233),]

Facility_B_random_load_3_log_red_agents_melted_wednesday_preop <- Facility_B_random_load_3_log_red_agents_melted[which(Facility_B_random_load_3_log_red_agents_melted$tick==81|Facility_B_random_load_3_log_red_agents_melted$tick==249|Facility_B_random_load_3_log_red_agents_melted$tick==417|Facility_B_random_load_3_log_red_agents_melted$tick==585|Facility_B_random_load_3_log_red_agents_melted$tick==753|Facility_B_random_load_3_log_red_agents_melted$tick==921|Facility_B_random_load_3_log_red_agents_melted$tick==1089|Facility_B_random_load_3_log_red_agents_melted$tick==1257),]

Facility_B_random_load_3_log_red_agents_melted_thursday_preop <- Facility_B_random_load_3_log_red_agents_melted[which(Facility_B_random_load_3_log_red_agents_melted$tick==105|Facility_B_random_load_3_log_red_agents_melted$tick==273|Facility_B_random_load_3_log_red_agents_melted$tick==441|Facility_B_random_load_3_log_red_agents_melted$tick==609|Facility_B_random_load_3_log_red_agents_melted$tick==777|Facility_B_random_load_3_log_red_agents_melted$tick==945|Facility_B_random_load_3_log_red_agents_melted$tick==1113|Facility_B_random_load_3_log_red_agents_melted$tick==1281),]

Facility_B_random_load_3_log_red_agents_melted_friday_preop <- Facility_B_random_load_3_log_red_agents_melted[which(Facility_B_random_load_3_log_red_agents_melted$tick==129|Facility_B_random_load_3_log_red_agents_melted$tick==297|Facility_B_random_load_3_log_red_agents_melted$tick==465|Facility_B_random_load_3_log_red_agents_melted$tick==633|Facility_B_random_load_3_log_red_agents_melted$tick==801|Facility_B_random_load_3_log_red_agents_melted$tick==969|Facility_B_random_load_3_log_red_agents_melted$tick==1137|Facility_B_random_load_3_log_red_agents_melted$tick==1305),]

Facility_B_random_load_3_log_red_agents_melted_ff <- as.ffdf(Facility_B_random_load_3_log_red_agents_melted)
rm(Facility_B_random_load_3_log_red_agents_melted)
gc()
```

```{r import Z4 Load 1 Log Reduction}
NL_table_Z4_Load_1_Log_Red <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-26-16-09 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_Z4_Load_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Z4_Load_1_Log_Red <- NL_table_Z4_Load_1_Log_Red[NL_table_Z4_Load_1_Log_Red$scenario==15,]

while (any(grepl('-', names(NL_table_Z4_Load_1_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_1_Log_Red <- NL_table_Z4_Load_1_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Z4_Load_1_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_1_Log_Red <- NL_table_Z4_Load_1_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Z4_Load_1_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_1_Log_Red <- NL_table_Z4_Load_1_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Z4_Load_1_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_1_Log_Red <- NL_table_Z4_Load_1_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Z4_Load_1_Log_Red[ , ..list_columns]

NL_table_Z4_Load_1_Log_Red[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Z4_Load_1_Log_Red <- as.data.frame(NL_table_Z4_Load_1_Log_Red)

NL_table_Z4_Load_1_Log_Red[NL_table_Z4_Load_1_Log_Red==-1] <- NA

NL_table_Z4_Load_1_Log_Red <- subset(NL_table_Z4_Load_1_Log_Red, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Z4_Load_1_Log_Red)[names(NL_table_Z4_Load_1_Log_Red)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Z4_Load_1_Log_Red)[names(NL_table_Z4_Load_1_Log_Red)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Z4_Load_1_Log_Red$loading_w1wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_loading_w1wed_conc_list <- append(z4_load_1_log_red_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_loading_w1wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_cleaning_w1wed_conc_list <- append(z4_load_1_log_red_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_cleaning_w1wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_1_Log_Red$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_1_log_red_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_1_log_red_drying_w1wed_conc_list <- append(z4_load_1_log_red_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_1_Log_Red$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_sorting_w1wed_conc_list <- append(z4_load_1_log_red_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_sorting_w1wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_tray_packing_w1wed_conc_list <- append(z4_load_1_log_red_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_tray_packing_w1wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$reject_w1wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_reject_w1wed_conc_list <- append(z4_load_1_log_red_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_reject_w1wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$other_w1wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_other_w1wed_conc_list <- append(z4_load_1_log_red_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_other_w1wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_1_log_red_loading_concs <- as.data.frame(z4_load_1_log_red_loading_w1wed_conc_list)
z4_load_1_log_red_loading_concs$area <- as.factor('loading')
z4_load_1_log_red_loading_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_1_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_cleaning_concs <- as.data.frame(z4_load_1_log_red_cleaning_w1wed_conc_list)
z4_load_1_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_1_log_red_cleaning_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_1_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_sorting_concs <- as.data.frame(z4_load_1_log_red_sorting_w1wed_conc_list)
z4_load_1_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_1_log_red_sorting_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_reject_concs <- as.data.frame(z4_load_1_log_red_reject_w1wed_conc_list)
z4_load_1_log_red_reject_concs$area <- as.factor('reject')
z4_load_1_log_red_reject_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_tray_packing_concs <- as.data.frame(z4_load_1_log_red_tray_packing_w1wed_conc_list)
z4_load_1_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_1_log_red_tray_packing_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_other_concs <- as.data.frame(z4_load_1_log_red_other_w1wed_conc_list)
z4_load_1_log_red_other_concs$area <- as.factor('other')
z4_load_1_log_red_other_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_w1wed_concs <- rbind(z4_load_1_log_red_loading_concs,z4_load_1_log_red_cleaning_concs,z4_load_1_log_red_sorting_concs,z4_load_1_log_red_tray_packing_concs,z4_load_1_log_red_reject_concs,z4_load_1_log_red_other_concs)

z4_load_1_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$loading_w1wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_loading_prev$area <- as.factor('loading')
z4_load_1_log_red_loading_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$cleaning_w1wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_1_log_red_cleaning_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$sorting_w1wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_1_log_red_sorting_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$reject_w1wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_reject_prev$area <- as.factor('reject')
z4_load_1_log_red_reject_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$tray_packing_w1wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_1_log_red_tray_packing_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$other_w1wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_other_prev$area <- as.factor('other')
z4_load_1_log_red_other_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_w1wed_prev <- rbind(z4_load_1_log_red_loading_prev,z4_load_1_log_red_cleaning_prev,z4_load_1_log_red_sorting_prev,z4_load_1_log_red_tray_packing_prev,z4_load_1_log_red_reject_prev,z4_load_1_log_red_other_prev)

z4_load_1_log_red_w1wed_wet_prev <- as.data.frame(z4_load_1_log_red_loading_prev$prevalence*21/100+z4_load_1_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_1_log_red_w1wed_wet_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_w1wed_wet_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_w1wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_1_log_red_w1wed_dry_prev <- as.data.frame(z4_load_1_log_red_sorting_prev$prevalence*20/100+z4_load_1_log_red_reject_prev$prevalence*23/100+z4_load_1_log_red_tray_packing_prev$prevalence*123/100+z4_load_1_log_red_other_prev$prevalence*10/100)/176*100
z4_load_1_log_red_w1wed_dry_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_w1wed_dry_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_w1wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_1_log_red_w1wed_recombined_prev <- rbind(z4_load_1_log_red_w1wed_wet_prev, z4_load_1_log_red_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Z4_Load_1_Log_Red$loading_w2wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_loading_w2wed_conc_list <- append(z4_load_1_log_red_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_loading_w2wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_cleaning_w2wed_conc_list <- append(z4_load_1_log_red_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_cleaning_w2wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_1_Log_Red$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_1_log_red_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_1_log_red_drying_w2wed_conc_list <- append(z4_load_1_log_red_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_1_Log_Red$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_sorting_w2wed_conc_list <- append(z4_load_1_log_red_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_sorting_w2wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_tray_packing_w2wed_conc_list <- append(z4_load_1_log_red_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_tray_packing_w2wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$reject_w2wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_reject_w2wed_conc_list <- append(z4_load_1_log_red_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_reject_w2wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$other_w2wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_other_w2wed_conc_list <- append(z4_load_1_log_red_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_other_w2wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_1_log_red_loading_concs <- as.data.frame(z4_load_1_log_red_loading_w2wed_conc_list)
z4_load_1_log_red_loading_concs$area <- as.factor('loading')
z4_load_1_log_red_loading_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_1_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_cleaning_concs <- as.data.frame(z4_load_1_log_red_cleaning_w2wed_conc_list)
z4_load_1_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_1_log_red_cleaning_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_1_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_sorting_concs <- as.data.frame(z4_load_1_log_red_sorting_w2wed_conc_list)
z4_load_1_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_1_log_red_sorting_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_reject_concs <- as.data.frame(z4_load_1_log_red_reject_w2wed_conc_list)
z4_load_1_log_red_reject_concs$area <- as.factor('reject')
z4_load_1_log_red_reject_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_tray_packing_concs <- as.data.frame(z4_load_1_log_red_tray_packing_w2wed_conc_list)
z4_load_1_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_1_log_red_tray_packing_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_other_concs <- as.data.frame(z4_load_1_log_red_other_w2wed_conc_list)
z4_load_1_log_red_other_concs$area <- as.factor('other')
z4_load_1_log_red_other_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_w2wed_concs <- rbind(z4_load_1_log_red_loading_concs,z4_load_1_log_red_cleaning_concs,z4_load_1_log_red_sorting_concs,z4_load_1_log_red_tray_packing_concs,z4_load_1_log_red_reject_concs,z4_load_1_log_red_other_concs)

z4_load_1_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$loading_w2wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_loading_prev$area <- as.factor('loading')
z4_load_1_log_red_loading_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$cleaning_w2wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_1_log_red_cleaning_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$sorting_w2wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_1_log_red_sorting_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$reject_w2wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_reject_prev$area <- as.factor('reject')
z4_load_1_log_red_reject_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$tray_packing_w2wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_1_log_red_tray_packing_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$other_w2wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_other_prev$area <- as.factor('other')
z4_load_1_log_red_other_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_w2wed_prev <- rbind(z4_load_1_log_red_loading_prev,z4_load_1_log_red_cleaning_prev,z4_load_1_log_red_sorting_prev,z4_load_1_log_red_tray_packing_prev,z4_load_1_log_red_reject_prev,z4_load_1_log_red_other_prev)

z4_load_1_log_red_w2wed_wet_prev <- as.data.frame(z4_load_1_log_red_loading_prev$prevalence*21/100+z4_load_1_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_1_log_red_w2wed_wet_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_w2wed_wet_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_w2wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_1_log_red_w2wed_dry_prev <- as.data.frame(z4_load_1_log_red_sorting_prev$prevalence*20/100+z4_load_1_log_red_reject_prev$prevalence*23/100+z4_load_1_log_red_tray_packing_prev$prevalence*123/100+z4_load_1_log_red_other_prev$prevalence*10/100)/176*100
z4_load_1_log_red_w2wed_dry_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_w2wed_dry_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_w2wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_1_log_red_w2wed_recombined_prev <- rbind(z4_load_1_log_red_w2wed_wet_prev, z4_load_1_log_red_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Z4_Load_1_Log_Red$loading_w3wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_loading_w3wed_conc_list <- append(z4_load_1_log_red_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_loading_w3wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_cleaning_w3wed_conc_list <- append(z4_load_1_log_red_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_cleaning_w3wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_1_Log_Red$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_1_log_red_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_1_log_red_drying_w3wed_conc_list <- append(z4_load_1_log_red_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_1_Log_Red$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_sorting_w3wed_conc_list <- append(z4_load_1_log_red_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_sorting_w3wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_tray_packing_w3wed_conc_list <- append(z4_load_1_log_red_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_tray_packing_w3wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$reject_w3wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_reject_w3wed_conc_list <- append(z4_load_1_log_red_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_reject_w3wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$other_w3wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_other_w3wed_conc_list <- append(z4_load_1_log_red_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_other_w3wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_1_log_red_loading_concs <- as.data.frame(z4_load_1_log_red_loading_w3wed_conc_list)
z4_load_1_log_red_loading_concs$area <- as.factor('loading')
z4_load_1_log_red_loading_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_1_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_cleaning_concs <- as.data.frame(z4_load_1_log_red_cleaning_w3wed_conc_list)
z4_load_1_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_1_log_red_cleaning_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_1_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_sorting_concs <- as.data.frame(z4_load_1_log_red_sorting_w3wed_conc_list)
z4_load_1_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_1_log_red_sorting_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_reject_concs <- as.data.frame(z4_load_1_log_red_reject_w3wed_conc_list)
z4_load_1_log_red_reject_concs$area <- as.factor('reject')
z4_load_1_log_red_reject_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_tray_packing_concs <- as.data.frame(z4_load_1_log_red_tray_packing_w3wed_conc_list)
z4_load_1_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_1_log_red_tray_packing_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_other_concs <- as.data.frame(z4_load_1_log_red_other_w3wed_conc_list)
z4_load_1_log_red_other_concs$area <- as.factor('other')
z4_load_1_log_red_other_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_w3wed_concs <- rbind(z4_load_1_log_red_loading_concs,z4_load_1_log_red_cleaning_concs,z4_load_1_log_red_sorting_concs,z4_load_1_log_red_tray_packing_concs,z4_load_1_log_red_reject_concs,z4_load_1_log_red_other_concs)

z4_load_1_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$loading_w3wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_loading_prev$area <- as.factor('loading')
z4_load_1_log_red_loading_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$cleaning_w3wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_1_log_red_cleaning_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$sorting_w3wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_1_log_red_sorting_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$reject_w3wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_reject_prev$area <- as.factor('reject')
z4_load_1_log_red_reject_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$tray_packing_w3wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_1_log_red_tray_packing_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$other_w3wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_other_prev$area <- as.factor('other')
z4_load_1_log_red_other_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_w3wed_prev <- rbind(z4_load_1_log_red_loading_prev,z4_load_1_log_red_cleaning_prev,z4_load_1_log_red_sorting_prev,z4_load_1_log_red_tray_packing_prev,z4_load_1_log_red_reject_prev,z4_load_1_log_red_other_prev)

z4_load_1_log_red_w3wed_wet_prev <- as.data.frame(z4_load_1_log_red_loading_prev$prevalence*21/100+z4_load_1_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_1_log_red_w3wed_wet_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_w3wed_wet_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_w3wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_1_log_red_w3wed_dry_prev <- as.data.frame(z4_load_1_log_red_sorting_prev$prevalence*20/100+z4_load_1_log_red_reject_prev$prevalence*23/100+z4_load_1_log_red_tray_packing_prev$prevalence*123/100+z4_load_1_log_red_other_prev$prevalence*10/100)/176*100
z4_load_1_log_red_w3wed_dry_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_w3wed_dry_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_w3wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_1_log_red_w3wed_recombined_prev <- rbind(z4_load_1_log_red_w3wed_wet_prev, z4_load_1_log_red_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Z4_Load_1_Log_Red$loading_w4wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_loading_w4wed_conc_list <- append(z4_load_1_log_red_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_loading_w4wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_cleaning_w4wed_conc_list <- append(z4_load_1_log_red_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_cleaning_w4wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_1_Log_Red$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_1_log_red_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_1_log_red_drying_w4wed_conc_list <- append(z4_load_1_log_red_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_1_Log_Red$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_sorting_w4wed_conc_list <- append(z4_load_1_log_red_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_sorting_w4wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_tray_packing_w4wed_conc_list <- append(z4_load_1_log_red_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_tray_packing_w4wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$reject_w4wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_reject_w4wed_conc_list <- append(z4_load_1_log_red_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_reject_w4wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$other_w4wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_other_w4wed_conc_list <- append(z4_load_1_log_red_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_other_w4wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_1_log_red_loading_concs <- as.data.frame(z4_load_1_log_red_loading_w4wed_conc_list)
z4_load_1_log_red_loading_concs$area <- as.factor('loading')
z4_load_1_log_red_loading_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_1_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_cleaning_concs <- as.data.frame(z4_load_1_log_red_cleaning_w4wed_conc_list)
z4_load_1_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_1_log_red_cleaning_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_1_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_sorting_concs <- as.data.frame(z4_load_1_log_red_sorting_w4wed_conc_list)
z4_load_1_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_1_log_red_sorting_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_reject_concs <- as.data.frame(z4_load_1_log_red_reject_w4wed_conc_list)
z4_load_1_log_red_reject_concs$area <- as.factor('reject')
z4_load_1_log_red_reject_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_tray_packing_concs <- as.data.frame(z4_load_1_log_red_tray_packing_w4wed_conc_list)
z4_load_1_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_1_log_red_tray_packing_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_other_concs <- as.data.frame(z4_load_1_log_red_other_w4wed_conc_list)
z4_load_1_log_red_other_concs$area <- as.factor('other')
z4_load_1_log_red_other_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_w4wed_concs <- rbind(z4_load_1_log_red_loading_concs,z4_load_1_log_red_cleaning_concs,z4_load_1_log_red_sorting_concs,z4_load_1_log_red_tray_packing_concs,z4_load_1_log_red_reject_concs,z4_load_1_log_red_other_concs)

z4_load_1_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$loading_w4wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_loading_prev$area <- as.factor('loading')
z4_load_1_log_red_loading_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$cleaning_w4wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_1_log_red_cleaning_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$sorting_w4wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_1_log_red_sorting_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$reject_w4wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_reject_prev$area <- as.factor('reject')
z4_load_1_log_red_reject_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$tray_packing_w4wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_1_log_red_tray_packing_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$other_w4wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_other_prev$area <- as.factor('other')
z4_load_1_log_red_other_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_w4wed_prev <- rbind(z4_load_1_log_red_loading_prev,z4_load_1_log_red_cleaning_prev,z4_load_1_log_red_sorting_prev,z4_load_1_log_red_tray_packing_prev,z4_load_1_log_red_reject_prev,z4_load_1_log_red_other_prev)

z4_load_1_log_red_w4wed_wet_prev <- as.data.frame(z4_load_1_log_red_loading_prev$prevalence*21/100+z4_load_1_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_1_log_red_w4wed_wet_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_w4wed_wet_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_w4wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_1_log_red_w4wed_dry_prev <- as.data.frame(z4_load_1_log_red_sorting_prev$prevalence*20/100+z4_load_1_log_red_reject_prev$prevalence*23/100+z4_load_1_log_red_tray_packing_prev$prevalence*123/100+z4_load_1_log_red_other_prev$prevalence*10/100)/176*100
z4_load_1_log_red_w4wed_dry_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_w4wed_dry_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_w4wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_1_log_red_w4wed_recombined_prev <- rbind(z4_load_1_log_red_w4wed_wet_prev, z4_load_1_log_red_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Z4_Load_1_Log_Red$loading_w5wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_loading_w5wed_conc_list <- append(z4_load_1_log_red_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_loading_w5wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_cleaning_w5wed_conc_list <- append(z4_load_1_log_red_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_cleaning_w5wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_1_Log_Red$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_1_log_red_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_1_log_red_drying_w5wed_conc_list <- append(z4_load_1_log_red_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_1_Log_Red$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_sorting_w5wed_conc_list <- append(z4_load_1_log_red_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_sorting_w5wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_tray_packing_w5wed_conc_list <- append(z4_load_1_log_red_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_tray_packing_w5wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$reject_w5wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_reject_w5wed_conc_list <- append(z4_load_1_log_red_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_reject_w5wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$other_w5wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_other_w5wed_conc_list <- append(z4_load_1_log_red_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_other_w5wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_1_log_red_loading_concs <- as.data.frame(z4_load_1_log_red_loading_w5wed_conc_list)
z4_load_1_log_red_loading_concs$area <- as.factor('loading')
z4_load_1_log_red_loading_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_1_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_cleaning_concs <- as.data.frame(z4_load_1_log_red_cleaning_w5wed_conc_list)
z4_load_1_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_1_log_red_cleaning_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_1_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_sorting_concs <- as.data.frame(z4_load_1_log_red_sorting_w5wed_conc_list)
z4_load_1_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_1_log_red_sorting_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_reject_concs <- as.data.frame(z4_load_1_log_red_reject_w5wed_conc_list)
z4_load_1_log_red_reject_concs$area <- as.factor('reject')
z4_load_1_log_red_reject_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_tray_packing_concs <- as.data.frame(z4_load_1_log_red_tray_packing_w5wed_conc_list)
z4_load_1_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_1_log_red_tray_packing_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_other_concs <- as.data.frame(z4_load_1_log_red_other_w5wed_conc_list)
z4_load_1_log_red_other_concs$area <- as.factor('other')
z4_load_1_log_red_other_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_w5wed_concs <- rbind(z4_load_1_log_red_loading_concs,z4_load_1_log_red_cleaning_concs,z4_load_1_log_red_sorting_concs,z4_load_1_log_red_tray_packing_concs,z4_load_1_log_red_reject_concs,z4_load_1_log_red_other_concs)

z4_load_1_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$loading_w5wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_loading_prev$area <- as.factor('loading')
z4_load_1_log_red_loading_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$cleaning_w5wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_1_log_red_cleaning_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$sorting_w5wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_1_log_red_sorting_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$reject_w5wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_reject_prev$area <- as.factor('reject')
z4_load_1_log_red_reject_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$tray_packing_w5wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_1_log_red_tray_packing_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$other_w5wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_other_prev$area <- as.factor('other')
z4_load_1_log_red_other_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_w5wed_prev <- rbind(z4_load_1_log_red_loading_prev,z4_load_1_log_red_cleaning_prev,z4_load_1_log_red_sorting_prev,z4_load_1_log_red_tray_packing_prev,z4_load_1_log_red_reject_prev,z4_load_1_log_red_other_prev)

z4_load_1_log_red_w5wed_wet_prev <- as.data.frame(z4_load_1_log_red_loading_prev$prevalence*21/100+z4_load_1_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_1_log_red_w5wed_wet_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_w5wed_wet_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_w5wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_1_log_red_w5wed_dry_prev <- as.data.frame(z4_load_1_log_red_sorting_prev$prevalence*20/100+z4_load_1_log_red_reject_prev$prevalence*23/100+z4_load_1_log_red_tray_packing_prev$prevalence*123/100+z4_load_1_log_red_other_prev$prevalence*10/100)/176*100
z4_load_1_log_red_w5wed_dry_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_w5wed_dry_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_w5wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_1_log_red_w5wed_recombined_prev <- rbind(z4_load_1_log_red_w5wed_wet_prev, z4_load_1_log_red_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Z4_Load_1_Log_Red$loading_w6wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_loading_w6wed_conc_list <- append(z4_load_1_log_red_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_loading_w6wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_cleaning_w6wed_conc_list <- append(z4_load_1_log_red_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_cleaning_w6wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_1_Log_Red$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_1_log_red_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_1_log_red_drying_w6wed_conc_list <- append(z4_load_1_log_red_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_1_Log_Red$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_sorting_w6wed_conc_list <- append(z4_load_1_log_red_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_sorting_w6wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_tray_packing_w6wed_conc_list <- append(z4_load_1_log_red_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_tray_packing_w6wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$reject_w6wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_reject_w6wed_conc_list <- append(z4_load_1_log_red_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_reject_w6wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$other_w6wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_other_w6wed_conc_list <- append(z4_load_1_log_red_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_other_w6wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_1_log_red_loading_concs <- as.data.frame(z4_load_1_log_red_loading_w6wed_conc_list)
z4_load_1_log_red_loading_concs$area <- as.factor('loading')
z4_load_1_log_red_loading_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_1_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_cleaning_concs <- as.data.frame(z4_load_1_log_red_cleaning_w6wed_conc_list)
z4_load_1_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_1_log_red_cleaning_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_1_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_sorting_concs <- as.data.frame(z4_load_1_log_red_sorting_w6wed_conc_list)
z4_load_1_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_1_log_red_sorting_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_reject_concs <- as.data.frame(z4_load_1_log_red_reject_w6wed_conc_list)
z4_load_1_log_red_reject_concs$area <- as.factor('reject')
z4_load_1_log_red_reject_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_tray_packing_concs <- as.data.frame(z4_load_1_log_red_tray_packing_w6wed_conc_list)
z4_load_1_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_1_log_red_tray_packing_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_other_concs <- as.data.frame(z4_load_1_log_red_other_w6wed_conc_list)
z4_load_1_log_red_other_concs$area <- as.factor('other')
z4_load_1_log_red_other_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_w6wed_concs <- rbind(z4_load_1_log_red_loading_concs,z4_load_1_log_red_cleaning_concs,z4_load_1_log_red_sorting_concs,z4_load_1_log_red_tray_packing_concs,z4_load_1_log_red_reject_concs,z4_load_1_log_red_other_concs)

z4_load_1_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$loading_w6wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_loading_prev$area <- as.factor('loading')
z4_load_1_log_red_loading_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$cleaning_w6wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_1_log_red_cleaning_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$sorting_w6wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_1_log_red_sorting_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$reject_w6wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_reject_prev$area <- as.factor('reject')
z4_load_1_log_red_reject_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$tray_packing_w6wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_1_log_red_tray_packing_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$other_w6wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_other_prev$area <- as.factor('other')
z4_load_1_log_red_other_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_w6wed_prev <- rbind(z4_load_1_log_red_loading_prev,z4_load_1_log_red_cleaning_prev,z4_load_1_log_red_sorting_prev,z4_load_1_log_red_tray_packing_prev,z4_load_1_log_red_reject_prev,z4_load_1_log_red_other_prev)

z4_load_1_log_red_w6wed_wet_prev <- as.data.frame(z4_load_1_log_red_loading_prev$prevalence*21/100+z4_load_1_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_1_log_red_w6wed_wet_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_w6wed_wet_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_w6wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_1_log_red_w6wed_dry_prev <- as.data.frame(z4_load_1_log_red_sorting_prev$prevalence*20/100+z4_load_1_log_red_reject_prev$prevalence*23/100+z4_load_1_log_red_tray_packing_prev$prevalence*123/100+z4_load_1_log_red_other_prev$prevalence*10/100)/176*100
z4_load_1_log_red_w6wed_dry_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_w6wed_dry_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_w6wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_1_log_red_w6wed_recombined_prev <- rbind(z4_load_1_log_red_w6wed_wet_prev, z4_load_1_log_red_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Z4_Load_1_Log_Red$loading_w7wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_loading_w7wed_conc_list <- append(z4_load_1_log_red_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_loading_w7wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_cleaning_w7wed_conc_list <- append(z4_load_1_log_red_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_cleaning_w7wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_1_Log_Red$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_1_log_red_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_1_log_red_drying_w7wed_conc_list <- append(z4_load_1_log_red_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_1_Log_Red$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_sorting_w7wed_conc_list <- append(z4_load_1_log_red_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_sorting_w7wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_tray_packing_w7wed_conc_list <- append(z4_load_1_log_red_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_tray_packing_w7wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$reject_w7wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_reject_w7wed_conc_list <- append(z4_load_1_log_red_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_reject_w7wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$other_w7wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_other_w7wed_conc_list <- append(z4_load_1_log_red_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_other_w7wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_1_log_red_loading_concs <- as.data.frame(z4_load_1_log_red_loading_w7wed_conc_list)
z4_load_1_log_red_loading_concs$area <- as.factor('loading')
z4_load_1_log_red_loading_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_1_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_cleaning_concs <- as.data.frame(z4_load_1_log_red_cleaning_w7wed_conc_list)
z4_load_1_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_1_log_red_cleaning_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_1_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_sorting_concs <- as.data.frame(z4_load_1_log_red_sorting_w7wed_conc_list)
z4_load_1_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_1_log_red_sorting_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_reject_concs <- as.data.frame(z4_load_1_log_red_reject_w7wed_conc_list)
z4_load_1_log_red_reject_concs$area <- as.factor('reject')
z4_load_1_log_red_reject_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_tray_packing_concs <- as.data.frame(z4_load_1_log_red_tray_packing_w7wed_conc_list)
z4_load_1_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_1_log_red_tray_packing_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_other_concs <- as.data.frame(z4_load_1_log_red_other_w7wed_conc_list)
z4_load_1_log_red_other_concs$area <- as.factor('other')
z4_load_1_log_red_other_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_w7wed_concs <- rbind(z4_load_1_log_red_loading_concs,z4_load_1_log_red_cleaning_concs,z4_load_1_log_red_sorting_concs,z4_load_1_log_red_tray_packing_concs,z4_load_1_log_red_reject_concs,z4_load_1_log_red_other_concs)

z4_load_1_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$loading_w7wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_loading_prev$area <- as.factor('loading')
z4_load_1_log_red_loading_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$cleaning_w7wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_1_log_red_cleaning_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$sorting_w7wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_1_log_red_sorting_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$reject_w7wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_reject_prev$area <- as.factor('reject')
z4_load_1_log_red_reject_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$tray_packing_w7wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_1_log_red_tray_packing_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$other_w7wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_other_prev$area <- as.factor('other')
z4_load_1_log_red_other_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_w7wed_prev <- rbind(z4_load_1_log_red_loading_prev,z4_load_1_log_red_cleaning_prev,z4_load_1_log_red_sorting_prev,z4_load_1_log_red_tray_packing_prev,z4_load_1_log_red_reject_prev,z4_load_1_log_red_other_prev)

z4_load_1_log_red_w7wed_wet_prev <- as.data.frame(z4_load_1_log_red_loading_prev$prevalence*21/100+z4_load_1_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_1_log_red_w7wed_wet_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_w7wed_wet_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_w7wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_1_log_red_w7wed_dry_prev <- as.data.frame(z4_load_1_log_red_sorting_prev$prevalence*20/100+z4_load_1_log_red_reject_prev$prevalence*23/100+z4_load_1_log_red_tray_packing_prev$prevalence*123/100+z4_load_1_log_red_other_prev$prevalence*10/100)/176*100
z4_load_1_log_red_w7wed_dry_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_w7wed_dry_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_w7wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_1_log_red_w7wed_recombined_prev <- rbind(z4_load_1_log_red_w7wed_wet_prev, z4_load_1_log_red_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Z4_Load_1_Log_Red$loading_w8wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_loading_w8wed_conc_list <- append(z4_load_1_log_red_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_loading_w8wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_cleaning_w8wed_conc_list <- append(z4_load_1_log_red_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_cleaning_w8wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_1_Log_Red$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_1_log_red_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_1_log_red_drying_w8wed_conc_list <- append(z4_load_1_log_red_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_1_Log_Red$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_sorting_w8wed_conc_list <- append(z4_load_1_log_red_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_sorting_w8wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_tray_packing_w8wed_conc_list <- append(z4_load_1_log_red_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_tray_packing_w8wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$reject_w8wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_reject_w8wed_conc_list <- append(z4_load_1_log_red_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_reject_w8wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_1_Log_Red$other_w8wed_conc_list
vector <- vector[vector!='[]']
z4_load_1_log_red_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_1_log_red_other_w8wed_conc_list <- append(z4_load_1_log_red_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_1_log_red_other_w8wed_conc_matrix <- matrix(unlist(z4_load_1_log_red_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_1_log_red_loading_concs <- as.data.frame(z4_load_1_log_red_loading_w8wed_conc_list)
z4_load_1_log_red_loading_concs$area <- as.factor('loading')
z4_load_1_log_red_loading_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_1_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_cleaning_concs <- as.data.frame(z4_load_1_log_red_cleaning_w8wed_conc_list)
z4_load_1_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_1_log_red_cleaning_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_1_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_sorting_concs <- as.data.frame(z4_load_1_log_red_sorting_w8wed_conc_list)
z4_load_1_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_1_log_red_sorting_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_reject_concs <- as.data.frame(z4_load_1_log_red_reject_w8wed_conc_list)
z4_load_1_log_red_reject_concs$area <- as.factor('reject')
z4_load_1_log_red_reject_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_tray_packing_concs <- as.data.frame(z4_load_1_log_red_tray_packing_w8wed_conc_list)
z4_load_1_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_1_log_red_tray_packing_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_other_concs <- as.data.frame(z4_load_1_log_red_other_w8wed_conc_list)
z4_load_1_log_red_other_concs$area <- as.factor('other')
z4_load_1_log_red_other_concs$scenario <- as.factor('LZ_01')
z4_load_1_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_1_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_1_log_red_w8wed_concs <- rbind(z4_load_1_log_red_loading_concs,z4_load_1_log_red_cleaning_concs,z4_load_1_log_red_sorting_concs,z4_load_1_log_red_tray_packing_concs,z4_load_1_log_red_reject_concs,z4_load_1_log_red_other_concs)

z4_load_1_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$loading_w8wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_loading_prev$area <- as.factor('loading')
z4_load_1_log_red_loading_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$cleaning_w8wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_1_log_red_cleaning_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$sorting_w8wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_1_log_red_sorting_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$reject_w8wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_reject_prev$area <- as.factor('reject')
z4_load_1_log_red_reject_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$tray_packing_w8wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_1_log_red_tray_packing_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_1_Log_Red$other_w8wed_prev[order(NL_table_Z4_Load_1_Log_Red$local_seed)])
z4_load_1_log_red_other_prev$area <- as.factor('other')
z4_load_1_log_red_other_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_1_log_red_w8wed_prev <- rbind(z4_load_1_log_red_loading_prev,z4_load_1_log_red_cleaning_prev,z4_load_1_log_red_sorting_prev,z4_load_1_log_red_tray_packing_prev,z4_load_1_log_red_reject_prev,z4_load_1_log_red_other_prev)

z4_load_1_log_red_w8wed_wet_prev <- as.data.frame(z4_load_1_log_red_loading_prev$prevalence*21/100+z4_load_1_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_1_log_red_w8wed_wet_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_w8wed_wet_prev$water <- as.factor('Wet')
names(z4_load_1_log_red_w8wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_1_log_red_w8wed_dry_prev <- as.data.frame(z4_load_1_log_red_sorting_prev$prevalence*20/100+z4_load_1_log_red_reject_prev$prevalence*23/100+z4_load_1_log_red_tray_packing_prev$prevalence*123/100+z4_load_1_log_red_other_prev$prevalence*10/100)/176*100
z4_load_1_log_red_w8wed_dry_prev$scenario <- as.factor('LZ_01')
z4_load_1_log_red_w8wed_dry_prev$water <- as.factor('Dry')
names(z4_load_1_log_red_w8wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_1_log_red_w8wed_recombined_prev <- rbind(z4_load_1_log_red_w8wed_wet_prev, z4_load_1_log_red_w8wed_dry_prev)

vector <- NL_table_Z4_Load_1_Log_Red$lifetime_conc_list[order(NL_table_Z4_Load_1_Log_Red$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

z4_load_1_log_red_w1wed_recombined_prev$week <- as.factor(1)
z4_load_1_log_red_w2wed_recombined_prev$week <- as.factor(2)
z4_load_1_log_red_w3wed_recombined_prev$week <- as.factor(3)
z4_load_1_log_red_w4wed_recombined_prev$week <- as.factor(4)
z4_load_1_log_red_w5wed_recombined_prev$week <- as.factor(5)
z4_load_1_log_red_w6wed_recombined_prev$week <- as.factor(6)
z4_load_1_log_red_w7wed_recombined_prev$week <- as.factor(7)
z4_load_1_log_red_w8wed_recombined_prev$week <- as.factor(8)
z4_load_1_log_red_allwed_prev <- rbind(z4_load_1_log_red_w1wed_recombined_prev,z4_load_1_log_red_w2wed_recombined_prev,z4_load_1_log_red_w3wed_recombined_prev,z4_load_1_log_red_w4wed_recombined_prev,z4_load_1_log_red_w5wed_recombined_prev,z4_load_1_log_red_w6wed_recombined_prev,z4_load_1_log_red_w7wed_recombined_prev,z4_load_1_log_red_w8wed_recombined_prev)

Facility_B_z4_load_1_log_red_agents_melted <- melt(mdarray)
colnames(Facility_B_z4_load_1_log_red_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_z4_load_1_log_red_agents_melted$agent <- Facility_B_z4_load_1_log_red_agents_melted$agent-1
Facility_B_z4_load_1_log_red_agents_melted$logical <- Facility_B_z4_load_1_log_red_agents_melted$value>0
Facility_B_z4_load_1_log_red_agents_melted$binary <- as.numeric(Facility_B_z4_load_1_log_red_agents_melted$logical)
Facility_B_z4_load_1_log_red_agents_melted$log10value <- log10(Facility_B_z4_load_1_log_red_agents_melted$value)
Facility_B_z4_load_1_log_red_agents_melted$log10value[is.infinite(Facility_B_z4_load_1_log_red_agents_melted$log10value)] <- 0

agent <- Facility_B_z4_load_1_log_red_agents_melted$agent
iteration <- Facility_B_z4_load_1_log_red_agents_melted$iteration
tick <- Facility_B_z4_load_1_log_red_agents_melted$tick
rle_matrix <- tapply(Facility_B_z4_load_1_log_red_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_z4_load_1_log_red_agents_melted_mean_value_matrix <- tapply(Facility_B_z4_load_1_log_red_agents_melted$value, list(agent, tick), mean)
Facility_B_z4_load_1_log_red_agents_melted_median_value_matrix <- tapply(Facility_B_z4_load_1_log_red_agents_melted$value, list(agent, tick), median)
Facility_B_z4_load_1_log_red_agents_melted_prob_value_matrix <- tapply(Facility_B_z4_load_1_log_red_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}
# durations$agent <- durations$agent-1

Facility_B_durations_z4_load_1_log_red <- durations

agents_list_z4_load_1_log_red <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_z4_load_1_log_red <- agents_list_z4_load_1_log_red[,c("V1","V7","V8","V9")]
colnames(agents_list_z4_load_1_log_red) <- c("name","sanitation_status","schedule","area")
agents_list_z4_load_1_log_red$ttp <- rep((168*2),225)
agents_list_z4_load_1_log_red$ttp[agents_list_z4_load_1_log_red$schedule=="daily"] <- (24*2)

agent <- 1
while(agent<=225) {
  agents_list_z4_load_1_log_red$min_duration[agent] <- ifelse(length(Facility_B_durations_z4_load_1_log_red$duration[Facility_B_durations_z4_load_1_log_red$agent==agent])==0,NA,min(Facility_B_durations_z4_load_1_log_red$duration[Facility_B_durations_z4_load_1_log_red$agent==agent], na.rm = TRUE))
  agents_list_z4_load_1_log_red$mean_duration[agent] <- ifelse(length(Facility_B_durations_z4_load_1_log_red$duration[Facility_B_durations_z4_load_1_log_red$agent==agent])==0,NA,mean(Facility_B_durations_z4_load_1_log_red$duration[Facility_B_durations_z4_load_1_log_red$agent==agent], na.rm = TRUE))
  agents_list_z4_load_1_log_red$median_duration[agent] <- ifelse(length(Facility_B_durations_z4_load_1_log_red$duration[Facility_B_durations_z4_load_1_log_red$agent==agent])==0,NA,median(Facility_B_durations_z4_load_1_log_red$duration[Facility_B_durations_z4_load_1_log_red$agent==agent], na.rm = TRUE))
  agents_list_z4_load_1_log_red$max_duration[agent] <- ifelse(length(Facility_B_durations_z4_load_1_log_red$duration[Facility_B_durations_z4_load_1_log_red$agent==agent])==0,NA,max(Facility_B_durations_z4_load_1_log_red$duration[Facility_B_durations_z4_load_1_log_red$agent==agent], na.rm = TRUE))
  agents_list_z4_load_1_log_red$times_persistent[agent] <- sum(Facility_B_durations_z4_load_1_log_red$duration[Facility_B_durations_z4_load_1_log_red$agent==agent]>agents_list_z4_load_1_log_red$ttp[agent])
  agent <- agent+1 
}

Facility_B_z4_load_1_log_red_agents_melted_monday_preop <- Facility_B_z4_load_1_log_red_agents_melted[which(Facility_B_z4_load_1_log_red_agents_melted$tick==33|Facility_B_z4_load_1_log_red_agents_melted$tick==201|Facility_B_z4_load_1_log_red_agents_melted$tick==369|Facility_B_z4_load_1_log_red_agents_melted$tick==537|Facility_B_z4_load_1_log_red_agents_melted$tick==705|Facility_B_z4_load_1_log_red_agents_melted$tick==873|Facility_B_z4_load_1_log_red_agents_melted$tick==1041|Facility_B_z4_load_1_log_red_agents_melted$tick==1209),]

Facility_B_z4_load_1_log_red_agents_melted_tuesday_preop <- Facility_B_z4_load_1_log_red_agents_melted[which(Facility_B_z4_load_1_log_red_agents_melted$tick==57|Facility_B_z4_load_1_log_red_agents_melted$tick==225|Facility_B_z4_load_1_log_red_agents_melted$tick==393|Facility_B_z4_load_1_log_red_agents_melted$tick==561|Facility_B_z4_load_1_log_red_agents_melted$tick==729|Facility_B_z4_load_1_log_red_agents_melted$tick==897|Facility_B_z4_load_1_log_red_agents_melted$tick==1065|Facility_B_z4_load_1_log_red_agents_melted$tick==1233),]

Facility_B_z4_load_1_log_red_agents_melted_wednesday_preop <- Facility_B_z4_load_1_log_red_agents_melted[which(Facility_B_z4_load_1_log_red_agents_melted$tick==81|Facility_B_z4_load_1_log_red_agents_melted$tick==249|Facility_B_z4_load_1_log_red_agents_melted$tick==417|Facility_B_z4_load_1_log_red_agents_melted$tick==585|Facility_B_z4_load_1_log_red_agents_melted$tick==753|Facility_B_z4_load_1_log_red_agents_melted$tick==921|Facility_B_z4_load_1_log_red_agents_melted$tick==1089|Facility_B_z4_load_1_log_red_agents_melted$tick==1257),]

Facility_B_z4_load_1_log_red_agents_melted_thursday_preop <- Facility_B_z4_load_1_log_red_agents_melted[which(Facility_B_z4_load_1_log_red_agents_melted$tick==105|Facility_B_z4_load_1_log_red_agents_melted$tick==273|Facility_B_z4_load_1_log_red_agents_melted$tick==441|Facility_B_z4_load_1_log_red_agents_melted$tick==609|Facility_B_z4_load_1_log_red_agents_melted$tick==777|Facility_B_z4_load_1_log_red_agents_melted$tick==945|Facility_B_z4_load_1_log_red_agents_melted$tick==1113|Facility_B_z4_load_1_log_red_agents_melted$tick==1281),]

Facility_B_z4_load_1_log_red_agents_melted_friday_preop <- Facility_B_z4_load_1_log_red_agents_melted[which(Facility_B_z4_load_1_log_red_agents_melted$tick==129|Facility_B_z4_load_1_log_red_agents_melted$tick==297|Facility_B_z4_load_1_log_red_agents_melted$tick==465|Facility_B_z4_load_1_log_red_agents_melted$tick==633|Facility_B_z4_load_1_log_red_agents_melted$tick==801|Facility_B_z4_load_1_log_red_agents_melted$tick==969|Facility_B_z4_load_1_log_red_agents_melted$tick==1137|Facility_B_z4_load_1_log_red_agents_melted$tick==1305),]

Facility_B_z4_load_1_log_red_agents_melted_ff <- as.ffdf(Facility_B_z4_load_1_log_red_agents_melted)
rm(Facility_B_z4_load_1_log_red_agents_melted)
gc()
```

```{r import Z4 Load 2 Log Reduction}
NL_table_Z4_Load_2_Log_Red <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-26-16-09 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_Z4_Load_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Z4_Load_2_Log_Red <- NL_table_Z4_Load_2_Log_Red[NL_table_Z4_Load_2_Log_Red$scenario==16,]

while (any(grepl('-', names(NL_table_Z4_Load_2_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_2_Log_Red <- NL_table_Z4_Load_2_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Z4_Load_2_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_2_Log_Red <- NL_table_Z4_Load_2_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Z4_Load_2_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_2_Log_Red <- NL_table_Z4_Load_2_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Z4_Load_2_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_2_Log_Red <- NL_table_Z4_Load_2_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Z4_Load_2_Log_Red[ , ..list_columns]

NL_table_Z4_Load_2_Log_Red[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Z4_Load_2_Log_Red <- as.data.frame(NL_table_Z4_Load_2_Log_Red)

NL_table_Z4_Load_2_Log_Red[NL_table_Z4_Load_2_Log_Red==-1] <- NA

NL_table_Z4_Load_2_Log_Red <- subset(NL_table_Z4_Load_2_Log_Red, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Z4_Load_2_Log_Red)[names(NL_table_Z4_Load_2_Log_Red)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Z4_Load_2_Log_Red)[names(NL_table_Z4_Load_2_Log_Red)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Z4_Load_2_Log_Red$loading_w1wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_loading_w1wed_conc_list <- append(z4_load_2_log_red_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_loading_w1wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_cleaning_w1wed_conc_list <- append(z4_load_2_log_red_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_cleaning_w1wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_2_Log_Red$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_2_log_red_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_2_log_red_drying_w1wed_conc_list <- append(z4_load_2_log_red_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_2_Log_Red$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_sorting_w1wed_conc_list <- append(z4_load_2_log_red_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_sorting_w1wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_tray_packing_w1wed_conc_list <- append(z4_load_2_log_red_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_tray_packing_w1wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$reject_w1wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_reject_w1wed_conc_list <- append(z4_load_2_log_red_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_reject_w1wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$other_w1wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_other_w1wed_conc_list <- append(z4_load_2_log_red_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_other_w1wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_2_log_red_loading_concs <- as.data.frame(z4_load_2_log_red_loading_w1wed_conc_list)
z4_load_2_log_red_loading_concs$area <- as.factor('loading')
z4_load_2_log_red_loading_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_2_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_cleaning_concs <- as.data.frame(z4_load_2_log_red_cleaning_w1wed_conc_list)
z4_load_2_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_2_log_red_cleaning_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_2_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_sorting_concs <- as.data.frame(z4_load_2_log_red_sorting_w1wed_conc_list)
z4_load_2_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_2_log_red_sorting_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_reject_concs <- as.data.frame(z4_load_2_log_red_reject_w1wed_conc_list)
z4_load_2_log_red_reject_concs$area <- as.factor('reject')
z4_load_2_log_red_reject_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_tray_packing_concs <- as.data.frame(z4_load_2_log_red_tray_packing_w1wed_conc_list)
z4_load_2_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_2_log_red_tray_packing_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_other_concs <- as.data.frame(z4_load_2_log_red_other_w1wed_conc_list)
z4_load_2_log_red_other_concs$area <- as.factor('other')
z4_load_2_log_red_other_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_w1wed_concs <- rbind(z4_load_2_log_red_loading_concs,z4_load_2_log_red_cleaning_concs,z4_load_2_log_red_sorting_concs,z4_load_2_log_red_tray_packing_concs,z4_load_2_log_red_reject_concs,z4_load_2_log_red_other_concs)

z4_load_2_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$loading_w1wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_loading_prev$area <- as.factor('loading')
z4_load_2_log_red_loading_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$cleaning_w1wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_2_log_red_cleaning_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$sorting_w1wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_2_log_red_sorting_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$reject_w1wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_reject_prev$area <- as.factor('reject')
z4_load_2_log_red_reject_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$tray_packing_w1wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_2_log_red_tray_packing_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$other_w1wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_other_prev$area <- as.factor('other')
z4_load_2_log_red_other_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_w1wed_prev <- rbind(z4_load_2_log_red_loading_prev,z4_load_2_log_red_cleaning_prev,z4_load_2_log_red_sorting_prev,z4_load_2_log_red_tray_packing_prev,z4_load_2_log_red_reject_prev,z4_load_2_log_red_other_prev)

z4_load_2_log_red_w1wed_wet_prev <- as.data.frame(z4_load_2_log_red_loading_prev$prevalence*21/100+z4_load_2_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_2_log_red_w1wed_wet_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_w1wed_wet_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_w1wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_2_log_red_w1wed_dry_prev <- as.data.frame(z4_load_2_log_red_sorting_prev$prevalence*20/100+z4_load_2_log_red_reject_prev$prevalence*23/100+z4_load_2_log_red_tray_packing_prev$prevalence*123/100+z4_load_2_log_red_other_prev$prevalence*10/100)/176*100
z4_load_2_log_red_w1wed_dry_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_w1wed_dry_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_w1wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_2_log_red_w1wed_recombined_prev <- rbind(z4_load_2_log_red_w1wed_wet_prev, z4_load_2_log_red_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Z4_Load_2_Log_Red$loading_w2wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_loading_w2wed_conc_list <- append(z4_load_2_log_red_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_loading_w2wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_cleaning_w2wed_conc_list <- append(z4_load_2_log_red_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_cleaning_w2wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_2_Log_Red$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_2_log_red_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_2_log_red_drying_w2wed_conc_list <- append(z4_load_2_log_red_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_2_Log_Red$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_sorting_w2wed_conc_list <- append(z4_load_2_log_red_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_sorting_w2wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_tray_packing_w2wed_conc_list <- append(z4_load_2_log_red_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_tray_packing_w2wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$reject_w2wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_reject_w2wed_conc_list <- append(z4_load_2_log_red_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_reject_w2wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$other_w2wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_other_w2wed_conc_list <- append(z4_load_2_log_red_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_other_w2wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_2_log_red_loading_concs <- as.data.frame(z4_load_2_log_red_loading_w2wed_conc_list)
z4_load_2_log_red_loading_concs$area <- as.factor('loading')
z4_load_2_log_red_loading_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_2_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_cleaning_concs <- as.data.frame(z4_load_2_log_red_cleaning_w2wed_conc_list)
z4_load_2_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_2_log_red_cleaning_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_2_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_sorting_concs <- as.data.frame(z4_load_2_log_red_sorting_w2wed_conc_list)
z4_load_2_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_2_log_red_sorting_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_reject_concs <- as.data.frame(z4_load_2_log_red_reject_w2wed_conc_list)
z4_load_2_log_red_reject_concs$area <- as.factor('reject')
z4_load_2_log_red_reject_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_tray_packing_concs <- as.data.frame(z4_load_2_log_red_tray_packing_w2wed_conc_list)
z4_load_2_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_2_log_red_tray_packing_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_other_concs <- as.data.frame(z4_load_2_log_red_other_w2wed_conc_list)
z4_load_2_log_red_other_concs$area <- as.factor('other')
z4_load_2_log_red_other_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_w2wed_concs <- rbind(z4_load_2_log_red_loading_concs,z4_load_2_log_red_cleaning_concs,z4_load_2_log_red_sorting_concs,z4_load_2_log_red_tray_packing_concs,z4_load_2_log_red_reject_concs,z4_load_2_log_red_other_concs)

z4_load_2_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$loading_w2wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_loading_prev$area <- as.factor('loading')
z4_load_2_log_red_loading_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$cleaning_w2wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_2_log_red_cleaning_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$sorting_w2wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_2_log_red_sorting_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$reject_w2wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_reject_prev$area <- as.factor('reject')
z4_load_2_log_red_reject_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$tray_packing_w2wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_2_log_red_tray_packing_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$other_w2wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_other_prev$area <- as.factor('other')
z4_load_2_log_red_other_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_w2wed_prev <- rbind(z4_load_2_log_red_loading_prev,z4_load_2_log_red_cleaning_prev,z4_load_2_log_red_sorting_prev,z4_load_2_log_red_tray_packing_prev,z4_load_2_log_red_reject_prev,z4_load_2_log_red_other_prev)

z4_load_2_log_red_w2wed_wet_prev <- as.data.frame(z4_load_2_log_red_loading_prev$prevalence*21/100+z4_load_2_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_2_log_red_w2wed_wet_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_w2wed_wet_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_w2wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_2_log_red_w2wed_dry_prev <- as.data.frame(z4_load_2_log_red_sorting_prev$prevalence*20/100+z4_load_2_log_red_reject_prev$prevalence*23/100+z4_load_2_log_red_tray_packing_prev$prevalence*123/100+z4_load_2_log_red_other_prev$prevalence*10/100)/176*100
z4_load_2_log_red_w2wed_dry_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_w2wed_dry_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_w2wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_2_log_red_w2wed_recombined_prev <- rbind(z4_load_2_log_red_w2wed_wet_prev, z4_load_2_log_red_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Z4_Load_2_Log_Red$loading_w3wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_loading_w3wed_conc_list <- append(z4_load_2_log_red_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_loading_w3wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_cleaning_w3wed_conc_list <- append(z4_load_2_log_red_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_cleaning_w3wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_2_Log_Red$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_2_log_red_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_2_log_red_drying_w3wed_conc_list <- append(z4_load_2_log_red_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_2_Log_Red$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_sorting_w3wed_conc_list <- append(z4_load_2_log_red_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_sorting_w3wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_tray_packing_w3wed_conc_list <- append(z4_load_2_log_red_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_tray_packing_w3wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$reject_w3wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_reject_w3wed_conc_list <- append(z4_load_2_log_red_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_reject_w3wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$other_w3wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_other_w3wed_conc_list <- append(z4_load_2_log_red_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_other_w3wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_2_log_red_loading_concs <- as.data.frame(z4_load_2_log_red_loading_w3wed_conc_list)
z4_load_2_log_red_loading_concs$area <- as.factor('loading')
z4_load_2_log_red_loading_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_2_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_cleaning_concs <- as.data.frame(z4_load_2_log_red_cleaning_w3wed_conc_list)
z4_load_2_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_2_log_red_cleaning_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_2_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_sorting_concs <- as.data.frame(z4_load_2_log_red_sorting_w3wed_conc_list)
z4_load_2_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_2_log_red_sorting_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_reject_concs <- as.data.frame(z4_load_2_log_red_reject_w3wed_conc_list)
z4_load_2_log_red_reject_concs$area <- as.factor('reject')
z4_load_2_log_red_reject_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_tray_packing_concs <- as.data.frame(z4_load_2_log_red_tray_packing_w3wed_conc_list)
z4_load_2_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_2_log_red_tray_packing_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_other_concs <- as.data.frame(z4_load_2_log_red_other_w3wed_conc_list)
z4_load_2_log_red_other_concs$area <- as.factor('other')
z4_load_2_log_red_other_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_w3wed_concs <- rbind(z4_load_2_log_red_loading_concs,z4_load_2_log_red_cleaning_concs,z4_load_2_log_red_sorting_concs,z4_load_2_log_red_tray_packing_concs,z4_load_2_log_red_reject_concs,z4_load_2_log_red_other_concs)

z4_load_2_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$loading_w3wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_loading_prev$area <- as.factor('loading')
z4_load_2_log_red_loading_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$cleaning_w3wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_2_log_red_cleaning_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$sorting_w3wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_2_log_red_sorting_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$reject_w3wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_reject_prev$area <- as.factor('reject')
z4_load_2_log_red_reject_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$tray_packing_w3wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_2_log_red_tray_packing_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$other_w3wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_other_prev$area <- as.factor('other')
z4_load_2_log_red_other_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_w3wed_prev <- rbind(z4_load_2_log_red_loading_prev,z4_load_2_log_red_cleaning_prev,z4_load_2_log_red_sorting_prev,z4_load_2_log_red_tray_packing_prev,z4_load_2_log_red_reject_prev,z4_load_2_log_red_other_prev)

z4_load_2_log_red_w3wed_wet_prev <- as.data.frame(z4_load_2_log_red_loading_prev$prevalence*21/100+z4_load_2_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_2_log_red_w3wed_wet_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_w3wed_wet_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_w3wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_2_log_red_w3wed_dry_prev <- as.data.frame(z4_load_2_log_red_sorting_prev$prevalence*20/100+z4_load_2_log_red_reject_prev$prevalence*23/100+z4_load_2_log_red_tray_packing_prev$prevalence*123/100+z4_load_2_log_red_other_prev$prevalence*10/100)/176*100
z4_load_2_log_red_w3wed_dry_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_w3wed_dry_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_w3wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_2_log_red_w3wed_recombined_prev <- rbind(z4_load_2_log_red_w3wed_wet_prev, z4_load_2_log_red_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Z4_Load_2_Log_Red$loading_w4wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_loading_w4wed_conc_list <- append(z4_load_2_log_red_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_loading_w4wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_cleaning_w4wed_conc_list <- append(z4_load_2_log_red_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_cleaning_w4wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_2_Log_Red$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_2_log_red_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_2_log_red_drying_w4wed_conc_list <- append(z4_load_2_log_red_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_2_Log_Red$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_sorting_w4wed_conc_list <- append(z4_load_2_log_red_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_sorting_w4wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_tray_packing_w4wed_conc_list <- append(z4_load_2_log_red_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_tray_packing_w4wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$reject_w4wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_reject_w4wed_conc_list <- append(z4_load_2_log_red_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_reject_w4wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$other_w4wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_other_w4wed_conc_list <- append(z4_load_2_log_red_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_other_w4wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_2_log_red_loading_concs <- as.data.frame(z4_load_2_log_red_loading_w4wed_conc_list)
z4_load_2_log_red_loading_concs$area <- as.factor('loading')
z4_load_2_log_red_loading_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_2_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_cleaning_concs <- as.data.frame(z4_load_2_log_red_cleaning_w4wed_conc_list)
z4_load_2_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_2_log_red_cleaning_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_2_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_sorting_concs <- as.data.frame(z4_load_2_log_red_sorting_w4wed_conc_list)
z4_load_2_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_2_log_red_sorting_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_reject_concs <- as.data.frame(z4_load_2_log_red_reject_w4wed_conc_list)
z4_load_2_log_red_reject_concs$area <- as.factor('reject')
z4_load_2_log_red_reject_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_tray_packing_concs <- as.data.frame(z4_load_2_log_red_tray_packing_w4wed_conc_list)
z4_load_2_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_2_log_red_tray_packing_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_other_concs <- as.data.frame(z4_load_2_log_red_other_w4wed_conc_list)
z4_load_2_log_red_other_concs$area <- as.factor('other')
z4_load_2_log_red_other_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_w4wed_concs <- rbind(z4_load_2_log_red_loading_concs,z4_load_2_log_red_cleaning_concs,z4_load_2_log_red_sorting_concs,z4_load_2_log_red_tray_packing_concs,z4_load_2_log_red_reject_concs,z4_load_2_log_red_other_concs)

z4_load_2_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$loading_w4wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_loading_prev$area <- as.factor('loading')
z4_load_2_log_red_loading_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$cleaning_w4wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_2_log_red_cleaning_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$sorting_w4wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_2_log_red_sorting_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$reject_w4wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_reject_prev$area <- as.factor('reject')
z4_load_2_log_red_reject_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$tray_packing_w4wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_2_log_red_tray_packing_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$other_w4wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_other_prev$area <- as.factor('other')
z4_load_2_log_red_other_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_w4wed_prev <- rbind(z4_load_2_log_red_loading_prev,z4_load_2_log_red_cleaning_prev,z4_load_2_log_red_sorting_prev,z4_load_2_log_red_tray_packing_prev,z4_load_2_log_red_reject_prev,z4_load_2_log_red_other_prev)

z4_load_2_log_red_w4wed_wet_prev <- as.data.frame(z4_load_2_log_red_loading_prev$prevalence*21/100+z4_load_2_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_2_log_red_w4wed_wet_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_w4wed_wet_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_w4wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_2_log_red_w4wed_dry_prev <- as.data.frame(z4_load_2_log_red_sorting_prev$prevalence*20/100+z4_load_2_log_red_reject_prev$prevalence*23/100+z4_load_2_log_red_tray_packing_prev$prevalence*123/100+z4_load_2_log_red_other_prev$prevalence*10/100)/176*100
z4_load_2_log_red_w4wed_dry_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_w4wed_dry_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_w4wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_2_log_red_w4wed_recombined_prev <- rbind(z4_load_2_log_red_w4wed_wet_prev, z4_load_2_log_red_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Z4_Load_2_Log_Red$loading_w5wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_loading_w5wed_conc_list <- append(z4_load_2_log_red_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_loading_w5wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_cleaning_w5wed_conc_list <- append(z4_load_2_log_red_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_cleaning_w5wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_2_Log_Red$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_2_log_red_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_2_log_red_drying_w5wed_conc_list <- append(z4_load_2_log_red_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_2_Log_Red$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_sorting_w5wed_conc_list <- append(z4_load_2_log_red_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_sorting_w5wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_tray_packing_w5wed_conc_list <- append(z4_load_2_log_red_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_tray_packing_w5wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$reject_w5wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_reject_w5wed_conc_list <- append(z4_load_2_log_red_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_reject_w5wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$other_w5wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_other_w5wed_conc_list <- append(z4_load_2_log_red_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_other_w5wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_2_log_red_loading_concs <- as.data.frame(z4_load_2_log_red_loading_w5wed_conc_list)
z4_load_2_log_red_loading_concs$area <- as.factor('loading')
z4_load_2_log_red_loading_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_2_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_cleaning_concs <- as.data.frame(z4_load_2_log_red_cleaning_w5wed_conc_list)
z4_load_2_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_2_log_red_cleaning_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_2_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_sorting_concs <- as.data.frame(z4_load_2_log_red_sorting_w5wed_conc_list)
z4_load_2_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_2_log_red_sorting_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_reject_concs <- as.data.frame(z4_load_2_log_red_reject_w5wed_conc_list)
z4_load_2_log_red_reject_concs$area <- as.factor('reject')
z4_load_2_log_red_reject_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_tray_packing_concs <- as.data.frame(z4_load_2_log_red_tray_packing_w5wed_conc_list)
z4_load_2_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_2_log_red_tray_packing_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_other_concs <- as.data.frame(z4_load_2_log_red_other_w5wed_conc_list)
z4_load_2_log_red_other_concs$area <- as.factor('other')
z4_load_2_log_red_other_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_w5wed_concs <- rbind(z4_load_2_log_red_loading_concs,z4_load_2_log_red_cleaning_concs,z4_load_2_log_red_sorting_concs,z4_load_2_log_red_tray_packing_concs,z4_load_2_log_red_reject_concs,z4_load_2_log_red_other_concs)

z4_load_2_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$loading_w5wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_loading_prev$area <- as.factor('loading')
z4_load_2_log_red_loading_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$cleaning_w5wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_2_log_red_cleaning_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$sorting_w5wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_2_log_red_sorting_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$reject_w5wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_reject_prev$area <- as.factor('reject')
z4_load_2_log_red_reject_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$tray_packing_w5wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_2_log_red_tray_packing_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$other_w5wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_other_prev$area <- as.factor('other')
z4_load_2_log_red_other_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_w5wed_prev <- rbind(z4_load_2_log_red_loading_prev,z4_load_2_log_red_cleaning_prev,z4_load_2_log_red_sorting_prev,z4_load_2_log_red_tray_packing_prev,z4_load_2_log_red_reject_prev,z4_load_2_log_red_other_prev)

z4_load_2_log_red_w5wed_wet_prev <- as.data.frame(z4_load_2_log_red_loading_prev$prevalence*21/100+z4_load_2_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_2_log_red_w5wed_wet_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_w5wed_wet_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_w5wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_2_log_red_w5wed_dry_prev <- as.data.frame(z4_load_2_log_red_sorting_prev$prevalence*20/100+z4_load_2_log_red_reject_prev$prevalence*23/100+z4_load_2_log_red_tray_packing_prev$prevalence*123/100+z4_load_2_log_red_other_prev$prevalence*10/100)/176*100
z4_load_2_log_red_w5wed_dry_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_w5wed_dry_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_w5wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_2_log_red_w5wed_recombined_prev <- rbind(z4_load_2_log_red_w5wed_wet_prev, z4_load_2_log_red_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Z4_Load_2_Log_Red$loading_w6wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_loading_w6wed_conc_list <- append(z4_load_2_log_red_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_loading_w6wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_cleaning_w6wed_conc_list <- append(z4_load_2_log_red_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_cleaning_w6wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_2_Log_Red$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_2_log_red_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_2_log_red_drying_w6wed_conc_list <- append(z4_load_2_log_red_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_2_Log_Red$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_sorting_w6wed_conc_list <- append(z4_load_2_log_red_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_sorting_w6wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_tray_packing_w6wed_conc_list <- append(z4_load_2_log_red_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_tray_packing_w6wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$reject_w6wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_reject_w6wed_conc_list <- append(z4_load_2_log_red_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_reject_w6wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$other_w6wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_other_w6wed_conc_list <- append(z4_load_2_log_red_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_other_w6wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_2_log_red_loading_concs <- as.data.frame(z4_load_2_log_red_loading_w6wed_conc_list)
z4_load_2_log_red_loading_concs$area <- as.factor('loading')
z4_load_2_log_red_loading_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_2_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_cleaning_concs <- as.data.frame(z4_load_2_log_red_cleaning_w6wed_conc_list)
z4_load_2_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_2_log_red_cleaning_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_2_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_sorting_concs <- as.data.frame(z4_load_2_log_red_sorting_w6wed_conc_list)
z4_load_2_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_2_log_red_sorting_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_reject_concs <- as.data.frame(z4_load_2_log_red_reject_w6wed_conc_list)
z4_load_2_log_red_reject_concs$area <- as.factor('reject')
z4_load_2_log_red_reject_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_tray_packing_concs <- as.data.frame(z4_load_2_log_red_tray_packing_w6wed_conc_list)
z4_load_2_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_2_log_red_tray_packing_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_other_concs <- as.data.frame(z4_load_2_log_red_other_w6wed_conc_list)
z4_load_2_log_red_other_concs$area <- as.factor('other')
z4_load_2_log_red_other_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_w6wed_concs <- rbind(z4_load_2_log_red_loading_concs,z4_load_2_log_red_cleaning_concs,z4_load_2_log_red_sorting_concs,z4_load_2_log_red_tray_packing_concs,z4_load_2_log_red_reject_concs,z4_load_2_log_red_other_concs)

z4_load_2_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$loading_w6wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_loading_prev$area <- as.factor('loading')
z4_load_2_log_red_loading_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$cleaning_w6wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_2_log_red_cleaning_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$sorting_w6wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_2_log_red_sorting_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$reject_w6wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_reject_prev$area <- as.factor('reject')
z4_load_2_log_red_reject_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$tray_packing_w6wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_2_log_red_tray_packing_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$other_w6wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_other_prev$area <- as.factor('other')
z4_load_2_log_red_other_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_w6wed_prev <- rbind(z4_load_2_log_red_loading_prev,z4_load_2_log_red_cleaning_prev,z4_load_2_log_red_sorting_prev,z4_load_2_log_red_tray_packing_prev,z4_load_2_log_red_reject_prev,z4_load_2_log_red_other_prev)

z4_load_2_log_red_w6wed_wet_prev <- as.data.frame(z4_load_2_log_red_loading_prev$prevalence*21/100+z4_load_2_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_2_log_red_w6wed_wet_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_w6wed_wet_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_w6wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_2_log_red_w6wed_dry_prev <- as.data.frame(z4_load_2_log_red_sorting_prev$prevalence*20/100+z4_load_2_log_red_reject_prev$prevalence*23/100+z4_load_2_log_red_tray_packing_prev$prevalence*123/100+z4_load_2_log_red_other_prev$prevalence*10/100)/176*100
z4_load_2_log_red_w6wed_dry_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_w6wed_dry_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_w6wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_2_log_red_w6wed_recombined_prev <- rbind(z4_load_2_log_red_w6wed_wet_prev, z4_load_2_log_red_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Z4_Load_2_Log_Red$loading_w7wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_loading_w7wed_conc_list <- append(z4_load_2_log_red_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_loading_w7wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_cleaning_w7wed_conc_list <- append(z4_load_2_log_red_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_cleaning_w7wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_2_Log_Red$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_2_log_red_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_2_log_red_drying_w7wed_conc_list <- append(z4_load_2_log_red_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_2_Log_Red$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_sorting_w7wed_conc_list <- append(z4_load_2_log_red_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_sorting_w7wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_tray_packing_w7wed_conc_list <- append(z4_load_2_log_red_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_tray_packing_w7wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$reject_w7wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_reject_w7wed_conc_list <- append(z4_load_2_log_red_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_reject_w7wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$other_w7wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_other_w7wed_conc_list <- append(z4_load_2_log_red_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_other_w7wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_2_log_red_loading_concs <- as.data.frame(z4_load_2_log_red_loading_w7wed_conc_list)
z4_load_2_log_red_loading_concs$area <- as.factor('loading')
z4_load_2_log_red_loading_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_2_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_cleaning_concs <- as.data.frame(z4_load_2_log_red_cleaning_w7wed_conc_list)
z4_load_2_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_2_log_red_cleaning_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_2_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_sorting_concs <- as.data.frame(z4_load_2_log_red_sorting_w7wed_conc_list)
z4_load_2_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_2_log_red_sorting_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_reject_concs <- as.data.frame(z4_load_2_log_red_reject_w7wed_conc_list)
z4_load_2_log_red_reject_concs$area <- as.factor('reject')
z4_load_2_log_red_reject_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_tray_packing_concs <- as.data.frame(z4_load_2_log_red_tray_packing_w7wed_conc_list)
z4_load_2_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_2_log_red_tray_packing_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_other_concs <- as.data.frame(z4_load_2_log_red_other_w7wed_conc_list)
z4_load_2_log_red_other_concs$area <- as.factor('other')
z4_load_2_log_red_other_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_w7wed_concs <- rbind(z4_load_2_log_red_loading_concs,z4_load_2_log_red_cleaning_concs,z4_load_2_log_red_sorting_concs,z4_load_2_log_red_tray_packing_concs,z4_load_2_log_red_reject_concs,z4_load_2_log_red_other_concs)

z4_load_2_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$loading_w7wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_loading_prev$area <- as.factor('loading')
z4_load_2_log_red_loading_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$cleaning_w7wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_2_log_red_cleaning_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$sorting_w7wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_2_log_red_sorting_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$reject_w7wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_reject_prev$area <- as.factor('reject')
z4_load_2_log_red_reject_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$tray_packing_w7wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_2_log_red_tray_packing_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$other_w7wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_other_prev$area <- as.factor('other')
z4_load_2_log_red_other_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_w7wed_prev <- rbind(z4_load_2_log_red_loading_prev,z4_load_2_log_red_cleaning_prev,z4_load_2_log_red_sorting_prev,z4_load_2_log_red_tray_packing_prev,z4_load_2_log_red_reject_prev,z4_load_2_log_red_other_prev)

z4_load_2_log_red_w7wed_wet_prev <- as.data.frame(z4_load_2_log_red_loading_prev$prevalence*21/100+z4_load_2_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_2_log_red_w7wed_wet_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_w7wed_wet_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_w7wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_2_log_red_w7wed_dry_prev <- as.data.frame(z4_load_2_log_red_sorting_prev$prevalence*20/100+z4_load_2_log_red_reject_prev$prevalence*23/100+z4_load_2_log_red_tray_packing_prev$prevalence*123/100+z4_load_2_log_red_other_prev$prevalence*10/100)/176*100
z4_load_2_log_red_w7wed_dry_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_w7wed_dry_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_w7wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_2_log_red_w7wed_recombined_prev <- rbind(z4_load_2_log_red_w7wed_wet_prev, z4_load_2_log_red_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Z4_Load_2_Log_Red$loading_w8wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_loading_w8wed_conc_list <- append(z4_load_2_log_red_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_loading_w8wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_cleaning_w8wed_conc_list <- append(z4_load_2_log_red_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_cleaning_w8wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_2_Log_Red$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_2_log_red_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_2_log_red_drying_w8wed_conc_list <- append(z4_load_2_log_red_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_2_Log_Red$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_sorting_w8wed_conc_list <- append(z4_load_2_log_red_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_sorting_w8wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_tray_packing_w8wed_conc_list <- append(z4_load_2_log_red_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_tray_packing_w8wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$reject_w8wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_reject_w8wed_conc_list <- append(z4_load_2_log_red_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_reject_w8wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_2_Log_Red$other_w8wed_conc_list
vector <- vector[vector!='[]']
z4_load_2_log_red_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_2_log_red_other_w8wed_conc_list <- append(z4_load_2_log_red_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_2_log_red_other_w8wed_conc_matrix <- matrix(unlist(z4_load_2_log_red_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_2_log_red_loading_concs <- as.data.frame(z4_load_2_log_red_loading_w8wed_conc_list)
z4_load_2_log_red_loading_concs$area <- as.factor('loading')
z4_load_2_log_red_loading_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_2_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_cleaning_concs <- as.data.frame(z4_load_2_log_red_cleaning_w8wed_conc_list)
z4_load_2_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_2_log_red_cleaning_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_2_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_sorting_concs <- as.data.frame(z4_load_2_log_red_sorting_w8wed_conc_list)
z4_load_2_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_2_log_red_sorting_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_reject_concs <- as.data.frame(z4_load_2_log_red_reject_w8wed_conc_list)
z4_load_2_log_red_reject_concs$area <- as.factor('reject')
z4_load_2_log_red_reject_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_tray_packing_concs <- as.data.frame(z4_load_2_log_red_tray_packing_w8wed_conc_list)
z4_load_2_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_2_log_red_tray_packing_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_other_concs <- as.data.frame(z4_load_2_log_red_other_w8wed_conc_list)
z4_load_2_log_red_other_concs$area <- as.factor('other')
z4_load_2_log_red_other_concs$scenario <- as.factor('LZ_02')
z4_load_2_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_2_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_2_log_red_w8wed_concs <- rbind(z4_load_2_log_red_loading_concs,z4_load_2_log_red_cleaning_concs,z4_load_2_log_red_sorting_concs,z4_load_2_log_red_tray_packing_concs,z4_load_2_log_red_reject_concs,z4_load_2_log_red_other_concs)

z4_load_2_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$loading_w8wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_loading_prev$area <- as.factor('loading')
z4_load_2_log_red_loading_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$cleaning_w8wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_2_log_red_cleaning_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$sorting_w8wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_2_log_red_sorting_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$reject_w8wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_reject_prev$area <- as.factor('reject')
z4_load_2_log_red_reject_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$tray_packing_w8wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_2_log_red_tray_packing_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_2_Log_Red$other_w8wed_prev[order(NL_table_Z4_Load_2_Log_Red$local_seed)])
z4_load_2_log_red_other_prev$area <- as.factor('other')
z4_load_2_log_red_other_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_2_log_red_w8wed_prev <- rbind(z4_load_2_log_red_loading_prev,z4_load_2_log_red_cleaning_prev,z4_load_2_log_red_sorting_prev,z4_load_2_log_red_tray_packing_prev,z4_load_2_log_red_reject_prev,z4_load_2_log_red_other_prev)

z4_load_2_log_red_w8wed_wet_prev <- as.data.frame(z4_load_2_log_red_loading_prev$prevalence*21/100+z4_load_2_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_2_log_red_w8wed_wet_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_w8wed_wet_prev$water <- as.factor('Wet')
names(z4_load_2_log_red_w8wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_2_log_red_w8wed_dry_prev <- as.data.frame(z4_load_2_log_red_sorting_prev$prevalence*20/100+z4_load_2_log_red_reject_prev$prevalence*23/100+z4_load_2_log_red_tray_packing_prev$prevalence*123/100+z4_load_2_log_red_other_prev$prevalence*10/100)/176*100
z4_load_2_log_red_w8wed_dry_prev$scenario <- as.factor('LZ_02')
z4_load_2_log_red_w8wed_dry_prev$water <- as.factor('Dry')
names(z4_load_2_log_red_w8wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_2_log_red_w8wed_recombined_prev <- rbind(z4_load_2_log_red_w8wed_wet_prev, z4_load_2_log_red_w8wed_dry_prev)

vector <- NL_table_Z4_Load_2_Log_Red$lifetime_conc_list[order(NL_table_Z4_Load_2_Log_Red$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

z4_load_2_log_red_w1wed_recombined_prev$week <- as.factor(1)
z4_load_2_log_red_w2wed_recombined_prev$week <- as.factor(2)
z4_load_2_log_red_w3wed_recombined_prev$week <- as.factor(3)
z4_load_2_log_red_w4wed_recombined_prev$week <- as.factor(4)
z4_load_2_log_red_w5wed_recombined_prev$week <- as.factor(5)
z4_load_2_log_red_w6wed_recombined_prev$week <- as.factor(6)
z4_load_2_log_red_w7wed_recombined_prev$week <- as.factor(7)
z4_load_2_log_red_w8wed_recombined_prev$week <- as.factor(8)
z4_load_2_log_red_allwed_prev <- rbind(z4_load_2_log_red_w1wed_recombined_prev,z4_load_2_log_red_w2wed_recombined_prev,z4_load_2_log_red_w3wed_recombined_prev,z4_load_2_log_red_w4wed_recombined_prev,z4_load_2_log_red_w5wed_recombined_prev,z4_load_2_log_red_w6wed_recombined_prev,z4_load_2_log_red_w7wed_recombined_prev,z4_load_2_log_red_w8wed_recombined_prev)

Facility_B_z4_load_2_log_red_agents_melted <- melt(mdarray)
colnames(Facility_B_z4_load_2_log_red_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_z4_load_2_log_red_agents_melted$agent <- Facility_B_z4_load_2_log_red_agents_melted$agent-1
Facility_B_z4_load_2_log_red_agents_melted$logical <- Facility_B_z4_load_2_log_red_agents_melted$value>0
Facility_B_z4_load_2_log_red_agents_melted$binary <- as.numeric(Facility_B_z4_load_2_log_red_agents_melted$logical)
Facility_B_z4_load_2_log_red_agents_melted$log10value <- log10(Facility_B_z4_load_2_log_red_agents_melted$value)
Facility_B_z4_load_2_log_red_agents_melted$log10value[is.infinite(Facility_B_z4_load_2_log_red_agents_melted$log10value)] <- 0

agent <- Facility_B_z4_load_2_log_red_agents_melted$agent
iteration <- Facility_B_z4_load_2_log_red_agents_melted$iteration
tick <- Facility_B_z4_load_2_log_red_agents_melted$tick
rle_matrix <- tapply(Facility_B_z4_load_2_log_red_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_z4_load_2_log_red_agents_melted_mean_value_matrix <- tapply(Facility_B_z4_load_2_log_red_agents_melted$value, list(agent, tick), mean)
Facility_B_z4_load_2_log_red_agents_melted_median_value_matrix <- tapply(Facility_B_z4_load_2_log_red_agents_melted$value, list(agent, tick), median)
Facility_B_z4_load_2_log_red_agents_melted_prob_value_matrix <- tapply(Facility_B_z4_load_2_log_red_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}
# durations$agent <- durations$agent-1

Facility_B_durations_z4_load_2_log_red <- durations

agents_list_z4_load_2_log_red <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_z4_load_2_log_red <- agents_list_z4_load_2_log_red[,c("V1","V7","V8","V9")]
colnames(agents_list_z4_load_2_log_red) <- c("name","sanitation_status","schedule","area")
agents_list_z4_load_2_log_red$ttp <- rep((168*2),225)
agents_list_z4_load_2_log_red$ttp[agents_list_z4_load_2_log_red$schedule=="daily"] <- (24*2)

agent <- 1
while(agent<=225) {
  agents_list_z4_load_2_log_red$min_duration[agent] <- ifelse(length(Facility_B_durations_z4_load_2_log_red$duration[Facility_B_durations_z4_load_2_log_red$agent==agent])==0,NA,min(Facility_B_durations_z4_load_2_log_red$duration[Facility_B_durations_z4_load_2_log_red$agent==agent], na.rm = TRUE))
  agents_list_z4_load_2_log_red$mean_duration[agent] <- ifelse(length(Facility_B_durations_z4_load_2_log_red$duration[Facility_B_durations_z4_load_2_log_red$agent==agent])==0,NA,mean(Facility_B_durations_z4_load_2_log_red$duration[Facility_B_durations_z4_load_2_log_red$agent==agent], na.rm = TRUE))
  agents_list_z4_load_2_log_red$median_duration[agent] <- ifelse(length(Facility_B_durations_z4_load_2_log_red$duration[Facility_B_durations_z4_load_2_log_red$agent==agent])==0,NA,median(Facility_B_durations_z4_load_2_log_red$duration[Facility_B_durations_z4_load_2_log_red$agent==agent], na.rm = TRUE))
  agents_list_z4_load_2_log_red$max_duration[agent] <- ifelse(length(Facility_B_durations_z4_load_2_log_red$duration[Facility_B_durations_z4_load_2_log_red$agent==agent])==0,NA,max(Facility_B_durations_z4_load_2_log_red$duration[Facility_B_durations_z4_load_2_log_red$agent==agent], na.rm = TRUE))
  agents_list_z4_load_2_log_red$times_persistent[agent] <- sum(Facility_B_durations_z4_load_2_log_red$duration[Facility_B_durations_z4_load_2_log_red$agent==agent]>agents_list_z4_load_2_log_red$ttp[agent])
  agent <- agent+1 
}

Facility_B_z4_load_2_log_red_agents_melted_monday_preop <- Facility_B_z4_load_2_log_red_agents_melted[which(Facility_B_z4_load_2_log_red_agents_melted$tick==33|Facility_B_z4_load_2_log_red_agents_melted$tick==201|Facility_B_z4_load_2_log_red_agents_melted$tick==369|Facility_B_z4_load_2_log_red_agents_melted$tick==537|Facility_B_z4_load_2_log_red_agents_melted$tick==705|Facility_B_z4_load_2_log_red_agents_melted$tick==873|Facility_B_z4_load_2_log_red_agents_melted$tick==1041|Facility_B_z4_load_2_log_red_agents_melted$tick==1209),]

Facility_B_z4_load_2_log_red_agents_melted_tuesday_preop <- Facility_B_z4_load_2_log_red_agents_melted[which(Facility_B_z4_load_2_log_red_agents_melted$tick==57|Facility_B_z4_load_2_log_red_agents_melted$tick==225|Facility_B_z4_load_2_log_red_agents_melted$tick==393|Facility_B_z4_load_2_log_red_agents_melted$tick==561|Facility_B_z4_load_2_log_red_agents_melted$tick==729|Facility_B_z4_load_2_log_red_agents_melted$tick==897|Facility_B_z4_load_2_log_red_agents_melted$tick==1065|Facility_B_z4_load_2_log_red_agents_melted$tick==1233),]

Facility_B_z4_load_2_log_red_agents_melted_wednesday_preop <- Facility_B_z4_load_2_log_red_agents_melted[which(Facility_B_z4_load_2_log_red_agents_melted$tick==81|Facility_B_z4_load_2_log_red_agents_melted$tick==249|Facility_B_z4_load_2_log_red_agents_melted$tick==417|Facility_B_z4_load_2_log_red_agents_melted$tick==585|Facility_B_z4_load_2_log_red_agents_melted$tick==753|Facility_B_z4_load_2_log_red_agents_melted$tick==921|Facility_B_z4_load_2_log_red_agents_melted$tick==1089|Facility_B_z4_load_2_log_red_agents_melted$tick==1257),]

Facility_B_z4_load_2_log_red_agents_melted_thursday_preop <- Facility_B_z4_load_2_log_red_agents_melted[which(Facility_B_z4_load_2_log_red_agents_melted$tick==105|Facility_B_z4_load_2_log_red_agents_melted$tick==273|Facility_B_z4_load_2_log_red_agents_melted$tick==441|Facility_B_z4_load_2_log_red_agents_melted$tick==609|Facility_B_z4_load_2_log_red_agents_melted$tick==777|Facility_B_z4_load_2_log_red_agents_melted$tick==945|Facility_B_z4_load_2_log_red_agents_melted$tick==1113|Facility_B_z4_load_2_log_red_agents_melted$tick==1281),]

Facility_B_z4_load_2_log_red_agents_melted_friday_preop <- Facility_B_z4_load_2_log_red_agents_melted[which(Facility_B_z4_load_2_log_red_agents_melted$tick==129|Facility_B_z4_load_2_log_red_agents_melted$tick==297|Facility_B_z4_load_2_log_red_agents_melted$tick==465|Facility_B_z4_load_2_log_red_agents_melted$tick==633|Facility_B_z4_load_2_log_red_agents_melted$tick==801|Facility_B_z4_load_2_log_red_agents_melted$tick==969|Facility_B_z4_load_2_log_red_agents_melted$tick==1137|Facility_B_z4_load_2_log_red_agents_melted$tick==1305),]

Facility_B_z4_load_2_log_red_agents_melted_ff <- as.ffdf(Facility_B_z4_load_2_log_red_agents_melted)
rm(Facility_B_z4_load_2_log_red_agents_melted)
gc()
```

```{r import Z4 Load 3 Log Reduction}
NL_table_Z4_Load_3_Log_Red <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-26-16-09 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_Z4_Load_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Z4_Load_3_Log_Red <- NL_table_Z4_Load_3_Log_Red[NL_table_Z4_Load_3_Log_Red$scenario==17,]

while (any(grepl('-', names(NL_table_Z4_Load_3_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_3_Log_Red <- NL_table_Z4_Load_3_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Z4_Load_3_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_3_Log_Red <- NL_table_Z4_Load_3_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Z4_Load_3_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_3_Log_Red <- NL_table_Z4_Load_3_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Z4_Load_3_Log_Red), fixed = TRUE))) {
  NL_table_Z4_Load_3_Log_Red <- NL_table_Z4_Load_3_Log_Red %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Z4_Load_3_Log_Red[ , ..list_columns]

NL_table_Z4_Load_3_Log_Red[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Z4_Load_3_Log_Red <- as.data.frame(NL_table_Z4_Load_3_Log_Red)

NL_table_Z4_Load_3_Log_Red[NL_table_Z4_Load_3_Log_Red==-1] <- NA

NL_table_Z4_Load_3_Log_Red <- subset(NL_table_Z4_Load_3_Log_Red, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Z4_Load_3_Log_Red)[names(NL_table_Z4_Load_3_Log_Red)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Z4_Load_3_Log_Red)[names(NL_table_Z4_Load_3_Log_Red)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Z4_Load_3_Log_Red$loading_w1wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_loading_w1wed_conc_list <- append(z4_load_3_log_red_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_loading_w1wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_cleaning_w1wed_conc_list <- append(z4_load_3_log_red_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_cleaning_w1wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_3_Log_Red$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_3_log_red_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_3_log_red_drying_w1wed_conc_list <- append(z4_load_3_log_red_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_3_Log_Red$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_sorting_w1wed_conc_list <- append(z4_load_3_log_red_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_sorting_w1wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_tray_packing_w1wed_conc_list <- append(z4_load_3_log_red_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_tray_packing_w1wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$reject_w1wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_reject_w1wed_conc_list <- append(z4_load_3_log_red_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_reject_w1wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$other_w1wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_other_w1wed_conc_list <- append(z4_load_3_log_red_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_other_w1wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_3_log_red_loading_concs <- as.data.frame(z4_load_3_log_red_loading_w1wed_conc_list)
z4_load_3_log_red_loading_concs$area <- as.factor('loading')
z4_load_3_log_red_loading_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_3_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_cleaning_concs <- as.data.frame(z4_load_3_log_red_cleaning_w1wed_conc_list)
z4_load_3_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_3_log_red_cleaning_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_3_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_sorting_concs <- as.data.frame(z4_load_3_log_red_sorting_w1wed_conc_list)
z4_load_3_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_3_log_red_sorting_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_reject_concs <- as.data.frame(z4_load_3_log_red_reject_w1wed_conc_list)
z4_load_3_log_red_reject_concs$area <- as.factor('reject')
z4_load_3_log_red_reject_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_tray_packing_concs <- as.data.frame(z4_load_3_log_red_tray_packing_w1wed_conc_list)
z4_load_3_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_3_log_red_tray_packing_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_other_concs <- as.data.frame(z4_load_3_log_red_other_w1wed_conc_list)
z4_load_3_log_red_other_concs$area <- as.factor('other')
z4_load_3_log_red_other_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_w1wed_concs <- rbind(z4_load_3_log_red_loading_concs,z4_load_3_log_red_cleaning_concs,z4_load_3_log_red_sorting_concs,z4_load_3_log_red_tray_packing_concs,z4_load_3_log_red_reject_concs,z4_load_3_log_red_other_concs)

z4_load_3_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$loading_w1wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_loading_prev$area <- as.factor('loading')
z4_load_3_log_red_loading_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$cleaning_w1wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_3_log_red_cleaning_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$sorting_w1wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_3_log_red_sorting_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$reject_w1wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_reject_prev$area <- as.factor('reject')
z4_load_3_log_red_reject_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$tray_packing_w1wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_3_log_red_tray_packing_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$other_w1wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_other_prev$area <- as.factor('other')
z4_load_3_log_red_other_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_w1wed_prev <- rbind(z4_load_3_log_red_loading_prev,z4_load_3_log_red_cleaning_prev,z4_load_3_log_red_sorting_prev,z4_load_3_log_red_tray_packing_prev,z4_load_3_log_red_reject_prev,z4_load_3_log_red_other_prev)

z4_load_3_log_red_w1wed_wet_prev <- as.data.frame(z4_load_3_log_red_loading_prev$prevalence*21/100+z4_load_3_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_3_log_red_w1wed_wet_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_w1wed_wet_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_w1wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_3_log_red_w1wed_dry_prev <- as.data.frame(z4_load_3_log_red_sorting_prev$prevalence*20/100+z4_load_3_log_red_reject_prev$prevalence*23/100+z4_load_3_log_red_tray_packing_prev$prevalence*123/100+z4_load_3_log_red_other_prev$prevalence*10/100)/176*100
z4_load_3_log_red_w1wed_dry_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_w1wed_dry_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_w1wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_3_log_red_w1wed_recombined_prev <- rbind(z4_load_3_log_red_w1wed_wet_prev, z4_load_3_log_red_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Z4_Load_3_Log_Red$loading_w2wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_loading_w2wed_conc_list <- append(z4_load_3_log_red_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_loading_w2wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_cleaning_w2wed_conc_list <- append(z4_load_3_log_red_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_cleaning_w2wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_3_Log_Red$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_3_log_red_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_3_log_red_drying_w2wed_conc_list <- append(z4_load_3_log_red_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_3_Log_Red$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_sorting_w2wed_conc_list <- append(z4_load_3_log_red_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_sorting_w2wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_tray_packing_w2wed_conc_list <- append(z4_load_3_log_red_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_tray_packing_w2wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$reject_w2wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_reject_w2wed_conc_list <- append(z4_load_3_log_red_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_reject_w2wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$other_w2wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_other_w2wed_conc_list <- append(z4_load_3_log_red_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_other_w2wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_3_log_red_loading_concs <- as.data.frame(z4_load_3_log_red_loading_w2wed_conc_list)
z4_load_3_log_red_loading_concs$area <- as.factor('loading')
z4_load_3_log_red_loading_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_3_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_cleaning_concs <- as.data.frame(z4_load_3_log_red_cleaning_w2wed_conc_list)
z4_load_3_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_3_log_red_cleaning_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_3_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_sorting_concs <- as.data.frame(z4_load_3_log_red_sorting_w2wed_conc_list)
z4_load_3_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_3_log_red_sorting_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_reject_concs <- as.data.frame(z4_load_3_log_red_reject_w2wed_conc_list)
z4_load_3_log_red_reject_concs$area <- as.factor('reject')
z4_load_3_log_red_reject_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_tray_packing_concs <- as.data.frame(z4_load_3_log_red_tray_packing_w2wed_conc_list)
z4_load_3_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_3_log_red_tray_packing_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_other_concs <- as.data.frame(z4_load_3_log_red_other_w2wed_conc_list)
z4_load_3_log_red_other_concs$area <- as.factor('other')
z4_load_3_log_red_other_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_w2wed_concs <- rbind(z4_load_3_log_red_loading_concs,z4_load_3_log_red_cleaning_concs,z4_load_3_log_red_sorting_concs,z4_load_3_log_red_tray_packing_concs,z4_load_3_log_red_reject_concs,z4_load_3_log_red_other_concs)

z4_load_3_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$loading_w2wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_loading_prev$area <- as.factor('loading')
z4_load_3_log_red_loading_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$cleaning_w2wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_3_log_red_cleaning_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$sorting_w2wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_3_log_red_sorting_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$reject_w2wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_reject_prev$area <- as.factor('reject')
z4_load_3_log_red_reject_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$tray_packing_w2wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_3_log_red_tray_packing_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$other_w2wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_other_prev$area <- as.factor('other')
z4_load_3_log_red_other_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_w2wed_prev <- rbind(z4_load_3_log_red_loading_prev,z4_load_3_log_red_cleaning_prev,z4_load_3_log_red_sorting_prev,z4_load_3_log_red_tray_packing_prev,z4_load_3_log_red_reject_prev,z4_load_3_log_red_other_prev)

z4_load_3_log_red_w2wed_wet_prev <- as.data.frame(z4_load_3_log_red_loading_prev$prevalence*21/100+z4_load_3_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_3_log_red_w2wed_wet_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_w2wed_wet_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_w2wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_3_log_red_w2wed_dry_prev <- as.data.frame(z4_load_3_log_red_sorting_prev$prevalence*20/100+z4_load_3_log_red_reject_prev$prevalence*23/100+z4_load_3_log_red_tray_packing_prev$prevalence*123/100+z4_load_3_log_red_other_prev$prevalence*10/100)/176*100
z4_load_3_log_red_w2wed_dry_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_w2wed_dry_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_w2wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_3_log_red_w2wed_recombined_prev <- rbind(z4_load_3_log_red_w2wed_wet_prev, z4_load_3_log_red_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Z4_Load_3_Log_Red$loading_w3wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_loading_w3wed_conc_list <- append(z4_load_3_log_red_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_loading_w3wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_cleaning_w3wed_conc_list <- append(z4_load_3_log_red_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_cleaning_w3wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_3_Log_Red$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_3_log_red_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_3_log_red_drying_w3wed_conc_list <- append(z4_load_3_log_red_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_3_Log_Red$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_sorting_w3wed_conc_list <- append(z4_load_3_log_red_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_sorting_w3wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_tray_packing_w3wed_conc_list <- append(z4_load_3_log_red_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_tray_packing_w3wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$reject_w3wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_reject_w3wed_conc_list <- append(z4_load_3_log_red_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_reject_w3wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$other_w3wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_other_w3wed_conc_list <- append(z4_load_3_log_red_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_other_w3wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_3_log_red_loading_concs <- as.data.frame(z4_load_3_log_red_loading_w3wed_conc_list)
z4_load_3_log_red_loading_concs$area <- as.factor('loading')
z4_load_3_log_red_loading_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_3_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_cleaning_concs <- as.data.frame(z4_load_3_log_red_cleaning_w3wed_conc_list)
z4_load_3_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_3_log_red_cleaning_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_3_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_sorting_concs <- as.data.frame(z4_load_3_log_red_sorting_w3wed_conc_list)
z4_load_3_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_3_log_red_sorting_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_reject_concs <- as.data.frame(z4_load_3_log_red_reject_w3wed_conc_list)
z4_load_3_log_red_reject_concs$area <- as.factor('reject')
z4_load_3_log_red_reject_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_tray_packing_concs <- as.data.frame(z4_load_3_log_red_tray_packing_w3wed_conc_list)
z4_load_3_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_3_log_red_tray_packing_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_other_concs <- as.data.frame(z4_load_3_log_red_other_w3wed_conc_list)
z4_load_3_log_red_other_concs$area <- as.factor('other')
z4_load_3_log_red_other_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_w3wed_concs <- rbind(z4_load_3_log_red_loading_concs,z4_load_3_log_red_cleaning_concs,z4_load_3_log_red_sorting_concs,z4_load_3_log_red_tray_packing_concs,z4_load_3_log_red_reject_concs,z4_load_3_log_red_other_concs)

z4_load_3_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$loading_w3wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_loading_prev$area <- as.factor('loading')
z4_load_3_log_red_loading_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$cleaning_w3wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_3_log_red_cleaning_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$sorting_w3wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_3_log_red_sorting_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$reject_w3wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_reject_prev$area <- as.factor('reject')
z4_load_3_log_red_reject_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$tray_packing_w3wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_3_log_red_tray_packing_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$other_w3wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_other_prev$area <- as.factor('other')
z4_load_3_log_red_other_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_w3wed_prev <- rbind(z4_load_3_log_red_loading_prev,z4_load_3_log_red_cleaning_prev,z4_load_3_log_red_sorting_prev,z4_load_3_log_red_tray_packing_prev,z4_load_3_log_red_reject_prev,z4_load_3_log_red_other_prev)

z4_load_3_log_red_w3wed_wet_prev <- as.data.frame(z4_load_3_log_red_loading_prev$prevalence*21/100+z4_load_3_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_3_log_red_w3wed_wet_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_w3wed_wet_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_w3wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_3_log_red_w3wed_dry_prev <- as.data.frame(z4_load_3_log_red_sorting_prev$prevalence*20/100+z4_load_3_log_red_reject_prev$prevalence*23/100+z4_load_3_log_red_tray_packing_prev$prevalence*123/100+z4_load_3_log_red_other_prev$prevalence*10/100)/176*100
z4_load_3_log_red_w3wed_dry_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_w3wed_dry_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_w3wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_3_log_red_w3wed_recombined_prev <- rbind(z4_load_3_log_red_w3wed_wet_prev, z4_load_3_log_red_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Z4_Load_3_Log_Red$loading_w4wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_loading_w4wed_conc_list <- append(z4_load_3_log_red_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_loading_w4wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_cleaning_w4wed_conc_list <- append(z4_load_3_log_red_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_cleaning_w4wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_3_Log_Red$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_3_log_red_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_3_log_red_drying_w4wed_conc_list <- append(z4_load_3_log_red_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_3_Log_Red$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_sorting_w4wed_conc_list <- append(z4_load_3_log_red_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_sorting_w4wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_tray_packing_w4wed_conc_list <- append(z4_load_3_log_red_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_tray_packing_w4wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$reject_w4wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_reject_w4wed_conc_list <- append(z4_load_3_log_red_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_reject_w4wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$other_w4wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_other_w4wed_conc_list <- append(z4_load_3_log_red_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_other_w4wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_3_log_red_loading_concs <- as.data.frame(z4_load_3_log_red_loading_w4wed_conc_list)
z4_load_3_log_red_loading_concs$area <- as.factor('loading')
z4_load_3_log_red_loading_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_3_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_cleaning_concs <- as.data.frame(z4_load_3_log_red_cleaning_w4wed_conc_list)
z4_load_3_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_3_log_red_cleaning_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_3_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_sorting_concs <- as.data.frame(z4_load_3_log_red_sorting_w4wed_conc_list)
z4_load_3_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_3_log_red_sorting_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_reject_concs <- as.data.frame(z4_load_3_log_red_reject_w4wed_conc_list)
z4_load_3_log_red_reject_concs$area <- as.factor('reject')
z4_load_3_log_red_reject_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_tray_packing_concs <- as.data.frame(z4_load_3_log_red_tray_packing_w4wed_conc_list)
z4_load_3_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_3_log_red_tray_packing_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_other_concs <- as.data.frame(z4_load_3_log_red_other_w4wed_conc_list)
z4_load_3_log_red_other_concs$area <- as.factor('other')
z4_load_3_log_red_other_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_w4wed_concs <- rbind(z4_load_3_log_red_loading_concs,z4_load_3_log_red_cleaning_concs,z4_load_3_log_red_sorting_concs,z4_load_3_log_red_tray_packing_concs,z4_load_3_log_red_reject_concs,z4_load_3_log_red_other_concs)

z4_load_3_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$loading_w4wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_loading_prev$area <- as.factor('loading')
z4_load_3_log_red_loading_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$cleaning_w4wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_3_log_red_cleaning_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$sorting_w4wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_3_log_red_sorting_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$reject_w4wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_reject_prev$area <- as.factor('reject')
z4_load_3_log_red_reject_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$tray_packing_w4wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_3_log_red_tray_packing_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$other_w4wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_other_prev$area <- as.factor('other')
z4_load_3_log_red_other_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_w4wed_prev <- rbind(z4_load_3_log_red_loading_prev,z4_load_3_log_red_cleaning_prev,z4_load_3_log_red_sorting_prev,z4_load_3_log_red_tray_packing_prev,z4_load_3_log_red_reject_prev,z4_load_3_log_red_other_prev)

z4_load_3_log_red_w4wed_wet_prev <- as.data.frame(z4_load_3_log_red_loading_prev$prevalence*21/100+z4_load_3_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_3_log_red_w4wed_wet_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_w4wed_wet_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_w4wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_3_log_red_w4wed_dry_prev <- as.data.frame(z4_load_3_log_red_sorting_prev$prevalence*20/100+z4_load_3_log_red_reject_prev$prevalence*23/100+z4_load_3_log_red_tray_packing_prev$prevalence*123/100+z4_load_3_log_red_other_prev$prevalence*10/100)/176*100
z4_load_3_log_red_w4wed_dry_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_w4wed_dry_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_w4wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_3_log_red_w4wed_recombined_prev <- rbind(z4_load_3_log_red_w4wed_wet_prev, z4_load_3_log_red_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Z4_Load_3_Log_Red$loading_w5wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_loading_w5wed_conc_list <- append(z4_load_3_log_red_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_loading_w5wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_cleaning_w5wed_conc_list <- append(z4_load_3_log_red_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_cleaning_w5wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_3_Log_Red$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_3_log_red_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_3_log_red_drying_w5wed_conc_list <- append(z4_load_3_log_red_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_3_Log_Red$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_sorting_w5wed_conc_list <- append(z4_load_3_log_red_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_sorting_w5wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_tray_packing_w5wed_conc_list <- append(z4_load_3_log_red_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_tray_packing_w5wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$reject_w5wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_reject_w5wed_conc_list <- append(z4_load_3_log_red_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_reject_w5wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$other_w5wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_other_w5wed_conc_list <- append(z4_load_3_log_red_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_other_w5wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_3_log_red_loading_concs <- as.data.frame(z4_load_3_log_red_loading_w5wed_conc_list)
z4_load_3_log_red_loading_concs$area <- as.factor('loading')
z4_load_3_log_red_loading_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_3_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_cleaning_concs <- as.data.frame(z4_load_3_log_red_cleaning_w5wed_conc_list)
z4_load_3_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_3_log_red_cleaning_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_3_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_sorting_concs <- as.data.frame(z4_load_3_log_red_sorting_w5wed_conc_list)
z4_load_3_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_3_log_red_sorting_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_reject_concs <- as.data.frame(z4_load_3_log_red_reject_w5wed_conc_list)
z4_load_3_log_red_reject_concs$area <- as.factor('reject')
z4_load_3_log_red_reject_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_tray_packing_concs <- as.data.frame(z4_load_3_log_red_tray_packing_w5wed_conc_list)
z4_load_3_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_3_log_red_tray_packing_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_other_concs <- as.data.frame(z4_load_3_log_red_other_w5wed_conc_list)
z4_load_3_log_red_other_concs$area <- as.factor('other')
z4_load_3_log_red_other_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_w5wed_concs <- rbind(z4_load_3_log_red_loading_concs,z4_load_3_log_red_cleaning_concs,z4_load_3_log_red_sorting_concs,z4_load_3_log_red_tray_packing_concs,z4_load_3_log_red_reject_concs,z4_load_3_log_red_other_concs)

z4_load_3_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$loading_w5wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_loading_prev$area <- as.factor('loading')
z4_load_3_log_red_loading_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$cleaning_w5wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_3_log_red_cleaning_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$sorting_w5wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_3_log_red_sorting_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$reject_w5wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_reject_prev$area <- as.factor('reject')
z4_load_3_log_red_reject_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$tray_packing_w5wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_3_log_red_tray_packing_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$other_w5wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_other_prev$area <- as.factor('other')
z4_load_3_log_red_other_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_w5wed_prev <- rbind(z4_load_3_log_red_loading_prev,z4_load_3_log_red_cleaning_prev,z4_load_3_log_red_sorting_prev,z4_load_3_log_red_tray_packing_prev,z4_load_3_log_red_reject_prev,z4_load_3_log_red_other_prev)

z4_load_3_log_red_w5wed_wet_prev <- as.data.frame(z4_load_3_log_red_loading_prev$prevalence*21/100+z4_load_3_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_3_log_red_w5wed_wet_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_w5wed_wet_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_w5wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_3_log_red_w5wed_dry_prev <- as.data.frame(z4_load_3_log_red_sorting_prev$prevalence*20/100+z4_load_3_log_red_reject_prev$prevalence*23/100+z4_load_3_log_red_tray_packing_prev$prevalence*123/100+z4_load_3_log_red_other_prev$prevalence*10/100)/176*100
z4_load_3_log_red_w5wed_dry_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_w5wed_dry_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_w5wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_3_log_red_w5wed_recombined_prev <- rbind(z4_load_3_log_red_w5wed_wet_prev, z4_load_3_log_red_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Z4_Load_3_Log_Red$loading_w6wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_loading_w6wed_conc_list <- append(z4_load_3_log_red_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_loading_w6wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_cleaning_w6wed_conc_list <- append(z4_load_3_log_red_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_cleaning_w6wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_3_Log_Red$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_3_log_red_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_3_log_red_drying_w6wed_conc_list <- append(z4_load_3_log_red_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_3_Log_Red$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_sorting_w6wed_conc_list <- append(z4_load_3_log_red_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_sorting_w6wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_tray_packing_w6wed_conc_list <- append(z4_load_3_log_red_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_tray_packing_w6wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$reject_w6wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_reject_w6wed_conc_list <- append(z4_load_3_log_red_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_reject_w6wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$other_w6wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_other_w6wed_conc_list <- append(z4_load_3_log_red_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_other_w6wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_3_log_red_loading_concs <- as.data.frame(z4_load_3_log_red_loading_w6wed_conc_list)
z4_load_3_log_red_loading_concs$area <- as.factor('loading')
z4_load_3_log_red_loading_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_3_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_cleaning_concs <- as.data.frame(z4_load_3_log_red_cleaning_w6wed_conc_list)
z4_load_3_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_3_log_red_cleaning_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_3_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_sorting_concs <- as.data.frame(z4_load_3_log_red_sorting_w6wed_conc_list)
z4_load_3_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_3_log_red_sorting_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_reject_concs <- as.data.frame(z4_load_3_log_red_reject_w6wed_conc_list)
z4_load_3_log_red_reject_concs$area <- as.factor('reject')
z4_load_3_log_red_reject_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_tray_packing_concs <- as.data.frame(z4_load_3_log_red_tray_packing_w6wed_conc_list)
z4_load_3_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_3_log_red_tray_packing_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_other_concs <- as.data.frame(z4_load_3_log_red_other_w6wed_conc_list)
z4_load_3_log_red_other_concs$area <- as.factor('other')
z4_load_3_log_red_other_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_w6wed_concs <- rbind(z4_load_3_log_red_loading_concs,z4_load_3_log_red_cleaning_concs,z4_load_3_log_red_sorting_concs,z4_load_3_log_red_tray_packing_concs,z4_load_3_log_red_reject_concs,z4_load_3_log_red_other_concs)

z4_load_3_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$loading_w6wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_loading_prev$area <- as.factor('loading')
z4_load_3_log_red_loading_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$cleaning_w6wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_3_log_red_cleaning_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$sorting_w6wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_3_log_red_sorting_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$reject_w6wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_reject_prev$area <- as.factor('reject')
z4_load_3_log_red_reject_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$tray_packing_w6wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_3_log_red_tray_packing_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$other_w6wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_other_prev$area <- as.factor('other')
z4_load_3_log_red_other_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_w6wed_prev <- rbind(z4_load_3_log_red_loading_prev,z4_load_3_log_red_cleaning_prev,z4_load_3_log_red_sorting_prev,z4_load_3_log_red_tray_packing_prev,z4_load_3_log_red_reject_prev,z4_load_3_log_red_other_prev)

z4_load_3_log_red_w6wed_wet_prev <- as.data.frame(z4_load_3_log_red_loading_prev$prevalence*21/100+z4_load_3_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_3_log_red_w6wed_wet_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_w6wed_wet_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_w6wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_3_log_red_w6wed_dry_prev <- as.data.frame(z4_load_3_log_red_sorting_prev$prevalence*20/100+z4_load_3_log_red_reject_prev$prevalence*23/100+z4_load_3_log_red_tray_packing_prev$prevalence*123/100+z4_load_3_log_red_other_prev$prevalence*10/100)/176*100
z4_load_3_log_red_w6wed_dry_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_w6wed_dry_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_w6wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_3_log_red_w6wed_recombined_prev <- rbind(z4_load_3_log_red_w6wed_wet_prev, z4_load_3_log_red_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Z4_Load_3_Log_Red$loading_w7wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_loading_w7wed_conc_list <- append(z4_load_3_log_red_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_loading_w7wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_cleaning_w7wed_conc_list <- append(z4_load_3_log_red_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_cleaning_w7wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_3_Log_Red$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_3_log_red_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_3_log_red_drying_w7wed_conc_list <- append(z4_load_3_log_red_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_3_Log_Red$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_sorting_w7wed_conc_list <- append(z4_load_3_log_red_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_sorting_w7wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_tray_packing_w7wed_conc_list <- append(z4_load_3_log_red_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_tray_packing_w7wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$reject_w7wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_reject_w7wed_conc_list <- append(z4_load_3_log_red_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_reject_w7wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$other_w7wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_other_w7wed_conc_list <- append(z4_load_3_log_red_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_other_w7wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_3_log_red_loading_concs <- as.data.frame(z4_load_3_log_red_loading_w7wed_conc_list)
z4_load_3_log_red_loading_concs$area <- as.factor('loading')
z4_load_3_log_red_loading_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_3_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_cleaning_concs <- as.data.frame(z4_load_3_log_red_cleaning_w7wed_conc_list)
z4_load_3_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_3_log_red_cleaning_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_3_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_sorting_concs <- as.data.frame(z4_load_3_log_red_sorting_w7wed_conc_list)
z4_load_3_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_3_log_red_sorting_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_reject_concs <- as.data.frame(z4_load_3_log_red_reject_w7wed_conc_list)
z4_load_3_log_red_reject_concs$area <- as.factor('reject')
z4_load_3_log_red_reject_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_tray_packing_concs <- as.data.frame(z4_load_3_log_red_tray_packing_w7wed_conc_list)
z4_load_3_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_3_log_red_tray_packing_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_other_concs <- as.data.frame(z4_load_3_log_red_other_w7wed_conc_list)
z4_load_3_log_red_other_concs$area <- as.factor('other')
z4_load_3_log_red_other_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_w7wed_concs <- rbind(z4_load_3_log_red_loading_concs,z4_load_3_log_red_cleaning_concs,z4_load_3_log_red_sorting_concs,z4_load_3_log_red_tray_packing_concs,z4_load_3_log_red_reject_concs,z4_load_3_log_red_other_concs)

z4_load_3_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$loading_w7wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_loading_prev$area <- as.factor('loading')
z4_load_3_log_red_loading_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$cleaning_w7wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_3_log_red_cleaning_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$sorting_w7wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_3_log_red_sorting_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$reject_w7wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_reject_prev$area <- as.factor('reject')
z4_load_3_log_red_reject_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$tray_packing_w7wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_3_log_red_tray_packing_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$other_w7wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_other_prev$area <- as.factor('other')
z4_load_3_log_red_other_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_w7wed_prev <- rbind(z4_load_3_log_red_loading_prev,z4_load_3_log_red_cleaning_prev,z4_load_3_log_red_sorting_prev,z4_load_3_log_red_tray_packing_prev,z4_load_3_log_red_reject_prev,z4_load_3_log_red_other_prev)

z4_load_3_log_red_w7wed_wet_prev <- as.data.frame(z4_load_3_log_red_loading_prev$prevalence*21/100+z4_load_3_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_3_log_red_w7wed_wet_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_w7wed_wet_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_w7wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_3_log_red_w7wed_dry_prev <- as.data.frame(z4_load_3_log_red_sorting_prev$prevalence*20/100+z4_load_3_log_red_reject_prev$prevalence*23/100+z4_load_3_log_red_tray_packing_prev$prevalence*123/100+z4_load_3_log_red_other_prev$prevalence*10/100)/176*100
z4_load_3_log_red_w7wed_dry_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_w7wed_dry_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_w7wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_3_log_red_w7wed_recombined_prev <- rbind(z4_load_3_log_red_w7wed_wet_prev, z4_load_3_log_red_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Z4_Load_3_Log_Red$loading_w8wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_loading_w8wed_conc_list <- append(z4_load_3_log_red_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_loading_w8wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_cleaning_w8wed_conc_list <- append(z4_load_3_log_red_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_cleaning_w8wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Load_3_Log_Red$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# z4_load_3_log_red_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_load_3_log_red_drying_w8wed_conc_list <- append(z4_load_3_log_red_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Load_3_Log_Red$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_sorting_w8wed_conc_list <- append(z4_load_3_log_red_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_sorting_w8wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_tray_packing_w8wed_conc_list <- append(z4_load_3_log_red_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_tray_packing_w8wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$reject_w8wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_reject_w8wed_conc_list <- append(z4_load_3_log_red_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_reject_w8wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Load_3_Log_Red$other_w8wed_conc_list
vector <- vector[vector!='[]']
z4_load_3_log_red_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_load_3_log_red_other_w8wed_conc_list <- append(z4_load_3_log_red_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_load_3_log_red_other_w8wed_conc_matrix <- matrix(unlist(z4_load_3_log_red_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

z4_load_3_log_red_loading_concs <- as.data.frame(z4_load_3_log_red_loading_w8wed_conc_list)
z4_load_3_log_red_loading_concs$area <- as.factor('loading')
z4_load_3_log_red_loading_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_loading_concs$water <- as.factor('Wet')
names(z4_load_3_log_red_loading_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_cleaning_concs <- as.data.frame(z4_load_3_log_red_cleaning_w8wed_conc_list)
z4_load_3_log_red_cleaning_concs$area <- as.factor('cleaning')
z4_load_3_log_red_cleaning_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_cleaning_concs$water <- as.factor('Wet')
names(z4_load_3_log_red_cleaning_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_sorting_concs <- as.data.frame(z4_load_3_log_red_sorting_w8wed_conc_list)
z4_load_3_log_red_sorting_concs$area <- as.factor('sorting')
z4_load_3_log_red_sorting_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_sorting_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_sorting_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_reject_concs <- as.data.frame(z4_load_3_log_red_reject_w8wed_conc_list)
z4_load_3_log_red_reject_concs$area <- as.factor('reject')
z4_load_3_log_red_reject_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_reject_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_reject_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_tray_packing_concs <- as.data.frame(z4_load_3_log_red_tray_packing_w8wed_conc_list)
z4_load_3_log_red_tray_packing_concs$area <- as.factor('tray packing')
z4_load_3_log_red_tray_packing_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_tray_packing_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_other_concs <- as.data.frame(z4_load_3_log_red_other_w8wed_conc_list)
z4_load_3_log_red_other_concs$area <- as.factor('other')
z4_load_3_log_red_other_concs$scenario <- as.factor('LZ_03')
z4_load_3_log_red_other_concs$water <- as.factor('Dry')
names(z4_load_3_log_red_other_concs) <- c('concentration','area','scenario','water')

z4_load_3_log_red_w8wed_concs <- rbind(z4_load_3_log_red_loading_concs,z4_load_3_log_red_cleaning_concs,z4_load_3_log_red_sorting_concs,z4_load_3_log_red_tray_packing_concs,z4_load_3_log_red_reject_concs,z4_load_3_log_red_other_concs)

z4_load_3_log_red_loading_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$loading_w8wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_loading_prev$area <- as.factor('loading')
z4_load_3_log_red_loading_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_loading_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_loading_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_cleaning_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$cleaning_w8wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_cleaning_prev$area <- as.factor('cleaning')
z4_load_3_log_red_cleaning_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_cleaning_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_sorting_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$sorting_w8wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_sorting_prev$area <- as.factor('sorting')
z4_load_3_log_red_sorting_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_sorting_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_sorting_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_reject_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$reject_w8wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_reject_prev$area <- as.factor('reject')
z4_load_3_log_red_reject_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_reject_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_reject_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_tray_packing_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$tray_packing_w8wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_tray_packing_prev$area <- as.factor('tray packing')
z4_load_3_log_red_tray_packing_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_tray_packing_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_other_prev <- as.data.frame(NL_table_Z4_Load_3_Log_Red$other_w8wed_prev[order(NL_table_Z4_Load_3_Log_Red$local_seed)])
z4_load_3_log_red_other_prev$area <- as.factor('other')
z4_load_3_log_red_other_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_other_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_other_prev) <- c('prevalence','area','scenario','water')

z4_load_3_log_red_w8wed_prev <- rbind(z4_load_3_log_red_loading_prev,z4_load_3_log_red_cleaning_prev,z4_load_3_log_red_sorting_prev,z4_load_3_log_red_tray_packing_prev,z4_load_3_log_red_reject_prev,z4_load_3_log_red_other_prev)

z4_load_3_log_red_w8wed_wet_prev <- as.data.frame(z4_load_3_log_red_loading_prev$prevalence*21/100+z4_load_3_log_red_cleaning_prev$prevalence*28/100)/49*100
z4_load_3_log_red_w8wed_wet_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_w8wed_wet_prev$water <- as.factor('Wet')
names(z4_load_3_log_red_w8wed_wet_prev) <- c('prevalence','scenario','water')

z4_load_3_log_red_w8wed_dry_prev <- as.data.frame(z4_load_3_log_red_sorting_prev$prevalence*20/100+z4_load_3_log_red_reject_prev$prevalence*23/100+z4_load_3_log_red_tray_packing_prev$prevalence*123/100+z4_load_3_log_red_other_prev$prevalence*10/100)/176*100
z4_load_3_log_red_w8wed_dry_prev$scenario <- as.factor('LZ_03')
z4_load_3_log_red_w8wed_dry_prev$water <- as.factor('Dry')
names(z4_load_3_log_red_w8wed_dry_prev) <- c('prevalence','scenario','water')

z4_load_3_log_red_w8wed_recombined_prev <- rbind(z4_load_3_log_red_w8wed_wet_prev, z4_load_3_log_red_w8wed_dry_prev)

vector <- NL_table_Z4_Load_3_Log_Red$lifetime_conc_list[order(NL_table_Z4_Load_3_Log_Red$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

z4_load_3_log_red_w1wed_recombined_prev$week <- as.factor(1)
z4_load_3_log_red_w2wed_recombined_prev$week <- as.factor(2)
z4_load_3_log_red_w3wed_recombined_prev$week <- as.factor(3)
z4_load_3_log_red_w4wed_recombined_prev$week <- as.factor(4)
z4_load_3_log_red_w5wed_recombined_prev$week <- as.factor(5)
z4_load_3_log_red_w6wed_recombined_prev$week <- as.factor(6)
z4_load_3_log_red_w7wed_recombined_prev$week <- as.factor(7)
z4_load_3_log_red_w8wed_recombined_prev$week <- as.factor(8)
z4_load_3_log_red_allwed_prev <- rbind(z4_load_3_log_red_w1wed_recombined_prev,z4_load_3_log_red_w2wed_recombined_prev,z4_load_3_log_red_w3wed_recombined_prev,z4_load_3_log_red_w4wed_recombined_prev,z4_load_3_log_red_w5wed_recombined_prev,z4_load_3_log_red_w6wed_recombined_prev,z4_load_3_log_red_w7wed_recombined_prev,z4_load_3_log_red_w8wed_recombined_prev)

Facility_B_z4_load_3_log_red_agents_melted <- melt(mdarray)
colnames(Facility_B_z4_load_3_log_red_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_z4_load_3_log_red_agents_melted$agent <- Facility_B_z4_load_3_log_red_agents_melted$agent-1
Facility_B_z4_load_3_log_red_agents_melted$logical <- Facility_B_z4_load_3_log_red_agents_melted$value>0
Facility_B_z4_load_3_log_red_agents_melted$binary <- as.numeric(Facility_B_z4_load_3_log_red_agents_melted$logical)
Facility_B_z4_load_3_log_red_agents_melted$log10value <- log10(Facility_B_z4_load_3_log_red_agents_melted$value)
Facility_B_z4_load_3_log_red_agents_melted$log10value[is.infinite(Facility_B_z4_load_3_log_red_agents_melted$log10value)] <- 0

agent <- Facility_B_z4_load_3_log_red_agents_melted$agent
iteration <- Facility_B_z4_load_3_log_red_agents_melted$iteration
tick <- Facility_B_z4_load_3_log_red_agents_melted$tick
rle_matrix <- tapply(Facility_B_z4_load_3_log_red_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_z4_load_3_log_red_agents_melted_mean_value_matrix <- tapply(Facility_B_z4_load_3_log_red_agents_melted$value, list(agent, tick), mean)
Facility_B_z4_load_3_log_red_agents_melted_median_value_matrix <- tapply(Facility_B_z4_load_3_log_red_agents_melted$value, list(agent, tick), median)
Facility_B_z4_load_3_log_red_agents_melted_prob_value_matrix <- tapply(Facility_B_z4_load_3_log_red_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}
# durations$agent <- durations$agent-1

Facility_B_durations_z4_load_3_log_red <- durations

agents_list_z4_load_3_log_red <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_z4_load_3_log_red <- agents_list_z4_load_3_log_red[,c("V1","V7","V8","V9")]
colnames(agents_list_z4_load_3_log_red) <- c("name","sanitation_status","schedule","area")
agents_list_z4_load_3_log_red$ttp <- rep((168*2),225)
agents_list_z4_load_3_log_red$ttp[agents_list_z4_load_3_log_red$schedule=="daily"] <- (24*2)

agent <- 1
while(agent<=225) {
  agents_list_z4_load_3_log_red$min_duration[agent] <- ifelse(length(Facility_B_durations_z4_load_3_log_red$duration[Facility_B_durations_z4_load_3_log_red$agent==agent])==0,NA,min(Facility_B_durations_z4_load_3_log_red$duration[Facility_B_durations_z4_load_3_log_red$agent==agent], na.rm = TRUE))
  agents_list_z4_load_3_log_red$mean_duration[agent] <- ifelse(length(Facility_B_durations_z4_load_3_log_red$duration[Facility_B_durations_z4_load_3_log_red$agent==agent])==0,NA,mean(Facility_B_durations_z4_load_3_log_red$duration[Facility_B_durations_z4_load_3_log_red$agent==agent], na.rm = TRUE))
  agents_list_z4_load_3_log_red$median_duration[agent] <- ifelse(length(Facility_B_durations_z4_load_3_log_red$duration[Facility_B_durations_z4_load_3_log_red$agent==agent])==0,NA,median(Facility_B_durations_z4_load_3_log_red$duration[Facility_B_durations_z4_load_3_log_red$agent==agent], na.rm = TRUE))
  agents_list_z4_load_3_log_red$max_duration[agent] <- ifelse(length(Facility_B_durations_z4_load_3_log_red$duration[Facility_B_durations_z4_load_3_log_red$agent==agent])==0,NA,max(Facility_B_durations_z4_load_3_log_red$duration[Facility_B_durations_z4_load_3_log_red$agent==agent], na.rm = TRUE))
  agents_list_z4_load_3_log_red$times_persistent[agent] <- sum(Facility_B_durations_z4_load_3_log_red$duration[Facility_B_durations_z4_load_3_log_red$agent==agent]>agents_list_z4_load_3_log_red$ttp[agent])
  agent <- agent+1 
}

Facility_B_z4_load_3_log_red_agents_melted_monday_preop <- Facility_B_z4_load_3_log_red_agents_melted[which(Facility_B_z4_load_3_log_red_agents_melted$tick==33|Facility_B_z4_load_3_log_red_agents_melted$tick==201|Facility_B_z4_load_3_log_red_agents_melted$tick==369|Facility_B_z4_load_3_log_red_agents_melted$tick==537|Facility_B_z4_load_3_log_red_agents_melted$tick==705|Facility_B_z4_load_3_log_red_agents_melted$tick==873|Facility_B_z4_load_3_log_red_agents_melted$tick==1041|Facility_B_z4_load_3_log_red_agents_melted$tick==1209),]

Facility_B_z4_load_3_log_red_agents_melted_tuesday_preop <- Facility_B_z4_load_3_log_red_agents_melted[which(Facility_B_z4_load_3_log_red_agents_melted$tick==57|Facility_B_z4_load_3_log_red_agents_melted$tick==225|Facility_B_z4_load_3_log_red_agents_melted$tick==393|Facility_B_z4_load_3_log_red_agents_melted$tick==561|Facility_B_z4_load_3_log_red_agents_melted$tick==729|Facility_B_z4_load_3_log_red_agents_melted$tick==897|Facility_B_z4_load_3_log_red_agents_melted$tick==1065|Facility_B_z4_load_3_log_red_agents_melted$tick==1233),]

Facility_B_z4_load_3_log_red_agents_melted_wednesday_preop <- Facility_B_z4_load_3_log_red_agents_melted[which(Facility_B_z4_load_3_log_red_agents_melted$tick==81|Facility_B_z4_load_3_log_red_agents_melted$tick==249|Facility_B_z4_load_3_log_red_agents_melted$tick==417|Facility_B_z4_load_3_log_red_agents_melted$tick==585|Facility_B_z4_load_3_log_red_agents_melted$tick==753|Facility_B_z4_load_3_log_red_agents_melted$tick==921|Facility_B_z4_load_3_log_red_agents_melted$tick==1089|Facility_B_z4_load_3_log_red_agents_melted$tick==1257),]

Facility_B_z4_load_3_log_red_agents_melted_thursday_preop <- Facility_B_z4_load_3_log_red_agents_melted[which(Facility_B_z4_load_3_log_red_agents_melted$tick==105|Facility_B_z4_load_3_log_red_agents_melted$tick==273|Facility_B_z4_load_3_log_red_agents_melted$tick==441|Facility_B_z4_load_3_log_red_agents_melted$tick==609|Facility_B_z4_load_3_log_red_agents_melted$tick==777|Facility_B_z4_load_3_log_red_agents_melted$tick==945|Facility_B_z4_load_3_log_red_agents_melted$tick==1113|Facility_B_z4_load_3_log_red_agents_melted$tick==1281),]

Facility_B_z4_load_3_log_red_agents_melted_friday_preop <- Facility_B_z4_load_3_log_red_agents_melted[which(Facility_B_z4_load_3_log_red_agents_melted$tick==129|Facility_B_z4_load_3_log_red_agents_melted$tick==297|Facility_B_z4_load_3_log_red_agents_melted$tick==465|Facility_B_z4_load_3_log_red_agents_melted$tick==633|Facility_B_z4_load_3_log_red_agents_melted$tick==801|Facility_B_z4_load_3_log_red_agents_melted$tick==969|Facility_B_z4_load_3_log_red_agents_melted$tick==1137|Facility_B_z4_load_3_log_red_agents_melted$tick==1305),]

Facility_B_z4_load_3_log_red_agents_melted_ff <- as.ffdf(Facility_B_z4_load_3_log_red_agents_melted)
rm(Facility_B_z4_load_3_log_red_agents_melted)
gc()
```

```{r import Random Event Occurences 150% Delay Period}
NL_table_Random_Prob_150pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-28-13-09 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_P_Random_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Random_Prob_150pc <- NL_table_Random_Prob_150pc[NL_table_Random_Prob_150pc$scenario==31,]

while (any(grepl('-', names(NL_table_Random_Prob_150pc), fixed = TRUE))) {
  NL_table_Random_Prob_150pc <- NL_table_Random_Prob_150pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Random_Prob_150pc), fixed = TRUE))) {
  NL_table_Random_Prob_150pc <- NL_table_Random_Prob_150pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Random_Prob_150pc), fixed = TRUE))) {
  NL_table_Random_Prob_150pc <- NL_table_Random_Prob_150pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Random_Prob_150pc), fixed = TRUE))) {
  NL_table_Random_Prob_150pc <- NL_table_Random_Prob_150pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Random_Prob_150pc[ , ..list_columns]

NL_table_Random_Prob_150pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Random_Prob_150pc <- as.data.frame(NL_table_Random_Prob_150pc)

NL_table_Random_Prob_150pc[NL_table_Random_Prob_150pc==-1] <- NA

NL_table_Random_Prob_150pc <- subset(NL_table_Random_Prob_150pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Random_Prob_150pc)[names(NL_table_Random_Prob_150pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Random_Prob_150pc)[names(NL_table_Random_Prob_150pc)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Random_Prob_150pc$loading_w1wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_loading_w1wed_conc_list <- append(random_prob_150pc_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_loading_w1wed_conc_matrix <- matrix(unlist(random_prob_150pc_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_cleaning_w1wed_conc_list <- append(random_prob_150pc_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_cleaning_w1wed_conc_matrix <- matrix(unlist(random_prob_150pc_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_150pc$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_150pc_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_150pc_drying_w1wed_conc_list <- append(random_prob_150pc_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_150pc$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_sorting_w1wed_conc_list <- append(random_prob_150pc_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_sorting_w1wed_conc_matrix <- matrix(unlist(random_prob_150pc_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_tray_packing_w1wed_conc_list <- append(random_prob_150pc_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_tray_packing_w1wed_conc_matrix <- matrix(unlist(random_prob_150pc_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$reject_w1wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_reject_w1wed_conc_list <- append(random_prob_150pc_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_reject_w1wed_conc_matrix <- matrix(unlist(random_prob_150pc_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$other_w1wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_other_w1wed_conc_list <- append(random_prob_150pc_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_other_w1wed_conc_matrix <- matrix(unlist(random_prob_150pc_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_150pc_loading_concs <- as.data.frame(random_prob_150pc_loading_w1wed_conc_list)
random_prob_150pc_loading_concs$area <- as.factor('loading')
random_prob_150pc_loading_concs$scenario <- as.factor('PR_01')
random_prob_150pc_loading_concs$water <- as.factor('Wet')
names(random_prob_150pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_cleaning_concs <- as.data.frame(random_prob_150pc_cleaning_w1wed_conc_list)
random_prob_150pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_150pc_cleaning_concs$scenario <- as.factor('PR_01')
random_prob_150pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_150pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_sorting_concs <- as.data.frame(random_prob_150pc_sorting_w1wed_conc_list)
random_prob_150pc_sorting_concs$area <- as.factor('sorting')
random_prob_150pc_sorting_concs$scenario <- as.factor('PR_01')
random_prob_150pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_150pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_reject_concs <- as.data.frame(random_prob_150pc_reject_w1wed_conc_list)
random_prob_150pc_reject_concs$area <- as.factor('reject')
random_prob_150pc_reject_concs$scenario <- as.factor('PR_01')
random_prob_150pc_reject_concs$water <- as.factor('Dry')
names(random_prob_150pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_tray_packing_concs <- as.data.frame(random_prob_150pc_tray_packing_w1wed_conc_list)
random_prob_150pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_150pc_tray_packing_concs$scenario <- as.factor('PR_01')
random_prob_150pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_150pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_other_concs <- as.data.frame(random_prob_150pc_other_w1wed_conc_list)
random_prob_150pc_other_concs$area <- as.factor('other')
random_prob_150pc_other_concs$scenario <- as.factor('PR_01')
random_prob_150pc_other_concs$water <- as.factor('Dry')
names(random_prob_150pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_w1wed_concs <- rbind(random_prob_150pc_loading_concs,random_prob_150pc_cleaning_concs,random_prob_150pc_sorting_concs,random_prob_150pc_tray_packing_concs,random_prob_150pc_reject_concs,random_prob_150pc_other_concs)

random_prob_150pc_loading_prev <- as.data.frame(NL_table_Random_Prob_150pc$loading_w1wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_loading_prev$area <- as.factor('loading')
random_prob_150pc_loading_prev$scenario <- as.factor('PR_01')
random_prob_150pc_loading_prev$water <- as.factor('Wet')
names(random_prob_150pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_150pc$cleaning_w1wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_150pc_cleaning_prev$scenario <- as.factor('PR_01')
random_prob_150pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_150pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_150pc$sorting_w1wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_sorting_prev$area <- as.factor('sorting')
random_prob_150pc_sorting_prev$scenario <- as.factor('PR_01')
random_prob_150pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_150pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_reject_prev <- as.data.frame(NL_table_Random_Prob_150pc$reject_w1wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_reject_prev$area <- as.factor('reject')
random_prob_150pc_reject_prev$scenario <- as.factor('PR_01')
random_prob_150pc_reject_prev$water <- as.factor('Dry')
names(random_prob_150pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_150pc$tray_packing_w1wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_150pc_tray_packing_prev$scenario <- as.factor('PR_01')
random_prob_150pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_150pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_other_prev <- as.data.frame(NL_table_Random_Prob_150pc$other_w1wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_other_prev$area <- as.factor('other')
random_prob_150pc_other_prev$scenario <- as.factor('PR_01')
random_prob_150pc_other_prev$water <- as.factor('Dry')
names(random_prob_150pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_w1wed_prev <- rbind(random_prob_150pc_loading_prev,random_prob_150pc_cleaning_prev,random_prob_150pc_sorting_prev,random_prob_150pc_tray_packing_prev,random_prob_150pc_reject_prev,random_prob_150pc_other_prev)

random_prob_150pc_w1wed_wet_prev <- as.data.frame(random_prob_150pc_loading_prev$prevalence*21/100+random_prob_150pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_150pc_w1wed_wet_prev$scenario <- as.factor('PR_01')
random_prob_150pc_w1wed_wet_prev$water <- as.factor('Wet')
names(random_prob_150pc_w1wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_150pc_w1wed_dry_prev <- as.data.frame(random_prob_150pc_sorting_prev$prevalence*20/100+random_prob_150pc_reject_prev$prevalence*23/100+random_prob_150pc_tray_packing_prev$prevalence*123/100+random_prob_150pc_other_prev$prevalence*10/100)/176*100
random_prob_150pc_w1wed_dry_prev$scenario <- as.factor('PR_01')
random_prob_150pc_w1wed_dry_prev$water <- as.factor('Dry')
names(random_prob_150pc_w1wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_150pc_w1wed_recombined_prev <- rbind(random_prob_150pc_w1wed_wet_prev, random_prob_150pc_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Random_Prob_150pc$loading_w2wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_loading_w2wed_conc_list <- append(random_prob_150pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_loading_w2wed_conc_matrix <- matrix(unlist(random_prob_150pc_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_cleaning_w2wed_conc_list <- append(random_prob_150pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_cleaning_w2wed_conc_matrix <- matrix(unlist(random_prob_150pc_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_150pc$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_150pc_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_150pc_drying_w2wed_conc_list <- append(random_prob_150pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_150pc$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_sorting_w2wed_conc_list <- append(random_prob_150pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_sorting_w2wed_conc_matrix <- matrix(unlist(random_prob_150pc_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_tray_packing_w2wed_conc_list <- append(random_prob_150pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_tray_packing_w2wed_conc_matrix <- matrix(unlist(random_prob_150pc_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$reject_w2wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_reject_w2wed_conc_list <- append(random_prob_150pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_reject_w2wed_conc_matrix <- matrix(unlist(random_prob_150pc_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$other_w2wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_other_w2wed_conc_list <- append(random_prob_150pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_other_w2wed_conc_matrix <- matrix(unlist(random_prob_150pc_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_150pc_loading_concs <- as.data.frame(random_prob_150pc_loading_w2wed_conc_list)
random_prob_150pc_loading_concs$area <- as.factor('loading')
random_prob_150pc_loading_concs$scenario <- as.factor('PR_01')
random_prob_150pc_loading_concs$water <- as.factor('Wet')
names(random_prob_150pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_cleaning_concs <- as.data.frame(random_prob_150pc_cleaning_w2wed_conc_list)
random_prob_150pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_150pc_cleaning_concs$scenario <- as.factor('PR_01')
random_prob_150pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_150pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_sorting_concs <- as.data.frame(random_prob_150pc_sorting_w2wed_conc_list)
random_prob_150pc_sorting_concs$area <- as.factor('sorting')
random_prob_150pc_sorting_concs$scenario <- as.factor('PR_01')
random_prob_150pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_150pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_reject_concs <- as.data.frame(random_prob_150pc_reject_w2wed_conc_list)
random_prob_150pc_reject_concs$area <- as.factor('reject')
random_prob_150pc_reject_concs$scenario <- as.factor('PR_01')
random_prob_150pc_reject_concs$water <- as.factor('Dry')
names(random_prob_150pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_tray_packing_concs <- as.data.frame(random_prob_150pc_tray_packing_w2wed_conc_list)
random_prob_150pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_150pc_tray_packing_concs$scenario <- as.factor('PR_01')
random_prob_150pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_150pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_other_concs <- as.data.frame(random_prob_150pc_other_w2wed_conc_list)
random_prob_150pc_other_concs$area <- as.factor('other')
random_prob_150pc_other_concs$scenario <- as.factor('PR_01')
random_prob_150pc_other_concs$water <- as.factor('Dry')
names(random_prob_150pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_w2wed_concs <- rbind(random_prob_150pc_loading_concs,random_prob_150pc_cleaning_concs,random_prob_150pc_sorting_concs,random_prob_150pc_tray_packing_concs,random_prob_150pc_reject_concs,random_prob_150pc_other_concs)

random_prob_150pc_loading_prev <- as.data.frame(NL_table_Random_Prob_150pc$loading_w2wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_loading_prev$area <- as.factor('loading')
random_prob_150pc_loading_prev$scenario <- as.factor('PR_01')
random_prob_150pc_loading_prev$water <- as.factor('Wet')
names(random_prob_150pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_150pc$cleaning_w2wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_150pc_cleaning_prev$scenario <- as.factor('PR_01')
random_prob_150pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_150pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_150pc$sorting_w2wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_sorting_prev$area <- as.factor('sorting')
random_prob_150pc_sorting_prev$scenario <- as.factor('PR_01')
random_prob_150pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_150pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_reject_prev <- as.data.frame(NL_table_Random_Prob_150pc$reject_w2wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_reject_prev$area <- as.factor('reject')
random_prob_150pc_reject_prev$scenario <- as.factor('PR_01')
random_prob_150pc_reject_prev$water <- as.factor('Dry')
names(random_prob_150pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_150pc$tray_packing_w2wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_150pc_tray_packing_prev$scenario <- as.factor('PR_01')
random_prob_150pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_150pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_other_prev <- as.data.frame(NL_table_Random_Prob_150pc$other_w2wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_other_prev$area <- as.factor('other')
random_prob_150pc_other_prev$scenario <- as.factor('PR_01')
random_prob_150pc_other_prev$water <- as.factor('Dry')
names(random_prob_150pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_w2wed_prev <- rbind(random_prob_150pc_loading_prev,random_prob_150pc_cleaning_prev,random_prob_150pc_sorting_prev,random_prob_150pc_tray_packing_prev,random_prob_150pc_reject_prev,random_prob_150pc_other_prev)

random_prob_150pc_w2wed_wet_prev <- as.data.frame(random_prob_150pc_loading_prev$prevalence*21/100+random_prob_150pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_150pc_w2wed_wet_prev$scenario <- as.factor('PR_01')
random_prob_150pc_w2wed_wet_prev$water <- as.factor('Wet')
names(random_prob_150pc_w2wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_150pc_w2wed_dry_prev <- as.data.frame(random_prob_150pc_sorting_prev$prevalence*20/100+random_prob_150pc_reject_prev$prevalence*23/100+random_prob_150pc_tray_packing_prev$prevalence*123/100+random_prob_150pc_other_prev$prevalence*10/100)/176*100
random_prob_150pc_w2wed_dry_prev$scenario <- as.factor('PR_01')
random_prob_150pc_w2wed_dry_prev$water <- as.factor('Dry')
names(random_prob_150pc_w2wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_150pc_w2wed_recombined_prev <- rbind(random_prob_150pc_w2wed_wet_prev, random_prob_150pc_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Random_Prob_150pc$loading_w3wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_loading_w3wed_conc_list <- append(random_prob_150pc_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_loading_w3wed_conc_matrix <- matrix(unlist(random_prob_150pc_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_cleaning_w3wed_conc_list <- append(random_prob_150pc_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_cleaning_w3wed_conc_matrix <- matrix(unlist(random_prob_150pc_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_150pc$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_150pc_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_150pc_drying_w3wed_conc_list <- append(random_prob_150pc_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_150pc$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_sorting_w3wed_conc_list <- append(random_prob_150pc_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_sorting_w3wed_conc_matrix <- matrix(unlist(random_prob_150pc_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_tray_packing_w3wed_conc_list <- append(random_prob_150pc_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_tray_packing_w3wed_conc_matrix <- matrix(unlist(random_prob_150pc_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$reject_w3wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_reject_w3wed_conc_list <- append(random_prob_150pc_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_reject_w3wed_conc_matrix <- matrix(unlist(random_prob_150pc_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$other_w3wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_other_w3wed_conc_list <- append(random_prob_150pc_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_other_w3wed_conc_matrix <- matrix(unlist(random_prob_150pc_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_150pc_loading_concs <- as.data.frame(random_prob_150pc_loading_w3wed_conc_list)
random_prob_150pc_loading_concs$area <- as.factor('loading')
random_prob_150pc_loading_concs$scenario <- as.factor('PR_01')
random_prob_150pc_loading_concs$water <- as.factor('Wet')
names(random_prob_150pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_cleaning_concs <- as.data.frame(random_prob_150pc_cleaning_w3wed_conc_list)
random_prob_150pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_150pc_cleaning_concs$scenario <- as.factor('PR_01')
random_prob_150pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_150pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_sorting_concs <- as.data.frame(random_prob_150pc_sorting_w3wed_conc_list)
random_prob_150pc_sorting_concs$area <- as.factor('sorting')
random_prob_150pc_sorting_concs$scenario <- as.factor('PR_01')
random_prob_150pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_150pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_reject_concs <- as.data.frame(random_prob_150pc_reject_w3wed_conc_list)
random_prob_150pc_reject_concs$area <- as.factor('reject')
random_prob_150pc_reject_concs$scenario <- as.factor('PR_01')
random_prob_150pc_reject_concs$water <- as.factor('Dry')
names(random_prob_150pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_tray_packing_concs <- as.data.frame(random_prob_150pc_tray_packing_w3wed_conc_list)
random_prob_150pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_150pc_tray_packing_concs$scenario <- as.factor('PR_01')
random_prob_150pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_150pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_other_concs <- as.data.frame(random_prob_150pc_other_w3wed_conc_list)
random_prob_150pc_other_concs$area <- as.factor('other')
random_prob_150pc_other_concs$scenario <- as.factor('PR_01')
random_prob_150pc_other_concs$water <- as.factor('Dry')
names(random_prob_150pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_w3wed_concs <- rbind(random_prob_150pc_loading_concs,random_prob_150pc_cleaning_concs,random_prob_150pc_sorting_concs,random_prob_150pc_tray_packing_concs,random_prob_150pc_reject_concs,random_prob_150pc_other_concs)

random_prob_150pc_loading_prev <- as.data.frame(NL_table_Random_Prob_150pc$loading_w3wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_loading_prev$area <- as.factor('loading')
random_prob_150pc_loading_prev$scenario <- as.factor('PR_01')
random_prob_150pc_loading_prev$water <- as.factor('Wet')
names(random_prob_150pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_150pc$cleaning_w3wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_150pc_cleaning_prev$scenario <- as.factor('PR_01')
random_prob_150pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_150pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_150pc$sorting_w3wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_sorting_prev$area <- as.factor('sorting')
random_prob_150pc_sorting_prev$scenario <- as.factor('PR_01')
random_prob_150pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_150pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_reject_prev <- as.data.frame(NL_table_Random_Prob_150pc$reject_w3wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_reject_prev$area <- as.factor('reject')
random_prob_150pc_reject_prev$scenario <- as.factor('PR_01')
random_prob_150pc_reject_prev$water <- as.factor('Dry')
names(random_prob_150pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_150pc$tray_packing_w3wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_150pc_tray_packing_prev$scenario <- as.factor('PR_01')
random_prob_150pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_150pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_other_prev <- as.data.frame(NL_table_Random_Prob_150pc$other_w3wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_other_prev$area <- as.factor('other')
random_prob_150pc_other_prev$scenario <- as.factor('PR_01')
random_prob_150pc_other_prev$water <- as.factor('Dry')
names(random_prob_150pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_w3wed_prev <- rbind(random_prob_150pc_loading_prev,random_prob_150pc_cleaning_prev,random_prob_150pc_sorting_prev,random_prob_150pc_tray_packing_prev,random_prob_150pc_reject_prev,random_prob_150pc_other_prev)

random_prob_150pc_w3wed_wet_prev <- as.data.frame(random_prob_150pc_loading_prev$prevalence*21/100+random_prob_150pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_150pc_w3wed_wet_prev$scenario <- as.factor('PR_01')
random_prob_150pc_w3wed_wet_prev$water <- as.factor('Wet')
names(random_prob_150pc_w3wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_150pc_w3wed_dry_prev <- as.data.frame(random_prob_150pc_sorting_prev$prevalence*20/100+random_prob_150pc_reject_prev$prevalence*23/100+random_prob_150pc_tray_packing_prev$prevalence*123/100+random_prob_150pc_other_prev$prevalence*10/100)/176*100
random_prob_150pc_w3wed_dry_prev$scenario <- as.factor('PR_01')
random_prob_150pc_w3wed_dry_prev$water <- as.factor('Dry')
names(random_prob_150pc_w3wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_150pc_w3wed_recombined_prev <- rbind(random_prob_150pc_w3wed_wet_prev, random_prob_150pc_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Random_Prob_150pc$loading_w4wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_loading_w4wed_conc_list <- append(random_prob_150pc_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_loading_w4wed_conc_matrix <- matrix(unlist(random_prob_150pc_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_cleaning_w4wed_conc_list <- append(random_prob_150pc_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_cleaning_w4wed_conc_matrix <- matrix(unlist(random_prob_150pc_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_150pc$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_150pc_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_150pc_drying_w4wed_conc_list <- append(random_prob_150pc_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_150pc$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_sorting_w4wed_conc_list <- append(random_prob_150pc_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_sorting_w4wed_conc_matrix <- matrix(unlist(random_prob_150pc_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_tray_packing_w4wed_conc_list <- append(random_prob_150pc_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_tray_packing_w4wed_conc_matrix <- matrix(unlist(random_prob_150pc_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$reject_w4wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_reject_w4wed_conc_list <- append(random_prob_150pc_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_reject_w4wed_conc_matrix <- matrix(unlist(random_prob_150pc_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$other_w4wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_other_w4wed_conc_list <- append(random_prob_150pc_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_other_w4wed_conc_matrix <- matrix(unlist(random_prob_150pc_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_150pc_loading_concs <- as.data.frame(random_prob_150pc_loading_w4wed_conc_list)
random_prob_150pc_loading_concs$area <- as.factor('loading')
random_prob_150pc_loading_concs$scenario <- as.factor('PR_01')
random_prob_150pc_loading_concs$water <- as.factor('Wet')
names(random_prob_150pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_cleaning_concs <- as.data.frame(random_prob_150pc_cleaning_w4wed_conc_list)
random_prob_150pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_150pc_cleaning_concs$scenario <- as.factor('PR_01')
random_prob_150pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_150pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_sorting_concs <- as.data.frame(random_prob_150pc_sorting_w4wed_conc_list)
random_prob_150pc_sorting_concs$area <- as.factor('sorting')
random_prob_150pc_sorting_concs$scenario <- as.factor('PR_01')
random_prob_150pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_150pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_reject_concs <- as.data.frame(random_prob_150pc_reject_w4wed_conc_list)
random_prob_150pc_reject_concs$area <- as.factor('reject')
random_prob_150pc_reject_concs$scenario <- as.factor('PR_01')
random_prob_150pc_reject_concs$water <- as.factor('Dry')
names(random_prob_150pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_tray_packing_concs <- as.data.frame(random_prob_150pc_tray_packing_w4wed_conc_list)
random_prob_150pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_150pc_tray_packing_concs$scenario <- as.factor('PR_01')
random_prob_150pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_150pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_other_concs <- as.data.frame(random_prob_150pc_other_w4wed_conc_list)
random_prob_150pc_other_concs$area <- as.factor('other')
random_prob_150pc_other_concs$scenario <- as.factor('PR_01')
random_prob_150pc_other_concs$water <- as.factor('Dry')
names(random_prob_150pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_w4wed_concs <- rbind(random_prob_150pc_loading_concs,random_prob_150pc_cleaning_concs,random_prob_150pc_sorting_concs,random_prob_150pc_tray_packing_concs,random_prob_150pc_reject_concs,random_prob_150pc_other_concs)

random_prob_150pc_loading_prev <- as.data.frame(NL_table_Random_Prob_150pc$loading_w4wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_loading_prev$area <- as.factor('loading')
random_prob_150pc_loading_prev$scenario <- as.factor('PR_01')
random_prob_150pc_loading_prev$water <- as.factor('Wet')
names(random_prob_150pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_150pc$cleaning_w4wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_150pc_cleaning_prev$scenario <- as.factor('PR_01')
random_prob_150pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_150pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_150pc$sorting_w4wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_sorting_prev$area <- as.factor('sorting')
random_prob_150pc_sorting_prev$scenario <- as.factor('PR_01')
random_prob_150pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_150pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_reject_prev <- as.data.frame(NL_table_Random_Prob_150pc$reject_w4wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_reject_prev$area <- as.factor('reject')
random_prob_150pc_reject_prev$scenario <- as.factor('PR_01')
random_prob_150pc_reject_prev$water <- as.factor('Dry')
names(random_prob_150pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_150pc$tray_packing_w4wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_150pc_tray_packing_prev$scenario <- as.factor('PR_01')
random_prob_150pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_150pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_other_prev <- as.data.frame(NL_table_Random_Prob_150pc$other_w4wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_other_prev$area <- as.factor('other')
random_prob_150pc_other_prev$scenario <- as.factor('PR_01')
random_prob_150pc_other_prev$water <- as.factor('Dry')
names(random_prob_150pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_w4wed_prev <- rbind(random_prob_150pc_loading_prev,random_prob_150pc_cleaning_prev,random_prob_150pc_sorting_prev,random_prob_150pc_tray_packing_prev,random_prob_150pc_reject_prev,random_prob_150pc_other_prev)

random_prob_150pc_w4wed_wet_prev <- as.data.frame(random_prob_150pc_loading_prev$prevalence*21/100+random_prob_150pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_150pc_w4wed_wet_prev$scenario <- as.factor('PR_01')
random_prob_150pc_w4wed_wet_prev$water <- as.factor('Wet')
names(random_prob_150pc_w4wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_150pc_w4wed_dry_prev <- as.data.frame(random_prob_150pc_sorting_prev$prevalence*20/100+random_prob_150pc_reject_prev$prevalence*23/100+random_prob_150pc_tray_packing_prev$prevalence*123/100+random_prob_150pc_other_prev$prevalence*10/100)/176*100
random_prob_150pc_w4wed_dry_prev$scenario <- as.factor('PR_01')
random_prob_150pc_w4wed_dry_prev$water <- as.factor('Dry')
names(random_prob_150pc_w4wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_150pc_w4wed_recombined_prev <- rbind(random_prob_150pc_w4wed_wet_prev, random_prob_150pc_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Random_Prob_150pc$loading_w5wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_loading_w5wed_conc_list <- append(random_prob_150pc_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_loading_w5wed_conc_matrix <- matrix(unlist(random_prob_150pc_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_cleaning_w5wed_conc_list <- append(random_prob_150pc_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_cleaning_w5wed_conc_matrix <- matrix(unlist(random_prob_150pc_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_150pc$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_150pc_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_150pc_drying_w5wed_conc_list <- append(random_prob_150pc_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_150pc$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_sorting_w5wed_conc_list <- append(random_prob_150pc_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_sorting_w5wed_conc_matrix <- matrix(unlist(random_prob_150pc_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_tray_packing_w5wed_conc_list <- append(random_prob_150pc_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_tray_packing_w5wed_conc_matrix <- matrix(unlist(random_prob_150pc_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$reject_w5wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_reject_w5wed_conc_list <- append(random_prob_150pc_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_reject_w5wed_conc_matrix <- matrix(unlist(random_prob_150pc_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$other_w5wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_other_w5wed_conc_list <- append(random_prob_150pc_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_other_w5wed_conc_matrix <- matrix(unlist(random_prob_150pc_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_150pc_loading_concs <- as.data.frame(random_prob_150pc_loading_w5wed_conc_list)
random_prob_150pc_loading_concs$area <- as.factor('loading')
random_prob_150pc_loading_concs$scenario <- as.factor('PR_01')
random_prob_150pc_loading_concs$water <- as.factor('Wet')
names(random_prob_150pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_cleaning_concs <- as.data.frame(random_prob_150pc_cleaning_w5wed_conc_list)
random_prob_150pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_150pc_cleaning_concs$scenario <- as.factor('PR_01')
random_prob_150pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_150pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_sorting_concs <- as.data.frame(random_prob_150pc_sorting_w5wed_conc_list)
random_prob_150pc_sorting_concs$area <- as.factor('sorting')
random_prob_150pc_sorting_concs$scenario <- as.factor('PR_01')
random_prob_150pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_150pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_reject_concs <- as.data.frame(random_prob_150pc_reject_w5wed_conc_list)
random_prob_150pc_reject_concs$area <- as.factor('reject')
random_prob_150pc_reject_concs$scenario <- as.factor('PR_01')
random_prob_150pc_reject_concs$water <- as.factor('Dry')
names(random_prob_150pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_tray_packing_concs <- as.data.frame(random_prob_150pc_tray_packing_w5wed_conc_list)
random_prob_150pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_150pc_tray_packing_concs$scenario <- as.factor('PR_01')
random_prob_150pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_150pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_other_concs <- as.data.frame(random_prob_150pc_other_w5wed_conc_list)
random_prob_150pc_other_concs$area <- as.factor('other')
random_prob_150pc_other_concs$scenario <- as.factor('PR_01')
random_prob_150pc_other_concs$water <- as.factor('Dry')
names(random_prob_150pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_w5wed_concs <- rbind(random_prob_150pc_loading_concs,random_prob_150pc_cleaning_concs,random_prob_150pc_sorting_concs,random_prob_150pc_tray_packing_concs,random_prob_150pc_reject_concs,random_prob_150pc_other_concs)

random_prob_150pc_loading_prev <- as.data.frame(NL_table_Random_Prob_150pc$loading_w5wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_loading_prev$area <- as.factor('loading')
random_prob_150pc_loading_prev$scenario <- as.factor('PR_01')
random_prob_150pc_loading_prev$water <- as.factor('Wet')
names(random_prob_150pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_150pc$cleaning_w5wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_150pc_cleaning_prev$scenario <- as.factor('PR_01')
random_prob_150pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_150pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_150pc$sorting_w5wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_sorting_prev$area <- as.factor('sorting')
random_prob_150pc_sorting_prev$scenario <- as.factor('PR_01')
random_prob_150pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_150pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_reject_prev <- as.data.frame(NL_table_Random_Prob_150pc$reject_w5wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_reject_prev$area <- as.factor('reject')
random_prob_150pc_reject_prev$scenario <- as.factor('PR_01')
random_prob_150pc_reject_prev$water <- as.factor('Dry')
names(random_prob_150pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_150pc$tray_packing_w5wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_150pc_tray_packing_prev$scenario <- as.factor('PR_01')
random_prob_150pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_150pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_other_prev <- as.data.frame(NL_table_Random_Prob_150pc$other_w5wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_other_prev$area <- as.factor('other')
random_prob_150pc_other_prev$scenario <- as.factor('PR_01')
random_prob_150pc_other_prev$water <- as.factor('Dry')
names(random_prob_150pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_w5wed_prev <- rbind(random_prob_150pc_loading_prev,random_prob_150pc_cleaning_prev,random_prob_150pc_sorting_prev,random_prob_150pc_tray_packing_prev,random_prob_150pc_reject_prev,random_prob_150pc_other_prev)

random_prob_150pc_w5wed_wet_prev <- as.data.frame(random_prob_150pc_loading_prev$prevalence*21/100+random_prob_150pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_150pc_w5wed_wet_prev$scenario <- as.factor('PR_01')
random_prob_150pc_w5wed_wet_prev$water <- as.factor('Wet')
names(random_prob_150pc_w5wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_150pc_w5wed_dry_prev <- as.data.frame(random_prob_150pc_sorting_prev$prevalence*20/100+random_prob_150pc_reject_prev$prevalence*23/100+random_prob_150pc_tray_packing_prev$prevalence*123/100+random_prob_150pc_other_prev$prevalence*10/100)/176*100
random_prob_150pc_w5wed_dry_prev$scenario <- as.factor('PR_01')
random_prob_150pc_w5wed_dry_prev$water <- as.factor('Dry')
names(random_prob_150pc_w5wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_150pc_w5wed_recombined_prev <- rbind(random_prob_150pc_w5wed_wet_prev, random_prob_150pc_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Random_Prob_150pc$loading_w6wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_loading_w6wed_conc_list <- append(random_prob_150pc_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_loading_w6wed_conc_matrix <- matrix(unlist(random_prob_150pc_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_cleaning_w6wed_conc_list <- append(random_prob_150pc_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_cleaning_w6wed_conc_matrix <- matrix(unlist(random_prob_150pc_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_150pc$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_150pc_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_150pc_drying_w6wed_conc_list <- append(random_prob_150pc_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_150pc$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_sorting_w6wed_conc_list <- append(random_prob_150pc_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_sorting_w6wed_conc_matrix <- matrix(unlist(random_prob_150pc_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_tray_packing_w6wed_conc_list <- append(random_prob_150pc_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_tray_packing_w6wed_conc_matrix <- matrix(unlist(random_prob_150pc_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$reject_w6wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_reject_w6wed_conc_list <- append(random_prob_150pc_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_reject_w6wed_conc_matrix <- matrix(unlist(random_prob_150pc_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$other_w6wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_other_w6wed_conc_list <- append(random_prob_150pc_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_other_w6wed_conc_matrix <- matrix(unlist(random_prob_150pc_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_150pc_loading_concs <- as.data.frame(random_prob_150pc_loading_w6wed_conc_list)
random_prob_150pc_loading_concs$area <- as.factor('loading')
random_prob_150pc_loading_concs$scenario <- as.factor('PR_01')
random_prob_150pc_loading_concs$water <- as.factor('Wet')
names(random_prob_150pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_cleaning_concs <- as.data.frame(random_prob_150pc_cleaning_w6wed_conc_list)
random_prob_150pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_150pc_cleaning_concs$scenario <- as.factor('PR_01')
random_prob_150pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_150pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_sorting_concs <- as.data.frame(random_prob_150pc_sorting_w6wed_conc_list)
random_prob_150pc_sorting_concs$area <- as.factor('sorting')
random_prob_150pc_sorting_concs$scenario <- as.factor('PR_01')
random_prob_150pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_150pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_reject_concs <- as.data.frame(random_prob_150pc_reject_w6wed_conc_list)
random_prob_150pc_reject_concs$area <- as.factor('reject')
random_prob_150pc_reject_concs$scenario <- as.factor('PR_01')
random_prob_150pc_reject_concs$water <- as.factor('Dry')
names(random_prob_150pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_tray_packing_concs <- as.data.frame(random_prob_150pc_tray_packing_w6wed_conc_list)
random_prob_150pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_150pc_tray_packing_concs$scenario <- as.factor('PR_01')
random_prob_150pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_150pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_other_concs <- as.data.frame(random_prob_150pc_other_w6wed_conc_list)
random_prob_150pc_other_concs$area <- as.factor('other')
random_prob_150pc_other_concs$scenario <- as.factor('PR_01')
random_prob_150pc_other_concs$water <- as.factor('Dry')
names(random_prob_150pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_w6wed_concs <- rbind(random_prob_150pc_loading_concs,random_prob_150pc_cleaning_concs,random_prob_150pc_sorting_concs,random_prob_150pc_tray_packing_concs,random_prob_150pc_reject_concs,random_prob_150pc_other_concs)

random_prob_150pc_loading_prev <- as.data.frame(NL_table_Random_Prob_150pc$loading_w6wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_loading_prev$area <- as.factor('loading')
random_prob_150pc_loading_prev$scenario <- as.factor('PR_01')
random_prob_150pc_loading_prev$water <- as.factor('Wet')
names(random_prob_150pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_150pc$cleaning_w6wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_150pc_cleaning_prev$scenario <- as.factor('PR_01')
random_prob_150pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_150pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_150pc$sorting_w6wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_sorting_prev$area <- as.factor('sorting')
random_prob_150pc_sorting_prev$scenario <- as.factor('PR_01')
random_prob_150pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_150pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_reject_prev <- as.data.frame(NL_table_Random_Prob_150pc$reject_w6wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_reject_prev$area <- as.factor('reject')
random_prob_150pc_reject_prev$scenario <- as.factor('PR_01')
random_prob_150pc_reject_prev$water <- as.factor('Dry')
names(random_prob_150pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_150pc$tray_packing_w6wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_150pc_tray_packing_prev$scenario <- as.factor('PR_01')
random_prob_150pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_150pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_other_prev <- as.data.frame(NL_table_Random_Prob_150pc$other_w6wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_other_prev$area <- as.factor('other')
random_prob_150pc_other_prev$scenario <- as.factor('PR_01')
random_prob_150pc_other_prev$water <- as.factor('Dry')
names(random_prob_150pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_w6wed_prev <- rbind(random_prob_150pc_loading_prev,random_prob_150pc_cleaning_prev,random_prob_150pc_sorting_prev,random_prob_150pc_tray_packing_prev,random_prob_150pc_reject_prev,random_prob_150pc_other_prev)

random_prob_150pc_w6wed_wet_prev <- as.data.frame(random_prob_150pc_loading_prev$prevalence*21/100+random_prob_150pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_150pc_w6wed_wet_prev$scenario <- as.factor('PR_01')
random_prob_150pc_w6wed_wet_prev$water <- as.factor('Wet')
names(random_prob_150pc_w6wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_150pc_w6wed_dry_prev <- as.data.frame(random_prob_150pc_sorting_prev$prevalence*20/100+random_prob_150pc_reject_prev$prevalence*23/100+random_prob_150pc_tray_packing_prev$prevalence*123/100+random_prob_150pc_other_prev$prevalence*10/100)/176*100
random_prob_150pc_w6wed_dry_prev$scenario <- as.factor('PR_01')
random_prob_150pc_w6wed_dry_prev$water <- as.factor('Dry')
names(random_prob_150pc_w6wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_150pc_w6wed_recombined_prev <- rbind(random_prob_150pc_w6wed_wet_prev, random_prob_150pc_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Random_Prob_150pc$loading_w7wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_loading_w7wed_conc_list <- append(random_prob_150pc_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_loading_w7wed_conc_matrix <- matrix(unlist(random_prob_150pc_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_cleaning_w7wed_conc_list <- append(random_prob_150pc_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_cleaning_w7wed_conc_matrix <- matrix(unlist(random_prob_150pc_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_150pc$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_150pc_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_150pc_drying_w7wed_conc_list <- append(random_prob_150pc_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_150pc$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_sorting_w7wed_conc_list <- append(random_prob_150pc_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_sorting_w7wed_conc_matrix <- matrix(unlist(random_prob_150pc_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_tray_packing_w7wed_conc_list <- append(random_prob_150pc_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_tray_packing_w7wed_conc_matrix <- matrix(unlist(random_prob_150pc_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$reject_w7wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_reject_w7wed_conc_list <- append(random_prob_150pc_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_reject_w7wed_conc_matrix <- matrix(unlist(random_prob_150pc_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$other_w7wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_other_w7wed_conc_list <- append(random_prob_150pc_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_other_w7wed_conc_matrix <- matrix(unlist(random_prob_150pc_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_150pc_loading_concs <- as.data.frame(random_prob_150pc_loading_w7wed_conc_list)
random_prob_150pc_loading_concs$area <- as.factor('loading')
random_prob_150pc_loading_concs$scenario <- as.factor('PR_01')
random_prob_150pc_loading_concs$water <- as.factor('Wet')
names(random_prob_150pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_cleaning_concs <- as.data.frame(random_prob_150pc_cleaning_w7wed_conc_list)
random_prob_150pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_150pc_cleaning_concs$scenario <- as.factor('PR_01')
random_prob_150pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_150pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_sorting_concs <- as.data.frame(random_prob_150pc_sorting_w7wed_conc_list)
random_prob_150pc_sorting_concs$area <- as.factor('sorting')
random_prob_150pc_sorting_concs$scenario <- as.factor('PR_01')
random_prob_150pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_150pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_reject_concs <- as.data.frame(random_prob_150pc_reject_w7wed_conc_list)
random_prob_150pc_reject_concs$area <- as.factor('reject')
random_prob_150pc_reject_concs$scenario <- as.factor('PR_01')
random_prob_150pc_reject_concs$water <- as.factor('Dry')
names(random_prob_150pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_tray_packing_concs <- as.data.frame(random_prob_150pc_tray_packing_w7wed_conc_list)
random_prob_150pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_150pc_tray_packing_concs$scenario <- as.factor('PR_01')
random_prob_150pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_150pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_other_concs <- as.data.frame(random_prob_150pc_other_w7wed_conc_list)
random_prob_150pc_other_concs$area <- as.factor('other')
random_prob_150pc_other_concs$scenario <- as.factor('PR_01')
random_prob_150pc_other_concs$water <- as.factor('Dry')
names(random_prob_150pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_w7wed_concs <- rbind(random_prob_150pc_loading_concs,random_prob_150pc_cleaning_concs,random_prob_150pc_sorting_concs,random_prob_150pc_tray_packing_concs,random_prob_150pc_reject_concs,random_prob_150pc_other_concs)

random_prob_150pc_loading_prev <- as.data.frame(NL_table_Random_Prob_150pc$loading_w7wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_loading_prev$area <- as.factor('loading')
random_prob_150pc_loading_prev$scenario <- as.factor('PR_01')
random_prob_150pc_loading_prev$water <- as.factor('Wet')
names(random_prob_150pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_150pc$cleaning_w7wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_150pc_cleaning_prev$scenario <- as.factor('PR_01')
random_prob_150pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_150pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_150pc$sorting_w7wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_sorting_prev$area <- as.factor('sorting')
random_prob_150pc_sorting_prev$scenario <- as.factor('PR_01')
random_prob_150pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_150pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_reject_prev <- as.data.frame(NL_table_Random_Prob_150pc$reject_w7wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_reject_prev$area <- as.factor('reject')
random_prob_150pc_reject_prev$scenario <- as.factor('PR_01')
random_prob_150pc_reject_prev$water <- as.factor('Dry')
names(random_prob_150pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_150pc$tray_packing_w7wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_150pc_tray_packing_prev$scenario <- as.factor('PR_01')
random_prob_150pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_150pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_other_prev <- as.data.frame(NL_table_Random_Prob_150pc$other_w7wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_other_prev$area <- as.factor('other')
random_prob_150pc_other_prev$scenario <- as.factor('PR_01')
random_prob_150pc_other_prev$water <- as.factor('Dry')
names(random_prob_150pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_w7wed_prev <- rbind(random_prob_150pc_loading_prev,random_prob_150pc_cleaning_prev,random_prob_150pc_sorting_prev,random_prob_150pc_tray_packing_prev,random_prob_150pc_reject_prev,random_prob_150pc_other_prev)

random_prob_150pc_w7wed_wet_prev <- as.data.frame(random_prob_150pc_loading_prev$prevalence*21/100+random_prob_150pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_150pc_w7wed_wet_prev$scenario <- as.factor('PR_01')
random_prob_150pc_w7wed_wet_prev$water <- as.factor('Wet')
names(random_prob_150pc_w7wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_150pc_w7wed_dry_prev <- as.data.frame(random_prob_150pc_sorting_prev$prevalence*20/100+random_prob_150pc_reject_prev$prevalence*23/100+random_prob_150pc_tray_packing_prev$prevalence*123/100+random_prob_150pc_other_prev$prevalence*10/100)/176*100
random_prob_150pc_w7wed_dry_prev$scenario <- as.factor('PR_01')
random_prob_150pc_w7wed_dry_prev$water <- as.factor('Dry')
names(random_prob_150pc_w7wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_150pc_w7wed_recombined_prev <- rbind(random_prob_150pc_w7wed_wet_prev, random_prob_150pc_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Random_Prob_150pc$loading_w8wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_loading_w8wed_conc_list <- append(random_prob_150pc_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_loading_w8wed_conc_matrix <- matrix(unlist(random_prob_150pc_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_cleaning_w8wed_conc_list <- append(random_prob_150pc_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_cleaning_w8wed_conc_matrix <- matrix(unlist(random_prob_150pc_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_150pc$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_150pc_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_150pc_drying_w8wed_conc_list <- append(random_prob_150pc_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_150pc$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_sorting_w8wed_conc_list <- append(random_prob_150pc_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_sorting_w8wed_conc_matrix <- matrix(unlist(random_prob_150pc_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_tray_packing_w8wed_conc_list <- append(random_prob_150pc_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_tray_packing_w8wed_conc_matrix <- matrix(unlist(random_prob_150pc_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$reject_w8wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_reject_w8wed_conc_list <- append(random_prob_150pc_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_reject_w8wed_conc_matrix <- matrix(unlist(random_prob_150pc_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_150pc$other_w8wed_conc_list
vector <- vector[vector!='[]']
random_prob_150pc_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_150pc_other_w8wed_conc_list <- append(random_prob_150pc_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_150pc_other_w8wed_conc_matrix <- matrix(unlist(random_prob_150pc_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_150pc_loading_concs <- as.data.frame(random_prob_150pc_loading_w8wed_conc_list)
random_prob_150pc_loading_concs$area <- as.factor('loading')
random_prob_150pc_loading_concs$scenario <- as.factor('PR_01')
random_prob_150pc_loading_concs$water <- as.factor('Wet')
names(random_prob_150pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_cleaning_concs <- as.data.frame(random_prob_150pc_cleaning_w8wed_conc_list)
random_prob_150pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_150pc_cleaning_concs$scenario <- as.factor('PR_01')
random_prob_150pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_150pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_sorting_concs <- as.data.frame(random_prob_150pc_sorting_w8wed_conc_list)
random_prob_150pc_sorting_concs$area <- as.factor('sorting')
random_prob_150pc_sorting_concs$scenario <- as.factor('PR_01')
random_prob_150pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_150pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_reject_concs <- as.data.frame(random_prob_150pc_reject_w8wed_conc_list)
random_prob_150pc_reject_concs$area <- as.factor('reject')
random_prob_150pc_reject_concs$scenario <- as.factor('PR_01')
random_prob_150pc_reject_concs$water <- as.factor('Dry')
names(random_prob_150pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_tray_packing_concs <- as.data.frame(random_prob_150pc_tray_packing_w8wed_conc_list)
random_prob_150pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_150pc_tray_packing_concs$scenario <- as.factor('PR_01')
random_prob_150pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_150pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_other_concs <- as.data.frame(random_prob_150pc_other_w8wed_conc_list)
random_prob_150pc_other_concs$area <- as.factor('other')
random_prob_150pc_other_concs$scenario <- as.factor('PR_01')
random_prob_150pc_other_concs$water <- as.factor('Dry')
names(random_prob_150pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_150pc_w8wed_concs <- rbind(random_prob_150pc_loading_concs,random_prob_150pc_cleaning_concs,random_prob_150pc_sorting_concs,random_prob_150pc_tray_packing_concs,random_prob_150pc_reject_concs,random_prob_150pc_other_concs)

random_prob_150pc_loading_prev <- as.data.frame(NL_table_Random_Prob_150pc$loading_w8wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_loading_prev$area <- as.factor('loading')
random_prob_150pc_loading_prev$scenario <- as.factor('PR_01')
random_prob_150pc_loading_prev$water <- as.factor('Wet')
names(random_prob_150pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_150pc$cleaning_w8wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_150pc_cleaning_prev$scenario <- as.factor('PR_01')
random_prob_150pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_150pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_150pc$sorting_w8wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_sorting_prev$area <- as.factor('sorting')
random_prob_150pc_sorting_prev$scenario <- as.factor('PR_01')
random_prob_150pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_150pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_reject_prev <- as.data.frame(NL_table_Random_Prob_150pc$reject_w8wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_reject_prev$area <- as.factor('reject')
random_prob_150pc_reject_prev$scenario <- as.factor('PR_01')
random_prob_150pc_reject_prev$water <- as.factor('Dry')
names(random_prob_150pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_150pc$tray_packing_w8wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_150pc_tray_packing_prev$scenario <- as.factor('PR_01')
random_prob_150pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_150pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_other_prev <- as.data.frame(NL_table_Random_Prob_150pc$other_w8wed_prev[order(NL_table_Random_Prob_150pc$local_seed)])
random_prob_150pc_other_prev$area <- as.factor('other')
random_prob_150pc_other_prev$scenario <- as.factor('PR_01')
random_prob_150pc_other_prev$water <- as.factor('Dry')
names(random_prob_150pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_150pc_w8wed_prev <- rbind(random_prob_150pc_loading_prev,random_prob_150pc_cleaning_prev,random_prob_150pc_sorting_prev,random_prob_150pc_tray_packing_prev,random_prob_150pc_reject_prev,random_prob_150pc_other_prev)

random_prob_150pc_w8wed_wet_prev <- as.data.frame(random_prob_150pc_loading_prev$prevalence*21/100+random_prob_150pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_150pc_w8wed_wet_prev$scenario <- as.factor('PR_01')
random_prob_150pc_w8wed_wet_prev$water <- as.factor('Wet')
names(random_prob_150pc_w8wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_150pc_w8wed_dry_prev <- as.data.frame(random_prob_150pc_sorting_prev$prevalence*20/100+random_prob_150pc_reject_prev$prevalence*23/100+random_prob_150pc_tray_packing_prev$prevalence*123/100+random_prob_150pc_other_prev$prevalence*10/100)/176*100
random_prob_150pc_w8wed_dry_prev$scenario <- as.factor('PR_01')
random_prob_150pc_w8wed_dry_prev$water <- as.factor('Dry')
names(random_prob_150pc_w8wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_150pc_w8wed_recombined_prev <- rbind(random_prob_150pc_w8wed_wet_prev, random_prob_150pc_w8wed_dry_prev)

vector <- NL_table_Random_Prob_150pc$lifetime_conc_list[order(NL_table_Random_Prob_150pc$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

random_prob_150pc_w1wed_recombined_prev$week <- as.factor(1)
random_prob_150pc_w2wed_recombined_prev$week <- as.factor(2)
random_prob_150pc_w3wed_recombined_prev$week <- as.factor(3)
random_prob_150pc_w4wed_recombined_prev$week <- as.factor(4)
random_prob_150pc_w5wed_recombined_prev$week <- as.factor(5)
random_prob_150pc_w6wed_recombined_prev$week <- as.factor(6)
random_prob_150pc_w7wed_recombined_prev$week <- as.factor(7)
random_prob_150pc_w8wed_recombined_prev$week <- as.factor(8)
random_prob_150pc_allwed_prev <- rbind(random_prob_150pc_w1wed_recombined_prev,random_prob_150pc_w2wed_recombined_prev,random_prob_150pc_w3wed_recombined_prev,random_prob_150pc_w4wed_recombined_prev,random_prob_150pc_w5wed_recombined_prev,random_prob_150pc_w6wed_recombined_prev,random_prob_150pc_w7wed_recombined_prev,random_prob_150pc_w8wed_recombined_prev)

Facility_B_random_prob_150pc_agents_melted <- melt(mdarray)
colnames(Facility_B_random_prob_150pc_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_random_prob_150pc_agents_melted$agent <- Facility_B_random_prob_150pc_agents_melted$agent-1
Facility_B_random_prob_150pc_agents_melted$logical <- Facility_B_random_prob_150pc_agents_melted$value>0
Facility_B_random_prob_150pc_agents_melted$binary <- as.numeric(Facility_B_random_prob_150pc_agents_melted$logical)
Facility_B_random_prob_150pc_agents_melted$log10value <- log10(Facility_B_random_prob_150pc_agents_melted$value)
Facility_B_random_prob_150pc_agents_melted$log10value[is.infinite(Facility_B_random_prob_150pc_agents_melted$log10value)] <- 0

agent <- Facility_B_random_prob_150pc_agents_melted$agent
iteration <- Facility_B_random_prob_150pc_agents_melted$iteration
tick <- Facility_B_random_prob_150pc_agents_melted$tick
rle_matrix <- tapply(Facility_B_random_prob_150pc_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_random_prob_150pc_agents_melted_mean_value_matrix <- tapply(Facility_B_random_prob_150pc_agents_melted$value, list(agent, tick), mean)
Facility_B_random_prob_150pc_agents_melted_median_value_matrix <- tapply(Facility_B_random_prob_150pc_agents_melted$value, list(agent, tick), median)
Facility_B_random_prob_150pc_agents_melted_prob_value_matrix <- tapply(Facility_B_random_prob_150pc_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}
# durations$agent <- durations$agent-1

Facility_B_durations_random_prob_150pc <- durations

agents_list_random_prob_150pc <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_random_prob_150pc <- agents_list_random_prob_150pc[,c("V1","V7","V8","V9")]
colnames(agents_list_random_prob_150pc) <- c("name","sanitation_status","schedule","area")
agents_list_random_prob_150pc$ttp <- rep((168*2),225)
agents_list_random_prob_150pc$ttp[agents_list_random_prob_150pc$schedule=="daily"] <- (24*2)

agent <- 1
while(agent<=225) {
  agents_list_random_prob_150pc$min_duration[agent] <- ifelse(length(Facility_B_durations_random_prob_150pc$duration[Facility_B_durations_random_prob_150pc$agent==agent])==0,NA,min(Facility_B_durations_random_prob_150pc$duration[Facility_B_durations_random_prob_150pc$agent==agent], na.rm = TRUE))
  agents_list_random_prob_150pc$mean_duration[agent] <- ifelse(length(Facility_B_durations_random_prob_150pc$duration[Facility_B_durations_random_prob_150pc$agent==agent])==0,NA,mean(Facility_B_durations_random_prob_150pc$duration[Facility_B_durations_random_prob_150pc$agent==agent], na.rm = TRUE))
  agents_list_random_prob_150pc$median_duration[agent] <- ifelse(length(Facility_B_durations_random_prob_150pc$duration[Facility_B_durations_random_prob_150pc$agent==agent])==0,NA,median(Facility_B_durations_random_prob_150pc$duration[Facility_B_durations_random_prob_150pc$agent==agent], na.rm = TRUE))
  agents_list_random_prob_150pc$max_duration[agent] <- ifelse(length(Facility_B_durations_random_prob_150pc$duration[Facility_B_durations_random_prob_150pc$agent==agent])==0,NA,max(Facility_B_durations_random_prob_150pc$duration[Facility_B_durations_random_prob_150pc$agent==agent], na.rm = TRUE))
  agents_list_random_prob_150pc$times_persistent[agent] <- sum(Facility_B_durations_random_prob_150pc$duration[Facility_B_durations_random_prob_150pc$agent==agent]>agents_list_random_prob_150pc$ttp[agent])
  agent <- agent+1 
}

Facility_B_random_prob_150pc_agents_melted_monday_preop <- Facility_B_random_prob_150pc_agents_melted[which(Facility_B_random_prob_150pc_agents_melted$tick==33|Facility_B_random_prob_150pc_agents_melted$tick==201|Facility_B_random_prob_150pc_agents_melted$tick==369|Facility_B_random_prob_150pc_agents_melted$tick==537|Facility_B_random_prob_150pc_agents_melted$tick==705|Facility_B_random_prob_150pc_agents_melted$tick==873|Facility_B_random_prob_150pc_agents_melted$tick==1041|Facility_B_random_prob_150pc_agents_melted$tick==1209),]

Facility_B_random_prob_150pc_agents_melted_tuesday_preop <- Facility_B_random_prob_150pc_agents_melted[which(Facility_B_random_prob_150pc_agents_melted$tick==57|Facility_B_random_prob_150pc_agents_melted$tick==225|Facility_B_random_prob_150pc_agents_melted$tick==393|Facility_B_random_prob_150pc_agents_melted$tick==561|Facility_B_random_prob_150pc_agents_melted$tick==729|Facility_B_random_prob_150pc_agents_melted$tick==897|Facility_B_random_prob_150pc_agents_melted$tick==1065|Facility_B_random_prob_150pc_agents_melted$tick==1233),]

Facility_B_random_prob_150pc_agents_melted_wednesday_preop <- Facility_B_random_prob_150pc_agents_melted[which(Facility_B_random_prob_150pc_agents_melted$tick==81|Facility_B_random_prob_150pc_agents_melted$tick==249|Facility_B_random_prob_150pc_agents_melted$tick==417|Facility_B_random_prob_150pc_agents_melted$tick==585|Facility_B_random_prob_150pc_agents_melted$tick==753|Facility_B_random_prob_150pc_agents_melted$tick==921|Facility_B_random_prob_150pc_agents_melted$tick==1089|Facility_B_random_prob_150pc_agents_melted$tick==1257),]

Facility_B_random_prob_150pc_agents_melted_thursday_preop <- Facility_B_random_prob_150pc_agents_melted[which(Facility_B_random_prob_150pc_agents_melted$tick==105|Facility_B_random_prob_150pc_agents_melted$tick==273|Facility_B_random_prob_150pc_agents_melted$tick==441|Facility_B_random_prob_150pc_agents_melted$tick==609|Facility_B_random_prob_150pc_agents_melted$tick==777|Facility_B_random_prob_150pc_agents_melted$tick==945|Facility_B_random_prob_150pc_agents_melted$tick==1113|Facility_B_random_prob_150pc_agents_melted$tick==1281),]

Facility_B_random_prob_150pc_agents_melted_friday_preop <- Facility_B_random_prob_150pc_agents_melted[which(Facility_B_random_prob_150pc_agents_melted$tick==129|Facility_B_random_prob_150pc_agents_melted$tick==297|Facility_B_random_prob_150pc_agents_melted$tick==465|Facility_B_random_prob_150pc_agents_melted$tick==633|Facility_B_random_prob_150pc_agents_melted$tick==801|Facility_B_random_prob_150pc_agents_melted$tick==969|Facility_B_random_prob_150pc_agents_melted$tick==1137|Facility_B_random_prob_150pc_agents_melted$tick==1305),]

Facility_B_random_prob_150pc_agents_melted_ff <- as.ffdf(Facility_B_random_prob_150pc_agents_melted)
rm(Facility_B_random_prob_150pc_agents_melted)
gc()
```

```{r import Random Event Occurences 200% Delay Period}
NL_table_Random_Prob_200pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-28-13-09 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_P_Random_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Random_Prob_200pc <- NL_table_Random_Prob_200pc[NL_table_Random_Prob_200pc$scenario==32,]

while (any(grepl('-', names(NL_table_Random_Prob_200pc), fixed = TRUE))) {
  NL_table_Random_Prob_200pc <- NL_table_Random_Prob_200pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Random_Prob_200pc), fixed = TRUE))) {
  NL_table_Random_Prob_200pc <- NL_table_Random_Prob_200pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Random_Prob_200pc), fixed = TRUE))) {
  NL_table_Random_Prob_200pc <- NL_table_Random_Prob_200pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Random_Prob_200pc), fixed = TRUE))) {
  NL_table_Random_Prob_200pc <- NL_table_Random_Prob_200pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Random_Prob_200pc[ , ..list_columns]

NL_table_Random_Prob_200pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Random_Prob_200pc <- as.data.frame(NL_table_Random_Prob_200pc)

NL_table_Random_Prob_200pc[NL_table_Random_Prob_200pc==-1] <- NA

NL_table_Random_Prob_200pc <- subset(NL_table_Random_Prob_200pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Random_Prob_200pc)[names(NL_table_Random_Prob_200pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Random_Prob_200pc)[names(NL_table_Random_Prob_200pc)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Random_Prob_200pc$loading_w1wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_loading_w1wed_conc_list <- append(random_prob_200pc_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_loading_w1wed_conc_matrix <- matrix(unlist(random_prob_200pc_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_cleaning_w1wed_conc_list <- append(random_prob_200pc_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_cleaning_w1wed_conc_matrix <- matrix(unlist(random_prob_200pc_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_200pc$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_200pc_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_200pc_drying_w1wed_conc_list <- append(random_prob_200pc_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_200pc$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_sorting_w1wed_conc_list <- append(random_prob_200pc_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_sorting_w1wed_conc_matrix <- matrix(unlist(random_prob_200pc_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_tray_packing_w1wed_conc_list <- append(random_prob_200pc_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_tray_packing_w1wed_conc_matrix <- matrix(unlist(random_prob_200pc_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$reject_w1wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_reject_w1wed_conc_list <- append(random_prob_200pc_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_reject_w1wed_conc_matrix <- matrix(unlist(random_prob_200pc_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$other_w1wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_other_w1wed_conc_list <- append(random_prob_200pc_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_other_w1wed_conc_matrix <- matrix(unlist(random_prob_200pc_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_200pc_loading_concs <- as.data.frame(random_prob_200pc_loading_w1wed_conc_list)
random_prob_200pc_loading_concs$area <- as.factor('loading')
random_prob_200pc_loading_concs$scenario <- as.factor('PR_02')
random_prob_200pc_loading_concs$water <- as.factor('Wet')
names(random_prob_200pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_cleaning_concs <- as.data.frame(random_prob_200pc_cleaning_w1wed_conc_list)
random_prob_200pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_200pc_cleaning_concs$scenario <- as.factor('PR_02')
random_prob_200pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_200pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_sorting_concs <- as.data.frame(random_prob_200pc_sorting_w1wed_conc_list)
random_prob_200pc_sorting_concs$area <- as.factor('sorting')
random_prob_200pc_sorting_concs$scenario <- as.factor('PR_02')
random_prob_200pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_200pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_reject_concs <- as.data.frame(random_prob_200pc_reject_w1wed_conc_list)
random_prob_200pc_reject_concs$area <- as.factor('reject')
random_prob_200pc_reject_concs$scenario <- as.factor('PR_02')
random_prob_200pc_reject_concs$water <- as.factor('Dry')
names(random_prob_200pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_tray_packing_concs <- as.data.frame(random_prob_200pc_tray_packing_w1wed_conc_list)
random_prob_200pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_200pc_tray_packing_concs$scenario <- as.factor('PR_02')
random_prob_200pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_200pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_other_concs <- as.data.frame(random_prob_200pc_other_w1wed_conc_list)
random_prob_200pc_other_concs$area <- as.factor('other')
random_prob_200pc_other_concs$scenario <- as.factor('PR_02')
random_prob_200pc_other_concs$water <- as.factor('Dry')
names(random_prob_200pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_w1wed_concs <- rbind(random_prob_200pc_loading_concs,random_prob_200pc_cleaning_concs,random_prob_200pc_sorting_concs,random_prob_200pc_tray_packing_concs,random_prob_200pc_reject_concs,random_prob_200pc_other_concs)

random_prob_200pc_loading_prev <- as.data.frame(NL_table_Random_Prob_200pc$loading_w1wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_loading_prev$area <- as.factor('loading')
random_prob_200pc_loading_prev$scenario <- as.factor('PR_02')
random_prob_200pc_loading_prev$water <- as.factor('Wet')
names(random_prob_200pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_200pc$cleaning_w1wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_200pc_cleaning_prev$scenario <- as.factor('PR_02')
random_prob_200pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_200pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_200pc$sorting_w1wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_sorting_prev$area <- as.factor('sorting')
random_prob_200pc_sorting_prev$scenario <- as.factor('PR_02')
random_prob_200pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_200pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_reject_prev <- as.data.frame(NL_table_Random_Prob_200pc$reject_w1wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_reject_prev$area <- as.factor('reject')
random_prob_200pc_reject_prev$scenario <- as.factor('PR_02')
random_prob_200pc_reject_prev$water <- as.factor('Dry')
names(random_prob_200pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_200pc$tray_packing_w1wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_200pc_tray_packing_prev$scenario <- as.factor('PR_02')
random_prob_200pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_200pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_other_prev <- as.data.frame(NL_table_Random_Prob_200pc$other_w1wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_other_prev$area <- as.factor('other')
random_prob_200pc_other_prev$scenario <- as.factor('PR_02')
random_prob_200pc_other_prev$water <- as.factor('Dry')
names(random_prob_200pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_w1wed_prev <- rbind(random_prob_200pc_loading_prev,random_prob_200pc_cleaning_prev,random_prob_200pc_sorting_prev,random_prob_200pc_tray_packing_prev,random_prob_200pc_reject_prev,random_prob_200pc_other_prev)

random_prob_200pc_w1wed_wet_prev <- as.data.frame(random_prob_200pc_loading_prev$prevalence*21/100+random_prob_200pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_200pc_w1wed_wet_prev$scenario <- as.factor('PR_02')
random_prob_200pc_w1wed_wet_prev$water <- as.factor('Wet')
names(random_prob_200pc_w1wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_200pc_w1wed_dry_prev <- as.data.frame(random_prob_200pc_sorting_prev$prevalence*20/100+random_prob_200pc_reject_prev$prevalence*23/100+random_prob_200pc_tray_packing_prev$prevalence*123/100+random_prob_200pc_other_prev$prevalence*10/100)/176*100
random_prob_200pc_w1wed_dry_prev$scenario <- as.factor('PR_02')
random_prob_200pc_w1wed_dry_prev$water <- as.factor('Dry')
names(random_prob_200pc_w1wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_200pc_w1wed_recombined_prev <- rbind(random_prob_200pc_w1wed_wet_prev, random_prob_200pc_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Random_Prob_200pc$loading_w2wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_loading_w2wed_conc_list <- append(random_prob_200pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_loading_w2wed_conc_matrix <- matrix(unlist(random_prob_200pc_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_cleaning_w2wed_conc_list <- append(random_prob_200pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_cleaning_w2wed_conc_matrix <- matrix(unlist(random_prob_200pc_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_200pc$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_200pc_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_200pc_drying_w2wed_conc_list <- append(random_prob_200pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_200pc$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_sorting_w2wed_conc_list <- append(random_prob_200pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_sorting_w2wed_conc_matrix <- matrix(unlist(random_prob_200pc_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_tray_packing_w2wed_conc_list <- append(random_prob_200pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_tray_packing_w2wed_conc_matrix <- matrix(unlist(random_prob_200pc_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$reject_w2wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_reject_w2wed_conc_list <- append(random_prob_200pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_reject_w2wed_conc_matrix <- matrix(unlist(random_prob_200pc_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$other_w2wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_other_w2wed_conc_list <- append(random_prob_200pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_other_w2wed_conc_matrix <- matrix(unlist(random_prob_200pc_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_200pc_loading_concs <- as.data.frame(random_prob_200pc_loading_w2wed_conc_list)
random_prob_200pc_loading_concs$area <- as.factor('loading')
random_prob_200pc_loading_concs$scenario <- as.factor('PR_02')
random_prob_200pc_loading_concs$water <- as.factor('Wet')
names(random_prob_200pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_cleaning_concs <- as.data.frame(random_prob_200pc_cleaning_w2wed_conc_list)
random_prob_200pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_200pc_cleaning_concs$scenario <- as.factor('PR_02')
random_prob_200pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_200pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_sorting_concs <- as.data.frame(random_prob_200pc_sorting_w2wed_conc_list)
random_prob_200pc_sorting_concs$area <- as.factor('sorting')
random_prob_200pc_sorting_concs$scenario <- as.factor('PR_02')
random_prob_200pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_200pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_reject_concs <- as.data.frame(random_prob_200pc_reject_w2wed_conc_list)
random_prob_200pc_reject_concs$area <- as.factor('reject')
random_prob_200pc_reject_concs$scenario <- as.factor('PR_02')
random_prob_200pc_reject_concs$water <- as.factor('Dry')
names(random_prob_200pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_tray_packing_concs <- as.data.frame(random_prob_200pc_tray_packing_w2wed_conc_list)
random_prob_200pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_200pc_tray_packing_concs$scenario <- as.factor('PR_02')
random_prob_200pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_200pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_other_concs <- as.data.frame(random_prob_200pc_other_w2wed_conc_list)
random_prob_200pc_other_concs$area <- as.factor('other')
random_prob_200pc_other_concs$scenario <- as.factor('PR_02')
random_prob_200pc_other_concs$water <- as.factor('Dry')
names(random_prob_200pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_w2wed_concs <- rbind(random_prob_200pc_loading_concs,random_prob_200pc_cleaning_concs,random_prob_200pc_sorting_concs,random_prob_200pc_tray_packing_concs,random_prob_200pc_reject_concs,random_prob_200pc_other_concs)

random_prob_200pc_loading_prev <- as.data.frame(NL_table_Random_Prob_200pc$loading_w2wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_loading_prev$area <- as.factor('loading')
random_prob_200pc_loading_prev$scenario <- as.factor('PR_02')
random_prob_200pc_loading_prev$water <- as.factor('Wet')
names(random_prob_200pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_200pc$cleaning_w2wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_200pc_cleaning_prev$scenario <- as.factor('PR_02')
random_prob_200pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_200pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_200pc$sorting_w2wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_sorting_prev$area <- as.factor('sorting')
random_prob_200pc_sorting_prev$scenario <- as.factor('PR_02')
random_prob_200pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_200pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_reject_prev <- as.data.frame(NL_table_Random_Prob_200pc$reject_w2wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_reject_prev$area <- as.factor('reject')
random_prob_200pc_reject_prev$scenario <- as.factor('PR_02')
random_prob_200pc_reject_prev$water <- as.factor('Dry')
names(random_prob_200pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_200pc$tray_packing_w2wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_200pc_tray_packing_prev$scenario <- as.factor('PR_02')
random_prob_200pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_200pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_other_prev <- as.data.frame(NL_table_Random_Prob_200pc$other_w2wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_other_prev$area <- as.factor('other')
random_prob_200pc_other_prev$scenario <- as.factor('PR_02')
random_prob_200pc_other_prev$water <- as.factor('Dry')
names(random_prob_200pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_w2wed_prev <- rbind(random_prob_200pc_loading_prev,random_prob_200pc_cleaning_prev,random_prob_200pc_sorting_prev,random_prob_200pc_tray_packing_prev,random_prob_200pc_reject_prev,random_prob_200pc_other_prev)

random_prob_200pc_w2wed_wet_prev <- as.data.frame(random_prob_200pc_loading_prev$prevalence*21/100+random_prob_200pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_200pc_w2wed_wet_prev$scenario <- as.factor('PR_02')
random_prob_200pc_w2wed_wet_prev$water <- as.factor('Wet')
names(random_prob_200pc_w2wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_200pc_w2wed_dry_prev <- as.data.frame(random_prob_200pc_sorting_prev$prevalence*20/100+random_prob_200pc_reject_prev$prevalence*23/100+random_prob_200pc_tray_packing_prev$prevalence*123/100+random_prob_200pc_other_prev$prevalence*10/100)/176*100
random_prob_200pc_w2wed_dry_prev$scenario <- as.factor('PR_02')
random_prob_200pc_w2wed_dry_prev$water <- as.factor('Dry')
names(random_prob_200pc_w2wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_200pc_w2wed_recombined_prev <- rbind(random_prob_200pc_w2wed_wet_prev, random_prob_200pc_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Random_Prob_200pc$loading_w3wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_loading_w3wed_conc_list <- append(random_prob_200pc_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_loading_w3wed_conc_matrix <- matrix(unlist(random_prob_200pc_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_cleaning_w3wed_conc_list <- append(random_prob_200pc_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_cleaning_w3wed_conc_matrix <- matrix(unlist(random_prob_200pc_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_200pc$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_200pc_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_200pc_drying_w3wed_conc_list <- append(random_prob_200pc_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_200pc$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_sorting_w3wed_conc_list <- append(random_prob_200pc_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_sorting_w3wed_conc_matrix <- matrix(unlist(random_prob_200pc_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_tray_packing_w3wed_conc_list <- append(random_prob_200pc_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_tray_packing_w3wed_conc_matrix <- matrix(unlist(random_prob_200pc_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$reject_w3wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_reject_w3wed_conc_list <- append(random_prob_200pc_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_reject_w3wed_conc_matrix <- matrix(unlist(random_prob_200pc_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$other_w3wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_other_w3wed_conc_list <- append(random_prob_200pc_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_other_w3wed_conc_matrix <- matrix(unlist(random_prob_200pc_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_200pc_loading_concs <- as.data.frame(random_prob_200pc_loading_w3wed_conc_list)
random_prob_200pc_loading_concs$area <- as.factor('loading')
random_prob_200pc_loading_concs$scenario <- as.factor('PR_02')
random_prob_200pc_loading_concs$water <- as.factor('Wet')
names(random_prob_200pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_cleaning_concs <- as.data.frame(random_prob_200pc_cleaning_w3wed_conc_list)
random_prob_200pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_200pc_cleaning_concs$scenario <- as.factor('PR_02')
random_prob_200pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_200pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_sorting_concs <- as.data.frame(random_prob_200pc_sorting_w3wed_conc_list)
random_prob_200pc_sorting_concs$area <- as.factor('sorting')
random_prob_200pc_sorting_concs$scenario <- as.factor('PR_02')
random_prob_200pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_200pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_reject_concs <- as.data.frame(random_prob_200pc_reject_w3wed_conc_list)
random_prob_200pc_reject_concs$area <- as.factor('reject')
random_prob_200pc_reject_concs$scenario <- as.factor('PR_02')
random_prob_200pc_reject_concs$water <- as.factor('Dry')
names(random_prob_200pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_tray_packing_concs <- as.data.frame(random_prob_200pc_tray_packing_w3wed_conc_list)
random_prob_200pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_200pc_tray_packing_concs$scenario <- as.factor('PR_02')
random_prob_200pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_200pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_other_concs <- as.data.frame(random_prob_200pc_other_w3wed_conc_list)
random_prob_200pc_other_concs$area <- as.factor('other')
random_prob_200pc_other_concs$scenario <- as.factor('PR_02')
random_prob_200pc_other_concs$water <- as.factor('Dry')
names(random_prob_200pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_w3wed_concs <- rbind(random_prob_200pc_loading_concs,random_prob_200pc_cleaning_concs,random_prob_200pc_sorting_concs,random_prob_200pc_tray_packing_concs,random_prob_200pc_reject_concs,random_prob_200pc_other_concs)

random_prob_200pc_loading_prev <- as.data.frame(NL_table_Random_Prob_200pc$loading_w3wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_loading_prev$area <- as.factor('loading')
random_prob_200pc_loading_prev$scenario <- as.factor('PR_02')
random_prob_200pc_loading_prev$water <- as.factor('Wet')
names(random_prob_200pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_200pc$cleaning_w3wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_200pc_cleaning_prev$scenario <- as.factor('PR_02')
random_prob_200pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_200pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_200pc$sorting_w3wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_sorting_prev$area <- as.factor('sorting')
random_prob_200pc_sorting_prev$scenario <- as.factor('PR_02')
random_prob_200pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_200pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_reject_prev <- as.data.frame(NL_table_Random_Prob_200pc$reject_w3wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_reject_prev$area <- as.factor('reject')
random_prob_200pc_reject_prev$scenario <- as.factor('PR_02')
random_prob_200pc_reject_prev$water <- as.factor('Dry')
names(random_prob_200pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_200pc$tray_packing_w3wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_200pc_tray_packing_prev$scenario <- as.factor('PR_02')
random_prob_200pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_200pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_other_prev <- as.data.frame(NL_table_Random_Prob_200pc$other_w3wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_other_prev$area <- as.factor('other')
random_prob_200pc_other_prev$scenario <- as.factor('PR_02')
random_prob_200pc_other_prev$water <- as.factor('Dry')
names(random_prob_200pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_w3wed_prev <- rbind(random_prob_200pc_loading_prev,random_prob_200pc_cleaning_prev,random_prob_200pc_sorting_prev,random_prob_200pc_tray_packing_prev,random_prob_200pc_reject_prev,random_prob_200pc_other_prev)

random_prob_200pc_w3wed_wet_prev <- as.data.frame(random_prob_200pc_loading_prev$prevalence*21/100+random_prob_200pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_200pc_w3wed_wet_prev$scenario <- as.factor('PR_02')
random_prob_200pc_w3wed_wet_prev$water <- as.factor('Wet')
names(random_prob_200pc_w3wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_200pc_w3wed_dry_prev <- as.data.frame(random_prob_200pc_sorting_prev$prevalence*20/100+random_prob_200pc_reject_prev$prevalence*23/100+random_prob_200pc_tray_packing_prev$prevalence*123/100+random_prob_200pc_other_prev$prevalence*10/100)/176*100
random_prob_200pc_w3wed_dry_prev$scenario <- as.factor('PR_02')
random_prob_200pc_w3wed_dry_prev$water <- as.factor('Dry')
names(random_prob_200pc_w3wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_200pc_w3wed_recombined_prev <- rbind(random_prob_200pc_w3wed_wet_prev, random_prob_200pc_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Random_Prob_200pc$loading_w4wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_loading_w4wed_conc_list <- append(random_prob_200pc_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_loading_w4wed_conc_matrix <- matrix(unlist(random_prob_200pc_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_cleaning_w4wed_conc_list <- append(random_prob_200pc_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_cleaning_w4wed_conc_matrix <- matrix(unlist(random_prob_200pc_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_200pc$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_200pc_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_200pc_drying_w4wed_conc_list <- append(random_prob_200pc_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_200pc$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_sorting_w4wed_conc_list <- append(random_prob_200pc_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_sorting_w4wed_conc_matrix <- matrix(unlist(random_prob_200pc_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_tray_packing_w4wed_conc_list <- append(random_prob_200pc_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_tray_packing_w4wed_conc_matrix <- matrix(unlist(random_prob_200pc_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$reject_w4wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_reject_w4wed_conc_list <- append(random_prob_200pc_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_reject_w4wed_conc_matrix <- matrix(unlist(random_prob_200pc_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$other_w4wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_other_w4wed_conc_list <- append(random_prob_200pc_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_other_w4wed_conc_matrix <- matrix(unlist(random_prob_200pc_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_200pc_loading_concs <- as.data.frame(random_prob_200pc_loading_w4wed_conc_list)
random_prob_200pc_loading_concs$area <- as.factor('loading')
random_prob_200pc_loading_concs$scenario <- as.factor('PR_02')
random_prob_200pc_loading_concs$water <- as.factor('Wet')
names(random_prob_200pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_cleaning_concs <- as.data.frame(random_prob_200pc_cleaning_w4wed_conc_list)
random_prob_200pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_200pc_cleaning_concs$scenario <- as.factor('PR_02')
random_prob_200pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_200pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_sorting_concs <- as.data.frame(random_prob_200pc_sorting_w4wed_conc_list)
random_prob_200pc_sorting_concs$area <- as.factor('sorting')
random_prob_200pc_sorting_concs$scenario <- as.factor('PR_02')
random_prob_200pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_200pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_reject_concs <- as.data.frame(random_prob_200pc_reject_w4wed_conc_list)
random_prob_200pc_reject_concs$area <- as.factor('reject')
random_prob_200pc_reject_concs$scenario <- as.factor('PR_02')
random_prob_200pc_reject_concs$water <- as.factor('Dry')
names(random_prob_200pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_tray_packing_concs <- as.data.frame(random_prob_200pc_tray_packing_w4wed_conc_list)
random_prob_200pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_200pc_tray_packing_concs$scenario <- as.factor('PR_02')
random_prob_200pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_200pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_other_concs <- as.data.frame(random_prob_200pc_other_w4wed_conc_list)
random_prob_200pc_other_concs$area <- as.factor('other')
random_prob_200pc_other_concs$scenario <- as.factor('PR_02')
random_prob_200pc_other_concs$water <- as.factor('Dry')
names(random_prob_200pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_w4wed_concs <- rbind(random_prob_200pc_loading_concs,random_prob_200pc_cleaning_concs,random_prob_200pc_sorting_concs,random_prob_200pc_tray_packing_concs,random_prob_200pc_reject_concs,random_prob_200pc_other_concs)

random_prob_200pc_loading_prev <- as.data.frame(NL_table_Random_Prob_200pc$loading_w4wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_loading_prev$area <- as.factor('loading')
random_prob_200pc_loading_prev$scenario <- as.factor('PR_02')
random_prob_200pc_loading_prev$water <- as.factor('Wet')
names(random_prob_200pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_200pc$cleaning_w4wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_200pc_cleaning_prev$scenario <- as.factor('PR_02')
random_prob_200pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_200pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_200pc$sorting_w4wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_sorting_prev$area <- as.factor('sorting')
random_prob_200pc_sorting_prev$scenario <- as.factor('PR_02')
random_prob_200pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_200pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_reject_prev <- as.data.frame(NL_table_Random_Prob_200pc$reject_w4wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_reject_prev$area <- as.factor('reject')
random_prob_200pc_reject_prev$scenario <- as.factor('PR_02')
random_prob_200pc_reject_prev$water <- as.factor('Dry')
names(random_prob_200pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_200pc$tray_packing_w4wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_200pc_tray_packing_prev$scenario <- as.factor('PR_02')
random_prob_200pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_200pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_other_prev <- as.data.frame(NL_table_Random_Prob_200pc$other_w4wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_other_prev$area <- as.factor('other')
random_prob_200pc_other_prev$scenario <- as.factor('PR_02')
random_prob_200pc_other_prev$water <- as.factor('Dry')
names(random_prob_200pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_w4wed_prev <- rbind(random_prob_200pc_loading_prev,random_prob_200pc_cleaning_prev,random_prob_200pc_sorting_prev,random_prob_200pc_tray_packing_prev,random_prob_200pc_reject_prev,random_prob_200pc_other_prev)

random_prob_200pc_w4wed_wet_prev <- as.data.frame(random_prob_200pc_loading_prev$prevalence*21/100+random_prob_200pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_200pc_w4wed_wet_prev$scenario <- as.factor('PR_02')
random_prob_200pc_w4wed_wet_prev$water <- as.factor('Wet')
names(random_prob_200pc_w4wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_200pc_w4wed_dry_prev <- as.data.frame(random_prob_200pc_sorting_prev$prevalence*20/100+random_prob_200pc_reject_prev$prevalence*23/100+random_prob_200pc_tray_packing_prev$prevalence*123/100+random_prob_200pc_other_prev$prevalence*10/100)/176*100
random_prob_200pc_w4wed_dry_prev$scenario <- as.factor('PR_02')
random_prob_200pc_w4wed_dry_prev$water <- as.factor('Dry')
names(random_prob_200pc_w4wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_200pc_w4wed_recombined_prev <- rbind(random_prob_200pc_w4wed_wet_prev, random_prob_200pc_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Random_Prob_200pc$loading_w5wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_loading_w5wed_conc_list <- append(random_prob_200pc_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_loading_w5wed_conc_matrix <- matrix(unlist(random_prob_200pc_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_cleaning_w5wed_conc_list <- append(random_prob_200pc_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_cleaning_w5wed_conc_matrix <- matrix(unlist(random_prob_200pc_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_200pc$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_200pc_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_200pc_drying_w5wed_conc_list <- append(random_prob_200pc_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_200pc$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_sorting_w5wed_conc_list <- append(random_prob_200pc_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_sorting_w5wed_conc_matrix <- matrix(unlist(random_prob_200pc_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_tray_packing_w5wed_conc_list <- append(random_prob_200pc_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_tray_packing_w5wed_conc_matrix <- matrix(unlist(random_prob_200pc_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$reject_w5wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_reject_w5wed_conc_list <- append(random_prob_200pc_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_reject_w5wed_conc_matrix <- matrix(unlist(random_prob_200pc_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$other_w5wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_other_w5wed_conc_list <- append(random_prob_200pc_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_other_w5wed_conc_matrix <- matrix(unlist(random_prob_200pc_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_200pc_loading_concs <- as.data.frame(random_prob_200pc_loading_w5wed_conc_list)
random_prob_200pc_loading_concs$area <- as.factor('loading')
random_prob_200pc_loading_concs$scenario <- as.factor('PR_02')
random_prob_200pc_loading_concs$water <- as.factor('Wet')
names(random_prob_200pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_cleaning_concs <- as.data.frame(random_prob_200pc_cleaning_w5wed_conc_list)
random_prob_200pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_200pc_cleaning_concs$scenario <- as.factor('PR_02')
random_prob_200pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_200pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_sorting_concs <- as.data.frame(random_prob_200pc_sorting_w5wed_conc_list)
random_prob_200pc_sorting_concs$area <- as.factor('sorting')
random_prob_200pc_sorting_concs$scenario <- as.factor('PR_02')
random_prob_200pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_200pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_reject_concs <- as.data.frame(random_prob_200pc_reject_w5wed_conc_list)
random_prob_200pc_reject_concs$area <- as.factor('reject')
random_prob_200pc_reject_concs$scenario <- as.factor('PR_02')
random_prob_200pc_reject_concs$water <- as.factor('Dry')
names(random_prob_200pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_tray_packing_concs <- as.data.frame(random_prob_200pc_tray_packing_w5wed_conc_list)
random_prob_200pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_200pc_tray_packing_concs$scenario <- as.factor('PR_02')
random_prob_200pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_200pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_other_concs <- as.data.frame(random_prob_200pc_other_w5wed_conc_list)
random_prob_200pc_other_concs$area <- as.factor('other')
random_prob_200pc_other_concs$scenario <- as.factor('PR_02')
random_prob_200pc_other_concs$water <- as.factor('Dry')
names(random_prob_200pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_w5wed_concs <- rbind(random_prob_200pc_loading_concs,random_prob_200pc_cleaning_concs,random_prob_200pc_sorting_concs,random_prob_200pc_tray_packing_concs,random_prob_200pc_reject_concs,random_prob_200pc_other_concs)

random_prob_200pc_loading_prev <- as.data.frame(NL_table_Random_Prob_200pc$loading_w5wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_loading_prev$area <- as.factor('loading')
random_prob_200pc_loading_prev$scenario <- as.factor('PR_02')
random_prob_200pc_loading_prev$water <- as.factor('Wet')
names(random_prob_200pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_200pc$cleaning_w5wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_200pc_cleaning_prev$scenario <- as.factor('PR_02')
random_prob_200pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_200pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_200pc$sorting_w5wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_sorting_prev$area <- as.factor('sorting')
random_prob_200pc_sorting_prev$scenario <- as.factor('PR_02')
random_prob_200pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_200pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_reject_prev <- as.data.frame(NL_table_Random_Prob_200pc$reject_w5wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_reject_prev$area <- as.factor('reject')
random_prob_200pc_reject_prev$scenario <- as.factor('PR_02')
random_prob_200pc_reject_prev$water <- as.factor('Dry')
names(random_prob_200pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_200pc$tray_packing_w5wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_200pc_tray_packing_prev$scenario <- as.factor('PR_02')
random_prob_200pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_200pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_other_prev <- as.data.frame(NL_table_Random_Prob_200pc$other_w5wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_other_prev$area <- as.factor('other')
random_prob_200pc_other_prev$scenario <- as.factor('PR_02')
random_prob_200pc_other_prev$water <- as.factor('Dry')
names(random_prob_200pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_w5wed_prev <- rbind(random_prob_200pc_loading_prev,random_prob_200pc_cleaning_prev,random_prob_200pc_sorting_prev,random_prob_200pc_tray_packing_prev,random_prob_200pc_reject_prev,random_prob_200pc_other_prev)

random_prob_200pc_w5wed_wet_prev <- as.data.frame(random_prob_200pc_loading_prev$prevalence*21/100+random_prob_200pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_200pc_w5wed_wet_prev$scenario <- as.factor('PR_02')
random_prob_200pc_w5wed_wet_prev$water <- as.factor('Wet')
names(random_prob_200pc_w5wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_200pc_w5wed_dry_prev <- as.data.frame(random_prob_200pc_sorting_prev$prevalence*20/100+random_prob_200pc_reject_prev$prevalence*23/100+random_prob_200pc_tray_packing_prev$prevalence*123/100+random_prob_200pc_other_prev$prevalence*10/100)/176*100
random_prob_200pc_w5wed_dry_prev$scenario <- as.factor('PR_02')
random_prob_200pc_w5wed_dry_prev$water <- as.factor('Dry')
names(random_prob_200pc_w5wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_200pc_w5wed_recombined_prev <- rbind(random_prob_200pc_w5wed_wet_prev, random_prob_200pc_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Random_Prob_200pc$loading_w6wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_loading_w6wed_conc_list <- append(random_prob_200pc_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_loading_w6wed_conc_matrix <- matrix(unlist(random_prob_200pc_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_cleaning_w6wed_conc_list <- append(random_prob_200pc_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_cleaning_w6wed_conc_matrix <- matrix(unlist(random_prob_200pc_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_200pc$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_200pc_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_200pc_drying_w6wed_conc_list <- append(random_prob_200pc_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_200pc$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_sorting_w6wed_conc_list <- append(random_prob_200pc_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_sorting_w6wed_conc_matrix <- matrix(unlist(random_prob_200pc_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_tray_packing_w6wed_conc_list <- append(random_prob_200pc_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_tray_packing_w6wed_conc_matrix <- matrix(unlist(random_prob_200pc_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$reject_w6wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_reject_w6wed_conc_list <- append(random_prob_200pc_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_reject_w6wed_conc_matrix <- matrix(unlist(random_prob_200pc_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$other_w6wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_other_w6wed_conc_list <- append(random_prob_200pc_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_other_w6wed_conc_matrix <- matrix(unlist(random_prob_200pc_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_200pc_loading_concs <- as.data.frame(random_prob_200pc_loading_w6wed_conc_list)
random_prob_200pc_loading_concs$area <- as.factor('loading')
random_prob_200pc_loading_concs$scenario <- as.factor('PR_02')
random_prob_200pc_loading_concs$water <- as.factor('Wet')
names(random_prob_200pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_cleaning_concs <- as.data.frame(random_prob_200pc_cleaning_w6wed_conc_list)
random_prob_200pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_200pc_cleaning_concs$scenario <- as.factor('PR_02')
random_prob_200pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_200pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_sorting_concs <- as.data.frame(random_prob_200pc_sorting_w6wed_conc_list)
random_prob_200pc_sorting_concs$area <- as.factor('sorting')
random_prob_200pc_sorting_concs$scenario <- as.factor('PR_02')
random_prob_200pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_200pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_reject_concs <- as.data.frame(random_prob_200pc_reject_w6wed_conc_list)
random_prob_200pc_reject_concs$area <- as.factor('reject')
random_prob_200pc_reject_concs$scenario <- as.factor('PR_02')
random_prob_200pc_reject_concs$water <- as.factor('Dry')
names(random_prob_200pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_tray_packing_concs <- as.data.frame(random_prob_200pc_tray_packing_w6wed_conc_list)
random_prob_200pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_200pc_tray_packing_concs$scenario <- as.factor('PR_02')
random_prob_200pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_200pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_other_concs <- as.data.frame(random_prob_200pc_other_w6wed_conc_list)
random_prob_200pc_other_concs$area <- as.factor('other')
random_prob_200pc_other_concs$scenario <- as.factor('PR_02')
random_prob_200pc_other_concs$water <- as.factor('Dry')
names(random_prob_200pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_w6wed_concs <- rbind(random_prob_200pc_loading_concs,random_prob_200pc_cleaning_concs,random_prob_200pc_sorting_concs,random_prob_200pc_tray_packing_concs,random_prob_200pc_reject_concs,random_prob_200pc_other_concs)

random_prob_200pc_loading_prev <- as.data.frame(NL_table_Random_Prob_200pc$loading_w6wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_loading_prev$area <- as.factor('loading')
random_prob_200pc_loading_prev$scenario <- as.factor('PR_02')
random_prob_200pc_loading_prev$water <- as.factor('Wet')
names(random_prob_200pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_200pc$cleaning_w6wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_200pc_cleaning_prev$scenario <- as.factor('PR_02')
random_prob_200pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_200pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_200pc$sorting_w6wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_sorting_prev$area <- as.factor('sorting')
random_prob_200pc_sorting_prev$scenario <- as.factor('PR_02')
random_prob_200pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_200pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_reject_prev <- as.data.frame(NL_table_Random_Prob_200pc$reject_w6wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_reject_prev$area <- as.factor('reject')
random_prob_200pc_reject_prev$scenario <- as.factor('PR_02')
random_prob_200pc_reject_prev$water <- as.factor('Dry')
names(random_prob_200pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_200pc$tray_packing_w6wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_200pc_tray_packing_prev$scenario <- as.factor('PR_02')
random_prob_200pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_200pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_other_prev <- as.data.frame(NL_table_Random_Prob_200pc$other_w6wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_other_prev$area <- as.factor('other')
random_prob_200pc_other_prev$scenario <- as.factor('PR_02')
random_prob_200pc_other_prev$water <- as.factor('Dry')
names(random_prob_200pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_w6wed_prev <- rbind(random_prob_200pc_loading_prev,random_prob_200pc_cleaning_prev,random_prob_200pc_sorting_prev,random_prob_200pc_tray_packing_prev,random_prob_200pc_reject_prev,random_prob_200pc_other_prev)

random_prob_200pc_w6wed_wet_prev <- as.data.frame(random_prob_200pc_loading_prev$prevalence*21/100+random_prob_200pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_200pc_w6wed_wet_prev$scenario <- as.factor('PR_02')
random_prob_200pc_w6wed_wet_prev$water <- as.factor('Wet')
names(random_prob_200pc_w6wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_200pc_w6wed_dry_prev <- as.data.frame(random_prob_200pc_sorting_prev$prevalence*20/100+random_prob_200pc_reject_prev$prevalence*23/100+random_prob_200pc_tray_packing_prev$prevalence*123/100+random_prob_200pc_other_prev$prevalence*10/100)/176*100
random_prob_200pc_w6wed_dry_prev$scenario <- as.factor('PR_02')
random_prob_200pc_w6wed_dry_prev$water <- as.factor('Dry')
names(random_prob_200pc_w6wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_200pc_w6wed_recombined_prev <- rbind(random_prob_200pc_w6wed_wet_prev, random_prob_200pc_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Random_Prob_200pc$loading_w7wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_loading_w7wed_conc_list <- append(random_prob_200pc_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_loading_w7wed_conc_matrix <- matrix(unlist(random_prob_200pc_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_cleaning_w7wed_conc_list <- append(random_prob_200pc_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_cleaning_w7wed_conc_matrix <- matrix(unlist(random_prob_200pc_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_200pc$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_200pc_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_200pc_drying_w7wed_conc_list <- append(random_prob_200pc_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_200pc$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_sorting_w7wed_conc_list <- append(random_prob_200pc_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_sorting_w7wed_conc_matrix <- matrix(unlist(random_prob_200pc_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_tray_packing_w7wed_conc_list <- append(random_prob_200pc_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_tray_packing_w7wed_conc_matrix <- matrix(unlist(random_prob_200pc_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$reject_w7wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_reject_w7wed_conc_list <- append(random_prob_200pc_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_reject_w7wed_conc_matrix <- matrix(unlist(random_prob_200pc_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$other_w7wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_other_w7wed_conc_list <- append(random_prob_200pc_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_other_w7wed_conc_matrix <- matrix(unlist(random_prob_200pc_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_200pc_loading_concs <- as.data.frame(random_prob_200pc_loading_w7wed_conc_list)
random_prob_200pc_loading_concs$area <- as.factor('loading')
random_prob_200pc_loading_concs$scenario <- as.factor('PR_02')
random_prob_200pc_loading_concs$water <- as.factor('Wet')
names(random_prob_200pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_cleaning_concs <- as.data.frame(random_prob_200pc_cleaning_w7wed_conc_list)
random_prob_200pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_200pc_cleaning_concs$scenario <- as.factor('PR_02')
random_prob_200pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_200pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_sorting_concs <- as.data.frame(random_prob_200pc_sorting_w7wed_conc_list)
random_prob_200pc_sorting_concs$area <- as.factor('sorting')
random_prob_200pc_sorting_concs$scenario <- as.factor('PR_02')
random_prob_200pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_200pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_reject_concs <- as.data.frame(random_prob_200pc_reject_w7wed_conc_list)
random_prob_200pc_reject_concs$area <- as.factor('reject')
random_prob_200pc_reject_concs$scenario <- as.factor('PR_02')
random_prob_200pc_reject_concs$water <- as.factor('Dry')
names(random_prob_200pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_tray_packing_concs <- as.data.frame(random_prob_200pc_tray_packing_w7wed_conc_list)
random_prob_200pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_200pc_tray_packing_concs$scenario <- as.factor('PR_02')
random_prob_200pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_200pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_other_concs <- as.data.frame(random_prob_200pc_other_w7wed_conc_list)
random_prob_200pc_other_concs$area <- as.factor('other')
random_prob_200pc_other_concs$scenario <- as.factor('PR_02')
random_prob_200pc_other_concs$water <- as.factor('Dry')
names(random_prob_200pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_w7wed_concs <- rbind(random_prob_200pc_loading_concs,random_prob_200pc_cleaning_concs,random_prob_200pc_sorting_concs,random_prob_200pc_tray_packing_concs,random_prob_200pc_reject_concs,random_prob_200pc_other_concs)

random_prob_200pc_loading_prev <- as.data.frame(NL_table_Random_Prob_200pc$loading_w7wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_loading_prev$area <- as.factor('loading')
random_prob_200pc_loading_prev$scenario <- as.factor('PR_02')
random_prob_200pc_loading_prev$water <- as.factor('Wet')
names(random_prob_200pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_200pc$cleaning_w7wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_200pc_cleaning_prev$scenario <- as.factor('PR_02')
random_prob_200pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_200pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_200pc$sorting_w7wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_sorting_prev$area <- as.factor('sorting')
random_prob_200pc_sorting_prev$scenario <- as.factor('PR_02')
random_prob_200pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_200pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_reject_prev <- as.data.frame(NL_table_Random_Prob_200pc$reject_w7wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_reject_prev$area <- as.factor('reject')
random_prob_200pc_reject_prev$scenario <- as.factor('PR_02')
random_prob_200pc_reject_prev$water <- as.factor('Dry')
names(random_prob_200pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_200pc$tray_packing_w7wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_200pc_tray_packing_prev$scenario <- as.factor('PR_02')
random_prob_200pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_200pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_other_prev <- as.data.frame(NL_table_Random_Prob_200pc$other_w7wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_other_prev$area <- as.factor('other')
random_prob_200pc_other_prev$scenario <- as.factor('PR_02')
random_prob_200pc_other_prev$water <- as.factor('Dry')
names(random_prob_200pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_w7wed_prev <- rbind(random_prob_200pc_loading_prev,random_prob_200pc_cleaning_prev,random_prob_200pc_sorting_prev,random_prob_200pc_tray_packing_prev,random_prob_200pc_reject_prev,random_prob_200pc_other_prev)

random_prob_200pc_w7wed_wet_prev <- as.data.frame(random_prob_200pc_loading_prev$prevalence*21/100+random_prob_200pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_200pc_w7wed_wet_prev$scenario <- as.factor('PR_02')
random_prob_200pc_w7wed_wet_prev$water <- as.factor('Wet')
names(random_prob_200pc_w7wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_200pc_w7wed_dry_prev <- as.data.frame(random_prob_200pc_sorting_prev$prevalence*20/100+random_prob_200pc_reject_prev$prevalence*23/100+random_prob_200pc_tray_packing_prev$prevalence*123/100+random_prob_200pc_other_prev$prevalence*10/100)/176*100
random_prob_200pc_w7wed_dry_prev$scenario <- as.factor('PR_02')
random_prob_200pc_w7wed_dry_prev$water <- as.factor('Dry')
names(random_prob_200pc_w7wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_200pc_w7wed_recombined_prev <- rbind(random_prob_200pc_w7wed_wet_prev, random_prob_200pc_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Random_Prob_200pc$loading_w8wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_loading_w8wed_conc_list <- append(random_prob_200pc_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_loading_w8wed_conc_matrix <- matrix(unlist(random_prob_200pc_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_cleaning_w8wed_conc_list <- append(random_prob_200pc_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_cleaning_w8wed_conc_matrix <- matrix(unlist(random_prob_200pc_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_200pc$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_200pc_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_200pc_drying_w8wed_conc_list <- append(random_prob_200pc_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_200pc$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_sorting_w8wed_conc_list <- append(random_prob_200pc_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_sorting_w8wed_conc_matrix <- matrix(unlist(random_prob_200pc_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_tray_packing_w8wed_conc_list <- append(random_prob_200pc_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_tray_packing_w8wed_conc_matrix <- matrix(unlist(random_prob_200pc_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$reject_w8wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_reject_w8wed_conc_list <- append(random_prob_200pc_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_reject_w8wed_conc_matrix <- matrix(unlist(random_prob_200pc_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_200pc$other_w8wed_conc_list
vector <- vector[vector!='[]']
random_prob_200pc_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_200pc_other_w8wed_conc_list <- append(random_prob_200pc_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_200pc_other_w8wed_conc_matrix <- matrix(unlist(random_prob_200pc_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_200pc_loading_concs <- as.data.frame(random_prob_200pc_loading_w8wed_conc_list)
random_prob_200pc_loading_concs$area <- as.factor('loading')
random_prob_200pc_loading_concs$scenario <- as.factor('PR_02')
random_prob_200pc_loading_concs$water <- as.factor('Wet')
names(random_prob_200pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_cleaning_concs <- as.data.frame(random_prob_200pc_cleaning_w8wed_conc_list)
random_prob_200pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_200pc_cleaning_concs$scenario <- as.factor('PR_02')
random_prob_200pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_200pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_sorting_concs <- as.data.frame(random_prob_200pc_sorting_w8wed_conc_list)
random_prob_200pc_sorting_concs$area <- as.factor('sorting')
random_prob_200pc_sorting_concs$scenario <- as.factor('PR_02')
random_prob_200pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_200pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_reject_concs <- as.data.frame(random_prob_200pc_reject_w8wed_conc_list)
random_prob_200pc_reject_concs$area <- as.factor('reject')
random_prob_200pc_reject_concs$scenario <- as.factor('PR_02')
random_prob_200pc_reject_concs$water <- as.factor('Dry')
names(random_prob_200pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_tray_packing_concs <- as.data.frame(random_prob_200pc_tray_packing_w8wed_conc_list)
random_prob_200pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_200pc_tray_packing_concs$scenario <- as.factor('PR_02')
random_prob_200pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_200pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_other_concs <- as.data.frame(random_prob_200pc_other_w8wed_conc_list)
random_prob_200pc_other_concs$area <- as.factor('other')
random_prob_200pc_other_concs$scenario <- as.factor('PR_02')
random_prob_200pc_other_concs$water <- as.factor('Dry')
names(random_prob_200pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_200pc_w8wed_concs <- rbind(random_prob_200pc_loading_concs,random_prob_200pc_cleaning_concs,random_prob_200pc_sorting_concs,random_prob_200pc_tray_packing_concs,random_prob_200pc_reject_concs,random_prob_200pc_other_concs)

random_prob_200pc_loading_prev <- as.data.frame(NL_table_Random_Prob_200pc$loading_w8wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_loading_prev$area <- as.factor('loading')
random_prob_200pc_loading_prev$scenario <- as.factor('PR_02')
random_prob_200pc_loading_prev$water <- as.factor('Wet')
names(random_prob_200pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_200pc$cleaning_w8wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_200pc_cleaning_prev$scenario <- as.factor('PR_02')
random_prob_200pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_200pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_200pc$sorting_w8wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_sorting_prev$area <- as.factor('sorting')
random_prob_200pc_sorting_prev$scenario <- as.factor('PR_02')
random_prob_200pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_200pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_reject_prev <- as.data.frame(NL_table_Random_Prob_200pc$reject_w8wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_reject_prev$area <- as.factor('reject')
random_prob_200pc_reject_prev$scenario <- as.factor('PR_02')
random_prob_200pc_reject_prev$water <- as.factor('Dry')
names(random_prob_200pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_200pc$tray_packing_w8wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_200pc_tray_packing_prev$scenario <- as.factor('PR_02')
random_prob_200pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_200pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_other_prev <- as.data.frame(NL_table_Random_Prob_200pc$other_w8wed_prev[order(NL_table_Random_Prob_200pc$local_seed)])
random_prob_200pc_other_prev$area <- as.factor('other')
random_prob_200pc_other_prev$scenario <- as.factor('PR_02')
random_prob_200pc_other_prev$water <- as.factor('Dry')
names(random_prob_200pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_200pc_w8wed_prev <- rbind(random_prob_200pc_loading_prev,random_prob_200pc_cleaning_prev,random_prob_200pc_sorting_prev,random_prob_200pc_tray_packing_prev,random_prob_200pc_reject_prev,random_prob_200pc_other_prev)

random_prob_200pc_w8wed_wet_prev <- as.data.frame(random_prob_200pc_loading_prev$prevalence*21/100+random_prob_200pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_200pc_w8wed_wet_prev$scenario <- as.factor('PR_02')
random_prob_200pc_w8wed_wet_prev$water <- as.factor('Wet')
names(random_prob_200pc_w8wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_200pc_w8wed_dry_prev <- as.data.frame(random_prob_200pc_sorting_prev$prevalence*20/100+random_prob_200pc_reject_prev$prevalence*23/100+random_prob_200pc_tray_packing_prev$prevalence*123/100+random_prob_200pc_other_prev$prevalence*10/100)/176*100
random_prob_200pc_w8wed_dry_prev$scenario <- as.factor('PR_02')
random_prob_200pc_w8wed_dry_prev$water <- as.factor('Dry')
names(random_prob_200pc_w8wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_200pc_w8wed_recombined_prev <- rbind(random_prob_200pc_w8wed_wet_prev, random_prob_200pc_w8wed_dry_prev)

vector <- NL_table_Random_Prob_200pc$lifetime_conc_list[order(NL_table_Random_Prob_200pc$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

random_prob_200pc_w1wed_recombined_prev$week <- as.factor(1)
random_prob_200pc_w2wed_recombined_prev$week <- as.factor(2)
random_prob_200pc_w3wed_recombined_prev$week <- as.factor(3)
random_prob_200pc_w4wed_recombined_prev$week <- as.factor(4)
random_prob_200pc_w5wed_recombined_prev$week <- as.factor(5)
random_prob_200pc_w6wed_recombined_prev$week <- as.factor(6)
random_prob_200pc_w7wed_recombined_prev$week <- as.factor(7)
random_prob_200pc_w8wed_recombined_prev$week <- as.factor(8)
random_prob_200pc_allwed_prev <- rbind(random_prob_200pc_w1wed_recombined_prev,random_prob_200pc_w2wed_recombined_prev,random_prob_200pc_w3wed_recombined_prev,random_prob_200pc_w4wed_recombined_prev,random_prob_200pc_w5wed_recombined_prev,random_prob_200pc_w6wed_recombined_prev,random_prob_200pc_w7wed_recombined_prev,random_prob_200pc_w8wed_recombined_prev)

Facility_B_random_prob_200pc_agents_melted <- melt(mdarray)
colnames(Facility_B_random_prob_200pc_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_random_prob_200pc_agents_melted$agent <- Facility_B_random_prob_200pc_agents_melted$agent-1
Facility_B_random_prob_200pc_agents_melted$logical <- Facility_B_random_prob_200pc_agents_melted$value>0
Facility_B_random_prob_200pc_agents_melted$binary <- as.numeric(Facility_B_random_prob_200pc_agents_melted$logical)
Facility_B_random_prob_200pc_agents_melted$log10value <- log10(Facility_B_random_prob_200pc_agents_melted$value)
Facility_B_random_prob_200pc_agents_melted$log10value[is.infinite(Facility_B_random_prob_200pc_agents_melted$log10value)] <- 0

agent <- Facility_B_random_prob_200pc_agents_melted$agent
iteration <- Facility_B_random_prob_200pc_agents_melted$iteration
tick <- Facility_B_random_prob_200pc_agents_melted$tick
rle_matrix <- tapply(Facility_B_random_prob_200pc_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_random_prob_200pc_agents_melted_mean_value_matrix <- tapply(Facility_B_random_prob_200pc_agents_melted$value, list(agent, tick), mean)
Facility_B_random_prob_200pc_agents_melted_median_value_matrix <- tapply(Facility_B_random_prob_200pc_agents_melted$value, list(agent, tick), median)
Facility_B_random_prob_200pc_agents_melted_prob_value_matrix <- tapply(Facility_B_random_prob_200pc_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}
# durations$agent <- durations$agent-1

Facility_B_durations_random_prob_200pc <- durations

agents_list_random_prob_200pc <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_random_prob_200pc <- agents_list_random_prob_200pc[,c("V1","V7","V8","V9")]
colnames(agents_list_random_prob_200pc) <- c("name","sanitation_status","schedule","area")
agents_list_random_prob_200pc$ttp <- rep((168*2),225)
agents_list_random_prob_200pc$ttp[agents_list_random_prob_200pc$schedule=="daily"] <- (24*2)

agent <- 1
while(agent<=225) {
  agents_list_random_prob_200pc$min_duration[agent] <- ifelse(length(Facility_B_durations_random_prob_200pc$duration[Facility_B_durations_random_prob_200pc$agent==agent])==0,NA,min(Facility_B_durations_random_prob_200pc$duration[Facility_B_durations_random_prob_200pc$agent==agent], na.rm = TRUE))
  agents_list_random_prob_200pc$mean_duration[agent] <- ifelse(length(Facility_B_durations_random_prob_200pc$duration[Facility_B_durations_random_prob_200pc$agent==agent])==0,NA,mean(Facility_B_durations_random_prob_200pc$duration[Facility_B_durations_random_prob_200pc$agent==agent], na.rm = TRUE))
  agents_list_random_prob_200pc$median_duration[agent] <- ifelse(length(Facility_B_durations_random_prob_200pc$duration[Facility_B_durations_random_prob_200pc$agent==agent])==0,NA,median(Facility_B_durations_random_prob_200pc$duration[Facility_B_durations_random_prob_200pc$agent==agent], na.rm = TRUE))
  agents_list_random_prob_200pc$max_duration[agent] <- ifelse(length(Facility_B_durations_random_prob_200pc$duration[Facility_B_durations_random_prob_200pc$agent==agent])==0,NA,max(Facility_B_durations_random_prob_200pc$duration[Facility_B_durations_random_prob_200pc$agent==agent], na.rm = TRUE))
  agents_list_random_prob_200pc$times_persistent[agent] <- sum(Facility_B_durations_random_prob_200pc$duration[Facility_B_durations_random_prob_200pc$agent==agent]>agents_list_random_prob_200pc$ttp[agent])
  agent <- agent+1 
}

Facility_B_random_prob_200pc_agents_melted_monday_preop <- Facility_B_random_prob_200pc_agents_melted[which(Facility_B_random_prob_200pc_agents_melted$tick==33|Facility_B_random_prob_200pc_agents_melted$tick==201|Facility_B_random_prob_200pc_agents_melted$tick==369|Facility_B_random_prob_200pc_agents_melted$tick==537|Facility_B_random_prob_200pc_agents_melted$tick==705|Facility_B_random_prob_200pc_agents_melted$tick==873|Facility_B_random_prob_200pc_agents_melted$tick==1041|Facility_B_random_prob_200pc_agents_melted$tick==1209),]

Facility_B_random_prob_200pc_agents_melted_tuesday_preop <- Facility_B_random_prob_200pc_agents_melted[which(Facility_B_random_prob_200pc_agents_melted$tick==57|Facility_B_random_prob_200pc_agents_melted$tick==225|Facility_B_random_prob_200pc_agents_melted$tick==393|Facility_B_random_prob_200pc_agents_melted$tick==561|Facility_B_random_prob_200pc_agents_melted$tick==729|Facility_B_random_prob_200pc_agents_melted$tick==897|Facility_B_random_prob_200pc_agents_melted$tick==1065|Facility_B_random_prob_200pc_agents_melted$tick==1233),]

Facility_B_random_prob_200pc_agents_melted_wednesday_preop <- Facility_B_random_prob_200pc_agents_melted[which(Facility_B_random_prob_200pc_agents_melted$tick==81|Facility_B_random_prob_200pc_agents_melted$tick==249|Facility_B_random_prob_200pc_agents_melted$tick==417|Facility_B_random_prob_200pc_agents_melted$tick==585|Facility_B_random_prob_200pc_agents_melted$tick==753|Facility_B_random_prob_200pc_agents_melted$tick==921|Facility_B_random_prob_200pc_agents_melted$tick==1089|Facility_B_random_prob_200pc_agents_melted$tick==1257),]

Facility_B_random_prob_200pc_agents_melted_thursday_preop <- Facility_B_random_prob_200pc_agents_melted[which(Facility_B_random_prob_200pc_agents_melted$tick==105|Facility_B_random_prob_200pc_agents_melted$tick==273|Facility_B_random_prob_200pc_agents_melted$tick==441|Facility_B_random_prob_200pc_agents_melted$tick==609|Facility_B_random_prob_200pc_agents_melted$tick==777|Facility_B_random_prob_200pc_agents_melted$tick==945|Facility_B_random_prob_200pc_agents_melted$tick==1113|Facility_B_random_prob_200pc_agents_melted$tick==1281),]

Facility_B_random_prob_200pc_agents_melted_friday_preop <- Facility_B_random_prob_200pc_agents_melted[which(Facility_B_random_prob_200pc_agents_melted$tick==129|Facility_B_random_prob_200pc_agents_melted$tick==297|Facility_B_random_prob_200pc_agents_melted$tick==465|Facility_B_random_prob_200pc_agents_melted$tick==633|Facility_B_random_prob_200pc_agents_melted$tick==801|Facility_B_random_prob_200pc_agents_melted$tick==969|Facility_B_random_prob_200pc_agents_melted$tick==1137|Facility_B_random_prob_200pc_agents_melted$tick==1305),]

Facility_B_random_prob_200pc_agents_melted_ff <- as.ffdf(Facility_B_random_prob_200pc_agents_melted)
rm(Facility_B_random_prob_200pc_agents_melted)
gc()
```

```{r import Random Event Occurences 250% Delay Period}
NL_table_Random_Prob_250pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-28-13-09 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_P_Random_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Random_Prob_250pc <- NL_table_Random_Prob_250pc[NL_table_Random_Prob_250pc$scenario==33,]

while (any(grepl('-', names(NL_table_Random_Prob_250pc), fixed = TRUE))) {
  NL_table_Random_Prob_250pc <- NL_table_Random_Prob_250pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Random_Prob_250pc), fixed = TRUE))) {
  NL_table_Random_Prob_250pc <- NL_table_Random_Prob_250pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Random_Prob_250pc), fixed = TRUE))) {
  NL_table_Random_Prob_250pc <- NL_table_Random_Prob_250pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Random_Prob_250pc), fixed = TRUE))) {
  NL_table_Random_Prob_250pc <- NL_table_Random_Prob_250pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Random_Prob_250pc[ , ..list_columns]

NL_table_Random_Prob_250pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Random_Prob_250pc <- as.data.frame(NL_table_Random_Prob_250pc)

NL_table_Random_Prob_250pc[NL_table_Random_Prob_250pc==-1] <- NA

NL_table_Random_Prob_250pc <- subset(NL_table_Random_Prob_250pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Random_Prob_250pc)[names(NL_table_Random_Prob_250pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Random_Prob_250pc)[names(NL_table_Random_Prob_250pc)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Random_Prob_250pc$loading_w1wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_loading_w1wed_conc_list <- append(random_prob_250pc_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_loading_w1wed_conc_matrix <- matrix(unlist(random_prob_250pc_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_cleaning_w1wed_conc_list <- append(random_prob_250pc_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_cleaning_w1wed_conc_matrix <- matrix(unlist(random_prob_250pc_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_250pc$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_250pc_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_250pc_drying_w1wed_conc_list <- append(random_prob_250pc_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_250pc$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_sorting_w1wed_conc_list <- append(random_prob_250pc_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_sorting_w1wed_conc_matrix <- matrix(unlist(random_prob_250pc_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_tray_packing_w1wed_conc_list <- append(random_prob_250pc_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_tray_packing_w1wed_conc_matrix <- matrix(unlist(random_prob_250pc_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$reject_w1wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_reject_w1wed_conc_list <- append(random_prob_250pc_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_reject_w1wed_conc_matrix <- matrix(unlist(random_prob_250pc_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$other_w1wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_other_w1wed_conc_list <- append(random_prob_250pc_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_other_w1wed_conc_matrix <- matrix(unlist(random_prob_250pc_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_250pc_loading_concs <- as.data.frame(random_prob_250pc_loading_w1wed_conc_list)
random_prob_250pc_loading_concs$area <- as.factor('loading')
random_prob_250pc_loading_concs$scenario <- as.factor('PR_03')
random_prob_250pc_loading_concs$water <- as.factor('Wet')
names(random_prob_250pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_cleaning_concs <- as.data.frame(random_prob_250pc_cleaning_w1wed_conc_list)
random_prob_250pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_250pc_cleaning_concs$scenario <- as.factor('PR_03')
random_prob_250pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_250pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_sorting_concs <- as.data.frame(random_prob_250pc_sorting_w1wed_conc_list)
random_prob_250pc_sorting_concs$area <- as.factor('sorting')
random_prob_250pc_sorting_concs$scenario <- as.factor('PR_03')
random_prob_250pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_250pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_reject_concs <- as.data.frame(random_prob_250pc_reject_w1wed_conc_list)
random_prob_250pc_reject_concs$area <- as.factor('reject')
random_prob_250pc_reject_concs$scenario <- as.factor('PR_03')
random_prob_250pc_reject_concs$water <- as.factor('Dry')
names(random_prob_250pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_tray_packing_concs <- as.data.frame(random_prob_250pc_tray_packing_w1wed_conc_list)
random_prob_250pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_250pc_tray_packing_concs$scenario <- as.factor('PR_03')
random_prob_250pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_250pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_other_concs <- as.data.frame(random_prob_250pc_other_w1wed_conc_list)
random_prob_250pc_other_concs$area <- as.factor('other')
random_prob_250pc_other_concs$scenario <- as.factor('PR_03')
random_prob_250pc_other_concs$water <- as.factor('Dry')
names(random_prob_250pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_w1wed_concs <- rbind(random_prob_250pc_loading_concs,random_prob_250pc_cleaning_concs,random_prob_250pc_sorting_concs,random_prob_250pc_tray_packing_concs,random_prob_250pc_reject_concs,random_prob_250pc_other_concs)

random_prob_250pc_loading_prev <- as.data.frame(NL_table_Random_Prob_250pc$loading_w1wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_loading_prev$area <- as.factor('loading')
random_prob_250pc_loading_prev$scenario <- as.factor('PR_03')
random_prob_250pc_loading_prev$water <- as.factor('Wet')
names(random_prob_250pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_250pc$cleaning_w1wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_250pc_cleaning_prev$scenario <- as.factor('PR_03')
random_prob_250pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_250pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_250pc$sorting_w1wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_sorting_prev$area <- as.factor('sorting')
random_prob_250pc_sorting_prev$scenario <- as.factor('PR_03')
random_prob_250pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_250pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_reject_prev <- as.data.frame(NL_table_Random_Prob_250pc$reject_w1wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_reject_prev$area <- as.factor('reject')
random_prob_250pc_reject_prev$scenario <- as.factor('PR_03')
random_prob_250pc_reject_prev$water <- as.factor('Dry')
names(random_prob_250pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_250pc$tray_packing_w1wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_250pc_tray_packing_prev$scenario <- as.factor('PR_03')
random_prob_250pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_250pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_other_prev <- as.data.frame(NL_table_Random_Prob_250pc$other_w1wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_other_prev$area <- as.factor('other')
random_prob_250pc_other_prev$scenario <- as.factor('PR_03')
random_prob_250pc_other_prev$water <- as.factor('Dry')
names(random_prob_250pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_w1wed_prev <- rbind(random_prob_250pc_loading_prev,random_prob_250pc_cleaning_prev,random_prob_250pc_sorting_prev,random_prob_250pc_tray_packing_prev,random_prob_250pc_reject_prev,random_prob_250pc_other_prev)

random_prob_250pc_w1wed_wet_prev <- as.data.frame(random_prob_250pc_loading_prev$prevalence*21/100+random_prob_250pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_250pc_w1wed_wet_prev$scenario <- as.factor('PR_03')
random_prob_250pc_w1wed_wet_prev$water <- as.factor('Wet')
names(random_prob_250pc_w1wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_250pc_w1wed_dry_prev <- as.data.frame(random_prob_250pc_sorting_prev$prevalence*20/100+random_prob_250pc_reject_prev$prevalence*23/100+random_prob_250pc_tray_packing_prev$prevalence*123/100+random_prob_250pc_other_prev$prevalence*10/100)/176*100
random_prob_250pc_w1wed_dry_prev$scenario <- as.factor('PR_03')
random_prob_250pc_w1wed_dry_prev$water <- as.factor('Dry')
names(random_prob_250pc_w1wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_250pc_w1wed_recombined_prev <- rbind(random_prob_250pc_w1wed_wet_prev, random_prob_250pc_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Random_Prob_250pc$loading_w2wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_loading_w2wed_conc_list <- append(random_prob_250pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_loading_w2wed_conc_matrix <- matrix(unlist(random_prob_250pc_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_cleaning_w2wed_conc_list <- append(random_prob_250pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_cleaning_w2wed_conc_matrix <- matrix(unlist(random_prob_250pc_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_250pc$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_250pc_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_250pc_drying_w2wed_conc_list <- append(random_prob_250pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_250pc$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_sorting_w2wed_conc_list <- append(random_prob_250pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_sorting_w2wed_conc_matrix <- matrix(unlist(random_prob_250pc_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_tray_packing_w2wed_conc_list <- append(random_prob_250pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_tray_packing_w2wed_conc_matrix <- matrix(unlist(random_prob_250pc_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$reject_w2wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_reject_w2wed_conc_list <- append(random_prob_250pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_reject_w2wed_conc_matrix <- matrix(unlist(random_prob_250pc_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$other_w2wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_other_w2wed_conc_list <- append(random_prob_250pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_other_w2wed_conc_matrix <- matrix(unlist(random_prob_250pc_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_250pc_loading_concs <- as.data.frame(random_prob_250pc_loading_w2wed_conc_list)
random_prob_250pc_loading_concs$area <- as.factor('loading')
random_prob_250pc_loading_concs$scenario <- as.factor('PR_03')
random_prob_250pc_loading_concs$water <- as.factor('Wet')
names(random_prob_250pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_cleaning_concs <- as.data.frame(random_prob_250pc_cleaning_w2wed_conc_list)
random_prob_250pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_250pc_cleaning_concs$scenario <- as.factor('PR_03')
random_prob_250pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_250pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_sorting_concs <- as.data.frame(random_prob_250pc_sorting_w2wed_conc_list)
random_prob_250pc_sorting_concs$area <- as.factor('sorting')
random_prob_250pc_sorting_concs$scenario <- as.factor('PR_03')
random_prob_250pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_250pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_reject_concs <- as.data.frame(random_prob_250pc_reject_w2wed_conc_list)
random_prob_250pc_reject_concs$area <- as.factor('reject')
random_prob_250pc_reject_concs$scenario <- as.factor('PR_03')
random_prob_250pc_reject_concs$water <- as.factor('Dry')
names(random_prob_250pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_tray_packing_concs <- as.data.frame(random_prob_250pc_tray_packing_w2wed_conc_list)
random_prob_250pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_250pc_tray_packing_concs$scenario <- as.factor('PR_03')
random_prob_250pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_250pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_other_concs <- as.data.frame(random_prob_250pc_other_w2wed_conc_list)
random_prob_250pc_other_concs$area <- as.factor('other')
random_prob_250pc_other_concs$scenario <- as.factor('PR_03')
random_prob_250pc_other_concs$water <- as.factor('Dry')
names(random_prob_250pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_w2wed_concs <- rbind(random_prob_250pc_loading_concs,random_prob_250pc_cleaning_concs,random_prob_250pc_sorting_concs,random_prob_250pc_tray_packing_concs,random_prob_250pc_reject_concs,random_prob_250pc_other_concs)

random_prob_250pc_loading_prev <- as.data.frame(NL_table_Random_Prob_250pc$loading_w2wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_loading_prev$area <- as.factor('loading')
random_prob_250pc_loading_prev$scenario <- as.factor('PR_03')
random_prob_250pc_loading_prev$water <- as.factor('Wet')
names(random_prob_250pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_250pc$cleaning_w2wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_250pc_cleaning_prev$scenario <- as.factor('PR_03')
random_prob_250pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_250pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_250pc$sorting_w2wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_sorting_prev$area <- as.factor('sorting')
random_prob_250pc_sorting_prev$scenario <- as.factor('PR_03')
random_prob_250pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_250pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_reject_prev <- as.data.frame(NL_table_Random_Prob_250pc$reject_w2wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_reject_prev$area <- as.factor('reject')
random_prob_250pc_reject_prev$scenario <- as.factor('PR_03')
random_prob_250pc_reject_prev$water <- as.factor('Dry')
names(random_prob_250pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_250pc$tray_packing_w2wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_250pc_tray_packing_prev$scenario <- as.factor('PR_03')
random_prob_250pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_250pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_other_prev <- as.data.frame(NL_table_Random_Prob_250pc$other_w2wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_other_prev$area <- as.factor('other')
random_prob_250pc_other_prev$scenario <- as.factor('PR_03')
random_prob_250pc_other_prev$water <- as.factor('Dry')
names(random_prob_250pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_w2wed_prev <- rbind(random_prob_250pc_loading_prev,random_prob_250pc_cleaning_prev,random_prob_250pc_sorting_prev,random_prob_250pc_tray_packing_prev,random_prob_250pc_reject_prev,random_prob_250pc_other_prev)

random_prob_250pc_w2wed_wet_prev <- as.data.frame(random_prob_250pc_loading_prev$prevalence*21/100+random_prob_250pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_250pc_w2wed_wet_prev$scenario <- as.factor('PR_03')
random_prob_250pc_w2wed_wet_prev$water <- as.factor('Wet')
names(random_prob_250pc_w2wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_250pc_w2wed_dry_prev <- as.data.frame(random_prob_250pc_sorting_prev$prevalence*20/100+random_prob_250pc_reject_prev$prevalence*23/100+random_prob_250pc_tray_packing_prev$prevalence*123/100+random_prob_250pc_other_prev$prevalence*10/100)/176*100
random_prob_250pc_w2wed_dry_prev$scenario <- as.factor('PR_03')
random_prob_250pc_w2wed_dry_prev$water <- as.factor('Dry')
names(random_prob_250pc_w2wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_250pc_w2wed_recombined_prev <- rbind(random_prob_250pc_w2wed_wet_prev, random_prob_250pc_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Random_Prob_250pc$loading_w3wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_loading_w3wed_conc_list <- append(random_prob_250pc_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_loading_w3wed_conc_matrix <- matrix(unlist(random_prob_250pc_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_cleaning_w3wed_conc_list <- append(random_prob_250pc_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_cleaning_w3wed_conc_matrix <- matrix(unlist(random_prob_250pc_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_250pc$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_250pc_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_250pc_drying_w3wed_conc_list <- append(random_prob_250pc_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_250pc$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_sorting_w3wed_conc_list <- append(random_prob_250pc_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_sorting_w3wed_conc_matrix <- matrix(unlist(random_prob_250pc_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_tray_packing_w3wed_conc_list <- append(random_prob_250pc_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_tray_packing_w3wed_conc_matrix <- matrix(unlist(random_prob_250pc_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$reject_w3wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_reject_w3wed_conc_list <- append(random_prob_250pc_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_reject_w3wed_conc_matrix <- matrix(unlist(random_prob_250pc_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$other_w3wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_other_w3wed_conc_list <- append(random_prob_250pc_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_other_w3wed_conc_matrix <- matrix(unlist(random_prob_250pc_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_250pc_loading_concs <- as.data.frame(random_prob_250pc_loading_w3wed_conc_list)
random_prob_250pc_loading_concs$area <- as.factor('loading')
random_prob_250pc_loading_concs$scenario <- as.factor('PR_03')
random_prob_250pc_loading_concs$water <- as.factor('Wet')
names(random_prob_250pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_cleaning_concs <- as.data.frame(random_prob_250pc_cleaning_w3wed_conc_list)
random_prob_250pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_250pc_cleaning_concs$scenario <- as.factor('PR_03')
random_prob_250pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_250pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_sorting_concs <- as.data.frame(random_prob_250pc_sorting_w3wed_conc_list)
random_prob_250pc_sorting_concs$area <- as.factor('sorting')
random_prob_250pc_sorting_concs$scenario <- as.factor('PR_03')
random_prob_250pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_250pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_reject_concs <- as.data.frame(random_prob_250pc_reject_w3wed_conc_list)
random_prob_250pc_reject_concs$area <- as.factor('reject')
random_prob_250pc_reject_concs$scenario <- as.factor('PR_03')
random_prob_250pc_reject_concs$water <- as.factor('Dry')
names(random_prob_250pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_tray_packing_concs <- as.data.frame(random_prob_250pc_tray_packing_w3wed_conc_list)
random_prob_250pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_250pc_tray_packing_concs$scenario <- as.factor('PR_03')
random_prob_250pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_250pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_other_concs <- as.data.frame(random_prob_250pc_other_w3wed_conc_list)
random_prob_250pc_other_concs$area <- as.factor('other')
random_prob_250pc_other_concs$scenario <- as.factor('PR_03')
random_prob_250pc_other_concs$water <- as.factor('Dry')
names(random_prob_250pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_w3wed_concs <- rbind(random_prob_250pc_loading_concs,random_prob_250pc_cleaning_concs,random_prob_250pc_sorting_concs,random_prob_250pc_tray_packing_concs,random_prob_250pc_reject_concs,random_prob_250pc_other_concs)

random_prob_250pc_loading_prev <- as.data.frame(NL_table_Random_Prob_250pc$loading_w3wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_loading_prev$area <- as.factor('loading')
random_prob_250pc_loading_prev$scenario <- as.factor('PR_03')
random_prob_250pc_loading_prev$water <- as.factor('Wet')
names(random_prob_250pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_250pc$cleaning_w3wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_250pc_cleaning_prev$scenario <- as.factor('PR_03')
random_prob_250pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_250pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_250pc$sorting_w3wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_sorting_prev$area <- as.factor('sorting')
random_prob_250pc_sorting_prev$scenario <- as.factor('PR_03')
random_prob_250pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_250pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_reject_prev <- as.data.frame(NL_table_Random_Prob_250pc$reject_w3wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_reject_prev$area <- as.factor('reject')
random_prob_250pc_reject_prev$scenario <- as.factor('PR_03')
random_prob_250pc_reject_prev$water <- as.factor('Dry')
names(random_prob_250pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_250pc$tray_packing_w3wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_250pc_tray_packing_prev$scenario <- as.factor('PR_03')
random_prob_250pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_250pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_other_prev <- as.data.frame(NL_table_Random_Prob_250pc$other_w3wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_other_prev$area <- as.factor('other')
random_prob_250pc_other_prev$scenario <- as.factor('PR_03')
random_prob_250pc_other_prev$water <- as.factor('Dry')
names(random_prob_250pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_w3wed_prev <- rbind(random_prob_250pc_loading_prev,random_prob_250pc_cleaning_prev,random_prob_250pc_sorting_prev,random_prob_250pc_tray_packing_prev,random_prob_250pc_reject_prev,random_prob_250pc_other_prev)

random_prob_250pc_w3wed_wet_prev <- as.data.frame(random_prob_250pc_loading_prev$prevalence*21/100+random_prob_250pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_250pc_w3wed_wet_prev$scenario <- as.factor('PR_03')
random_prob_250pc_w3wed_wet_prev$water <- as.factor('Wet')
names(random_prob_250pc_w3wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_250pc_w3wed_dry_prev <- as.data.frame(random_prob_250pc_sorting_prev$prevalence*20/100+random_prob_250pc_reject_prev$prevalence*23/100+random_prob_250pc_tray_packing_prev$prevalence*123/100+random_prob_250pc_other_prev$prevalence*10/100)/176*100
random_prob_250pc_w3wed_dry_prev$scenario <- as.factor('PR_03')
random_prob_250pc_w3wed_dry_prev$water <- as.factor('Dry')
names(random_prob_250pc_w3wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_250pc_w3wed_recombined_prev <- rbind(random_prob_250pc_w3wed_wet_prev, random_prob_250pc_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Random_Prob_250pc$loading_w4wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_loading_w4wed_conc_list <- append(random_prob_250pc_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_loading_w4wed_conc_matrix <- matrix(unlist(random_prob_250pc_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_cleaning_w4wed_conc_list <- append(random_prob_250pc_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_cleaning_w4wed_conc_matrix <- matrix(unlist(random_prob_250pc_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_250pc$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_250pc_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_250pc_drying_w4wed_conc_list <- append(random_prob_250pc_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_250pc$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_sorting_w4wed_conc_list <- append(random_prob_250pc_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_sorting_w4wed_conc_matrix <- matrix(unlist(random_prob_250pc_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_tray_packing_w4wed_conc_list <- append(random_prob_250pc_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_tray_packing_w4wed_conc_matrix <- matrix(unlist(random_prob_250pc_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$reject_w4wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_reject_w4wed_conc_list <- append(random_prob_250pc_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_reject_w4wed_conc_matrix <- matrix(unlist(random_prob_250pc_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$other_w4wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_other_w4wed_conc_list <- append(random_prob_250pc_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_other_w4wed_conc_matrix <- matrix(unlist(random_prob_250pc_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_250pc_loading_concs <- as.data.frame(random_prob_250pc_loading_w4wed_conc_list)
random_prob_250pc_loading_concs$area <- as.factor('loading')
random_prob_250pc_loading_concs$scenario <- as.factor('PR_03')
random_prob_250pc_loading_concs$water <- as.factor('Wet')
names(random_prob_250pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_cleaning_concs <- as.data.frame(random_prob_250pc_cleaning_w4wed_conc_list)
random_prob_250pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_250pc_cleaning_concs$scenario <- as.factor('PR_03')
random_prob_250pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_250pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_sorting_concs <- as.data.frame(random_prob_250pc_sorting_w4wed_conc_list)
random_prob_250pc_sorting_concs$area <- as.factor('sorting')
random_prob_250pc_sorting_concs$scenario <- as.factor('PR_03')
random_prob_250pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_250pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_reject_concs <- as.data.frame(random_prob_250pc_reject_w4wed_conc_list)
random_prob_250pc_reject_concs$area <- as.factor('reject')
random_prob_250pc_reject_concs$scenario <- as.factor('PR_03')
random_prob_250pc_reject_concs$water <- as.factor('Dry')
names(random_prob_250pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_tray_packing_concs <- as.data.frame(random_prob_250pc_tray_packing_w4wed_conc_list)
random_prob_250pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_250pc_tray_packing_concs$scenario <- as.factor('PR_03')
random_prob_250pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_250pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_other_concs <- as.data.frame(random_prob_250pc_other_w4wed_conc_list)
random_prob_250pc_other_concs$area <- as.factor('other')
random_prob_250pc_other_concs$scenario <- as.factor('PR_03')
random_prob_250pc_other_concs$water <- as.factor('Dry')
names(random_prob_250pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_w4wed_concs <- rbind(random_prob_250pc_loading_concs,random_prob_250pc_cleaning_concs,random_prob_250pc_sorting_concs,random_prob_250pc_tray_packing_concs,random_prob_250pc_reject_concs,random_prob_250pc_other_concs)

random_prob_250pc_loading_prev <- as.data.frame(NL_table_Random_Prob_250pc$loading_w4wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_loading_prev$area <- as.factor('loading')
random_prob_250pc_loading_prev$scenario <- as.factor('PR_03')
random_prob_250pc_loading_prev$water <- as.factor('Wet')
names(random_prob_250pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_250pc$cleaning_w4wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_250pc_cleaning_prev$scenario <- as.factor('PR_03')
random_prob_250pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_250pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_250pc$sorting_w4wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_sorting_prev$area <- as.factor('sorting')
random_prob_250pc_sorting_prev$scenario <- as.factor('PR_03')
random_prob_250pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_250pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_reject_prev <- as.data.frame(NL_table_Random_Prob_250pc$reject_w4wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_reject_prev$area <- as.factor('reject')
random_prob_250pc_reject_prev$scenario <- as.factor('PR_03')
random_prob_250pc_reject_prev$water <- as.factor('Dry')
names(random_prob_250pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_250pc$tray_packing_w4wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_250pc_tray_packing_prev$scenario <- as.factor('PR_03')
random_prob_250pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_250pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_other_prev <- as.data.frame(NL_table_Random_Prob_250pc$other_w4wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_other_prev$area <- as.factor('other')
random_prob_250pc_other_prev$scenario <- as.factor('PR_03')
random_prob_250pc_other_prev$water <- as.factor('Dry')
names(random_prob_250pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_w4wed_prev <- rbind(random_prob_250pc_loading_prev,random_prob_250pc_cleaning_prev,random_prob_250pc_sorting_prev,random_prob_250pc_tray_packing_prev,random_prob_250pc_reject_prev,random_prob_250pc_other_prev)

random_prob_250pc_w4wed_wet_prev <- as.data.frame(random_prob_250pc_loading_prev$prevalence*21/100+random_prob_250pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_250pc_w4wed_wet_prev$scenario <- as.factor('PR_03')
random_prob_250pc_w4wed_wet_prev$water <- as.factor('Wet')
names(random_prob_250pc_w4wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_250pc_w4wed_dry_prev <- as.data.frame(random_prob_250pc_sorting_prev$prevalence*20/100+random_prob_250pc_reject_prev$prevalence*23/100+random_prob_250pc_tray_packing_prev$prevalence*123/100+random_prob_250pc_other_prev$prevalence*10/100)/176*100
random_prob_250pc_w4wed_dry_prev$scenario <- as.factor('PR_03')
random_prob_250pc_w4wed_dry_prev$water <- as.factor('Dry')
names(random_prob_250pc_w4wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_250pc_w4wed_recombined_prev <- rbind(random_prob_250pc_w4wed_wet_prev, random_prob_250pc_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Random_Prob_250pc$loading_w5wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_loading_w5wed_conc_list <- append(random_prob_250pc_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_loading_w5wed_conc_matrix <- matrix(unlist(random_prob_250pc_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_cleaning_w5wed_conc_list <- append(random_prob_250pc_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_cleaning_w5wed_conc_matrix <- matrix(unlist(random_prob_250pc_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_250pc$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_250pc_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_250pc_drying_w5wed_conc_list <- append(random_prob_250pc_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_250pc$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_sorting_w5wed_conc_list <- append(random_prob_250pc_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_sorting_w5wed_conc_matrix <- matrix(unlist(random_prob_250pc_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_tray_packing_w5wed_conc_list <- append(random_prob_250pc_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_tray_packing_w5wed_conc_matrix <- matrix(unlist(random_prob_250pc_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$reject_w5wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_reject_w5wed_conc_list <- append(random_prob_250pc_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_reject_w5wed_conc_matrix <- matrix(unlist(random_prob_250pc_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$other_w5wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_other_w5wed_conc_list <- append(random_prob_250pc_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_other_w5wed_conc_matrix <- matrix(unlist(random_prob_250pc_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_250pc_loading_concs <- as.data.frame(random_prob_250pc_loading_w5wed_conc_list)
random_prob_250pc_loading_concs$area <- as.factor('loading')
random_prob_250pc_loading_concs$scenario <- as.factor('PR_03')
random_prob_250pc_loading_concs$water <- as.factor('Wet')
names(random_prob_250pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_cleaning_concs <- as.data.frame(random_prob_250pc_cleaning_w5wed_conc_list)
random_prob_250pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_250pc_cleaning_concs$scenario <- as.factor('PR_03')
random_prob_250pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_250pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_sorting_concs <- as.data.frame(random_prob_250pc_sorting_w5wed_conc_list)
random_prob_250pc_sorting_concs$area <- as.factor('sorting')
random_prob_250pc_sorting_concs$scenario <- as.factor('PR_03')
random_prob_250pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_250pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_reject_concs <- as.data.frame(random_prob_250pc_reject_w5wed_conc_list)
random_prob_250pc_reject_concs$area <- as.factor('reject')
random_prob_250pc_reject_concs$scenario <- as.factor('PR_03')
random_prob_250pc_reject_concs$water <- as.factor('Dry')
names(random_prob_250pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_tray_packing_concs <- as.data.frame(random_prob_250pc_tray_packing_w5wed_conc_list)
random_prob_250pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_250pc_tray_packing_concs$scenario <- as.factor('PR_03')
random_prob_250pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_250pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_other_concs <- as.data.frame(random_prob_250pc_other_w5wed_conc_list)
random_prob_250pc_other_concs$area <- as.factor('other')
random_prob_250pc_other_concs$scenario <- as.factor('PR_03')
random_prob_250pc_other_concs$water <- as.factor('Dry')
names(random_prob_250pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_w5wed_concs <- rbind(random_prob_250pc_loading_concs,random_prob_250pc_cleaning_concs,random_prob_250pc_sorting_concs,random_prob_250pc_tray_packing_concs,random_prob_250pc_reject_concs,random_prob_250pc_other_concs)

random_prob_250pc_loading_prev <- as.data.frame(NL_table_Random_Prob_250pc$loading_w5wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_loading_prev$area <- as.factor('loading')
random_prob_250pc_loading_prev$scenario <- as.factor('PR_03')
random_prob_250pc_loading_prev$water <- as.factor('Wet')
names(random_prob_250pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_250pc$cleaning_w5wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_250pc_cleaning_prev$scenario <- as.factor('PR_03')
random_prob_250pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_250pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_250pc$sorting_w5wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_sorting_prev$area <- as.factor('sorting')
random_prob_250pc_sorting_prev$scenario <- as.factor('PR_03')
random_prob_250pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_250pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_reject_prev <- as.data.frame(NL_table_Random_Prob_250pc$reject_w5wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_reject_prev$area <- as.factor('reject')
random_prob_250pc_reject_prev$scenario <- as.factor('PR_03')
random_prob_250pc_reject_prev$water <- as.factor('Dry')
names(random_prob_250pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_250pc$tray_packing_w5wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_250pc_tray_packing_prev$scenario <- as.factor('PR_03')
random_prob_250pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_250pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_other_prev <- as.data.frame(NL_table_Random_Prob_250pc$other_w5wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_other_prev$area <- as.factor('other')
random_prob_250pc_other_prev$scenario <- as.factor('PR_03')
random_prob_250pc_other_prev$water <- as.factor('Dry')
names(random_prob_250pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_w5wed_prev <- rbind(random_prob_250pc_loading_prev,random_prob_250pc_cleaning_prev,random_prob_250pc_sorting_prev,random_prob_250pc_tray_packing_prev,random_prob_250pc_reject_prev,random_prob_250pc_other_prev)

random_prob_250pc_w5wed_wet_prev <- as.data.frame(random_prob_250pc_loading_prev$prevalence*21/100+random_prob_250pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_250pc_w5wed_wet_prev$scenario <- as.factor('PR_03')
random_prob_250pc_w5wed_wet_prev$water <- as.factor('Wet')
names(random_prob_250pc_w5wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_250pc_w5wed_dry_prev <- as.data.frame(random_prob_250pc_sorting_prev$prevalence*20/100+random_prob_250pc_reject_prev$prevalence*23/100+random_prob_250pc_tray_packing_prev$prevalence*123/100+random_prob_250pc_other_prev$prevalence*10/100)/176*100
random_prob_250pc_w5wed_dry_prev$scenario <- as.factor('PR_03')
random_prob_250pc_w5wed_dry_prev$water <- as.factor('Dry')
names(random_prob_250pc_w5wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_250pc_w5wed_recombined_prev <- rbind(random_prob_250pc_w5wed_wet_prev, random_prob_250pc_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Random_Prob_250pc$loading_w6wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_loading_w6wed_conc_list <- append(random_prob_250pc_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_loading_w6wed_conc_matrix <- matrix(unlist(random_prob_250pc_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_cleaning_w6wed_conc_list <- append(random_prob_250pc_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_cleaning_w6wed_conc_matrix <- matrix(unlist(random_prob_250pc_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_250pc$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_250pc_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_250pc_drying_w6wed_conc_list <- append(random_prob_250pc_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_250pc$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_sorting_w6wed_conc_list <- append(random_prob_250pc_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_sorting_w6wed_conc_matrix <- matrix(unlist(random_prob_250pc_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_tray_packing_w6wed_conc_list <- append(random_prob_250pc_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_tray_packing_w6wed_conc_matrix <- matrix(unlist(random_prob_250pc_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$reject_w6wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_reject_w6wed_conc_list <- append(random_prob_250pc_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_reject_w6wed_conc_matrix <- matrix(unlist(random_prob_250pc_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$other_w6wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_other_w6wed_conc_list <- append(random_prob_250pc_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_other_w6wed_conc_matrix <- matrix(unlist(random_prob_250pc_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_250pc_loading_concs <- as.data.frame(random_prob_250pc_loading_w6wed_conc_list)
random_prob_250pc_loading_concs$area <- as.factor('loading')
random_prob_250pc_loading_concs$scenario <- as.factor('PR_03')
random_prob_250pc_loading_concs$water <- as.factor('Wet')
names(random_prob_250pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_cleaning_concs <- as.data.frame(random_prob_250pc_cleaning_w6wed_conc_list)
random_prob_250pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_250pc_cleaning_concs$scenario <- as.factor('PR_03')
random_prob_250pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_250pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_sorting_concs <- as.data.frame(random_prob_250pc_sorting_w6wed_conc_list)
random_prob_250pc_sorting_concs$area <- as.factor('sorting')
random_prob_250pc_sorting_concs$scenario <- as.factor('PR_03')
random_prob_250pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_250pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_reject_concs <- as.data.frame(random_prob_250pc_reject_w6wed_conc_list)
random_prob_250pc_reject_concs$area <- as.factor('reject')
random_prob_250pc_reject_concs$scenario <- as.factor('PR_03')
random_prob_250pc_reject_concs$water <- as.factor('Dry')
names(random_prob_250pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_tray_packing_concs <- as.data.frame(random_prob_250pc_tray_packing_w6wed_conc_list)
random_prob_250pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_250pc_tray_packing_concs$scenario <- as.factor('PR_03')
random_prob_250pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_250pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_other_concs <- as.data.frame(random_prob_250pc_other_w6wed_conc_list)
random_prob_250pc_other_concs$area <- as.factor('other')
random_prob_250pc_other_concs$scenario <- as.factor('PR_03')
random_prob_250pc_other_concs$water <- as.factor('Dry')
names(random_prob_250pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_w6wed_concs <- rbind(random_prob_250pc_loading_concs,random_prob_250pc_cleaning_concs,random_prob_250pc_sorting_concs,random_prob_250pc_tray_packing_concs,random_prob_250pc_reject_concs,random_prob_250pc_other_concs)

random_prob_250pc_loading_prev <- as.data.frame(NL_table_Random_Prob_250pc$loading_w6wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_loading_prev$area <- as.factor('loading')
random_prob_250pc_loading_prev$scenario <- as.factor('PR_03')
random_prob_250pc_loading_prev$water <- as.factor('Wet')
names(random_prob_250pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_250pc$cleaning_w6wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_250pc_cleaning_prev$scenario <- as.factor('PR_03')
random_prob_250pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_250pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_250pc$sorting_w6wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_sorting_prev$area <- as.factor('sorting')
random_prob_250pc_sorting_prev$scenario <- as.factor('PR_03')
random_prob_250pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_250pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_reject_prev <- as.data.frame(NL_table_Random_Prob_250pc$reject_w6wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_reject_prev$area <- as.factor('reject')
random_prob_250pc_reject_prev$scenario <- as.factor('PR_03')
random_prob_250pc_reject_prev$water <- as.factor('Dry')
names(random_prob_250pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_250pc$tray_packing_w6wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_250pc_tray_packing_prev$scenario <- as.factor('PR_03')
random_prob_250pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_250pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_other_prev <- as.data.frame(NL_table_Random_Prob_250pc$other_w6wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_other_prev$area <- as.factor('other')
random_prob_250pc_other_prev$scenario <- as.factor('PR_03')
random_prob_250pc_other_prev$water <- as.factor('Dry')
names(random_prob_250pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_w6wed_prev <- rbind(random_prob_250pc_loading_prev,random_prob_250pc_cleaning_prev,random_prob_250pc_sorting_prev,random_prob_250pc_tray_packing_prev,random_prob_250pc_reject_prev,random_prob_250pc_other_prev)

random_prob_250pc_w6wed_wet_prev <- as.data.frame(random_prob_250pc_loading_prev$prevalence*21/100+random_prob_250pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_250pc_w6wed_wet_prev$scenario <- as.factor('PR_03')
random_prob_250pc_w6wed_wet_prev$water <- as.factor('Wet')
names(random_prob_250pc_w6wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_250pc_w6wed_dry_prev <- as.data.frame(random_prob_250pc_sorting_prev$prevalence*20/100+random_prob_250pc_reject_prev$prevalence*23/100+random_prob_250pc_tray_packing_prev$prevalence*123/100+random_prob_250pc_other_prev$prevalence*10/100)/176*100
random_prob_250pc_w6wed_dry_prev$scenario <- as.factor('PR_03')
random_prob_250pc_w6wed_dry_prev$water <- as.factor('Dry')
names(random_prob_250pc_w6wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_250pc_w6wed_recombined_prev <- rbind(random_prob_250pc_w6wed_wet_prev, random_prob_250pc_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Random_Prob_250pc$loading_w7wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_loading_w7wed_conc_list <- append(random_prob_250pc_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_loading_w7wed_conc_matrix <- matrix(unlist(random_prob_250pc_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_cleaning_w7wed_conc_list <- append(random_prob_250pc_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_cleaning_w7wed_conc_matrix <- matrix(unlist(random_prob_250pc_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_250pc$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_250pc_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_250pc_drying_w7wed_conc_list <- append(random_prob_250pc_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_250pc$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_sorting_w7wed_conc_list <- append(random_prob_250pc_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_sorting_w7wed_conc_matrix <- matrix(unlist(random_prob_250pc_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_tray_packing_w7wed_conc_list <- append(random_prob_250pc_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_tray_packing_w7wed_conc_matrix <- matrix(unlist(random_prob_250pc_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$reject_w7wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_reject_w7wed_conc_list <- append(random_prob_250pc_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_reject_w7wed_conc_matrix <- matrix(unlist(random_prob_250pc_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$other_w7wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_other_w7wed_conc_list <- append(random_prob_250pc_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_other_w7wed_conc_matrix <- matrix(unlist(random_prob_250pc_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_250pc_loading_concs <- as.data.frame(random_prob_250pc_loading_w7wed_conc_list)
random_prob_250pc_loading_concs$area <- as.factor('loading')
random_prob_250pc_loading_concs$scenario <- as.factor('PR_03')
random_prob_250pc_loading_concs$water <- as.factor('Wet')
names(random_prob_250pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_cleaning_concs <- as.data.frame(random_prob_250pc_cleaning_w7wed_conc_list)
random_prob_250pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_250pc_cleaning_concs$scenario <- as.factor('PR_03')
random_prob_250pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_250pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_sorting_concs <- as.data.frame(random_prob_250pc_sorting_w7wed_conc_list)
random_prob_250pc_sorting_concs$area <- as.factor('sorting')
random_prob_250pc_sorting_concs$scenario <- as.factor('PR_03')
random_prob_250pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_250pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_reject_concs <- as.data.frame(random_prob_250pc_reject_w7wed_conc_list)
random_prob_250pc_reject_concs$area <- as.factor('reject')
random_prob_250pc_reject_concs$scenario <- as.factor('PR_03')
random_prob_250pc_reject_concs$water <- as.factor('Dry')
names(random_prob_250pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_tray_packing_concs <- as.data.frame(random_prob_250pc_tray_packing_w7wed_conc_list)
random_prob_250pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_250pc_tray_packing_concs$scenario <- as.factor('PR_03')
random_prob_250pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_250pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_other_concs <- as.data.frame(random_prob_250pc_other_w7wed_conc_list)
random_prob_250pc_other_concs$area <- as.factor('other')
random_prob_250pc_other_concs$scenario <- as.factor('PR_03')
random_prob_250pc_other_concs$water <- as.factor('Dry')
names(random_prob_250pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_w7wed_concs <- rbind(random_prob_250pc_loading_concs,random_prob_250pc_cleaning_concs,random_prob_250pc_sorting_concs,random_prob_250pc_tray_packing_concs,random_prob_250pc_reject_concs,random_prob_250pc_other_concs)

random_prob_250pc_loading_prev <- as.data.frame(NL_table_Random_Prob_250pc$loading_w7wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_loading_prev$area <- as.factor('loading')
random_prob_250pc_loading_prev$scenario <- as.factor('PR_03')
random_prob_250pc_loading_prev$water <- as.factor('Wet')
names(random_prob_250pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_250pc$cleaning_w7wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_250pc_cleaning_prev$scenario <- as.factor('PR_03')
random_prob_250pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_250pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_250pc$sorting_w7wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_sorting_prev$area <- as.factor('sorting')
random_prob_250pc_sorting_prev$scenario <- as.factor('PR_03')
random_prob_250pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_250pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_reject_prev <- as.data.frame(NL_table_Random_Prob_250pc$reject_w7wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_reject_prev$area <- as.factor('reject')
random_prob_250pc_reject_prev$scenario <- as.factor('PR_03')
random_prob_250pc_reject_prev$water <- as.factor('Dry')
names(random_prob_250pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_250pc$tray_packing_w7wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_250pc_tray_packing_prev$scenario <- as.factor('PR_03')
random_prob_250pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_250pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_other_prev <- as.data.frame(NL_table_Random_Prob_250pc$other_w7wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_other_prev$area <- as.factor('other')
random_prob_250pc_other_prev$scenario <- as.factor('PR_03')
random_prob_250pc_other_prev$water <- as.factor('Dry')
names(random_prob_250pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_w7wed_prev <- rbind(random_prob_250pc_loading_prev,random_prob_250pc_cleaning_prev,random_prob_250pc_sorting_prev,random_prob_250pc_tray_packing_prev,random_prob_250pc_reject_prev,random_prob_250pc_other_prev)

random_prob_250pc_w7wed_wet_prev <- as.data.frame(random_prob_250pc_loading_prev$prevalence*21/100+random_prob_250pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_250pc_w7wed_wet_prev$scenario <- as.factor('PR_03')
random_prob_250pc_w7wed_wet_prev$water <- as.factor('Wet')
names(random_prob_250pc_w7wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_250pc_w7wed_dry_prev <- as.data.frame(random_prob_250pc_sorting_prev$prevalence*20/100+random_prob_250pc_reject_prev$prevalence*23/100+random_prob_250pc_tray_packing_prev$prevalence*123/100+random_prob_250pc_other_prev$prevalence*10/100)/176*100
random_prob_250pc_w7wed_dry_prev$scenario <- as.factor('PR_03')
random_prob_250pc_w7wed_dry_prev$water <- as.factor('Dry')
names(random_prob_250pc_w7wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_250pc_w7wed_recombined_prev <- rbind(random_prob_250pc_w7wed_wet_prev, random_prob_250pc_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Random_Prob_250pc$loading_w8wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_loading_w8wed_conc_list <- append(random_prob_250pc_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_loading_w8wed_conc_matrix <- matrix(unlist(random_prob_250pc_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_cleaning_w8wed_conc_list <- append(random_prob_250pc_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_cleaning_w8wed_conc_matrix <- matrix(unlist(random_prob_250pc_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Random_Prob_250pc$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# random_prob_250pc_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   random_prob_250pc_drying_w8wed_conc_list <- append(random_prob_250pc_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Random_Prob_250pc$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_sorting_w8wed_conc_list <- append(random_prob_250pc_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_sorting_w8wed_conc_matrix <- matrix(unlist(random_prob_250pc_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_tray_packing_w8wed_conc_list <- append(random_prob_250pc_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_tray_packing_w8wed_conc_matrix <- matrix(unlist(random_prob_250pc_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$reject_w8wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_reject_w8wed_conc_list <- append(random_prob_250pc_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_reject_w8wed_conc_matrix <- matrix(unlist(random_prob_250pc_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Random_Prob_250pc$other_w8wed_conc_list
vector <- vector[vector!='[]']
random_prob_250pc_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  random_prob_250pc_other_w8wed_conc_list <- append(random_prob_250pc_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
random_prob_250pc_other_w8wed_conc_matrix <- matrix(unlist(random_prob_250pc_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

random_prob_250pc_loading_concs <- as.data.frame(random_prob_250pc_loading_w8wed_conc_list)
random_prob_250pc_loading_concs$area <- as.factor('loading')
random_prob_250pc_loading_concs$scenario <- as.factor('PR_03')
random_prob_250pc_loading_concs$water <- as.factor('Wet')
names(random_prob_250pc_loading_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_cleaning_concs <- as.data.frame(random_prob_250pc_cleaning_w8wed_conc_list)
random_prob_250pc_cleaning_concs$area <- as.factor('cleaning')
random_prob_250pc_cleaning_concs$scenario <- as.factor('PR_03')
random_prob_250pc_cleaning_concs$water <- as.factor('Wet')
names(random_prob_250pc_cleaning_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_sorting_concs <- as.data.frame(random_prob_250pc_sorting_w8wed_conc_list)
random_prob_250pc_sorting_concs$area <- as.factor('sorting')
random_prob_250pc_sorting_concs$scenario <- as.factor('PR_03')
random_prob_250pc_sorting_concs$water <- as.factor('Dry')
names(random_prob_250pc_sorting_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_reject_concs <- as.data.frame(random_prob_250pc_reject_w8wed_conc_list)
random_prob_250pc_reject_concs$area <- as.factor('reject')
random_prob_250pc_reject_concs$scenario <- as.factor('PR_03')
random_prob_250pc_reject_concs$water <- as.factor('Dry')
names(random_prob_250pc_reject_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_tray_packing_concs <- as.data.frame(random_prob_250pc_tray_packing_w8wed_conc_list)
random_prob_250pc_tray_packing_concs$area <- as.factor('tray packing')
random_prob_250pc_tray_packing_concs$scenario <- as.factor('PR_03')
random_prob_250pc_tray_packing_concs$water <- as.factor('Dry')
names(random_prob_250pc_tray_packing_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_other_concs <- as.data.frame(random_prob_250pc_other_w8wed_conc_list)
random_prob_250pc_other_concs$area <- as.factor('other')
random_prob_250pc_other_concs$scenario <- as.factor('PR_03')
random_prob_250pc_other_concs$water <- as.factor('Dry')
names(random_prob_250pc_other_concs) <- c('concentration','area','scenario','water')

random_prob_250pc_w8wed_concs <- rbind(random_prob_250pc_loading_concs,random_prob_250pc_cleaning_concs,random_prob_250pc_sorting_concs,random_prob_250pc_tray_packing_concs,random_prob_250pc_reject_concs,random_prob_250pc_other_concs)

random_prob_250pc_loading_prev <- as.data.frame(NL_table_Random_Prob_250pc$loading_w8wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_loading_prev$area <- as.factor('loading')
random_prob_250pc_loading_prev$scenario <- as.factor('PR_03')
random_prob_250pc_loading_prev$water <- as.factor('Wet')
names(random_prob_250pc_loading_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_cleaning_prev <- as.data.frame(NL_table_Random_Prob_250pc$cleaning_w8wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_cleaning_prev$area <- as.factor('cleaning')
random_prob_250pc_cleaning_prev$scenario <- as.factor('PR_03')
random_prob_250pc_cleaning_prev$water <- as.factor('Wet')
names(random_prob_250pc_cleaning_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_sorting_prev <- as.data.frame(NL_table_Random_Prob_250pc$sorting_w8wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_sorting_prev$area <- as.factor('sorting')
random_prob_250pc_sorting_prev$scenario <- as.factor('PR_03')
random_prob_250pc_sorting_prev$water <- as.factor('Dry')
names(random_prob_250pc_sorting_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_reject_prev <- as.data.frame(NL_table_Random_Prob_250pc$reject_w8wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_reject_prev$area <- as.factor('reject')
random_prob_250pc_reject_prev$scenario <- as.factor('PR_03')
random_prob_250pc_reject_prev$water <- as.factor('Dry')
names(random_prob_250pc_reject_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_tray_packing_prev <- as.data.frame(NL_table_Random_Prob_250pc$tray_packing_w8wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_tray_packing_prev$area <- as.factor('tray packing')
random_prob_250pc_tray_packing_prev$scenario <- as.factor('PR_03')
random_prob_250pc_tray_packing_prev$water <- as.factor('Dry')
names(random_prob_250pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_other_prev <- as.data.frame(NL_table_Random_Prob_250pc$other_w8wed_prev[order(NL_table_Random_Prob_250pc$local_seed)])
random_prob_250pc_other_prev$area <- as.factor('other')
random_prob_250pc_other_prev$scenario <- as.factor('PR_03')
random_prob_250pc_other_prev$water <- as.factor('Dry')
names(random_prob_250pc_other_prev) <- c('prevalence','area','scenario','water')

random_prob_250pc_w8wed_prev <- rbind(random_prob_250pc_loading_prev,random_prob_250pc_cleaning_prev,random_prob_250pc_sorting_prev,random_prob_250pc_tray_packing_prev,random_prob_250pc_reject_prev,random_prob_250pc_other_prev)

random_prob_250pc_w8wed_wet_prev <- as.data.frame(random_prob_250pc_loading_prev$prevalence*21/100+random_prob_250pc_cleaning_prev$prevalence*28/100)/49*100
random_prob_250pc_w8wed_wet_prev$scenario <- as.factor('PR_03')
random_prob_250pc_w8wed_wet_prev$water <- as.factor('Wet')
names(random_prob_250pc_w8wed_wet_prev) <- c('prevalence','scenario','water')

random_prob_250pc_w8wed_dry_prev <- as.data.frame(random_prob_250pc_sorting_prev$prevalence*20/100+random_prob_250pc_reject_prev$prevalence*23/100+random_prob_250pc_tray_packing_prev$prevalence*123/100+random_prob_250pc_other_prev$prevalence*10/100)/176*100
random_prob_250pc_w8wed_dry_prev$scenario <- as.factor('PR_03')
random_prob_250pc_w8wed_dry_prev$water <- as.factor('Dry')
names(random_prob_250pc_w8wed_dry_prev) <- c('prevalence','scenario','water')

random_prob_250pc_w8wed_recombined_prev <- rbind(random_prob_250pc_w8wed_wet_prev, random_prob_250pc_w8wed_dry_prev)

vector <- NL_table_Random_Prob_250pc$lifetime_conc_list[order(NL_table_Random_Prob_250pc$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

random_prob_250pc_w1wed_recombined_prev$week <- as.factor(1)
random_prob_250pc_w2wed_recombined_prev$week <- as.factor(2)
random_prob_250pc_w3wed_recombined_prev$week <- as.factor(3)
random_prob_250pc_w4wed_recombined_prev$week <- as.factor(4)
random_prob_250pc_w5wed_recombined_prev$week <- as.factor(5)
random_prob_250pc_w6wed_recombined_prev$week <- as.factor(6)
random_prob_250pc_w7wed_recombined_prev$week <- as.factor(7)
random_prob_250pc_w8wed_recombined_prev$week <- as.factor(8)
random_prob_250pc_allwed_prev <- rbind(random_prob_250pc_w1wed_recombined_prev,random_prob_250pc_w2wed_recombined_prev,random_prob_250pc_w3wed_recombined_prev,random_prob_250pc_w4wed_recombined_prev,random_prob_250pc_w5wed_recombined_prev,random_prob_250pc_w6wed_recombined_prev,random_prob_250pc_w7wed_recombined_prev,random_prob_250pc_w8wed_recombined_prev)

Facility_B_random_prob_250pc_agents_melted <- melt(mdarray)
colnames(Facility_B_random_prob_250pc_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_random_prob_250pc_agents_melted$agent <- Facility_B_random_prob_250pc_agents_melted$agent-1
Facility_B_random_prob_250pc_agents_melted$logical <- Facility_B_random_prob_250pc_agents_melted$value>0
Facility_B_random_prob_250pc_agents_melted$binary <- as.numeric(Facility_B_random_prob_250pc_agents_melted$logical)
Facility_B_random_prob_250pc_agents_melted$log10value <- log10(Facility_B_random_prob_250pc_agents_melted$value)
Facility_B_random_prob_250pc_agents_melted$log10value[is.infinite(Facility_B_random_prob_250pc_agents_melted$log10value)] <- 0

agent <- Facility_B_random_prob_250pc_agents_melted$agent
iteration <- Facility_B_random_prob_250pc_agents_melted$iteration
tick <- Facility_B_random_prob_250pc_agents_melted$tick
rle_matrix <- tapply(Facility_B_random_prob_250pc_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_random_prob_250pc_agents_melted_mean_value_matrix <- tapply(Facility_B_random_prob_250pc_agents_melted$value, list(agent, tick), mean)
Facility_B_random_prob_250pc_agents_melted_median_value_matrix <- tapply(Facility_B_random_prob_250pc_agents_melted$value, list(agent, tick), median)
Facility_B_random_prob_250pc_agents_melted_prob_value_matrix <- tapply(Facility_B_random_prob_250pc_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}
# durations$agent <- durations$agent-1

Facility_B_durations_random_prob_250pc <- durations

agents_list_random_prob_250pc <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_random_prob_250pc <- agents_list_random_prob_250pc[,c("V1","V7","V8","V9")]
colnames(agents_list_random_prob_250pc) <- c("name","sanitation_status","schedule","area")
agents_list_random_prob_250pc$ttp <- rep((168*2),225)
agents_list_random_prob_250pc$ttp[agents_list_random_prob_250pc$schedule=="daily"] <- (24*2)

agent <- 1
while(agent<=225) {
  agents_list_random_prob_250pc$min_duration[agent] <- ifelse(length(Facility_B_durations_random_prob_250pc$duration[Facility_B_durations_random_prob_250pc$agent==agent])==0,NA,min(Facility_B_durations_random_prob_250pc$duration[Facility_B_durations_random_prob_250pc$agent==agent], na.rm = TRUE))
  agents_list_random_prob_250pc$mean_duration[agent] <- ifelse(length(Facility_B_durations_random_prob_250pc$duration[Facility_B_durations_random_prob_250pc$agent==agent])==0,NA,mean(Facility_B_durations_random_prob_250pc$duration[Facility_B_durations_random_prob_250pc$agent==agent], na.rm = TRUE))
  agents_list_random_prob_250pc$median_duration[agent] <- ifelse(length(Facility_B_durations_random_prob_250pc$duration[Facility_B_durations_random_prob_250pc$agent==agent])==0,NA,median(Facility_B_durations_random_prob_250pc$duration[Facility_B_durations_random_prob_250pc$agent==agent], na.rm = TRUE))
  agents_list_random_prob_250pc$max_duration[agent] <- ifelse(length(Facility_B_durations_random_prob_250pc$duration[Facility_B_durations_random_prob_250pc$agent==agent])==0,NA,max(Facility_B_durations_random_prob_250pc$duration[Facility_B_durations_random_prob_250pc$agent==agent], na.rm = TRUE))
  agents_list_random_prob_250pc$times_persistent[agent] <- sum(Facility_B_durations_random_prob_250pc$duration[Facility_B_durations_random_prob_250pc$agent==agent]>agents_list_random_prob_250pc$ttp[agent])
  agent <- agent+1 
}

Facility_B_random_prob_250pc_agents_melted_monday_preop <- Facility_B_random_prob_250pc_agents_melted[which(Facility_B_random_prob_250pc_agents_melted$tick==33|Facility_B_random_prob_250pc_agents_melted$tick==201|Facility_B_random_prob_250pc_agents_melted$tick==369|Facility_B_random_prob_250pc_agents_melted$tick==537|Facility_B_random_prob_250pc_agents_melted$tick==705|Facility_B_random_prob_250pc_agents_melted$tick==873|Facility_B_random_prob_250pc_agents_melted$tick==1041|Facility_B_random_prob_250pc_agents_melted$tick==1209),]

Facility_B_random_prob_250pc_agents_melted_tuesday_preop <- Facility_B_random_prob_250pc_agents_melted[which(Facility_B_random_prob_250pc_agents_melted$tick==57|Facility_B_random_prob_250pc_agents_melted$tick==225|Facility_B_random_prob_250pc_agents_melted$tick==393|Facility_B_random_prob_250pc_agents_melted$tick==561|Facility_B_random_prob_250pc_agents_melted$tick==729|Facility_B_random_prob_250pc_agents_melted$tick==897|Facility_B_random_prob_250pc_agents_melted$tick==1065|Facility_B_random_prob_250pc_agents_melted$tick==1233),]

Facility_B_random_prob_250pc_agents_melted_wednesday_preop <- Facility_B_random_prob_250pc_agents_melted[which(Facility_B_random_prob_250pc_agents_melted$tick==81|Facility_B_random_prob_250pc_agents_melted$tick==249|Facility_B_random_prob_250pc_agents_melted$tick==417|Facility_B_random_prob_250pc_agents_melted$tick==585|Facility_B_random_prob_250pc_agents_melted$tick==753|Facility_B_random_prob_250pc_agents_melted$tick==921|Facility_B_random_prob_250pc_agents_melted$tick==1089|Facility_B_random_prob_250pc_agents_melted$tick==1257),]

Facility_B_random_prob_250pc_agents_melted_thursday_preop <- Facility_B_random_prob_250pc_agents_melted[which(Facility_B_random_prob_250pc_agents_melted$tick==105|Facility_B_random_prob_250pc_agents_melted$tick==273|Facility_B_random_prob_250pc_agents_melted$tick==441|Facility_B_random_prob_250pc_agents_melted$tick==609|Facility_B_random_prob_250pc_agents_melted$tick==777|Facility_B_random_prob_250pc_agents_melted$tick==945|Facility_B_random_prob_250pc_agents_melted$tick==1113|Facility_B_random_prob_250pc_agents_melted$tick==1281),]

Facility_B_random_prob_250pc_agents_melted_friday_preop <- Facility_B_random_prob_250pc_agents_melted[which(Facility_B_random_prob_250pc_agents_melted$tick==129|Facility_B_random_prob_250pc_agents_melted$tick==297|Facility_B_random_prob_250pc_agents_melted$tick==465|Facility_B_random_prob_250pc_agents_melted$tick==633|Facility_B_random_prob_250pc_agents_melted$tick==801|Facility_B_random_prob_250pc_agents_melted$tick==969|Facility_B_random_prob_250pc_agents_melted$tick==1137|Facility_B_random_prob_250pc_agents_melted$tick==1305),]

Facility_B_random_prob_250pc_agents_melted_ff <- as.ffdf(Facility_B_random_prob_250pc_agents_melted)
rm(Facility_B_random_prob_250pc_agents_melted)
gc()
```

```{r import P Z4 Reduction 75%}
NL_table_Z4_Prob_75pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-28-00-01 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_P_Z4_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Z4_Prob_75pc <- NL_table_Z4_Prob_75pc[NL_table_Z4_Prob_75pc$scenario==35,]

while (any(grepl('-', names(NL_table_Z4_Prob_75pc), fixed = TRUE))) {
  NL_table_Z4_Prob_75pc <- NL_table_Z4_Prob_75pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Z4_Prob_75pc), fixed = TRUE))) {
  NL_table_Z4_Prob_75pc <- NL_table_Z4_Prob_75pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Z4_Prob_75pc), fixed = TRUE))) {
  NL_table_Z4_Prob_75pc <- NL_table_Z4_Prob_75pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Z4_Prob_75pc), fixed = TRUE))) {
  NL_table_Z4_Prob_75pc <- NL_table_Z4_Prob_75pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Z4_Prob_75pc[ , ..list_columns]

NL_table_Z4_Prob_75pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Z4_Prob_75pc <- as.data.frame(NL_table_Z4_Prob_75pc)

NL_table_Z4_Prob_75pc[NL_table_Z4_Prob_75pc==-1] <- NA

NL_table_Z4_Prob_75pc <- subset(NL_table_Z4_Prob_75pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Z4_Prob_75pc)[names(NL_table_Z4_Prob_75pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Z4_Prob_75pc)[names(NL_table_Z4_Prob_75pc)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Z4_Prob_75pc$loading_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_loading_w1wed_conc_list <- append(z4_prob_75pc_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_loading_w1wed_conc_matrix <- matrix(unlist(z4_prob_75pc_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_cleaning_w1wed_conc_list <- append(z4_prob_75pc_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_cleaning_w1wed_conc_matrix <- matrix(unlist(z4_prob_75pc_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_75pc$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_75pc_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_75pc_drying_w1wed_conc_list <- append(z4_prob_75pc_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_75pc$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_sorting_w1wed_conc_list <- append(z4_prob_75pc_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_sorting_w1wed_conc_matrix <- matrix(unlist(z4_prob_75pc_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_tray_packing_w1wed_conc_list <- append(z4_prob_75pc_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_tray_packing_w1wed_conc_matrix <- matrix(unlist(z4_prob_75pc_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$reject_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_reject_w1wed_conc_list <- append(z4_prob_75pc_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_reject_w1wed_conc_matrix <- matrix(unlist(z4_prob_75pc_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$other_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_other_w1wed_conc_list <- append(z4_prob_75pc_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_other_w1wed_conc_matrix <- matrix(unlist(z4_prob_75pc_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_75pc_loading_concs <- as.data.frame(z4_prob_75pc_loading_w1wed_conc_list)
z4_prob_75pc_loading_concs$area <- as.factor('loading')
z4_prob_75pc_loading_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_75pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_cleaning_concs <- as.data.frame(z4_prob_75pc_cleaning_w1wed_conc_list)
z4_prob_75pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_75pc_cleaning_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_75pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_sorting_concs <- as.data.frame(z4_prob_75pc_sorting_w1wed_conc_list)
z4_prob_75pc_sorting_concs$area <- as.factor('sorting')
z4_prob_75pc_sorting_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_75pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_reject_concs <- as.data.frame(z4_prob_75pc_reject_w1wed_conc_list)
z4_prob_75pc_reject_concs$area <- as.factor('reject')
z4_prob_75pc_reject_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_75pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_tray_packing_concs <- as.data.frame(z4_prob_75pc_tray_packing_w1wed_conc_list)
z4_prob_75pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_75pc_tray_packing_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_75pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_other_concs <- as.data.frame(z4_prob_75pc_other_w1wed_conc_list)
z4_prob_75pc_other_concs$area <- as.factor('other')
z4_prob_75pc_other_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_other_concs$water <- as.factor('Dry')
names(z4_prob_75pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_w1wed_concs <- rbind(z4_prob_75pc_loading_concs,z4_prob_75pc_cleaning_concs,z4_prob_75pc_sorting_concs,z4_prob_75pc_tray_packing_concs,z4_prob_75pc_reject_concs,z4_prob_75pc_other_concs)

z4_prob_75pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_75pc$loading_w1wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_loading_prev$area <- as.factor('loading')
z4_prob_75pc_loading_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_75pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_75pc$cleaning_w1wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_75pc_cleaning_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_75pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_75pc$sorting_w1wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_sorting_prev$area <- as.factor('sorting')
z4_prob_75pc_sorting_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_75pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_75pc$reject_w1wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_reject_prev$area <- as.factor('reject')
z4_prob_75pc_reject_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_75pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_75pc$tray_packing_w1wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_75pc_tray_packing_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_75pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_other_prev <- as.data.frame(NL_table_Z4_Prob_75pc$other_w1wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_other_prev$area <- as.factor('other')
z4_prob_75pc_other_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_other_prev$water <- as.factor('Dry')
names(z4_prob_75pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_w1wed_prev <- rbind(z4_prob_75pc_loading_prev,z4_prob_75pc_cleaning_prev,z4_prob_75pc_sorting_prev,z4_prob_75pc_tray_packing_prev,z4_prob_75pc_reject_prev,z4_prob_75pc_other_prev)

z4_prob_75pc_w1wed_wet_prev <- as.data.frame(z4_prob_75pc_loading_prev$prevalence*21/100+z4_prob_75pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_75pc_w1wed_wet_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_w1wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_75pc_w1wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_75pc_w1wed_dry_prev <- as.data.frame(z4_prob_75pc_sorting_prev$prevalence*20/100+z4_prob_75pc_reject_prev$prevalence*23/100+z4_prob_75pc_tray_packing_prev$prevalence*123/100+z4_prob_75pc_other_prev$prevalence*10/100)/176*100
z4_prob_75pc_w1wed_dry_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_w1wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_75pc_w1wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_75pc_w1wed_recombined_prev <- rbind(z4_prob_75pc_w1wed_wet_prev, z4_prob_75pc_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Z4_Prob_75pc$loading_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_loading_w2wed_conc_list <- append(z4_prob_75pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_loading_w2wed_conc_matrix <- matrix(unlist(z4_prob_75pc_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_cleaning_w2wed_conc_list <- append(z4_prob_75pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_cleaning_w2wed_conc_matrix <- matrix(unlist(z4_prob_75pc_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_75pc$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_75pc_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_75pc_drying_w2wed_conc_list <- append(z4_prob_75pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_75pc$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_sorting_w2wed_conc_list <- append(z4_prob_75pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_sorting_w2wed_conc_matrix <- matrix(unlist(z4_prob_75pc_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_tray_packing_w2wed_conc_list <- append(z4_prob_75pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_tray_packing_w2wed_conc_matrix <- matrix(unlist(z4_prob_75pc_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$reject_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_reject_w2wed_conc_list <- append(z4_prob_75pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_reject_w2wed_conc_matrix <- matrix(unlist(z4_prob_75pc_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$other_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_other_w2wed_conc_list <- append(z4_prob_75pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_other_w2wed_conc_matrix <- matrix(unlist(z4_prob_75pc_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_75pc_loading_concs <- as.data.frame(z4_prob_75pc_loading_w2wed_conc_list)
z4_prob_75pc_loading_concs$area <- as.factor('loading')
z4_prob_75pc_loading_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_75pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_cleaning_concs <- as.data.frame(z4_prob_75pc_cleaning_w2wed_conc_list)
z4_prob_75pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_75pc_cleaning_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_75pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_sorting_concs <- as.data.frame(z4_prob_75pc_sorting_w2wed_conc_list)
z4_prob_75pc_sorting_concs$area <- as.factor('sorting')
z4_prob_75pc_sorting_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_75pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_reject_concs <- as.data.frame(z4_prob_75pc_reject_w2wed_conc_list)
z4_prob_75pc_reject_concs$area <- as.factor('reject')
z4_prob_75pc_reject_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_75pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_tray_packing_concs <- as.data.frame(z4_prob_75pc_tray_packing_w2wed_conc_list)
z4_prob_75pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_75pc_tray_packing_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_75pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_other_concs <- as.data.frame(z4_prob_75pc_other_w2wed_conc_list)
z4_prob_75pc_other_concs$area <- as.factor('other')
z4_prob_75pc_other_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_other_concs$water <- as.factor('Dry')
names(z4_prob_75pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_w2wed_concs <- rbind(z4_prob_75pc_loading_concs,z4_prob_75pc_cleaning_concs,z4_prob_75pc_sorting_concs,z4_prob_75pc_tray_packing_concs,z4_prob_75pc_reject_concs,z4_prob_75pc_other_concs)

z4_prob_75pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_75pc$loading_w2wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_loading_prev$area <- as.factor('loading')
z4_prob_75pc_loading_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_75pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_75pc$cleaning_w2wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_75pc_cleaning_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_75pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_75pc$sorting_w2wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_sorting_prev$area <- as.factor('sorting')
z4_prob_75pc_sorting_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_75pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_75pc$reject_w2wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_reject_prev$area <- as.factor('reject')
z4_prob_75pc_reject_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_75pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_75pc$tray_packing_w2wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_75pc_tray_packing_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_75pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_other_prev <- as.data.frame(NL_table_Z4_Prob_75pc$other_w2wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_other_prev$area <- as.factor('other')
z4_prob_75pc_other_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_other_prev$water <- as.factor('Dry')
names(z4_prob_75pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_w2wed_prev <- rbind(z4_prob_75pc_loading_prev,z4_prob_75pc_cleaning_prev,z4_prob_75pc_sorting_prev,z4_prob_75pc_tray_packing_prev,z4_prob_75pc_reject_prev,z4_prob_75pc_other_prev)

z4_prob_75pc_w2wed_wet_prev <- as.data.frame(z4_prob_75pc_loading_prev$prevalence*21/100+z4_prob_75pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_75pc_w2wed_wet_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_w2wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_75pc_w2wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_75pc_w2wed_dry_prev <- as.data.frame(z4_prob_75pc_sorting_prev$prevalence*20/100+z4_prob_75pc_reject_prev$prevalence*23/100+z4_prob_75pc_tray_packing_prev$prevalence*123/100+z4_prob_75pc_other_prev$prevalence*10/100)/176*100
z4_prob_75pc_w2wed_dry_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_w2wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_75pc_w2wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_75pc_w2wed_recombined_prev <- rbind(z4_prob_75pc_w2wed_wet_prev, z4_prob_75pc_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Z4_Prob_75pc$loading_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_loading_w3wed_conc_list <- append(z4_prob_75pc_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_loading_w3wed_conc_matrix <- matrix(unlist(z4_prob_75pc_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_cleaning_w3wed_conc_list <- append(z4_prob_75pc_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_cleaning_w3wed_conc_matrix <- matrix(unlist(z4_prob_75pc_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_75pc$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_75pc_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_75pc_drying_w3wed_conc_list <- append(z4_prob_75pc_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_75pc$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_sorting_w3wed_conc_list <- append(z4_prob_75pc_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_sorting_w3wed_conc_matrix <- matrix(unlist(z4_prob_75pc_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_tray_packing_w3wed_conc_list <- append(z4_prob_75pc_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_tray_packing_w3wed_conc_matrix <- matrix(unlist(z4_prob_75pc_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$reject_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_reject_w3wed_conc_list <- append(z4_prob_75pc_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_reject_w3wed_conc_matrix <- matrix(unlist(z4_prob_75pc_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$other_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_other_w3wed_conc_list <- append(z4_prob_75pc_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_other_w3wed_conc_matrix <- matrix(unlist(z4_prob_75pc_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_75pc_loading_concs <- as.data.frame(z4_prob_75pc_loading_w3wed_conc_list)
z4_prob_75pc_loading_concs$area <- as.factor('loading')
z4_prob_75pc_loading_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_75pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_cleaning_concs <- as.data.frame(z4_prob_75pc_cleaning_w3wed_conc_list)
z4_prob_75pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_75pc_cleaning_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_75pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_sorting_concs <- as.data.frame(z4_prob_75pc_sorting_w3wed_conc_list)
z4_prob_75pc_sorting_concs$area <- as.factor('sorting')
z4_prob_75pc_sorting_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_75pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_reject_concs <- as.data.frame(z4_prob_75pc_reject_w3wed_conc_list)
z4_prob_75pc_reject_concs$area <- as.factor('reject')
z4_prob_75pc_reject_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_75pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_tray_packing_concs <- as.data.frame(z4_prob_75pc_tray_packing_w3wed_conc_list)
z4_prob_75pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_75pc_tray_packing_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_75pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_other_concs <- as.data.frame(z4_prob_75pc_other_w3wed_conc_list)
z4_prob_75pc_other_concs$area <- as.factor('other')
z4_prob_75pc_other_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_other_concs$water <- as.factor('Dry')
names(z4_prob_75pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_w3wed_concs <- rbind(z4_prob_75pc_loading_concs,z4_prob_75pc_cleaning_concs,z4_prob_75pc_sorting_concs,z4_prob_75pc_tray_packing_concs,z4_prob_75pc_reject_concs,z4_prob_75pc_other_concs)

z4_prob_75pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_75pc$loading_w3wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_loading_prev$area <- as.factor('loading')
z4_prob_75pc_loading_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_75pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_75pc$cleaning_w3wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_75pc_cleaning_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_75pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_75pc$sorting_w3wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_sorting_prev$area <- as.factor('sorting')
z4_prob_75pc_sorting_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_75pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_75pc$reject_w3wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_reject_prev$area <- as.factor('reject')
z4_prob_75pc_reject_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_75pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_75pc$tray_packing_w3wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_75pc_tray_packing_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_75pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_other_prev <- as.data.frame(NL_table_Z4_Prob_75pc$other_w3wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_other_prev$area <- as.factor('other')
z4_prob_75pc_other_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_other_prev$water <- as.factor('Dry')
names(z4_prob_75pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_w3wed_prev <- rbind(z4_prob_75pc_loading_prev,z4_prob_75pc_cleaning_prev,z4_prob_75pc_sorting_prev,z4_prob_75pc_tray_packing_prev,z4_prob_75pc_reject_prev,z4_prob_75pc_other_prev)

z4_prob_75pc_w3wed_wet_prev <- as.data.frame(z4_prob_75pc_loading_prev$prevalence*21/100+z4_prob_75pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_75pc_w3wed_wet_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_w3wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_75pc_w3wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_75pc_w3wed_dry_prev <- as.data.frame(z4_prob_75pc_sorting_prev$prevalence*20/100+z4_prob_75pc_reject_prev$prevalence*23/100+z4_prob_75pc_tray_packing_prev$prevalence*123/100+z4_prob_75pc_other_prev$prevalence*10/100)/176*100
z4_prob_75pc_w3wed_dry_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_w3wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_75pc_w3wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_75pc_w3wed_recombined_prev <- rbind(z4_prob_75pc_w3wed_wet_prev, z4_prob_75pc_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Z4_Prob_75pc$loading_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_loading_w4wed_conc_list <- append(z4_prob_75pc_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_loading_w4wed_conc_matrix <- matrix(unlist(z4_prob_75pc_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_cleaning_w4wed_conc_list <- append(z4_prob_75pc_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_cleaning_w4wed_conc_matrix <- matrix(unlist(z4_prob_75pc_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_75pc$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_75pc_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_75pc_drying_w4wed_conc_list <- append(z4_prob_75pc_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_75pc$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_sorting_w4wed_conc_list <- append(z4_prob_75pc_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_sorting_w4wed_conc_matrix <- matrix(unlist(z4_prob_75pc_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_tray_packing_w4wed_conc_list <- append(z4_prob_75pc_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_tray_packing_w4wed_conc_matrix <- matrix(unlist(z4_prob_75pc_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$reject_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_reject_w4wed_conc_list <- append(z4_prob_75pc_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_reject_w4wed_conc_matrix <- matrix(unlist(z4_prob_75pc_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$other_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_other_w4wed_conc_list <- append(z4_prob_75pc_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_other_w4wed_conc_matrix <- matrix(unlist(z4_prob_75pc_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_75pc_loading_concs <- as.data.frame(z4_prob_75pc_loading_w4wed_conc_list)
z4_prob_75pc_loading_concs$area <- as.factor('loading')
z4_prob_75pc_loading_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_75pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_cleaning_concs <- as.data.frame(z4_prob_75pc_cleaning_w4wed_conc_list)
z4_prob_75pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_75pc_cleaning_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_75pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_sorting_concs <- as.data.frame(z4_prob_75pc_sorting_w4wed_conc_list)
z4_prob_75pc_sorting_concs$area <- as.factor('sorting')
z4_prob_75pc_sorting_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_75pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_reject_concs <- as.data.frame(z4_prob_75pc_reject_w4wed_conc_list)
z4_prob_75pc_reject_concs$area <- as.factor('reject')
z4_prob_75pc_reject_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_75pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_tray_packing_concs <- as.data.frame(z4_prob_75pc_tray_packing_w4wed_conc_list)
z4_prob_75pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_75pc_tray_packing_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_75pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_other_concs <- as.data.frame(z4_prob_75pc_other_w4wed_conc_list)
z4_prob_75pc_other_concs$area <- as.factor('other')
z4_prob_75pc_other_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_other_concs$water <- as.factor('Dry')
names(z4_prob_75pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_w4wed_concs <- rbind(z4_prob_75pc_loading_concs,z4_prob_75pc_cleaning_concs,z4_prob_75pc_sorting_concs,z4_prob_75pc_tray_packing_concs,z4_prob_75pc_reject_concs,z4_prob_75pc_other_concs)

z4_prob_75pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_75pc$loading_w4wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_loading_prev$area <- as.factor('loading')
z4_prob_75pc_loading_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_75pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_75pc$cleaning_w4wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_75pc_cleaning_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_75pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_75pc$sorting_w4wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_sorting_prev$area <- as.factor('sorting')
z4_prob_75pc_sorting_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_75pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_75pc$reject_w4wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_reject_prev$area <- as.factor('reject')
z4_prob_75pc_reject_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_75pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_75pc$tray_packing_w4wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_75pc_tray_packing_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_75pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_other_prev <- as.data.frame(NL_table_Z4_Prob_75pc$other_w4wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_other_prev$area <- as.factor('other')
z4_prob_75pc_other_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_other_prev$water <- as.factor('Dry')
names(z4_prob_75pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_w4wed_prev <- rbind(z4_prob_75pc_loading_prev,z4_prob_75pc_cleaning_prev,z4_prob_75pc_sorting_prev,z4_prob_75pc_tray_packing_prev,z4_prob_75pc_reject_prev,z4_prob_75pc_other_prev)

z4_prob_75pc_w4wed_wet_prev <- as.data.frame(z4_prob_75pc_loading_prev$prevalence*21/100+z4_prob_75pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_75pc_w4wed_wet_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_w4wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_75pc_w4wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_75pc_w4wed_dry_prev <- as.data.frame(z4_prob_75pc_sorting_prev$prevalence*20/100+z4_prob_75pc_reject_prev$prevalence*23/100+z4_prob_75pc_tray_packing_prev$prevalence*123/100+z4_prob_75pc_other_prev$prevalence*10/100)/176*100
z4_prob_75pc_w4wed_dry_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_w4wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_75pc_w4wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_75pc_w4wed_recombined_prev <- rbind(z4_prob_75pc_w4wed_wet_prev, z4_prob_75pc_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Z4_Prob_75pc$loading_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_loading_w5wed_conc_list <- append(z4_prob_75pc_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_loading_w5wed_conc_matrix <- matrix(unlist(z4_prob_75pc_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_cleaning_w5wed_conc_list <- append(z4_prob_75pc_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_cleaning_w5wed_conc_matrix <- matrix(unlist(z4_prob_75pc_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_75pc$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_75pc_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_75pc_drying_w5wed_conc_list <- append(z4_prob_75pc_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_75pc$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_sorting_w5wed_conc_list <- append(z4_prob_75pc_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_sorting_w5wed_conc_matrix <- matrix(unlist(z4_prob_75pc_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_tray_packing_w5wed_conc_list <- append(z4_prob_75pc_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_tray_packing_w5wed_conc_matrix <- matrix(unlist(z4_prob_75pc_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$reject_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_reject_w5wed_conc_list <- append(z4_prob_75pc_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_reject_w5wed_conc_matrix <- matrix(unlist(z4_prob_75pc_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$other_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_other_w5wed_conc_list <- append(z4_prob_75pc_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_other_w5wed_conc_matrix <- matrix(unlist(z4_prob_75pc_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_75pc_loading_concs <- as.data.frame(z4_prob_75pc_loading_w5wed_conc_list)
z4_prob_75pc_loading_concs$area <- as.factor('loading')
z4_prob_75pc_loading_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_75pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_cleaning_concs <- as.data.frame(z4_prob_75pc_cleaning_w5wed_conc_list)
z4_prob_75pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_75pc_cleaning_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_75pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_sorting_concs <- as.data.frame(z4_prob_75pc_sorting_w5wed_conc_list)
z4_prob_75pc_sorting_concs$area <- as.factor('sorting')
z4_prob_75pc_sorting_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_75pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_reject_concs <- as.data.frame(z4_prob_75pc_reject_w5wed_conc_list)
z4_prob_75pc_reject_concs$area <- as.factor('reject')
z4_prob_75pc_reject_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_75pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_tray_packing_concs <- as.data.frame(z4_prob_75pc_tray_packing_w5wed_conc_list)
z4_prob_75pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_75pc_tray_packing_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_75pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_other_concs <- as.data.frame(z4_prob_75pc_other_w5wed_conc_list)
z4_prob_75pc_other_concs$area <- as.factor('other')
z4_prob_75pc_other_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_other_concs$water <- as.factor('Dry')
names(z4_prob_75pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_w5wed_concs <- rbind(z4_prob_75pc_loading_concs,z4_prob_75pc_cleaning_concs,z4_prob_75pc_sorting_concs,z4_prob_75pc_tray_packing_concs,z4_prob_75pc_reject_concs,z4_prob_75pc_other_concs)

z4_prob_75pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_75pc$loading_w5wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_loading_prev$area <- as.factor('loading')
z4_prob_75pc_loading_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_75pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_75pc$cleaning_w5wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_75pc_cleaning_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_75pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_75pc$sorting_w5wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_sorting_prev$area <- as.factor('sorting')
z4_prob_75pc_sorting_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_75pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_75pc$reject_w5wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_reject_prev$area <- as.factor('reject')
z4_prob_75pc_reject_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_75pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_75pc$tray_packing_w5wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_75pc_tray_packing_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_75pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_other_prev <- as.data.frame(NL_table_Z4_Prob_75pc$other_w5wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_other_prev$area <- as.factor('other')
z4_prob_75pc_other_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_other_prev$water <- as.factor('Dry')
names(z4_prob_75pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_w5wed_prev <- rbind(z4_prob_75pc_loading_prev,z4_prob_75pc_cleaning_prev,z4_prob_75pc_sorting_prev,z4_prob_75pc_tray_packing_prev,z4_prob_75pc_reject_prev,z4_prob_75pc_other_prev)

z4_prob_75pc_w5wed_wet_prev <- as.data.frame(z4_prob_75pc_loading_prev$prevalence*21/100+z4_prob_75pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_75pc_w5wed_wet_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_w5wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_75pc_w5wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_75pc_w5wed_dry_prev <- as.data.frame(z4_prob_75pc_sorting_prev$prevalence*20/100+z4_prob_75pc_reject_prev$prevalence*23/100+z4_prob_75pc_tray_packing_prev$prevalence*123/100+z4_prob_75pc_other_prev$prevalence*10/100)/176*100
z4_prob_75pc_w5wed_dry_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_w5wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_75pc_w5wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_75pc_w5wed_recombined_prev <- rbind(z4_prob_75pc_w5wed_wet_prev, z4_prob_75pc_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Z4_Prob_75pc$loading_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_loading_w6wed_conc_list <- append(z4_prob_75pc_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_loading_w6wed_conc_matrix <- matrix(unlist(z4_prob_75pc_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_cleaning_w6wed_conc_list <- append(z4_prob_75pc_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_cleaning_w6wed_conc_matrix <- matrix(unlist(z4_prob_75pc_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_75pc$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_75pc_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_75pc_drying_w6wed_conc_list <- append(z4_prob_75pc_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_75pc$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_sorting_w6wed_conc_list <- append(z4_prob_75pc_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_sorting_w6wed_conc_matrix <- matrix(unlist(z4_prob_75pc_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_tray_packing_w6wed_conc_list <- append(z4_prob_75pc_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_tray_packing_w6wed_conc_matrix <- matrix(unlist(z4_prob_75pc_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$reject_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_reject_w6wed_conc_list <- append(z4_prob_75pc_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_reject_w6wed_conc_matrix <- matrix(unlist(z4_prob_75pc_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$other_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_other_w6wed_conc_list <- append(z4_prob_75pc_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_other_w6wed_conc_matrix <- matrix(unlist(z4_prob_75pc_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_75pc_loading_concs <- as.data.frame(z4_prob_75pc_loading_w6wed_conc_list)
z4_prob_75pc_loading_concs$area <- as.factor('loading')
z4_prob_75pc_loading_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_75pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_cleaning_concs <- as.data.frame(z4_prob_75pc_cleaning_w6wed_conc_list)
z4_prob_75pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_75pc_cleaning_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_75pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_sorting_concs <- as.data.frame(z4_prob_75pc_sorting_w6wed_conc_list)
z4_prob_75pc_sorting_concs$area <- as.factor('sorting')
z4_prob_75pc_sorting_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_75pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_reject_concs <- as.data.frame(z4_prob_75pc_reject_w6wed_conc_list)
z4_prob_75pc_reject_concs$area <- as.factor('reject')
z4_prob_75pc_reject_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_75pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_tray_packing_concs <- as.data.frame(z4_prob_75pc_tray_packing_w6wed_conc_list)
z4_prob_75pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_75pc_tray_packing_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_75pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_other_concs <- as.data.frame(z4_prob_75pc_other_w6wed_conc_list)
z4_prob_75pc_other_concs$area <- as.factor('other')
z4_prob_75pc_other_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_other_concs$water <- as.factor('Dry')
names(z4_prob_75pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_w6wed_concs <- rbind(z4_prob_75pc_loading_concs,z4_prob_75pc_cleaning_concs,z4_prob_75pc_sorting_concs,z4_prob_75pc_tray_packing_concs,z4_prob_75pc_reject_concs,z4_prob_75pc_other_concs)

z4_prob_75pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_75pc$loading_w6wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_loading_prev$area <- as.factor('loading')
z4_prob_75pc_loading_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_75pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_75pc$cleaning_w6wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_75pc_cleaning_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_75pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_75pc$sorting_w6wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_sorting_prev$area <- as.factor('sorting')
z4_prob_75pc_sorting_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_75pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_75pc$reject_w6wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_reject_prev$area <- as.factor('reject')
z4_prob_75pc_reject_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_75pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_75pc$tray_packing_w6wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_75pc_tray_packing_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_75pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_other_prev <- as.data.frame(NL_table_Z4_Prob_75pc$other_w6wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_other_prev$area <- as.factor('other')
z4_prob_75pc_other_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_other_prev$water <- as.factor('Dry')
names(z4_prob_75pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_w6wed_prev <- rbind(z4_prob_75pc_loading_prev,z4_prob_75pc_cleaning_prev,z4_prob_75pc_sorting_prev,z4_prob_75pc_tray_packing_prev,z4_prob_75pc_reject_prev,z4_prob_75pc_other_prev)

z4_prob_75pc_w6wed_wet_prev <- as.data.frame(z4_prob_75pc_loading_prev$prevalence*21/100+z4_prob_75pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_75pc_w6wed_wet_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_w6wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_75pc_w6wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_75pc_w6wed_dry_prev <- as.data.frame(z4_prob_75pc_sorting_prev$prevalence*20/100+z4_prob_75pc_reject_prev$prevalence*23/100+z4_prob_75pc_tray_packing_prev$prevalence*123/100+z4_prob_75pc_other_prev$prevalence*10/100)/176*100
z4_prob_75pc_w6wed_dry_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_w6wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_75pc_w6wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_75pc_w6wed_recombined_prev <- rbind(z4_prob_75pc_w6wed_wet_prev, z4_prob_75pc_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Z4_Prob_75pc$loading_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_loading_w7wed_conc_list <- append(z4_prob_75pc_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_loading_w7wed_conc_matrix <- matrix(unlist(z4_prob_75pc_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_cleaning_w7wed_conc_list <- append(z4_prob_75pc_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_cleaning_w7wed_conc_matrix <- matrix(unlist(z4_prob_75pc_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_75pc$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_75pc_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_75pc_drying_w7wed_conc_list <- append(z4_prob_75pc_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_75pc$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_sorting_w7wed_conc_list <- append(z4_prob_75pc_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_sorting_w7wed_conc_matrix <- matrix(unlist(z4_prob_75pc_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_tray_packing_w7wed_conc_list <- append(z4_prob_75pc_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_tray_packing_w7wed_conc_matrix <- matrix(unlist(z4_prob_75pc_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$reject_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_reject_w7wed_conc_list <- append(z4_prob_75pc_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_reject_w7wed_conc_matrix <- matrix(unlist(z4_prob_75pc_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$other_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_other_w7wed_conc_list <- append(z4_prob_75pc_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_other_w7wed_conc_matrix <- matrix(unlist(z4_prob_75pc_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_75pc_loading_concs <- as.data.frame(z4_prob_75pc_loading_w7wed_conc_list)
z4_prob_75pc_loading_concs$area <- as.factor('loading')
z4_prob_75pc_loading_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_75pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_cleaning_concs <- as.data.frame(z4_prob_75pc_cleaning_w7wed_conc_list)
z4_prob_75pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_75pc_cleaning_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_75pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_sorting_concs <- as.data.frame(z4_prob_75pc_sorting_w7wed_conc_list)
z4_prob_75pc_sorting_concs$area <- as.factor('sorting')
z4_prob_75pc_sorting_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_75pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_reject_concs <- as.data.frame(z4_prob_75pc_reject_w7wed_conc_list)
z4_prob_75pc_reject_concs$area <- as.factor('reject')
z4_prob_75pc_reject_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_75pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_tray_packing_concs <- as.data.frame(z4_prob_75pc_tray_packing_w7wed_conc_list)
z4_prob_75pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_75pc_tray_packing_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_75pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_other_concs <- as.data.frame(z4_prob_75pc_other_w7wed_conc_list)
z4_prob_75pc_other_concs$area <- as.factor('other')
z4_prob_75pc_other_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_other_concs$water <- as.factor('Dry')
names(z4_prob_75pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_w7wed_concs <- rbind(z4_prob_75pc_loading_concs,z4_prob_75pc_cleaning_concs,z4_prob_75pc_sorting_concs,z4_prob_75pc_tray_packing_concs,z4_prob_75pc_reject_concs,z4_prob_75pc_other_concs)

z4_prob_75pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_75pc$loading_w7wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_loading_prev$area <- as.factor('loading')
z4_prob_75pc_loading_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_75pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_75pc$cleaning_w7wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_75pc_cleaning_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_75pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_75pc$sorting_w7wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_sorting_prev$area <- as.factor('sorting')
z4_prob_75pc_sorting_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_75pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_75pc$reject_w7wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_reject_prev$area <- as.factor('reject')
z4_prob_75pc_reject_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_75pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_75pc$tray_packing_w7wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_75pc_tray_packing_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_75pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_other_prev <- as.data.frame(NL_table_Z4_Prob_75pc$other_w7wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_other_prev$area <- as.factor('other')
z4_prob_75pc_other_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_other_prev$water <- as.factor('Dry')
names(z4_prob_75pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_w7wed_prev <- rbind(z4_prob_75pc_loading_prev,z4_prob_75pc_cleaning_prev,z4_prob_75pc_sorting_prev,z4_prob_75pc_tray_packing_prev,z4_prob_75pc_reject_prev,z4_prob_75pc_other_prev)

z4_prob_75pc_w7wed_wet_prev <- as.data.frame(z4_prob_75pc_loading_prev$prevalence*21/100+z4_prob_75pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_75pc_w7wed_wet_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_w7wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_75pc_w7wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_75pc_w7wed_dry_prev <- as.data.frame(z4_prob_75pc_sorting_prev$prevalence*20/100+z4_prob_75pc_reject_prev$prevalence*23/100+z4_prob_75pc_tray_packing_prev$prevalence*123/100+z4_prob_75pc_other_prev$prevalence*10/100)/176*100
z4_prob_75pc_w7wed_dry_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_w7wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_75pc_w7wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_75pc_w7wed_recombined_prev <- rbind(z4_prob_75pc_w7wed_wet_prev, z4_prob_75pc_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Z4_Prob_75pc$loading_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_loading_w8wed_conc_list <- append(z4_prob_75pc_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_loading_w8wed_conc_matrix <- matrix(unlist(z4_prob_75pc_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_cleaning_w8wed_conc_list <- append(z4_prob_75pc_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_cleaning_w8wed_conc_matrix <- matrix(unlist(z4_prob_75pc_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_75pc$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_75pc_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_75pc_drying_w8wed_conc_list <- append(z4_prob_75pc_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_75pc$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_sorting_w8wed_conc_list <- append(z4_prob_75pc_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_sorting_w8wed_conc_matrix <- matrix(unlist(z4_prob_75pc_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_tray_packing_w8wed_conc_list <- append(z4_prob_75pc_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_tray_packing_w8wed_conc_matrix <- matrix(unlist(z4_prob_75pc_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$reject_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_reject_w8wed_conc_list <- append(z4_prob_75pc_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_reject_w8wed_conc_matrix <- matrix(unlist(z4_prob_75pc_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_75pc$other_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_75pc_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_75pc_other_w8wed_conc_list <- append(z4_prob_75pc_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_75pc_other_w8wed_conc_matrix <- matrix(unlist(z4_prob_75pc_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_75pc_loading_concs <- as.data.frame(z4_prob_75pc_loading_w8wed_conc_list)
z4_prob_75pc_loading_concs$area <- as.factor('loading')
z4_prob_75pc_loading_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_75pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_cleaning_concs <- as.data.frame(z4_prob_75pc_cleaning_w8wed_conc_list)
z4_prob_75pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_75pc_cleaning_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_75pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_sorting_concs <- as.data.frame(z4_prob_75pc_sorting_w8wed_conc_list)
z4_prob_75pc_sorting_concs$area <- as.factor('sorting')
z4_prob_75pc_sorting_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_75pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_reject_concs <- as.data.frame(z4_prob_75pc_reject_w8wed_conc_list)
z4_prob_75pc_reject_concs$area <- as.factor('reject')
z4_prob_75pc_reject_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_75pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_tray_packing_concs <- as.data.frame(z4_prob_75pc_tray_packing_w8wed_conc_list)
z4_prob_75pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_75pc_tray_packing_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_75pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_other_concs <- as.data.frame(z4_prob_75pc_other_w8wed_conc_list)
z4_prob_75pc_other_concs$area <- as.factor('other')
z4_prob_75pc_other_concs$scenario <- as.factor('PZ_01')
z4_prob_75pc_other_concs$water <- as.factor('Dry')
names(z4_prob_75pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_75pc_w8wed_concs <- rbind(z4_prob_75pc_loading_concs,z4_prob_75pc_cleaning_concs,z4_prob_75pc_sorting_concs,z4_prob_75pc_tray_packing_concs,z4_prob_75pc_reject_concs,z4_prob_75pc_other_concs)

z4_prob_75pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_75pc$loading_w8wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_loading_prev$area <- as.factor('loading')
z4_prob_75pc_loading_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_75pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_75pc$cleaning_w8wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_75pc_cleaning_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_75pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_75pc$sorting_w8wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_sorting_prev$area <- as.factor('sorting')
z4_prob_75pc_sorting_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_75pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_75pc$reject_w8wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_reject_prev$area <- as.factor('reject')
z4_prob_75pc_reject_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_75pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_75pc$tray_packing_w8wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_75pc_tray_packing_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_75pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_other_prev <- as.data.frame(NL_table_Z4_Prob_75pc$other_w8wed_prev[order(NL_table_Z4_Prob_75pc$local_seed)])
z4_prob_75pc_other_prev$area <- as.factor('other')
z4_prob_75pc_other_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_other_prev$water <- as.factor('Dry')
names(z4_prob_75pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_75pc_w8wed_prev <- rbind(z4_prob_75pc_loading_prev,z4_prob_75pc_cleaning_prev,z4_prob_75pc_sorting_prev,z4_prob_75pc_tray_packing_prev,z4_prob_75pc_reject_prev,z4_prob_75pc_other_prev)

z4_prob_75pc_w8wed_wet_prev <- as.data.frame(z4_prob_75pc_loading_prev$prevalence*21/100+z4_prob_75pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_75pc_w8wed_wet_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_w8wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_75pc_w8wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_75pc_w8wed_dry_prev <- as.data.frame(z4_prob_75pc_sorting_prev$prevalence*20/100+z4_prob_75pc_reject_prev$prevalence*23/100+z4_prob_75pc_tray_packing_prev$prevalence*123/100+z4_prob_75pc_other_prev$prevalence*10/100)/176*100
z4_prob_75pc_w8wed_dry_prev$scenario <- as.factor('PZ_01')
z4_prob_75pc_w8wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_75pc_w8wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_75pc_w8wed_recombined_prev <- rbind(z4_prob_75pc_w8wed_wet_prev, z4_prob_75pc_w8wed_dry_prev)

vector <- NL_table_Z4_Prob_75pc$lifetime_conc_list[order(NL_table_Z4_Prob_75pc$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

z4_prob_75pc_w1wed_recombined_prev$week <- as.factor(1)
z4_prob_75pc_w2wed_recombined_prev$week <- as.factor(2)
z4_prob_75pc_w3wed_recombined_prev$week <- as.factor(3)
z4_prob_75pc_w4wed_recombined_prev$week <- as.factor(4)
z4_prob_75pc_w5wed_recombined_prev$week <- as.factor(5)
z4_prob_75pc_w6wed_recombined_prev$week <- as.factor(6)
z4_prob_75pc_w7wed_recombined_prev$week <- as.factor(7)
z4_prob_75pc_w8wed_recombined_prev$week <- as.factor(8)
z4_prob_75pc_allwed_prev <- rbind(z4_prob_75pc_w1wed_recombined_prev,z4_prob_75pc_w2wed_recombined_prev,z4_prob_75pc_w3wed_recombined_prev,z4_prob_75pc_w4wed_recombined_prev,z4_prob_75pc_w5wed_recombined_prev,z4_prob_75pc_w6wed_recombined_prev,z4_prob_75pc_w7wed_recombined_prev,z4_prob_75pc_w8wed_recombined_prev)

Facility_B_z4_prob_75pc_agents_melted <- melt(mdarray)
colnames(Facility_B_z4_prob_75pc_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_z4_prob_75pc_agents_melted$agent <- Facility_B_z4_prob_75pc_agents_melted$agent-1
Facility_B_z4_prob_75pc_agents_melted$logical <- Facility_B_z4_prob_75pc_agents_melted$value>0
Facility_B_z4_prob_75pc_agents_melted$binary <- as.numeric(Facility_B_z4_prob_75pc_agents_melted$logical)
Facility_B_z4_prob_75pc_agents_melted$log10value <- log10(Facility_B_z4_prob_75pc_agents_melted$value)
Facility_B_z4_prob_75pc_agents_melted$log10value[is.infinite(Facility_B_z4_prob_75pc_agents_melted$log10value)] <- 0

agent <- Facility_B_z4_prob_75pc_agents_melted$agent
iteration <- Facility_B_z4_prob_75pc_agents_melted$iteration
tick <- Facility_B_z4_prob_75pc_agents_melted$tick
rle_matrix <- tapply(Facility_B_z4_prob_75pc_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_z4_prob_75pc_agents_melted_mean_value_matrix <- tapply(Facility_B_z4_prob_75pc_agents_melted$value, list(agent, tick), mean)
Facility_B_z4_prob_75pc_agents_melted_median_value_matrix <- tapply(Facility_B_z4_prob_75pc_agents_melted$value, list(agent, tick), median)
Facility_B_z4_prob_75pc_agents_melted_prob_value_matrix <- tapply(Facility_B_z4_prob_75pc_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}
# durations$agent <- durations$agent-1

Facility_B_durations_z4_prob_75pc <- durations

agents_list_z4_prob_75pc <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_z4_prob_75pc <- agents_list_z4_prob_75pc[,c("V1","V7","V8","V9")]
colnames(agents_list_z4_prob_75pc) <- c("name","sanitation_status","schedule","area")
agents_list_z4_prob_75pc$ttp <- rep((168*2),225)
agents_list_z4_prob_75pc$ttp[agents_list_z4_prob_75pc$schedule=="daily"] <- (24*2)

agent <- 1
while(agent<=225) {
  agents_list_z4_prob_75pc$min_duration[agent] <- ifelse(length(Facility_B_durations_z4_prob_75pc$duration[Facility_B_durations_z4_prob_75pc$agent==agent])==0,NA,min(Facility_B_durations_z4_prob_75pc$duration[Facility_B_durations_z4_prob_75pc$agent==agent], na.rm = TRUE))
  agents_list_z4_prob_75pc$mean_duration[agent] <- ifelse(length(Facility_B_durations_z4_prob_75pc$duration[Facility_B_durations_z4_prob_75pc$agent==agent])==0,NA,mean(Facility_B_durations_z4_prob_75pc$duration[Facility_B_durations_z4_prob_75pc$agent==agent], na.rm = TRUE))
  agents_list_z4_prob_75pc$median_duration[agent] <- ifelse(length(Facility_B_durations_z4_prob_75pc$duration[Facility_B_durations_z4_prob_75pc$agent==agent])==0,NA,median(Facility_B_durations_z4_prob_75pc$duration[Facility_B_durations_z4_prob_75pc$agent==agent], na.rm = TRUE))
  agents_list_z4_prob_75pc$max_duration[agent] <- ifelse(length(Facility_B_durations_z4_prob_75pc$duration[Facility_B_durations_z4_prob_75pc$agent==agent])==0,NA,max(Facility_B_durations_z4_prob_75pc$duration[Facility_B_durations_z4_prob_75pc$agent==agent], na.rm = TRUE))
  agents_list_z4_prob_75pc$times_persistent[agent] <- sum(Facility_B_durations_z4_prob_75pc$duration[Facility_B_durations_z4_prob_75pc$agent==agent]>agents_list_z4_prob_75pc$ttp[agent])
  agent <- agent+1 
}

Facility_B_z4_prob_75pc_agents_melted_monday_preop <- Facility_B_z4_prob_75pc_agents_melted[which(Facility_B_z4_prob_75pc_agents_melted$tick==33|Facility_B_z4_prob_75pc_agents_melted$tick==201|Facility_B_z4_prob_75pc_agents_melted$tick==369|Facility_B_z4_prob_75pc_agents_melted$tick==537|Facility_B_z4_prob_75pc_agents_melted$tick==705|Facility_B_z4_prob_75pc_agents_melted$tick==873|Facility_B_z4_prob_75pc_agents_melted$tick==1041|Facility_B_z4_prob_75pc_agents_melted$tick==1209),]

Facility_B_z4_prob_75pc_agents_melted_tuesday_preop <- Facility_B_z4_prob_75pc_agents_melted[which(Facility_B_z4_prob_75pc_agents_melted$tick==57|Facility_B_z4_prob_75pc_agents_melted$tick==225|Facility_B_z4_prob_75pc_agents_melted$tick==393|Facility_B_z4_prob_75pc_agents_melted$tick==561|Facility_B_z4_prob_75pc_agents_melted$tick==729|Facility_B_z4_prob_75pc_agents_melted$tick==897|Facility_B_z4_prob_75pc_agents_melted$tick==1065|Facility_B_z4_prob_75pc_agents_melted$tick==1233),]

Facility_B_z4_prob_75pc_agents_melted_wednesday_preop <- Facility_B_z4_prob_75pc_agents_melted[which(Facility_B_z4_prob_75pc_agents_melted$tick==81|Facility_B_z4_prob_75pc_agents_melted$tick==249|Facility_B_z4_prob_75pc_agents_melted$tick==417|Facility_B_z4_prob_75pc_agents_melted$tick==585|Facility_B_z4_prob_75pc_agents_melted$tick==753|Facility_B_z4_prob_75pc_agents_melted$tick==921|Facility_B_z4_prob_75pc_agents_melted$tick==1089|Facility_B_z4_prob_75pc_agents_melted$tick==1257),]

Facility_B_z4_prob_75pc_agents_melted_thursday_preop <- Facility_B_z4_prob_75pc_agents_melted[which(Facility_B_z4_prob_75pc_agents_melted$tick==105|Facility_B_z4_prob_75pc_agents_melted$tick==273|Facility_B_z4_prob_75pc_agents_melted$tick==441|Facility_B_z4_prob_75pc_agents_melted$tick==609|Facility_B_z4_prob_75pc_agents_melted$tick==777|Facility_B_z4_prob_75pc_agents_melted$tick==945|Facility_B_z4_prob_75pc_agents_melted$tick==1113|Facility_B_z4_prob_75pc_agents_melted$tick==1281),]

Facility_B_z4_prob_75pc_agents_melted_friday_preop <- Facility_B_z4_prob_75pc_agents_melted[which(Facility_B_z4_prob_75pc_agents_melted$tick==129|Facility_B_z4_prob_75pc_agents_melted$tick==297|Facility_B_z4_prob_75pc_agents_melted$tick==465|Facility_B_z4_prob_75pc_agents_melted$tick==633|Facility_B_z4_prob_75pc_agents_melted$tick==801|Facility_B_z4_prob_75pc_agents_melted$tick==969|Facility_B_z4_prob_75pc_agents_melted$tick==1137|Facility_B_z4_prob_75pc_agents_melted$tick==1305),]

Facility_B_z4_prob_75pc_agents_melted_ff <- as.ffdf(Facility_B_z4_prob_75pc_agents_melted)
rm(Facility_B_z4_prob_75pc_agents_melted)
gc()
```

```{r import P Z4 Reduction 50%}
NL_table_Z4_Prob_50pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-28-00-01 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_P_Z4_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Z4_Prob_50pc <- NL_table_Z4_Prob_50pc[NL_table_Z4_Prob_50pc$scenario==36,]

while (any(grepl('-', names(NL_table_Z4_Prob_50pc), fixed = TRUE))) {
  NL_table_Z4_Prob_50pc <- NL_table_Z4_Prob_50pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Z4_Prob_50pc), fixed = TRUE))) {
  NL_table_Z4_Prob_50pc <- NL_table_Z4_Prob_50pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Z4_Prob_50pc), fixed = TRUE))) {
  NL_table_Z4_Prob_50pc <- NL_table_Z4_Prob_50pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Z4_Prob_50pc), fixed = TRUE))) {
  NL_table_Z4_Prob_50pc <- NL_table_Z4_Prob_50pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Z4_Prob_50pc[ , ..list_columns]

NL_table_Z4_Prob_50pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Z4_Prob_50pc <- as.data.frame(NL_table_Z4_Prob_50pc)

NL_table_Z4_Prob_50pc[NL_table_Z4_Prob_50pc==-1] <- NA

NL_table_Z4_Prob_50pc <- subset(NL_table_Z4_Prob_50pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Z4_Prob_50pc)[names(NL_table_Z4_Prob_50pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Z4_Prob_50pc)[names(NL_table_Z4_Prob_50pc)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Z4_Prob_50pc$loading_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_loading_w1wed_conc_list <- append(z4_prob_50pc_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_loading_w1wed_conc_matrix <- matrix(unlist(z4_prob_50pc_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_cleaning_w1wed_conc_list <- append(z4_prob_50pc_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_cleaning_w1wed_conc_matrix <- matrix(unlist(z4_prob_50pc_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_50pc$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_50pc_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_50pc_drying_w1wed_conc_list <- append(z4_prob_50pc_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_50pc$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_sorting_w1wed_conc_list <- append(z4_prob_50pc_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_sorting_w1wed_conc_matrix <- matrix(unlist(z4_prob_50pc_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_tray_packing_w1wed_conc_list <- append(z4_prob_50pc_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_tray_packing_w1wed_conc_matrix <- matrix(unlist(z4_prob_50pc_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$reject_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_reject_w1wed_conc_list <- append(z4_prob_50pc_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_reject_w1wed_conc_matrix <- matrix(unlist(z4_prob_50pc_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$other_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_other_w1wed_conc_list <- append(z4_prob_50pc_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_other_w1wed_conc_matrix <- matrix(unlist(z4_prob_50pc_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_50pc_loading_concs <- as.data.frame(z4_prob_50pc_loading_w1wed_conc_list)
z4_prob_50pc_loading_concs$area <- as.factor('loading')
z4_prob_50pc_loading_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_50pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_cleaning_concs <- as.data.frame(z4_prob_50pc_cleaning_w1wed_conc_list)
z4_prob_50pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_50pc_cleaning_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_50pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_sorting_concs <- as.data.frame(z4_prob_50pc_sorting_w1wed_conc_list)
z4_prob_50pc_sorting_concs$area <- as.factor('sorting')
z4_prob_50pc_sorting_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_50pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_reject_concs <- as.data.frame(z4_prob_50pc_reject_w1wed_conc_list)
z4_prob_50pc_reject_concs$area <- as.factor('reject')
z4_prob_50pc_reject_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_50pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_tray_packing_concs <- as.data.frame(z4_prob_50pc_tray_packing_w1wed_conc_list)
z4_prob_50pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_50pc_tray_packing_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_50pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_other_concs <- as.data.frame(z4_prob_50pc_other_w1wed_conc_list)
z4_prob_50pc_other_concs$area <- as.factor('other')
z4_prob_50pc_other_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_other_concs$water <- as.factor('Dry')
names(z4_prob_50pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_w1wed_concs <- rbind(z4_prob_50pc_loading_concs,z4_prob_50pc_cleaning_concs,z4_prob_50pc_sorting_concs,z4_prob_50pc_tray_packing_concs,z4_prob_50pc_reject_concs,z4_prob_50pc_other_concs)

z4_prob_50pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_50pc$loading_w1wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_loading_prev$area <- as.factor('loading')
z4_prob_50pc_loading_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_50pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_50pc$cleaning_w1wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_50pc_cleaning_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_50pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_50pc$sorting_w1wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_sorting_prev$area <- as.factor('sorting')
z4_prob_50pc_sorting_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_50pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_50pc$reject_w1wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_reject_prev$area <- as.factor('reject')
z4_prob_50pc_reject_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_50pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_50pc$tray_packing_w1wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_50pc_tray_packing_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_50pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_other_prev <- as.data.frame(NL_table_Z4_Prob_50pc$other_w1wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_other_prev$area <- as.factor('other')
z4_prob_50pc_other_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_other_prev$water <- as.factor('Dry')
names(z4_prob_50pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_w1wed_prev <- rbind(z4_prob_50pc_loading_prev,z4_prob_50pc_cleaning_prev,z4_prob_50pc_sorting_prev,z4_prob_50pc_tray_packing_prev,z4_prob_50pc_reject_prev,z4_prob_50pc_other_prev)

z4_prob_50pc_w1wed_wet_prev <- as.data.frame(z4_prob_50pc_loading_prev$prevalence*21/100+z4_prob_50pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_50pc_w1wed_wet_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_w1wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_50pc_w1wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_50pc_w1wed_dry_prev <- as.data.frame(z4_prob_50pc_sorting_prev$prevalence*20/100+z4_prob_50pc_reject_prev$prevalence*23/100+z4_prob_50pc_tray_packing_prev$prevalence*123/100+z4_prob_50pc_other_prev$prevalence*10/100)/176*100
z4_prob_50pc_w1wed_dry_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_w1wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_50pc_w1wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_50pc_w1wed_recombined_prev <- rbind(z4_prob_50pc_w1wed_wet_prev, z4_prob_50pc_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Z4_Prob_50pc$loading_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_loading_w2wed_conc_list <- append(z4_prob_50pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_loading_w2wed_conc_matrix <- matrix(unlist(z4_prob_50pc_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_cleaning_w2wed_conc_list <- append(z4_prob_50pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_cleaning_w2wed_conc_matrix <- matrix(unlist(z4_prob_50pc_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_50pc$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_50pc_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_50pc_drying_w2wed_conc_list <- append(z4_prob_50pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_50pc$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_sorting_w2wed_conc_list <- append(z4_prob_50pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_sorting_w2wed_conc_matrix <- matrix(unlist(z4_prob_50pc_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_tray_packing_w2wed_conc_list <- append(z4_prob_50pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_tray_packing_w2wed_conc_matrix <- matrix(unlist(z4_prob_50pc_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$reject_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_reject_w2wed_conc_list <- append(z4_prob_50pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_reject_w2wed_conc_matrix <- matrix(unlist(z4_prob_50pc_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$other_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_other_w2wed_conc_list <- append(z4_prob_50pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_other_w2wed_conc_matrix <- matrix(unlist(z4_prob_50pc_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_50pc_loading_concs <- as.data.frame(z4_prob_50pc_loading_w2wed_conc_list)
z4_prob_50pc_loading_concs$area <- as.factor('loading')
z4_prob_50pc_loading_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_50pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_cleaning_concs <- as.data.frame(z4_prob_50pc_cleaning_w2wed_conc_list)
z4_prob_50pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_50pc_cleaning_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_50pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_sorting_concs <- as.data.frame(z4_prob_50pc_sorting_w2wed_conc_list)
z4_prob_50pc_sorting_concs$area <- as.factor('sorting')
z4_prob_50pc_sorting_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_50pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_reject_concs <- as.data.frame(z4_prob_50pc_reject_w2wed_conc_list)
z4_prob_50pc_reject_concs$area <- as.factor('reject')
z4_prob_50pc_reject_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_50pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_tray_packing_concs <- as.data.frame(z4_prob_50pc_tray_packing_w2wed_conc_list)
z4_prob_50pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_50pc_tray_packing_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_50pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_other_concs <- as.data.frame(z4_prob_50pc_other_w2wed_conc_list)
z4_prob_50pc_other_concs$area <- as.factor('other')
z4_prob_50pc_other_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_other_concs$water <- as.factor('Dry')
names(z4_prob_50pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_w2wed_concs <- rbind(z4_prob_50pc_loading_concs,z4_prob_50pc_cleaning_concs,z4_prob_50pc_sorting_concs,z4_prob_50pc_tray_packing_concs,z4_prob_50pc_reject_concs,z4_prob_50pc_other_concs)

z4_prob_50pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_50pc$loading_w2wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_loading_prev$area <- as.factor('loading')
z4_prob_50pc_loading_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_50pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_50pc$cleaning_w2wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_50pc_cleaning_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_50pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_50pc$sorting_w2wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_sorting_prev$area <- as.factor('sorting')
z4_prob_50pc_sorting_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_50pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_50pc$reject_w2wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_reject_prev$area <- as.factor('reject')
z4_prob_50pc_reject_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_50pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_50pc$tray_packing_w2wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_50pc_tray_packing_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_50pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_other_prev <- as.data.frame(NL_table_Z4_Prob_50pc$other_w2wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_other_prev$area <- as.factor('other')
z4_prob_50pc_other_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_other_prev$water <- as.factor('Dry')
names(z4_prob_50pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_w2wed_prev <- rbind(z4_prob_50pc_loading_prev,z4_prob_50pc_cleaning_prev,z4_prob_50pc_sorting_prev,z4_prob_50pc_tray_packing_prev,z4_prob_50pc_reject_prev,z4_prob_50pc_other_prev)

z4_prob_50pc_w2wed_wet_prev <- as.data.frame(z4_prob_50pc_loading_prev$prevalence*21/100+z4_prob_50pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_50pc_w2wed_wet_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_w2wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_50pc_w2wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_50pc_w2wed_dry_prev <- as.data.frame(z4_prob_50pc_sorting_prev$prevalence*20/100+z4_prob_50pc_reject_prev$prevalence*23/100+z4_prob_50pc_tray_packing_prev$prevalence*123/100+z4_prob_50pc_other_prev$prevalence*10/100)/176*100
z4_prob_50pc_w2wed_dry_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_w2wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_50pc_w2wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_50pc_w2wed_recombined_prev <- rbind(z4_prob_50pc_w2wed_wet_prev, z4_prob_50pc_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Z4_Prob_50pc$loading_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_loading_w3wed_conc_list <- append(z4_prob_50pc_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_loading_w3wed_conc_matrix <- matrix(unlist(z4_prob_50pc_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_cleaning_w3wed_conc_list <- append(z4_prob_50pc_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_cleaning_w3wed_conc_matrix <- matrix(unlist(z4_prob_50pc_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_50pc$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_50pc_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_50pc_drying_w3wed_conc_list <- append(z4_prob_50pc_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_50pc$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_sorting_w3wed_conc_list <- append(z4_prob_50pc_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_sorting_w3wed_conc_matrix <- matrix(unlist(z4_prob_50pc_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_tray_packing_w3wed_conc_list <- append(z4_prob_50pc_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_tray_packing_w3wed_conc_matrix <- matrix(unlist(z4_prob_50pc_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$reject_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_reject_w3wed_conc_list <- append(z4_prob_50pc_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_reject_w3wed_conc_matrix <- matrix(unlist(z4_prob_50pc_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$other_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_other_w3wed_conc_list <- append(z4_prob_50pc_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_other_w3wed_conc_matrix <- matrix(unlist(z4_prob_50pc_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_50pc_loading_concs <- as.data.frame(z4_prob_50pc_loading_w3wed_conc_list)
z4_prob_50pc_loading_concs$area <- as.factor('loading')
z4_prob_50pc_loading_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_50pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_cleaning_concs <- as.data.frame(z4_prob_50pc_cleaning_w3wed_conc_list)
z4_prob_50pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_50pc_cleaning_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_50pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_sorting_concs <- as.data.frame(z4_prob_50pc_sorting_w3wed_conc_list)
z4_prob_50pc_sorting_concs$area <- as.factor('sorting')
z4_prob_50pc_sorting_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_50pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_reject_concs <- as.data.frame(z4_prob_50pc_reject_w3wed_conc_list)
z4_prob_50pc_reject_concs$area <- as.factor('reject')
z4_prob_50pc_reject_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_50pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_tray_packing_concs <- as.data.frame(z4_prob_50pc_tray_packing_w3wed_conc_list)
z4_prob_50pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_50pc_tray_packing_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_50pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_other_concs <- as.data.frame(z4_prob_50pc_other_w3wed_conc_list)
z4_prob_50pc_other_concs$area <- as.factor('other')
z4_prob_50pc_other_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_other_concs$water <- as.factor('Dry')
names(z4_prob_50pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_w3wed_concs <- rbind(z4_prob_50pc_loading_concs,z4_prob_50pc_cleaning_concs,z4_prob_50pc_sorting_concs,z4_prob_50pc_tray_packing_concs,z4_prob_50pc_reject_concs,z4_prob_50pc_other_concs)

z4_prob_50pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_50pc$loading_w3wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_loading_prev$area <- as.factor('loading')
z4_prob_50pc_loading_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_50pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_50pc$cleaning_w3wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_50pc_cleaning_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_50pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_50pc$sorting_w3wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_sorting_prev$area <- as.factor('sorting')
z4_prob_50pc_sorting_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_50pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_50pc$reject_w3wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_reject_prev$area <- as.factor('reject')
z4_prob_50pc_reject_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_50pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_50pc$tray_packing_w3wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_50pc_tray_packing_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_50pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_other_prev <- as.data.frame(NL_table_Z4_Prob_50pc$other_w3wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_other_prev$area <- as.factor('other')
z4_prob_50pc_other_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_other_prev$water <- as.factor('Dry')
names(z4_prob_50pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_w3wed_prev <- rbind(z4_prob_50pc_loading_prev,z4_prob_50pc_cleaning_prev,z4_prob_50pc_sorting_prev,z4_prob_50pc_tray_packing_prev,z4_prob_50pc_reject_prev,z4_prob_50pc_other_prev)

z4_prob_50pc_w3wed_wet_prev <- as.data.frame(z4_prob_50pc_loading_prev$prevalence*21/100+z4_prob_50pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_50pc_w3wed_wet_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_w3wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_50pc_w3wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_50pc_w3wed_dry_prev <- as.data.frame(z4_prob_50pc_sorting_prev$prevalence*20/100+z4_prob_50pc_reject_prev$prevalence*23/100+z4_prob_50pc_tray_packing_prev$prevalence*123/100+z4_prob_50pc_other_prev$prevalence*10/100)/176*100
z4_prob_50pc_w3wed_dry_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_w3wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_50pc_w3wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_50pc_w3wed_recombined_prev <- rbind(z4_prob_50pc_w3wed_wet_prev, z4_prob_50pc_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Z4_Prob_50pc$loading_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_loading_w4wed_conc_list <- append(z4_prob_50pc_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_loading_w4wed_conc_matrix <- matrix(unlist(z4_prob_50pc_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_cleaning_w4wed_conc_list <- append(z4_prob_50pc_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_cleaning_w4wed_conc_matrix <- matrix(unlist(z4_prob_50pc_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_50pc$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_50pc_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_50pc_drying_w4wed_conc_list <- append(z4_prob_50pc_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_50pc$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_sorting_w4wed_conc_list <- append(z4_prob_50pc_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_sorting_w4wed_conc_matrix <- matrix(unlist(z4_prob_50pc_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_tray_packing_w4wed_conc_list <- append(z4_prob_50pc_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_tray_packing_w4wed_conc_matrix <- matrix(unlist(z4_prob_50pc_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$reject_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_reject_w4wed_conc_list <- append(z4_prob_50pc_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_reject_w4wed_conc_matrix <- matrix(unlist(z4_prob_50pc_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$other_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_other_w4wed_conc_list <- append(z4_prob_50pc_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_other_w4wed_conc_matrix <- matrix(unlist(z4_prob_50pc_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_50pc_loading_concs <- as.data.frame(z4_prob_50pc_loading_w4wed_conc_list)
z4_prob_50pc_loading_concs$area <- as.factor('loading')
z4_prob_50pc_loading_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_50pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_cleaning_concs <- as.data.frame(z4_prob_50pc_cleaning_w4wed_conc_list)
z4_prob_50pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_50pc_cleaning_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_50pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_sorting_concs <- as.data.frame(z4_prob_50pc_sorting_w4wed_conc_list)
z4_prob_50pc_sorting_concs$area <- as.factor('sorting')
z4_prob_50pc_sorting_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_50pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_reject_concs <- as.data.frame(z4_prob_50pc_reject_w4wed_conc_list)
z4_prob_50pc_reject_concs$area <- as.factor('reject')
z4_prob_50pc_reject_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_50pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_tray_packing_concs <- as.data.frame(z4_prob_50pc_tray_packing_w4wed_conc_list)
z4_prob_50pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_50pc_tray_packing_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_50pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_other_concs <- as.data.frame(z4_prob_50pc_other_w4wed_conc_list)
z4_prob_50pc_other_concs$area <- as.factor('other')
z4_prob_50pc_other_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_other_concs$water <- as.factor('Dry')
names(z4_prob_50pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_w4wed_concs <- rbind(z4_prob_50pc_loading_concs,z4_prob_50pc_cleaning_concs,z4_prob_50pc_sorting_concs,z4_prob_50pc_tray_packing_concs,z4_prob_50pc_reject_concs,z4_prob_50pc_other_concs)

z4_prob_50pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_50pc$loading_w4wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_loading_prev$area <- as.factor('loading')
z4_prob_50pc_loading_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_50pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_50pc$cleaning_w4wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_50pc_cleaning_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_50pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_50pc$sorting_w4wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_sorting_prev$area <- as.factor('sorting')
z4_prob_50pc_sorting_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_50pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_50pc$reject_w4wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_reject_prev$area <- as.factor('reject')
z4_prob_50pc_reject_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_50pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_50pc$tray_packing_w4wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_50pc_tray_packing_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_50pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_other_prev <- as.data.frame(NL_table_Z4_Prob_50pc$other_w4wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_other_prev$area <- as.factor('other')
z4_prob_50pc_other_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_other_prev$water <- as.factor('Dry')
names(z4_prob_50pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_w4wed_prev <- rbind(z4_prob_50pc_loading_prev,z4_prob_50pc_cleaning_prev,z4_prob_50pc_sorting_prev,z4_prob_50pc_tray_packing_prev,z4_prob_50pc_reject_prev,z4_prob_50pc_other_prev)

z4_prob_50pc_w4wed_wet_prev <- as.data.frame(z4_prob_50pc_loading_prev$prevalence*21/100+z4_prob_50pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_50pc_w4wed_wet_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_w4wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_50pc_w4wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_50pc_w4wed_dry_prev <- as.data.frame(z4_prob_50pc_sorting_prev$prevalence*20/100+z4_prob_50pc_reject_prev$prevalence*23/100+z4_prob_50pc_tray_packing_prev$prevalence*123/100+z4_prob_50pc_other_prev$prevalence*10/100)/176*100
z4_prob_50pc_w4wed_dry_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_w4wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_50pc_w4wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_50pc_w4wed_recombined_prev <- rbind(z4_prob_50pc_w4wed_wet_prev, z4_prob_50pc_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Z4_Prob_50pc$loading_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_loading_w5wed_conc_list <- append(z4_prob_50pc_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_loading_w5wed_conc_matrix <- matrix(unlist(z4_prob_50pc_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_cleaning_w5wed_conc_list <- append(z4_prob_50pc_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_cleaning_w5wed_conc_matrix <- matrix(unlist(z4_prob_50pc_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_50pc$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_50pc_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_50pc_drying_w5wed_conc_list <- append(z4_prob_50pc_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_50pc$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_sorting_w5wed_conc_list <- append(z4_prob_50pc_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_sorting_w5wed_conc_matrix <- matrix(unlist(z4_prob_50pc_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_tray_packing_w5wed_conc_list <- append(z4_prob_50pc_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_tray_packing_w5wed_conc_matrix <- matrix(unlist(z4_prob_50pc_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$reject_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_reject_w5wed_conc_list <- append(z4_prob_50pc_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_reject_w5wed_conc_matrix <- matrix(unlist(z4_prob_50pc_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$other_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_other_w5wed_conc_list <- append(z4_prob_50pc_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_other_w5wed_conc_matrix <- matrix(unlist(z4_prob_50pc_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_50pc_loading_concs <- as.data.frame(z4_prob_50pc_loading_w5wed_conc_list)
z4_prob_50pc_loading_concs$area <- as.factor('loading')
z4_prob_50pc_loading_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_50pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_cleaning_concs <- as.data.frame(z4_prob_50pc_cleaning_w5wed_conc_list)
z4_prob_50pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_50pc_cleaning_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_50pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_sorting_concs <- as.data.frame(z4_prob_50pc_sorting_w5wed_conc_list)
z4_prob_50pc_sorting_concs$area <- as.factor('sorting')
z4_prob_50pc_sorting_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_50pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_reject_concs <- as.data.frame(z4_prob_50pc_reject_w5wed_conc_list)
z4_prob_50pc_reject_concs$area <- as.factor('reject')
z4_prob_50pc_reject_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_50pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_tray_packing_concs <- as.data.frame(z4_prob_50pc_tray_packing_w5wed_conc_list)
z4_prob_50pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_50pc_tray_packing_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_50pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_other_concs <- as.data.frame(z4_prob_50pc_other_w5wed_conc_list)
z4_prob_50pc_other_concs$area <- as.factor('other')
z4_prob_50pc_other_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_other_concs$water <- as.factor('Dry')
names(z4_prob_50pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_w5wed_concs <- rbind(z4_prob_50pc_loading_concs,z4_prob_50pc_cleaning_concs,z4_prob_50pc_sorting_concs,z4_prob_50pc_tray_packing_concs,z4_prob_50pc_reject_concs,z4_prob_50pc_other_concs)

z4_prob_50pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_50pc$loading_w5wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_loading_prev$area <- as.factor('loading')
z4_prob_50pc_loading_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_50pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_50pc$cleaning_w5wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_50pc_cleaning_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_50pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_50pc$sorting_w5wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_sorting_prev$area <- as.factor('sorting')
z4_prob_50pc_sorting_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_50pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_50pc$reject_w5wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_reject_prev$area <- as.factor('reject')
z4_prob_50pc_reject_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_50pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_50pc$tray_packing_w5wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_50pc_tray_packing_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_50pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_other_prev <- as.data.frame(NL_table_Z4_Prob_50pc$other_w5wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_other_prev$area <- as.factor('other')
z4_prob_50pc_other_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_other_prev$water <- as.factor('Dry')
names(z4_prob_50pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_w5wed_prev <- rbind(z4_prob_50pc_loading_prev,z4_prob_50pc_cleaning_prev,z4_prob_50pc_sorting_prev,z4_prob_50pc_tray_packing_prev,z4_prob_50pc_reject_prev,z4_prob_50pc_other_prev)

z4_prob_50pc_w5wed_wet_prev <- as.data.frame(z4_prob_50pc_loading_prev$prevalence*21/100+z4_prob_50pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_50pc_w5wed_wet_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_w5wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_50pc_w5wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_50pc_w5wed_dry_prev <- as.data.frame(z4_prob_50pc_sorting_prev$prevalence*20/100+z4_prob_50pc_reject_prev$prevalence*23/100+z4_prob_50pc_tray_packing_prev$prevalence*123/100+z4_prob_50pc_other_prev$prevalence*10/100)/176*100
z4_prob_50pc_w5wed_dry_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_w5wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_50pc_w5wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_50pc_w5wed_recombined_prev <- rbind(z4_prob_50pc_w5wed_wet_prev, z4_prob_50pc_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Z4_Prob_50pc$loading_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_loading_w6wed_conc_list <- append(z4_prob_50pc_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_loading_w6wed_conc_matrix <- matrix(unlist(z4_prob_50pc_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_cleaning_w6wed_conc_list <- append(z4_prob_50pc_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_cleaning_w6wed_conc_matrix <- matrix(unlist(z4_prob_50pc_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_50pc$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_50pc_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_50pc_drying_w6wed_conc_list <- append(z4_prob_50pc_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_50pc$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_sorting_w6wed_conc_list <- append(z4_prob_50pc_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_sorting_w6wed_conc_matrix <- matrix(unlist(z4_prob_50pc_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_tray_packing_w6wed_conc_list <- append(z4_prob_50pc_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_tray_packing_w6wed_conc_matrix <- matrix(unlist(z4_prob_50pc_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$reject_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_reject_w6wed_conc_list <- append(z4_prob_50pc_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_reject_w6wed_conc_matrix <- matrix(unlist(z4_prob_50pc_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$other_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_other_w6wed_conc_list <- append(z4_prob_50pc_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_other_w6wed_conc_matrix <- matrix(unlist(z4_prob_50pc_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_50pc_loading_concs <- as.data.frame(z4_prob_50pc_loading_w6wed_conc_list)
z4_prob_50pc_loading_concs$area <- as.factor('loading')
z4_prob_50pc_loading_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_50pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_cleaning_concs <- as.data.frame(z4_prob_50pc_cleaning_w6wed_conc_list)
z4_prob_50pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_50pc_cleaning_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_50pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_sorting_concs <- as.data.frame(z4_prob_50pc_sorting_w6wed_conc_list)
z4_prob_50pc_sorting_concs$area <- as.factor('sorting')
z4_prob_50pc_sorting_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_50pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_reject_concs <- as.data.frame(z4_prob_50pc_reject_w6wed_conc_list)
z4_prob_50pc_reject_concs$area <- as.factor('reject')
z4_prob_50pc_reject_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_50pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_tray_packing_concs <- as.data.frame(z4_prob_50pc_tray_packing_w6wed_conc_list)
z4_prob_50pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_50pc_tray_packing_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_50pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_other_concs <- as.data.frame(z4_prob_50pc_other_w6wed_conc_list)
z4_prob_50pc_other_concs$area <- as.factor('other')
z4_prob_50pc_other_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_other_concs$water <- as.factor('Dry')
names(z4_prob_50pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_w6wed_concs <- rbind(z4_prob_50pc_loading_concs,z4_prob_50pc_cleaning_concs,z4_prob_50pc_sorting_concs,z4_prob_50pc_tray_packing_concs,z4_prob_50pc_reject_concs,z4_prob_50pc_other_concs)

z4_prob_50pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_50pc$loading_w6wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_loading_prev$area <- as.factor('loading')
z4_prob_50pc_loading_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_50pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_50pc$cleaning_w6wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_50pc_cleaning_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_50pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_50pc$sorting_w6wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_sorting_prev$area <- as.factor('sorting')
z4_prob_50pc_sorting_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_50pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_50pc$reject_w6wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_reject_prev$area <- as.factor('reject')
z4_prob_50pc_reject_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_50pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_50pc$tray_packing_w6wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_50pc_tray_packing_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_50pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_other_prev <- as.data.frame(NL_table_Z4_Prob_50pc$other_w6wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_other_prev$area <- as.factor('other')
z4_prob_50pc_other_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_other_prev$water <- as.factor('Dry')
names(z4_prob_50pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_w6wed_prev <- rbind(z4_prob_50pc_loading_prev,z4_prob_50pc_cleaning_prev,z4_prob_50pc_sorting_prev,z4_prob_50pc_tray_packing_prev,z4_prob_50pc_reject_prev,z4_prob_50pc_other_prev)

z4_prob_50pc_w6wed_wet_prev <- as.data.frame(z4_prob_50pc_loading_prev$prevalence*21/100+z4_prob_50pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_50pc_w6wed_wet_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_w6wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_50pc_w6wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_50pc_w6wed_dry_prev <- as.data.frame(z4_prob_50pc_sorting_prev$prevalence*20/100+z4_prob_50pc_reject_prev$prevalence*23/100+z4_prob_50pc_tray_packing_prev$prevalence*123/100+z4_prob_50pc_other_prev$prevalence*10/100)/176*100
z4_prob_50pc_w6wed_dry_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_w6wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_50pc_w6wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_50pc_w6wed_recombined_prev <- rbind(z4_prob_50pc_w6wed_wet_prev, z4_prob_50pc_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Z4_Prob_50pc$loading_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_loading_w7wed_conc_list <- append(z4_prob_50pc_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_loading_w7wed_conc_matrix <- matrix(unlist(z4_prob_50pc_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_cleaning_w7wed_conc_list <- append(z4_prob_50pc_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_cleaning_w7wed_conc_matrix <- matrix(unlist(z4_prob_50pc_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_50pc$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_50pc_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_50pc_drying_w7wed_conc_list <- append(z4_prob_50pc_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_50pc$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_sorting_w7wed_conc_list <- append(z4_prob_50pc_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_sorting_w7wed_conc_matrix <- matrix(unlist(z4_prob_50pc_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_tray_packing_w7wed_conc_list <- append(z4_prob_50pc_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_tray_packing_w7wed_conc_matrix <- matrix(unlist(z4_prob_50pc_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$reject_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_reject_w7wed_conc_list <- append(z4_prob_50pc_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_reject_w7wed_conc_matrix <- matrix(unlist(z4_prob_50pc_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$other_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_other_w7wed_conc_list <- append(z4_prob_50pc_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_other_w7wed_conc_matrix <- matrix(unlist(z4_prob_50pc_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_50pc_loading_concs <- as.data.frame(z4_prob_50pc_loading_w7wed_conc_list)
z4_prob_50pc_loading_concs$area <- as.factor('loading')
z4_prob_50pc_loading_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_50pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_cleaning_concs <- as.data.frame(z4_prob_50pc_cleaning_w7wed_conc_list)
z4_prob_50pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_50pc_cleaning_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_50pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_sorting_concs <- as.data.frame(z4_prob_50pc_sorting_w7wed_conc_list)
z4_prob_50pc_sorting_concs$area <- as.factor('sorting')
z4_prob_50pc_sorting_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_50pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_reject_concs <- as.data.frame(z4_prob_50pc_reject_w7wed_conc_list)
z4_prob_50pc_reject_concs$area <- as.factor('reject')
z4_prob_50pc_reject_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_50pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_tray_packing_concs <- as.data.frame(z4_prob_50pc_tray_packing_w7wed_conc_list)
z4_prob_50pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_50pc_tray_packing_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_50pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_other_concs <- as.data.frame(z4_prob_50pc_other_w7wed_conc_list)
z4_prob_50pc_other_concs$area <- as.factor('other')
z4_prob_50pc_other_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_other_concs$water <- as.factor('Dry')
names(z4_prob_50pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_w7wed_concs <- rbind(z4_prob_50pc_loading_concs,z4_prob_50pc_cleaning_concs,z4_prob_50pc_sorting_concs,z4_prob_50pc_tray_packing_concs,z4_prob_50pc_reject_concs,z4_prob_50pc_other_concs)

z4_prob_50pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_50pc$loading_w7wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_loading_prev$area <- as.factor('loading')
z4_prob_50pc_loading_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_50pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_50pc$cleaning_w7wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_50pc_cleaning_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_50pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_50pc$sorting_w7wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_sorting_prev$area <- as.factor('sorting')
z4_prob_50pc_sorting_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_50pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_50pc$reject_w7wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_reject_prev$area <- as.factor('reject')
z4_prob_50pc_reject_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_50pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_50pc$tray_packing_w7wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_50pc_tray_packing_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_50pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_other_prev <- as.data.frame(NL_table_Z4_Prob_50pc$other_w7wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_other_prev$area <- as.factor('other')
z4_prob_50pc_other_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_other_prev$water <- as.factor('Dry')
names(z4_prob_50pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_w7wed_prev <- rbind(z4_prob_50pc_loading_prev,z4_prob_50pc_cleaning_prev,z4_prob_50pc_sorting_prev,z4_prob_50pc_tray_packing_prev,z4_prob_50pc_reject_prev,z4_prob_50pc_other_prev)

z4_prob_50pc_w7wed_wet_prev <- as.data.frame(z4_prob_50pc_loading_prev$prevalence*21/100+z4_prob_50pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_50pc_w7wed_wet_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_w7wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_50pc_w7wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_50pc_w7wed_dry_prev <- as.data.frame(z4_prob_50pc_sorting_prev$prevalence*20/100+z4_prob_50pc_reject_prev$prevalence*23/100+z4_prob_50pc_tray_packing_prev$prevalence*123/100+z4_prob_50pc_other_prev$prevalence*10/100)/176*100
z4_prob_50pc_w7wed_dry_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_w7wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_50pc_w7wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_50pc_w7wed_recombined_prev <- rbind(z4_prob_50pc_w7wed_wet_prev, z4_prob_50pc_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Z4_Prob_50pc$loading_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_loading_w8wed_conc_list <- append(z4_prob_50pc_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_loading_w8wed_conc_matrix <- matrix(unlist(z4_prob_50pc_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_cleaning_w8wed_conc_list <- append(z4_prob_50pc_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_cleaning_w8wed_conc_matrix <- matrix(unlist(z4_prob_50pc_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_50pc$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_50pc_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_50pc_drying_w8wed_conc_list <- append(z4_prob_50pc_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_50pc$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_sorting_w8wed_conc_list <- append(z4_prob_50pc_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_sorting_w8wed_conc_matrix <- matrix(unlist(z4_prob_50pc_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_tray_packing_w8wed_conc_list <- append(z4_prob_50pc_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_tray_packing_w8wed_conc_matrix <- matrix(unlist(z4_prob_50pc_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$reject_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_reject_w8wed_conc_list <- append(z4_prob_50pc_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_reject_w8wed_conc_matrix <- matrix(unlist(z4_prob_50pc_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_50pc$other_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_50pc_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_50pc_other_w8wed_conc_list <- append(z4_prob_50pc_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_50pc_other_w8wed_conc_matrix <- matrix(unlist(z4_prob_50pc_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_50pc_loading_concs <- as.data.frame(z4_prob_50pc_loading_w8wed_conc_list)
z4_prob_50pc_loading_concs$area <- as.factor('loading')
z4_prob_50pc_loading_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_50pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_cleaning_concs <- as.data.frame(z4_prob_50pc_cleaning_w8wed_conc_list)
z4_prob_50pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_50pc_cleaning_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_50pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_sorting_concs <- as.data.frame(z4_prob_50pc_sorting_w8wed_conc_list)
z4_prob_50pc_sorting_concs$area <- as.factor('sorting')
z4_prob_50pc_sorting_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_50pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_reject_concs <- as.data.frame(z4_prob_50pc_reject_w8wed_conc_list)
z4_prob_50pc_reject_concs$area <- as.factor('reject')
z4_prob_50pc_reject_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_50pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_tray_packing_concs <- as.data.frame(z4_prob_50pc_tray_packing_w8wed_conc_list)
z4_prob_50pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_50pc_tray_packing_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_50pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_other_concs <- as.data.frame(z4_prob_50pc_other_w8wed_conc_list)
z4_prob_50pc_other_concs$area <- as.factor('other')
z4_prob_50pc_other_concs$scenario <- as.factor('PZ_02')
z4_prob_50pc_other_concs$water <- as.factor('Dry')
names(z4_prob_50pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_50pc_w8wed_concs <- rbind(z4_prob_50pc_loading_concs,z4_prob_50pc_cleaning_concs,z4_prob_50pc_sorting_concs,z4_prob_50pc_tray_packing_concs,z4_prob_50pc_reject_concs,z4_prob_50pc_other_concs)

z4_prob_50pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_50pc$loading_w8wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_loading_prev$area <- as.factor('loading')
z4_prob_50pc_loading_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_50pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_50pc$cleaning_w8wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_50pc_cleaning_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_50pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_50pc$sorting_w8wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_sorting_prev$area <- as.factor('sorting')
z4_prob_50pc_sorting_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_50pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_50pc$reject_w8wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_reject_prev$area <- as.factor('reject')
z4_prob_50pc_reject_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_50pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_50pc$tray_packing_w8wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_50pc_tray_packing_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_50pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_other_prev <- as.data.frame(NL_table_Z4_Prob_50pc$other_w8wed_prev[order(NL_table_Z4_Prob_50pc$local_seed)])
z4_prob_50pc_other_prev$area <- as.factor('other')
z4_prob_50pc_other_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_other_prev$water <- as.factor('Dry')
names(z4_prob_50pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_50pc_w8wed_prev <- rbind(z4_prob_50pc_loading_prev,z4_prob_50pc_cleaning_prev,z4_prob_50pc_sorting_prev,z4_prob_50pc_tray_packing_prev,z4_prob_50pc_reject_prev,z4_prob_50pc_other_prev)

z4_prob_50pc_w8wed_wet_prev <- as.data.frame(z4_prob_50pc_loading_prev$prevalence*21/100+z4_prob_50pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_50pc_w8wed_wet_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_w8wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_50pc_w8wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_50pc_w8wed_dry_prev <- as.data.frame(z4_prob_50pc_sorting_prev$prevalence*20/100+z4_prob_50pc_reject_prev$prevalence*23/100+z4_prob_50pc_tray_packing_prev$prevalence*123/100+z4_prob_50pc_other_prev$prevalence*10/100)/176*100
z4_prob_50pc_w8wed_dry_prev$scenario <- as.factor('PZ_02')
z4_prob_50pc_w8wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_50pc_w8wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_50pc_w8wed_recombined_prev <- rbind(z4_prob_50pc_w8wed_wet_prev, z4_prob_50pc_w8wed_dry_prev)

vector <- NL_table_Z4_Prob_50pc$lifetime_conc_list[order(NL_table_Z4_Prob_50pc$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

z4_prob_50pc_w1wed_recombined_prev$week <- as.factor(1)
z4_prob_50pc_w2wed_recombined_prev$week <- as.factor(2)
z4_prob_50pc_w3wed_recombined_prev$week <- as.factor(3)
z4_prob_50pc_w4wed_recombined_prev$week <- as.factor(4)
z4_prob_50pc_w5wed_recombined_prev$week <- as.factor(5)
z4_prob_50pc_w6wed_recombined_prev$week <- as.factor(6)
z4_prob_50pc_w7wed_recombined_prev$week <- as.factor(7)
z4_prob_50pc_w8wed_recombined_prev$week <- as.factor(8)
z4_prob_50pc_allwed_prev <- rbind(z4_prob_50pc_w1wed_recombined_prev,z4_prob_50pc_w2wed_recombined_prev,z4_prob_50pc_w3wed_recombined_prev,z4_prob_50pc_w4wed_recombined_prev,z4_prob_50pc_w5wed_recombined_prev,z4_prob_50pc_w6wed_recombined_prev,z4_prob_50pc_w7wed_recombined_prev,z4_prob_50pc_w8wed_recombined_prev)

Facility_B_z4_prob_50pc_agents_melted <- melt(mdarray)
colnames(Facility_B_z4_prob_50pc_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_z4_prob_50pc_agents_melted$agent <- Facility_B_z4_prob_50pc_agents_melted$agent-1
Facility_B_z4_prob_50pc_agents_melted$logical <- Facility_B_z4_prob_50pc_agents_melted$value>0
Facility_B_z4_prob_50pc_agents_melted$binary <- as.numeric(Facility_B_z4_prob_50pc_agents_melted$logical)
Facility_B_z4_prob_50pc_agents_melted$log10value <- log10(Facility_B_z4_prob_50pc_agents_melted$value)
Facility_B_z4_prob_50pc_agents_melted$log10value[is.infinite(Facility_B_z4_prob_50pc_agents_melted$log10value)] <- 0

agent <- Facility_B_z4_prob_50pc_agents_melted$agent
iteration <- Facility_B_z4_prob_50pc_agents_melted$iteration
tick <- Facility_B_z4_prob_50pc_agents_melted$tick
rle_matrix <- tapply(Facility_B_z4_prob_50pc_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_z4_prob_50pc_agents_melted_mean_value_matrix <- tapply(Facility_B_z4_prob_50pc_agents_melted$value, list(agent, tick), mean)
Facility_B_z4_prob_50pc_agents_melted_median_value_matrix <- tapply(Facility_B_z4_prob_50pc_agents_melted$value, list(agent, tick), median)
Facility_B_z4_prob_50pc_agents_melted_prob_value_matrix <- tapply(Facility_B_z4_prob_50pc_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}
# durations$agent <- durations$agent-1

Facility_B_durations_z4_prob_50pc <- durations

agents_list_z4_prob_50pc <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_z4_prob_50pc <- agents_list_z4_prob_50pc[,c("V1","V7","V8","V9")]
colnames(agents_list_z4_prob_50pc) <- c("name","sanitation_status","schedule","area")
agents_list_z4_prob_50pc$ttp <- rep((168*2),225)
agents_list_z4_prob_50pc$ttp[agents_list_z4_prob_50pc$schedule=="daily"] <- (24*2)

agent <- 1
while(agent<=225) {
  agents_list_z4_prob_50pc$min_duration[agent] <- ifelse(length(Facility_B_durations_z4_prob_50pc$duration[Facility_B_durations_z4_prob_50pc$agent==agent])==0,NA,min(Facility_B_durations_z4_prob_50pc$duration[Facility_B_durations_z4_prob_50pc$agent==agent], na.rm = TRUE))
  agents_list_z4_prob_50pc$mean_duration[agent] <- ifelse(length(Facility_B_durations_z4_prob_50pc$duration[Facility_B_durations_z4_prob_50pc$agent==agent])==0,NA,mean(Facility_B_durations_z4_prob_50pc$duration[Facility_B_durations_z4_prob_50pc$agent==agent], na.rm = TRUE))
  agents_list_z4_prob_50pc$median_duration[agent] <- ifelse(length(Facility_B_durations_z4_prob_50pc$duration[Facility_B_durations_z4_prob_50pc$agent==agent])==0,NA,median(Facility_B_durations_z4_prob_50pc$duration[Facility_B_durations_z4_prob_50pc$agent==agent], na.rm = TRUE))
  agents_list_z4_prob_50pc$max_duration[agent] <- ifelse(length(Facility_B_durations_z4_prob_50pc$duration[Facility_B_durations_z4_prob_50pc$agent==agent])==0,NA,max(Facility_B_durations_z4_prob_50pc$duration[Facility_B_durations_z4_prob_50pc$agent==agent], na.rm = TRUE))
  agents_list_z4_prob_50pc$times_persistent[agent] <- sum(Facility_B_durations_z4_prob_50pc$duration[Facility_B_durations_z4_prob_50pc$agent==agent]>agents_list_z4_prob_50pc$ttp[agent])
  agent <- agent+1 
}

Facility_B_z4_prob_50pc_agents_melted_monday_preop <- Facility_B_z4_prob_50pc_agents_melted[which(Facility_B_z4_prob_50pc_agents_melted$tick==33|Facility_B_z4_prob_50pc_agents_melted$tick==201|Facility_B_z4_prob_50pc_agents_melted$tick==369|Facility_B_z4_prob_50pc_agents_melted$tick==537|Facility_B_z4_prob_50pc_agents_melted$tick==705|Facility_B_z4_prob_50pc_agents_melted$tick==873|Facility_B_z4_prob_50pc_agents_melted$tick==1041|Facility_B_z4_prob_50pc_agents_melted$tick==1209),]

Facility_B_z4_prob_50pc_agents_melted_tuesday_preop <- Facility_B_z4_prob_50pc_agents_melted[which(Facility_B_z4_prob_50pc_agents_melted$tick==57|Facility_B_z4_prob_50pc_agents_melted$tick==225|Facility_B_z4_prob_50pc_agents_melted$tick==393|Facility_B_z4_prob_50pc_agents_melted$tick==561|Facility_B_z4_prob_50pc_agents_melted$tick==729|Facility_B_z4_prob_50pc_agents_melted$tick==897|Facility_B_z4_prob_50pc_agents_melted$tick==1065|Facility_B_z4_prob_50pc_agents_melted$tick==1233),]

Facility_B_z4_prob_50pc_agents_melted_wednesday_preop <- Facility_B_z4_prob_50pc_agents_melted[which(Facility_B_z4_prob_50pc_agents_melted$tick==81|Facility_B_z4_prob_50pc_agents_melted$tick==249|Facility_B_z4_prob_50pc_agents_melted$tick==417|Facility_B_z4_prob_50pc_agents_melted$tick==585|Facility_B_z4_prob_50pc_agents_melted$tick==753|Facility_B_z4_prob_50pc_agents_melted$tick==921|Facility_B_z4_prob_50pc_agents_melted$tick==1089|Facility_B_z4_prob_50pc_agents_melted$tick==1257),]

Facility_B_z4_prob_50pc_agents_melted_thursday_preop <- Facility_B_z4_prob_50pc_agents_melted[which(Facility_B_z4_prob_50pc_agents_melted$tick==105|Facility_B_z4_prob_50pc_agents_melted$tick==273|Facility_B_z4_prob_50pc_agents_melted$tick==441|Facility_B_z4_prob_50pc_agents_melted$tick==609|Facility_B_z4_prob_50pc_agents_melted$tick==777|Facility_B_z4_prob_50pc_agents_melted$tick==945|Facility_B_z4_prob_50pc_agents_melted$tick==1113|Facility_B_z4_prob_50pc_agents_melted$tick==1281),]

Facility_B_z4_prob_50pc_agents_melted_friday_preop <- Facility_B_z4_prob_50pc_agents_melted[which(Facility_B_z4_prob_50pc_agents_melted$tick==129|Facility_B_z4_prob_50pc_agents_melted$tick==297|Facility_B_z4_prob_50pc_agents_melted$tick==465|Facility_B_z4_prob_50pc_agents_melted$tick==633|Facility_B_z4_prob_50pc_agents_melted$tick==801|Facility_B_z4_prob_50pc_agents_melted$tick==969|Facility_B_z4_prob_50pc_agents_melted$tick==1137|Facility_B_z4_prob_50pc_agents_melted$tick==1305),]

Facility_B_z4_prob_50pc_agents_melted_ff <- as.ffdf(Facility_B_z4_prob_50pc_agents_melted)
rm(Facility_B_z4_prob_50pc_agents_melted)
gc()
```

```{r import P Z4 Reduction 25%}
NL_table_Z4_Prob_25pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-28-00-01 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_P_Z4_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Z4_Prob_25pc <- NL_table_Z4_Prob_25pc[NL_table_Z4_Prob_25pc$scenario==37,]

while (any(grepl('-', names(NL_table_Z4_Prob_25pc), fixed = TRUE))) {
  NL_table_Z4_Prob_25pc <- NL_table_Z4_Prob_25pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Z4_Prob_25pc), fixed = TRUE))) {
  NL_table_Z4_Prob_25pc <- NL_table_Z4_Prob_25pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Z4_Prob_25pc), fixed = TRUE))) {
  NL_table_Z4_Prob_25pc <- NL_table_Z4_Prob_25pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Z4_Prob_25pc), fixed = TRUE))) {
  NL_table_Z4_Prob_25pc <- NL_table_Z4_Prob_25pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Z4_Prob_25pc[ , ..list_columns]

NL_table_Z4_Prob_25pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Z4_Prob_25pc <- as.data.frame(NL_table_Z4_Prob_25pc)

NL_table_Z4_Prob_25pc[NL_table_Z4_Prob_25pc==-1] <- NA

NL_table_Z4_Prob_25pc <- subset(NL_table_Z4_Prob_25pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Z4_Prob_25pc)[names(NL_table_Z4_Prob_25pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Z4_Prob_25pc)[names(NL_table_Z4_Prob_25pc)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Z4_Prob_25pc$loading_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_loading_w1wed_conc_list <- append(z4_prob_25pc_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_loading_w1wed_conc_matrix <- matrix(unlist(z4_prob_25pc_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_cleaning_w1wed_conc_list <- append(z4_prob_25pc_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_cleaning_w1wed_conc_matrix <- matrix(unlist(z4_prob_25pc_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_25pc$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_25pc_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_25pc_drying_w1wed_conc_list <- append(z4_prob_25pc_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_25pc$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_sorting_w1wed_conc_list <- append(z4_prob_25pc_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_sorting_w1wed_conc_matrix <- matrix(unlist(z4_prob_25pc_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_tray_packing_w1wed_conc_list <- append(z4_prob_25pc_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_tray_packing_w1wed_conc_matrix <- matrix(unlist(z4_prob_25pc_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$reject_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_reject_w1wed_conc_list <- append(z4_prob_25pc_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_reject_w1wed_conc_matrix <- matrix(unlist(z4_prob_25pc_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$other_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_other_w1wed_conc_list <- append(z4_prob_25pc_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_other_w1wed_conc_matrix <- matrix(unlist(z4_prob_25pc_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_25pc_loading_concs <- as.data.frame(z4_prob_25pc_loading_w1wed_conc_list)
z4_prob_25pc_loading_concs$area <- as.factor('loading')
z4_prob_25pc_loading_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_25pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_cleaning_concs <- as.data.frame(z4_prob_25pc_cleaning_w1wed_conc_list)
z4_prob_25pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_25pc_cleaning_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_25pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_sorting_concs <- as.data.frame(z4_prob_25pc_sorting_w1wed_conc_list)
z4_prob_25pc_sorting_concs$area <- as.factor('sorting')
z4_prob_25pc_sorting_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_25pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_reject_concs <- as.data.frame(z4_prob_25pc_reject_w1wed_conc_list)
z4_prob_25pc_reject_concs$area <- as.factor('reject')
z4_prob_25pc_reject_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_25pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_tray_packing_concs <- as.data.frame(z4_prob_25pc_tray_packing_w1wed_conc_list)
z4_prob_25pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_25pc_tray_packing_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_25pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_other_concs <- as.data.frame(z4_prob_25pc_other_w1wed_conc_list)
z4_prob_25pc_other_concs$area <- as.factor('other')
z4_prob_25pc_other_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_other_concs$water <- as.factor('Dry')
names(z4_prob_25pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_w1wed_concs <- rbind(z4_prob_25pc_loading_concs,z4_prob_25pc_cleaning_concs,z4_prob_25pc_sorting_concs,z4_prob_25pc_tray_packing_concs,z4_prob_25pc_reject_concs,z4_prob_25pc_other_concs)

z4_prob_25pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_25pc$loading_w1wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_loading_prev$area <- as.factor('loading')
z4_prob_25pc_loading_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_25pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_25pc$cleaning_w1wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_25pc_cleaning_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_25pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_25pc$sorting_w1wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_sorting_prev$area <- as.factor('sorting')
z4_prob_25pc_sorting_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_25pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_25pc$reject_w1wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_reject_prev$area <- as.factor('reject')
z4_prob_25pc_reject_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_25pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_25pc$tray_packing_w1wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_25pc_tray_packing_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_25pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_other_prev <- as.data.frame(NL_table_Z4_Prob_25pc$other_w1wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_other_prev$area <- as.factor('other')
z4_prob_25pc_other_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_other_prev$water <- as.factor('Dry')
names(z4_prob_25pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_w1wed_prev <- rbind(z4_prob_25pc_loading_prev,z4_prob_25pc_cleaning_prev,z4_prob_25pc_sorting_prev,z4_prob_25pc_tray_packing_prev,z4_prob_25pc_reject_prev,z4_prob_25pc_other_prev)

z4_prob_25pc_w1wed_wet_prev <- as.data.frame(z4_prob_25pc_loading_prev$prevalence*21/100+z4_prob_25pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_25pc_w1wed_wet_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_w1wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_25pc_w1wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_25pc_w1wed_dry_prev <- as.data.frame(z4_prob_25pc_sorting_prev$prevalence*20/100+z4_prob_25pc_reject_prev$prevalence*23/100+z4_prob_25pc_tray_packing_prev$prevalence*123/100+z4_prob_25pc_other_prev$prevalence*10/100)/176*100
z4_prob_25pc_w1wed_dry_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_w1wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_25pc_w1wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_25pc_w1wed_recombined_prev <- rbind(z4_prob_25pc_w1wed_wet_prev, z4_prob_25pc_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Z4_Prob_25pc$loading_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_loading_w2wed_conc_list <- append(z4_prob_25pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_loading_w2wed_conc_matrix <- matrix(unlist(z4_prob_25pc_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_cleaning_w2wed_conc_list <- append(z4_prob_25pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_cleaning_w2wed_conc_matrix <- matrix(unlist(z4_prob_25pc_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_25pc$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_25pc_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_25pc_drying_w2wed_conc_list <- append(z4_prob_25pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_25pc$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_sorting_w2wed_conc_list <- append(z4_prob_25pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_sorting_w2wed_conc_matrix <- matrix(unlist(z4_prob_25pc_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_tray_packing_w2wed_conc_list <- append(z4_prob_25pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_tray_packing_w2wed_conc_matrix <- matrix(unlist(z4_prob_25pc_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$reject_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_reject_w2wed_conc_list <- append(z4_prob_25pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_reject_w2wed_conc_matrix <- matrix(unlist(z4_prob_25pc_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$other_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_other_w2wed_conc_list <- append(z4_prob_25pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_other_w2wed_conc_matrix <- matrix(unlist(z4_prob_25pc_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_25pc_loading_concs <- as.data.frame(z4_prob_25pc_loading_w2wed_conc_list)
z4_prob_25pc_loading_concs$area <- as.factor('loading')
z4_prob_25pc_loading_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_25pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_cleaning_concs <- as.data.frame(z4_prob_25pc_cleaning_w2wed_conc_list)
z4_prob_25pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_25pc_cleaning_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_25pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_sorting_concs <- as.data.frame(z4_prob_25pc_sorting_w2wed_conc_list)
z4_prob_25pc_sorting_concs$area <- as.factor('sorting')
z4_prob_25pc_sorting_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_25pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_reject_concs <- as.data.frame(z4_prob_25pc_reject_w2wed_conc_list)
z4_prob_25pc_reject_concs$area <- as.factor('reject')
z4_prob_25pc_reject_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_25pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_tray_packing_concs <- as.data.frame(z4_prob_25pc_tray_packing_w2wed_conc_list)
z4_prob_25pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_25pc_tray_packing_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_25pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_other_concs <- as.data.frame(z4_prob_25pc_other_w2wed_conc_list)
z4_prob_25pc_other_concs$area <- as.factor('other')
z4_prob_25pc_other_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_other_concs$water <- as.factor('Dry')
names(z4_prob_25pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_w2wed_concs <- rbind(z4_prob_25pc_loading_concs,z4_prob_25pc_cleaning_concs,z4_prob_25pc_sorting_concs,z4_prob_25pc_tray_packing_concs,z4_prob_25pc_reject_concs,z4_prob_25pc_other_concs)

z4_prob_25pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_25pc$loading_w2wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_loading_prev$area <- as.factor('loading')
z4_prob_25pc_loading_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_25pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_25pc$cleaning_w2wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_25pc_cleaning_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_25pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_25pc$sorting_w2wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_sorting_prev$area <- as.factor('sorting')
z4_prob_25pc_sorting_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_25pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_25pc$reject_w2wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_reject_prev$area <- as.factor('reject')
z4_prob_25pc_reject_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_25pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_25pc$tray_packing_w2wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_25pc_tray_packing_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_25pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_other_prev <- as.data.frame(NL_table_Z4_Prob_25pc$other_w2wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_other_prev$area <- as.factor('other')
z4_prob_25pc_other_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_other_prev$water <- as.factor('Dry')
names(z4_prob_25pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_w2wed_prev <- rbind(z4_prob_25pc_loading_prev,z4_prob_25pc_cleaning_prev,z4_prob_25pc_sorting_prev,z4_prob_25pc_tray_packing_prev,z4_prob_25pc_reject_prev,z4_prob_25pc_other_prev)

z4_prob_25pc_w2wed_wet_prev <- as.data.frame(z4_prob_25pc_loading_prev$prevalence*21/100+z4_prob_25pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_25pc_w2wed_wet_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_w2wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_25pc_w2wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_25pc_w2wed_dry_prev <- as.data.frame(z4_prob_25pc_sorting_prev$prevalence*20/100+z4_prob_25pc_reject_prev$prevalence*23/100+z4_prob_25pc_tray_packing_prev$prevalence*123/100+z4_prob_25pc_other_prev$prevalence*10/100)/176*100
z4_prob_25pc_w2wed_dry_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_w2wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_25pc_w2wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_25pc_w2wed_recombined_prev <- rbind(z4_prob_25pc_w2wed_wet_prev, z4_prob_25pc_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Z4_Prob_25pc$loading_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_loading_w3wed_conc_list <- append(z4_prob_25pc_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_loading_w3wed_conc_matrix <- matrix(unlist(z4_prob_25pc_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_cleaning_w3wed_conc_list <- append(z4_prob_25pc_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_cleaning_w3wed_conc_matrix <- matrix(unlist(z4_prob_25pc_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_25pc$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_25pc_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_25pc_drying_w3wed_conc_list <- append(z4_prob_25pc_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_25pc$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_sorting_w3wed_conc_list <- append(z4_prob_25pc_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_sorting_w3wed_conc_matrix <- matrix(unlist(z4_prob_25pc_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_tray_packing_w3wed_conc_list <- append(z4_prob_25pc_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_tray_packing_w3wed_conc_matrix <- matrix(unlist(z4_prob_25pc_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$reject_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_reject_w3wed_conc_list <- append(z4_prob_25pc_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_reject_w3wed_conc_matrix <- matrix(unlist(z4_prob_25pc_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$other_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_other_w3wed_conc_list <- append(z4_prob_25pc_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_other_w3wed_conc_matrix <- matrix(unlist(z4_prob_25pc_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_25pc_loading_concs <- as.data.frame(z4_prob_25pc_loading_w3wed_conc_list)
z4_prob_25pc_loading_concs$area <- as.factor('loading')
z4_prob_25pc_loading_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_25pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_cleaning_concs <- as.data.frame(z4_prob_25pc_cleaning_w3wed_conc_list)
z4_prob_25pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_25pc_cleaning_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_25pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_sorting_concs <- as.data.frame(z4_prob_25pc_sorting_w3wed_conc_list)
z4_prob_25pc_sorting_concs$area <- as.factor('sorting')
z4_prob_25pc_sorting_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_25pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_reject_concs <- as.data.frame(z4_prob_25pc_reject_w3wed_conc_list)
z4_prob_25pc_reject_concs$area <- as.factor('reject')
z4_prob_25pc_reject_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_25pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_tray_packing_concs <- as.data.frame(z4_prob_25pc_tray_packing_w3wed_conc_list)
z4_prob_25pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_25pc_tray_packing_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_25pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_other_concs <- as.data.frame(z4_prob_25pc_other_w3wed_conc_list)
z4_prob_25pc_other_concs$area <- as.factor('other')
z4_prob_25pc_other_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_other_concs$water <- as.factor('Dry')
names(z4_prob_25pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_w3wed_concs <- rbind(z4_prob_25pc_loading_concs,z4_prob_25pc_cleaning_concs,z4_prob_25pc_sorting_concs,z4_prob_25pc_tray_packing_concs,z4_prob_25pc_reject_concs,z4_prob_25pc_other_concs)

z4_prob_25pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_25pc$loading_w3wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_loading_prev$area <- as.factor('loading')
z4_prob_25pc_loading_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_25pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_25pc$cleaning_w3wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_25pc_cleaning_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_25pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_25pc$sorting_w3wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_sorting_prev$area <- as.factor('sorting')
z4_prob_25pc_sorting_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_25pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_25pc$reject_w3wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_reject_prev$area <- as.factor('reject')
z4_prob_25pc_reject_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_25pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_25pc$tray_packing_w3wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_25pc_tray_packing_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_25pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_other_prev <- as.data.frame(NL_table_Z4_Prob_25pc$other_w3wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_other_prev$area <- as.factor('other')
z4_prob_25pc_other_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_other_prev$water <- as.factor('Dry')
names(z4_prob_25pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_w3wed_prev <- rbind(z4_prob_25pc_loading_prev,z4_prob_25pc_cleaning_prev,z4_prob_25pc_sorting_prev,z4_prob_25pc_tray_packing_prev,z4_prob_25pc_reject_prev,z4_prob_25pc_other_prev)

z4_prob_25pc_w3wed_wet_prev <- as.data.frame(z4_prob_25pc_loading_prev$prevalence*21/100+z4_prob_25pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_25pc_w3wed_wet_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_w3wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_25pc_w3wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_25pc_w3wed_dry_prev <- as.data.frame(z4_prob_25pc_sorting_prev$prevalence*20/100+z4_prob_25pc_reject_prev$prevalence*23/100+z4_prob_25pc_tray_packing_prev$prevalence*123/100+z4_prob_25pc_other_prev$prevalence*10/100)/176*100
z4_prob_25pc_w3wed_dry_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_w3wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_25pc_w3wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_25pc_w3wed_recombined_prev <- rbind(z4_prob_25pc_w3wed_wet_prev, z4_prob_25pc_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Z4_Prob_25pc$loading_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_loading_w4wed_conc_list <- append(z4_prob_25pc_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_loading_w4wed_conc_matrix <- matrix(unlist(z4_prob_25pc_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_cleaning_w4wed_conc_list <- append(z4_prob_25pc_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_cleaning_w4wed_conc_matrix <- matrix(unlist(z4_prob_25pc_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_25pc$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_25pc_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_25pc_drying_w4wed_conc_list <- append(z4_prob_25pc_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_25pc$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_sorting_w4wed_conc_list <- append(z4_prob_25pc_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_sorting_w4wed_conc_matrix <- matrix(unlist(z4_prob_25pc_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_tray_packing_w4wed_conc_list <- append(z4_prob_25pc_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_tray_packing_w4wed_conc_matrix <- matrix(unlist(z4_prob_25pc_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$reject_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_reject_w4wed_conc_list <- append(z4_prob_25pc_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_reject_w4wed_conc_matrix <- matrix(unlist(z4_prob_25pc_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$other_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_other_w4wed_conc_list <- append(z4_prob_25pc_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_other_w4wed_conc_matrix <- matrix(unlist(z4_prob_25pc_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_25pc_loading_concs <- as.data.frame(z4_prob_25pc_loading_w4wed_conc_list)
z4_prob_25pc_loading_concs$area <- as.factor('loading')
z4_prob_25pc_loading_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_25pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_cleaning_concs <- as.data.frame(z4_prob_25pc_cleaning_w4wed_conc_list)
z4_prob_25pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_25pc_cleaning_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_25pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_sorting_concs <- as.data.frame(z4_prob_25pc_sorting_w4wed_conc_list)
z4_prob_25pc_sorting_concs$area <- as.factor('sorting')
z4_prob_25pc_sorting_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_25pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_reject_concs <- as.data.frame(z4_prob_25pc_reject_w4wed_conc_list)
z4_prob_25pc_reject_concs$area <- as.factor('reject')
z4_prob_25pc_reject_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_25pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_tray_packing_concs <- as.data.frame(z4_prob_25pc_tray_packing_w4wed_conc_list)
z4_prob_25pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_25pc_tray_packing_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_25pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_other_concs <- as.data.frame(z4_prob_25pc_other_w4wed_conc_list)
z4_prob_25pc_other_concs$area <- as.factor('other')
z4_prob_25pc_other_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_other_concs$water <- as.factor('Dry')
names(z4_prob_25pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_w4wed_concs <- rbind(z4_prob_25pc_loading_concs,z4_prob_25pc_cleaning_concs,z4_prob_25pc_sorting_concs,z4_prob_25pc_tray_packing_concs,z4_prob_25pc_reject_concs,z4_prob_25pc_other_concs)

z4_prob_25pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_25pc$loading_w4wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_loading_prev$area <- as.factor('loading')
z4_prob_25pc_loading_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_25pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_25pc$cleaning_w4wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_25pc_cleaning_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_25pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_25pc$sorting_w4wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_sorting_prev$area <- as.factor('sorting')
z4_prob_25pc_sorting_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_25pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_25pc$reject_w4wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_reject_prev$area <- as.factor('reject')
z4_prob_25pc_reject_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_25pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_25pc$tray_packing_w4wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_25pc_tray_packing_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_25pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_other_prev <- as.data.frame(NL_table_Z4_Prob_25pc$other_w4wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_other_prev$area <- as.factor('other')
z4_prob_25pc_other_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_other_prev$water <- as.factor('Dry')
names(z4_prob_25pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_w4wed_prev <- rbind(z4_prob_25pc_loading_prev,z4_prob_25pc_cleaning_prev,z4_prob_25pc_sorting_prev,z4_prob_25pc_tray_packing_prev,z4_prob_25pc_reject_prev,z4_prob_25pc_other_prev)

z4_prob_25pc_w4wed_wet_prev <- as.data.frame(z4_prob_25pc_loading_prev$prevalence*21/100+z4_prob_25pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_25pc_w4wed_wet_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_w4wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_25pc_w4wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_25pc_w4wed_dry_prev <- as.data.frame(z4_prob_25pc_sorting_prev$prevalence*20/100+z4_prob_25pc_reject_prev$prevalence*23/100+z4_prob_25pc_tray_packing_prev$prevalence*123/100+z4_prob_25pc_other_prev$prevalence*10/100)/176*100
z4_prob_25pc_w4wed_dry_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_w4wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_25pc_w4wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_25pc_w4wed_recombined_prev <- rbind(z4_prob_25pc_w4wed_wet_prev, z4_prob_25pc_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Z4_Prob_25pc$loading_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_loading_w5wed_conc_list <- append(z4_prob_25pc_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_loading_w5wed_conc_matrix <- matrix(unlist(z4_prob_25pc_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_cleaning_w5wed_conc_list <- append(z4_prob_25pc_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_cleaning_w5wed_conc_matrix <- matrix(unlist(z4_prob_25pc_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_25pc$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_25pc_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_25pc_drying_w5wed_conc_list <- append(z4_prob_25pc_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_25pc$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_sorting_w5wed_conc_list <- append(z4_prob_25pc_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_sorting_w5wed_conc_matrix <- matrix(unlist(z4_prob_25pc_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_tray_packing_w5wed_conc_list <- append(z4_prob_25pc_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_tray_packing_w5wed_conc_matrix <- matrix(unlist(z4_prob_25pc_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$reject_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_reject_w5wed_conc_list <- append(z4_prob_25pc_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_reject_w5wed_conc_matrix <- matrix(unlist(z4_prob_25pc_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$other_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_other_w5wed_conc_list <- append(z4_prob_25pc_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_other_w5wed_conc_matrix <- matrix(unlist(z4_prob_25pc_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_25pc_loading_concs <- as.data.frame(z4_prob_25pc_loading_w5wed_conc_list)
z4_prob_25pc_loading_concs$area <- as.factor('loading')
z4_prob_25pc_loading_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_25pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_cleaning_concs <- as.data.frame(z4_prob_25pc_cleaning_w5wed_conc_list)
z4_prob_25pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_25pc_cleaning_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_25pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_sorting_concs <- as.data.frame(z4_prob_25pc_sorting_w5wed_conc_list)
z4_prob_25pc_sorting_concs$area <- as.factor('sorting')
z4_prob_25pc_sorting_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_25pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_reject_concs <- as.data.frame(z4_prob_25pc_reject_w5wed_conc_list)
z4_prob_25pc_reject_concs$area <- as.factor('reject')
z4_prob_25pc_reject_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_25pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_tray_packing_concs <- as.data.frame(z4_prob_25pc_tray_packing_w5wed_conc_list)
z4_prob_25pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_25pc_tray_packing_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_25pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_other_concs <- as.data.frame(z4_prob_25pc_other_w5wed_conc_list)
z4_prob_25pc_other_concs$area <- as.factor('other')
z4_prob_25pc_other_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_other_concs$water <- as.factor('Dry')
names(z4_prob_25pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_w5wed_concs <- rbind(z4_prob_25pc_loading_concs,z4_prob_25pc_cleaning_concs,z4_prob_25pc_sorting_concs,z4_prob_25pc_tray_packing_concs,z4_prob_25pc_reject_concs,z4_prob_25pc_other_concs)

z4_prob_25pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_25pc$loading_w5wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_loading_prev$area <- as.factor('loading')
z4_prob_25pc_loading_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_25pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_25pc$cleaning_w5wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_25pc_cleaning_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_25pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_25pc$sorting_w5wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_sorting_prev$area <- as.factor('sorting')
z4_prob_25pc_sorting_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_25pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_25pc$reject_w5wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_reject_prev$area <- as.factor('reject')
z4_prob_25pc_reject_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_25pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_25pc$tray_packing_w5wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_25pc_tray_packing_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_25pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_other_prev <- as.data.frame(NL_table_Z4_Prob_25pc$other_w5wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_other_prev$area <- as.factor('other')
z4_prob_25pc_other_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_other_prev$water <- as.factor('Dry')
names(z4_prob_25pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_w5wed_prev <- rbind(z4_prob_25pc_loading_prev,z4_prob_25pc_cleaning_prev,z4_prob_25pc_sorting_prev,z4_prob_25pc_tray_packing_prev,z4_prob_25pc_reject_prev,z4_prob_25pc_other_prev)

z4_prob_25pc_w5wed_wet_prev <- as.data.frame(z4_prob_25pc_loading_prev$prevalence*21/100+z4_prob_25pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_25pc_w5wed_wet_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_w5wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_25pc_w5wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_25pc_w5wed_dry_prev <- as.data.frame(z4_prob_25pc_sorting_prev$prevalence*20/100+z4_prob_25pc_reject_prev$prevalence*23/100+z4_prob_25pc_tray_packing_prev$prevalence*123/100+z4_prob_25pc_other_prev$prevalence*10/100)/176*100
z4_prob_25pc_w5wed_dry_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_w5wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_25pc_w5wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_25pc_w5wed_recombined_prev <- rbind(z4_prob_25pc_w5wed_wet_prev, z4_prob_25pc_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Z4_Prob_25pc$loading_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_loading_w6wed_conc_list <- append(z4_prob_25pc_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_loading_w6wed_conc_matrix <- matrix(unlist(z4_prob_25pc_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_cleaning_w6wed_conc_list <- append(z4_prob_25pc_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_cleaning_w6wed_conc_matrix <- matrix(unlist(z4_prob_25pc_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_25pc$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_25pc_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_25pc_drying_w6wed_conc_list <- append(z4_prob_25pc_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_25pc$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_sorting_w6wed_conc_list <- append(z4_prob_25pc_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_sorting_w6wed_conc_matrix <- matrix(unlist(z4_prob_25pc_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_tray_packing_w6wed_conc_list <- append(z4_prob_25pc_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_tray_packing_w6wed_conc_matrix <- matrix(unlist(z4_prob_25pc_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$reject_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_reject_w6wed_conc_list <- append(z4_prob_25pc_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_reject_w6wed_conc_matrix <- matrix(unlist(z4_prob_25pc_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$other_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_other_w6wed_conc_list <- append(z4_prob_25pc_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_other_w6wed_conc_matrix <- matrix(unlist(z4_prob_25pc_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_25pc_loading_concs <- as.data.frame(z4_prob_25pc_loading_w6wed_conc_list)
z4_prob_25pc_loading_concs$area <- as.factor('loading')
z4_prob_25pc_loading_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_25pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_cleaning_concs <- as.data.frame(z4_prob_25pc_cleaning_w6wed_conc_list)
z4_prob_25pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_25pc_cleaning_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_25pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_sorting_concs <- as.data.frame(z4_prob_25pc_sorting_w6wed_conc_list)
z4_prob_25pc_sorting_concs$area <- as.factor('sorting')
z4_prob_25pc_sorting_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_25pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_reject_concs <- as.data.frame(z4_prob_25pc_reject_w6wed_conc_list)
z4_prob_25pc_reject_concs$area <- as.factor('reject')
z4_prob_25pc_reject_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_25pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_tray_packing_concs <- as.data.frame(z4_prob_25pc_tray_packing_w6wed_conc_list)
z4_prob_25pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_25pc_tray_packing_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_25pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_other_concs <- as.data.frame(z4_prob_25pc_other_w6wed_conc_list)
z4_prob_25pc_other_concs$area <- as.factor('other')
z4_prob_25pc_other_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_other_concs$water <- as.factor('Dry')
names(z4_prob_25pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_w6wed_concs <- rbind(z4_prob_25pc_loading_concs,z4_prob_25pc_cleaning_concs,z4_prob_25pc_sorting_concs,z4_prob_25pc_tray_packing_concs,z4_prob_25pc_reject_concs,z4_prob_25pc_other_concs)

z4_prob_25pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_25pc$loading_w6wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_loading_prev$area <- as.factor('loading')
z4_prob_25pc_loading_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_25pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_25pc$cleaning_w6wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_25pc_cleaning_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_25pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_25pc$sorting_w6wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_sorting_prev$area <- as.factor('sorting')
z4_prob_25pc_sorting_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_25pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_25pc$reject_w6wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_reject_prev$area <- as.factor('reject')
z4_prob_25pc_reject_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_25pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_25pc$tray_packing_w6wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_25pc_tray_packing_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_25pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_other_prev <- as.data.frame(NL_table_Z4_Prob_25pc$other_w6wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_other_prev$area <- as.factor('other')
z4_prob_25pc_other_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_other_prev$water <- as.factor('Dry')
names(z4_prob_25pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_w6wed_prev <- rbind(z4_prob_25pc_loading_prev,z4_prob_25pc_cleaning_prev,z4_prob_25pc_sorting_prev,z4_prob_25pc_tray_packing_prev,z4_prob_25pc_reject_prev,z4_prob_25pc_other_prev)

z4_prob_25pc_w6wed_wet_prev <- as.data.frame(z4_prob_25pc_loading_prev$prevalence*21/100+z4_prob_25pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_25pc_w6wed_wet_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_w6wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_25pc_w6wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_25pc_w6wed_dry_prev <- as.data.frame(z4_prob_25pc_sorting_prev$prevalence*20/100+z4_prob_25pc_reject_prev$prevalence*23/100+z4_prob_25pc_tray_packing_prev$prevalence*123/100+z4_prob_25pc_other_prev$prevalence*10/100)/176*100
z4_prob_25pc_w6wed_dry_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_w6wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_25pc_w6wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_25pc_w6wed_recombined_prev <- rbind(z4_prob_25pc_w6wed_wet_prev, z4_prob_25pc_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Z4_Prob_25pc$loading_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_loading_w7wed_conc_list <- append(z4_prob_25pc_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_loading_w7wed_conc_matrix <- matrix(unlist(z4_prob_25pc_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_cleaning_w7wed_conc_list <- append(z4_prob_25pc_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_cleaning_w7wed_conc_matrix <- matrix(unlist(z4_prob_25pc_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_25pc$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_25pc_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_25pc_drying_w7wed_conc_list <- append(z4_prob_25pc_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_25pc$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_sorting_w7wed_conc_list <- append(z4_prob_25pc_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_sorting_w7wed_conc_matrix <- matrix(unlist(z4_prob_25pc_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_tray_packing_w7wed_conc_list <- append(z4_prob_25pc_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_tray_packing_w7wed_conc_matrix <- matrix(unlist(z4_prob_25pc_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$reject_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_reject_w7wed_conc_list <- append(z4_prob_25pc_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_reject_w7wed_conc_matrix <- matrix(unlist(z4_prob_25pc_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$other_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_other_w7wed_conc_list <- append(z4_prob_25pc_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_other_w7wed_conc_matrix <- matrix(unlist(z4_prob_25pc_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_25pc_loading_concs <- as.data.frame(z4_prob_25pc_loading_w7wed_conc_list)
z4_prob_25pc_loading_concs$area <- as.factor('loading')
z4_prob_25pc_loading_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_25pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_cleaning_concs <- as.data.frame(z4_prob_25pc_cleaning_w7wed_conc_list)
z4_prob_25pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_25pc_cleaning_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_25pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_sorting_concs <- as.data.frame(z4_prob_25pc_sorting_w7wed_conc_list)
z4_prob_25pc_sorting_concs$area <- as.factor('sorting')
z4_prob_25pc_sorting_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_25pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_reject_concs <- as.data.frame(z4_prob_25pc_reject_w7wed_conc_list)
z4_prob_25pc_reject_concs$area <- as.factor('reject')
z4_prob_25pc_reject_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_25pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_tray_packing_concs <- as.data.frame(z4_prob_25pc_tray_packing_w7wed_conc_list)
z4_prob_25pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_25pc_tray_packing_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_25pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_other_concs <- as.data.frame(z4_prob_25pc_other_w7wed_conc_list)
z4_prob_25pc_other_concs$area <- as.factor('other')
z4_prob_25pc_other_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_other_concs$water <- as.factor('Dry')
names(z4_prob_25pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_w7wed_concs <- rbind(z4_prob_25pc_loading_concs,z4_prob_25pc_cleaning_concs,z4_prob_25pc_sorting_concs,z4_prob_25pc_tray_packing_concs,z4_prob_25pc_reject_concs,z4_prob_25pc_other_concs)

z4_prob_25pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_25pc$loading_w7wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_loading_prev$area <- as.factor('loading')
z4_prob_25pc_loading_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_25pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_25pc$cleaning_w7wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_25pc_cleaning_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_25pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_25pc$sorting_w7wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_sorting_prev$area <- as.factor('sorting')
z4_prob_25pc_sorting_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_25pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_25pc$reject_w7wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_reject_prev$area <- as.factor('reject')
z4_prob_25pc_reject_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_25pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_25pc$tray_packing_w7wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_25pc_tray_packing_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_25pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_other_prev <- as.data.frame(NL_table_Z4_Prob_25pc$other_w7wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_other_prev$area <- as.factor('other')
z4_prob_25pc_other_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_other_prev$water <- as.factor('Dry')
names(z4_prob_25pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_w7wed_prev <- rbind(z4_prob_25pc_loading_prev,z4_prob_25pc_cleaning_prev,z4_prob_25pc_sorting_prev,z4_prob_25pc_tray_packing_prev,z4_prob_25pc_reject_prev,z4_prob_25pc_other_prev)

z4_prob_25pc_w7wed_wet_prev <- as.data.frame(z4_prob_25pc_loading_prev$prevalence*21/100+z4_prob_25pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_25pc_w7wed_wet_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_w7wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_25pc_w7wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_25pc_w7wed_dry_prev <- as.data.frame(z4_prob_25pc_sorting_prev$prevalence*20/100+z4_prob_25pc_reject_prev$prevalence*23/100+z4_prob_25pc_tray_packing_prev$prevalence*123/100+z4_prob_25pc_other_prev$prevalence*10/100)/176*100
z4_prob_25pc_w7wed_dry_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_w7wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_25pc_w7wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_25pc_w7wed_recombined_prev <- rbind(z4_prob_25pc_w7wed_wet_prev, z4_prob_25pc_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Z4_Prob_25pc$loading_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_loading_w8wed_conc_list <- append(z4_prob_25pc_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_loading_w8wed_conc_matrix <- matrix(unlist(z4_prob_25pc_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_cleaning_w8wed_conc_list <- append(z4_prob_25pc_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_cleaning_w8wed_conc_matrix <- matrix(unlist(z4_prob_25pc_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_25pc$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_25pc_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_25pc_drying_w8wed_conc_list <- append(z4_prob_25pc_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_25pc$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_sorting_w8wed_conc_list <- append(z4_prob_25pc_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_sorting_w8wed_conc_matrix <- matrix(unlist(z4_prob_25pc_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_tray_packing_w8wed_conc_list <- append(z4_prob_25pc_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_tray_packing_w8wed_conc_matrix <- matrix(unlist(z4_prob_25pc_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$reject_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_reject_w8wed_conc_list <- append(z4_prob_25pc_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_reject_w8wed_conc_matrix <- matrix(unlist(z4_prob_25pc_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_25pc$other_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_25pc_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_25pc_other_w8wed_conc_list <- append(z4_prob_25pc_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_25pc_other_w8wed_conc_matrix <- matrix(unlist(z4_prob_25pc_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_25pc_loading_concs <- as.data.frame(z4_prob_25pc_loading_w8wed_conc_list)
z4_prob_25pc_loading_concs$area <- as.factor('loading')
z4_prob_25pc_loading_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_25pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_cleaning_concs <- as.data.frame(z4_prob_25pc_cleaning_w8wed_conc_list)
z4_prob_25pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_25pc_cleaning_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_25pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_sorting_concs <- as.data.frame(z4_prob_25pc_sorting_w8wed_conc_list)
z4_prob_25pc_sorting_concs$area <- as.factor('sorting')
z4_prob_25pc_sorting_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_25pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_reject_concs <- as.data.frame(z4_prob_25pc_reject_w8wed_conc_list)
z4_prob_25pc_reject_concs$area <- as.factor('reject')
z4_prob_25pc_reject_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_25pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_tray_packing_concs <- as.data.frame(z4_prob_25pc_tray_packing_w8wed_conc_list)
z4_prob_25pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_25pc_tray_packing_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_25pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_other_concs <- as.data.frame(z4_prob_25pc_other_w8wed_conc_list)
z4_prob_25pc_other_concs$area <- as.factor('other')
z4_prob_25pc_other_concs$scenario <- as.factor('PZ_03')
z4_prob_25pc_other_concs$water <- as.factor('Dry')
names(z4_prob_25pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_25pc_w8wed_concs <- rbind(z4_prob_25pc_loading_concs,z4_prob_25pc_cleaning_concs,z4_prob_25pc_sorting_concs,z4_prob_25pc_tray_packing_concs,z4_prob_25pc_reject_concs,z4_prob_25pc_other_concs)

z4_prob_25pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_25pc$loading_w8wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_loading_prev$area <- as.factor('loading')
z4_prob_25pc_loading_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_25pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_25pc$cleaning_w8wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_25pc_cleaning_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_25pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_25pc$sorting_w8wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_sorting_prev$area <- as.factor('sorting')
z4_prob_25pc_sorting_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_25pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_25pc$reject_w8wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_reject_prev$area <- as.factor('reject')
z4_prob_25pc_reject_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_25pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_25pc$tray_packing_w8wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_25pc_tray_packing_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_25pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_other_prev <- as.data.frame(NL_table_Z4_Prob_25pc$other_w8wed_prev[order(NL_table_Z4_Prob_25pc$local_seed)])
z4_prob_25pc_other_prev$area <- as.factor('other')
z4_prob_25pc_other_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_other_prev$water <- as.factor('Dry')
names(z4_prob_25pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_25pc_w8wed_prev <- rbind(z4_prob_25pc_loading_prev,z4_prob_25pc_cleaning_prev,z4_prob_25pc_sorting_prev,z4_prob_25pc_tray_packing_prev,z4_prob_25pc_reject_prev,z4_prob_25pc_other_prev)

z4_prob_25pc_w8wed_wet_prev <- as.data.frame(z4_prob_25pc_loading_prev$prevalence*21/100+z4_prob_25pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_25pc_w8wed_wet_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_w8wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_25pc_w8wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_25pc_w8wed_dry_prev <- as.data.frame(z4_prob_25pc_sorting_prev$prevalence*20/100+z4_prob_25pc_reject_prev$prevalence*23/100+z4_prob_25pc_tray_packing_prev$prevalence*123/100+z4_prob_25pc_other_prev$prevalence*10/100)/176*100
z4_prob_25pc_w8wed_dry_prev$scenario <- as.factor('PZ_03')
z4_prob_25pc_w8wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_25pc_w8wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_25pc_w8wed_recombined_prev <- rbind(z4_prob_25pc_w8wed_wet_prev, z4_prob_25pc_w8wed_dry_prev)

vector <- NL_table_Z4_Prob_25pc$lifetime_conc_list[order(NL_table_Z4_Prob_25pc$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

z4_prob_25pc_w1wed_recombined_prev$week <- as.factor(1)
z4_prob_25pc_w2wed_recombined_prev$week <- as.factor(2)
z4_prob_25pc_w3wed_recombined_prev$week <- as.factor(3)
z4_prob_25pc_w4wed_recombined_prev$week <- as.factor(4)
z4_prob_25pc_w5wed_recombined_prev$week <- as.factor(5)
z4_prob_25pc_w6wed_recombined_prev$week <- as.factor(6)
z4_prob_25pc_w7wed_recombined_prev$week <- as.factor(7)
z4_prob_25pc_w8wed_recombined_prev$week <- as.factor(8)
z4_prob_25pc_allwed_prev <- rbind(z4_prob_25pc_w1wed_recombined_prev,z4_prob_25pc_w2wed_recombined_prev,z4_prob_25pc_w3wed_recombined_prev,z4_prob_25pc_w4wed_recombined_prev,z4_prob_25pc_w5wed_recombined_prev,z4_prob_25pc_w6wed_recombined_prev,z4_prob_25pc_w7wed_recombined_prev,z4_prob_25pc_w8wed_recombined_prev)

Facility_B_z4_prob_25pc_agents_melted <- melt(mdarray)
colnames(Facility_B_z4_prob_25pc_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_z4_prob_25pc_agents_melted$agent <- Facility_B_z4_prob_25pc_agents_melted$agent-1
Facility_B_z4_prob_25pc_agents_melted$logical <- Facility_B_z4_prob_25pc_agents_melted$value>0
Facility_B_z4_prob_25pc_agents_melted$binary <- as.numeric(Facility_B_z4_prob_25pc_agents_melted$logical)
Facility_B_z4_prob_25pc_agents_melted$log10value <- log10(Facility_B_z4_prob_25pc_agents_melted$value)
Facility_B_z4_prob_25pc_agents_melted$log10value[is.infinite(Facility_B_z4_prob_25pc_agents_melted$log10value)] <- 0

agent <- Facility_B_z4_prob_25pc_agents_melted$agent
iteration <- Facility_B_z4_prob_25pc_agents_melted$iteration
tick <- Facility_B_z4_prob_25pc_agents_melted$tick
rle_matrix <- tapply(Facility_B_z4_prob_25pc_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_z4_prob_25pc_agents_melted_mean_value_matrix <- tapply(Facility_B_z4_prob_25pc_agents_melted$value, list(agent, tick), mean)
Facility_B_z4_prob_25pc_agents_melted_median_value_matrix <- tapply(Facility_B_z4_prob_25pc_agents_melted$value, list(agent, tick), median)
Facility_B_z4_prob_25pc_agents_melted_prob_value_matrix <- tapply(Facility_B_z4_prob_25pc_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}
# durations$agent <- durations$agent-1

Facility_B_durations_z4_prob_25pc <- durations

agents_list_z4_prob_25pc <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_z4_prob_25pc <- agents_list_z4_prob_25pc[,c("V1","V7","V8","V9")]
colnames(agents_list_z4_prob_25pc) <- c("name","sanitation_status","schedule","area")
agents_list_z4_prob_25pc$ttp <- rep((168*2),225)
agents_list_z4_prob_25pc$ttp[agents_list_z4_prob_25pc$schedule=="daily"] <- (24*2)

agent <- 1
while(agent<=225) {
  agents_list_z4_prob_25pc$min_duration[agent] <- ifelse(length(Facility_B_durations_z4_prob_25pc$duration[Facility_B_durations_z4_prob_25pc$agent==agent])==0,NA,min(Facility_B_durations_z4_prob_25pc$duration[Facility_B_durations_z4_prob_25pc$agent==agent], na.rm = TRUE))
  agents_list_z4_prob_25pc$mean_duration[agent] <- ifelse(length(Facility_B_durations_z4_prob_25pc$duration[Facility_B_durations_z4_prob_25pc$agent==agent])==0,NA,mean(Facility_B_durations_z4_prob_25pc$duration[Facility_B_durations_z4_prob_25pc$agent==agent], na.rm = TRUE))
  agents_list_z4_prob_25pc$median_duration[agent] <- ifelse(length(Facility_B_durations_z4_prob_25pc$duration[Facility_B_durations_z4_prob_25pc$agent==agent])==0,NA,median(Facility_B_durations_z4_prob_25pc$duration[Facility_B_durations_z4_prob_25pc$agent==agent], na.rm = TRUE))
  agents_list_z4_prob_25pc$max_duration[agent] <- ifelse(length(Facility_B_durations_z4_prob_25pc$duration[Facility_B_durations_z4_prob_25pc$agent==agent])==0,NA,max(Facility_B_durations_z4_prob_25pc$duration[Facility_B_durations_z4_prob_25pc$agent==agent], na.rm = TRUE))
  agents_list_z4_prob_25pc$times_persistent[agent] <- sum(Facility_B_durations_z4_prob_25pc$duration[Facility_B_durations_z4_prob_25pc$agent==agent]>agents_list_z4_prob_25pc$ttp[agent])
  agent <- agent+1 
}

Facility_B_z4_prob_25pc_agents_melted_monday_preop <- Facility_B_z4_prob_25pc_agents_melted[which(Facility_B_z4_prob_25pc_agents_melted$tick==33|Facility_B_z4_prob_25pc_agents_melted$tick==201|Facility_B_z4_prob_25pc_agents_melted$tick==369|Facility_B_z4_prob_25pc_agents_melted$tick==537|Facility_B_z4_prob_25pc_agents_melted$tick==705|Facility_B_z4_prob_25pc_agents_melted$tick==873|Facility_B_z4_prob_25pc_agents_melted$tick==1041|Facility_B_z4_prob_25pc_agents_melted$tick==1209),]

Facility_B_z4_prob_25pc_agents_melted_tuesday_preop <- Facility_B_z4_prob_25pc_agents_melted[which(Facility_B_z4_prob_25pc_agents_melted$tick==57|Facility_B_z4_prob_25pc_agents_melted$tick==225|Facility_B_z4_prob_25pc_agents_melted$tick==393|Facility_B_z4_prob_25pc_agents_melted$tick==561|Facility_B_z4_prob_25pc_agents_melted$tick==729|Facility_B_z4_prob_25pc_agents_melted$tick==897|Facility_B_z4_prob_25pc_agents_melted$tick==1065|Facility_B_z4_prob_25pc_agents_melted$tick==1233),]

Facility_B_z4_prob_25pc_agents_melted_wednesday_preop <- Facility_B_z4_prob_25pc_agents_melted[which(Facility_B_z4_prob_25pc_agents_melted$tick==81|Facility_B_z4_prob_25pc_agents_melted$tick==249|Facility_B_z4_prob_25pc_agents_melted$tick==417|Facility_B_z4_prob_25pc_agents_melted$tick==585|Facility_B_z4_prob_25pc_agents_melted$tick==753|Facility_B_z4_prob_25pc_agents_melted$tick==921|Facility_B_z4_prob_25pc_agents_melted$tick==1089|Facility_B_z4_prob_25pc_agents_melted$tick==1257),]

Facility_B_z4_prob_25pc_agents_melted_thursday_preop <- Facility_B_z4_prob_25pc_agents_melted[which(Facility_B_z4_prob_25pc_agents_melted$tick==105|Facility_B_z4_prob_25pc_agents_melted$tick==273|Facility_B_z4_prob_25pc_agents_melted$tick==441|Facility_B_z4_prob_25pc_agents_melted$tick==609|Facility_B_z4_prob_25pc_agents_melted$tick==777|Facility_B_z4_prob_25pc_agents_melted$tick==945|Facility_B_z4_prob_25pc_agents_melted$tick==1113|Facility_B_z4_prob_25pc_agents_melted$tick==1281),]

Facility_B_z4_prob_25pc_agents_melted_friday_preop <- Facility_B_z4_prob_25pc_agents_melted[which(Facility_B_z4_prob_25pc_agents_melted$tick==129|Facility_B_z4_prob_25pc_agents_melted$tick==297|Facility_B_z4_prob_25pc_agents_melted$tick==465|Facility_B_z4_prob_25pc_agents_melted$tick==633|Facility_B_z4_prob_25pc_agents_melted$tick==801|Facility_B_z4_prob_25pc_agents_melted$tick==969|Facility_B_z4_prob_25pc_agents_melted$tick==1137|Facility_B_z4_prob_25pc_agents_melted$tick==1305),]

Facility_B_z4_prob_25pc_agents_melted_ff <- as.ffdf(Facility_B_z4_prob_25pc_agents_melted)
rm(Facility_B_z4_prob_25pc_agents_melted)
gc()
```

```{r import P Z4 Reduction 0%}
NL_table_Z4_Prob_0pc <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-28-00-01 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_P_Z4_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Z4_Prob_0pc <- NL_table_Z4_Prob_0pc[NL_table_Z4_Prob_0pc$scenario==38,]

while (any(grepl('-', names(NL_table_Z4_Prob_0pc), fixed = TRUE))) {
  NL_table_Z4_Prob_0pc <- NL_table_Z4_Prob_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Z4_Prob_0pc), fixed = TRUE))) {
  NL_table_Z4_Prob_0pc <- NL_table_Z4_Prob_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Z4_Prob_0pc), fixed = TRUE))) {
  NL_table_Z4_Prob_0pc <- NL_table_Z4_Prob_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Z4_Prob_0pc), fixed = TRUE))) {
  NL_table_Z4_Prob_0pc <- NL_table_Z4_Prob_0pc %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Z4_Prob_0pc[ , ..list_columns]

NL_table_Z4_Prob_0pc[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Z4_Prob_0pc <- as.data.frame(NL_table_Z4_Prob_0pc)

NL_table_Z4_Prob_0pc[NL_table_Z4_Prob_0pc==-1] <- NA

NL_table_Z4_Prob_0pc <- subset(NL_table_Z4_Prob_0pc, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Z4_Prob_0pc)[names(NL_table_Z4_Prob_0pc)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Z4_Prob_0pc)[names(NL_table_Z4_Prob_0pc)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Z4_Prob_0pc$loading_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_loading_w1wed_conc_list <- append(z4_prob_0pc_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_loading_w1wed_conc_matrix <- matrix(unlist(z4_prob_0pc_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_cleaning_w1wed_conc_list <- append(z4_prob_0pc_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_cleaning_w1wed_conc_matrix <- matrix(unlist(z4_prob_0pc_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_0pc$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_0pc_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_0pc_drying_w1wed_conc_list <- append(z4_prob_0pc_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_0pc$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_sorting_w1wed_conc_list <- append(z4_prob_0pc_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_sorting_w1wed_conc_matrix <- matrix(unlist(z4_prob_0pc_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_tray_packing_w1wed_conc_list <- append(z4_prob_0pc_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_tray_packing_w1wed_conc_matrix <- matrix(unlist(z4_prob_0pc_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$reject_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_reject_w1wed_conc_list <- append(z4_prob_0pc_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_reject_w1wed_conc_matrix <- matrix(unlist(z4_prob_0pc_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$other_w1wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_other_w1wed_conc_list <- append(z4_prob_0pc_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_other_w1wed_conc_matrix <- matrix(unlist(z4_prob_0pc_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_0pc_loading_concs <- as.data.frame(z4_prob_0pc_loading_w1wed_conc_list)
z4_prob_0pc_loading_concs$area <- as.factor('loading')
z4_prob_0pc_loading_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_0pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_cleaning_concs <- as.data.frame(z4_prob_0pc_cleaning_w1wed_conc_list)
z4_prob_0pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_0pc_cleaning_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_sorting_concs <- as.data.frame(z4_prob_0pc_sorting_w1wed_conc_list)
z4_prob_0pc_sorting_concs$area <- as.factor('sorting')
z4_prob_0pc_sorting_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_0pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_reject_concs <- as.data.frame(z4_prob_0pc_reject_w1wed_conc_list)
z4_prob_0pc_reject_concs$area <- as.factor('reject')
z4_prob_0pc_reject_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_0pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_tray_packing_concs <- as.data.frame(z4_prob_0pc_tray_packing_w1wed_conc_list)
z4_prob_0pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_0pc_tray_packing_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_other_concs <- as.data.frame(z4_prob_0pc_other_w1wed_conc_list)
z4_prob_0pc_other_concs$area <- as.factor('other')
z4_prob_0pc_other_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_other_concs$water <- as.factor('Dry')
names(z4_prob_0pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_w1wed_concs <- rbind(z4_prob_0pc_loading_concs,z4_prob_0pc_cleaning_concs,z4_prob_0pc_sorting_concs,z4_prob_0pc_tray_packing_concs,z4_prob_0pc_reject_concs,z4_prob_0pc_other_concs)

z4_prob_0pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_0pc$loading_w1wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_loading_prev$area <- as.factor('loading')
z4_prob_0pc_loading_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_0pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_0pc$cleaning_w1wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_0pc_cleaning_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_0pc$sorting_w1wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_sorting_prev$area <- as.factor('sorting')
z4_prob_0pc_sorting_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_0pc$reject_w1wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_reject_prev$area <- as.factor('reject')
z4_prob_0pc_reject_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_0pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_0pc$tray_packing_w1wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_0pc_tray_packing_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_other_prev <- as.data.frame(NL_table_Z4_Prob_0pc$other_w1wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_other_prev$area <- as.factor('other')
z4_prob_0pc_other_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_other_prev$water <- as.factor('Dry')
names(z4_prob_0pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_w1wed_prev <- rbind(z4_prob_0pc_loading_prev,z4_prob_0pc_cleaning_prev,z4_prob_0pc_sorting_prev,z4_prob_0pc_tray_packing_prev,z4_prob_0pc_reject_prev,z4_prob_0pc_other_prev)

z4_prob_0pc_w1wed_wet_prev <- as.data.frame(z4_prob_0pc_loading_prev$prevalence*21/100+z4_prob_0pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_0pc_w1wed_wet_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_w1wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_0pc_w1wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_0pc_w1wed_dry_prev <- as.data.frame(z4_prob_0pc_sorting_prev$prevalence*20/100+z4_prob_0pc_reject_prev$prevalence*23/100+z4_prob_0pc_tray_packing_prev$prevalence*123/100+z4_prob_0pc_other_prev$prevalence*10/100)/176*100
z4_prob_0pc_w1wed_dry_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_w1wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_0pc_w1wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_0pc_w1wed_recombined_prev <- rbind(z4_prob_0pc_w1wed_wet_prev, z4_prob_0pc_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Z4_Prob_0pc$loading_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_loading_w2wed_conc_list <- append(z4_prob_0pc_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_loading_w2wed_conc_matrix <- matrix(unlist(z4_prob_0pc_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_cleaning_w2wed_conc_list <- append(z4_prob_0pc_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_cleaning_w2wed_conc_matrix <- matrix(unlist(z4_prob_0pc_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_0pc$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_0pc_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_0pc_drying_w2wed_conc_list <- append(z4_prob_0pc_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_0pc$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_sorting_w2wed_conc_list <- append(z4_prob_0pc_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_sorting_w2wed_conc_matrix <- matrix(unlist(z4_prob_0pc_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_tray_packing_w2wed_conc_list <- append(z4_prob_0pc_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_tray_packing_w2wed_conc_matrix <- matrix(unlist(z4_prob_0pc_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$reject_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_reject_w2wed_conc_list <- append(z4_prob_0pc_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_reject_w2wed_conc_matrix <- matrix(unlist(z4_prob_0pc_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$other_w2wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_other_w2wed_conc_list <- append(z4_prob_0pc_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_other_w2wed_conc_matrix <- matrix(unlist(z4_prob_0pc_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_0pc_loading_concs <- as.data.frame(z4_prob_0pc_loading_w2wed_conc_list)
z4_prob_0pc_loading_concs$area <- as.factor('loading')
z4_prob_0pc_loading_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_0pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_cleaning_concs <- as.data.frame(z4_prob_0pc_cleaning_w2wed_conc_list)
z4_prob_0pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_0pc_cleaning_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_sorting_concs <- as.data.frame(z4_prob_0pc_sorting_w2wed_conc_list)
z4_prob_0pc_sorting_concs$area <- as.factor('sorting')
z4_prob_0pc_sorting_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_0pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_reject_concs <- as.data.frame(z4_prob_0pc_reject_w2wed_conc_list)
z4_prob_0pc_reject_concs$area <- as.factor('reject')
z4_prob_0pc_reject_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_0pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_tray_packing_concs <- as.data.frame(z4_prob_0pc_tray_packing_w2wed_conc_list)
z4_prob_0pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_0pc_tray_packing_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_other_concs <- as.data.frame(z4_prob_0pc_other_w2wed_conc_list)
z4_prob_0pc_other_concs$area <- as.factor('other')
z4_prob_0pc_other_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_other_concs$water <- as.factor('Dry')
names(z4_prob_0pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_w2wed_concs <- rbind(z4_prob_0pc_loading_concs,z4_prob_0pc_cleaning_concs,z4_prob_0pc_sorting_concs,z4_prob_0pc_tray_packing_concs,z4_prob_0pc_reject_concs,z4_prob_0pc_other_concs)

z4_prob_0pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_0pc$loading_w2wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_loading_prev$area <- as.factor('loading')
z4_prob_0pc_loading_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_0pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_0pc$cleaning_w2wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_0pc_cleaning_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_0pc$sorting_w2wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_sorting_prev$area <- as.factor('sorting')
z4_prob_0pc_sorting_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_0pc$reject_w2wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_reject_prev$area <- as.factor('reject')
z4_prob_0pc_reject_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_0pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_0pc$tray_packing_w2wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_0pc_tray_packing_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_other_prev <- as.data.frame(NL_table_Z4_Prob_0pc$other_w2wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_other_prev$area <- as.factor('other')
z4_prob_0pc_other_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_other_prev$water <- as.factor('Dry')
names(z4_prob_0pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_w2wed_prev <- rbind(z4_prob_0pc_loading_prev,z4_prob_0pc_cleaning_prev,z4_prob_0pc_sorting_prev,z4_prob_0pc_tray_packing_prev,z4_prob_0pc_reject_prev,z4_prob_0pc_other_prev)

z4_prob_0pc_w2wed_wet_prev <- as.data.frame(z4_prob_0pc_loading_prev$prevalence*21/100+z4_prob_0pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_0pc_w2wed_wet_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_w2wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_0pc_w2wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_0pc_w2wed_dry_prev <- as.data.frame(z4_prob_0pc_sorting_prev$prevalence*20/100+z4_prob_0pc_reject_prev$prevalence*23/100+z4_prob_0pc_tray_packing_prev$prevalence*123/100+z4_prob_0pc_other_prev$prevalence*10/100)/176*100
z4_prob_0pc_w2wed_dry_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_w2wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_0pc_w2wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_0pc_w2wed_recombined_prev <- rbind(z4_prob_0pc_w2wed_wet_prev, z4_prob_0pc_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Z4_Prob_0pc$loading_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_loading_w3wed_conc_list <- append(z4_prob_0pc_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_loading_w3wed_conc_matrix <- matrix(unlist(z4_prob_0pc_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_cleaning_w3wed_conc_list <- append(z4_prob_0pc_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_cleaning_w3wed_conc_matrix <- matrix(unlist(z4_prob_0pc_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_0pc$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_0pc_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_0pc_drying_w3wed_conc_list <- append(z4_prob_0pc_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_0pc$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_sorting_w3wed_conc_list <- append(z4_prob_0pc_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_sorting_w3wed_conc_matrix <- matrix(unlist(z4_prob_0pc_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_tray_packing_w3wed_conc_list <- append(z4_prob_0pc_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_tray_packing_w3wed_conc_matrix <- matrix(unlist(z4_prob_0pc_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$reject_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_reject_w3wed_conc_list <- append(z4_prob_0pc_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_reject_w3wed_conc_matrix <- matrix(unlist(z4_prob_0pc_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$other_w3wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_other_w3wed_conc_list <- append(z4_prob_0pc_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_other_w3wed_conc_matrix <- matrix(unlist(z4_prob_0pc_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_0pc_loading_concs <- as.data.frame(z4_prob_0pc_loading_w3wed_conc_list)
z4_prob_0pc_loading_concs$area <- as.factor('loading')
z4_prob_0pc_loading_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_0pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_cleaning_concs <- as.data.frame(z4_prob_0pc_cleaning_w3wed_conc_list)
z4_prob_0pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_0pc_cleaning_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_sorting_concs <- as.data.frame(z4_prob_0pc_sorting_w3wed_conc_list)
z4_prob_0pc_sorting_concs$area <- as.factor('sorting')
z4_prob_0pc_sorting_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_0pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_reject_concs <- as.data.frame(z4_prob_0pc_reject_w3wed_conc_list)
z4_prob_0pc_reject_concs$area <- as.factor('reject')
z4_prob_0pc_reject_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_0pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_tray_packing_concs <- as.data.frame(z4_prob_0pc_tray_packing_w3wed_conc_list)
z4_prob_0pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_0pc_tray_packing_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_other_concs <- as.data.frame(z4_prob_0pc_other_w3wed_conc_list)
z4_prob_0pc_other_concs$area <- as.factor('other')
z4_prob_0pc_other_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_other_concs$water <- as.factor('Dry')
names(z4_prob_0pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_w3wed_concs <- rbind(z4_prob_0pc_loading_concs,z4_prob_0pc_cleaning_concs,z4_prob_0pc_sorting_concs,z4_prob_0pc_tray_packing_concs,z4_prob_0pc_reject_concs,z4_prob_0pc_other_concs)

z4_prob_0pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_0pc$loading_w3wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_loading_prev$area <- as.factor('loading')
z4_prob_0pc_loading_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_0pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_0pc$cleaning_w3wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_0pc_cleaning_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_0pc$sorting_w3wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_sorting_prev$area <- as.factor('sorting')
z4_prob_0pc_sorting_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_0pc$reject_w3wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_reject_prev$area <- as.factor('reject')
z4_prob_0pc_reject_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_0pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_0pc$tray_packing_w3wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_0pc_tray_packing_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_other_prev <- as.data.frame(NL_table_Z4_Prob_0pc$other_w3wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_other_prev$area <- as.factor('other')
z4_prob_0pc_other_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_other_prev$water <- as.factor('Dry')
names(z4_prob_0pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_w3wed_prev <- rbind(z4_prob_0pc_loading_prev,z4_prob_0pc_cleaning_prev,z4_prob_0pc_sorting_prev,z4_prob_0pc_tray_packing_prev,z4_prob_0pc_reject_prev,z4_prob_0pc_other_prev)

z4_prob_0pc_w3wed_wet_prev <- as.data.frame(z4_prob_0pc_loading_prev$prevalence*21/100+z4_prob_0pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_0pc_w3wed_wet_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_w3wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_0pc_w3wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_0pc_w3wed_dry_prev <- as.data.frame(z4_prob_0pc_sorting_prev$prevalence*20/100+z4_prob_0pc_reject_prev$prevalence*23/100+z4_prob_0pc_tray_packing_prev$prevalence*123/100+z4_prob_0pc_other_prev$prevalence*10/100)/176*100
z4_prob_0pc_w3wed_dry_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_w3wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_0pc_w3wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_0pc_w3wed_recombined_prev <- rbind(z4_prob_0pc_w3wed_wet_prev, z4_prob_0pc_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Z4_Prob_0pc$loading_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_loading_w4wed_conc_list <- append(z4_prob_0pc_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_loading_w4wed_conc_matrix <- matrix(unlist(z4_prob_0pc_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_cleaning_w4wed_conc_list <- append(z4_prob_0pc_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_cleaning_w4wed_conc_matrix <- matrix(unlist(z4_prob_0pc_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_0pc$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_0pc_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_0pc_drying_w4wed_conc_list <- append(z4_prob_0pc_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_0pc$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_sorting_w4wed_conc_list <- append(z4_prob_0pc_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_sorting_w4wed_conc_matrix <- matrix(unlist(z4_prob_0pc_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_tray_packing_w4wed_conc_list <- append(z4_prob_0pc_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_tray_packing_w4wed_conc_matrix <- matrix(unlist(z4_prob_0pc_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$reject_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_reject_w4wed_conc_list <- append(z4_prob_0pc_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_reject_w4wed_conc_matrix <- matrix(unlist(z4_prob_0pc_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$other_w4wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_other_w4wed_conc_list <- append(z4_prob_0pc_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_other_w4wed_conc_matrix <- matrix(unlist(z4_prob_0pc_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_0pc_loading_concs <- as.data.frame(z4_prob_0pc_loading_w4wed_conc_list)
z4_prob_0pc_loading_concs$area <- as.factor('loading')
z4_prob_0pc_loading_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_0pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_cleaning_concs <- as.data.frame(z4_prob_0pc_cleaning_w4wed_conc_list)
z4_prob_0pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_0pc_cleaning_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_sorting_concs <- as.data.frame(z4_prob_0pc_sorting_w4wed_conc_list)
z4_prob_0pc_sorting_concs$area <- as.factor('sorting')
z4_prob_0pc_sorting_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_0pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_reject_concs <- as.data.frame(z4_prob_0pc_reject_w4wed_conc_list)
z4_prob_0pc_reject_concs$area <- as.factor('reject')
z4_prob_0pc_reject_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_0pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_tray_packing_concs <- as.data.frame(z4_prob_0pc_tray_packing_w4wed_conc_list)
z4_prob_0pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_0pc_tray_packing_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_other_concs <- as.data.frame(z4_prob_0pc_other_w4wed_conc_list)
z4_prob_0pc_other_concs$area <- as.factor('other')
z4_prob_0pc_other_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_other_concs$water <- as.factor('Dry')
names(z4_prob_0pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_w4wed_concs <- rbind(z4_prob_0pc_loading_concs,z4_prob_0pc_cleaning_concs,z4_prob_0pc_sorting_concs,z4_prob_0pc_tray_packing_concs,z4_prob_0pc_reject_concs,z4_prob_0pc_other_concs)

z4_prob_0pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_0pc$loading_w4wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_loading_prev$area <- as.factor('loading')
z4_prob_0pc_loading_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_0pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_0pc$cleaning_w4wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_0pc_cleaning_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_0pc$sorting_w4wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_sorting_prev$area <- as.factor('sorting')
z4_prob_0pc_sorting_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_0pc$reject_w4wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_reject_prev$area <- as.factor('reject')
z4_prob_0pc_reject_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_0pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_0pc$tray_packing_w4wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_0pc_tray_packing_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_other_prev <- as.data.frame(NL_table_Z4_Prob_0pc$other_w4wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_other_prev$area <- as.factor('other')
z4_prob_0pc_other_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_other_prev$water <- as.factor('Dry')
names(z4_prob_0pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_w4wed_prev <- rbind(z4_prob_0pc_loading_prev,z4_prob_0pc_cleaning_prev,z4_prob_0pc_sorting_prev,z4_prob_0pc_tray_packing_prev,z4_prob_0pc_reject_prev,z4_prob_0pc_other_prev)

z4_prob_0pc_w4wed_wet_prev <- as.data.frame(z4_prob_0pc_loading_prev$prevalence*21/100+z4_prob_0pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_0pc_w4wed_wet_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_w4wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_0pc_w4wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_0pc_w4wed_dry_prev <- as.data.frame(z4_prob_0pc_sorting_prev$prevalence*20/100+z4_prob_0pc_reject_prev$prevalence*23/100+z4_prob_0pc_tray_packing_prev$prevalence*123/100+z4_prob_0pc_other_prev$prevalence*10/100)/176*100
z4_prob_0pc_w4wed_dry_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_w4wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_0pc_w4wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_0pc_w4wed_recombined_prev <- rbind(z4_prob_0pc_w4wed_wet_prev, z4_prob_0pc_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Z4_Prob_0pc$loading_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_loading_w5wed_conc_list <- append(z4_prob_0pc_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_loading_w5wed_conc_matrix <- matrix(unlist(z4_prob_0pc_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_cleaning_w5wed_conc_list <- append(z4_prob_0pc_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_cleaning_w5wed_conc_matrix <- matrix(unlist(z4_prob_0pc_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_0pc$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_0pc_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_0pc_drying_w5wed_conc_list <- append(z4_prob_0pc_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_0pc$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_sorting_w5wed_conc_list <- append(z4_prob_0pc_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_sorting_w5wed_conc_matrix <- matrix(unlist(z4_prob_0pc_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_tray_packing_w5wed_conc_list <- append(z4_prob_0pc_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_tray_packing_w5wed_conc_matrix <- matrix(unlist(z4_prob_0pc_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$reject_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_reject_w5wed_conc_list <- append(z4_prob_0pc_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_reject_w5wed_conc_matrix <- matrix(unlist(z4_prob_0pc_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$other_w5wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_other_w5wed_conc_list <- append(z4_prob_0pc_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_other_w5wed_conc_matrix <- matrix(unlist(z4_prob_0pc_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_0pc_loading_concs <- as.data.frame(z4_prob_0pc_loading_w5wed_conc_list)
z4_prob_0pc_loading_concs$area <- as.factor('loading')
z4_prob_0pc_loading_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_0pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_cleaning_concs <- as.data.frame(z4_prob_0pc_cleaning_w5wed_conc_list)
z4_prob_0pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_0pc_cleaning_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_sorting_concs <- as.data.frame(z4_prob_0pc_sorting_w5wed_conc_list)
z4_prob_0pc_sorting_concs$area <- as.factor('sorting')
z4_prob_0pc_sorting_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_0pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_reject_concs <- as.data.frame(z4_prob_0pc_reject_w5wed_conc_list)
z4_prob_0pc_reject_concs$area <- as.factor('reject')
z4_prob_0pc_reject_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_0pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_tray_packing_concs <- as.data.frame(z4_prob_0pc_tray_packing_w5wed_conc_list)
z4_prob_0pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_0pc_tray_packing_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_other_concs <- as.data.frame(z4_prob_0pc_other_w5wed_conc_list)
z4_prob_0pc_other_concs$area <- as.factor('other')
z4_prob_0pc_other_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_other_concs$water <- as.factor('Dry')
names(z4_prob_0pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_w5wed_concs <- rbind(z4_prob_0pc_loading_concs,z4_prob_0pc_cleaning_concs,z4_prob_0pc_sorting_concs,z4_prob_0pc_tray_packing_concs,z4_prob_0pc_reject_concs,z4_prob_0pc_other_concs)

z4_prob_0pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_0pc$loading_w5wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_loading_prev$area <- as.factor('loading')
z4_prob_0pc_loading_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_0pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_0pc$cleaning_w5wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_0pc_cleaning_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_0pc$sorting_w5wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_sorting_prev$area <- as.factor('sorting')
z4_prob_0pc_sorting_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_0pc$reject_w5wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_reject_prev$area <- as.factor('reject')
z4_prob_0pc_reject_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_0pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_0pc$tray_packing_w5wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_0pc_tray_packing_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_other_prev <- as.data.frame(NL_table_Z4_Prob_0pc$other_w5wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_other_prev$area <- as.factor('other')
z4_prob_0pc_other_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_other_prev$water <- as.factor('Dry')
names(z4_prob_0pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_w5wed_prev <- rbind(z4_prob_0pc_loading_prev,z4_prob_0pc_cleaning_prev,z4_prob_0pc_sorting_prev,z4_prob_0pc_tray_packing_prev,z4_prob_0pc_reject_prev,z4_prob_0pc_other_prev)

z4_prob_0pc_w5wed_wet_prev <- as.data.frame(z4_prob_0pc_loading_prev$prevalence*21/100+z4_prob_0pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_0pc_w5wed_wet_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_w5wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_0pc_w5wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_0pc_w5wed_dry_prev <- as.data.frame(z4_prob_0pc_sorting_prev$prevalence*20/100+z4_prob_0pc_reject_prev$prevalence*23/100+z4_prob_0pc_tray_packing_prev$prevalence*123/100+z4_prob_0pc_other_prev$prevalence*10/100)/176*100
z4_prob_0pc_w5wed_dry_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_w5wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_0pc_w5wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_0pc_w5wed_recombined_prev <- rbind(z4_prob_0pc_w5wed_wet_prev, z4_prob_0pc_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Z4_Prob_0pc$loading_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_loading_w6wed_conc_list <- append(z4_prob_0pc_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_loading_w6wed_conc_matrix <- matrix(unlist(z4_prob_0pc_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_cleaning_w6wed_conc_list <- append(z4_prob_0pc_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_cleaning_w6wed_conc_matrix <- matrix(unlist(z4_prob_0pc_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_0pc$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_0pc_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_0pc_drying_w6wed_conc_list <- append(z4_prob_0pc_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_0pc$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_sorting_w6wed_conc_list <- append(z4_prob_0pc_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_sorting_w6wed_conc_matrix <- matrix(unlist(z4_prob_0pc_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_tray_packing_w6wed_conc_list <- append(z4_prob_0pc_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_tray_packing_w6wed_conc_matrix <- matrix(unlist(z4_prob_0pc_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$reject_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_reject_w6wed_conc_list <- append(z4_prob_0pc_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_reject_w6wed_conc_matrix <- matrix(unlist(z4_prob_0pc_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$other_w6wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_other_w6wed_conc_list <- append(z4_prob_0pc_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_other_w6wed_conc_matrix <- matrix(unlist(z4_prob_0pc_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_0pc_loading_concs <- as.data.frame(z4_prob_0pc_loading_w6wed_conc_list)
z4_prob_0pc_loading_concs$area <- as.factor('loading')
z4_prob_0pc_loading_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_0pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_cleaning_concs <- as.data.frame(z4_prob_0pc_cleaning_w6wed_conc_list)
z4_prob_0pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_0pc_cleaning_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_sorting_concs <- as.data.frame(z4_prob_0pc_sorting_w6wed_conc_list)
z4_prob_0pc_sorting_concs$area <- as.factor('sorting')
z4_prob_0pc_sorting_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_0pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_reject_concs <- as.data.frame(z4_prob_0pc_reject_w6wed_conc_list)
z4_prob_0pc_reject_concs$area <- as.factor('reject')
z4_prob_0pc_reject_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_0pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_tray_packing_concs <- as.data.frame(z4_prob_0pc_tray_packing_w6wed_conc_list)
z4_prob_0pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_0pc_tray_packing_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_other_concs <- as.data.frame(z4_prob_0pc_other_w6wed_conc_list)
z4_prob_0pc_other_concs$area <- as.factor('other')
z4_prob_0pc_other_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_other_concs$water <- as.factor('Dry')
names(z4_prob_0pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_w6wed_concs <- rbind(z4_prob_0pc_loading_concs,z4_prob_0pc_cleaning_concs,z4_prob_0pc_sorting_concs,z4_prob_0pc_tray_packing_concs,z4_prob_0pc_reject_concs,z4_prob_0pc_other_concs)

z4_prob_0pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_0pc$loading_w6wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_loading_prev$area <- as.factor('loading')
z4_prob_0pc_loading_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_0pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_0pc$cleaning_w6wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_0pc_cleaning_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_0pc$sorting_w6wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_sorting_prev$area <- as.factor('sorting')
z4_prob_0pc_sorting_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_0pc$reject_w6wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_reject_prev$area <- as.factor('reject')
z4_prob_0pc_reject_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_0pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_0pc$tray_packing_w6wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_0pc_tray_packing_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_other_prev <- as.data.frame(NL_table_Z4_Prob_0pc$other_w6wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_other_prev$area <- as.factor('other')
z4_prob_0pc_other_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_other_prev$water <- as.factor('Dry')
names(z4_prob_0pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_w6wed_prev <- rbind(z4_prob_0pc_loading_prev,z4_prob_0pc_cleaning_prev,z4_prob_0pc_sorting_prev,z4_prob_0pc_tray_packing_prev,z4_prob_0pc_reject_prev,z4_prob_0pc_other_prev)

z4_prob_0pc_w6wed_wet_prev <- as.data.frame(z4_prob_0pc_loading_prev$prevalence*21/100+z4_prob_0pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_0pc_w6wed_wet_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_w6wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_0pc_w6wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_0pc_w6wed_dry_prev <- as.data.frame(z4_prob_0pc_sorting_prev$prevalence*20/100+z4_prob_0pc_reject_prev$prevalence*23/100+z4_prob_0pc_tray_packing_prev$prevalence*123/100+z4_prob_0pc_other_prev$prevalence*10/100)/176*100
z4_prob_0pc_w6wed_dry_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_w6wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_0pc_w6wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_0pc_w6wed_recombined_prev <- rbind(z4_prob_0pc_w6wed_wet_prev, z4_prob_0pc_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Z4_Prob_0pc$loading_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_loading_w7wed_conc_list <- append(z4_prob_0pc_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_loading_w7wed_conc_matrix <- matrix(unlist(z4_prob_0pc_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_cleaning_w7wed_conc_list <- append(z4_prob_0pc_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_cleaning_w7wed_conc_matrix <- matrix(unlist(z4_prob_0pc_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_0pc$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_0pc_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_0pc_drying_w7wed_conc_list <- append(z4_prob_0pc_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_0pc$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_sorting_w7wed_conc_list <- append(z4_prob_0pc_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_sorting_w7wed_conc_matrix <- matrix(unlist(z4_prob_0pc_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_tray_packing_w7wed_conc_list <- append(z4_prob_0pc_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_tray_packing_w7wed_conc_matrix <- matrix(unlist(z4_prob_0pc_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$reject_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_reject_w7wed_conc_list <- append(z4_prob_0pc_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_reject_w7wed_conc_matrix <- matrix(unlist(z4_prob_0pc_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$other_w7wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_other_w7wed_conc_list <- append(z4_prob_0pc_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_other_w7wed_conc_matrix <- matrix(unlist(z4_prob_0pc_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_0pc_loading_concs <- as.data.frame(z4_prob_0pc_loading_w7wed_conc_list)
z4_prob_0pc_loading_concs$area <- as.factor('loading')
z4_prob_0pc_loading_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_0pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_cleaning_concs <- as.data.frame(z4_prob_0pc_cleaning_w7wed_conc_list)
z4_prob_0pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_0pc_cleaning_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_sorting_concs <- as.data.frame(z4_prob_0pc_sorting_w7wed_conc_list)
z4_prob_0pc_sorting_concs$area <- as.factor('sorting')
z4_prob_0pc_sorting_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_0pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_reject_concs <- as.data.frame(z4_prob_0pc_reject_w7wed_conc_list)
z4_prob_0pc_reject_concs$area <- as.factor('reject')
z4_prob_0pc_reject_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_0pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_tray_packing_concs <- as.data.frame(z4_prob_0pc_tray_packing_w7wed_conc_list)
z4_prob_0pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_0pc_tray_packing_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_other_concs <- as.data.frame(z4_prob_0pc_other_w7wed_conc_list)
z4_prob_0pc_other_concs$area <- as.factor('other')
z4_prob_0pc_other_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_other_concs$water <- as.factor('Dry')
names(z4_prob_0pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_w7wed_concs <- rbind(z4_prob_0pc_loading_concs,z4_prob_0pc_cleaning_concs,z4_prob_0pc_sorting_concs,z4_prob_0pc_tray_packing_concs,z4_prob_0pc_reject_concs,z4_prob_0pc_other_concs)

z4_prob_0pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_0pc$loading_w7wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_loading_prev$area <- as.factor('loading')
z4_prob_0pc_loading_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_0pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_0pc$cleaning_w7wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_0pc_cleaning_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_0pc$sorting_w7wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_sorting_prev$area <- as.factor('sorting')
z4_prob_0pc_sorting_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_0pc$reject_w7wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_reject_prev$area <- as.factor('reject')
z4_prob_0pc_reject_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_0pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_0pc$tray_packing_w7wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_0pc_tray_packing_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_other_prev <- as.data.frame(NL_table_Z4_Prob_0pc$other_w7wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_other_prev$area <- as.factor('other')
z4_prob_0pc_other_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_other_prev$water <- as.factor('Dry')
names(z4_prob_0pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_w7wed_prev <- rbind(z4_prob_0pc_loading_prev,z4_prob_0pc_cleaning_prev,z4_prob_0pc_sorting_prev,z4_prob_0pc_tray_packing_prev,z4_prob_0pc_reject_prev,z4_prob_0pc_other_prev)

z4_prob_0pc_w7wed_wet_prev <- as.data.frame(z4_prob_0pc_loading_prev$prevalence*21/100+z4_prob_0pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_0pc_w7wed_wet_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_w7wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_0pc_w7wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_0pc_w7wed_dry_prev <- as.data.frame(z4_prob_0pc_sorting_prev$prevalence*20/100+z4_prob_0pc_reject_prev$prevalence*23/100+z4_prob_0pc_tray_packing_prev$prevalence*123/100+z4_prob_0pc_other_prev$prevalence*10/100)/176*100
z4_prob_0pc_w7wed_dry_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_w7wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_0pc_w7wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_0pc_w7wed_recombined_prev <- rbind(z4_prob_0pc_w7wed_wet_prev, z4_prob_0pc_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Z4_Prob_0pc$loading_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_loading_w8wed_conc_list <- append(z4_prob_0pc_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_loading_w8wed_conc_matrix <- matrix(unlist(z4_prob_0pc_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_cleaning_w8wed_conc_list <- append(z4_prob_0pc_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_cleaning_w8wed_conc_matrix <- matrix(unlist(z4_prob_0pc_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Z4_Prob_0pc$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# z4_prob_0pc_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   z4_prob_0pc_drying_w8wed_conc_list <- append(z4_prob_0pc_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Z4_Prob_0pc$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_sorting_w8wed_conc_list <- append(z4_prob_0pc_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_sorting_w8wed_conc_matrix <- matrix(unlist(z4_prob_0pc_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_tray_packing_w8wed_conc_list <- append(z4_prob_0pc_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_tray_packing_w8wed_conc_matrix <- matrix(unlist(z4_prob_0pc_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$reject_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_reject_w8wed_conc_list <- append(z4_prob_0pc_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_reject_w8wed_conc_matrix <- matrix(unlist(z4_prob_0pc_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Z4_Prob_0pc$other_w8wed_conc_list
vector <- vector[vector!='[]']
z4_prob_0pc_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  z4_prob_0pc_other_w8wed_conc_list <- append(z4_prob_0pc_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
z4_prob_0pc_other_w8wed_conc_matrix <- matrix(unlist(z4_prob_0pc_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

z4_prob_0pc_loading_concs <- as.data.frame(z4_prob_0pc_loading_w8wed_conc_list)
z4_prob_0pc_loading_concs$area <- as.factor('loading')
z4_prob_0pc_loading_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_loading_concs$water <- as.factor('Wet')
names(z4_prob_0pc_loading_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_cleaning_concs <- as.data.frame(z4_prob_0pc_cleaning_w8wed_conc_list)
z4_prob_0pc_cleaning_concs$area <- as.factor('cleaning')
z4_prob_0pc_cleaning_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_cleaning_concs$water <- as.factor('Wet')
names(z4_prob_0pc_cleaning_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_sorting_concs <- as.data.frame(z4_prob_0pc_sorting_w8wed_conc_list)
z4_prob_0pc_sorting_concs$area <- as.factor('sorting')
z4_prob_0pc_sorting_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_sorting_concs$water <- as.factor('Dry')
names(z4_prob_0pc_sorting_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_reject_concs <- as.data.frame(z4_prob_0pc_reject_w8wed_conc_list)
z4_prob_0pc_reject_concs$area <- as.factor('reject')
z4_prob_0pc_reject_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_reject_concs$water <- as.factor('Dry')
names(z4_prob_0pc_reject_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_tray_packing_concs <- as.data.frame(z4_prob_0pc_tray_packing_w8wed_conc_list)
z4_prob_0pc_tray_packing_concs$area <- as.factor('tray packing')
z4_prob_0pc_tray_packing_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_tray_packing_concs$water <- as.factor('Dry')
names(z4_prob_0pc_tray_packing_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_other_concs <- as.data.frame(z4_prob_0pc_other_w8wed_conc_list)
z4_prob_0pc_other_concs$area <- as.factor('other')
z4_prob_0pc_other_concs$scenario <- as.factor('PZ_04')
z4_prob_0pc_other_concs$water <- as.factor('Dry')
names(z4_prob_0pc_other_concs) <- c('concentration','area','scenario','water')

z4_prob_0pc_w8wed_concs <- rbind(z4_prob_0pc_loading_concs,z4_prob_0pc_cleaning_concs,z4_prob_0pc_sorting_concs,z4_prob_0pc_tray_packing_concs,z4_prob_0pc_reject_concs,z4_prob_0pc_other_concs)

z4_prob_0pc_loading_prev <- as.data.frame(NL_table_Z4_Prob_0pc$loading_w8wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_loading_prev$area <- as.factor('loading')
z4_prob_0pc_loading_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_loading_prev$water <- as.factor('Wet')
names(z4_prob_0pc_loading_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_cleaning_prev <- as.data.frame(NL_table_Z4_Prob_0pc$cleaning_w8wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_cleaning_prev$area <- as.factor('cleaning')
z4_prob_0pc_cleaning_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_cleaning_prev$water <- as.factor('Wet')
names(z4_prob_0pc_cleaning_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_sorting_prev <- as.data.frame(NL_table_Z4_Prob_0pc$sorting_w8wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_sorting_prev$area <- as.factor('sorting')
z4_prob_0pc_sorting_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_sorting_prev$water <- as.factor('Dry')
names(z4_prob_0pc_sorting_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_reject_prev <- as.data.frame(NL_table_Z4_Prob_0pc$reject_w8wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_reject_prev$area <- as.factor('reject')
z4_prob_0pc_reject_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_reject_prev$water <- as.factor('Dry')
names(z4_prob_0pc_reject_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_tray_packing_prev <- as.data.frame(NL_table_Z4_Prob_0pc$tray_packing_w8wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_tray_packing_prev$area <- as.factor('tray packing')
z4_prob_0pc_tray_packing_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_tray_packing_prev$water <- as.factor('Dry')
names(z4_prob_0pc_tray_packing_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_other_prev <- as.data.frame(NL_table_Z4_Prob_0pc$other_w8wed_prev[order(NL_table_Z4_Prob_0pc$local_seed)])
z4_prob_0pc_other_prev$area <- as.factor('other')
z4_prob_0pc_other_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_other_prev$water <- as.factor('Dry')
names(z4_prob_0pc_other_prev) <- c('prevalence','area','scenario','water')

z4_prob_0pc_w8wed_prev <- rbind(z4_prob_0pc_loading_prev,z4_prob_0pc_cleaning_prev,z4_prob_0pc_sorting_prev,z4_prob_0pc_tray_packing_prev,z4_prob_0pc_reject_prev,z4_prob_0pc_other_prev)

z4_prob_0pc_w8wed_wet_prev <- as.data.frame(z4_prob_0pc_loading_prev$prevalence*21/100+z4_prob_0pc_cleaning_prev$prevalence*28/100)/49*100
z4_prob_0pc_w8wed_wet_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_w8wed_wet_prev$water <- as.factor('Wet')
names(z4_prob_0pc_w8wed_wet_prev) <- c('prevalence','scenario','water')

z4_prob_0pc_w8wed_dry_prev <- as.data.frame(z4_prob_0pc_sorting_prev$prevalence*20/100+z4_prob_0pc_reject_prev$prevalence*23/100+z4_prob_0pc_tray_packing_prev$prevalence*123/100+z4_prob_0pc_other_prev$prevalence*10/100)/176*100
z4_prob_0pc_w8wed_dry_prev$scenario <- as.factor('PZ_04')
z4_prob_0pc_w8wed_dry_prev$water <- as.factor('Dry')
names(z4_prob_0pc_w8wed_dry_prev) <- c('prevalence','scenario','water')

z4_prob_0pc_w8wed_recombined_prev <- rbind(z4_prob_0pc_w8wed_wet_prev, z4_prob_0pc_w8wed_dry_prev)

vector <- NL_table_Z4_Prob_0pc$lifetime_conc_list[order(NL_table_Z4_Prob_0pc$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

z4_prob_0pc_w1wed_recombined_prev$week <- as.factor(1)
z4_prob_0pc_w2wed_recombined_prev$week <- as.factor(2)
z4_prob_0pc_w3wed_recombined_prev$week <- as.factor(3)
z4_prob_0pc_w4wed_recombined_prev$week <- as.factor(4)
z4_prob_0pc_w5wed_recombined_prev$week <- as.factor(5)
z4_prob_0pc_w6wed_recombined_prev$week <- as.factor(6)
z4_prob_0pc_w7wed_recombined_prev$week <- as.factor(7)
z4_prob_0pc_w8wed_recombined_prev$week <- as.factor(8)
z4_prob_0pc_allwed_prev <- rbind(z4_prob_0pc_w1wed_recombined_prev,z4_prob_0pc_w2wed_recombined_prev,z4_prob_0pc_w3wed_recombined_prev,z4_prob_0pc_w4wed_recombined_prev,z4_prob_0pc_w5wed_recombined_prev,z4_prob_0pc_w6wed_recombined_prev,z4_prob_0pc_w7wed_recombined_prev,z4_prob_0pc_w8wed_recombined_prev)

Facility_B_z4_prob_0pc_agents_melted <- melt(mdarray)
colnames(Facility_B_z4_prob_0pc_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_z4_prob_0pc_agents_melted$agent <- Facility_B_z4_prob_0pc_agents_melted$agent-1
Facility_B_z4_prob_0pc_agents_melted$logical <- Facility_B_z4_prob_0pc_agents_melted$value>0
Facility_B_z4_prob_0pc_agents_melted$binary <- as.numeric(Facility_B_z4_prob_0pc_agents_melted$logical)
Facility_B_z4_prob_0pc_agents_melted$log10value <- log10(Facility_B_z4_prob_0pc_agents_melted$value)
Facility_B_z4_prob_0pc_agents_melted$log10value[is.infinite(Facility_B_z4_prob_0pc_agents_melted$log10value)] <- 0

agent <- Facility_B_z4_prob_0pc_agents_melted$agent
iteration <- Facility_B_z4_prob_0pc_agents_melted$iteration
tick <- Facility_B_z4_prob_0pc_agents_melted$tick
rle_matrix <- tapply(Facility_B_z4_prob_0pc_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_z4_prob_0pc_agents_melted_mean_value_matrix <- tapply(Facility_B_z4_prob_0pc_agents_melted$value, list(agent, tick), mean)
Facility_B_z4_prob_0pc_agents_melted_median_value_matrix <- tapply(Facility_B_z4_prob_0pc_agents_melted$value, list(agent, tick), median)
Facility_B_z4_prob_0pc_agents_melted_prob_value_matrix <- tapply(Facility_B_z4_prob_0pc_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}
# durations$agent <- durations$agent-1

Facility_B_durations_z4_prob_0pc <- durations

agents_list_z4_prob_0pc <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_z4_prob_0pc <- agents_list_z4_prob_0pc[,c("V1","V7","V8","V9")]
colnames(agents_list_z4_prob_0pc) <- c("name","sanitation_status","schedule","area")
agents_list_z4_prob_0pc$ttp <- rep((168*2),225)
agents_list_z4_prob_0pc$ttp[agents_list_z4_prob_0pc$schedule=="daily"] <- (24*2)

agent <- 1
while(agent<=225) {
  agents_list_z4_prob_0pc$min_duration[agent] <- ifelse(length(Facility_B_durations_z4_prob_0pc$duration[Facility_B_durations_z4_prob_0pc$agent==agent])==0,NA,min(Facility_B_durations_z4_prob_0pc$duration[Facility_B_durations_z4_prob_0pc$agent==agent], na.rm = TRUE))
  agents_list_z4_prob_0pc$mean_duration[agent] <- ifelse(length(Facility_B_durations_z4_prob_0pc$duration[Facility_B_durations_z4_prob_0pc$agent==agent])==0,NA,mean(Facility_B_durations_z4_prob_0pc$duration[Facility_B_durations_z4_prob_0pc$agent==agent], na.rm = TRUE))
  agents_list_z4_prob_0pc$median_duration[agent] <- ifelse(length(Facility_B_durations_z4_prob_0pc$duration[Facility_B_durations_z4_prob_0pc$agent==agent])==0,NA,median(Facility_B_durations_z4_prob_0pc$duration[Facility_B_durations_z4_prob_0pc$agent==agent], na.rm = TRUE))
  agents_list_z4_prob_0pc$max_duration[agent] <- ifelse(length(Facility_B_durations_z4_prob_0pc$duration[Facility_B_durations_z4_prob_0pc$agent==agent])==0,NA,max(Facility_B_durations_z4_prob_0pc$duration[Facility_B_durations_z4_prob_0pc$agent==agent], na.rm = TRUE))
  agents_list_z4_prob_0pc$times_persistent[agent] <- sum(Facility_B_durations_z4_prob_0pc$duration[Facility_B_durations_z4_prob_0pc$agent==agent]>agents_list_z4_prob_0pc$ttp[agent])
  agent <- agent+1 
}

Facility_B_z4_prob_0pc_agents_melted_monday_preop <- Facility_B_z4_prob_0pc_agents_melted[which(Facility_B_z4_prob_0pc_agents_melted$tick==33|Facility_B_z4_prob_0pc_agents_melted$tick==201|Facility_B_z4_prob_0pc_agents_melted$tick==369|Facility_B_z4_prob_0pc_agents_melted$tick==537|Facility_B_z4_prob_0pc_agents_melted$tick==705|Facility_B_z4_prob_0pc_agents_melted$tick==873|Facility_B_z4_prob_0pc_agents_melted$tick==1041|Facility_B_z4_prob_0pc_agents_melted$tick==1209),]

Facility_B_z4_prob_0pc_agents_melted_tuesday_preop <- Facility_B_z4_prob_0pc_agents_melted[which(Facility_B_z4_prob_0pc_agents_melted$tick==57|Facility_B_z4_prob_0pc_agents_melted$tick==225|Facility_B_z4_prob_0pc_agents_melted$tick==393|Facility_B_z4_prob_0pc_agents_melted$tick==561|Facility_B_z4_prob_0pc_agents_melted$tick==729|Facility_B_z4_prob_0pc_agents_melted$tick==897|Facility_B_z4_prob_0pc_agents_melted$tick==1065|Facility_B_z4_prob_0pc_agents_melted$tick==1233),]

Facility_B_z4_prob_0pc_agents_melted_wednesday_preop <- Facility_B_z4_prob_0pc_agents_melted[which(Facility_B_z4_prob_0pc_agents_melted$tick==81|Facility_B_z4_prob_0pc_agents_melted$tick==249|Facility_B_z4_prob_0pc_agents_melted$tick==417|Facility_B_z4_prob_0pc_agents_melted$tick==585|Facility_B_z4_prob_0pc_agents_melted$tick==753|Facility_B_z4_prob_0pc_agents_melted$tick==921|Facility_B_z4_prob_0pc_agents_melted$tick==1089|Facility_B_z4_prob_0pc_agents_melted$tick==1257),]

Facility_B_z4_prob_0pc_agents_melted_thursday_preop <- Facility_B_z4_prob_0pc_agents_melted[which(Facility_B_z4_prob_0pc_agents_melted$tick==105|Facility_B_z4_prob_0pc_agents_melted$tick==273|Facility_B_z4_prob_0pc_agents_melted$tick==441|Facility_B_z4_prob_0pc_agents_melted$tick==609|Facility_B_z4_prob_0pc_agents_melted$tick==777|Facility_B_z4_prob_0pc_agents_melted$tick==945|Facility_B_z4_prob_0pc_agents_melted$tick==1113|Facility_B_z4_prob_0pc_agents_melted$tick==1281),]

Facility_B_z4_prob_0pc_agents_melted_friday_preop <- Facility_B_z4_prob_0pc_agents_melted[which(Facility_B_z4_prob_0pc_agents_melted$tick==129|Facility_B_z4_prob_0pc_agents_melted$tick==297|Facility_B_z4_prob_0pc_agents_melted$tick==465|Facility_B_z4_prob_0pc_agents_melted$tick==633|Facility_B_z4_prob_0pc_agents_melted$tick==801|Facility_B_z4_prob_0pc_agents_melted$tick==969|Facility_B_z4_prob_0pc_agents_melted$tick==1137|Facility_B_z4_prob_0pc_agents_melted$tick==1305),]

Facility_B_z4_prob_0pc_agents_melted_ff <- as.ffdf(Facility_B_z4_prob_0pc_agents_melted)
rm(Facility_B_z4_prob_0pc_agents_melted)
gc()
```

```{r import Full Risk-Based Intervention with Washing & Sanitation Intervention}
NL_table_Prob_Intervention <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-30-18-20 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_Risk-Based_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Prob_Intervention <- NL_table_Prob_Intervention[NL_table_Prob_Intervention$scenario==25,]

while (any(grepl('-', names(NL_table_Prob_Intervention), fixed = TRUE))) {
  NL_table_Prob_Intervention <- NL_table_Prob_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Prob_Intervention), fixed = TRUE))) {
  NL_table_Prob_Intervention <- NL_table_Prob_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Prob_Intervention), fixed = TRUE))) {
  NL_table_Prob_Intervention <- NL_table_Prob_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Prob_Intervention), fixed = TRUE))) {
  NL_table_Prob_Intervention <- NL_table_Prob_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Prob_Intervention[ , ..list_columns]

NL_table_Prob_Intervention[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Prob_Intervention <- as.data.frame(NL_table_Prob_Intervention)

NL_table_Prob_Intervention[NL_table_Prob_Intervention==-1] <- NA

NL_table_Prob_Intervention <- subset(NL_table_Prob_Intervention, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Prob_Intervention)[names(NL_table_Prob_Intervention)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Prob_Intervention)[names(NL_table_Prob_Intervention)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Prob_Intervention$loading_w1wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_loading_w1wed_conc_list <- append(prob_intervention_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_loading_w1wed_conc_matrix <- matrix(unlist(prob_intervention_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Prob_Intervention$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_cleaning_w1wed_conc_list <- append(prob_intervention_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_cleaning_w1wed_conc_matrix <- matrix(unlist(prob_intervention_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Prob_Intervention$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# prob_intervention_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   prob_intervention_drying_w1wed_conc_list <- append(prob_intervention_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Prob_Intervention$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_sorting_w1wed_conc_list <- append(prob_intervention_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_sorting_w1wed_conc_matrix <- matrix(unlist(prob_intervention_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Prob_Intervention$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_tray_packing_w1wed_conc_list <- append(prob_intervention_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_tray_packing_w1wed_conc_matrix <- matrix(unlist(prob_intervention_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Prob_Intervention$reject_w1wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_reject_w1wed_conc_list <- append(prob_intervention_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_reject_w1wed_conc_matrix <- matrix(unlist(prob_intervention_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Prob_Intervention$other_w1wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_other_w1wed_conc_list <- append(prob_intervention_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_other_w1wed_conc_matrix <- matrix(unlist(prob_intervention_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

prob_intervention_loading_concs <- as.data.frame(prob_intervention_loading_w1wed_conc_list)
prob_intervention_loading_concs$area <- as.factor('loading')
prob_intervention_loading_concs$scenario <- as.factor('AI_02')
prob_intervention_loading_concs$water <- as.factor('Wet')
names(prob_intervention_loading_concs) <- c('concentration','area','scenario','water')

prob_intervention_cleaning_concs <- as.data.frame(prob_intervention_cleaning_w1wed_conc_list)
prob_intervention_cleaning_concs$area <- as.factor('cleaning')
prob_intervention_cleaning_concs$scenario <- as.factor('AI_02')
prob_intervention_cleaning_concs$water <- as.factor('Wet')
names(prob_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

prob_intervention_sorting_concs <- as.data.frame(prob_intervention_sorting_w1wed_conc_list)
prob_intervention_sorting_concs$area <- as.factor('sorting')
prob_intervention_sorting_concs$scenario <- as.factor('AI_02')
prob_intervention_sorting_concs$water <- as.factor('Dry')
names(prob_intervention_sorting_concs) <- c('concentration','area','scenario','water')

prob_intervention_reject_concs <- as.data.frame(prob_intervention_reject_w1wed_conc_list)
prob_intervention_reject_concs$area <- as.factor('reject')
prob_intervention_reject_concs$scenario <- as.factor('AI_02')
prob_intervention_reject_concs$water <- as.factor('Dry')
names(prob_intervention_reject_concs) <- c('concentration','area','scenario','water')

prob_intervention_tray_packing_concs <- as.data.frame(prob_intervention_tray_packing_w1wed_conc_list)
prob_intervention_tray_packing_concs$area <- as.factor('tray packing')
prob_intervention_tray_packing_concs$scenario <- as.factor('AI_02')
prob_intervention_tray_packing_concs$water <- as.factor('Dry')
names(prob_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

prob_intervention_other_concs <- as.data.frame(prob_intervention_other_w1wed_conc_list)
prob_intervention_other_concs$area <- as.factor('other')
prob_intervention_other_concs$scenario <- as.factor('AI_02')
prob_intervention_other_concs$water <- as.factor('Dry')
names(prob_intervention_other_concs) <- c('concentration','area','scenario','water')

prob_intervention_w1wed_concs <- rbind(prob_intervention_loading_concs,prob_intervention_cleaning_concs,prob_intervention_sorting_concs,prob_intervention_tray_packing_concs,prob_intervention_reject_concs,prob_intervention_other_concs)

prob_intervention_loading_prev <- as.data.frame(NL_table_Prob_Intervention$loading_w1wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_loading_prev$area <- as.factor('loading')
prob_intervention_loading_prev$scenario <- as.factor('AI_02')
prob_intervention_loading_prev$water <- as.factor('Wet')
names(prob_intervention_loading_prev) <- c('prevalence','area','scenario','water')

prob_intervention_cleaning_prev <- as.data.frame(NL_table_Prob_Intervention$cleaning_w1wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_cleaning_prev$area <- as.factor('cleaning')
prob_intervention_cleaning_prev$scenario <- as.factor('AI_02')
prob_intervention_cleaning_prev$water <- as.factor('Wet')
names(prob_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

prob_intervention_sorting_prev <- as.data.frame(NL_table_Prob_Intervention$sorting_w1wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_sorting_prev$area <- as.factor('sorting')
prob_intervention_sorting_prev$scenario <- as.factor('AI_02')
prob_intervention_sorting_prev$water <- as.factor('Dry')
names(prob_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

prob_intervention_reject_prev <- as.data.frame(NL_table_Prob_Intervention$reject_w1wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_reject_prev$area <- as.factor('reject')
prob_intervention_reject_prev$scenario <- as.factor('AI_02')
prob_intervention_reject_prev$water <- as.factor('Dry')
names(prob_intervention_reject_prev) <- c('prevalence','area','scenario','water')

prob_intervention_tray_packing_prev <- as.data.frame(NL_table_Prob_Intervention$tray_packing_w1wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_tray_packing_prev$area <- as.factor('tray packing')
prob_intervention_tray_packing_prev$scenario <- as.factor('AI_02')
prob_intervention_tray_packing_prev$water <- as.factor('Dry')
names(prob_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

prob_intervention_other_prev <- as.data.frame(NL_table_Prob_Intervention$other_w1wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_other_prev$area <- as.factor('other')
prob_intervention_other_prev$scenario <- as.factor('AI_02')
prob_intervention_other_prev$water <- as.factor('Dry')
names(prob_intervention_other_prev) <- c('prevalence','area','scenario','water')

prob_intervention_w1wed_prev <- rbind(prob_intervention_loading_prev,prob_intervention_cleaning_prev,prob_intervention_sorting_prev,prob_intervention_tray_packing_prev,prob_intervention_reject_prev,prob_intervention_other_prev)

prob_intervention_w1wed_wet_prev <- as.data.frame(prob_intervention_loading_prev$prevalence*21/100+prob_intervention_cleaning_prev$prevalence*28/100)/49*100
prob_intervention_w1wed_wet_prev$scenario <- as.factor('AI_02')
prob_intervention_w1wed_wet_prev$water <- as.factor('Wet')
names(prob_intervention_w1wed_wet_prev) <- c('prevalence','scenario','water')

prob_intervention_w1wed_dry_prev <- as.data.frame(prob_intervention_sorting_prev$prevalence*20/100+prob_intervention_reject_prev$prevalence*23/100+prob_intervention_tray_packing_prev$prevalence*123/100+prob_intervention_other_prev$prevalence*10/100)/176*100
prob_intervention_w1wed_dry_prev$scenario <- as.factor('AI_02')
prob_intervention_w1wed_dry_prev$water <- as.factor('Dry')
names(prob_intervention_w1wed_dry_prev) <- c('prevalence','scenario','water')

prob_intervention_w1wed_recombined_prev <- rbind(prob_intervention_w1wed_wet_prev, prob_intervention_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Prob_Intervention$loading_w2wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_loading_w2wed_conc_list <- append(prob_intervention_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_loading_w2wed_conc_matrix <- matrix(unlist(prob_intervention_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Prob_Intervention$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_cleaning_w2wed_conc_list <- append(prob_intervention_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_cleaning_w2wed_conc_matrix <- matrix(unlist(prob_intervention_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Prob_Intervention$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# prob_intervention_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   prob_intervention_drying_w2wed_conc_list <- append(prob_intervention_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Prob_Intervention$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_sorting_w2wed_conc_list <- append(prob_intervention_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_sorting_w2wed_conc_matrix <- matrix(unlist(prob_intervention_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Prob_Intervention$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_tray_packing_w2wed_conc_list <- append(prob_intervention_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_tray_packing_w2wed_conc_matrix <- matrix(unlist(prob_intervention_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Prob_Intervention$reject_w2wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_reject_w2wed_conc_list <- append(prob_intervention_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_reject_w2wed_conc_matrix <- matrix(unlist(prob_intervention_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Prob_Intervention$other_w2wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_other_w2wed_conc_list <- append(prob_intervention_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_other_w2wed_conc_matrix <- matrix(unlist(prob_intervention_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

prob_intervention_loading_concs <- as.data.frame(prob_intervention_loading_w2wed_conc_list)
prob_intervention_loading_concs$area <- as.factor('loading')
prob_intervention_loading_concs$scenario <- as.factor('AI_02')
prob_intervention_loading_concs$water <- as.factor('Wet')
names(prob_intervention_loading_concs) <- c('concentration','area','scenario','water')

prob_intervention_cleaning_concs <- as.data.frame(prob_intervention_cleaning_w2wed_conc_list)
prob_intervention_cleaning_concs$area <- as.factor('cleaning')
prob_intervention_cleaning_concs$scenario <- as.factor('AI_02')
prob_intervention_cleaning_concs$water <- as.factor('Wet')
names(prob_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

prob_intervention_sorting_concs <- as.data.frame(prob_intervention_sorting_w2wed_conc_list)
prob_intervention_sorting_concs$area <- as.factor('sorting')
prob_intervention_sorting_concs$scenario <- as.factor('AI_02')
prob_intervention_sorting_concs$water <- as.factor('Dry')
names(prob_intervention_sorting_concs) <- c('concentration','area','scenario','water')

prob_intervention_reject_concs <- as.data.frame(prob_intervention_reject_w2wed_conc_list)
prob_intervention_reject_concs$area <- as.factor('reject')
prob_intervention_reject_concs$scenario <- as.factor('AI_02')
prob_intervention_reject_concs$water <- as.factor('Dry')
names(prob_intervention_reject_concs) <- c('concentration','area','scenario','water')

prob_intervention_tray_packing_concs <- as.data.frame(prob_intervention_tray_packing_w2wed_conc_list)
prob_intervention_tray_packing_concs$area <- as.factor('tray packing')
prob_intervention_tray_packing_concs$scenario <- as.factor('AI_02')
prob_intervention_tray_packing_concs$water <- as.factor('Dry')
names(prob_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

prob_intervention_other_concs <- as.data.frame(prob_intervention_other_w2wed_conc_list)
prob_intervention_other_concs$area <- as.factor('other')
prob_intervention_other_concs$scenario <- as.factor('AI_02')
prob_intervention_other_concs$water <- as.factor('Dry')
names(prob_intervention_other_concs) <- c('concentration','area','scenario','water')

prob_intervention_w2wed_concs <- rbind(prob_intervention_loading_concs,prob_intervention_cleaning_concs,prob_intervention_sorting_concs,prob_intervention_tray_packing_concs,prob_intervention_reject_concs,prob_intervention_other_concs)

prob_intervention_loading_prev <- as.data.frame(NL_table_Prob_Intervention$loading_w2wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_loading_prev$area <- as.factor('loading')
prob_intervention_loading_prev$scenario <- as.factor('AI_02')
prob_intervention_loading_prev$water <- as.factor('Wet')
names(prob_intervention_loading_prev) <- c('prevalence','area','scenario','water')

prob_intervention_cleaning_prev <- as.data.frame(NL_table_Prob_Intervention$cleaning_w2wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_cleaning_prev$area <- as.factor('cleaning')
prob_intervention_cleaning_prev$scenario <- as.factor('AI_02')
prob_intervention_cleaning_prev$water <- as.factor('Wet')
names(prob_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

prob_intervention_sorting_prev <- as.data.frame(NL_table_Prob_Intervention$sorting_w2wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_sorting_prev$area <- as.factor('sorting')
prob_intervention_sorting_prev$scenario <- as.factor('AI_02')
prob_intervention_sorting_prev$water <- as.factor('Dry')
names(prob_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

prob_intervention_reject_prev <- as.data.frame(NL_table_Prob_Intervention$reject_w2wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_reject_prev$area <- as.factor('reject')
prob_intervention_reject_prev$scenario <- as.factor('AI_02')
prob_intervention_reject_prev$water <- as.factor('Dry')
names(prob_intervention_reject_prev) <- c('prevalence','area','scenario','water')

prob_intervention_tray_packing_prev <- as.data.frame(NL_table_Prob_Intervention$tray_packing_w2wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_tray_packing_prev$area <- as.factor('tray packing')
prob_intervention_tray_packing_prev$scenario <- as.factor('AI_02')
prob_intervention_tray_packing_prev$water <- as.factor('Dry')
names(prob_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

prob_intervention_other_prev <- as.data.frame(NL_table_Prob_Intervention$other_w2wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_other_prev$area <- as.factor('other')
prob_intervention_other_prev$scenario <- as.factor('AI_02')
prob_intervention_other_prev$water <- as.factor('Dry')
names(prob_intervention_other_prev) <- c('prevalence','area','scenario','water')

prob_intervention_w2wed_prev <- rbind(prob_intervention_loading_prev,prob_intervention_cleaning_prev,prob_intervention_sorting_prev,prob_intervention_tray_packing_prev,prob_intervention_reject_prev,prob_intervention_other_prev)

prob_intervention_w2wed_wet_prev <- as.data.frame(prob_intervention_loading_prev$prevalence*21/100+prob_intervention_cleaning_prev$prevalence*28/100)/49*100
prob_intervention_w2wed_wet_prev$scenario <- as.factor('AI_02')
prob_intervention_w2wed_wet_prev$water <- as.factor('Wet')
names(prob_intervention_w2wed_wet_prev) <- c('prevalence','scenario','water')

prob_intervention_w2wed_dry_prev <- as.data.frame(prob_intervention_sorting_prev$prevalence*20/100+prob_intervention_reject_prev$prevalence*23/100+prob_intervention_tray_packing_prev$prevalence*123/100+prob_intervention_other_prev$prevalence*10/100)/176*100
prob_intervention_w2wed_dry_prev$scenario <- as.factor('AI_02')
prob_intervention_w2wed_dry_prev$water <- as.factor('Dry')
names(prob_intervention_w2wed_dry_prev) <- c('prevalence','scenario','water')

prob_intervention_w2wed_recombined_prev <- rbind(prob_intervention_w2wed_wet_prev, prob_intervention_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Prob_Intervention$loading_w3wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_loading_w3wed_conc_list <- append(prob_intervention_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_loading_w3wed_conc_matrix <- matrix(unlist(prob_intervention_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Prob_Intervention$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_cleaning_w3wed_conc_list <- append(prob_intervention_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_cleaning_w3wed_conc_matrix <- matrix(unlist(prob_intervention_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Prob_Intervention$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# prob_intervention_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   prob_intervention_drying_w3wed_conc_list <- append(prob_intervention_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Prob_Intervention$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_sorting_w3wed_conc_list <- append(prob_intervention_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_sorting_w3wed_conc_matrix <- matrix(unlist(prob_intervention_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Prob_Intervention$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_tray_packing_w3wed_conc_list <- append(prob_intervention_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_tray_packing_w3wed_conc_matrix <- matrix(unlist(prob_intervention_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Prob_Intervention$reject_w3wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_reject_w3wed_conc_list <- append(prob_intervention_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_reject_w3wed_conc_matrix <- matrix(unlist(prob_intervention_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Prob_Intervention$other_w3wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_other_w3wed_conc_list <- append(prob_intervention_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_other_w3wed_conc_matrix <- matrix(unlist(prob_intervention_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

prob_intervention_loading_concs <- as.data.frame(prob_intervention_loading_w3wed_conc_list)
prob_intervention_loading_concs$area <- as.factor('loading')
prob_intervention_loading_concs$scenario <- as.factor('AI_02')
prob_intervention_loading_concs$water <- as.factor('Wet')
names(prob_intervention_loading_concs) <- c('concentration','area','scenario','water')

prob_intervention_cleaning_concs <- as.data.frame(prob_intervention_cleaning_w3wed_conc_list)
prob_intervention_cleaning_concs$area <- as.factor('cleaning')
prob_intervention_cleaning_concs$scenario <- as.factor('AI_02')
prob_intervention_cleaning_concs$water <- as.factor('Wet')
names(prob_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

prob_intervention_sorting_concs <- as.data.frame(prob_intervention_sorting_w3wed_conc_list)
prob_intervention_sorting_concs$area <- as.factor('sorting')
prob_intervention_sorting_concs$scenario <- as.factor('AI_02')
prob_intervention_sorting_concs$water <- as.factor('Dry')
names(prob_intervention_sorting_concs) <- c('concentration','area','scenario','water')

prob_intervention_reject_concs <- as.data.frame(prob_intervention_reject_w3wed_conc_list)
prob_intervention_reject_concs$area <- as.factor('reject')
prob_intervention_reject_concs$scenario <- as.factor('AI_02')
prob_intervention_reject_concs$water <- as.factor('Dry')
names(prob_intervention_reject_concs) <- c('concentration','area','scenario','water')

prob_intervention_tray_packing_concs <- as.data.frame(prob_intervention_tray_packing_w3wed_conc_list)
prob_intervention_tray_packing_concs$area <- as.factor('tray packing')
prob_intervention_tray_packing_concs$scenario <- as.factor('AI_02')
prob_intervention_tray_packing_concs$water <- as.factor('Dry')
names(prob_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

prob_intervention_other_concs <- as.data.frame(prob_intervention_other_w3wed_conc_list)
prob_intervention_other_concs$area <- as.factor('other')
prob_intervention_other_concs$scenario <- as.factor('AI_02')
prob_intervention_other_concs$water <- as.factor('Dry')
names(prob_intervention_other_concs) <- c('concentration','area','scenario','water')

prob_intervention_w3wed_concs <- rbind(prob_intervention_loading_concs,prob_intervention_cleaning_concs,prob_intervention_sorting_concs,prob_intervention_tray_packing_concs,prob_intervention_reject_concs,prob_intervention_other_concs)

prob_intervention_loading_prev <- as.data.frame(NL_table_Prob_Intervention$loading_w3wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_loading_prev$area <- as.factor('loading')
prob_intervention_loading_prev$scenario <- as.factor('AI_02')
prob_intervention_loading_prev$water <- as.factor('Wet')
names(prob_intervention_loading_prev) <- c('prevalence','area','scenario','water')

prob_intervention_cleaning_prev <- as.data.frame(NL_table_Prob_Intervention$cleaning_w3wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_cleaning_prev$area <- as.factor('cleaning')
prob_intervention_cleaning_prev$scenario <- as.factor('AI_02')
prob_intervention_cleaning_prev$water <- as.factor('Wet')
names(prob_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

prob_intervention_sorting_prev <- as.data.frame(NL_table_Prob_Intervention$sorting_w3wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_sorting_prev$area <- as.factor('sorting')
prob_intervention_sorting_prev$scenario <- as.factor('AI_02')
prob_intervention_sorting_prev$water <- as.factor('Dry')
names(prob_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

prob_intervention_reject_prev <- as.data.frame(NL_table_Prob_Intervention$reject_w3wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_reject_prev$area <- as.factor('reject')
prob_intervention_reject_prev$scenario <- as.factor('AI_02')
prob_intervention_reject_prev$water <- as.factor('Dry')
names(prob_intervention_reject_prev) <- c('prevalence','area','scenario','water')

prob_intervention_tray_packing_prev <- as.data.frame(NL_table_Prob_Intervention$tray_packing_w3wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_tray_packing_prev$area <- as.factor('tray packing')
prob_intervention_tray_packing_prev$scenario <- as.factor('AI_02')
prob_intervention_tray_packing_prev$water <- as.factor('Dry')
names(prob_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

prob_intervention_other_prev <- as.data.frame(NL_table_Prob_Intervention$other_w3wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_other_prev$area <- as.factor('other')
prob_intervention_other_prev$scenario <- as.factor('AI_02')
prob_intervention_other_prev$water <- as.factor('Dry')
names(prob_intervention_other_prev) <- c('prevalence','area','scenario','water')

prob_intervention_w3wed_prev <- rbind(prob_intervention_loading_prev,prob_intervention_cleaning_prev,prob_intervention_sorting_prev,prob_intervention_tray_packing_prev,prob_intervention_reject_prev,prob_intervention_other_prev)

prob_intervention_w3wed_wet_prev <- as.data.frame(prob_intervention_loading_prev$prevalence*21/100+prob_intervention_cleaning_prev$prevalence*28/100)/49*100
prob_intervention_w3wed_wet_prev$scenario <- as.factor('AI_02')
prob_intervention_w3wed_wet_prev$water <- as.factor('Wet')
names(prob_intervention_w3wed_wet_prev) <- c('prevalence','scenario','water')

prob_intervention_w3wed_dry_prev <- as.data.frame(prob_intervention_sorting_prev$prevalence*20/100+prob_intervention_reject_prev$prevalence*23/100+prob_intervention_tray_packing_prev$prevalence*123/100+prob_intervention_other_prev$prevalence*10/100)/176*100
prob_intervention_w3wed_dry_prev$scenario <- as.factor('AI_02')
prob_intervention_w3wed_dry_prev$water <- as.factor('Dry')
names(prob_intervention_w3wed_dry_prev) <- c('prevalence','scenario','water')

prob_intervention_w3wed_recombined_prev <- rbind(prob_intervention_w3wed_wet_prev, prob_intervention_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Prob_Intervention$loading_w4wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_loading_w4wed_conc_list <- append(prob_intervention_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_loading_w4wed_conc_matrix <- matrix(unlist(prob_intervention_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Prob_Intervention$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_cleaning_w4wed_conc_list <- append(prob_intervention_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_cleaning_w4wed_conc_matrix <- matrix(unlist(prob_intervention_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Prob_Intervention$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# prob_intervention_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   prob_intervention_drying_w4wed_conc_list <- append(prob_intervention_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Prob_Intervention$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_sorting_w4wed_conc_list <- append(prob_intervention_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_sorting_w4wed_conc_matrix <- matrix(unlist(prob_intervention_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Prob_Intervention$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_tray_packing_w4wed_conc_list <- append(prob_intervention_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_tray_packing_w4wed_conc_matrix <- matrix(unlist(prob_intervention_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Prob_Intervention$reject_w4wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_reject_w4wed_conc_list <- append(prob_intervention_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_reject_w4wed_conc_matrix <- matrix(unlist(prob_intervention_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Prob_Intervention$other_w4wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_other_w4wed_conc_list <- append(prob_intervention_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_other_w4wed_conc_matrix <- matrix(unlist(prob_intervention_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

prob_intervention_loading_concs <- as.data.frame(prob_intervention_loading_w4wed_conc_list)
prob_intervention_loading_concs$area <- as.factor('loading')
prob_intervention_loading_concs$scenario <- as.factor('AI_02')
prob_intervention_loading_concs$water <- as.factor('Wet')
names(prob_intervention_loading_concs) <- c('concentration','area','scenario','water')

prob_intervention_cleaning_concs <- as.data.frame(prob_intervention_cleaning_w4wed_conc_list)
prob_intervention_cleaning_concs$area <- as.factor('cleaning')
prob_intervention_cleaning_concs$scenario <- as.factor('AI_02')
prob_intervention_cleaning_concs$water <- as.factor('Wet')
names(prob_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

prob_intervention_sorting_concs <- as.data.frame(prob_intervention_sorting_w4wed_conc_list)
prob_intervention_sorting_concs$area <- as.factor('sorting')
prob_intervention_sorting_concs$scenario <- as.factor('AI_02')
prob_intervention_sorting_concs$water <- as.factor('Dry')
names(prob_intervention_sorting_concs) <- c('concentration','area','scenario','water')

prob_intervention_reject_concs <- as.data.frame(prob_intervention_reject_w4wed_conc_list)
prob_intervention_reject_concs$area <- as.factor('reject')
prob_intervention_reject_concs$scenario <- as.factor('AI_02')
prob_intervention_reject_concs$water <- as.factor('Dry')
names(prob_intervention_reject_concs) <- c('concentration','area','scenario','water')

prob_intervention_tray_packing_concs <- as.data.frame(prob_intervention_tray_packing_w4wed_conc_list)
prob_intervention_tray_packing_concs$area <- as.factor('tray packing')
prob_intervention_tray_packing_concs$scenario <- as.factor('AI_02')
prob_intervention_tray_packing_concs$water <- as.factor('Dry')
names(prob_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

prob_intervention_other_concs <- as.data.frame(prob_intervention_other_w4wed_conc_list)
prob_intervention_other_concs$area <- as.factor('other')
prob_intervention_other_concs$scenario <- as.factor('AI_02')
prob_intervention_other_concs$water <- as.factor('Dry')
names(prob_intervention_other_concs) <- c('concentration','area','scenario','water')

prob_intervention_w4wed_concs <- rbind(prob_intervention_loading_concs,prob_intervention_cleaning_concs,prob_intervention_sorting_concs,prob_intervention_tray_packing_concs,prob_intervention_reject_concs,prob_intervention_other_concs)

prob_intervention_loading_prev <- as.data.frame(NL_table_Prob_Intervention$loading_w4wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_loading_prev$area <- as.factor('loading')
prob_intervention_loading_prev$scenario <- as.factor('AI_02')
prob_intervention_loading_prev$water <- as.factor('Wet')
names(prob_intervention_loading_prev) <- c('prevalence','area','scenario','water')

prob_intervention_cleaning_prev <- as.data.frame(NL_table_Prob_Intervention$cleaning_w4wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_cleaning_prev$area <- as.factor('cleaning')
prob_intervention_cleaning_prev$scenario <- as.factor('AI_02')
prob_intervention_cleaning_prev$water <- as.factor('Wet')
names(prob_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

prob_intervention_sorting_prev <- as.data.frame(NL_table_Prob_Intervention$sorting_w4wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_sorting_prev$area <- as.factor('sorting')
prob_intervention_sorting_prev$scenario <- as.factor('AI_02')
prob_intervention_sorting_prev$water <- as.factor('Dry')
names(prob_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

prob_intervention_reject_prev <- as.data.frame(NL_table_Prob_Intervention$reject_w4wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_reject_prev$area <- as.factor('reject')
prob_intervention_reject_prev$scenario <- as.factor('AI_02')
prob_intervention_reject_prev$water <- as.factor('Dry')
names(prob_intervention_reject_prev) <- c('prevalence','area','scenario','water')

prob_intervention_tray_packing_prev <- as.data.frame(NL_table_Prob_Intervention$tray_packing_w4wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_tray_packing_prev$area <- as.factor('tray packing')
prob_intervention_tray_packing_prev$scenario <- as.factor('AI_02')
prob_intervention_tray_packing_prev$water <- as.factor('Dry')
names(prob_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

prob_intervention_other_prev <- as.data.frame(NL_table_Prob_Intervention$other_w4wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_other_prev$area <- as.factor('other')
prob_intervention_other_prev$scenario <- as.factor('AI_02')
prob_intervention_other_prev$water <- as.factor('Dry')
names(prob_intervention_other_prev) <- c('prevalence','area','scenario','water')

prob_intervention_w4wed_prev <- rbind(prob_intervention_loading_prev,prob_intervention_cleaning_prev,prob_intervention_sorting_prev,prob_intervention_tray_packing_prev,prob_intervention_reject_prev,prob_intervention_other_prev)

prob_intervention_w4wed_wet_prev <- as.data.frame(prob_intervention_loading_prev$prevalence*21/100+prob_intervention_cleaning_prev$prevalence*28/100)/49*100
prob_intervention_w4wed_wet_prev$scenario <- as.factor('AI_02')
prob_intervention_w4wed_wet_prev$water <- as.factor('Wet')
names(prob_intervention_w4wed_wet_prev) <- c('prevalence','scenario','water')

prob_intervention_w4wed_dry_prev <- as.data.frame(prob_intervention_sorting_prev$prevalence*20/100+prob_intervention_reject_prev$prevalence*23/100+prob_intervention_tray_packing_prev$prevalence*123/100+prob_intervention_other_prev$prevalence*10/100)/176*100
prob_intervention_w4wed_dry_prev$scenario <- as.factor('AI_02')
prob_intervention_w4wed_dry_prev$water <- as.factor('Dry')
names(prob_intervention_w4wed_dry_prev) <- c('prevalence','scenario','water')

prob_intervention_w4wed_recombined_prev <- rbind(prob_intervention_w4wed_wet_prev, prob_intervention_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Prob_Intervention$loading_w5wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_loading_w5wed_conc_list <- append(prob_intervention_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_loading_w5wed_conc_matrix <- matrix(unlist(prob_intervention_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Prob_Intervention$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_cleaning_w5wed_conc_list <- append(prob_intervention_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_cleaning_w5wed_conc_matrix <- matrix(unlist(prob_intervention_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Prob_Intervention$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# prob_intervention_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   prob_intervention_drying_w5wed_conc_list <- append(prob_intervention_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Prob_Intervention$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_sorting_w5wed_conc_list <- append(prob_intervention_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_sorting_w5wed_conc_matrix <- matrix(unlist(prob_intervention_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Prob_Intervention$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_tray_packing_w5wed_conc_list <- append(prob_intervention_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_tray_packing_w5wed_conc_matrix <- matrix(unlist(prob_intervention_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Prob_Intervention$reject_w5wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_reject_w5wed_conc_list <- append(prob_intervention_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_reject_w5wed_conc_matrix <- matrix(unlist(prob_intervention_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Prob_Intervention$other_w5wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_other_w5wed_conc_list <- append(prob_intervention_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_other_w5wed_conc_matrix <- matrix(unlist(prob_intervention_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

prob_intervention_loading_concs <- as.data.frame(prob_intervention_loading_w5wed_conc_list)
prob_intervention_loading_concs$area <- as.factor('loading')
prob_intervention_loading_concs$scenario <- as.factor('AI_02')
prob_intervention_loading_concs$water <- as.factor('Wet')
names(prob_intervention_loading_concs) <- c('concentration','area','scenario','water')

prob_intervention_cleaning_concs <- as.data.frame(prob_intervention_cleaning_w5wed_conc_list)
prob_intervention_cleaning_concs$area <- as.factor('cleaning')
prob_intervention_cleaning_concs$scenario <- as.factor('AI_02')
prob_intervention_cleaning_concs$water <- as.factor('Wet')
names(prob_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

prob_intervention_sorting_concs <- as.data.frame(prob_intervention_sorting_w5wed_conc_list)
prob_intervention_sorting_concs$area <- as.factor('sorting')
prob_intervention_sorting_concs$scenario <- as.factor('AI_02')
prob_intervention_sorting_concs$water <- as.factor('Dry')
names(prob_intervention_sorting_concs) <- c('concentration','area','scenario','water')

prob_intervention_reject_concs <- as.data.frame(prob_intervention_reject_w5wed_conc_list)
prob_intervention_reject_concs$area <- as.factor('reject')
prob_intervention_reject_concs$scenario <- as.factor('AI_02')
prob_intervention_reject_concs$water <- as.factor('Dry')
names(prob_intervention_reject_concs) <- c('concentration','area','scenario','water')

prob_intervention_tray_packing_concs <- as.data.frame(prob_intervention_tray_packing_w5wed_conc_list)
prob_intervention_tray_packing_concs$area <- as.factor('tray packing')
prob_intervention_tray_packing_concs$scenario <- as.factor('AI_02')
prob_intervention_tray_packing_concs$water <- as.factor('Dry')
names(prob_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

prob_intervention_other_concs <- as.data.frame(prob_intervention_other_w5wed_conc_list)
prob_intervention_other_concs$area <- as.factor('other')
prob_intervention_other_concs$scenario <- as.factor('AI_02')
prob_intervention_other_concs$water <- as.factor('Dry')
names(prob_intervention_other_concs) <- c('concentration','area','scenario','water')

prob_intervention_w5wed_concs <- rbind(prob_intervention_loading_concs,prob_intervention_cleaning_concs,prob_intervention_sorting_concs,prob_intervention_tray_packing_concs,prob_intervention_reject_concs,prob_intervention_other_concs)

prob_intervention_loading_prev <- as.data.frame(NL_table_Prob_Intervention$loading_w5wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_loading_prev$area <- as.factor('loading')
prob_intervention_loading_prev$scenario <- as.factor('AI_02')
prob_intervention_loading_prev$water <- as.factor('Wet')
names(prob_intervention_loading_prev) <- c('prevalence','area','scenario','water')

prob_intervention_cleaning_prev <- as.data.frame(NL_table_Prob_Intervention$cleaning_w5wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_cleaning_prev$area <- as.factor('cleaning')
prob_intervention_cleaning_prev$scenario <- as.factor('AI_02')
prob_intervention_cleaning_prev$water <- as.factor('Wet')
names(prob_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

prob_intervention_sorting_prev <- as.data.frame(NL_table_Prob_Intervention$sorting_w5wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_sorting_prev$area <- as.factor('sorting')
prob_intervention_sorting_prev$scenario <- as.factor('AI_02')
prob_intervention_sorting_prev$water <- as.factor('Dry')
names(prob_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

prob_intervention_reject_prev <- as.data.frame(NL_table_Prob_Intervention$reject_w5wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_reject_prev$area <- as.factor('reject')
prob_intervention_reject_prev$scenario <- as.factor('AI_02')
prob_intervention_reject_prev$water <- as.factor('Dry')
names(prob_intervention_reject_prev) <- c('prevalence','area','scenario','water')

prob_intervention_tray_packing_prev <- as.data.frame(NL_table_Prob_Intervention$tray_packing_w5wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_tray_packing_prev$area <- as.factor('tray packing')
prob_intervention_tray_packing_prev$scenario <- as.factor('AI_02')
prob_intervention_tray_packing_prev$water <- as.factor('Dry')
names(prob_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

prob_intervention_other_prev <- as.data.frame(NL_table_Prob_Intervention$other_w5wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_other_prev$area <- as.factor('other')
prob_intervention_other_prev$scenario <- as.factor('AI_02')
prob_intervention_other_prev$water <- as.factor('Dry')
names(prob_intervention_other_prev) <- c('prevalence','area','scenario','water')

prob_intervention_w5wed_prev <- rbind(prob_intervention_loading_prev,prob_intervention_cleaning_prev,prob_intervention_sorting_prev,prob_intervention_tray_packing_prev,prob_intervention_reject_prev,prob_intervention_other_prev)

prob_intervention_w5wed_wet_prev <- as.data.frame(prob_intervention_loading_prev$prevalence*21/100+prob_intervention_cleaning_prev$prevalence*28/100)/49*100
prob_intervention_w5wed_wet_prev$scenario <- as.factor('AI_02')
prob_intervention_w5wed_wet_prev$water <- as.factor('Wet')
names(prob_intervention_w5wed_wet_prev) <- c('prevalence','scenario','water')

prob_intervention_w5wed_dry_prev <- as.data.frame(prob_intervention_sorting_prev$prevalence*20/100+prob_intervention_reject_prev$prevalence*23/100+prob_intervention_tray_packing_prev$prevalence*123/100+prob_intervention_other_prev$prevalence*10/100)/176*100
prob_intervention_w5wed_dry_prev$scenario <- as.factor('AI_02')
prob_intervention_w5wed_dry_prev$water <- as.factor('Dry')
names(prob_intervention_w5wed_dry_prev) <- c('prevalence','scenario','water')

prob_intervention_w5wed_recombined_prev <- rbind(prob_intervention_w5wed_wet_prev, prob_intervention_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Prob_Intervention$loading_w6wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_loading_w6wed_conc_list <- append(prob_intervention_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_loading_w6wed_conc_matrix <- matrix(unlist(prob_intervention_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Prob_Intervention$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_cleaning_w6wed_conc_list <- append(prob_intervention_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_cleaning_w6wed_conc_matrix <- matrix(unlist(prob_intervention_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Prob_Intervention$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# prob_intervention_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   prob_intervention_drying_w6wed_conc_list <- append(prob_intervention_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Prob_Intervention$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_sorting_w6wed_conc_list <- append(prob_intervention_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_sorting_w6wed_conc_matrix <- matrix(unlist(prob_intervention_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Prob_Intervention$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_tray_packing_w6wed_conc_list <- append(prob_intervention_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_tray_packing_w6wed_conc_matrix <- matrix(unlist(prob_intervention_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Prob_Intervention$reject_w6wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_reject_w6wed_conc_list <- append(prob_intervention_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_reject_w6wed_conc_matrix <- matrix(unlist(prob_intervention_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Prob_Intervention$other_w6wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_other_w6wed_conc_list <- append(prob_intervention_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_other_w6wed_conc_matrix <- matrix(unlist(prob_intervention_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

prob_intervention_loading_concs <- as.data.frame(prob_intervention_loading_w6wed_conc_list)
prob_intervention_loading_concs$area <- as.factor('loading')
prob_intervention_loading_concs$scenario <- as.factor('AI_02')
prob_intervention_loading_concs$water <- as.factor('Wet')
names(prob_intervention_loading_concs) <- c('concentration','area','scenario','water')

prob_intervention_cleaning_concs <- as.data.frame(prob_intervention_cleaning_w6wed_conc_list)
prob_intervention_cleaning_concs$area <- as.factor('cleaning')
prob_intervention_cleaning_concs$scenario <- as.factor('AI_02')
prob_intervention_cleaning_concs$water <- as.factor('Wet')
names(prob_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

prob_intervention_sorting_concs <- as.data.frame(prob_intervention_sorting_w6wed_conc_list)
prob_intervention_sorting_concs$area <- as.factor('sorting')
prob_intervention_sorting_concs$scenario <- as.factor('AI_02')
prob_intervention_sorting_concs$water <- as.factor('Dry')
names(prob_intervention_sorting_concs) <- c('concentration','area','scenario','water')

prob_intervention_reject_concs <- as.data.frame(prob_intervention_reject_w6wed_conc_list)
prob_intervention_reject_concs$area <- as.factor('reject')
prob_intervention_reject_concs$scenario <- as.factor('AI_02')
prob_intervention_reject_concs$water <- as.factor('Dry')
names(prob_intervention_reject_concs) <- c('concentration','area','scenario','water')

prob_intervention_tray_packing_concs <- as.data.frame(prob_intervention_tray_packing_w6wed_conc_list)
prob_intervention_tray_packing_concs$area <- as.factor('tray packing')
prob_intervention_tray_packing_concs$scenario <- as.factor('AI_02')
prob_intervention_tray_packing_concs$water <- as.factor('Dry')
names(prob_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

prob_intervention_other_concs <- as.data.frame(prob_intervention_other_w6wed_conc_list)
prob_intervention_other_concs$area <- as.factor('other')
prob_intervention_other_concs$scenario <- as.factor('AI_02')
prob_intervention_other_concs$water <- as.factor('Dry')
names(prob_intervention_other_concs) <- c('concentration','area','scenario','water')

prob_intervention_w6wed_concs <- rbind(prob_intervention_loading_concs,prob_intervention_cleaning_concs,prob_intervention_sorting_concs,prob_intervention_tray_packing_concs,prob_intervention_reject_concs,prob_intervention_other_concs)

prob_intervention_loading_prev <- as.data.frame(NL_table_Prob_Intervention$loading_w6wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_loading_prev$area <- as.factor('loading')
prob_intervention_loading_prev$scenario <- as.factor('AI_02')
prob_intervention_loading_prev$water <- as.factor('Wet')
names(prob_intervention_loading_prev) <- c('prevalence','area','scenario','water')

prob_intervention_cleaning_prev <- as.data.frame(NL_table_Prob_Intervention$cleaning_w6wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_cleaning_prev$area <- as.factor('cleaning')
prob_intervention_cleaning_prev$scenario <- as.factor('AI_02')
prob_intervention_cleaning_prev$water <- as.factor('Wet')
names(prob_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

prob_intervention_sorting_prev <- as.data.frame(NL_table_Prob_Intervention$sorting_w6wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_sorting_prev$area <- as.factor('sorting')
prob_intervention_sorting_prev$scenario <- as.factor('AI_02')
prob_intervention_sorting_prev$water <- as.factor('Dry')
names(prob_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

prob_intervention_reject_prev <- as.data.frame(NL_table_Prob_Intervention$reject_w6wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_reject_prev$area <- as.factor('reject')
prob_intervention_reject_prev$scenario <- as.factor('AI_02')
prob_intervention_reject_prev$water <- as.factor('Dry')
names(prob_intervention_reject_prev) <- c('prevalence','area','scenario','water')

prob_intervention_tray_packing_prev <- as.data.frame(NL_table_Prob_Intervention$tray_packing_w6wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_tray_packing_prev$area <- as.factor('tray packing')
prob_intervention_tray_packing_prev$scenario <- as.factor('AI_02')
prob_intervention_tray_packing_prev$water <- as.factor('Dry')
names(prob_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

prob_intervention_other_prev <- as.data.frame(NL_table_Prob_Intervention$other_w6wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_other_prev$area <- as.factor('other')
prob_intervention_other_prev$scenario <- as.factor('AI_02')
prob_intervention_other_prev$water <- as.factor('Dry')
names(prob_intervention_other_prev) <- c('prevalence','area','scenario','water')

prob_intervention_w6wed_prev <- rbind(prob_intervention_loading_prev,prob_intervention_cleaning_prev,prob_intervention_sorting_prev,prob_intervention_tray_packing_prev,prob_intervention_reject_prev,prob_intervention_other_prev)

prob_intervention_w6wed_wet_prev <- as.data.frame(prob_intervention_loading_prev$prevalence*21/100+prob_intervention_cleaning_prev$prevalence*28/100)/49*100
prob_intervention_w6wed_wet_prev$scenario <- as.factor('AI_02')
prob_intervention_w6wed_wet_prev$water <- as.factor('Wet')
names(prob_intervention_w6wed_wet_prev) <- c('prevalence','scenario','water')

prob_intervention_w6wed_dry_prev <- as.data.frame(prob_intervention_sorting_prev$prevalence*20/100+prob_intervention_reject_prev$prevalence*23/100+prob_intervention_tray_packing_prev$prevalence*123/100+prob_intervention_other_prev$prevalence*10/100)/176*100
prob_intervention_w6wed_dry_prev$scenario <- as.factor('AI_02')
prob_intervention_w6wed_dry_prev$water <- as.factor('Dry')
names(prob_intervention_w6wed_dry_prev) <- c('prevalence','scenario','water')

prob_intervention_w6wed_recombined_prev <- rbind(prob_intervention_w6wed_wet_prev, prob_intervention_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Prob_Intervention$loading_w7wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_loading_w7wed_conc_list <- append(prob_intervention_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_loading_w7wed_conc_matrix <- matrix(unlist(prob_intervention_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Prob_Intervention$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_cleaning_w7wed_conc_list <- append(prob_intervention_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_cleaning_w7wed_conc_matrix <- matrix(unlist(prob_intervention_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Prob_Intervention$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# prob_intervention_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   prob_intervention_drying_w7wed_conc_list <- append(prob_intervention_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Prob_Intervention$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_sorting_w7wed_conc_list <- append(prob_intervention_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_sorting_w7wed_conc_matrix <- matrix(unlist(prob_intervention_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Prob_Intervention$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_tray_packing_w7wed_conc_list <- append(prob_intervention_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_tray_packing_w7wed_conc_matrix <- matrix(unlist(prob_intervention_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Prob_Intervention$reject_w7wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_reject_w7wed_conc_list <- append(prob_intervention_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_reject_w7wed_conc_matrix <- matrix(unlist(prob_intervention_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Prob_Intervention$other_w7wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_other_w7wed_conc_list <- append(prob_intervention_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_other_w7wed_conc_matrix <- matrix(unlist(prob_intervention_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

prob_intervention_loading_concs <- as.data.frame(prob_intervention_loading_w7wed_conc_list)
prob_intervention_loading_concs$area <- as.factor('loading')
prob_intervention_loading_concs$scenario <- as.factor('AI_02')
prob_intervention_loading_concs$water <- as.factor('Wet')
names(prob_intervention_loading_concs) <- c('concentration','area','scenario','water')

prob_intervention_cleaning_concs <- as.data.frame(prob_intervention_cleaning_w7wed_conc_list)
prob_intervention_cleaning_concs$area <- as.factor('cleaning')
prob_intervention_cleaning_concs$scenario <- as.factor('AI_02')
prob_intervention_cleaning_concs$water <- as.factor('Wet')
names(prob_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

prob_intervention_sorting_concs <- as.data.frame(prob_intervention_sorting_w7wed_conc_list)
prob_intervention_sorting_concs$area <- as.factor('sorting')
prob_intervention_sorting_concs$scenario <- as.factor('AI_02')
prob_intervention_sorting_concs$water <- as.factor('Dry')
names(prob_intervention_sorting_concs) <- c('concentration','area','scenario','water')

prob_intervention_reject_concs <- as.data.frame(prob_intervention_reject_w7wed_conc_list)
prob_intervention_reject_concs$area <- as.factor('reject')
prob_intervention_reject_concs$scenario <- as.factor('AI_02')
prob_intervention_reject_concs$water <- as.factor('Dry')
names(prob_intervention_reject_concs) <- c('concentration','area','scenario','water')

prob_intervention_tray_packing_concs <- as.data.frame(prob_intervention_tray_packing_w7wed_conc_list)
prob_intervention_tray_packing_concs$area <- as.factor('tray packing')
prob_intervention_tray_packing_concs$scenario <- as.factor('AI_02')
prob_intervention_tray_packing_concs$water <- as.factor('Dry')
names(prob_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

prob_intervention_other_concs <- as.data.frame(prob_intervention_other_w7wed_conc_list)
prob_intervention_other_concs$area <- as.factor('other')
prob_intervention_other_concs$scenario <- as.factor('AI_02')
prob_intervention_other_concs$water <- as.factor('Dry')
names(prob_intervention_other_concs) <- c('concentration','area','scenario','water')

prob_intervention_w7wed_concs <- rbind(prob_intervention_loading_concs,prob_intervention_cleaning_concs,prob_intervention_sorting_concs,prob_intervention_tray_packing_concs,prob_intervention_reject_concs,prob_intervention_other_concs)

prob_intervention_loading_prev <- as.data.frame(NL_table_Prob_Intervention$loading_w7wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_loading_prev$area <- as.factor('loading')
prob_intervention_loading_prev$scenario <- as.factor('AI_02')
prob_intervention_loading_prev$water <- as.factor('Wet')
names(prob_intervention_loading_prev) <- c('prevalence','area','scenario','water')

prob_intervention_cleaning_prev <- as.data.frame(NL_table_Prob_Intervention$cleaning_w7wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_cleaning_prev$area <- as.factor('cleaning')
prob_intervention_cleaning_prev$scenario <- as.factor('AI_02')
prob_intervention_cleaning_prev$water <- as.factor('Wet')
names(prob_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

prob_intervention_sorting_prev <- as.data.frame(NL_table_Prob_Intervention$sorting_w7wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_sorting_prev$area <- as.factor('sorting')
prob_intervention_sorting_prev$scenario <- as.factor('AI_02')
prob_intervention_sorting_prev$water <- as.factor('Dry')
names(prob_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

prob_intervention_reject_prev <- as.data.frame(NL_table_Prob_Intervention$reject_w7wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_reject_prev$area <- as.factor('reject')
prob_intervention_reject_prev$scenario <- as.factor('AI_02')
prob_intervention_reject_prev$water <- as.factor('Dry')
names(prob_intervention_reject_prev) <- c('prevalence','area','scenario','water')

prob_intervention_tray_packing_prev <- as.data.frame(NL_table_Prob_Intervention$tray_packing_w7wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_tray_packing_prev$area <- as.factor('tray packing')
prob_intervention_tray_packing_prev$scenario <- as.factor('AI_02')
prob_intervention_tray_packing_prev$water <- as.factor('Dry')
names(prob_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

prob_intervention_other_prev <- as.data.frame(NL_table_Prob_Intervention$other_w7wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_other_prev$area <- as.factor('other')
prob_intervention_other_prev$scenario <- as.factor('AI_02')
prob_intervention_other_prev$water <- as.factor('Dry')
names(prob_intervention_other_prev) <- c('prevalence','area','scenario','water')

prob_intervention_w7wed_prev <- rbind(prob_intervention_loading_prev,prob_intervention_cleaning_prev,prob_intervention_sorting_prev,prob_intervention_tray_packing_prev,prob_intervention_reject_prev,prob_intervention_other_prev)

prob_intervention_w7wed_wet_prev <- as.data.frame(prob_intervention_loading_prev$prevalence*21/100+prob_intervention_cleaning_prev$prevalence*28/100)/49*100
prob_intervention_w7wed_wet_prev$scenario <- as.factor('AI_02')
prob_intervention_w7wed_wet_prev$water <- as.factor('Wet')
names(prob_intervention_w7wed_wet_prev) <- c('prevalence','scenario','water')

prob_intervention_w7wed_dry_prev <- as.data.frame(prob_intervention_sorting_prev$prevalence*20/100+prob_intervention_reject_prev$prevalence*23/100+prob_intervention_tray_packing_prev$prevalence*123/100+prob_intervention_other_prev$prevalence*10/100)/176*100
prob_intervention_w7wed_dry_prev$scenario <- as.factor('AI_02')
prob_intervention_w7wed_dry_prev$water <- as.factor('Dry')
names(prob_intervention_w7wed_dry_prev) <- c('prevalence','scenario','water')

prob_intervention_w7wed_recombined_prev <- rbind(prob_intervention_w7wed_wet_prev, prob_intervention_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Prob_Intervention$loading_w8wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_loading_w8wed_conc_list <- append(prob_intervention_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_loading_w8wed_conc_matrix <- matrix(unlist(prob_intervention_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Prob_Intervention$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_cleaning_w8wed_conc_list <- append(prob_intervention_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_cleaning_w8wed_conc_matrix <- matrix(unlist(prob_intervention_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Prob_Intervention$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# prob_intervention_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   prob_intervention_drying_w8wed_conc_list <- append(prob_intervention_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Prob_Intervention$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_sorting_w8wed_conc_list <- append(prob_intervention_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_sorting_w8wed_conc_matrix <- matrix(unlist(prob_intervention_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Prob_Intervention$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_tray_packing_w8wed_conc_list <- append(prob_intervention_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_tray_packing_w8wed_conc_matrix <- matrix(unlist(prob_intervention_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Prob_Intervention$reject_w8wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_reject_w8wed_conc_list <- append(prob_intervention_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_reject_w8wed_conc_matrix <- matrix(unlist(prob_intervention_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Prob_Intervention$other_w8wed_conc_list
vector <- vector[vector!='[]']
prob_intervention_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  prob_intervention_other_w8wed_conc_list <- append(prob_intervention_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
prob_intervention_other_w8wed_conc_matrix <- matrix(unlist(prob_intervention_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

prob_intervention_loading_concs <- as.data.frame(prob_intervention_loading_w8wed_conc_list)
prob_intervention_loading_concs$area <- as.factor('loading')
prob_intervention_loading_concs$scenario <- as.factor('AI_02')
prob_intervention_loading_concs$water <- as.factor('Wet')
names(prob_intervention_loading_concs) <- c('concentration','area','scenario','water')

prob_intervention_cleaning_concs <- as.data.frame(prob_intervention_cleaning_w8wed_conc_list)
prob_intervention_cleaning_concs$area <- as.factor('cleaning')
prob_intervention_cleaning_concs$scenario <- as.factor('AI_02')
prob_intervention_cleaning_concs$water <- as.factor('Wet')
names(prob_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

prob_intervention_sorting_concs <- as.data.frame(prob_intervention_sorting_w8wed_conc_list)
prob_intervention_sorting_concs$area <- as.factor('sorting')
prob_intervention_sorting_concs$scenario <- as.factor('AI_02')
prob_intervention_sorting_concs$water <- as.factor('Dry')
names(prob_intervention_sorting_concs) <- c('concentration','area','scenario','water')

prob_intervention_reject_concs <- as.data.frame(prob_intervention_reject_w8wed_conc_list)
prob_intervention_reject_concs$area <- as.factor('reject')
prob_intervention_reject_concs$scenario <- as.factor('AI_02')
prob_intervention_reject_concs$water <- as.factor('Dry')
names(prob_intervention_reject_concs) <- c('concentration','area','scenario','water')

prob_intervention_tray_packing_concs <- as.data.frame(prob_intervention_tray_packing_w8wed_conc_list)
prob_intervention_tray_packing_concs$area <- as.factor('tray packing')
prob_intervention_tray_packing_concs$scenario <- as.factor('AI_02')
prob_intervention_tray_packing_concs$water <- as.factor('Dry')
names(prob_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

prob_intervention_other_concs <- as.data.frame(prob_intervention_other_w8wed_conc_list)
prob_intervention_other_concs$area <- as.factor('other')
prob_intervention_other_concs$scenario <- as.factor('AI_02')
prob_intervention_other_concs$water <- as.factor('Dry')
names(prob_intervention_other_concs) <- c('concentration','area','scenario','water')

prob_intervention_w8wed_concs <- rbind(prob_intervention_loading_concs,prob_intervention_cleaning_concs,prob_intervention_sorting_concs,prob_intervention_tray_packing_concs,prob_intervention_reject_concs,prob_intervention_other_concs)

prob_intervention_loading_prev <- as.data.frame(NL_table_Prob_Intervention$loading_w8wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_loading_prev$area <- as.factor('loading')
prob_intervention_loading_prev$scenario <- as.factor('AI_02')
prob_intervention_loading_prev$water <- as.factor('Wet')
names(prob_intervention_loading_prev) <- c('prevalence','area','scenario','water')

prob_intervention_cleaning_prev <- as.data.frame(NL_table_Prob_Intervention$cleaning_w8wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_cleaning_prev$area <- as.factor('cleaning')
prob_intervention_cleaning_prev$scenario <- as.factor('AI_02')
prob_intervention_cleaning_prev$water <- as.factor('Wet')
names(prob_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

prob_intervention_sorting_prev <- as.data.frame(NL_table_Prob_Intervention$sorting_w8wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_sorting_prev$area <- as.factor('sorting')
prob_intervention_sorting_prev$scenario <- as.factor('AI_02')
prob_intervention_sorting_prev$water <- as.factor('Dry')
names(prob_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

prob_intervention_reject_prev <- as.data.frame(NL_table_Prob_Intervention$reject_w8wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_reject_prev$area <- as.factor('reject')
prob_intervention_reject_prev$scenario <- as.factor('AI_02')
prob_intervention_reject_prev$water <- as.factor('Dry')
names(prob_intervention_reject_prev) <- c('prevalence','area','scenario','water')

prob_intervention_tray_packing_prev <- as.data.frame(NL_table_Prob_Intervention$tray_packing_w8wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_tray_packing_prev$area <- as.factor('tray packing')
prob_intervention_tray_packing_prev$scenario <- as.factor('AI_02')
prob_intervention_tray_packing_prev$water <- as.factor('Dry')
names(prob_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

prob_intervention_other_prev <- as.data.frame(NL_table_Prob_Intervention$other_w8wed_prev[order(NL_table_Prob_Intervention$local_seed)])
prob_intervention_other_prev$area <- as.factor('other')
prob_intervention_other_prev$scenario <- as.factor('AI_02')
prob_intervention_other_prev$water <- as.factor('Dry')
names(prob_intervention_other_prev) <- c('prevalence','area','scenario','water')

prob_intervention_w8wed_prev <- rbind(prob_intervention_loading_prev,prob_intervention_cleaning_prev,prob_intervention_sorting_prev,prob_intervention_tray_packing_prev,prob_intervention_reject_prev,prob_intervention_other_prev)

prob_intervention_w8wed_wet_prev <- as.data.frame(prob_intervention_loading_prev$prevalence*21/100+prob_intervention_cleaning_prev$prevalence*28/100)/49*100
prob_intervention_w8wed_wet_prev$scenario <- as.factor('AI_02')
prob_intervention_w8wed_wet_prev$water <- as.factor('Wet')
names(prob_intervention_w8wed_wet_prev) <- c('prevalence','scenario','water')

prob_intervention_w8wed_dry_prev <- as.data.frame(prob_intervention_sorting_prev$prevalence*20/100+prob_intervention_reject_prev$prevalence*23/100+prob_intervention_tray_packing_prev$prevalence*123/100+prob_intervention_other_prev$prevalence*10/100)/176*100
prob_intervention_w8wed_dry_prev$scenario <- as.factor('AI_02')
prob_intervention_w8wed_dry_prev$water <- as.factor('Dry')
names(prob_intervention_w8wed_dry_prev) <- c('prevalence','scenario','water')

prob_intervention_w8wed_recombined_prev <- rbind(prob_intervention_w8wed_wet_prev, prob_intervention_w8wed_dry_prev)

prob_intervention_w1wed_prev$week <- as.factor(1)
prob_intervention_w2wed_prev$week <- as.factor(2)
prob_intervention_w3wed_prev$week <- as.factor(3)
prob_intervention_w4wed_prev$week <- as.factor(4)
prob_intervention_w5wed_prev$week <- as.factor(5)
prob_intervention_w6wed_prev$week <- as.factor(6)
prob_intervention_w7wed_prev$week <- as.factor(7)
prob_intervention_w8wed_prev$week <- as.factor(8)

prob_intervention_w1wed_recombined_prev$week <- as.factor(1)
prob_intervention_w2wed_recombined_prev$week <- as.factor(2)
prob_intervention_w3wed_recombined_prev$week <- as.factor(3)
prob_intervention_w4wed_recombined_prev$week <- as.factor(4)
prob_intervention_w5wed_recombined_prev$week <- as.factor(5)
prob_intervention_w6wed_recombined_prev$week <- as.factor(6)
prob_intervention_w7wed_recombined_prev$week <- as.factor(7)
prob_intervention_w8wed_recombined_prev$week <- as.factor(8)
prob_intervention_allwed_prev <- rbind(prob_intervention_w1wed_recombined_prev,prob_intervention_w2wed_recombined_prev,prob_intervention_w3wed_recombined_prev,prob_intervention_w4wed_recombined_prev,prob_intervention_w5wed_recombined_prev,prob_intervention_w6wed_recombined_prev,prob_intervention_w7wed_recombined_prev,prob_intervention_w8wed_recombined_prev)

vector <- NL_table_Prob_Intervention$lifetime_conc_list[order(NL_table_Prob_Intervention$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

prob_intervention_w1wed_recombined_prev$week <- as.factor(1)
prob_intervention_w2wed_recombined_prev$week <- as.factor(2)
prob_intervention_w3wed_recombined_prev$week <- as.factor(3)
prob_intervention_w4wed_recombined_prev$week <- as.factor(4)
prob_intervention_w5wed_recombined_prev$week <- as.factor(5)
prob_intervention_w6wed_recombined_prev$week <- as.factor(6)
prob_intervention_w7wed_recombined_prev$week <- as.factor(7)
prob_intervention_w8wed_recombined_prev$week <- as.factor(8)
prob_intervention_allwed_prev <- rbind(prob_intervention_w1wed_recombined_prev,prob_intervention_w2wed_recombined_prev,prob_intervention_w3wed_recombined_prev,prob_intervention_w4wed_recombined_prev,prob_intervention_w5wed_recombined_prev,prob_intervention_w6wed_recombined_prev,prob_intervention_w7wed_recombined_prev,prob_intervention_w8wed_recombined_prev)

Facility_B_prob_intervention_agents_melted <- melt(mdarray)
colnames(Facility_B_prob_intervention_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_prob_intervention_agents_melted$agent <- Facility_B_prob_intervention_agents_melted$agent-1
Facility_B_prob_intervention_agents_melted$logical <- Facility_B_prob_intervention_agents_melted$value>0
Facility_B_prob_intervention_agents_melted$binary <- as.numeric(Facility_B_prob_intervention_agents_melted$logical)
Facility_B_prob_intervention_agents_melted$log10value <- log10(Facility_B_prob_intervention_agents_melted$value)
Facility_B_prob_intervention_agents_melted$log10value[is.infinite(Facility_B_prob_intervention_agents_melted$log10value)] <- 0

agent <- Facility_B_prob_intervention_agents_melted$agent
iteration <- Facility_B_prob_intervention_agents_melted$iteration
tick <- Facility_B_prob_intervention_agents_melted$tick
rle_matrix <- tapply(Facility_B_prob_intervention_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_prob_intervention_mean_value_matrix <- tapply(Facility_B_prob_intervention_agents_melted$value, list(agent, tick), mean)
Facility_B_prob_intervention_median_value_matrix <- tapply(Facility_B_prob_intervention_agents_melted$value, list(agent, tick), median)
x <- Facility_B_prob_intervention_agents_melted
x$value[x$value==0] <- NA
Facility_B_prob_intervention_pos_median_value_matrix <- tapply(x$value, list(agent, tick), median, na.rm=TRUE)
Facility_B_prob_intervention_prob_value_matrix <- tapply(Facility_B_prob_intervention_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

#Maximum sensitivity####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_prob_intervention <- durations

agents_list_prob_intervention <- read.table(paste0(getwd(),'/Data/Agents - Prob Intervention.txt'))
agents_list_prob_intervention <- agents_list_prob_intervention[,c("V1","V7","V8","V9")]
colnames(agents_list_prob_intervention) <- c("name","sanitation_status","schedule","area")
#Time to persistence
agents_list_prob_intervention$time_to_persistence <- rep((168*2),225)
agents_list_prob_intervention$time_to_persistence[agents_list_prob_intervention$schedule=="daily"] <- (24*2)

persistent_short_durations_list_prob_intervention <- data.frame()
persistent_long_durations_list_prob_intervention <- data.frame()
persistent_uncleanable_durations_list_prob_intervention <- data.frame()
transient_short_durations_list_prob_intervention <- data.frame()
transient_long_durations_list_prob_intervention <- data.frame()
transient_uncleanable_durations_list_prob_intervention <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_prob_intervention$min_duration[agent] <- ifelse(length(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent])==0,NA,min(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_prob_intervention$mean_duration[agent] <- ifelse(length(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent])==0,NA,mean(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_prob_intervention$median_duration[agent] <- ifelse(length(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent])==0,NA,median(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_prob_intervention$max_duration[agent] <- ifelse(length(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent])==0,NA,max(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_prob_intervention$contamination_events[agent] <- sum(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_prob_intervention$times_persistent[agent] <- sum(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent]>agents_list_prob_intervention$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_prob_intervention$q1_duration[agent] <- quantile(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_prob_intervention$q3_duration[agent] <- quantile(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_prob_intervention$min_persistent_duration[agent] <- ifelse((length(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent])==0) || (agents_list_prob_intervention$times_persistent[agent]==0),NA,min(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent & Facility_B_durations_prob_intervention$duration>=agents_list_prob_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_prob_intervention$mean_persistent_duration[agent] <- ifelse((length(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent])==0) || (agents_list_prob_intervention$times_persistent[agent]==0),NA,mean(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent & Facility_B_durations_prob_intervention$duration>=agents_list_prob_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_prob_intervention$median_persistent_duration[agent] <- ifelse((length(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent])==0) || (agents_list_prob_intervention$times_persistent[agent]==0),NA,median(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent & Facility_B_durations_prob_intervention$duration>=agents_list_prob_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_prob_intervention$max_persistent_duration[agent] <- ifelse((length(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent])==0) || (agents_list_prob_intervention$times_persistent[agent]==0),NA,max(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent & Facility_B_durations_prob_intervention$duration>=agents_list_prob_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_prob_intervention$q1_persistent_duration[agent] <- ifelse((length(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent])==0) || (agents_list_prob_intervention$times_persistent[agent]==0),NA,quantile(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent & Facility_B_durations_prob_intervention$duration>=agents_list_prob_intervention$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_prob_intervention$q3_persistent_duration[agent] <- ifelse((length(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent])==0) || (agents_list_prob_intervention$times_persistent[agent]==0),NA,quantile(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent & Facility_B_durations_prob_intervention$duration>=agents_list_prob_intervention$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations
  x <- Facility_B_durations_prob_intervention[which(Facility_B_durations_prob_intervention$agent==agent & Facility_B_durations_prob_intervention$duration>agents_list_prob_intervention$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean
  agents_list_prob_intervention$mean_times_persistent[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_prob_intervention$mean_times_persistent[which(is.na(agents_list_prob_intervention$mean_times_persistent))] <- 0
  #Division by total number of iterations in simulation
  agents_list_prob_intervention$balanced_times_persistent[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_prob_intervention$duration[Facility_B_durations_prob_intervention$agent==agent])!=0) || (agents_list_prob_intervention$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_prob_intervention$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_prob_intervention <- rbind(
        persistent_short_durations_list_prob_intervention,
        Facility_B_durations_prob_intervention[Facility_B_durations_prob_intervention$agent==agent & Facility_B_durations_prob_intervention$duration>agents_list_prob_intervention$time_to_persistence[agent],]
      )
    } else if(agents_list_prob_intervention$time_to_persistence[agent]==336 && agents_list_prob_intervention$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_prob_intervention <- rbind(
        persistent_long_durations_list_prob_intervention,
        Facility_B_durations_prob_intervention[Facility_B_durations_prob_intervention$agent==agent & Facility_B_durations_prob_intervention$duration>agents_list_prob_intervention$time_to_persistence[agent],]
      )
    } else if(agents_list_prob_intervention$time_to_persistence[agent]==336 && agents_list_prob_intervention$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_prob_intervention <- rbind(
        persistent_uncleanable_durations_list_prob_intervention,
        Facility_B_durations_prob_intervention[Facility_B_durations_prob_intervention$agent==agent & Facility_B_durations_prob_intervention$duration>agents_list_prob_intervention$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_prob_intervention$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_prob_intervention <- rbind(
      transient_short_durations_list_prob_intervention,
      Facility_B_durations_prob_intervention[Facility_B_durations_prob_intervention$agent==agent & Facility_B_durations_prob_intervention$duration<=agents_list_prob_intervention$time_to_persistence[agent],]
    )
  } else if(agents_list_prob_intervention$time_to_persistence[agent]==336 && agents_list_prob_intervention$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_prob_intervention <- rbind(
      transient_long_durations_list_prob_intervention,
      Facility_B_durations_prob_intervention[Facility_B_durations_prob_intervention$agent==agent & Facility_B_durations_prob_intervention$duration<=agents_list_prob_intervention$time_to_persistence[agent],]
    )
  } else if(agents_list_prob_intervention$time_to_persistence[agent]==336 && agents_list_prob_intervention$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_prob_intervention <- rbind(
      transient_uncleanable_durations_list_prob_intervention,
      Facility_B_durations_prob_intervention[Facility_B_durations_prob_intervention$agent==agent & Facility_B_durations_prob_intervention$duration<=agents_list_prob_intervention$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

#10 cells minimum####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>9)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_prob_intervention_10min <- durations

persistent_short_durations_list_prob_intervention_10min <- data.frame()
persistent_long_durations_list_prob_intervention_10min <- data.frame()
persistent_uncleanable_durations_list_prob_intervention_10min <- data.frame()
transient_short_durations_list_prob_intervention_10min <- data.frame()
transient_long_durations_list_prob_intervention_10min <- data.frame()
transient_uncleanable_durations_list_prob_intervention_10min <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_prob_intervention$min_duration_10min[agent] <- ifelse(length(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent])==0,NA,min(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_prob_intervention$mean_duration_10min[agent] <- ifelse(length(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent])==0,NA,mean(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_prob_intervention$median_duration_10min[agent] <- ifelse(length(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent])==0,NA,median(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_prob_intervention$max_duration_10min[agent] <- ifelse(length(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent])==0,NA,max(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_prob_intervention$contamination_events_10min[agent] <- sum(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_prob_intervention$times_persistent_10min[agent] <- sum(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent]>agents_list_prob_intervention$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_prob_intervention$q1_duration_10min[agent] <- quantile(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_prob_intervention$q3_duration_10min[agent] <- quantile(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_prob_intervention$min_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent])==0) || (agents_list_prob_intervention$times_persistent_10min[agent]==0),NA,min(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent & Facility_B_durations_prob_intervention_10min$duration>=agents_list_prob_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_prob_intervention$mean_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent])==0) || (agents_list_prob_intervention$times_persistent_10min[agent]==0),NA,mean(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent & Facility_B_durations_prob_intervention_10min$duration>=agents_list_prob_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_prob_intervention$median_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent])==0) || (agents_list_prob_intervention$times_persistent_10min[agent]==0),NA,median(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent & Facility_B_durations_prob_intervention_10min$duration>=agents_list_prob_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_prob_intervention$max_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent])==0) || (agents_list_prob_intervention$times_persistent_10min[agent]==0),NA,max(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent & Facility_B_durations_prob_intervention_10min$duration>=agents_list_prob_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_prob_intervention$q1_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent])==0) || (agents_list_prob_intervention$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent & Facility_B_durations_prob_intervention_10min$duration>=agents_list_prob_intervention$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_prob_intervention$q3_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent])==0) || (agents_list_prob_intervention$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent & Facility_B_durations_prob_intervention_10min$duration>=agents_list_prob_intervention$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations (Does not account for iterations with 0 events)
  x <- Facility_B_durations_prob_intervention_10min[which(Facility_B_durations_prob_intervention_10min$agent==agent & Facility_B_durations_prob_intervention_10min$duration>agents_list_prob_intervention$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean (Does account for iterations with 0 events)
  agents_list_prob_intervention$mean_times_persistent_10min[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_prob_intervention$mean_times_persistent_10min[which(is.na(agents_list_prob_intervention$mean_times_persistent_10min))] <- 0
  #Division by total number of iterations in simulation
  agents_list_prob_intervention$balanced_times_persistent_10min[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_prob_intervention_10min$duration[Facility_B_durations_prob_intervention_10min$agent==agent])!=0) || (agents_list_prob_intervention$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_prob_intervention$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_prob_intervention_10min <- rbind(
        persistent_short_durations_list_prob_intervention_10min,
        Facility_B_durations_prob_intervention_10min[Facility_B_durations_prob_intervention_10min$agent==agent & Facility_B_durations_prob_intervention_10min$duration>agents_list_prob_intervention$time_to_persistence[agent],]
      )
    } else if(agents_list_prob_intervention$time_to_persistence[agent]==336 && agents_list_prob_intervention$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_prob_intervention_10min <- rbind(
        persistent_long_durations_list_prob_intervention_10min,
        Facility_B_durations_prob_intervention_10min[Facility_B_durations_prob_intervention_10min$agent==agent & Facility_B_durations_prob_intervention_10min$duration>agents_list_prob_intervention$time_to_persistence[agent],]
      )
    } else if(agents_list_prob_intervention$time_to_persistence[agent]==336 && agents_list_prob_intervention$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_prob_intervention_10min <- rbind(
        persistent_uncleanable_durations_list_prob_intervention_10min,
        Facility_B_durations_prob_intervention_10min[Facility_B_durations_prob_intervention_10min$agent==agent & Facility_B_durations_prob_intervention_10min$duration>agents_list_prob_intervention$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_prob_intervention$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_prob_intervention_10min <- rbind(
      transient_short_durations_list_prob_intervention_10min,
      Facility_B_durations_prob_intervention_10min[Facility_B_durations_prob_intervention_10min$agent==agent & Facility_B_durations_prob_intervention_10min$duration<=agents_list_prob_intervention$time_to_persistence[agent],]
    )
  } else if(agents_list_prob_intervention$time_to_persistence[agent]==336 && agents_list_prob_intervention$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_prob_intervention_10min <- rbind(
      transient_long_durations_list_prob_intervention_10min,
      Facility_B_durations_prob_intervention_10min[Facility_B_durations_prob_intervention_10min$agent==agent & Facility_B_durations_prob_intervention_10min$duration<=agents_list_prob_intervention$time_to_persistence[agent],]
    )
  } else if(agents_list_prob_intervention$time_to_persistence[agent]==336 && agents_list_prob_intervention$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_prob_intervention_10min <- rbind(
      transient_uncleanable_durations_list_prob_intervention_10min,
      Facility_B_durations_prob_intervention_10min[Facility_B_durations_prob_intervention_10min$agent==agent & Facility_B_durations_prob_intervention_10min$duration<=agents_list_prob_intervention$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

# Facility_B_prob_intervention_agents_melted_monday_preop <- Facility_B_prob_intervention_agents_melted[which(Facility_B_prob_intervention_agents_melted$tick==33|Facility_B_prob_intervention_agents_melted$tick==201|Facility_B_prob_intervention_agents_melted$tick==369|Facility_B_prob_intervention_agents_melted$tick==537|Facility_B_prob_intervention_agents_melted$tick==705|Facility_B_prob_intervention_agents_melted$tick==873|Facility_B_prob_intervention_agents_melted$tick==1041|Facility_B_prob_intervention_agents_melted$tick==1209),]
# 
# Facility_B_prob_intervention_agents_melted_tuesday_preop <- Facility_B_prob_intervention_agents_melted[which(Facility_B_prob_intervention_agents_melted$tick==57|Facility_B_prob_intervention_agents_melted$tick==225|Facility_B_prob_intervention_agents_melted$tick==393|Facility_B_prob_intervention_agents_melted$tick==561|Facility_B_prob_intervention_agents_melted$tick==729|Facility_B_prob_intervention_agents_melted$tick==897|Facility_B_prob_intervention_agents_melted$tick==1065|Facility_B_prob_intervention_agents_melted$tick==1233),]
# 
# Facility_B_prob_intervention_agents_melted_wednesday_preop <- Facility_B_prob_intervention_agents_melted[which(Facility_B_prob_intervention_agents_melted$tick==81|Facility_B_prob_intervention_agents_melted$tick==249|Facility_B_prob_intervention_agents_melted$tick==417|Facility_B_prob_intervention_agents_melted$tick==585|Facility_B_prob_intervention_agents_melted$tick==753|Facility_B_prob_intervention_agents_melted$tick==921|Facility_B_prob_intervention_agents_melted$tick==1089|Facility_B_prob_intervention_agents_melted$tick==1257),]
# 
# Facility_B_prob_intervention_agents_melted_thursday_preop <- Facility_B_prob_intervention_agents_melted[which(Facility_B_prob_intervention_agents_melted$tick==105|Facility_B_prob_intervention_agents_melted$tick==273|Facility_B_prob_intervention_agents_melted$tick==441|Facility_B_prob_intervention_agents_melted$tick==609|Facility_B_prob_intervention_agents_melted$tick==777|Facility_B_prob_intervention_agents_melted$tick==945|Facility_B_prob_intervention_agents_melted$tick==1113|Facility_B_prob_intervention_agents_melted$tick==1281),]
# 
# Facility_B_prob_intervention_agents_melted_friday_preop <- Facility_B_prob_intervention_agents_melted[which(Facility_B_prob_intervention_agents_melted$tick==129|Facility_B_prob_intervention_agents_melted$tick==297|Facility_B_prob_intervention_agents_melted$tick==465|Facility_B_prob_intervention_agents_melted$tick==633|Facility_B_prob_intervention_agents_melted$tick==801|Facility_B_prob_intervention_agents_melted$tick==969|Facility_B_prob_intervention_agents_melted$tick==1137|Facility_B_prob_intervention_agents_melted$tick==1305),]

Facility_B_prob_intervention_agents_melted_ff <- as.ffdf(Facility_B_prob_intervention_agents_melted)
rm(Facility_B_prob_intervention_agents_melted)
gc()
```

```{r import Partial Risk-Based Intervention with Washing & Sanitation}
NL_table_Partial_Prob_Intervention <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-30-18-20 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_Risk-Based_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Partial_Prob_Intervention <- NL_table_Partial_Prob_Intervention[NL_table_Partial_Prob_Intervention$scenario==29,]

while (any(grepl('-', names(NL_table_Partial_Prob_Intervention), fixed = TRUE))) {
  NL_table_Partial_Prob_Intervention <- NL_table_Partial_Prob_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Partial_Prob_Intervention), fixed = TRUE))) {
  NL_table_Partial_Prob_Intervention <- NL_table_Partial_Prob_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Partial_Prob_Intervention), fixed = TRUE))) {
  NL_table_Partial_Prob_Intervention <- NL_table_Partial_Prob_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Partial_Prob_Intervention), fixed = TRUE))) {
  NL_table_Partial_Prob_Intervention <- NL_table_Partial_Prob_Intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Partial_Prob_Intervention[ , ..list_columns]

NL_table_Partial_Prob_Intervention[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Partial_Prob_Intervention <- as.data.frame(NL_table_Partial_Prob_Intervention)

NL_table_Partial_Prob_Intervention[NL_table_Partial_Prob_Intervention==-1] <- NA

NL_table_Partial_Prob_Intervention <- subset(NL_table_Partial_Prob_Intervention, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Partial_Prob_Intervention)[names(NL_table_Partial_Prob_Intervention)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Partial_Prob_Intervention)[names(NL_table_Partial_Prob_Intervention)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Partial_Prob_Intervention$loading_w1wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_loading_w1wed_conc_list <- append(partial_prob_intervention_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_loading_w1wed_conc_matrix <- matrix(unlist(partial_prob_intervention_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_cleaning_w1wed_conc_list <- append(partial_prob_intervention_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_cleaning_w1wed_conc_matrix <- matrix(unlist(partial_prob_intervention_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Partial_Prob_Intervention$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# partial_prob_intervention_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   partial_prob_intervention_drying_w1wed_conc_list <- append(partial_prob_intervention_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Partial_Prob_Intervention$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_sorting_w1wed_conc_list <- append(partial_prob_intervention_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_sorting_w1wed_conc_matrix <- matrix(unlist(partial_prob_intervention_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_tray_packing_w1wed_conc_list <- append(partial_prob_intervention_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_tray_packing_w1wed_conc_matrix <- matrix(unlist(partial_prob_intervention_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$reject_w1wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_reject_w1wed_conc_list <- append(partial_prob_intervention_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_reject_w1wed_conc_matrix <- matrix(unlist(partial_prob_intervention_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$other_w1wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_other_w1wed_conc_list <- append(partial_prob_intervention_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_other_w1wed_conc_matrix <- matrix(unlist(partial_prob_intervention_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

partial_prob_intervention_loading_concs <- as.data.frame(partial_prob_intervention_loading_w1wed_conc_list)
partial_prob_intervention_loading_concs$area <- as.factor('loading')
partial_prob_intervention_loading_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_loading_concs$water <- as.factor('Wet')
names(partial_prob_intervention_loading_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_cleaning_concs <- as.data.frame(partial_prob_intervention_cleaning_w1wed_conc_list)
partial_prob_intervention_cleaning_concs$area <- as.factor('cleaning')
partial_prob_intervention_cleaning_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_cleaning_concs$water <- as.factor('Wet')
names(partial_prob_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_sorting_concs <- as.data.frame(partial_prob_intervention_sorting_w1wed_conc_list)
partial_prob_intervention_sorting_concs$area <- as.factor('sorting')
partial_prob_intervention_sorting_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_sorting_concs$water <- as.factor('Dry')
names(partial_prob_intervention_sorting_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_reject_concs <- as.data.frame(partial_prob_intervention_reject_w1wed_conc_list)
partial_prob_intervention_reject_concs$area <- as.factor('reject')
partial_prob_intervention_reject_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_reject_concs$water <- as.factor('Dry')
names(partial_prob_intervention_reject_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_tray_packing_concs <- as.data.frame(partial_prob_intervention_tray_packing_w1wed_conc_list)
partial_prob_intervention_tray_packing_concs$area <- as.factor('tray packing')
partial_prob_intervention_tray_packing_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_tray_packing_concs$water <- as.factor('Dry')
names(partial_prob_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_other_concs <- as.data.frame(partial_prob_intervention_other_w1wed_conc_list)
partial_prob_intervention_other_concs$area <- as.factor('other')
partial_prob_intervention_other_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_other_concs$water <- as.factor('Dry')
names(partial_prob_intervention_other_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_w1wed_concs <- rbind(partial_prob_intervention_loading_concs,partial_prob_intervention_cleaning_concs,partial_prob_intervention_sorting_concs,partial_prob_intervention_tray_packing_concs,partial_prob_intervention_reject_concs,partial_prob_intervention_other_concs)

partial_prob_intervention_loading_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$loading_w1wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_loading_prev$area <- as.factor('loading')
partial_prob_intervention_loading_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_loading_prev$water <- as.factor('Wet')
names(partial_prob_intervention_loading_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_cleaning_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$cleaning_w1wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_cleaning_prev$area <- as.factor('cleaning')
partial_prob_intervention_cleaning_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_cleaning_prev$water <- as.factor('Wet')
names(partial_prob_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_sorting_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$sorting_w1wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_sorting_prev$area <- as.factor('sorting')
partial_prob_intervention_sorting_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_sorting_prev$water <- as.factor('Dry')
names(partial_prob_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_reject_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$reject_w1wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_reject_prev$area <- as.factor('reject')
partial_prob_intervention_reject_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_reject_prev$water <- as.factor('Dry')
names(partial_prob_intervention_reject_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_tray_packing_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$tray_packing_w1wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_tray_packing_prev$area <- as.factor('tray packing')
partial_prob_intervention_tray_packing_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_tray_packing_prev$water <- as.factor('Dry')
names(partial_prob_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_other_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$other_w1wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_other_prev$area <- as.factor('other')
partial_prob_intervention_other_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_other_prev$water <- as.factor('Dry')
names(partial_prob_intervention_other_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_w1wed_prev <- rbind(partial_prob_intervention_loading_prev,partial_prob_intervention_cleaning_prev,partial_prob_intervention_sorting_prev,partial_prob_intervention_tray_packing_prev,partial_prob_intervention_reject_prev,partial_prob_intervention_other_prev)

partial_prob_intervention_w1wed_wet_prev <- as.data.frame(partial_prob_intervention_loading_prev$prevalence*21/100+partial_prob_intervention_cleaning_prev$prevalence*28/100)/49*100
partial_prob_intervention_w1wed_wet_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_w1wed_wet_prev$water <- as.factor('Wet')
names(partial_prob_intervention_w1wed_wet_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_w1wed_dry_prev <- as.data.frame(partial_prob_intervention_sorting_prev$prevalence*20/100+partial_prob_intervention_reject_prev$prevalence*23/100+partial_prob_intervention_tray_packing_prev$prevalence*123/100+partial_prob_intervention_other_prev$prevalence*10/100)/176*100
partial_prob_intervention_w1wed_dry_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_w1wed_dry_prev$water <- as.factor('Dry')
names(partial_prob_intervention_w1wed_dry_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_w1wed_recombined_prev <- rbind(partial_prob_intervention_w1wed_wet_prev, partial_prob_intervention_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Partial_Prob_Intervention$loading_w2wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_loading_w2wed_conc_list <- append(partial_prob_intervention_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_loading_w2wed_conc_matrix <- matrix(unlist(partial_prob_intervention_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_cleaning_w2wed_conc_list <- append(partial_prob_intervention_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_cleaning_w2wed_conc_matrix <- matrix(unlist(partial_prob_intervention_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Partial_Prob_Intervention$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# partial_prob_intervention_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   partial_prob_intervention_drying_w2wed_conc_list <- append(partial_prob_intervention_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Partial_Prob_Intervention$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_sorting_w2wed_conc_list <- append(partial_prob_intervention_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_sorting_w2wed_conc_matrix <- matrix(unlist(partial_prob_intervention_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_tray_packing_w2wed_conc_list <- append(partial_prob_intervention_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_tray_packing_w2wed_conc_matrix <- matrix(unlist(partial_prob_intervention_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$reject_w2wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_reject_w2wed_conc_list <- append(partial_prob_intervention_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_reject_w2wed_conc_matrix <- matrix(unlist(partial_prob_intervention_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$other_w2wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_other_w2wed_conc_list <- append(partial_prob_intervention_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_other_w2wed_conc_matrix <- matrix(unlist(partial_prob_intervention_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

partial_prob_intervention_loading_concs <- as.data.frame(partial_prob_intervention_loading_w2wed_conc_list)
partial_prob_intervention_loading_concs$area <- as.factor('loading')
partial_prob_intervention_loading_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_loading_concs$water <- as.factor('Wet')
names(partial_prob_intervention_loading_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_cleaning_concs <- as.data.frame(partial_prob_intervention_cleaning_w2wed_conc_list)
partial_prob_intervention_cleaning_concs$area <- as.factor('cleaning')
partial_prob_intervention_cleaning_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_cleaning_concs$water <- as.factor('Wet')
names(partial_prob_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_sorting_concs <- as.data.frame(partial_prob_intervention_sorting_w2wed_conc_list)
partial_prob_intervention_sorting_concs$area <- as.factor('sorting')
partial_prob_intervention_sorting_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_sorting_concs$water <- as.factor('Dry')
names(partial_prob_intervention_sorting_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_reject_concs <- as.data.frame(partial_prob_intervention_reject_w2wed_conc_list)
partial_prob_intervention_reject_concs$area <- as.factor('reject')
partial_prob_intervention_reject_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_reject_concs$water <- as.factor('Dry')
names(partial_prob_intervention_reject_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_tray_packing_concs <- as.data.frame(partial_prob_intervention_tray_packing_w2wed_conc_list)
partial_prob_intervention_tray_packing_concs$area <- as.factor('tray packing')
partial_prob_intervention_tray_packing_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_tray_packing_concs$water <- as.factor('Dry')
names(partial_prob_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_other_concs <- as.data.frame(partial_prob_intervention_other_w2wed_conc_list)
partial_prob_intervention_other_concs$area <- as.factor('other')
partial_prob_intervention_other_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_other_concs$water <- as.factor('Dry')
names(partial_prob_intervention_other_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_w2wed_concs <- rbind(partial_prob_intervention_loading_concs,partial_prob_intervention_cleaning_concs,partial_prob_intervention_sorting_concs,partial_prob_intervention_tray_packing_concs,partial_prob_intervention_reject_concs,partial_prob_intervention_other_concs)

partial_prob_intervention_loading_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$loading_w2wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_loading_prev$area <- as.factor('loading')
partial_prob_intervention_loading_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_loading_prev$water <- as.factor('Wet')
names(partial_prob_intervention_loading_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_cleaning_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$cleaning_w2wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_cleaning_prev$area <- as.factor('cleaning')
partial_prob_intervention_cleaning_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_cleaning_prev$water <- as.factor('Wet')
names(partial_prob_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_sorting_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$sorting_w2wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_sorting_prev$area <- as.factor('sorting')
partial_prob_intervention_sorting_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_sorting_prev$water <- as.factor('Dry')
names(partial_prob_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_reject_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$reject_w2wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_reject_prev$area <- as.factor('reject')
partial_prob_intervention_reject_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_reject_prev$water <- as.factor('Dry')
names(partial_prob_intervention_reject_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_tray_packing_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$tray_packing_w2wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_tray_packing_prev$area <- as.factor('tray packing')
partial_prob_intervention_tray_packing_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_tray_packing_prev$water <- as.factor('Dry')
names(partial_prob_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_other_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$other_w2wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_other_prev$area <- as.factor('other')
partial_prob_intervention_other_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_other_prev$water <- as.factor('Dry')
names(partial_prob_intervention_other_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_w2wed_prev <- rbind(partial_prob_intervention_loading_prev,partial_prob_intervention_cleaning_prev,partial_prob_intervention_sorting_prev,partial_prob_intervention_tray_packing_prev,partial_prob_intervention_reject_prev,partial_prob_intervention_other_prev)

partial_prob_intervention_w2wed_wet_prev <- as.data.frame(partial_prob_intervention_loading_prev$prevalence*21/100+partial_prob_intervention_cleaning_prev$prevalence*28/100)/49*100
partial_prob_intervention_w2wed_wet_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_w2wed_wet_prev$water <- as.factor('Wet')
names(partial_prob_intervention_w2wed_wet_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_w2wed_dry_prev <- as.data.frame(partial_prob_intervention_sorting_prev$prevalence*20/100+partial_prob_intervention_reject_prev$prevalence*23/100+partial_prob_intervention_tray_packing_prev$prevalence*123/100+partial_prob_intervention_other_prev$prevalence*10/100)/176*100
partial_prob_intervention_w2wed_dry_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_w2wed_dry_prev$water <- as.factor('Dry')
names(partial_prob_intervention_w2wed_dry_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_w2wed_recombined_prev <- rbind(partial_prob_intervention_w2wed_wet_prev, partial_prob_intervention_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Partial_Prob_Intervention$loading_w3wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_loading_w3wed_conc_list <- append(partial_prob_intervention_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_loading_w3wed_conc_matrix <- matrix(unlist(partial_prob_intervention_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_cleaning_w3wed_conc_list <- append(partial_prob_intervention_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_cleaning_w3wed_conc_matrix <- matrix(unlist(partial_prob_intervention_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Partial_Prob_Intervention$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# partial_prob_intervention_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   partial_prob_intervention_drying_w3wed_conc_list <- append(partial_prob_intervention_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Partial_Prob_Intervention$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_sorting_w3wed_conc_list <- append(partial_prob_intervention_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_sorting_w3wed_conc_matrix <- matrix(unlist(partial_prob_intervention_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_tray_packing_w3wed_conc_list <- append(partial_prob_intervention_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_tray_packing_w3wed_conc_matrix <- matrix(unlist(partial_prob_intervention_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$reject_w3wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_reject_w3wed_conc_list <- append(partial_prob_intervention_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_reject_w3wed_conc_matrix <- matrix(unlist(partial_prob_intervention_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$other_w3wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_other_w3wed_conc_list <- append(partial_prob_intervention_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_other_w3wed_conc_matrix <- matrix(unlist(partial_prob_intervention_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

partial_prob_intervention_loading_concs <- as.data.frame(partial_prob_intervention_loading_w3wed_conc_list)
partial_prob_intervention_loading_concs$area <- as.factor('loading')
partial_prob_intervention_loading_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_loading_concs$water <- as.factor('Wet')
names(partial_prob_intervention_loading_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_cleaning_concs <- as.data.frame(partial_prob_intervention_cleaning_w3wed_conc_list)
partial_prob_intervention_cleaning_concs$area <- as.factor('cleaning')
partial_prob_intervention_cleaning_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_cleaning_concs$water <- as.factor('Wet')
names(partial_prob_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_sorting_concs <- as.data.frame(partial_prob_intervention_sorting_w3wed_conc_list)
partial_prob_intervention_sorting_concs$area <- as.factor('sorting')
partial_prob_intervention_sorting_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_sorting_concs$water <- as.factor('Dry')
names(partial_prob_intervention_sorting_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_reject_concs <- as.data.frame(partial_prob_intervention_reject_w3wed_conc_list)
partial_prob_intervention_reject_concs$area <- as.factor('reject')
partial_prob_intervention_reject_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_reject_concs$water <- as.factor('Dry')
names(partial_prob_intervention_reject_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_tray_packing_concs <- as.data.frame(partial_prob_intervention_tray_packing_w3wed_conc_list)
partial_prob_intervention_tray_packing_concs$area <- as.factor('tray packing')
partial_prob_intervention_tray_packing_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_tray_packing_concs$water <- as.factor('Dry')
names(partial_prob_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_other_concs <- as.data.frame(partial_prob_intervention_other_w3wed_conc_list)
partial_prob_intervention_other_concs$area <- as.factor('other')
partial_prob_intervention_other_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_other_concs$water <- as.factor('Dry')
names(partial_prob_intervention_other_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_w3wed_concs <- rbind(partial_prob_intervention_loading_concs,partial_prob_intervention_cleaning_concs,partial_prob_intervention_sorting_concs,partial_prob_intervention_tray_packing_concs,partial_prob_intervention_reject_concs,partial_prob_intervention_other_concs)

partial_prob_intervention_loading_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$loading_w3wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_loading_prev$area <- as.factor('loading')
partial_prob_intervention_loading_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_loading_prev$water <- as.factor('Wet')
names(partial_prob_intervention_loading_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_cleaning_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$cleaning_w3wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_cleaning_prev$area <- as.factor('cleaning')
partial_prob_intervention_cleaning_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_cleaning_prev$water <- as.factor('Wet')
names(partial_prob_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_sorting_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$sorting_w3wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_sorting_prev$area <- as.factor('sorting')
partial_prob_intervention_sorting_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_sorting_prev$water <- as.factor('Dry')
names(partial_prob_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_reject_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$reject_w3wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_reject_prev$area <- as.factor('reject')
partial_prob_intervention_reject_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_reject_prev$water <- as.factor('Dry')
names(partial_prob_intervention_reject_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_tray_packing_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$tray_packing_w3wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_tray_packing_prev$area <- as.factor('tray packing')
partial_prob_intervention_tray_packing_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_tray_packing_prev$water <- as.factor('Dry')
names(partial_prob_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_other_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$other_w3wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_other_prev$area <- as.factor('other')
partial_prob_intervention_other_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_other_prev$water <- as.factor('Dry')
names(partial_prob_intervention_other_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_w3wed_prev <- rbind(partial_prob_intervention_loading_prev,partial_prob_intervention_cleaning_prev,partial_prob_intervention_sorting_prev,partial_prob_intervention_tray_packing_prev,partial_prob_intervention_reject_prev,partial_prob_intervention_other_prev)

partial_prob_intervention_w3wed_wet_prev <- as.data.frame(partial_prob_intervention_loading_prev$prevalence*21/100+partial_prob_intervention_cleaning_prev$prevalence*28/100)/49*100
partial_prob_intervention_w3wed_wet_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_w3wed_wet_prev$water <- as.factor('Wet')
names(partial_prob_intervention_w3wed_wet_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_w3wed_dry_prev <- as.data.frame(partial_prob_intervention_sorting_prev$prevalence*20/100+partial_prob_intervention_reject_prev$prevalence*23/100+partial_prob_intervention_tray_packing_prev$prevalence*123/100+partial_prob_intervention_other_prev$prevalence*10/100)/176*100
partial_prob_intervention_w3wed_dry_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_w3wed_dry_prev$water <- as.factor('Dry')
names(partial_prob_intervention_w3wed_dry_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_w3wed_recombined_prev <- rbind(partial_prob_intervention_w3wed_wet_prev, partial_prob_intervention_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Partial_Prob_Intervention$loading_w4wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_loading_w4wed_conc_list <- append(partial_prob_intervention_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_loading_w4wed_conc_matrix <- matrix(unlist(partial_prob_intervention_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_cleaning_w4wed_conc_list <- append(partial_prob_intervention_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_cleaning_w4wed_conc_matrix <- matrix(unlist(partial_prob_intervention_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Partial_Prob_Intervention$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# partial_prob_intervention_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   partial_prob_intervention_drying_w4wed_conc_list <- append(partial_prob_intervention_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Partial_Prob_Intervention$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_sorting_w4wed_conc_list <- append(partial_prob_intervention_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_sorting_w4wed_conc_matrix <- matrix(unlist(partial_prob_intervention_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_tray_packing_w4wed_conc_list <- append(partial_prob_intervention_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_tray_packing_w4wed_conc_matrix <- matrix(unlist(partial_prob_intervention_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$reject_w4wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_reject_w4wed_conc_list <- append(partial_prob_intervention_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_reject_w4wed_conc_matrix <- matrix(unlist(partial_prob_intervention_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$other_w4wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_other_w4wed_conc_list <- append(partial_prob_intervention_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_other_w4wed_conc_matrix <- matrix(unlist(partial_prob_intervention_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

partial_prob_intervention_loading_concs <- as.data.frame(partial_prob_intervention_loading_w4wed_conc_list)
partial_prob_intervention_loading_concs$area <- as.factor('loading')
partial_prob_intervention_loading_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_loading_concs$water <- as.factor('Wet')
names(partial_prob_intervention_loading_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_cleaning_concs <- as.data.frame(partial_prob_intervention_cleaning_w4wed_conc_list)
partial_prob_intervention_cleaning_concs$area <- as.factor('cleaning')
partial_prob_intervention_cleaning_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_cleaning_concs$water <- as.factor('Wet')
names(partial_prob_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_sorting_concs <- as.data.frame(partial_prob_intervention_sorting_w4wed_conc_list)
partial_prob_intervention_sorting_concs$area <- as.factor('sorting')
partial_prob_intervention_sorting_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_sorting_concs$water <- as.factor('Dry')
names(partial_prob_intervention_sorting_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_reject_concs <- as.data.frame(partial_prob_intervention_reject_w4wed_conc_list)
partial_prob_intervention_reject_concs$area <- as.factor('reject')
partial_prob_intervention_reject_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_reject_concs$water <- as.factor('Dry')
names(partial_prob_intervention_reject_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_tray_packing_concs <- as.data.frame(partial_prob_intervention_tray_packing_w4wed_conc_list)
partial_prob_intervention_tray_packing_concs$area <- as.factor('tray packing')
partial_prob_intervention_tray_packing_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_tray_packing_concs$water <- as.factor('Dry')
names(partial_prob_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_other_concs <- as.data.frame(partial_prob_intervention_other_w4wed_conc_list)
partial_prob_intervention_other_concs$area <- as.factor('other')
partial_prob_intervention_other_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_other_concs$water <- as.factor('Dry')
names(partial_prob_intervention_other_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_w4wed_concs <- rbind(partial_prob_intervention_loading_concs,partial_prob_intervention_cleaning_concs,partial_prob_intervention_sorting_concs,partial_prob_intervention_tray_packing_concs,partial_prob_intervention_reject_concs,partial_prob_intervention_other_concs)

partial_prob_intervention_loading_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$loading_w4wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_loading_prev$area <- as.factor('loading')
partial_prob_intervention_loading_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_loading_prev$water <- as.factor('Wet')
names(partial_prob_intervention_loading_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_cleaning_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$cleaning_w4wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_cleaning_prev$area <- as.factor('cleaning')
partial_prob_intervention_cleaning_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_cleaning_prev$water <- as.factor('Wet')
names(partial_prob_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_sorting_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$sorting_w4wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_sorting_prev$area <- as.factor('sorting')
partial_prob_intervention_sorting_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_sorting_prev$water <- as.factor('Dry')
names(partial_prob_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_reject_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$reject_w4wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_reject_prev$area <- as.factor('reject')
partial_prob_intervention_reject_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_reject_prev$water <- as.factor('Dry')
names(partial_prob_intervention_reject_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_tray_packing_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$tray_packing_w4wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_tray_packing_prev$area <- as.factor('tray packing')
partial_prob_intervention_tray_packing_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_tray_packing_prev$water <- as.factor('Dry')
names(partial_prob_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_other_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$other_w4wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_other_prev$area <- as.factor('other')
partial_prob_intervention_other_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_other_prev$water <- as.factor('Dry')
names(partial_prob_intervention_other_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_w4wed_prev <- rbind(partial_prob_intervention_loading_prev,partial_prob_intervention_cleaning_prev,partial_prob_intervention_sorting_prev,partial_prob_intervention_tray_packing_prev,partial_prob_intervention_reject_prev,partial_prob_intervention_other_prev)

partial_prob_intervention_w4wed_wet_prev <- as.data.frame(partial_prob_intervention_loading_prev$prevalence*21/100+partial_prob_intervention_cleaning_prev$prevalence*28/100)/49*100
partial_prob_intervention_w4wed_wet_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_w4wed_wet_prev$water <- as.factor('Wet')
names(partial_prob_intervention_w4wed_wet_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_w4wed_dry_prev <- as.data.frame(partial_prob_intervention_sorting_prev$prevalence*20/100+partial_prob_intervention_reject_prev$prevalence*23/100+partial_prob_intervention_tray_packing_prev$prevalence*123/100+partial_prob_intervention_other_prev$prevalence*10/100)/176*100
partial_prob_intervention_w4wed_dry_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_w4wed_dry_prev$water <- as.factor('Dry')
names(partial_prob_intervention_w4wed_dry_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_w4wed_recombined_prev <- rbind(partial_prob_intervention_w4wed_wet_prev, partial_prob_intervention_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Partial_Prob_Intervention$loading_w5wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_loading_w5wed_conc_list <- append(partial_prob_intervention_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_loading_w5wed_conc_matrix <- matrix(unlist(partial_prob_intervention_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_cleaning_w5wed_conc_list <- append(partial_prob_intervention_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_cleaning_w5wed_conc_matrix <- matrix(unlist(partial_prob_intervention_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Partial_Prob_Intervention$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# partial_prob_intervention_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   partial_prob_intervention_drying_w5wed_conc_list <- append(partial_prob_intervention_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Partial_Prob_Intervention$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_sorting_w5wed_conc_list <- append(partial_prob_intervention_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_sorting_w5wed_conc_matrix <- matrix(unlist(partial_prob_intervention_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_tray_packing_w5wed_conc_list <- append(partial_prob_intervention_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_tray_packing_w5wed_conc_matrix <- matrix(unlist(partial_prob_intervention_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$reject_w5wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_reject_w5wed_conc_list <- append(partial_prob_intervention_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_reject_w5wed_conc_matrix <- matrix(unlist(partial_prob_intervention_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$other_w5wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_other_w5wed_conc_list <- append(partial_prob_intervention_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_other_w5wed_conc_matrix <- matrix(unlist(partial_prob_intervention_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

partial_prob_intervention_loading_concs <- as.data.frame(partial_prob_intervention_loading_w5wed_conc_list)
partial_prob_intervention_loading_concs$area <- as.factor('loading')
partial_prob_intervention_loading_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_loading_concs$water <- as.factor('Wet')
names(partial_prob_intervention_loading_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_cleaning_concs <- as.data.frame(partial_prob_intervention_cleaning_w5wed_conc_list)
partial_prob_intervention_cleaning_concs$area <- as.factor('cleaning')
partial_prob_intervention_cleaning_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_cleaning_concs$water <- as.factor('Wet')
names(partial_prob_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_sorting_concs <- as.data.frame(partial_prob_intervention_sorting_w5wed_conc_list)
partial_prob_intervention_sorting_concs$area <- as.factor('sorting')
partial_prob_intervention_sorting_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_sorting_concs$water <- as.factor('Dry')
names(partial_prob_intervention_sorting_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_reject_concs <- as.data.frame(partial_prob_intervention_reject_w5wed_conc_list)
partial_prob_intervention_reject_concs$area <- as.factor('reject')
partial_prob_intervention_reject_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_reject_concs$water <- as.factor('Dry')
names(partial_prob_intervention_reject_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_tray_packing_concs <- as.data.frame(partial_prob_intervention_tray_packing_w5wed_conc_list)
partial_prob_intervention_tray_packing_concs$area <- as.factor('tray packing')
partial_prob_intervention_tray_packing_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_tray_packing_concs$water <- as.factor('Dry')
names(partial_prob_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_other_concs <- as.data.frame(partial_prob_intervention_other_w5wed_conc_list)
partial_prob_intervention_other_concs$area <- as.factor('other')
partial_prob_intervention_other_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_other_concs$water <- as.factor('Dry')
names(partial_prob_intervention_other_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_w5wed_concs <- rbind(partial_prob_intervention_loading_concs,partial_prob_intervention_cleaning_concs,partial_prob_intervention_sorting_concs,partial_prob_intervention_tray_packing_concs,partial_prob_intervention_reject_concs,partial_prob_intervention_other_concs)

partial_prob_intervention_loading_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$loading_w5wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_loading_prev$area <- as.factor('loading')
partial_prob_intervention_loading_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_loading_prev$water <- as.factor('Wet')
names(partial_prob_intervention_loading_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_cleaning_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$cleaning_w5wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_cleaning_prev$area <- as.factor('cleaning')
partial_prob_intervention_cleaning_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_cleaning_prev$water <- as.factor('Wet')
names(partial_prob_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_sorting_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$sorting_w5wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_sorting_prev$area <- as.factor('sorting')
partial_prob_intervention_sorting_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_sorting_prev$water <- as.factor('Dry')
names(partial_prob_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_reject_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$reject_w5wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_reject_prev$area <- as.factor('reject')
partial_prob_intervention_reject_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_reject_prev$water <- as.factor('Dry')
names(partial_prob_intervention_reject_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_tray_packing_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$tray_packing_w5wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_tray_packing_prev$area <- as.factor('tray packing')
partial_prob_intervention_tray_packing_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_tray_packing_prev$water <- as.factor('Dry')
names(partial_prob_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_other_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$other_w5wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_other_prev$area <- as.factor('other')
partial_prob_intervention_other_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_other_prev$water <- as.factor('Dry')
names(partial_prob_intervention_other_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_w5wed_prev <- rbind(partial_prob_intervention_loading_prev,partial_prob_intervention_cleaning_prev,partial_prob_intervention_sorting_prev,partial_prob_intervention_tray_packing_prev,partial_prob_intervention_reject_prev,partial_prob_intervention_other_prev)

partial_prob_intervention_w5wed_wet_prev <- as.data.frame(partial_prob_intervention_loading_prev$prevalence*21/100+partial_prob_intervention_cleaning_prev$prevalence*28/100)/49*100
partial_prob_intervention_w5wed_wet_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_w5wed_wet_prev$water <- as.factor('Wet')
names(partial_prob_intervention_w5wed_wet_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_w5wed_dry_prev <- as.data.frame(partial_prob_intervention_sorting_prev$prevalence*20/100+partial_prob_intervention_reject_prev$prevalence*23/100+partial_prob_intervention_tray_packing_prev$prevalence*123/100+partial_prob_intervention_other_prev$prevalence*10/100)/176*100
partial_prob_intervention_w5wed_dry_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_w5wed_dry_prev$water <- as.factor('Dry')
names(partial_prob_intervention_w5wed_dry_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_w5wed_recombined_prev <- rbind(partial_prob_intervention_w5wed_wet_prev, partial_prob_intervention_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Partial_Prob_Intervention$loading_w6wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_loading_w6wed_conc_list <- append(partial_prob_intervention_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_loading_w6wed_conc_matrix <- matrix(unlist(partial_prob_intervention_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_cleaning_w6wed_conc_list <- append(partial_prob_intervention_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_cleaning_w6wed_conc_matrix <- matrix(unlist(partial_prob_intervention_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Partial_Prob_Intervention$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# partial_prob_intervention_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   partial_prob_intervention_drying_w6wed_conc_list <- append(partial_prob_intervention_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Partial_Prob_Intervention$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_sorting_w6wed_conc_list <- append(partial_prob_intervention_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_sorting_w6wed_conc_matrix <- matrix(unlist(partial_prob_intervention_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_tray_packing_w6wed_conc_list <- append(partial_prob_intervention_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_tray_packing_w6wed_conc_matrix <- matrix(unlist(partial_prob_intervention_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$reject_w6wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_reject_w6wed_conc_list <- append(partial_prob_intervention_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_reject_w6wed_conc_matrix <- matrix(unlist(partial_prob_intervention_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$other_w6wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_other_w6wed_conc_list <- append(partial_prob_intervention_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_other_w6wed_conc_matrix <- matrix(unlist(partial_prob_intervention_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

partial_prob_intervention_loading_concs <- as.data.frame(partial_prob_intervention_loading_w6wed_conc_list)
partial_prob_intervention_loading_concs$area <- as.factor('loading')
partial_prob_intervention_loading_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_loading_concs$water <- as.factor('Wet')
names(partial_prob_intervention_loading_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_cleaning_concs <- as.data.frame(partial_prob_intervention_cleaning_w6wed_conc_list)
partial_prob_intervention_cleaning_concs$area <- as.factor('cleaning')
partial_prob_intervention_cleaning_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_cleaning_concs$water <- as.factor('Wet')
names(partial_prob_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_sorting_concs <- as.data.frame(partial_prob_intervention_sorting_w6wed_conc_list)
partial_prob_intervention_sorting_concs$area <- as.factor('sorting')
partial_prob_intervention_sorting_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_sorting_concs$water <- as.factor('Dry')
names(partial_prob_intervention_sorting_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_reject_concs <- as.data.frame(partial_prob_intervention_reject_w6wed_conc_list)
partial_prob_intervention_reject_concs$area <- as.factor('reject')
partial_prob_intervention_reject_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_reject_concs$water <- as.factor('Dry')
names(partial_prob_intervention_reject_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_tray_packing_concs <- as.data.frame(partial_prob_intervention_tray_packing_w6wed_conc_list)
partial_prob_intervention_tray_packing_concs$area <- as.factor('tray packing')
partial_prob_intervention_tray_packing_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_tray_packing_concs$water <- as.factor('Dry')
names(partial_prob_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_other_concs <- as.data.frame(partial_prob_intervention_other_w6wed_conc_list)
partial_prob_intervention_other_concs$area <- as.factor('other')
partial_prob_intervention_other_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_other_concs$water <- as.factor('Dry')
names(partial_prob_intervention_other_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_w6wed_concs <- rbind(partial_prob_intervention_loading_concs,partial_prob_intervention_cleaning_concs,partial_prob_intervention_sorting_concs,partial_prob_intervention_tray_packing_concs,partial_prob_intervention_reject_concs,partial_prob_intervention_other_concs)

partial_prob_intervention_loading_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$loading_w6wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_loading_prev$area <- as.factor('loading')
partial_prob_intervention_loading_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_loading_prev$water <- as.factor('Wet')
names(partial_prob_intervention_loading_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_cleaning_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$cleaning_w6wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_cleaning_prev$area <- as.factor('cleaning')
partial_prob_intervention_cleaning_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_cleaning_prev$water <- as.factor('Wet')
names(partial_prob_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_sorting_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$sorting_w6wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_sorting_prev$area <- as.factor('sorting')
partial_prob_intervention_sorting_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_sorting_prev$water <- as.factor('Dry')
names(partial_prob_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_reject_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$reject_w6wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_reject_prev$area <- as.factor('reject')
partial_prob_intervention_reject_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_reject_prev$water <- as.factor('Dry')
names(partial_prob_intervention_reject_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_tray_packing_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$tray_packing_w6wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_tray_packing_prev$area <- as.factor('tray packing')
partial_prob_intervention_tray_packing_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_tray_packing_prev$water <- as.factor('Dry')
names(partial_prob_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_other_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$other_w6wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_other_prev$area <- as.factor('other')
partial_prob_intervention_other_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_other_prev$water <- as.factor('Dry')
names(partial_prob_intervention_other_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_w6wed_prev <- rbind(partial_prob_intervention_loading_prev,partial_prob_intervention_cleaning_prev,partial_prob_intervention_sorting_prev,partial_prob_intervention_tray_packing_prev,partial_prob_intervention_reject_prev,partial_prob_intervention_other_prev)

partial_prob_intervention_w6wed_wet_prev <- as.data.frame(partial_prob_intervention_loading_prev$prevalence*21/100+partial_prob_intervention_cleaning_prev$prevalence*28/100)/49*100
partial_prob_intervention_w6wed_wet_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_w6wed_wet_prev$water <- as.factor('Wet')
names(partial_prob_intervention_w6wed_wet_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_w6wed_dry_prev <- as.data.frame(partial_prob_intervention_sorting_prev$prevalence*20/100+partial_prob_intervention_reject_prev$prevalence*23/100+partial_prob_intervention_tray_packing_prev$prevalence*123/100+partial_prob_intervention_other_prev$prevalence*10/100)/176*100
partial_prob_intervention_w6wed_dry_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_w6wed_dry_prev$water <- as.factor('Dry')
names(partial_prob_intervention_w6wed_dry_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_w6wed_recombined_prev <- rbind(partial_prob_intervention_w6wed_wet_prev, partial_prob_intervention_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Partial_Prob_Intervention$loading_w7wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_loading_w7wed_conc_list <- append(partial_prob_intervention_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_loading_w7wed_conc_matrix <- matrix(unlist(partial_prob_intervention_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_cleaning_w7wed_conc_list <- append(partial_prob_intervention_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_cleaning_w7wed_conc_matrix <- matrix(unlist(partial_prob_intervention_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Partial_Prob_Intervention$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# partial_prob_intervention_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   partial_prob_intervention_drying_w7wed_conc_list <- append(partial_prob_intervention_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Partial_Prob_Intervention$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_sorting_w7wed_conc_list <- append(partial_prob_intervention_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_sorting_w7wed_conc_matrix <- matrix(unlist(partial_prob_intervention_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_tray_packing_w7wed_conc_list <- append(partial_prob_intervention_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_tray_packing_w7wed_conc_matrix <- matrix(unlist(partial_prob_intervention_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$reject_w7wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_reject_w7wed_conc_list <- append(partial_prob_intervention_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_reject_w7wed_conc_matrix <- matrix(unlist(partial_prob_intervention_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$other_w7wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_other_w7wed_conc_list <- append(partial_prob_intervention_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_other_w7wed_conc_matrix <- matrix(unlist(partial_prob_intervention_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

partial_prob_intervention_loading_concs <- as.data.frame(partial_prob_intervention_loading_w7wed_conc_list)
partial_prob_intervention_loading_concs$area <- as.factor('loading')
partial_prob_intervention_loading_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_loading_concs$water <- as.factor('Wet')
names(partial_prob_intervention_loading_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_cleaning_concs <- as.data.frame(partial_prob_intervention_cleaning_w7wed_conc_list)
partial_prob_intervention_cleaning_concs$area <- as.factor('cleaning')
partial_prob_intervention_cleaning_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_cleaning_concs$water <- as.factor('Wet')
names(partial_prob_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_sorting_concs <- as.data.frame(partial_prob_intervention_sorting_w7wed_conc_list)
partial_prob_intervention_sorting_concs$area <- as.factor('sorting')
partial_prob_intervention_sorting_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_sorting_concs$water <- as.factor('Dry')
names(partial_prob_intervention_sorting_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_reject_concs <- as.data.frame(partial_prob_intervention_reject_w7wed_conc_list)
partial_prob_intervention_reject_concs$area <- as.factor('reject')
partial_prob_intervention_reject_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_reject_concs$water <- as.factor('Dry')
names(partial_prob_intervention_reject_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_tray_packing_concs <- as.data.frame(partial_prob_intervention_tray_packing_w7wed_conc_list)
partial_prob_intervention_tray_packing_concs$area <- as.factor('tray packing')
partial_prob_intervention_tray_packing_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_tray_packing_concs$water <- as.factor('Dry')
names(partial_prob_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_other_concs <- as.data.frame(partial_prob_intervention_other_w7wed_conc_list)
partial_prob_intervention_other_concs$area <- as.factor('other')
partial_prob_intervention_other_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_other_concs$water <- as.factor('Dry')
names(partial_prob_intervention_other_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_w7wed_concs <- rbind(partial_prob_intervention_loading_concs,partial_prob_intervention_cleaning_concs,partial_prob_intervention_sorting_concs,partial_prob_intervention_tray_packing_concs,partial_prob_intervention_reject_concs,partial_prob_intervention_other_concs)

partial_prob_intervention_loading_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$loading_w7wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_loading_prev$area <- as.factor('loading')
partial_prob_intervention_loading_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_loading_prev$water <- as.factor('Wet')
names(partial_prob_intervention_loading_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_cleaning_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$cleaning_w7wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_cleaning_prev$area <- as.factor('cleaning')
partial_prob_intervention_cleaning_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_cleaning_prev$water <- as.factor('Wet')
names(partial_prob_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_sorting_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$sorting_w7wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_sorting_prev$area <- as.factor('sorting')
partial_prob_intervention_sorting_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_sorting_prev$water <- as.factor('Dry')
names(partial_prob_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_reject_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$reject_w7wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_reject_prev$area <- as.factor('reject')
partial_prob_intervention_reject_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_reject_prev$water <- as.factor('Dry')
names(partial_prob_intervention_reject_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_tray_packing_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$tray_packing_w7wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_tray_packing_prev$area <- as.factor('tray packing')
partial_prob_intervention_tray_packing_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_tray_packing_prev$water <- as.factor('Dry')
names(partial_prob_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_other_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$other_w7wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_other_prev$area <- as.factor('other')
partial_prob_intervention_other_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_other_prev$water <- as.factor('Dry')
names(partial_prob_intervention_other_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_w7wed_prev <- rbind(partial_prob_intervention_loading_prev,partial_prob_intervention_cleaning_prev,partial_prob_intervention_sorting_prev,partial_prob_intervention_tray_packing_prev,partial_prob_intervention_reject_prev,partial_prob_intervention_other_prev)

partial_prob_intervention_w7wed_wet_prev <- as.data.frame(partial_prob_intervention_loading_prev$prevalence*21/100+partial_prob_intervention_cleaning_prev$prevalence*28/100)/49*100
partial_prob_intervention_w7wed_wet_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_w7wed_wet_prev$water <- as.factor('Wet')
names(partial_prob_intervention_w7wed_wet_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_w7wed_dry_prev <- as.data.frame(partial_prob_intervention_sorting_prev$prevalence*20/100+partial_prob_intervention_reject_prev$prevalence*23/100+partial_prob_intervention_tray_packing_prev$prevalence*123/100+partial_prob_intervention_other_prev$prevalence*10/100)/176*100
partial_prob_intervention_w7wed_dry_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_w7wed_dry_prev$water <- as.factor('Dry')
names(partial_prob_intervention_w7wed_dry_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_w7wed_recombined_prev <- rbind(partial_prob_intervention_w7wed_wet_prev, partial_prob_intervention_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Partial_Prob_Intervention$loading_w8wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_loading_w8wed_conc_list <- append(partial_prob_intervention_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_loading_w8wed_conc_matrix <- matrix(unlist(partial_prob_intervention_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_cleaning_w8wed_conc_list <- append(partial_prob_intervention_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_cleaning_w8wed_conc_matrix <- matrix(unlist(partial_prob_intervention_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Partial_Prob_Intervention$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# partial_prob_intervention_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   partial_prob_intervention_drying_w8wed_conc_list <- append(partial_prob_intervention_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Partial_Prob_Intervention$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_sorting_w8wed_conc_list <- append(partial_prob_intervention_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_sorting_w8wed_conc_matrix <- matrix(unlist(partial_prob_intervention_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_tray_packing_w8wed_conc_list <- append(partial_prob_intervention_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_tray_packing_w8wed_conc_matrix <- matrix(unlist(partial_prob_intervention_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$reject_w8wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_reject_w8wed_conc_list <- append(partial_prob_intervention_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_reject_w8wed_conc_matrix <- matrix(unlist(partial_prob_intervention_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Partial_Prob_Intervention$other_w8wed_conc_list
vector <- vector[vector!='[]']
partial_prob_intervention_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  partial_prob_intervention_other_w8wed_conc_list <- append(partial_prob_intervention_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
partial_prob_intervention_other_w8wed_conc_matrix <- matrix(unlist(partial_prob_intervention_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

partial_prob_intervention_loading_concs <- as.data.frame(partial_prob_intervention_loading_w8wed_conc_list)
partial_prob_intervention_loading_concs$area <- as.factor('loading')
partial_prob_intervention_loading_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_loading_concs$water <- as.factor('Wet')
names(partial_prob_intervention_loading_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_cleaning_concs <- as.data.frame(partial_prob_intervention_cleaning_w8wed_conc_list)
partial_prob_intervention_cleaning_concs$area <- as.factor('cleaning')
partial_prob_intervention_cleaning_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_cleaning_concs$water <- as.factor('Wet')
names(partial_prob_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_sorting_concs <- as.data.frame(partial_prob_intervention_sorting_w8wed_conc_list)
partial_prob_intervention_sorting_concs$area <- as.factor('sorting')
partial_prob_intervention_sorting_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_sorting_concs$water <- as.factor('Dry')
names(partial_prob_intervention_sorting_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_reject_concs <- as.data.frame(partial_prob_intervention_reject_w8wed_conc_list)
partial_prob_intervention_reject_concs$area <- as.factor('reject')
partial_prob_intervention_reject_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_reject_concs$water <- as.factor('Dry')
names(partial_prob_intervention_reject_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_tray_packing_concs <- as.data.frame(partial_prob_intervention_tray_packing_w8wed_conc_list)
partial_prob_intervention_tray_packing_concs$area <- as.factor('tray packing')
partial_prob_intervention_tray_packing_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_tray_packing_concs$water <- as.factor('Dry')
names(partial_prob_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_other_concs <- as.data.frame(partial_prob_intervention_other_w8wed_conc_list)
partial_prob_intervention_other_concs$area <- as.factor('other')
partial_prob_intervention_other_concs$scenario <- as.factor('AI_03')
partial_prob_intervention_other_concs$water <- as.factor('Dry')
names(partial_prob_intervention_other_concs) <- c('concentration','area','scenario','water')

partial_prob_intervention_w8wed_concs <- rbind(partial_prob_intervention_loading_concs,partial_prob_intervention_cleaning_concs,partial_prob_intervention_sorting_concs,partial_prob_intervention_tray_packing_concs,partial_prob_intervention_reject_concs,partial_prob_intervention_other_concs)

partial_prob_intervention_loading_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$loading_w8wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_loading_prev$area <- as.factor('loading')
partial_prob_intervention_loading_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_loading_prev$water <- as.factor('Wet')
names(partial_prob_intervention_loading_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_cleaning_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$cleaning_w8wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_cleaning_prev$area <- as.factor('cleaning')
partial_prob_intervention_cleaning_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_cleaning_prev$water <- as.factor('Wet')
names(partial_prob_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_sorting_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$sorting_w8wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_sorting_prev$area <- as.factor('sorting')
partial_prob_intervention_sorting_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_sorting_prev$water <- as.factor('Dry')
names(partial_prob_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_reject_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$reject_w8wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_reject_prev$area <- as.factor('reject')
partial_prob_intervention_reject_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_reject_prev$water <- as.factor('Dry')
names(partial_prob_intervention_reject_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_tray_packing_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$tray_packing_w8wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_tray_packing_prev$area <- as.factor('tray packing')
partial_prob_intervention_tray_packing_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_tray_packing_prev$water <- as.factor('Dry')
names(partial_prob_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_other_prev <- as.data.frame(NL_table_Partial_Prob_Intervention$other_w8wed_prev[order(NL_table_Partial_Prob_Intervention$local_seed)])
partial_prob_intervention_other_prev$area <- as.factor('other')
partial_prob_intervention_other_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_other_prev$water <- as.factor('Dry')
names(partial_prob_intervention_other_prev) <- c('prevalence','area','scenario','water')

partial_prob_intervention_w8wed_prev <- rbind(partial_prob_intervention_loading_prev,partial_prob_intervention_cleaning_prev,partial_prob_intervention_sorting_prev,partial_prob_intervention_tray_packing_prev,partial_prob_intervention_reject_prev,partial_prob_intervention_other_prev)

partial_prob_intervention_w8wed_wet_prev <- as.data.frame(partial_prob_intervention_loading_prev$prevalence*21/100+partial_prob_intervention_cleaning_prev$prevalence*28/100)/49*100
partial_prob_intervention_w8wed_wet_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_w8wed_wet_prev$water <- as.factor('Wet')
names(partial_prob_intervention_w8wed_wet_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_w8wed_dry_prev <- as.data.frame(partial_prob_intervention_sorting_prev$prevalence*20/100+partial_prob_intervention_reject_prev$prevalence*23/100+partial_prob_intervention_tray_packing_prev$prevalence*123/100+partial_prob_intervention_other_prev$prevalence*10/100)/176*100
partial_prob_intervention_w8wed_dry_prev$scenario <- as.factor('AI_03')
partial_prob_intervention_w8wed_dry_prev$water <- as.factor('Dry')
names(partial_prob_intervention_w8wed_dry_prev) <- c('prevalence','scenario','water')

partial_prob_intervention_w8wed_recombined_prev <- rbind(partial_prob_intervention_w8wed_wet_prev, partial_prob_intervention_w8wed_dry_prev)

partial_prob_intervention_w1wed_prev$week <- as.factor(1)
partial_prob_intervention_w2wed_prev$week <- as.factor(2)
partial_prob_intervention_w3wed_prev$week <- as.factor(3)
partial_prob_intervention_w4wed_prev$week <- as.factor(4)
partial_prob_intervention_w5wed_prev$week <- as.factor(5)
partial_prob_intervention_w6wed_prev$week <- as.factor(6)
partial_prob_intervention_w7wed_prev$week <- as.factor(7)
partial_prob_intervention_w8wed_prev$week <- as.factor(8)

partial_prob_intervention_w1wed_recombined_prev$week <- as.factor(1)
partial_prob_intervention_w2wed_recombined_prev$week <- as.factor(2)
partial_prob_intervention_w3wed_recombined_prev$week <- as.factor(3)
partial_prob_intervention_w4wed_recombined_prev$week <- as.factor(4)
partial_prob_intervention_w5wed_recombined_prev$week <- as.factor(5)
partial_prob_intervention_w6wed_recombined_prev$week <- as.factor(6)
partial_prob_intervention_w7wed_recombined_prev$week <- as.factor(7)
partial_prob_intervention_w8wed_recombined_prev$week <- as.factor(8)
partial_prob_intervention_allwed_prev <- rbind(partial_prob_intervention_w1wed_recombined_prev,partial_prob_intervention_w2wed_recombined_prev,partial_prob_intervention_w3wed_recombined_prev,partial_prob_intervention_w4wed_recombined_prev,partial_prob_intervention_w5wed_recombined_prev,partial_prob_intervention_w6wed_recombined_prev,partial_prob_intervention_w7wed_recombined_prev,partial_prob_intervention_w8wed_recombined_prev)

vector <- NL_table_Partial_Prob_Intervention$lifetime_conc_list[order(NL_table_Partial_Prob_Intervention$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

partial_prob_intervention_w1wed_recombined_prev$week <- as.factor(1)
partial_prob_intervention_w2wed_recombined_prev$week <- as.factor(2)
partial_prob_intervention_w3wed_recombined_prev$week <- as.factor(3)
partial_prob_intervention_w4wed_recombined_prev$week <- as.factor(4)
partial_prob_intervention_w5wed_recombined_prev$week <- as.factor(5)
partial_prob_intervention_w6wed_recombined_prev$week <- as.factor(6)
partial_prob_intervention_w7wed_recombined_prev$week <- as.factor(7)
partial_prob_intervention_w8wed_recombined_prev$week <- as.factor(8)
partial_prob_intervention_allwed_prev <- rbind(partial_prob_intervention_w1wed_recombined_prev,partial_prob_intervention_w2wed_recombined_prev,partial_prob_intervention_w3wed_recombined_prev,partial_prob_intervention_w4wed_recombined_prev,partial_prob_intervention_w5wed_recombined_prev,partial_prob_intervention_w6wed_recombined_prev,partial_prob_intervention_w7wed_recombined_prev,partial_prob_intervention_w8wed_recombined_prev)

Facility_B_partial_prob_intervention_agents_melted <- melt(mdarray)
colnames(Facility_B_partial_prob_intervention_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_partial_prob_intervention_agents_melted$agent <- Facility_B_partial_prob_intervention_agents_melted$agent-1
Facility_B_partial_prob_intervention_agents_melted$logical <- Facility_B_partial_prob_intervention_agents_melted$value>0
Facility_B_partial_prob_intervention_agents_melted$binary <- as.numeric(Facility_B_partial_prob_intervention_agents_melted$logical)
Facility_B_partial_prob_intervention_agents_melted$log10value <- log10(Facility_B_partial_prob_intervention_agents_melted$value)
Facility_B_partial_prob_intervention_agents_melted$log10value[is.infinite(Facility_B_partial_prob_intervention_agents_melted$log10value)] <- 0

agent <- Facility_B_partial_prob_intervention_agents_melted$agent
iteration <- Facility_B_partial_prob_intervention_agents_melted$iteration
tick <- Facility_B_partial_prob_intervention_agents_melted$tick
rle_matrix <- tapply(Facility_B_partial_prob_intervention_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_partial_prob_intervention_mean_value_matrix <- tapply(Facility_B_partial_prob_intervention_agents_melted$value, list(agent, tick), mean)
Facility_B_partial_prob_intervention_median_value_matrix <- tapply(Facility_B_partial_prob_intervention_agents_melted$value, list(agent, tick), median)
x <- Facility_B_partial_prob_intervention_agents_melted
x$value[x$value==0] <- NA
Facility_B_partial_prob_intervention_pos_median_value_matrix <- tapply(x$value, list(agent, tick), median, na.rm=TRUE)
Facility_B_partial_prob_intervention_prob_value_matrix <- tapply(Facility_B_partial_prob_intervention_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

#Maximum sensitivity####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_partial_prob_intervention <- durations

agents_list_partial_prob_intervention <- read.table(paste0(getwd(),'/Data/Agents - Partial Prob Intervention.txt'))
agents_list_partial_prob_intervention <- agents_list_partial_prob_intervention[,c("V1","V7","V8","V9")]
colnames(agents_list_partial_prob_intervention) <- c("name","sanitation_status","schedule","area")
#Time to persistence
agents_list_partial_prob_intervention$time_to_persistence <- rep((168*2),225)
agents_list_partial_prob_intervention$time_to_persistence[agents_list_partial_prob_intervention$schedule=="daily"] <- (24*2)

persistent_short_durations_list_partial_prob_intervention <- data.frame()
persistent_long_durations_list_partial_prob_intervention <- data.frame()
persistent_uncleanable_durations_list_partial_prob_intervention <- data.frame()
transient_short_durations_list_partial_prob_intervention <- data.frame()
transient_long_durations_list_partial_prob_intervention <- data.frame()
transient_uncleanable_durations_list_partial_prob_intervention <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_partial_prob_intervention$min_duration[agent] <- ifelse(length(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent])==0,NA,min(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_partial_prob_intervention$mean_duration[agent] <- ifelse(length(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent])==0,NA,mean(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_partial_prob_intervention$median_duration[agent] <- ifelse(length(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent])==0,NA,median(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_partial_prob_intervention$max_duration[agent] <- ifelse(length(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent])==0,NA,max(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_partial_prob_intervention$contamination_events[agent] <- sum(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_partial_prob_intervention$times_persistent[agent] <- sum(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent]>agents_list_partial_prob_intervention$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_partial_prob_intervention$q1_duration[agent] <- quantile(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_partial_prob_intervention$q3_duration[agent] <- quantile(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_partial_prob_intervention$min_persistent_duration[agent] <- ifelse((length(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent])==0) || (agents_list_partial_prob_intervention$times_persistent[agent]==0),NA,min(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent & Facility_B_durations_partial_prob_intervention$duration>=agents_list_partial_prob_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_partial_prob_intervention$mean_persistent_duration[agent] <- ifelse((length(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent])==0) || (agents_list_partial_prob_intervention$times_persistent[agent]==0),NA,mean(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent & Facility_B_durations_partial_prob_intervention$duration>=agents_list_partial_prob_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_partial_prob_intervention$median_persistent_duration[agent] <- ifelse((length(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent])==0) || (agents_list_partial_prob_intervention$times_persistent[agent]==0),NA,median(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent & Facility_B_durations_partial_prob_intervention$duration>=agents_list_partial_prob_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_partial_prob_intervention$max_persistent_duration[agent] <- ifelse((length(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent])==0) || (agents_list_partial_prob_intervention$times_persistent[agent]==0),NA,max(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent & Facility_B_durations_partial_prob_intervention$duration>=agents_list_partial_prob_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_partial_prob_intervention$q1_persistent_duration[agent] <- ifelse((length(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent])==0) || (agents_list_partial_prob_intervention$times_persistent[agent]==0),NA,quantile(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent & Facility_B_durations_partial_prob_intervention$duration>=agents_list_partial_prob_intervention$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_partial_prob_intervention$q3_persistent_duration[agent] <- ifelse((length(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent])==0) || (agents_list_partial_prob_intervention$times_persistent[agent]==0),NA,quantile(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent & Facility_B_durations_partial_prob_intervention$duration>=agents_list_partial_prob_intervention$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations
  x <- Facility_B_durations_partial_prob_intervention[which(Facility_B_durations_partial_prob_intervention$agent==agent & Facility_B_durations_partial_prob_intervention$duration>agents_list_partial_prob_intervention$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean
  agents_list_partial_prob_intervention$mean_times_persistent[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_partial_prob_intervention$mean_times_persistent[which(is.na(agents_list_partial_prob_intervention$mean_times_persistent))] <- 0
  #Division by total number of iterations in simulation
  agents_list_partial_prob_intervention$balanced_times_persistent[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_partial_prob_intervention$duration[Facility_B_durations_partial_prob_intervention$agent==agent])!=0) || (agents_list_partial_prob_intervention$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_partial_prob_intervention$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_partial_prob_intervention <- rbind(
        persistent_short_durations_list_partial_prob_intervention,
        Facility_B_durations_partial_prob_intervention[Facility_B_durations_partial_prob_intervention$agent==agent & Facility_B_durations_partial_prob_intervention$duration>agents_list_partial_prob_intervention$time_to_persistence[agent],]
      )
    } else if(agents_list_partial_prob_intervention$time_to_persistence[agent]==336 && agents_list_partial_prob_intervention$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_partial_prob_intervention <- rbind(
        persistent_long_durations_list_partial_prob_intervention,
        Facility_B_durations_partial_prob_intervention[Facility_B_durations_partial_prob_intervention$agent==agent & Facility_B_durations_partial_prob_intervention$duration>agents_list_partial_prob_intervention$time_to_persistence[agent],]
      )
    } else if(agents_list_partial_prob_intervention$time_to_persistence[agent]==336 && agents_list_partial_prob_intervention$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_partial_prob_intervention <- rbind(
        persistent_uncleanable_durations_list_partial_prob_intervention,
        Facility_B_durations_partial_prob_intervention[Facility_B_durations_partial_prob_intervention$agent==agent & Facility_B_durations_partial_prob_intervention$duration>agents_list_partial_prob_intervention$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_partial_prob_intervention$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_partial_prob_intervention <- rbind(
      transient_short_durations_list_partial_prob_intervention,
      Facility_B_durations_partial_prob_intervention[Facility_B_durations_partial_prob_intervention$agent==agent & Facility_B_durations_partial_prob_intervention$duration<=agents_list_partial_prob_intervention$time_to_persistence[agent],]
    )
  } else if(agents_list_partial_prob_intervention$time_to_persistence[agent]==336 && agents_list_partial_prob_intervention$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_partial_prob_intervention <- rbind(
      transient_long_durations_list_partial_prob_intervention,
      Facility_B_durations_partial_prob_intervention[Facility_B_durations_partial_prob_intervention$agent==agent & Facility_B_durations_partial_prob_intervention$duration<=agents_list_partial_prob_intervention$time_to_persistence[agent],]
    )
  } else if(agents_list_partial_prob_intervention$time_to_persistence[agent]==336 && agents_list_partial_prob_intervention$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_partial_prob_intervention <- rbind(
      transient_uncleanable_durations_list_partial_prob_intervention,
      Facility_B_durations_partial_prob_intervention[Facility_B_durations_partial_prob_intervention$agent==agent & Facility_B_durations_partial_prob_intervention$duration<=agents_list_partial_prob_intervention$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

#10 cells minimum####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>9)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_partial_prob_intervention_10min <- durations

persistent_short_durations_list_partial_prob_intervention_10min <- data.frame()
persistent_long_durations_list_partial_prob_intervention_10min <- data.frame()
persistent_uncleanable_durations_list_partial_prob_intervention_10min <- data.frame()
transient_short_durations_list_partial_prob_intervention_10min <- data.frame()
transient_long_durations_list_partial_prob_intervention_10min <- data.frame()
transient_uncleanable_durations_list_partial_prob_intervention_10min <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_partial_prob_intervention$min_duration_10min[agent] <- ifelse(length(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent])==0,NA,min(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_partial_prob_intervention$mean_duration_10min[agent] <- ifelse(length(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent])==0,NA,mean(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_partial_prob_intervention$median_duration_10min[agent] <- ifelse(length(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent])==0,NA,median(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_partial_prob_intervention$max_duration_10min[agent] <- ifelse(length(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent])==0,NA,max(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_partial_prob_intervention$contamination_events_10min[agent] <- sum(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_partial_prob_intervention$times_persistent_10min[agent] <- sum(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent]>agents_list_partial_prob_intervention$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_partial_prob_intervention$q1_duration_10min[agent] <- quantile(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_partial_prob_intervention$q3_duration_10min[agent] <- quantile(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_partial_prob_intervention$min_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent])==0) || (agents_list_partial_prob_intervention$times_persistent_10min[agent]==0),NA,min(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent & Facility_B_durations_partial_prob_intervention_10min$duration>=agents_list_partial_prob_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_partial_prob_intervention$mean_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent])==0) || (agents_list_partial_prob_intervention$times_persistent_10min[agent]==0),NA,mean(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent & Facility_B_durations_partial_prob_intervention_10min$duration>=agents_list_partial_prob_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_partial_prob_intervention$median_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent])==0) || (agents_list_partial_prob_intervention$times_persistent_10min[agent]==0),NA,median(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent & Facility_B_durations_partial_prob_intervention_10min$duration>=agents_list_partial_prob_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_partial_prob_intervention$max_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent])==0) || (agents_list_partial_prob_intervention$times_persistent_10min[agent]==0),NA,max(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent & Facility_B_durations_partial_prob_intervention_10min$duration>=agents_list_partial_prob_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_partial_prob_intervention$q1_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent])==0) || (agents_list_partial_prob_intervention$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent & Facility_B_durations_partial_prob_intervention_10min$duration>=agents_list_partial_prob_intervention$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_partial_prob_intervention$q3_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent])==0) || (agents_list_partial_prob_intervention$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent & Facility_B_durations_partial_prob_intervention_10min$duration>=agents_list_partial_prob_intervention$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations (Does not account for iterations with 0 events)
  x <- Facility_B_durations_partial_prob_intervention_10min[which(Facility_B_durations_partial_prob_intervention_10min$agent==agent & Facility_B_durations_partial_prob_intervention_10min$duration>agents_list_partial_prob_intervention$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean (Does account for iterations with 0 events)
  agents_list_partial_prob_intervention$mean_times_persistent_10min[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_partial_prob_intervention$mean_times_persistent_10min[which(is.na(agents_list_partial_prob_intervention$mean_times_persistent_10min))] <- 0
  #Division by total number of iterations in simulation
  agents_list_partial_prob_intervention$balanced_times_persistent_10min[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_partial_prob_intervention_10min$duration[Facility_B_durations_partial_prob_intervention_10min$agent==agent])!=0) || (agents_list_partial_prob_intervention$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_partial_prob_intervention$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_partial_prob_intervention_10min <- rbind(
        persistent_short_durations_list_partial_prob_intervention_10min,
        Facility_B_durations_partial_prob_intervention_10min[Facility_B_durations_partial_prob_intervention_10min$agent==agent & Facility_B_durations_partial_prob_intervention_10min$duration>agents_list_partial_prob_intervention$time_to_persistence[agent],]
      )
    } else if(agents_list_partial_prob_intervention$time_to_persistence[agent]==336 && agents_list_partial_prob_intervention$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_partial_prob_intervention_10min <- rbind(
        persistent_long_durations_list_partial_prob_intervention_10min,
        Facility_B_durations_partial_prob_intervention_10min[Facility_B_durations_partial_prob_intervention_10min$agent==agent & Facility_B_durations_partial_prob_intervention_10min$duration>agents_list_partial_prob_intervention$time_to_persistence[agent],]
      )
    } else if(agents_list_partial_prob_intervention$time_to_persistence[agent]==336 && agents_list_partial_prob_intervention$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_partial_prob_intervention_10min <- rbind(
        persistent_uncleanable_durations_list_partial_prob_intervention_10min,
        Facility_B_durations_partial_prob_intervention_10min[Facility_B_durations_partial_prob_intervention_10min$agent==agent & Facility_B_durations_partial_prob_intervention_10min$duration>agents_list_partial_prob_intervention$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_partial_prob_intervention$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_partial_prob_intervention_10min <- rbind(
      transient_short_durations_list_partial_prob_intervention_10min,
      Facility_B_durations_partial_prob_intervention_10min[Facility_B_durations_partial_prob_intervention_10min$agent==agent & Facility_B_durations_partial_prob_intervention_10min$duration<=agents_list_partial_prob_intervention$time_to_persistence[agent],]
    )
  } else if(agents_list_partial_prob_intervention$time_to_persistence[agent]==336 && agents_list_partial_prob_intervention$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_partial_prob_intervention_10min <- rbind(
      transient_long_durations_list_partial_prob_intervention_10min,
      Facility_B_durations_partial_prob_intervention_10min[Facility_B_durations_partial_prob_intervention_10min$agent==agent & Facility_B_durations_partial_prob_intervention_10min$duration<=agents_list_partial_prob_intervention$time_to_persistence[agent],]
    )
  } else if(agents_list_partial_prob_intervention$time_to_persistence[agent]==336 && agents_list_partial_prob_intervention$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_partial_prob_intervention_10min <- rbind(
      transient_uncleanable_durations_list_partial_prob_intervention_10min,
      Facility_B_durations_partial_prob_intervention_10min[Facility_B_durations_partial_prob_intervention_10min$agent==agent & Facility_B_durations_partial_prob_intervention_10min$duration<=agents_list_partial_prob_intervention$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

# Facility_B_partial_prob_intervention_agents_melted_monday_preop <- Facility_B_partial_prob_intervention_agents_melted[which(Facility_B_partial_prob_intervention_agents_melted$tick==33|Facility_B_partial_prob_intervention_agents_melted$tick==201|Facility_B_partial_prob_intervention_agents_melted$tick==369|Facility_B_partial_prob_intervention_agents_melted$tick==537|Facility_B_partial_prob_intervention_agents_melted$tick==705|Facility_B_partial_prob_intervention_agents_melted$tick==873|Facility_B_partial_prob_intervention_agents_melted$tick==1041|Facility_B_partial_prob_intervention_agents_melted$tick==1209),]
# 
# Facility_B_partial_prob_intervention_agents_melted_tuesday_preop <- Facility_B_partial_prob_intervention_agents_melted[which(Facility_B_partial_prob_intervention_agents_melted$tick==57|Facility_B_partial_prob_intervention_agents_melted$tick==225|Facility_B_partial_prob_intervention_agents_melted$tick==393|Facility_B_partial_prob_intervention_agents_melted$tick==561|Facility_B_partial_prob_intervention_agents_melted$tick==729|Facility_B_partial_prob_intervention_agents_melted$tick==897|Facility_B_partial_prob_intervention_agents_melted$tick==1065|Facility_B_partial_prob_intervention_agents_melted$tick==1233),]
# 
# Facility_B_partial_prob_intervention_agents_melted_wednesday_preop <- Facility_B_partial_prob_intervention_agents_melted[which(Facility_B_partial_prob_intervention_agents_melted$tick==81|Facility_B_partial_prob_intervention_agents_melted$tick==249|Facility_B_partial_prob_intervention_agents_melted$tick==417|Facility_B_partial_prob_intervention_agents_melted$tick==585|Facility_B_partial_prob_intervention_agents_melted$tick==753|Facility_B_partial_prob_intervention_agents_melted$tick==921|Facility_B_partial_prob_intervention_agents_melted$tick==1089|Facility_B_partial_prob_intervention_agents_melted$tick==1257),]
# 
# Facility_B_partial_prob_intervention_agents_melted_thursday_preop <- Facility_B_partial_prob_intervention_agents_melted[which(Facility_B_partial_prob_intervention_agents_melted$tick==105|Facility_B_partial_prob_intervention_agents_melted$tick==273|Facility_B_partial_prob_intervention_agents_melted$tick==441|Facility_B_partial_prob_intervention_agents_melted$tick==609|Facility_B_partial_prob_intervention_agents_melted$tick==777|Facility_B_partial_prob_intervention_agents_melted$tick==945|Facility_B_partial_prob_intervention_agents_melted$tick==1113|Facility_B_partial_prob_intervention_agents_melted$tick==1281),]
# 
# Facility_B_partial_prob_intervention_agents_melted_friday_preop <- Facility_B_partial_prob_intervention_agents_melted[which(Facility_B_partial_prob_intervention_agents_melted$tick==129|Facility_B_partial_prob_intervention_agents_melted$tick==297|Facility_B_partial_prob_intervention_agents_melted$tick==465|Facility_B_partial_prob_intervention_agents_melted$tick==633|Facility_B_partial_prob_intervention_agents_melted$tick==801|Facility_B_partial_prob_intervention_agents_melted$tick==969|Facility_B_partial_prob_intervention_agents_melted$tick==1137|Facility_B_partial_prob_intervention_agents_melted$tick==1305),]

Facility_B_partial_prob_intervention_agents_melted_ff <- as.ffdf(Facility_B_partial_prob_intervention_agents_melted)
rm(Facility_B_partial_prob_intervention_agents_melted)
gc()
```

```{r import Connections Intervention}
NL_table_Connections_intervention <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-30-15-54 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Weeks_Connections_Interventions-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Connections_intervention <- NL_table_Connections_intervention[NL_table_Connections_intervention$scenario==46,]

while (any(grepl('-', names(NL_table_Connections_intervention), fixed = TRUE))) {
  NL_table_Connections_intervention <- NL_table_Connections_intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Connections_intervention), fixed = TRUE))) {
  NL_table_Connections_intervention <- NL_table_Connections_intervention %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Connections_intervention), fixed = TRUE))) {
  NL_table_Connections_intervention <- NL_table_Connections_intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Connections_intervention), fixed = TRUE))) {
  NL_table_Connections_intervention <- NL_table_Connections_intervention %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Connections_intervention[ , ..list_columns]

NL_table_Connections_intervention[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Connections_intervention <- as.data.frame(NL_table_Connections_intervention)

NL_table_Connections_intervention[NL_table_Connections_intervention==-1] <- NA

NL_table_Connections_intervention <- subset(NL_table_Connections_intervention, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Connections_intervention)[names(NL_table_Connections_intervention)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Connections_intervention)[names(NL_table_Connections_intervention)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Connections_intervention$loading_w1wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_loading_w1wed_conc_list <- append(connections_intervention_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_loading_w1wed_conc_matrix <- matrix(unlist(connections_intervention_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Connections_intervention$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_cleaning_w1wed_conc_list <- append(connections_intervention_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_cleaning_w1wed_conc_matrix <- matrix(unlist(connections_intervention_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Connections_intervention$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# connections_intervention_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   connections_intervention_drying_w1wed_conc_list <- append(connections_intervention_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Connections_intervention$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_sorting_w1wed_conc_list <- append(connections_intervention_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_sorting_w1wed_conc_matrix <- matrix(unlist(connections_intervention_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Connections_intervention$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_tray_packing_w1wed_conc_list <- append(connections_intervention_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_tray_packing_w1wed_conc_matrix <- matrix(unlist(connections_intervention_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Connections_intervention$reject_w1wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_reject_w1wed_conc_list <- append(connections_intervention_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_reject_w1wed_conc_matrix <- matrix(unlist(connections_intervention_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Connections_intervention$other_w1wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_other_w1wed_conc_list <- append(connections_intervention_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_other_w1wed_conc_matrix <- matrix(unlist(connections_intervention_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

connections_intervention_loading_concs <- as.data.frame(connections_intervention_loading_w1wed_conc_list)
connections_intervention_loading_concs$area <- as.factor('loading')
connections_intervention_loading_concs$scenario <- as.factor('AI_04')
connections_intervention_loading_concs$water <- as.factor('Wet')
names(connections_intervention_loading_concs) <- c('concentration','area','scenario','water')

connections_intervention_cleaning_concs <- as.data.frame(connections_intervention_cleaning_w1wed_conc_list)
connections_intervention_cleaning_concs$area <- as.factor('cleaning')
connections_intervention_cleaning_concs$scenario <- as.factor('AI_04')
connections_intervention_cleaning_concs$water <- as.factor('Wet')
names(connections_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

connections_intervention_sorting_concs <- as.data.frame(connections_intervention_sorting_w1wed_conc_list)
connections_intervention_sorting_concs$area <- as.factor('sorting')
connections_intervention_sorting_concs$scenario <- as.factor('AI_04')
connections_intervention_sorting_concs$water <- as.factor('Dry')
names(connections_intervention_sorting_concs) <- c('concentration','area','scenario','water')

connections_intervention_reject_concs <- as.data.frame(connections_intervention_reject_w1wed_conc_list)
connections_intervention_reject_concs$area <- as.factor('reject')
connections_intervention_reject_concs$scenario <- as.factor('AI_04')
connections_intervention_reject_concs$water <- as.factor('Dry')
names(connections_intervention_reject_concs) <- c('concentration','area','scenario','water')

connections_intervention_tray_packing_concs <- as.data.frame(connections_intervention_tray_packing_w1wed_conc_list)
connections_intervention_tray_packing_concs$area <- as.factor('tray packing')
connections_intervention_tray_packing_concs$scenario <- as.factor('AI_04')
connections_intervention_tray_packing_concs$water <- as.factor('Dry')
names(connections_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

connections_intervention_other_concs <- as.data.frame(connections_intervention_other_w1wed_conc_list)
connections_intervention_other_concs$area <- as.factor('other')
connections_intervention_other_concs$scenario <- as.factor('AI_04')
connections_intervention_other_concs$water <- as.factor('Dry')
names(connections_intervention_other_concs) <- c('concentration','area','scenario','water')

connections_intervention_w1wed_concs <- rbind(connections_intervention_loading_concs,connections_intervention_cleaning_concs,connections_intervention_sorting_concs,connections_intervention_tray_packing_concs,connections_intervention_reject_concs,connections_intervention_other_concs)

connections_intervention_loading_prev <- as.data.frame(NL_table_Connections_intervention$loading_w1wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_loading_prev$area <- as.factor('loading')
connections_intervention_loading_prev$scenario <- as.factor('AI_04')
connections_intervention_loading_prev$water <- as.factor('Wet')
names(connections_intervention_loading_prev) <- c('prevalence','area','scenario','water')

connections_intervention_cleaning_prev <- as.data.frame(NL_table_Connections_intervention$cleaning_w1wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_cleaning_prev$area <- as.factor('cleaning')
connections_intervention_cleaning_prev$scenario <- as.factor('AI_04')
connections_intervention_cleaning_prev$water <- as.factor('Wet')
names(connections_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

connections_intervention_sorting_prev <- as.data.frame(NL_table_Connections_intervention$sorting_w1wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_sorting_prev$area <- as.factor('sorting')
connections_intervention_sorting_prev$scenario <- as.factor('AI_04')
connections_intervention_sorting_prev$water <- as.factor('Dry')
names(connections_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

connections_intervention_reject_prev <- as.data.frame(NL_table_Connections_intervention$reject_w1wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_reject_prev$area <- as.factor('reject')
connections_intervention_reject_prev$scenario <- as.factor('AI_04')
connections_intervention_reject_prev$water <- as.factor('Dry')
names(connections_intervention_reject_prev) <- c('prevalence','area','scenario','water')

connections_intervention_tray_packing_prev <- as.data.frame(NL_table_Connections_intervention$tray_packing_w1wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_tray_packing_prev$area <- as.factor('tray packing')
connections_intervention_tray_packing_prev$scenario <- as.factor('AI_04')
connections_intervention_tray_packing_prev$water <- as.factor('Dry')
names(connections_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

connections_intervention_other_prev <- as.data.frame(NL_table_Connections_intervention$other_w1wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_other_prev$area <- as.factor('other')
connections_intervention_other_prev$scenario <- as.factor('AI_04')
connections_intervention_other_prev$water <- as.factor('Dry')
names(connections_intervention_other_prev) <- c('prevalence','area','scenario','water')

connections_intervention_w1wed_prev <- rbind(connections_intervention_loading_prev,connections_intervention_cleaning_prev,connections_intervention_sorting_prev,connections_intervention_tray_packing_prev,connections_intervention_reject_prev,connections_intervention_other_prev)

connections_intervention_w1wed_wet_prev <- as.data.frame(connections_intervention_loading_prev$prevalence*21/100+connections_intervention_cleaning_prev$prevalence*28/100)/49*100
connections_intervention_w1wed_wet_prev$scenario <- as.factor('AI_04')
connections_intervention_w1wed_wet_prev$water <- as.factor('Wet')
names(connections_intervention_w1wed_wet_prev) <- c('prevalence','scenario','water')

connections_intervention_w1wed_dry_prev <- as.data.frame(connections_intervention_sorting_prev$prevalence*20/100+connections_intervention_reject_prev$prevalence*23/100+connections_intervention_tray_packing_prev$prevalence*123/100+connections_intervention_other_prev$prevalence*10/100)/176*100
connections_intervention_w1wed_dry_prev$scenario <- as.factor('AI_04')
connections_intervention_w1wed_dry_prev$water <- as.factor('Dry')
names(connections_intervention_w1wed_dry_prev) <- c('prevalence','scenario','water')

connections_intervention_w1wed_recombined_prev <- rbind(connections_intervention_w1wed_wet_prev, connections_intervention_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Connections_intervention$loading_w2wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_loading_w2wed_conc_list <- append(connections_intervention_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_loading_w2wed_conc_matrix <- matrix(unlist(connections_intervention_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Connections_intervention$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_cleaning_w2wed_conc_list <- append(connections_intervention_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_cleaning_w2wed_conc_matrix <- matrix(unlist(connections_intervention_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Connections_intervention$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# connections_intervention_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   connections_intervention_drying_w2wed_conc_list <- append(connections_intervention_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Connections_intervention$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_sorting_w2wed_conc_list <- append(connections_intervention_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_sorting_w2wed_conc_matrix <- matrix(unlist(connections_intervention_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Connections_intervention$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_tray_packing_w2wed_conc_list <- append(connections_intervention_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_tray_packing_w2wed_conc_matrix <- matrix(unlist(connections_intervention_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Connections_intervention$reject_w2wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_reject_w2wed_conc_list <- append(connections_intervention_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_reject_w2wed_conc_matrix <- matrix(unlist(connections_intervention_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Connections_intervention$other_w2wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_other_w2wed_conc_list <- append(connections_intervention_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_other_w2wed_conc_matrix <- matrix(unlist(connections_intervention_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

connections_intervention_loading_concs <- as.data.frame(connections_intervention_loading_w2wed_conc_list)
connections_intervention_loading_concs$area <- as.factor('loading')
connections_intervention_loading_concs$scenario <- as.factor('AI_04')
connections_intervention_loading_concs$water <- as.factor('Wet')
names(connections_intervention_loading_concs) <- c('concentration','area','scenario','water')

connections_intervention_cleaning_concs <- as.data.frame(connections_intervention_cleaning_w2wed_conc_list)
connections_intervention_cleaning_concs$area <- as.factor('cleaning')
connections_intervention_cleaning_concs$scenario <- as.factor('AI_04')
connections_intervention_cleaning_concs$water <- as.factor('Wet')
names(connections_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

connections_intervention_sorting_concs <- as.data.frame(connections_intervention_sorting_w2wed_conc_list)
connections_intervention_sorting_concs$area <- as.factor('sorting')
connections_intervention_sorting_concs$scenario <- as.factor('AI_04')
connections_intervention_sorting_concs$water <- as.factor('Dry')
names(connections_intervention_sorting_concs) <- c('concentration','area','scenario','water')

connections_intervention_reject_concs <- as.data.frame(connections_intervention_reject_w2wed_conc_list)
connections_intervention_reject_concs$area <- as.factor('reject')
connections_intervention_reject_concs$scenario <- as.factor('AI_04')
connections_intervention_reject_concs$water <- as.factor('Dry')
names(connections_intervention_reject_concs) <- c('concentration','area','scenario','water')

connections_intervention_tray_packing_concs <- as.data.frame(connections_intervention_tray_packing_w2wed_conc_list)
connections_intervention_tray_packing_concs$area <- as.factor('tray packing')
connections_intervention_tray_packing_concs$scenario <- as.factor('AI_04')
connections_intervention_tray_packing_concs$water <- as.factor('Dry')
names(connections_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

connections_intervention_other_concs <- as.data.frame(connections_intervention_other_w2wed_conc_list)
connections_intervention_other_concs$area <- as.factor('other')
connections_intervention_other_concs$scenario <- as.factor('AI_04')
connections_intervention_other_concs$water <- as.factor('Dry')
names(connections_intervention_other_concs) <- c('concentration','area','scenario','water')

connections_intervention_w2wed_concs <- rbind(connections_intervention_loading_concs,connections_intervention_cleaning_concs,connections_intervention_sorting_concs,connections_intervention_tray_packing_concs,connections_intervention_reject_concs,connections_intervention_other_concs)

connections_intervention_loading_prev <- as.data.frame(NL_table_Connections_intervention$loading_w2wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_loading_prev$area <- as.factor('loading')
connections_intervention_loading_prev$scenario <- as.factor('AI_04')
connections_intervention_loading_prev$water <- as.factor('Wet')
names(connections_intervention_loading_prev) <- c('prevalence','area','scenario','water')

connections_intervention_cleaning_prev <- as.data.frame(NL_table_Connections_intervention$cleaning_w2wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_cleaning_prev$area <- as.factor('cleaning')
connections_intervention_cleaning_prev$scenario <- as.factor('AI_04')
connections_intervention_cleaning_prev$water <- as.factor('Wet')
names(connections_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

connections_intervention_sorting_prev <- as.data.frame(NL_table_Connections_intervention$sorting_w2wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_sorting_prev$area <- as.factor('sorting')
connections_intervention_sorting_prev$scenario <- as.factor('AI_04')
connections_intervention_sorting_prev$water <- as.factor('Dry')
names(connections_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

connections_intervention_reject_prev <- as.data.frame(NL_table_Connections_intervention$reject_w2wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_reject_prev$area <- as.factor('reject')
connections_intervention_reject_prev$scenario <- as.factor('AI_04')
connections_intervention_reject_prev$water <- as.factor('Dry')
names(connections_intervention_reject_prev) <- c('prevalence','area','scenario','water')

connections_intervention_tray_packing_prev <- as.data.frame(NL_table_Connections_intervention$tray_packing_w2wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_tray_packing_prev$area <- as.factor('tray packing')
connections_intervention_tray_packing_prev$scenario <- as.factor('AI_04')
connections_intervention_tray_packing_prev$water <- as.factor('Dry')
names(connections_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

connections_intervention_other_prev <- as.data.frame(NL_table_Connections_intervention$other_w2wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_other_prev$area <- as.factor('other')
connections_intervention_other_prev$scenario <- as.factor('AI_04')
connections_intervention_other_prev$water <- as.factor('Dry')
names(connections_intervention_other_prev) <- c('prevalence','area','scenario','water')

connections_intervention_w2wed_prev <- rbind(connections_intervention_loading_prev,connections_intervention_cleaning_prev,connections_intervention_sorting_prev,connections_intervention_tray_packing_prev,connections_intervention_reject_prev,connections_intervention_other_prev)

connections_intervention_w2wed_wet_prev <- as.data.frame(connections_intervention_loading_prev$prevalence*21/100+connections_intervention_cleaning_prev$prevalence*28/100)/49*100
connections_intervention_w2wed_wet_prev$scenario <- as.factor('AI_04')
connections_intervention_w2wed_wet_prev$water <- as.factor('Wet')
names(connections_intervention_w2wed_wet_prev) <- c('prevalence','scenario','water')

connections_intervention_w2wed_dry_prev <- as.data.frame(connections_intervention_sorting_prev$prevalence*20/100+connections_intervention_reject_prev$prevalence*23/100+connections_intervention_tray_packing_prev$prevalence*123/100+connections_intervention_other_prev$prevalence*10/100)/176*100
connections_intervention_w2wed_dry_prev$scenario <- as.factor('AI_04')
connections_intervention_w2wed_dry_prev$water <- as.factor('Dry')
names(connections_intervention_w2wed_dry_prev) <- c('prevalence','scenario','water')

connections_intervention_w2wed_recombined_prev <- rbind(connections_intervention_w2wed_wet_prev, connections_intervention_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Connections_intervention$loading_w3wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_loading_w3wed_conc_list <- append(connections_intervention_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_loading_w3wed_conc_matrix <- matrix(unlist(connections_intervention_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Connections_intervention$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_cleaning_w3wed_conc_list <- append(connections_intervention_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_cleaning_w3wed_conc_matrix <- matrix(unlist(connections_intervention_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Connections_intervention$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# connections_intervention_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   connections_intervention_drying_w3wed_conc_list <- append(connections_intervention_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Connections_intervention$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_sorting_w3wed_conc_list <- append(connections_intervention_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_sorting_w3wed_conc_matrix <- matrix(unlist(connections_intervention_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Connections_intervention$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_tray_packing_w3wed_conc_list <- append(connections_intervention_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_tray_packing_w3wed_conc_matrix <- matrix(unlist(connections_intervention_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Connections_intervention$reject_w3wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_reject_w3wed_conc_list <- append(connections_intervention_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_reject_w3wed_conc_matrix <- matrix(unlist(connections_intervention_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Connections_intervention$other_w3wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_other_w3wed_conc_list <- append(connections_intervention_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_other_w3wed_conc_matrix <- matrix(unlist(connections_intervention_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

connections_intervention_loading_concs <- as.data.frame(connections_intervention_loading_w3wed_conc_list)
connections_intervention_loading_concs$area <- as.factor('loading')
connections_intervention_loading_concs$scenario <- as.factor('AI_04')
connections_intervention_loading_concs$water <- as.factor('Wet')
names(connections_intervention_loading_concs) <- c('concentration','area','scenario','water')

connections_intervention_cleaning_concs <- as.data.frame(connections_intervention_cleaning_w3wed_conc_list)
connections_intervention_cleaning_concs$area <- as.factor('cleaning')
connections_intervention_cleaning_concs$scenario <- as.factor('AI_04')
connections_intervention_cleaning_concs$water <- as.factor('Wet')
names(connections_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

connections_intervention_sorting_concs <- as.data.frame(connections_intervention_sorting_w3wed_conc_list)
connections_intervention_sorting_concs$area <- as.factor('sorting')
connections_intervention_sorting_concs$scenario <- as.factor('AI_04')
connections_intervention_sorting_concs$water <- as.factor('Dry')
names(connections_intervention_sorting_concs) <- c('concentration','area','scenario','water')

connections_intervention_reject_concs <- as.data.frame(connections_intervention_reject_w3wed_conc_list)
connections_intervention_reject_concs$area <- as.factor('reject')
connections_intervention_reject_concs$scenario <- as.factor('AI_04')
connections_intervention_reject_concs$water <- as.factor('Dry')
names(connections_intervention_reject_concs) <- c('concentration','area','scenario','water')

connections_intervention_tray_packing_concs <- as.data.frame(connections_intervention_tray_packing_w3wed_conc_list)
connections_intervention_tray_packing_concs$area <- as.factor('tray packing')
connections_intervention_tray_packing_concs$scenario <- as.factor('AI_04')
connections_intervention_tray_packing_concs$water <- as.factor('Dry')
names(connections_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

connections_intervention_other_concs <- as.data.frame(connections_intervention_other_w3wed_conc_list)
connections_intervention_other_concs$area <- as.factor('other')
connections_intervention_other_concs$scenario <- as.factor('AI_04')
connections_intervention_other_concs$water <- as.factor('Dry')
names(connections_intervention_other_concs) <- c('concentration','area','scenario','water')

connections_intervention_w3wed_concs <- rbind(connections_intervention_loading_concs,connections_intervention_cleaning_concs,connections_intervention_sorting_concs,connections_intervention_tray_packing_concs,connections_intervention_reject_concs,connections_intervention_other_concs)

connections_intervention_loading_prev <- as.data.frame(NL_table_Connections_intervention$loading_w3wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_loading_prev$area <- as.factor('loading')
connections_intervention_loading_prev$scenario <- as.factor('AI_04')
connections_intervention_loading_prev$water <- as.factor('Wet')
names(connections_intervention_loading_prev) <- c('prevalence','area','scenario','water')

connections_intervention_cleaning_prev <- as.data.frame(NL_table_Connections_intervention$cleaning_w3wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_cleaning_prev$area <- as.factor('cleaning')
connections_intervention_cleaning_prev$scenario <- as.factor('AI_04')
connections_intervention_cleaning_prev$water <- as.factor('Wet')
names(connections_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

connections_intervention_sorting_prev <- as.data.frame(NL_table_Connections_intervention$sorting_w3wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_sorting_prev$area <- as.factor('sorting')
connections_intervention_sorting_prev$scenario <- as.factor('AI_04')
connections_intervention_sorting_prev$water <- as.factor('Dry')
names(connections_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

connections_intervention_reject_prev <- as.data.frame(NL_table_Connections_intervention$reject_w3wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_reject_prev$area <- as.factor('reject')
connections_intervention_reject_prev$scenario <- as.factor('AI_04')
connections_intervention_reject_prev$water <- as.factor('Dry')
names(connections_intervention_reject_prev) <- c('prevalence','area','scenario','water')

connections_intervention_tray_packing_prev <- as.data.frame(NL_table_Connections_intervention$tray_packing_w3wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_tray_packing_prev$area <- as.factor('tray packing')
connections_intervention_tray_packing_prev$scenario <- as.factor('AI_04')
connections_intervention_tray_packing_prev$water <- as.factor('Dry')
names(connections_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

connections_intervention_other_prev <- as.data.frame(NL_table_Connections_intervention$other_w3wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_other_prev$area <- as.factor('other')
connections_intervention_other_prev$scenario <- as.factor('AI_04')
connections_intervention_other_prev$water <- as.factor('Dry')
names(connections_intervention_other_prev) <- c('prevalence','area','scenario','water')

connections_intervention_w3wed_prev <- rbind(connections_intervention_loading_prev,connections_intervention_cleaning_prev,connections_intervention_sorting_prev,connections_intervention_tray_packing_prev,connections_intervention_reject_prev,connections_intervention_other_prev)

connections_intervention_w3wed_wet_prev <- as.data.frame(connections_intervention_loading_prev$prevalence*21/100+connections_intervention_cleaning_prev$prevalence*28/100)/49*100
connections_intervention_w3wed_wet_prev$scenario <- as.factor('AI_04')
connections_intervention_w3wed_wet_prev$water <- as.factor('Wet')
names(connections_intervention_w3wed_wet_prev) <- c('prevalence','scenario','water')

connections_intervention_w3wed_dry_prev <- as.data.frame(connections_intervention_sorting_prev$prevalence*20/100+connections_intervention_reject_prev$prevalence*23/100+connections_intervention_tray_packing_prev$prevalence*123/100+connections_intervention_other_prev$prevalence*10/100)/176*100
connections_intervention_w3wed_dry_prev$scenario <- as.factor('AI_04')
connections_intervention_w3wed_dry_prev$water <- as.factor('Dry')
names(connections_intervention_w3wed_dry_prev) <- c('prevalence','scenario','water')

connections_intervention_w3wed_recombined_prev <- rbind(connections_intervention_w3wed_wet_prev, connections_intervention_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Connections_intervention$loading_w4wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_loading_w4wed_conc_list <- append(connections_intervention_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_loading_w4wed_conc_matrix <- matrix(unlist(connections_intervention_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Connections_intervention$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_cleaning_w4wed_conc_list <- append(connections_intervention_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_cleaning_w4wed_conc_matrix <- matrix(unlist(connections_intervention_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Connections_intervention$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# connections_intervention_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   connections_intervention_drying_w4wed_conc_list <- append(connections_intervention_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Connections_intervention$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_sorting_w4wed_conc_list <- append(connections_intervention_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_sorting_w4wed_conc_matrix <- matrix(unlist(connections_intervention_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Connections_intervention$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_tray_packing_w4wed_conc_list <- append(connections_intervention_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_tray_packing_w4wed_conc_matrix <- matrix(unlist(connections_intervention_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Connections_intervention$reject_w4wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_reject_w4wed_conc_list <- append(connections_intervention_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_reject_w4wed_conc_matrix <- matrix(unlist(connections_intervention_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Connections_intervention$other_w4wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_other_w4wed_conc_list <- append(connections_intervention_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_other_w4wed_conc_matrix <- matrix(unlist(connections_intervention_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

connections_intervention_loading_concs <- as.data.frame(connections_intervention_loading_w4wed_conc_list)
connections_intervention_loading_concs$area <- as.factor('loading')
connections_intervention_loading_concs$scenario <- as.factor('AI_04')
connections_intervention_loading_concs$water <- as.factor('Wet')
names(connections_intervention_loading_concs) <- c('concentration','area','scenario','water')

connections_intervention_cleaning_concs <- as.data.frame(connections_intervention_cleaning_w4wed_conc_list)
connections_intervention_cleaning_concs$area <- as.factor('cleaning')
connections_intervention_cleaning_concs$scenario <- as.factor('AI_04')
connections_intervention_cleaning_concs$water <- as.factor('Wet')
names(connections_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

connections_intervention_sorting_concs <- as.data.frame(connections_intervention_sorting_w4wed_conc_list)
connections_intervention_sorting_concs$area <- as.factor('sorting')
connections_intervention_sorting_concs$scenario <- as.factor('AI_04')
connections_intervention_sorting_concs$water <- as.factor('Dry')
names(connections_intervention_sorting_concs) <- c('concentration','area','scenario','water')

connections_intervention_reject_concs <- as.data.frame(connections_intervention_reject_w4wed_conc_list)
connections_intervention_reject_concs$area <- as.factor('reject')
connections_intervention_reject_concs$scenario <- as.factor('AI_04')
connections_intervention_reject_concs$water <- as.factor('Dry')
names(connections_intervention_reject_concs) <- c('concentration','area','scenario','water')

connections_intervention_tray_packing_concs <- as.data.frame(connections_intervention_tray_packing_w4wed_conc_list)
connections_intervention_tray_packing_concs$area <- as.factor('tray packing')
connections_intervention_tray_packing_concs$scenario <- as.factor('AI_04')
connections_intervention_tray_packing_concs$water <- as.factor('Dry')
names(connections_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

connections_intervention_other_concs <- as.data.frame(connections_intervention_other_w4wed_conc_list)
connections_intervention_other_concs$area <- as.factor('other')
connections_intervention_other_concs$scenario <- as.factor('AI_04')
connections_intervention_other_concs$water <- as.factor('Dry')
names(connections_intervention_other_concs) <- c('concentration','area','scenario','water')

connections_intervention_w4wed_concs <- rbind(connections_intervention_loading_concs,connections_intervention_cleaning_concs,connections_intervention_sorting_concs,connections_intervention_tray_packing_concs,connections_intervention_reject_concs,connections_intervention_other_concs)

connections_intervention_loading_prev <- as.data.frame(NL_table_Connections_intervention$loading_w4wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_loading_prev$area <- as.factor('loading')
connections_intervention_loading_prev$scenario <- as.factor('AI_04')
connections_intervention_loading_prev$water <- as.factor('Wet')
names(connections_intervention_loading_prev) <- c('prevalence','area','scenario','water')

connections_intervention_cleaning_prev <- as.data.frame(NL_table_Connections_intervention$cleaning_w4wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_cleaning_prev$area <- as.factor('cleaning')
connections_intervention_cleaning_prev$scenario <- as.factor('AI_04')
connections_intervention_cleaning_prev$water <- as.factor('Wet')
names(connections_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

connections_intervention_sorting_prev <- as.data.frame(NL_table_Connections_intervention$sorting_w4wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_sorting_prev$area <- as.factor('sorting')
connections_intervention_sorting_prev$scenario <- as.factor('AI_04')
connections_intervention_sorting_prev$water <- as.factor('Dry')
names(connections_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

connections_intervention_reject_prev <- as.data.frame(NL_table_Connections_intervention$reject_w4wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_reject_prev$area <- as.factor('reject')
connections_intervention_reject_prev$scenario <- as.factor('AI_04')
connections_intervention_reject_prev$water <- as.factor('Dry')
names(connections_intervention_reject_prev) <- c('prevalence','area','scenario','water')

connections_intervention_tray_packing_prev <- as.data.frame(NL_table_Connections_intervention$tray_packing_w4wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_tray_packing_prev$area <- as.factor('tray packing')
connections_intervention_tray_packing_prev$scenario <- as.factor('AI_04')
connections_intervention_tray_packing_prev$water <- as.factor('Dry')
names(connections_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

connections_intervention_other_prev <- as.data.frame(NL_table_Connections_intervention$other_w4wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_other_prev$area <- as.factor('other')
connections_intervention_other_prev$scenario <- as.factor('AI_04')
connections_intervention_other_prev$water <- as.factor('Dry')
names(connections_intervention_other_prev) <- c('prevalence','area','scenario','water')

connections_intervention_w4wed_prev <- rbind(connections_intervention_loading_prev,connections_intervention_cleaning_prev,connections_intervention_sorting_prev,connections_intervention_tray_packing_prev,connections_intervention_reject_prev,connections_intervention_other_prev)

connections_intervention_w4wed_wet_prev <- as.data.frame(connections_intervention_loading_prev$prevalence*21/100+connections_intervention_cleaning_prev$prevalence*28/100)/49*100
connections_intervention_w4wed_wet_prev$scenario <- as.factor('AI_04')
connections_intervention_w4wed_wet_prev$water <- as.factor('Wet')
names(connections_intervention_w4wed_wet_prev) <- c('prevalence','scenario','water')

connections_intervention_w4wed_dry_prev <- as.data.frame(connections_intervention_sorting_prev$prevalence*20/100+connections_intervention_reject_prev$prevalence*23/100+connections_intervention_tray_packing_prev$prevalence*123/100+connections_intervention_other_prev$prevalence*10/100)/176*100
connections_intervention_w4wed_dry_prev$scenario <- as.factor('AI_04')
connections_intervention_w4wed_dry_prev$water <- as.factor('Dry')
names(connections_intervention_w4wed_dry_prev) <- c('prevalence','scenario','water')

connections_intervention_w4wed_recombined_prev <- rbind(connections_intervention_w4wed_wet_prev, connections_intervention_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Connections_intervention$loading_w5wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_loading_w5wed_conc_list <- append(connections_intervention_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_loading_w5wed_conc_matrix <- matrix(unlist(connections_intervention_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Connections_intervention$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_cleaning_w5wed_conc_list <- append(connections_intervention_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_cleaning_w5wed_conc_matrix <- matrix(unlist(connections_intervention_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Connections_intervention$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# connections_intervention_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   connections_intervention_drying_w5wed_conc_list <- append(connections_intervention_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Connections_intervention$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_sorting_w5wed_conc_list <- append(connections_intervention_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_sorting_w5wed_conc_matrix <- matrix(unlist(connections_intervention_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Connections_intervention$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_tray_packing_w5wed_conc_list <- append(connections_intervention_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_tray_packing_w5wed_conc_matrix <- matrix(unlist(connections_intervention_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Connections_intervention$reject_w5wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_reject_w5wed_conc_list <- append(connections_intervention_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_reject_w5wed_conc_matrix <- matrix(unlist(connections_intervention_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Connections_intervention$other_w5wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_other_w5wed_conc_list <- append(connections_intervention_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_other_w5wed_conc_matrix <- matrix(unlist(connections_intervention_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

connections_intervention_loading_concs <- as.data.frame(connections_intervention_loading_w5wed_conc_list)
connections_intervention_loading_concs$area <- as.factor('loading')
connections_intervention_loading_concs$scenario <- as.factor('AI_04')
connections_intervention_loading_concs$water <- as.factor('Wet')
names(connections_intervention_loading_concs) <- c('concentration','area','scenario','water')

connections_intervention_cleaning_concs <- as.data.frame(connections_intervention_cleaning_w5wed_conc_list)
connections_intervention_cleaning_concs$area <- as.factor('cleaning')
connections_intervention_cleaning_concs$scenario <- as.factor('AI_04')
connections_intervention_cleaning_concs$water <- as.factor('Wet')
names(connections_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

connections_intervention_sorting_concs <- as.data.frame(connections_intervention_sorting_w5wed_conc_list)
connections_intervention_sorting_concs$area <- as.factor('sorting')
connections_intervention_sorting_concs$scenario <- as.factor('AI_04')
connections_intervention_sorting_concs$water <- as.factor('Dry')
names(connections_intervention_sorting_concs) <- c('concentration','area','scenario','water')

connections_intervention_reject_concs <- as.data.frame(connections_intervention_reject_w5wed_conc_list)
connections_intervention_reject_concs$area <- as.factor('reject')
connections_intervention_reject_concs$scenario <- as.factor('AI_04')
connections_intervention_reject_concs$water <- as.factor('Dry')
names(connections_intervention_reject_concs) <- c('concentration','area','scenario','water')

connections_intervention_tray_packing_concs <- as.data.frame(connections_intervention_tray_packing_w5wed_conc_list)
connections_intervention_tray_packing_concs$area <- as.factor('tray packing')
connections_intervention_tray_packing_concs$scenario <- as.factor('AI_04')
connections_intervention_tray_packing_concs$water <- as.factor('Dry')
names(connections_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

connections_intervention_other_concs <- as.data.frame(connections_intervention_other_w5wed_conc_list)
connections_intervention_other_concs$area <- as.factor('other')
connections_intervention_other_concs$scenario <- as.factor('AI_04')
connections_intervention_other_concs$water <- as.factor('Dry')
names(connections_intervention_other_concs) <- c('concentration','area','scenario','water')

connections_intervention_w5wed_concs <- rbind(connections_intervention_loading_concs,connections_intervention_cleaning_concs,connections_intervention_sorting_concs,connections_intervention_tray_packing_concs,connections_intervention_reject_concs,connections_intervention_other_concs)

connections_intervention_loading_prev <- as.data.frame(NL_table_Connections_intervention$loading_w5wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_loading_prev$area <- as.factor('loading')
connections_intervention_loading_prev$scenario <- as.factor('AI_04')
connections_intervention_loading_prev$water <- as.factor('Wet')
names(connections_intervention_loading_prev) <- c('prevalence','area','scenario','water')

connections_intervention_cleaning_prev <- as.data.frame(NL_table_Connections_intervention$cleaning_w5wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_cleaning_prev$area <- as.factor('cleaning')
connections_intervention_cleaning_prev$scenario <- as.factor('AI_04')
connections_intervention_cleaning_prev$water <- as.factor('Wet')
names(connections_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

connections_intervention_sorting_prev <- as.data.frame(NL_table_Connections_intervention$sorting_w5wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_sorting_prev$area <- as.factor('sorting')
connections_intervention_sorting_prev$scenario <- as.factor('AI_04')
connections_intervention_sorting_prev$water <- as.factor('Dry')
names(connections_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

connections_intervention_reject_prev <- as.data.frame(NL_table_Connections_intervention$reject_w5wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_reject_prev$area <- as.factor('reject')
connections_intervention_reject_prev$scenario <- as.factor('AI_04')
connections_intervention_reject_prev$water <- as.factor('Dry')
names(connections_intervention_reject_prev) <- c('prevalence','area','scenario','water')

connections_intervention_tray_packing_prev <- as.data.frame(NL_table_Connections_intervention$tray_packing_w5wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_tray_packing_prev$area <- as.factor('tray packing')
connections_intervention_tray_packing_prev$scenario <- as.factor('AI_04')
connections_intervention_tray_packing_prev$water <- as.factor('Dry')
names(connections_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

connections_intervention_other_prev <- as.data.frame(NL_table_Connections_intervention$other_w5wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_other_prev$area <- as.factor('other')
connections_intervention_other_prev$scenario <- as.factor('AI_04')
connections_intervention_other_prev$water <- as.factor('Dry')
names(connections_intervention_other_prev) <- c('prevalence','area','scenario','water')

connections_intervention_w5wed_prev <- rbind(connections_intervention_loading_prev,connections_intervention_cleaning_prev,connections_intervention_sorting_prev,connections_intervention_tray_packing_prev,connections_intervention_reject_prev,connections_intervention_other_prev)

connections_intervention_w5wed_wet_prev <- as.data.frame(connections_intervention_loading_prev$prevalence*21/100+connections_intervention_cleaning_prev$prevalence*28/100)/49*100
connections_intervention_w5wed_wet_prev$scenario <- as.factor('AI_04')
connections_intervention_w5wed_wet_prev$water <- as.factor('Wet')
names(connections_intervention_w5wed_wet_prev) <- c('prevalence','scenario','water')

connections_intervention_w5wed_dry_prev <- as.data.frame(connections_intervention_sorting_prev$prevalence*20/100+connections_intervention_reject_prev$prevalence*23/100+connections_intervention_tray_packing_prev$prevalence*123/100+connections_intervention_other_prev$prevalence*10/100)/176*100
connections_intervention_w5wed_dry_prev$scenario <- as.factor('AI_04')
connections_intervention_w5wed_dry_prev$water <- as.factor('Dry')
names(connections_intervention_w5wed_dry_prev) <- c('prevalence','scenario','water')

connections_intervention_w5wed_recombined_prev <- rbind(connections_intervention_w5wed_wet_prev, connections_intervention_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Connections_intervention$loading_w6wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_loading_w6wed_conc_list <- append(connections_intervention_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_loading_w6wed_conc_matrix <- matrix(unlist(connections_intervention_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Connections_intervention$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_cleaning_w6wed_conc_list <- append(connections_intervention_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_cleaning_w6wed_conc_matrix <- matrix(unlist(connections_intervention_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Connections_intervention$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# connections_intervention_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   connections_intervention_drying_w6wed_conc_list <- append(connections_intervention_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Connections_intervention$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_sorting_w6wed_conc_list <- append(connections_intervention_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_sorting_w6wed_conc_matrix <- matrix(unlist(connections_intervention_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Connections_intervention$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_tray_packing_w6wed_conc_list <- append(connections_intervention_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_tray_packing_w6wed_conc_matrix <- matrix(unlist(connections_intervention_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Connections_intervention$reject_w6wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_reject_w6wed_conc_list <- append(connections_intervention_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_reject_w6wed_conc_matrix <- matrix(unlist(connections_intervention_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Connections_intervention$other_w6wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_other_w6wed_conc_list <- append(connections_intervention_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_other_w6wed_conc_matrix <- matrix(unlist(connections_intervention_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

connections_intervention_loading_concs <- as.data.frame(connections_intervention_loading_w6wed_conc_list)
connections_intervention_loading_concs$area <- as.factor('loading')
connections_intervention_loading_concs$scenario <- as.factor('AI_04')
connections_intervention_loading_concs$water <- as.factor('Wet')
names(connections_intervention_loading_concs) <- c('concentration','area','scenario','water')

connections_intervention_cleaning_concs <- as.data.frame(connections_intervention_cleaning_w6wed_conc_list)
connections_intervention_cleaning_concs$area <- as.factor('cleaning')
connections_intervention_cleaning_concs$scenario <- as.factor('AI_04')
connections_intervention_cleaning_concs$water <- as.factor('Wet')
names(connections_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

connections_intervention_sorting_concs <- as.data.frame(connections_intervention_sorting_w6wed_conc_list)
connections_intervention_sorting_concs$area <- as.factor('sorting')
connections_intervention_sorting_concs$scenario <- as.factor('AI_04')
connections_intervention_sorting_concs$water <- as.factor('Dry')
names(connections_intervention_sorting_concs) <- c('concentration','area','scenario','water')

connections_intervention_reject_concs <- as.data.frame(connections_intervention_reject_w6wed_conc_list)
connections_intervention_reject_concs$area <- as.factor('reject')
connections_intervention_reject_concs$scenario <- as.factor('AI_04')
connections_intervention_reject_concs$water <- as.factor('Dry')
names(connections_intervention_reject_concs) <- c('concentration','area','scenario','water')

connections_intervention_tray_packing_concs <- as.data.frame(connections_intervention_tray_packing_w6wed_conc_list)
connections_intervention_tray_packing_concs$area <- as.factor('tray packing')
connections_intervention_tray_packing_concs$scenario <- as.factor('AI_04')
connections_intervention_tray_packing_concs$water <- as.factor('Dry')
names(connections_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

connections_intervention_other_concs <- as.data.frame(connections_intervention_other_w6wed_conc_list)
connections_intervention_other_concs$area <- as.factor('other')
connections_intervention_other_concs$scenario <- as.factor('AI_04')
connections_intervention_other_concs$water <- as.factor('Dry')
names(connections_intervention_other_concs) <- c('concentration','area','scenario','water')

connections_intervention_w6wed_concs <- rbind(connections_intervention_loading_concs,connections_intervention_cleaning_concs,connections_intervention_sorting_concs,connections_intervention_tray_packing_concs,connections_intervention_reject_concs,connections_intervention_other_concs)

connections_intervention_loading_prev <- as.data.frame(NL_table_Connections_intervention$loading_w6wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_loading_prev$area <- as.factor('loading')
connections_intervention_loading_prev$scenario <- as.factor('AI_04')
connections_intervention_loading_prev$water <- as.factor('Wet')
names(connections_intervention_loading_prev) <- c('prevalence','area','scenario','water')

connections_intervention_cleaning_prev <- as.data.frame(NL_table_Connections_intervention$cleaning_w6wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_cleaning_prev$area <- as.factor('cleaning')
connections_intervention_cleaning_prev$scenario <- as.factor('AI_04')
connections_intervention_cleaning_prev$water <- as.factor('Wet')
names(connections_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

connections_intervention_sorting_prev <- as.data.frame(NL_table_Connections_intervention$sorting_w6wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_sorting_prev$area <- as.factor('sorting')
connections_intervention_sorting_prev$scenario <- as.factor('AI_04')
connections_intervention_sorting_prev$water <- as.factor('Dry')
names(connections_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

connections_intervention_reject_prev <- as.data.frame(NL_table_Connections_intervention$reject_w6wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_reject_prev$area <- as.factor('reject')
connections_intervention_reject_prev$scenario <- as.factor('AI_04')
connections_intervention_reject_prev$water <- as.factor('Dry')
names(connections_intervention_reject_prev) <- c('prevalence','area','scenario','water')

connections_intervention_tray_packing_prev <- as.data.frame(NL_table_Connections_intervention$tray_packing_w6wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_tray_packing_prev$area <- as.factor('tray packing')
connections_intervention_tray_packing_prev$scenario <- as.factor('AI_04')
connections_intervention_tray_packing_prev$water <- as.factor('Dry')
names(connections_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

connections_intervention_other_prev <- as.data.frame(NL_table_Connections_intervention$other_w6wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_other_prev$area <- as.factor('other')
connections_intervention_other_prev$scenario <- as.factor('AI_04')
connections_intervention_other_prev$water <- as.factor('Dry')
names(connections_intervention_other_prev) <- c('prevalence','area','scenario','water')

connections_intervention_w6wed_prev <- rbind(connections_intervention_loading_prev,connections_intervention_cleaning_prev,connections_intervention_sorting_prev,connections_intervention_tray_packing_prev,connections_intervention_reject_prev,connections_intervention_other_prev)

connections_intervention_w6wed_wet_prev <- as.data.frame(connections_intervention_loading_prev$prevalence*21/100+connections_intervention_cleaning_prev$prevalence*28/100)/49*100
connections_intervention_w6wed_wet_prev$scenario <- as.factor('AI_04')
connections_intervention_w6wed_wet_prev$water <- as.factor('Wet')
names(connections_intervention_w6wed_wet_prev) <- c('prevalence','scenario','water')

connections_intervention_w6wed_dry_prev <- as.data.frame(connections_intervention_sorting_prev$prevalence*20/100+connections_intervention_reject_prev$prevalence*23/100+connections_intervention_tray_packing_prev$prevalence*123/100+connections_intervention_other_prev$prevalence*10/100)/176*100
connections_intervention_w6wed_dry_prev$scenario <- as.factor('AI_04')
connections_intervention_w6wed_dry_prev$water <- as.factor('Dry')
names(connections_intervention_w6wed_dry_prev) <- c('prevalence','scenario','water')

connections_intervention_w6wed_recombined_prev <- rbind(connections_intervention_w6wed_wet_prev, connections_intervention_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Connections_intervention$loading_w7wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_loading_w7wed_conc_list <- append(connections_intervention_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_loading_w7wed_conc_matrix <- matrix(unlist(connections_intervention_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Connections_intervention$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_cleaning_w7wed_conc_list <- append(connections_intervention_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_cleaning_w7wed_conc_matrix <- matrix(unlist(connections_intervention_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Connections_intervention$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# connections_intervention_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   connections_intervention_drying_w7wed_conc_list <- append(connections_intervention_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Connections_intervention$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_sorting_w7wed_conc_list <- append(connections_intervention_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_sorting_w7wed_conc_matrix <- matrix(unlist(connections_intervention_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Connections_intervention$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_tray_packing_w7wed_conc_list <- append(connections_intervention_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_tray_packing_w7wed_conc_matrix <- matrix(unlist(connections_intervention_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Connections_intervention$reject_w7wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_reject_w7wed_conc_list <- append(connections_intervention_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_reject_w7wed_conc_matrix <- matrix(unlist(connections_intervention_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Connections_intervention$other_w7wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_other_w7wed_conc_list <- append(connections_intervention_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_other_w7wed_conc_matrix <- matrix(unlist(connections_intervention_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

connections_intervention_loading_concs <- as.data.frame(connections_intervention_loading_w7wed_conc_list)
connections_intervention_loading_concs$area <- as.factor('loading')
connections_intervention_loading_concs$scenario <- as.factor('AI_04')
connections_intervention_loading_concs$water <- as.factor('Wet')
names(connections_intervention_loading_concs) <- c('concentration','area','scenario','water')

connections_intervention_cleaning_concs <- as.data.frame(connections_intervention_cleaning_w7wed_conc_list)
connections_intervention_cleaning_concs$area <- as.factor('cleaning')
connections_intervention_cleaning_concs$scenario <- as.factor('AI_04')
connections_intervention_cleaning_concs$water <- as.factor('Wet')
names(connections_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

connections_intervention_sorting_concs <- as.data.frame(connections_intervention_sorting_w7wed_conc_list)
connections_intervention_sorting_concs$area <- as.factor('sorting')
connections_intervention_sorting_concs$scenario <- as.factor('AI_04')
connections_intervention_sorting_concs$water <- as.factor('Dry')
names(connections_intervention_sorting_concs) <- c('concentration','area','scenario','water')

connections_intervention_reject_concs <- as.data.frame(connections_intervention_reject_w7wed_conc_list)
connections_intervention_reject_concs$area <- as.factor('reject')
connections_intervention_reject_concs$scenario <- as.factor('AI_04')
connections_intervention_reject_concs$water <- as.factor('Dry')
names(connections_intervention_reject_concs) <- c('concentration','area','scenario','water')

connections_intervention_tray_packing_concs <- as.data.frame(connections_intervention_tray_packing_w7wed_conc_list)
connections_intervention_tray_packing_concs$area <- as.factor('tray packing')
connections_intervention_tray_packing_concs$scenario <- as.factor('AI_04')
connections_intervention_tray_packing_concs$water <- as.factor('Dry')
names(connections_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

connections_intervention_other_concs <- as.data.frame(connections_intervention_other_w7wed_conc_list)
connections_intervention_other_concs$area <- as.factor('other')
connections_intervention_other_concs$scenario <- as.factor('AI_04')
connections_intervention_other_concs$water <- as.factor('Dry')
names(connections_intervention_other_concs) <- c('concentration','area','scenario','water')

connections_intervention_w7wed_concs <- rbind(connections_intervention_loading_concs,connections_intervention_cleaning_concs,connections_intervention_sorting_concs,connections_intervention_tray_packing_concs,connections_intervention_reject_concs,connections_intervention_other_concs)

connections_intervention_loading_prev <- as.data.frame(NL_table_Connections_intervention$loading_w7wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_loading_prev$area <- as.factor('loading')
connections_intervention_loading_prev$scenario <- as.factor('AI_04')
connections_intervention_loading_prev$water <- as.factor('Wet')
names(connections_intervention_loading_prev) <- c('prevalence','area','scenario','water')

connections_intervention_cleaning_prev <- as.data.frame(NL_table_Connections_intervention$cleaning_w7wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_cleaning_prev$area <- as.factor('cleaning')
connections_intervention_cleaning_prev$scenario <- as.factor('AI_04')
connections_intervention_cleaning_prev$water <- as.factor('Wet')
names(connections_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

connections_intervention_sorting_prev <- as.data.frame(NL_table_Connections_intervention$sorting_w7wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_sorting_prev$area <- as.factor('sorting')
connections_intervention_sorting_prev$scenario <- as.factor('AI_04')
connections_intervention_sorting_prev$water <- as.factor('Dry')
names(connections_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

connections_intervention_reject_prev <- as.data.frame(NL_table_Connections_intervention$reject_w7wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_reject_prev$area <- as.factor('reject')
connections_intervention_reject_prev$scenario <- as.factor('AI_04')
connections_intervention_reject_prev$water <- as.factor('Dry')
names(connections_intervention_reject_prev) <- c('prevalence','area','scenario','water')

connections_intervention_tray_packing_prev <- as.data.frame(NL_table_Connections_intervention$tray_packing_w7wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_tray_packing_prev$area <- as.factor('tray packing')
connections_intervention_tray_packing_prev$scenario <- as.factor('AI_04')
connections_intervention_tray_packing_prev$water <- as.factor('Dry')
names(connections_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

connections_intervention_other_prev <- as.data.frame(NL_table_Connections_intervention$other_w7wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_other_prev$area <- as.factor('other')
connections_intervention_other_prev$scenario <- as.factor('AI_04')
connections_intervention_other_prev$water <- as.factor('Dry')
names(connections_intervention_other_prev) <- c('prevalence','area','scenario','water')

connections_intervention_w7wed_prev <- rbind(connections_intervention_loading_prev,connections_intervention_cleaning_prev,connections_intervention_sorting_prev,connections_intervention_tray_packing_prev,connections_intervention_reject_prev,connections_intervention_other_prev)

connections_intervention_w7wed_wet_prev <- as.data.frame(connections_intervention_loading_prev$prevalence*21/100+connections_intervention_cleaning_prev$prevalence*28/100)/49*100
connections_intervention_w7wed_wet_prev$scenario <- as.factor('AI_04')
connections_intervention_w7wed_wet_prev$water <- as.factor('Wet')
names(connections_intervention_w7wed_wet_prev) <- c('prevalence','scenario','water')

connections_intervention_w7wed_dry_prev <- as.data.frame(connections_intervention_sorting_prev$prevalence*20/100+connections_intervention_reject_prev$prevalence*23/100+connections_intervention_tray_packing_prev$prevalence*123/100+connections_intervention_other_prev$prevalence*10/100)/176*100
connections_intervention_w7wed_dry_prev$scenario <- as.factor('AI_04')
connections_intervention_w7wed_dry_prev$water <- as.factor('Dry')
names(connections_intervention_w7wed_dry_prev) <- c('prevalence','scenario','water')

connections_intervention_w7wed_recombined_prev <- rbind(connections_intervention_w7wed_wet_prev, connections_intervention_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Connections_intervention$loading_w8wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_loading_w8wed_conc_list <- append(connections_intervention_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_loading_w8wed_conc_matrix <- matrix(unlist(connections_intervention_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Connections_intervention$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_cleaning_w8wed_conc_list <- append(connections_intervention_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_cleaning_w8wed_conc_matrix <- matrix(unlist(connections_intervention_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Connections_intervention$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# connections_intervention_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   connections_intervention_drying_w8wed_conc_list <- append(connections_intervention_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Connections_intervention$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_sorting_w8wed_conc_list <- append(connections_intervention_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_sorting_w8wed_conc_matrix <- matrix(unlist(connections_intervention_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Connections_intervention$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_tray_packing_w8wed_conc_list <- append(connections_intervention_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_tray_packing_w8wed_conc_matrix <- matrix(unlist(connections_intervention_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Connections_intervention$reject_w8wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_reject_w8wed_conc_list <- append(connections_intervention_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_reject_w8wed_conc_matrix <- matrix(unlist(connections_intervention_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Connections_intervention$other_w8wed_conc_list
vector <- vector[vector!='[]']
connections_intervention_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  connections_intervention_other_w8wed_conc_list <- append(connections_intervention_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
connections_intervention_other_w8wed_conc_matrix <- matrix(unlist(connections_intervention_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

connections_intervention_loading_concs <- as.data.frame(connections_intervention_loading_w8wed_conc_list)
connections_intervention_loading_concs$area <- as.factor('loading')
connections_intervention_loading_concs$scenario <- as.factor('AI_04')
connections_intervention_loading_concs$water <- as.factor('Wet')
names(connections_intervention_loading_concs) <- c('concentration','area','scenario','water')

connections_intervention_cleaning_concs <- as.data.frame(connections_intervention_cleaning_w8wed_conc_list)
connections_intervention_cleaning_concs$area <- as.factor('cleaning')
connections_intervention_cleaning_concs$scenario <- as.factor('AI_04')
connections_intervention_cleaning_concs$water <- as.factor('Wet')
names(connections_intervention_cleaning_concs) <- c('concentration','area','scenario','water')

connections_intervention_sorting_concs <- as.data.frame(connections_intervention_sorting_w8wed_conc_list)
connections_intervention_sorting_concs$area <- as.factor('sorting')
connections_intervention_sorting_concs$scenario <- as.factor('AI_04')
connections_intervention_sorting_concs$water <- as.factor('Dry')
names(connections_intervention_sorting_concs) <- c('concentration','area','scenario','water')

connections_intervention_reject_concs <- as.data.frame(connections_intervention_reject_w8wed_conc_list)
connections_intervention_reject_concs$area <- as.factor('reject')
connections_intervention_reject_concs$scenario <- as.factor('AI_04')
connections_intervention_reject_concs$water <- as.factor('Dry')
names(connections_intervention_reject_concs) <- c('concentration','area','scenario','water')

connections_intervention_tray_packing_concs <- as.data.frame(connections_intervention_tray_packing_w8wed_conc_list)
connections_intervention_tray_packing_concs$area <- as.factor('tray packing')
connections_intervention_tray_packing_concs$scenario <- as.factor('AI_04')
connections_intervention_tray_packing_concs$water <- as.factor('Dry')
names(connections_intervention_tray_packing_concs) <- c('concentration','area','scenario','water')

connections_intervention_other_concs <- as.data.frame(connections_intervention_other_w8wed_conc_list)
connections_intervention_other_concs$area <- as.factor('other')
connections_intervention_other_concs$scenario <- as.factor('AI_04')
connections_intervention_other_concs$water <- as.factor('Dry')
names(connections_intervention_other_concs) <- c('concentration','area','scenario','water')

connections_intervention_w8wed_concs <- rbind(connections_intervention_loading_concs,connections_intervention_cleaning_concs,connections_intervention_sorting_concs,connections_intervention_tray_packing_concs,connections_intervention_reject_concs,connections_intervention_other_concs)

connections_intervention_loading_prev <- as.data.frame(NL_table_Connections_intervention$loading_w8wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_loading_prev$area <- as.factor('loading')
connections_intervention_loading_prev$scenario <- as.factor('AI_04')
connections_intervention_loading_prev$water <- as.factor('Wet')
names(connections_intervention_loading_prev) <- c('prevalence','area','scenario','water')

connections_intervention_cleaning_prev <- as.data.frame(NL_table_Connections_intervention$cleaning_w8wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_cleaning_prev$area <- as.factor('cleaning')
connections_intervention_cleaning_prev$scenario <- as.factor('AI_04')
connections_intervention_cleaning_prev$water <- as.factor('Wet')
names(connections_intervention_cleaning_prev) <- c('prevalence','area','scenario','water')

connections_intervention_sorting_prev <- as.data.frame(NL_table_Connections_intervention$sorting_w8wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_sorting_prev$area <- as.factor('sorting')
connections_intervention_sorting_prev$scenario <- as.factor('AI_04')
connections_intervention_sorting_prev$water <- as.factor('Dry')
names(connections_intervention_sorting_prev) <- c('prevalence','area','scenario','water')

connections_intervention_reject_prev <- as.data.frame(NL_table_Connections_intervention$reject_w8wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_reject_prev$area <- as.factor('reject')
connections_intervention_reject_prev$scenario <- as.factor('AI_04')
connections_intervention_reject_prev$water <- as.factor('Dry')
names(connections_intervention_reject_prev) <- c('prevalence','area','scenario','water')

connections_intervention_tray_packing_prev <- as.data.frame(NL_table_Connections_intervention$tray_packing_w8wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_tray_packing_prev$area <- as.factor('tray packing')
connections_intervention_tray_packing_prev$scenario <- as.factor('AI_04')
connections_intervention_tray_packing_prev$water <- as.factor('Dry')
names(connections_intervention_tray_packing_prev) <- c('prevalence','area','scenario','water')

connections_intervention_other_prev <- as.data.frame(NL_table_Connections_intervention$other_w8wed_prev[order(NL_table_Connections_intervention$local_seed)])
connections_intervention_other_prev$area <- as.factor('other')
connections_intervention_other_prev$scenario <- as.factor('AI_04')
connections_intervention_other_prev$water <- as.factor('Dry')
names(connections_intervention_other_prev) <- c('prevalence','area','scenario','water')

connections_intervention_w8wed_prev <- rbind(connections_intervention_loading_prev,connections_intervention_cleaning_prev,connections_intervention_sorting_prev,connections_intervention_tray_packing_prev,connections_intervention_reject_prev,connections_intervention_other_prev)

connections_intervention_w8wed_wet_prev <- as.data.frame(connections_intervention_loading_prev$prevalence*21/100+connections_intervention_cleaning_prev$prevalence*28/100)/49*100
connections_intervention_w8wed_wet_prev$scenario <- as.factor('AI_04')
connections_intervention_w8wed_wet_prev$water <- as.factor('Wet')
names(connections_intervention_w8wed_wet_prev) <- c('prevalence','scenario','water')

connections_intervention_w8wed_dry_prev <- as.data.frame(connections_intervention_sorting_prev$prevalence*20/100+connections_intervention_reject_prev$prevalence*23/100+connections_intervention_tray_packing_prev$prevalence*123/100+connections_intervention_other_prev$prevalence*10/100)/176*100
connections_intervention_w8wed_dry_prev$scenario <- as.factor('AI_04')
connections_intervention_w8wed_dry_prev$water <- as.factor('Dry')
names(connections_intervention_w8wed_dry_prev) <- c('prevalence','scenario','water')

connections_intervention_w8wed_recombined_prev <- rbind(connections_intervention_w8wed_wet_prev, connections_intervention_w8wed_dry_prev)

connections_intervention_w1wed_prev$week <- as.factor(1)
connections_intervention_w2wed_prev$week <- as.factor(2)
connections_intervention_w3wed_prev$week <- as.factor(3)
connections_intervention_w4wed_prev$week <- as.factor(4)
connections_intervention_w5wed_prev$week <- as.factor(5)
connections_intervention_w6wed_prev$week <- as.factor(6)
connections_intervention_w7wed_prev$week <- as.factor(7)
connections_intervention_w8wed_prev$week <- as.factor(8)

connections_intervention_w1wed_recombined_prev$week <- as.factor(1)
connections_intervention_w2wed_recombined_prev$week <- as.factor(2)
connections_intervention_w3wed_recombined_prev$week <- as.factor(3)
connections_intervention_w4wed_recombined_prev$week <- as.factor(4)
connections_intervention_w5wed_recombined_prev$week <- as.factor(5)
connections_intervention_w6wed_recombined_prev$week <- as.factor(6)
connections_intervention_w7wed_recombined_prev$week <- as.factor(7)
connections_intervention_w8wed_recombined_prev$week <- as.factor(8)
connections_intervention_allwed_prev <- rbind(connections_intervention_w1wed_recombined_prev,connections_intervention_w2wed_recombined_prev,connections_intervention_w3wed_recombined_prev,connections_intervention_w4wed_recombined_prev,connections_intervention_w5wed_recombined_prev,connections_intervention_w6wed_recombined_prev,connections_intervention_w7wed_recombined_prev,connections_intervention_w8wed_recombined_prev)

vector <- NL_table_Connections_intervention$lifetime_conc_list[order(NL_table_Connections_intervention$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

connections_intervention_w1wed_recombined_prev$week <- as.factor(1)
connections_intervention_w2wed_recombined_prev$week <- as.factor(2)
connections_intervention_w3wed_recombined_prev$week <- as.factor(3)
connections_intervention_w4wed_recombined_prev$week <- as.factor(4)
connections_intervention_w5wed_recombined_prev$week <- as.factor(5)
connections_intervention_w6wed_recombined_prev$week <- as.factor(6)
connections_intervention_w7wed_recombined_prev$week <- as.factor(7)
connections_intervention_w8wed_recombined_prev$week <- as.factor(8)
connections_intervention_allwed_prev <- rbind(connections_intervention_w1wed_recombined_prev,connections_intervention_w2wed_recombined_prev,connections_intervention_w3wed_recombined_prev,connections_intervention_w4wed_recombined_prev,connections_intervention_w5wed_recombined_prev,connections_intervention_w6wed_recombined_prev,connections_intervention_w7wed_recombined_prev,connections_intervention_w8wed_recombined_prev)

Facility_B_connections_intervention_agents_melted <- melt(mdarray)
colnames(Facility_B_connections_intervention_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_connections_intervention_agents_melted$agent <- Facility_B_connections_intervention_agents_melted$agent-1
Facility_B_connections_intervention_agents_melted$logical <- Facility_B_connections_intervention_agents_melted$value>0
Facility_B_connections_intervention_agents_melted$binary <- as.numeric(Facility_B_connections_intervention_agents_melted$logical)
Facility_B_connections_intervention_agents_melted$log10value <- log10(Facility_B_connections_intervention_agents_melted$value)
Facility_B_connections_intervention_agents_melted$log10value[is.infinite(Facility_B_connections_intervention_agents_melted$log10value)] <- 0

agent <- Facility_B_connections_intervention_agents_melted$agent
iteration <- Facility_B_connections_intervention_agents_melted$iteration
tick <- Facility_B_connections_intervention_agents_melted$tick
rle_matrix <- tapply(Facility_B_connections_intervention_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_connections_intervention_mean_value_matrix <- tapply(Facility_B_connections_intervention_agents_melted$value, list(agent, tick), mean)
Facility_B_connections_intervention_median_value_matrix <- tapply(Facility_B_connections_intervention_agents_melted$value, list(agent, tick), median)
Facility_B_connections_intervention_prob_value_matrix <- tapply(Facility_B_connections_intervention_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}
# durations$agent <- durations$agent-1

Facility_B_durations_connections_intervention <- durations

agents_list_connections_intervention <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_connections_intervention <- agents_list_connections_intervention[,c("V1","V7","V8","V9")]
colnames(agents_list_connections_intervention) <- c("name","sanitation_status","schedule","area")
#Time to persistence
agents_list_connections_intervention$time_to_persistence <- rep((168*2),225)
agents_list_connections_intervention$time_to_persistence[agents_list_connections_intervention$schedule=="daily"] <- (24*2)
#Scenario
agents_list_connections_intervention$scenario <- as.factor('AI_04')

persistent_durations_list_connections_intervention <- vector()
transient_durations_list_connections_intervention <- vector()
excess_durations_list_connections_intervention <- vector()
agent <- 1
while(agent<=225) {
  #All Durations####
  #Minimum Contamination Duration
  agents_list_connections_intervention$min_duration[agent] <- ifelse(length(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent])==0,NA,min(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_connections_intervention$mean_duration[agent] <- ifelse(length(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent])==0,NA,mean(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_connections_intervention$median_duration[agent] <- ifelse(length(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent])==0,NA,median(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_connections_intervention$max_duration[agent] <- ifelse(length(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent])==0,NA,max(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_connections_intervention$contamination_events[agent] <- sum(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_connections_intervention$times_persistent[agent] <- sum(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent]>agents_list_connections_intervention$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_connections_intervention$q1_duration[agent] <- quantile(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_connections_intervention$q3_duration[agent] <- quantile(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_connections_intervention$min_persistent_duration[agent] <- ifelse((length(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent])==0) || (agents_list_connections_intervention$times_persistent[agent]==0),NA,min(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent & Facility_B_durations_connections_intervention$duration>=agents_list_connections_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_connections_intervention$mean_persistent_duration[agent] <- ifelse((length(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent])==0) || (agents_list_connections_intervention$times_persistent[agent]==0),NA,mean(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent & Facility_B_durations_connections_intervention$duration>=agents_list_connections_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_connections_intervention$median_persistent_duration[agent] <- ifelse((length(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent])==0) || (agents_list_connections_intervention$times_persistent[agent]==0),NA,median(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent & Facility_B_durations_connections_intervention$duration>=agents_list_connections_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_connections_intervention$max_persistent_duration[agent] <- ifelse((length(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent])==0) || (agents_list_connections_intervention$times_persistent[agent]==0),NA,max(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent & Facility_B_durations_connections_intervention$duration>=agents_list_connections_intervention$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_connections_intervention$q1_persistent_duration[agent] <- ifelse((length(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent])==0) || (agents_list_connections_intervention$times_persistent[agent]==0),NA,quantile(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent & Facility_B_durations_connections_intervention$duration>=agents_list_connections_intervention$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_connections_intervention$q3_persistent_duration[agent] <- ifelse((length(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent])==0) || (agents_list_connections_intervention$times_persistent[agent]==0),NA,quantile(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent & Facility_B_durations_connections_intervention$duration>=agents_list_connections_intervention$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated between iterations
  x <- Facility_B_durations_connections_intervention[which(Facility_B_durations_connections_intervention$agent==agent & Facility_B_durations_connections_intervention$duration>agents_list_connections_intervention$time_to_persistence[agent]),]
  agents_list_connections_intervention$mean_times_persistent[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_connections_intervention$mean_times_persistent[which(is.na(agents_list_connections_intervention$mean_times_persistent))] <- 0
  #Division by total number of iterations in simulation
  agents_list_connections_intervention$balanced_times_persistent[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent])!=0) || (agents_list_connections_intervention$times_persistent[agent]!=0)) {
    persistent_durations_list_connections_intervention <- append(persistent_durations_list_connections_intervention, Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent & Facility_B_durations_connections_intervention$duration>=agents_list_connections_intervention$time_to_persistence[agent]])
    excess_durations_list_connections_intervention <- append(
      excess_durations_list_connections_intervention,
      Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$agent==agent & Facility_B_durations_connections_intervention$duration>=agents_list_connections_intervention$time_to_persistence[agent]]-agents_list_connections_intervention$time_to_persistence[agent])
  }
  transient_durations_list_connections_intervention <- append(transient_durations_list_connections_intervention, Facility_B_durations_connections_intervention$duration[Facility_B_durations_connections_intervention$duration<agents_list_connections_intervention$time_to_persistence[agent] & Facility_B_durations_connections_intervention$agent==agent])
  agent <- agent+1
}

Facility_B_connections_intervention_agents_melted_monday_preop <- Facility_B_connections_intervention_agents_melted[which(Facility_B_connections_intervention_agents_melted$tick==33|Facility_B_connections_intervention_agents_melted$tick==201|Facility_B_connections_intervention_agents_melted$tick==369|Facility_B_connections_intervention_agents_melted$tick==537|Facility_B_connections_intervention_agents_melted$tick==705|Facility_B_connections_intervention_agents_melted$tick==873|Facility_B_connections_intervention_agents_melted$tick==1041|Facility_B_connections_intervention_agents_melted$tick==1209),]

Facility_B_connections_intervention_agents_melted_tuesday_preop <- Facility_B_connections_intervention_agents_melted[which(Facility_B_connections_intervention_agents_melted$tick==57|Facility_B_connections_intervention_agents_melted$tick==225|Facility_B_connections_intervention_agents_melted$tick==393|Facility_B_connections_intervention_agents_melted$tick==561|Facility_B_connections_intervention_agents_melted$tick==729|Facility_B_connections_intervention_agents_melted$tick==897|Facility_B_connections_intervention_agents_melted$tick==1065|Facility_B_connections_intervention_agents_melted$tick==1233),]

Facility_B_connections_intervention_agents_melted_wednesday_preop <- Facility_B_connections_intervention_agents_melted[which(Facility_B_connections_intervention_agents_melted$tick==81|Facility_B_connections_intervention_agents_melted$tick==249|Facility_B_connections_intervention_agents_melted$tick==417|Facility_B_connections_intervention_agents_melted$tick==585|Facility_B_connections_intervention_agents_melted$tick==753|Facility_B_connections_intervention_agents_melted$tick==921|Facility_B_connections_intervention_agents_melted$tick==1089|Facility_B_connections_intervention_agents_melted$tick==1257),]

Facility_B_connections_intervention_agents_melted_thursday_preop <- Facility_B_connections_intervention_agents_melted[which(Facility_B_connections_intervention_agents_melted$tick==105|Facility_B_connections_intervention_agents_melted$tick==273|Facility_B_connections_intervention_agents_melted$tick==441|Facility_B_connections_intervention_agents_melted$tick==609|Facility_B_connections_intervention_agents_melted$tick==777|Facility_B_connections_intervention_agents_melted$tick==945|Facility_B_connections_intervention_agents_melted$tick==1113|Facility_B_connections_intervention_agents_melted$tick==1281),]

Facility_B_connections_intervention_agents_melted_friday_preop <- Facility_B_connections_intervention_agents_melted[which(Facility_B_connections_intervention_agents_melted$tick==129|Facility_B_connections_intervention_agents_melted$tick==297|Facility_B_connections_intervention_agents_melted$tick==465|Facility_B_connections_intervention_agents_melted$tick==633|Facility_B_connections_intervention_agents_melted$tick==801|Facility_B_connections_intervention_agents_melted$tick==969|Facility_B_connections_intervention_agents_melted$tick==1137|Facility_B_connections_intervention_agents_melted$tick==1305),]

Facility_B_connections_intervention_agents_melted_ff <- as.ffdf(Facility_B_connections_intervention_agents_melted)
rm(Facility_B_connections_intervention_agents_melted)
gc()
```

```{r import Index Case 1}
NL_table_Index_1 <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-25-11-09 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Pre_Contamination-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Index_1 <- NL_table_Index_1[NL_table_Index_1$scenario==51,]

while (any(grepl('-', names(NL_table_Index_1), fixed = TRUE))) {
  NL_table_Index_1 <- NL_table_Index_1 %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Index_1), fixed = TRUE))) {
  NL_table_Index_1 <- NL_table_Index_1 %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Index_1), fixed = TRUE))) {
  NL_table_Index_1 <- NL_table_Index_1 %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Index_1), fixed = TRUE))) {
  NL_table_Index_1 <- NL_table_Index_1 %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Index_1[ , ..list_columns]

NL_table_Index_1[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Index_1 <- as.data.frame(NL_table_Index_1)

NL_table_Index_1[NL_table_Index_1==-1] <- NA

NL_table_Index_1 <- subset(NL_table_Index_1, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Index_1)[names(NL_table_Index_1)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Index_1)[names(NL_table_Index_1)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Index_1$loading_w1wed_conc_list
vector <- vector[vector!='[]']
index_1_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_loading_w1wed_conc_list <- append(index_1_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_loading_w1wed_conc_matrix <- matrix(unlist(index_1_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_1$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
index_1_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_cleaning_w1wed_conc_list <- append(index_1_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_cleaning_w1wed_conc_matrix <- matrix(unlist(index_1_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_1$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# index_1_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_1_drying_w1wed_conc_list <- append(index_1_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_1$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
index_1_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_sorting_w1wed_conc_list <- append(index_1_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_sorting_w1wed_conc_matrix <- matrix(unlist(index_1_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_1$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
index_1_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_tray_packing_w1wed_conc_list <- append(index_1_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_tray_packing_w1wed_conc_matrix <- matrix(unlist(index_1_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_1$reject_w1wed_conc_list
vector <- vector[vector!='[]']
index_1_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_reject_w1wed_conc_list <- append(index_1_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_reject_w1wed_conc_matrix <- matrix(unlist(index_1_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_1$other_w1wed_conc_list
vector <- vector[vector!='[]']
index_1_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_other_w1wed_conc_list <- append(index_1_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_other_w1wed_conc_matrix <- matrix(unlist(index_1_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

index_1_loading_concs <- as.data.frame(index_1_loading_w1wed_conc_list)
index_1_loading_concs$area <- as.factor('loading')
index_1_loading_concs$scenario <- as.factor('XI_02A1')
index_1_loading_concs$water <- as.factor('Wet')
names(index_1_loading_concs) <- c('concentration','area','scenario','water')

index_1_cleaning_concs <- as.data.frame(index_1_cleaning_w1wed_conc_list)
index_1_cleaning_concs$area <- as.factor('cleaning')
index_1_cleaning_concs$scenario <- as.factor('XI_02A1')
index_1_cleaning_concs$water <- as.factor('Wet')
names(index_1_cleaning_concs) <- c('concentration','area','scenario','water')

index_1_sorting_concs <- as.data.frame(index_1_sorting_w1wed_conc_list)
index_1_sorting_concs$area <- as.factor('sorting')
index_1_sorting_concs$scenario <- as.factor('XI_02A1')
index_1_sorting_concs$water <- as.factor('Dry')
names(index_1_sorting_concs) <- c('concentration','area','scenario','water')

index_1_reject_concs <- as.data.frame(index_1_reject_w1wed_conc_list)
index_1_reject_concs$area <- as.factor('reject')
index_1_reject_concs$scenario <- as.factor('XI_02A1')
index_1_reject_concs$water <- as.factor('Dry')
names(index_1_reject_concs) <- c('concentration','area','scenario','water')

index_1_tray_packing_concs <- as.data.frame(index_1_tray_packing_w1wed_conc_list)
index_1_tray_packing_concs$area <- as.factor('tray packing')
index_1_tray_packing_concs$scenario <- as.factor('XI_02A1')
index_1_tray_packing_concs$water <- as.factor('Dry')
names(index_1_tray_packing_concs) <- c('concentration','area','scenario','water')

index_1_other_concs <- as.data.frame(index_1_other_w1wed_conc_list)
index_1_other_concs$area <- as.factor('other')
index_1_other_concs$scenario <- as.factor('XI_02A1')
index_1_other_concs$water <- as.factor('Dry')
names(index_1_other_concs) <- c('concentration','area','scenario','water')

index_1_w1wed_concs <- rbind(index_1_loading_concs,index_1_cleaning_concs,index_1_sorting_concs,index_1_tray_packing_concs,index_1_reject_concs,index_1_other_concs)

index_1_loading_prev <- as.data.frame(NL_table_Index_1$loading_w1wed_prev[order(NL_table_Index_1$local_seed)])
index_1_loading_prev$area <- as.factor('loading')
index_1_loading_prev$scenario <- as.factor('XI_02A1')
index_1_loading_prev$water <- as.factor('Wet')
names(index_1_loading_prev) <- c('prevalence','area','scenario','water')

index_1_cleaning_prev <- as.data.frame(NL_table_Index_1$cleaning_w1wed_prev[order(NL_table_Index_1$local_seed)])
index_1_cleaning_prev$area <- as.factor('cleaning')
index_1_cleaning_prev$scenario <- as.factor('XI_02A1')
index_1_cleaning_prev$water <- as.factor('Wet')
names(index_1_cleaning_prev) <- c('prevalence','area','scenario','water')

index_1_sorting_prev <- as.data.frame(NL_table_Index_1$sorting_w1wed_prev[order(NL_table_Index_1$local_seed)])
index_1_sorting_prev$area <- as.factor('sorting')
index_1_sorting_prev$scenario <- as.factor('XI_02A1')
index_1_sorting_prev$water <- as.factor('Dry')
names(index_1_sorting_prev) <- c('prevalence','area','scenario','water')

index_1_reject_prev <- as.data.frame(NL_table_Index_1$reject_w1wed_prev[order(NL_table_Index_1$local_seed)])
index_1_reject_prev$area <- as.factor('reject')
index_1_reject_prev$scenario <- as.factor('XI_02A1')
index_1_reject_prev$water <- as.factor('Dry')
names(index_1_reject_prev) <- c('prevalence','area','scenario','water')

index_1_tray_packing_prev <- as.data.frame(NL_table_Index_1$tray_packing_w1wed_prev[order(NL_table_Index_1$local_seed)])
index_1_tray_packing_prev$area <- as.factor('tray packing')
index_1_tray_packing_prev$scenario <- as.factor('XI_02A1')
index_1_tray_packing_prev$water <- as.factor('Dry')
names(index_1_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_1_other_prev <- as.data.frame(NL_table_Index_1$other_w1wed_prev[order(NL_table_Index_1$local_seed)])
index_1_other_prev$area <- as.factor('other')
index_1_other_prev$scenario <- as.factor('XI_02A1')
index_1_other_prev$water <- as.factor('Dry')
names(index_1_other_prev) <- c('prevalence','area','scenario','water')

index_1_w1wed_prev <- rbind(index_1_loading_prev,index_1_cleaning_prev,index_1_sorting_prev,index_1_tray_packing_prev,index_1_reject_prev,index_1_other_prev)

index_1_w1wed_wet_prev <- as.data.frame(index_1_loading_prev$prevalence*21/100+index_1_cleaning_prev$prevalence*28/100)/49*100
index_1_w1wed_wet_prev$scenario <- as.factor('XI_02A1')
index_1_w1wed_wet_prev$water <- as.factor('Wet')
names(index_1_w1wed_wet_prev) <- c('prevalence','scenario','water')

index_1_w1wed_dry_prev <- as.data.frame(index_1_sorting_prev$prevalence*20/100+index_1_reject_prev$prevalence*23/100+index_1_tray_packing_prev$prevalence*123/100+index_1_other_prev$prevalence*10/100)/176*100
index_1_w1wed_dry_prev$scenario <- as.factor('XI_02A1')
index_1_w1wed_dry_prev$water <- as.factor('Dry')
names(index_1_w1wed_dry_prev) <- c('prevalence','scenario','water')

index_1_w1wed_recombined_prev <- rbind(index_1_w1wed_wet_prev, index_1_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Index_1$loading_w2wed_conc_list
vector <- vector[vector!='[]']
index_1_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_loading_w2wed_conc_list <- append(index_1_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_loading_w2wed_conc_matrix <- matrix(unlist(index_1_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_1$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
index_1_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_cleaning_w2wed_conc_list <- append(index_1_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_cleaning_w2wed_conc_matrix <- matrix(unlist(index_1_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_1$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# index_1_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_1_drying_w2wed_conc_list <- append(index_1_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_1$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
index_1_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_sorting_w2wed_conc_list <- append(index_1_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_sorting_w2wed_conc_matrix <- matrix(unlist(index_1_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_1$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
index_1_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_tray_packing_w2wed_conc_list <- append(index_1_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_tray_packing_w2wed_conc_matrix <- matrix(unlist(index_1_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_1$reject_w2wed_conc_list
vector <- vector[vector!='[]']
index_1_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_reject_w2wed_conc_list <- append(index_1_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_reject_w2wed_conc_matrix <- matrix(unlist(index_1_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_1$other_w2wed_conc_list
vector <- vector[vector!='[]']
index_1_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_other_w2wed_conc_list <- append(index_1_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_other_w2wed_conc_matrix <- matrix(unlist(index_1_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

index_1_loading_concs <- as.data.frame(index_1_loading_w2wed_conc_list)
index_1_loading_concs$area <- as.factor('loading')
index_1_loading_concs$scenario <- as.factor('XI_02A1')
index_1_loading_concs$water <- as.factor('Wet')
names(index_1_loading_concs) <- c('concentration','area','scenario','water')

index_1_cleaning_concs <- as.data.frame(index_1_cleaning_w2wed_conc_list)
index_1_cleaning_concs$area <- as.factor('cleaning')
index_1_cleaning_concs$scenario <- as.factor('XI_02A1')
index_1_cleaning_concs$water <- as.factor('Wet')
names(index_1_cleaning_concs) <- c('concentration','area','scenario','water')

index_1_sorting_concs <- as.data.frame(index_1_sorting_w2wed_conc_list)
index_1_sorting_concs$area <- as.factor('sorting')
index_1_sorting_concs$scenario <- as.factor('XI_02A1')
index_1_sorting_concs$water <- as.factor('Dry')
names(index_1_sorting_concs) <- c('concentration','area','scenario','water')

index_1_reject_concs <- as.data.frame(index_1_reject_w2wed_conc_list)
index_1_reject_concs$area <- as.factor('reject')
index_1_reject_concs$scenario <- as.factor('XI_02A1')
index_1_reject_concs$water <- as.factor('Dry')
names(index_1_reject_concs) <- c('concentration','area','scenario','water')

index_1_tray_packing_concs <- as.data.frame(index_1_tray_packing_w2wed_conc_list)
index_1_tray_packing_concs$area <- as.factor('tray packing')
index_1_tray_packing_concs$scenario <- as.factor('XI_02A1')
index_1_tray_packing_concs$water <- as.factor('Dry')
names(index_1_tray_packing_concs) <- c('concentration','area','scenario','water')

index_1_other_concs <- as.data.frame(index_1_other_w2wed_conc_list)
index_1_other_concs$area <- as.factor('other')
index_1_other_concs$scenario <- as.factor('XI_02A1')
index_1_other_concs$water <- as.factor('Dry')
names(index_1_other_concs) <- c('concentration','area','scenario','water')

index_1_w2wed_concs <- rbind(index_1_loading_concs,index_1_cleaning_concs,index_1_sorting_concs,index_1_tray_packing_concs,index_1_reject_concs,index_1_other_concs)

index_1_loading_prev <- as.data.frame(NL_table_Index_1$loading_w2wed_prev[order(NL_table_Index_1$local_seed)])
index_1_loading_prev$area <- as.factor('loading')
index_1_loading_prev$scenario <- as.factor('XI_02A1')
index_1_loading_prev$water <- as.factor('Wet')
names(index_1_loading_prev) <- c('prevalence','area','scenario','water')

index_1_cleaning_prev <- as.data.frame(NL_table_Index_1$cleaning_w2wed_prev[order(NL_table_Index_1$local_seed)])
index_1_cleaning_prev$area <- as.factor('cleaning')
index_1_cleaning_prev$scenario <- as.factor('XI_02A1')
index_1_cleaning_prev$water <- as.factor('Wet')
names(index_1_cleaning_prev) <- c('prevalence','area','scenario','water')

index_1_sorting_prev <- as.data.frame(NL_table_Index_1$sorting_w2wed_prev[order(NL_table_Index_1$local_seed)])
index_1_sorting_prev$area <- as.factor('sorting')
index_1_sorting_prev$scenario <- as.factor('XI_02A1')
index_1_sorting_prev$water <- as.factor('Dry')
names(index_1_sorting_prev) <- c('prevalence','area','scenario','water')

index_1_reject_prev <- as.data.frame(NL_table_Index_1$reject_w2wed_prev[order(NL_table_Index_1$local_seed)])
index_1_reject_prev$area <- as.factor('reject')
index_1_reject_prev$scenario <- as.factor('XI_02A1')
index_1_reject_prev$water <- as.factor('Dry')
names(index_1_reject_prev) <- c('prevalence','area','scenario','water')

index_1_tray_packing_prev <- as.data.frame(NL_table_Index_1$tray_packing_w2wed_prev[order(NL_table_Index_1$local_seed)])
index_1_tray_packing_prev$area <- as.factor('tray packing')
index_1_tray_packing_prev$scenario <- as.factor('XI_02A1')
index_1_tray_packing_prev$water <- as.factor('Dry')
names(index_1_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_1_other_prev <- as.data.frame(NL_table_Index_1$other_w2wed_prev[order(NL_table_Index_1$local_seed)])
index_1_other_prev$area <- as.factor('other')
index_1_other_prev$scenario <- as.factor('XI_02A1')
index_1_other_prev$water <- as.factor('Dry')
names(index_1_other_prev) <- c('prevalence','area','scenario','water')

index_1_w2wed_prev <- rbind(index_1_loading_prev,index_1_cleaning_prev,index_1_sorting_prev,index_1_tray_packing_prev,index_1_reject_prev,index_1_other_prev)

index_1_w2wed_wet_prev <- as.data.frame(index_1_loading_prev$prevalence*21/100+index_1_cleaning_prev$prevalence*28/100)/49*100
index_1_w2wed_wet_prev$scenario <- as.factor('XI_02A1')
index_1_w2wed_wet_prev$water <- as.factor('Wet')
names(index_1_w2wed_wet_prev) <- c('prevalence','scenario','water')

index_1_w2wed_dry_prev <- as.data.frame(index_1_sorting_prev$prevalence*20/100+index_1_reject_prev$prevalence*23/100+index_1_tray_packing_prev$prevalence*123/100+index_1_other_prev$prevalence*10/100)/176*100
index_1_w2wed_dry_prev$scenario <- as.factor('XI_02A1')
index_1_w2wed_dry_prev$water <- as.factor('Dry')
names(index_1_w2wed_dry_prev) <- c('prevalence','scenario','water')

index_1_w2wed_recombined_prev <- rbind(index_1_w2wed_wet_prev, index_1_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Index_1$loading_w3wed_conc_list
vector <- vector[vector!='[]']
index_1_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_loading_w3wed_conc_list <- append(index_1_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_loading_w3wed_conc_matrix <- matrix(unlist(index_1_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_1$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
index_1_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_cleaning_w3wed_conc_list <- append(index_1_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_cleaning_w3wed_conc_matrix <- matrix(unlist(index_1_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_1$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# index_1_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_1_drying_w3wed_conc_list <- append(index_1_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_1$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
index_1_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_sorting_w3wed_conc_list <- append(index_1_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_sorting_w3wed_conc_matrix <- matrix(unlist(index_1_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_1$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
index_1_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_tray_packing_w3wed_conc_list <- append(index_1_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_tray_packing_w3wed_conc_matrix <- matrix(unlist(index_1_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_1$reject_w3wed_conc_list
vector <- vector[vector!='[]']
index_1_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_reject_w3wed_conc_list <- append(index_1_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_reject_w3wed_conc_matrix <- matrix(unlist(index_1_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_1$other_w3wed_conc_list
vector <- vector[vector!='[]']
index_1_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_other_w3wed_conc_list <- append(index_1_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_other_w3wed_conc_matrix <- matrix(unlist(index_1_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

index_1_loading_concs <- as.data.frame(index_1_loading_w3wed_conc_list)
index_1_loading_concs$area <- as.factor('loading')
index_1_loading_concs$scenario <- as.factor('XI_02A1')
index_1_loading_concs$water <- as.factor('Wet')
names(index_1_loading_concs) <- c('concentration','area','scenario','water')

index_1_cleaning_concs <- as.data.frame(index_1_cleaning_w3wed_conc_list)
index_1_cleaning_concs$area <- as.factor('cleaning')
index_1_cleaning_concs$scenario <- as.factor('XI_02A1')
index_1_cleaning_concs$water <- as.factor('Wet')
names(index_1_cleaning_concs) <- c('concentration','area','scenario','water')

index_1_sorting_concs <- as.data.frame(index_1_sorting_w3wed_conc_list)
index_1_sorting_concs$area <- as.factor('sorting')
index_1_sorting_concs$scenario <- as.factor('XI_02A1')
index_1_sorting_concs$water <- as.factor('Dry')
names(index_1_sorting_concs) <- c('concentration','area','scenario','water')

index_1_reject_concs <- as.data.frame(index_1_reject_w3wed_conc_list)
index_1_reject_concs$area <- as.factor('reject')
index_1_reject_concs$scenario <- as.factor('XI_02A1')
index_1_reject_concs$water <- as.factor('Dry')
names(index_1_reject_concs) <- c('concentration','area','scenario','water')

index_1_tray_packing_concs <- as.data.frame(index_1_tray_packing_w3wed_conc_list)
index_1_tray_packing_concs$area <- as.factor('tray packing')
index_1_tray_packing_concs$scenario <- as.factor('XI_02A1')
index_1_tray_packing_concs$water <- as.factor('Dry')
names(index_1_tray_packing_concs) <- c('concentration','area','scenario','water')

index_1_other_concs <- as.data.frame(index_1_other_w3wed_conc_list)
index_1_other_concs$area <- as.factor('other')
index_1_other_concs$scenario <- as.factor('XI_02A1')
index_1_other_concs$water <- as.factor('Dry')
names(index_1_other_concs) <- c('concentration','area','scenario','water')

index_1_w3wed_concs <- rbind(index_1_loading_concs,index_1_cleaning_concs,index_1_sorting_concs,index_1_tray_packing_concs,index_1_reject_concs,index_1_other_concs)

index_1_loading_prev <- as.data.frame(NL_table_Index_1$loading_w3wed_prev[order(NL_table_Index_1$local_seed)])
index_1_loading_prev$area <- as.factor('loading')
index_1_loading_prev$scenario <- as.factor('XI_02A1')
index_1_loading_prev$water <- as.factor('Wet')
names(index_1_loading_prev) <- c('prevalence','area','scenario','water')

index_1_cleaning_prev <- as.data.frame(NL_table_Index_1$cleaning_w3wed_prev[order(NL_table_Index_1$local_seed)])
index_1_cleaning_prev$area <- as.factor('cleaning')
index_1_cleaning_prev$scenario <- as.factor('XI_02A1')
index_1_cleaning_prev$water <- as.factor('Wet')
names(index_1_cleaning_prev) <- c('prevalence','area','scenario','water')

index_1_sorting_prev <- as.data.frame(NL_table_Index_1$sorting_w3wed_prev[order(NL_table_Index_1$local_seed)])
index_1_sorting_prev$area <- as.factor('sorting')
index_1_sorting_prev$scenario <- as.factor('XI_02A1')
index_1_sorting_prev$water <- as.factor('Dry')
names(index_1_sorting_prev) <- c('prevalence','area','scenario','water')

index_1_reject_prev <- as.data.frame(NL_table_Index_1$reject_w3wed_prev[order(NL_table_Index_1$local_seed)])
index_1_reject_prev$area <- as.factor('reject')
index_1_reject_prev$scenario <- as.factor('XI_02A1')
index_1_reject_prev$water <- as.factor('Dry')
names(index_1_reject_prev) <- c('prevalence','area','scenario','water')

index_1_tray_packing_prev <- as.data.frame(NL_table_Index_1$tray_packing_w3wed_prev[order(NL_table_Index_1$local_seed)])
index_1_tray_packing_prev$area <- as.factor('tray packing')
index_1_tray_packing_prev$scenario <- as.factor('XI_02A1')
index_1_tray_packing_prev$water <- as.factor('Dry')
names(index_1_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_1_other_prev <- as.data.frame(NL_table_Index_1$other_w3wed_prev[order(NL_table_Index_1$local_seed)])
index_1_other_prev$area <- as.factor('other')
index_1_other_prev$scenario <- as.factor('XI_02A1')
index_1_other_prev$water <- as.factor('Dry')
names(index_1_other_prev) <- c('prevalence','area','scenario','water')

index_1_w3wed_prev <- rbind(index_1_loading_prev,index_1_cleaning_prev,index_1_sorting_prev,index_1_tray_packing_prev,index_1_reject_prev,index_1_other_prev)

index_1_w3wed_wet_prev <- as.data.frame(index_1_loading_prev$prevalence*21/100+index_1_cleaning_prev$prevalence*28/100)/49*100
index_1_w3wed_wet_prev$scenario <- as.factor('XI_02A1')
index_1_w3wed_wet_prev$water <- as.factor('Wet')
names(index_1_w3wed_wet_prev) <- c('prevalence','scenario','water')

index_1_w3wed_dry_prev <- as.data.frame(index_1_sorting_prev$prevalence*20/100+index_1_reject_prev$prevalence*23/100+index_1_tray_packing_prev$prevalence*123/100+index_1_other_prev$prevalence*10/100)/176*100
index_1_w3wed_dry_prev$scenario <- as.factor('XI_02A1')
index_1_w3wed_dry_prev$water <- as.factor('Dry')
names(index_1_w3wed_dry_prev) <- c('prevalence','scenario','water')

index_1_w3wed_recombined_prev <- rbind(index_1_w3wed_wet_prev, index_1_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Index_1$loading_w4wed_conc_list
vector <- vector[vector!='[]']
index_1_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_loading_w4wed_conc_list <- append(index_1_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_loading_w4wed_conc_matrix <- matrix(unlist(index_1_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_1$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
index_1_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_cleaning_w4wed_conc_list <- append(index_1_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_cleaning_w4wed_conc_matrix <- matrix(unlist(index_1_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_1$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# index_1_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_1_drying_w4wed_conc_list <- append(index_1_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_1$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
index_1_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_sorting_w4wed_conc_list <- append(index_1_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_sorting_w4wed_conc_matrix <- matrix(unlist(index_1_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_1$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
index_1_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_tray_packing_w4wed_conc_list <- append(index_1_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_tray_packing_w4wed_conc_matrix <- matrix(unlist(index_1_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_1$reject_w4wed_conc_list
vector <- vector[vector!='[]']
index_1_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_reject_w4wed_conc_list <- append(index_1_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_reject_w4wed_conc_matrix <- matrix(unlist(index_1_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_1$other_w4wed_conc_list
vector <- vector[vector!='[]']
index_1_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_other_w4wed_conc_list <- append(index_1_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_other_w4wed_conc_matrix <- matrix(unlist(index_1_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

index_1_loading_concs <- as.data.frame(index_1_loading_w4wed_conc_list)
index_1_loading_concs$area <- as.factor('loading')
index_1_loading_concs$scenario <- as.factor('XI_02A1')
index_1_loading_concs$water <- as.factor('Wet')
names(index_1_loading_concs) <- c('concentration','area','scenario','water')

index_1_cleaning_concs <- as.data.frame(index_1_cleaning_w4wed_conc_list)
index_1_cleaning_concs$area <- as.factor('cleaning')
index_1_cleaning_concs$scenario <- as.factor('XI_02A1')
index_1_cleaning_concs$water <- as.factor('Wet')
names(index_1_cleaning_concs) <- c('concentration','area','scenario','water')

index_1_sorting_concs <- as.data.frame(index_1_sorting_w4wed_conc_list)
index_1_sorting_concs$area <- as.factor('sorting')
index_1_sorting_concs$scenario <- as.factor('XI_02A1')
index_1_sorting_concs$water <- as.factor('Dry')
names(index_1_sorting_concs) <- c('concentration','area','scenario','water')

index_1_reject_concs <- as.data.frame(index_1_reject_w4wed_conc_list)
index_1_reject_concs$area <- as.factor('reject')
index_1_reject_concs$scenario <- as.factor('XI_02A1')
index_1_reject_concs$water <- as.factor('Dry')
names(index_1_reject_concs) <- c('concentration','area','scenario','water')

index_1_tray_packing_concs <- as.data.frame(index_1_tray_packing_w4wed_conc_list)
index_1_tray_packing_concs$area <- as.factor('tray packing')
index_1_tray_packing_concs$scenario <- as.factor('XI_02A1')
index_1_tray_packing_concs$water <- as.factor('Dry')
names(index_1_tray_packing_concs) <- c('concentration','area','scenario','water')

index_1_other_concs <- as.data.frame(index_1_other_w4wed_conc_list)
index_1_other_concs$area <- as.factor('other')
index_1_other_concs$scenario <- as.factor('XI_02A1')
index_1_other_concs$water <- as.factor('Dry')
names(index_1_other_concs) <- c('concentration','area','scenario','water')

index_1_w4wed_concs <- rbind(index_1_loading_concs,index_1_cleaning_concs,index_1_sorting_concs,index_1_tray_packing_concs,index_1_reject_concs,index_1_other_concs)

index_1_loading_prev <- as.data.frame(NL_table_Index_1$loading_w4wed_prev[order(NL_table_Index_1$local_seed)])
index_1_loading_prev$area <- as.factor('loading')
index_1_loading_prev$scenario <- as.factor('XI_02A1')
index_1_loading_prev$water <- as.factor('Wet')
names(index_1_loading_prev) <- c('prevalence','area','scenario','water')

index_1_cleaning_prev <- as.data.frame(NL_table_Index_1$cleaning_w4wed_prev[order(NL_table_Index_1$local_seed)])
index_1_cleaning_prev$area <- as.factor('cleaning')
index_1_cleaning_prev$scenario <- as.factor('XI_02A1')
index_1_cleaning_prev$water <- as.factor('Wet')
names(index_1_cleaning_prev) <- c('prevalence','area','scenario','water')

index_1_sorting_prev <- as.data.frame(NL_table_Index_1$sorting_w4wed_prev[order(NL_table_Index_1$local_seed)])
index_1_sorting_prev$area <- as.factor('sorting')
index_1_sorting_prev$scenario <- as.factor('XI_02A1')
index_1_sorting_prev$water <- as.factor('Dry')
names(index_1_sorting_prev) <- c('prevalence','area','scenario','water')

index_1_reject_prev <- as.data.frame(NL_table_Index_1$reject_w4wed_prev[order(NL_table_Index_1$local_seed)])
index_1_reject_prev$area <- as.factor('reject')
index_1_reject_prev$scenario <- as.factor('XI_02A1')
index_1_reject_prev$water <- as.factor('Dry')
names(index_1_reject_prev) <- c('prevalence','area','scenario','water')

index_1_tray_packing_prev <- as.data.frame(NL_table_Index_1$tray_packing_w4wed_prev[order(NL_table_Index_1$local_seed)])
index_1_tray_packing_prev$area <- as.factor('tray packing')
index_1_tray_packing_prev$scenario <- as.factor('XI_02A1')
index_1_tray_packing_prev$water <- as.factor('Dry')
names(index_1_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_1_other_prev <- as.data.frame(NL_table_Index_1$other_w4wed_prev[order(NL_table_Index_1$local_seed)])
index_1_other_prev$area <- as.factor('other')
index_1_other_prev$scenario <- as.factor('XI_02A1')
index_1_other_prev$water <- as.factor('Dry')
names(index_1_other_prev) <- c('prevalence','area','scenario','water')

index_1_w4wed_prev <- rbind(index_1_loading_prev,index_1_cleaning_prev,index_1_sorting_prev,index_1_tray_packing_prev,index_1_reject_prev,index_1_other_prev)

index_1_w4wed_wet_prev <- as.data.frame(index_1_loading_prev$prevalence*21/100+index_1_cleaning_prev$prevalence*28/100)/49*100
index_1_w4wed_wet_prev$scenario <- as.factor('XI_02A1')
index_1_w4wed_wet_prev$water <- as.factor('Wet')
names(index_1_w4wed_wet_prev) <- c('prevalence','scenario','water')

index_1_w4wed_dry_prev <- as.data.frame(index_1_sorting_prev$prevalence*20/100+index_1_reject_prev$prevalence*23/100+index_1_tray_packing_prev$prevalence*123/100+index_1_other_prev$prevalence*10/100)/176*100
index_1_w4wed_dry_prev$scenario <- as.factor('XI_02A1')
index_1_w4wed_dry_prev$water <- as.factor('Dry')
names(index_1_w4wed_dry_prev) <- c('prevalence','scenario','water')

index_1_w4wed_recombined_prev <- rbind(index_1_w4wed_wet_prev, index_1_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Index_1$loading_w5wed_conc_list
vector <- vector[vector!='[]']
index_1_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_loading_w5wed_conc_list <- append(index_1_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_loading_w5wed_conc_matrix <- matrix(unlist(index_1_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_1$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
index_1_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_cleaning_w5wed_conc_list <- append(index_1_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_cleaning_w5wed_conc_matrix <- matrix(unlist(index_1_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_1$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# index_1_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_1_drying_w5wed_conc_list <- append(index_1_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_1$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
index_1_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_sorting_w5wed_conc_list <- append(index_1_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_sorting_w5wed_conc_matrix <- matrix(unlist(index_1_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_1$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
index_1_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_tray_packing_w5wed_conc_list <- append(index_1_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_tray_packing_w5wed_conc_matrix <- matrix(unlist(index_1_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_1$reject_w5wed_conc_list
vector <- vector[vector!='[]']
index_1_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_reject_w5wed_conc_list <- append(index_1_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_reject_w5wed_conc_matrix <- matrix(unlist(index_1_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_1$other_w5wed_conc_list
vector <- vector[vector!='[]']
index_1_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_other_w5wed_conc_list <- append(index_1_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_other_w5wed_conc_matrix <- matrix(unlist(index_1_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

index_1_loading_concs <- as.data.frame(index_1_loading_w5wed_conc_list)
index_1_loading_concs$area <- as.factor('loading')
index_1_loading_concs$scenario <- as.factor('XI_02A1')
index_1_loading_concs$water <- as.factor('Wet')
names(index_1_loading_concs) <- c('concentration','area','scenario','water')

index_1_cleaning_concs <- as.data.frame(index_1_cleaning_w5wed_conc_list)
index_1_cleaning_concs$area <- as.factor('cleaning')
index_1_cleaning_concs$scenario <- as.factor('XI_02A1')
index_1_cleaning_concs$water <- as.factor('Wet')
names(index_1_cleaning_concs) <- c('concentration','area','scenario','water')

index_1_sorting_concs <- as.data.frame(index_1_sorting_w5wed_conc_list)
index_1_sorting_concs$area <- as.factor('sorting')
index_1_sorting_concs$scenario <- as.factor('XI_02A1')
index_1_sorting_concs$water <- as.factor('Dry')
names(index_1_sorting_concs) <- c('concentration','area','scenario','water')

index_1_reject_concs <- as.data.frame(index_1_reject_w5wed_conc_list)
index_1_reject_concs$area <- as.factor('reject')
index_1_reject_concs$scenario <- as.factor('XI_02A1')
index_1_reject_concs$water <- as.factor('Dry')
names(index_1_reject_concs) <- c('concentration','area','scenario','water')

index_1_tray_packing_concs <- as.data.frame(index_1_tray_packing_w5wed_conc_list)
index_1_tray_packing_concs$area <- as.factor('tray packing')
index_1_tray_packing_concs$scenario <- as.factor('XI_02A1')
index_1_tray_packing_concs$water <- as.factor('Dry')
names(index_1_tray_packing_concs) <- c('concentration','area','scenario','water')

index_1_other_concs <- as.data.frame(index_1_other_w5wed_conc_list)
index_1_other_concs$area <- as.factor('other')
index_1_other_concs$scenario <- as.factor('XI_02A1')
index_1_other_concs$water <- as.factor('Dry')
names(index_1_other_concs) <- c('concentration','area','scenario','water')

index_1_w5wed_concs <- rbind(index_1_loading_concs,index_1_cleaning_concs,index_1_sorting_concs,index_1_tray_packing_concs,index_1_reject_concs,index_1_other_concs)

index_1_loading_prev <- as.data.frame(NL_table_Index_1$loading_w5wed_prev[order(NL_table_Index_1$local_seed)])
index_1_loading_prev$area <- as.factor('loading')
index_1_loading_prev$scenario <- as.factor('XI_02A1')
index_1_loading_prev$water <- as.factor('Wet')
names(index_1_loading_prev) <- c('prevalence','area','scenario','water')

index_1_cleaning_prev <- as.data.frame(NL_table_Index_1$cleaning_w5wed_prev[order(NL_table_Index_1$local_seed)])
index_1_cleaning_prev$area <- as.factor('cleaning')
index_1_cleaning_prev$scenario <- as.factor('XI_02A1')
index_1_cleaning_prev$water <- as.factor('Wet')
names(index_1_cleaning_prev) <- c('prevalence','area','scenario','water')

index_1_sorting_prev <- as.data.frame(NL_table_Index_1$sorting_w5wed_prev[order(NL_table_Index_1$local_seed)])
index_1_sorting_prev$area <- as.factor('sorting')
index_1_sorting_prev$scenario <- as.factor('XI_02A1')
index_1_sorting_prev$water <- as.factor('Dry')
names(index_1_sorting_prev) <- c('prevalence','area','scenario','water')

index_1_reject_prev <- as.data.frame(NL_table_Index_1$reject_w5wed_prev[order(NL_table_Index_1$local_seed)])
index_1_reject_prev$area <- as.factor('reject')
index_1_reject_prev$scenario <- as.factor('XI_02A1')
index_1_reject_prev$water <- as.factor('Dry')
names(index_1_reject_prev) <- c('prevalence','area','scenario','water')

index_1_tray_packing_prev <- as.data.frame(NL_table_Index_1$tray_packing_w5wed_prev[order(NL_table_Index_1$local_seed)])
index_1_tray_packing_prev$area <- as.factor('tray packing')
index_1_tray_packing_prev$scenario <- as.factor('XI_02A1')
index_1_tray_packing_prev$water <- as.factor('Dry')
names(index_1_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_1_other_prev <- as.data.frame(NL_table_Index_1$other_w5wed_prev[order(NL_table_Index_1$local_seed)])
index_1_other_prev$area <- as.factor('other')
index_1_other_prev$scenario <- as.factor('XI_02A1')
index_1_other_prev$water <- as.factor('Dry')
names(index_1_other_prev) <- c('prevalence','area','scenario','water')

index_1_w5wed_prev <- rbind(index_1_loading_prev,index_1_cleaning_prev,index_1_sorting_prev,index_1_tray_packing_prev,index_1_reject_prev,index_1_other_prev)

index_1_w5wed_wet_prev <- as.data.frame(index_1_loading_prev$prevalence*21/100+index_1_cleaning_prev$prevalence*28/100)/49*100
index_1_w5wed_wet_prev$scenario <- as.factor('XI_02A1')
index_1_w5wed_wet_prev$water <- as.factor('Wet')
names(index_1_w5wed_wet_prev) <- c('prevalence','scenario','water')

index_1_w5wed_dry_prev <- as.data.frame(index_1_sorting_prev$prevalence*20/100+index_1_reject_prev$prevalence*23/100+index_1_tray_packing_prev$prevalence*123/100+index_1_other_prev$prevalence*10/100)/176*100
index_1_w5wed_dry_prev$scenario <- as.factor('XI_02A1')
index_1_w5wed_dry_prev$water <- as.factor('Dry')
names(index_1_w5wed_dry_prev) <- c('prevalence','scenario','water')

index_1_w5wed_recombined_prev <- rbind(index_1_w5wed_wet_prev, index_1_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Index_1$loading_w6wed_conc_list
vector <- vector[vector!='[]']
index_1_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_loading_w6wed_conc_list <- append(index_1_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_loading_w6wed_conc_matrix <- matrix(unlist(index_1_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_1$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
index_1_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_cleaning_w6wed_conc_list <- append(index_1_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_cleaning_w6wed_conc_matrix <- matrix(unlist(index_1_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_1$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# index_1_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_1_drying_w6wed_conc_list <- append(index_1_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_1$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
index_1_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_sorting_w6wed_conc_list <- append(index_1_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_sorting_w6wed_conc_matrix <- matrix(unlist(index_1_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_1$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
index_1_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_tray_packing_w6wed_conc_list <- append(index_1_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_tray_packing_w6wed_conc_matrix <- matrix(unlist(index_1_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_1$reject_w6wed_conc_list
vector <- vector[vector!='[]']
index_1_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_reject_w6wed_conc_list <- append(index_1_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_reject_w6wed_conc_matrix <- matrix(unlist(index_1_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_1$other_w6wed_conc_list
vector <- vector[vector!='[]']
index_1_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_other_w6wed_conc_list <- append(index_1_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_other_w6wed_conc_matrix <- matrix(unlist(index_1_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

index_1_loading_concs <- as.data.frame(index_1_loading_w6wed_conc_list)
index_1_loading_concs$area <- as.factor('loading')
index_1_loading_concs$scenario <- as.factor('XI_02A1')
index_1_loading_concs$water <- as.factor('Wet')
names(index_1_loading_concs) <- c('concentration','area','scenario','water')

index_1_cleaning_concs <- as.data.frame(index_1_cleaning_w6wed_conc_list)
index_1_cleaning_concs$area <- as.factor('cleaning')
index_1_cleaning_concs$scenario <- as.factor('XI_02A1')
index_1_cleaning_concs$water <- as.factor('Wet')
names(index_1_cleaning_concs) <- c('concentration','area','scenario','water')

index_1_sorting_concs <- as.data.frame(index_1_sorting_w6wed_conc_list)
index_1_sorting_concs$area <- as.factor('sorting')
index_1_sorting_concs$scenario <- as.factor('XI_02A1')
index_1_sorting_concs$water <- as.factor('Dry')
names(index_1_sorting_concs) <- c('concentration','area','scenario','water')

index_1_reject_concs <- as.data.frame(index_1_reject_w6wed_conc_list)
index_1_reject_concs$area <- as.factor('reject')
index_1_reject_concs$scenario <- as.factor('XI_02A1')
index_1_reject_concs$water <- as.factor('Dry')
names(index_1_reject_concs) <- c('concentration','area','scenario','water')

index_1_tray_packing_concs <- as.data.frame(index_1_tray_packing_w6wed_conc_list)
index_1_tray_packing_concs$area <- as.factor('tray packing')
index_1_tray_packing_concs$scenario <- as.factor('XI_02A1')
index_1_tray_packing_concs$water <- as.factor('Dry')
names(index_1_tray_packing_concs) <- c('concentration','area','scenario','water')

index_1_other_concs <- as.data.frame(index_1_other_w6wed_conc_list)
index_1_other_concs$area <- as.factor('other')
index_1_other_concs$scenario <- as.factor('XI_02A1')
index_1_other_concs$water <- as.factor('Dry')
names(index_1_other_concs) <- c('concentration','area','scenario','water')

index_1_w6wed_concs <- rbind(index_1_loading_concs,index_1_cleaning_concs,index_1_sorting_concs,index_1_tray_packing_concs,index_1_reject_concs,index_1_other_concs)

index_1_loading_prev <- as.data.frame(NL_table_Index_1$loading_w6wed_prev[order(NL_table_Index_1$local_seed)])
index_1_loading_prev$area <- as.factor('loading')
index_1_loading_prev$scenario <- as.factor('XI_02A1')
index_1_loading_prev$water <- as.factor('Wet')
names(index_1_loading_prev) <- c('prevalence','area','scenario','water')

index_1_cleaning_prev <- as.data.frame(NL_table_Index_1$cleaning_w6wed_prev[order(NL_table_Index_1$local_seed)])
index_1_cleaning_prev$area <- as.factor('cleaning')
index_1_cleaning_prev$scenario <- as.factor('XI_02A1')
index_1_cleaning_prev$water <- as.factor('Wet')
names(index_1_cleaning_prev) <- c('prevalence','area','scenario','water')

index_1_sorting_prev <- as.data.frame(NL_table_Index_1$sorting_w6wed_prev[order(NL_table_Index_1$local_seed)])
index_1_sorting_prev$area <- as.factor('sorting')
index_1_sorting_prev$scenario <- as.factor('XI_02A1')
index_1_sorting_prev$water <- as.factor('Dry')
names(index_1_sorting_prev) <- c('prevalence','area','scenario','water')

index_1_reject_prev <- as.data.frame(NL_table_Index_1$reject_w6wed_prev[order(NL_table_Index_1$local_seed)])
index_1_reject_prev$area <- as.factor('reject')
index_1_reject_prev$scenario <- as.factor('XI_02A1')
index_1_reject_prev$water <- as.factor('Dry')
names(index_1_reject_prev) <- c('prevalence','area','scenario','water')

index_1_tray_packing_prev <- as.data.frame(NL_table_Index_1$tray_packing_w6wed_prev[order(NL_table_Index_1$local_seed)])
index_1_tray_packing_prev$area <- as.factor('tray packing')
index_1_tray_packing_prev$scenario <- as.factor('XI_02A1')
index_1_tray_packing_prev$water <- as.factor('Dry')
names(index_1_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_1_other_prev <- as.data.frame(NL_table_Index_1$other_w6wed_prev[order(NL_table_Index_1$local_seed)])
index_1_other_prev$area <- as.factor('other')
index_1_other_prev$scenario <- as.factor('XI_02A1')
index_1_other_prev$water <- as.factor('Dry')
names(index_1_other_prev) <- c('prevalence','area','scenario','water')

index_1_w6wed_prev <- rbind(index_1_loading_prev,index_1_cleaning_prev,index_1_sorting_prev,index_1_tray_packing_prev,index_1_reject_prev,index_1_other_prev)

index_1_w6wed_wet_prev <- as.data.frame(index_1_loading_prev$prevalence*21/100+index_1_cleaning_prev$prevalence*28/100)/49*100
index_1_w6wed_wet_prev$scenario <- as.factor('XI_02A1')
index_1_w6wed_wet_prev$water <- as.factor('Wet')
names(index_1_w6wed_wet_prev) <- c('prevalence','scenario','water')

index_1_w6wed_dry_prev <- as.data.frame(index_1_sorting_prev$prevalence*20/100+index_1_reject_prev$prevalence*23/100+index_1_tray_packing_prev$prevalence*123/100+index_1_other_prev$prevalence*10/100)/176*100
index_1_w6wed_dry_prev$scenario <- as.factor('XI_02A1')
index_1_w6wed_dry_prev$water <- as.factor('Dry')
names(index_1_w6wed_dry_prev) <- c('prevalence','scenario','water')

index_1_w6wed_recombined_prev <- rbind(index_1_w6wed_wet_prev, index_1_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Index_1$loading_w7wed_conc_list
vector <- vector[vector!='[]']
index_1_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_loading_w7wed_conc_list <- append(index_1_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_loading_w7wed_conc_matrix <- matrix(unlist(index_1_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_1$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
index_1_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_cleaning_w7wed_conc_list <- append(index_1_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_cleaning_w7wed_conc_matrix <- matrix(unlist(index_1_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_1$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# index_1_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_1_drying_w7wed_conc_list <- append(index_1_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_1$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
index_1_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_sorting_w7wed_conc_list <- append(index_1_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_sorting_w7wed_conc_matrix <- matrix(unlist(index_1_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_1$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
index_1_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_tray_packing_w7wed_conc_list <- append(index_1_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_tray_packing_w7wed_conc_matrix <- matrix(unlist(index_1_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_1$reject_w7wed_conc_list
vector <- vector[vector!='[]']
index_1_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_reject_w7wed_conc_list <- append(index_1_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_reject_w7wed_conc_matrix <- matrix(unlist(index_1_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_1$other_w7wed_conc_list
vector <- vector[vector!='[]']
index_1_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_other_w7wed_conc_list <- append(index_1_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_other_w7wed_conc_matrix <- matrix(unlist(index_1_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

index_1_loading_concs <- as.data.frame(index_1_loading_w7wed_conc_list)
index_1_loading_concs$area <- as.factor('loading')
index_1_loading_concs$scenario <- as.factor('XI_02A1')
index_1_loading_concs$water <- as.factor('Wet')
names(index_1_loading_concs) <- c('concentration','area','scenario','water')

index_1_cleaning_concs <- as.data.frame(index_1_cleaning_w7wed_conc_list)
index_1_cleaning_concs$area <- as.factor('cleaning')
index_1_cleaning_concs$scenario <- as.factor('XI_02A1')
index_1_cleaning_concs$water <- as.factor('Wet')
names(index_1_cleaning_concs) <- c('concentration','area','scenario','water')

index_1_sorting_concs <- as.data.frame(index_1_sorting_w7wed_conc_list)
index_1_sorting_concs$area <- as.factor('sorting')
index_1_sorting_concs$scenario <- as.factor('XI_02A1')
index_1_sorting_concs$water <- as.factor('Dry')
names(index_1_sorting_concs) <- c('concentration','area','scenario','water')

index_1_reject_concs <- as.data.frame(index_1_reject_w7wed_conc_list)
index_1_reject_concs$area <- as.factor('reject')
index_1_reject_concs$scenario <- as.factor('XI_02A1')
index_1_reject_concs$water <- as.factor('Dry')
names(index_1_reject_concs) <- c('concentration','area','scenario','water')

index_1_tray_packing_concs <- as.data.frame(index_1_tray_packing_w7wed_conc_list)
index_1_tray_packing_concs$area <- as.factor('tray packing')
index_1_tray_packing_concs$scenario <- as.factor('XI_02A1')
index_1_tray_packing_concs$water <- as.factor('Dry')
names(index_1_tray_packing_concs) <- c('concentration','area','scenario','water')

index_1_other_concs <- as.data.frame(index_1_other_w7wed_conc_list)
index_1_other_concs$area <- as.factor('other')
index_1_other_concs$scenario <- as.factor('XI_02A1')
index_1_other_concs$water <- as.factor('Dry')
names(index_1_other_concs) <- c('concentration','area','scenario','water')

index_1_w7wed_concs <- rbind(index_1_loading_concs,index_1_cleaning_concs,index_1_sorting_concs,index_1_tray_packing_concs,index_1_reject_concs,index_1_other_concs)

index_1_loading_prev <- as.data.frame(NL_table_Index_1$loading_w7wed_prev[order(NL_table_Index_1$local_seed)])
index_1_loading_prev$area <- as.factor('loading')
index_1_loading_prev$scenario <- as.factor('XI_02A1')
index_1_loading_prev$water <- as.factor('Wet')
names(index_1_loading_prev) <- c('prevalence','area','scenario','water')

index_1_cleaning_prev <- as.data.frame(NL_table_Index_1$cleaning_w7wed_prev[order(NL_table_Index_1$local_seed)])
index_1_cleaning_prev$area <- as.factor('cleaning')
index_1_cleaning_prev$scenario <- as.factor('XI_02A1')
index_1_cleaning_prev$water <- as.factor('Wet')
names(index_1_cleaning_prev) <- c('prevalence','area','scenario','water')

index_1_sorting_prev <- as.data.frame(NL_table_Index_1$sorting_w7wed_prev[order(NL_table_Index_1$local_seed)])
index_1_sorting_prev$area <- as.factor('sorting')
index_1_sorting_prev$scenario <- as.factor('XI_02A1')
index_1_sorting_prev$water <- as.factor('Dry')
names(index_1_sorting_prev) <- c('prevalence','area','scenario','water')

index_1_reject_prev <- as.data.frame(NL_table_Index_1$reject_w7wed_prev[order(NL_table_Index_1$local_seed)])
index_1_reject_prev$area <- as.factor('reject')
index_1_reject_prev$scenario <- as.factor('XI_02A1')
index_1_reject_prev$water <- as.factor('Dry')
names(index_1_reject_prev) <- c('prevalence','area','scenario','water')

index_1_tray_packing_prev <- as.data.frame(NL_table_Index_1$tray_packing_w7wed_prev[order(NL_table_Index_1$local_seed)])
index_1_tray_packing_prev$area <- as.factor('tray packing')
index_1_tray_packing_prev$scenario <- as.factor('XI_02A1')
index_1_tray_packing_prev$water <- as.factor('Dry')
names(index_1_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_1_other_prev <- as.data.frame(NL_table_Index_1$other_w7wed_prev[order(NL_table_Index_1$local_seed)])
index_1_other_prev$area <- as.factor('other')
index_1_other_prev$scenario <- as.factor('XI_02A1')
index_1_other_prev$water <- as.factor('Dry')
names(index_1_other_prev) <- c('prevalence','area','scenario','water')

index_1_w7wed_prev <- rbind(index_1_loading_prev,index_1_cleaning_prev,index_1_sorting_prev,index_1_tray_packing_prev,index_1_reject_prev,index_1_other_prev)

index_1_w7wed_wet_prev <- as.data.frame(index_1_loading_prev$prevalence*21/100+index_1_cleaning_prev$prevalence*28/100)/49*100
index_1_w7wed_wet_prev$scenario <- as.factor('XI_02A1')
index_1_w7wed_wet_prev$water <- as.factor('Wet')
names(index_1_w7wed_wet_prev) <- c('prevalence','scenario','water')

index_1_w7wed_dry_prev <- as.data.frame(index_1_sorting_prev$prevalence*20/100+index_1_reject_prev$prevalence*23/100+index_1_tray_packing_prev$prevalence*123/100+index_1_other_prev$prevalence*10/100)/176*100
index_1_w7wed_dry_prev$scenario <- as.factor('XI_02A1')
index_1_w7wed_dry_prev$water <- as.factor('Dry')
names(index_1_w7wed_dry_prev) <- c('prevalence','scenario','water')

index_1_w7wed_recombined_prev <- rbind(index_1_w7wed_wet_prev, index_1_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Index_1$loading_w8wed_conc_list
vector <- vector[vector!='[]']
index_1_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_loading_w8wed_conc_list <- append(index_1_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_loading_w8wed_conc_matrix <- matrix(unlist(index_1_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_1$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
index_1_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_cleaning_w8wed_conc_list <- append(index_1_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_cleaning_w8wed_conc_matrix <- matrix(unlist(index_1_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_1$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# index_1_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_1_drying_w8wed_conc_list <- append(index_1_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_1$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
index_1_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_sorting_w8wed_conc_list <- append(index_1_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_sorting_w8wed_conc_matrix <- matrix(unlist(index_1_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_1$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
index_1_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_tray_packing_w8wed_conc_list <- append(index_1_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_tray_packing_w8wed_conc_matrix <- matrix(unlist(index_1_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_1$reject_w8wed_conc_list
vector <- vector[vector!='[]']
index_1_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_reject_w8wed_conc_list <- append(index_1_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_reject_w8wed_conc_matrix <- matrix(unlist(index_1_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_1$other_w8wed_conc_list
vector <- vector[vector!='[]']
index_1_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_1_other_w8wed_conc_list <- append(index_1_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_1_other_w8wed_conc_matrix <- matrix(unlist(index_1_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

index_1_loading_concs <- as.data.frame(index_1_loading_w8wed_conc_list)
index_1_loading_concs$area <- as.factor('loading')
index_1_loading_concs$scenario <- as.factor('XI_02A1')
index_1_loading_concs$water <- as.factor('Wet')
names(index_1_loading_concs) <- c('concentration','area','scenario','water')

index_1_cleaning_concs <- as.data.frame(index_1_cleaning_w8wed_conc_list)
index_1_cleaning_concs$area <- as.factor('cleaning')
index_1_cleaning_concs$scenario <- as.factor('XI_02A1')
index_1_cleaning_concs$water <- as.factor('Wet')
names(index_1_cleaning_concs) <- c('concentration','area','scenario','water')

index_1_sorting_concs <- as.data.frame(index_1_sorting_w8wed_conc_list)
index_1_sorting_concs$area <- as.factor('sorting')
index_1_sorting_concs$scenario <- as.factor('XI_02A1')
index_1_sorting_concs$water <- as.factor('Dry')
names(index_1_sorting_concs) <- c('concentration','area','scenario','water')

index_1_reject_concs <- as.data.frame(index_1_reject_w8wed_conc_list)
index_1_reject_concs$area <- as.factor('reject')
index_1_reject_concs$scenario <- as.factor('XI_02A1')
index_1_reject_concs$water <- as.factor('Dry')
names(index_1_reject_concs) <- c('concentration','area','scenario','water')

index_1_tray_packing_concs <- as.data.frame(index_1_tray_packing_w8wed_conc_list)
index_1_tray_packing_concs$area <- as.factor('tray packing')
index_1_tray_packing_concs$scenario <- as.factor('XI_02A1')
index_1_tray_packing_concs$water <- as.factor('Dry')
names(index_1_tray_packing_concs) <- c('concentration','area','scenario','water')

index_1_other_concs <- as.data.frame(index_1_other_w8wed_conc_list)
index_1_other_concs$area <- as.factor('other')
index_1_other_concs$scenario <- as.factor('XI_02A1')
index_1_other_concs$water <- as.factor('Dry')
names(index_1_other_concs) <- c('concentration','area','scenario','water')

index_1_w8wed_concs <- rbind(index_1_loading_concs,index_1_cleaning_concs,index_1_sorting_concs,index_1_tray_packing_concs,index_1_reject_concs,index_1_other_concs)

index_1_loading_prev <- as.data.frame(NL_table_Index_1$loading_w8wed_prev[order(NL_table_Index_1$local_seed)])
index_1_loading_prev$area <- as.factor('loading')
index_1_loading_prev$scenario <- as.factor('XI_02A1')
index_1_loading_prev$water <- as.factor('Wet')
names(index_1_loading_prev) <- c('prevalence','area','scenario','water')

index_1_cleaning_prev <- as.data.frame(NL_table_Index_1$cleaning_w8wed_prev[order(NL_table_Index_1$local_seed)])
index_1_cleaning_prev$area <- as.factor('cleaning')
index_1_cleaning_prev$scenario <- as.factor('XI_02A1')
index_1_cleaning_prev$water <- as.factor('Wet')
names(index_1_cleaning_prev) <- c('prevalence','area','scenario','water')

index_1_sorting_prev <- as.data.frame(NL_table_Index_1$sorting_w8wed_prev[order(NL_table_Index_1$local_seed)])
index_1_sorting_prev$area <- as.factor('sorting')
index_1_sorting_prev$scenario <- as.factor('XI_02A1')
index_1_sorting_prev$water <- as.factor('Dry')
names(index_1_sorting_prev) <- c('prevalence','area','scenario','water')

index_1_reject_prev <- as.data.frame(NL_table_Index_1$reject_w8wed_prev[order(NL_table_Index_1$local_seed)])
index_1_reject_prev$area <- as.factor('reject')
index_1_reject_prev$scenario <- as.factor('XI_02A1')
index_1_reject_prev$water <- as.factor('Dry')
names(index_1_reject_prev) <- c('prevalence','area','scenario','water')

index_1_tray_packing_prev <- as.data.frame(NL_table_Index_1$tray_packing_w8wed_prev[order(NL_table_Index_1$local_seed)])
index_1_tray_packing_prev$area <- as.factor('tray packing')
index_1_tray_packing_prev$scenario <- as.factor('XI_02A1')
index_1_tray_packing_prev$water <- as.factor('Dry')
names(index_1_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_1_other_prev <- as.data.frame(NL_table_Index_1$other_w8wed_prev[order(NL_table_Index_1$local_seed)])
index_1_other_prev$area <- as.factor('other')
index_1_other_prev$scenario <- as.factor('XI_02A1')
index_1_other_prev$water <- as.factor('Dry')
names(index_1_other_prev) <- c('prevalence','area','scenario','water')

index_1_w8wed_prev <- rbind(index_1_loading_prev,index_1_cleaning_prev,index_1_sorting_prev,index_1_tray_packing_prev,index_1_reject_prev,index_1_other_prev)

index_1_w8wed_wet_prev <- as.data.frame(index_1_loading_prev$prevalence*21/100+index_1_cleaning_prev$prevalence*28/100)/49*100
index_1_w8wed_wet_prev$scenario <- as.factor('XI_02A1')
index_1_w8wed_wet_prev$water <- as.factor('Wet')
names(index_1_w8wed_wet_prev) <- c('prevalence','scenario','water')

index_1_w8wed_dry_prev <- as.data.frame(index_1_sorting_prev$prevalence*20/100+index_1_reject_prev$prevalence*23/100+index_1_tray_packing_prev$prevalence*123/100+index_1_other_prev$prevalence*10/100)/176*100
index_1_w8wed_dry_prev$scenario <- as.factor('XI_02A1')
index_1_w8wed_dry_prev$water <- as.factor('Dry')
names(index_1_w8wed_dry_prev) <- c('prevalence','scenario','water')

index_1_w8wed_recombined_prev <- rbind(index_1_w8wed_wet_prev, index_1_w8wed_dry_prev)

index_1_w1wed_prev$week <- as.factor(1)
index_1_w2wed_prev$week <- as.factor(2)
index_1_w3wed_prev$week <- as.factor(3)
index_1_w4wed_prev$week <- as.factor(4)
index_1_w5wed_prev$week <- as.factor(5)
index_1_w6wed_prev$week <- as.factor(6)
index_1_w7wed_prev$week <- as.factor(7)
index_1_w8wed_prev$week <- as.factor(8)

index_1_w1wed_recombined_prev$week <- as.factor(1)
index_1_w2wed_recombined_prev$week <- as.factor(2)
index_1_w3wed_recombined_prev$week <- as.factor(3)
index_1_w4wed_recombined_prev$week <- as.factor(4)
index_1_w5wed_recombined_prev$week <- as.factor(5)
index_1_w6wed_recombined_prev$week <- as.factor(6)
index_1_w7wed_recombined_prev$week <- as.factor(7)
index_1_w8wed_recombined_prev$week <- as.factor(8)
index_1_allwed_prev <- rbind(index_1_w1wed_recombined_prev,index_1_w2wed_recombined_prev,index_1_w3wed_recombined_prev,index_1_w4wed_recombined_prev,index_1_w5wed_recombined_prev,index_1_w6wed_recombined_prev,index_1_w7wed_recombined_prev,index_1_w8wed_recombined_prev)

vector <- NL_table_Index_1$lifetime_conc_list[order(NL_table_Index_1$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

index_1_w1wed_recombined_prev$week <- as.factor(1)
index_1_w2wed_recombined_prev$week <- as.factor(2)
index_1_w3wed_recombined_prev$week <- as.factor(3)
index_1_w4wed_recombined_prev$week <- as.factor(4)
index_1_w5wed_recombined_prev$week <- as.factor(5)
index_1_w6wed_recombined_prev$week <- as.factor(6)
index_1_w7wed_recombined_prev$week <- as.factor(7)
index_1_w8wed_recombined_prev$week <- as.factor(8)
index_1_allwed_prev <- rbind(index_1_w1wed_recombined_prev,index_1_w2wed_recombined_prev,index_1_w3wed_recombined_prev,index_1_w4wed_recombined_prev,index_1_w5wed_recombined_prev,index_1_w6wed_recombined_prev,index_1_w7wed_recombined_prev,index_1_w8wed_recombined_prev)

Facility_B_index_1_agents_melted <- melt(mdarray)
colnames(Facility_B_index_1_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_index_1_agents_melted$agent <- Facility_B_index_1_agents_melted$agent-1
Facility_B_index_1_agents_melted$logical <- Facility_B_index_1_agents_melted$value>0
Facility_B_index_1_agents_melted$binary <- as.numeric(Facility_B_index_1_agents_melted$logical)
Facility_B_index_1_agents_melted$log10value <- log10(Facility_B_index_1_agents_melted$value)
Facility_B_index_1_agents_melted$log10value[is.infinite(Facility_B_index_1_agents_melted$log10value)] <- 0

agent <- Facility_B_index_1_agents_melted$agent
iteration <- Facility_B_index_1_agents_melted$iteration
tick <- Facility_B_index_1_agents_melted$tick
rle_matrix <- tapply(Facility_B_index_1_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_partial_prob_intervention_mean_value_matrix <- tapply(Facility_B_index_1_agents_melted$value, list(agent, tick), mean)
Facility_B_index_1_median_value_matrix <- tapply(Facility_B_index_1_agents_melted$value, list(agent, tick), median)
x <- Facility_B_index_1_agents_melted
x$value[x$value==0] <- NA
Facility_B_index_1_pos_median_value_matrix <- tapply(x$value, list(agent, tick), median, na.rm=TRUE)
Facility_B_index_1_prob_value_matrix <- tapply(Facility_B_index_1_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

#Maximum sensitivity####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_index_1 <- durations

agents_list_index_1 <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_index_1 <- agents_list_index_1[,c("V1","V7","V8","V9")]
colnames(agents_list_index_1) <- c("name","sanitation_status","schedule","area")
#Time to persistence
agents_list_index_1$time_to_persistence <- rep((168*2),225)
agents_list_index_1$time_to_persistence[agents_list_index_1$schedule=="daily"] <- (24*2)

persistent_short_durations_list_index_1 <- data.frame()
persistent_long_durations_list_index_1 <- data.frame()
persistent_uncleanable_durations_list_index_1 <- data.frame()
transient_short_durations_list_index_1 <- data.frame()
transient_long_durations_list_index_1 <- data.frame()
transient_uncleanable_durations_list_index_1 <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_index_1$min_duration[agent] <- ifelse(length(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent])==0,NA,min(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_index_1$mean_duration[agent] <- ifelse(length(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent])==0,NA,mean(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_index_1$median_duration[agent] <- ifelse(length(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent])==0,NA,median(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_index_1$max_duration[agent] <- ifelse(length(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent])==0,NA,max(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_index_1$contamination_events[agent] <- sum(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_index_1$times_persistent[agent] <- sum(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent]>agents_list_index_1$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_index_1$q1_duration[agent] <- quantile(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_index_1$q3_duration[agent] <- quantile(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_index_1$min_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent])==0) || (agents_list_index_1$times_persistent[agent]==0),NA,min(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent & Facility_B_durations_index_1$duration>=agents_list_index_1$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_index_1$mean_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent])==0) || (agents_list_index_1$times_persistent[agent]==0),NA,mean(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent & Facility_B_durations_index_1$duration>=agents_list_index_1$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_index_1$median_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent])==0) || (agents_list_index_1$times_persistent[agent]==0),NA,median(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent & Facility_B_durations_index_1$duration>=agents_list_index_1$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_index_1$max_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent])==0) || (agents_list_index_1$times_persistent[agent]==0),NA,max(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent & Facility_B_durations_index_1$duration>=agents_list_index_1$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_index_1$q1_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent])==0) || (agents_list_index_1$times_persistent[agent]==0),NA,quantile(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent & Facility_B_durations_index_1$duration>=agents_list_index_1$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_index_1$q3_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent])==0) || (agents_list_index_1$times_persistent[agent]==0),NA,quantile(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent & Facility_B_durations_index_1$duration>=agents_list_index_1$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations
  x <- Facility_B_durations_index_1[which(Facility_B_durations_index_1$agent==agent & Facility_B_durations_index_1$duration>agents_list_index_1$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean
  agents_list_index_1$mean_times_persistent[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_index_1$mean_times_persistent[which(is.na(agents_list_index_1$mean_times_persistent))] <- 0
  #Division by total number of iterations in simulation
  agents_list_index_1$balanced_times_persistent[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_index_1$duration[Facility_B_durations_index_1$agent==agent])!=0) || (agents_list_index_1$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_index_1$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_index_1 <- rbind(
        persistent_short_durations_list_index_1,
        Facility_B_durations_index_1[Facility_B_durations_index_1$agent==agent & Facility_B_durations_index_1$duration>agents_list_index_1$time_to_persistence[agent],]
      )
    } else if(agents_list_index_1$time_to_persistence[agent]==336 && agents_list_index_1$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_index_1 <- rbind(
        persistent_long_durations_list_index_1,
        Facility_B_durations_index_1[Facility_B_durations_index_1$agent==agent & Facility_B_durations_index_1$duration>agents_list_index_1$time_to_persistence[agent],]
      )
    } else if(agents_list_index_1$time_to_persistence[agent]==336 && agents_list_index_1$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_index_1 <- rbind(
        persistent_uncleanable_durations_list_index_1,
        Facility_B_durations_index_1[Facility_B_durations_index_1$agent==agent & Facility_B_durations_index_1$duration>agents_list_index_1$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_index_1$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_index_1 <- rbind(
      transient_short_durations_list_index_1,
      Facility_B_durations_index_1[Facility_B_durations_index_1$agent==agent & Facility_B_durations_index_1$duration<=agents_list_index_1$time_to_persistence[agent],]
    )
  } else if(agents_list_index_1$time_to_persistence[agent]==336 && agents_list_index_1$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_index_1 <- rbind(
      transient_long_durations_list_index_1,
      Facility_B_durations_index_1[Facility_B_durations_index_1$agent==agent & Facility_B_durations_index_1$duration<=agents_list_index_1$time_to_persistence[agent],]
    )
  } else if(agents_list_index_1$time_to_persistence[agent]==336 && agents_list_index_1$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_index_1 <- rbind(
      transient_uncleanable_durations_list_index_1,
      Facility_B_durations_index_1[Facility_B_durations_index_1$agent==agent & Facility_B_durations_index_1$duration<=agents_list_index_1$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

#10 cells minimum####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>9)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_index_1_10min <- durations

persistent_short_durations_list_index_1_10min <- data.frame()
persistent_long_durations_list_index_1_10min <- data.frame()
persistent_uncleanable_durations_list_index_1_10min <- data.frame()
transient_short_durations_list_index_1_10min <- data.frame()
transient_long_durations_list_index_1_10min <- data.frame()
transient_uncleanable_durations_list_index_1_10min <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_index_1$min_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent])==0,NA,min(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_index_1$mean_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent])==0,NA,mean(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_index_1$median_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent])==0,NA,median(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_index_1$max_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent])==0,NA,max(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_index_1$contamination_events_10min[agent] <- sum(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_index_1$times_persistent_10min[agent] <- sum(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent]>agents_list_index_1$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_index_1$q1_duration_10min[agent] <- quantile(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_index_1$q3_duration_10min[agent] <- quantile(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_index_1$min_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent])==0) || (agents_list_index_1$times_persistent_10min[agent]==0),NA,min(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent & Facility_B_durations_index_1_10min$duration>=agents_list_index_1$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_index_1$mean_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent])==0) || (agents_list_index_1$times_persistent_10min[agent]==0),NA,mean(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent & Facility_B_durations_index_1_10min$duration>=agents_list_index_1$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_index_1$median_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent])==0) || (agents_list_index_1$times_persistent_10min[agent]==0),NA,median(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent & Facility_B_durations_index_1_10min$duration>=agents_list_index_1$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_index_1$max_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent])==0) || (agents_list_index_1$times_persistent_10min[agent]==0),NA,max(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent & Facility_B_durations_index_1_10min$duration>=agents_list_index_1$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_index_1$q1_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent])==0) || (agents_list_index_1$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent & Facility_B_durations_index_1_10min$duration>=agents_list_index_1$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_index_1$q3_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent])==0) || (agents_list_index_1$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent & Facility_B_durations_index_1_10min$duration>=agents_list_index_1$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations (Does not account for iterations with 0 events)
  x <- Facility_B_durations_index_1_10min[which(Facility_B_durations_index_1_10min$agent==agent & Facility_B_durations_index_1_10min$duration>agents_list_index_1$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean (Does account for iterations with 0 events)
  agents_list_index_1$mean_times_persistent_10min[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_index_1$mean_times_persistent_10min[which(is.na(agents_list_index_1$mean_times_persistent_10min))] <- 0
  #Division by total number of iterations in simulation
  agents_list_index_1$balanced_times_persistent_10min[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_index_1_10min$duration[Facility_B_durations_index_1_10min$agent==agent])!=0) || (agents_list_index_1$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_index_1$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_index_1_10min <- rbind(
        persistent_short_durations_list_index_1_10min,
        Facility_B_durations_index_1_10min[Facility_B_durations_index_1_10min$agent==agent & Facility_B_durations_index_1_10min$duration>agents_list_index_1$time_to_persistence[agent],]
      )
    } else if(agents_list_index_1$time_to_persistence[agent]==336 && agents_list_index_1$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_index_1_10min <- rbind(
        persistent_long_durations_list_index_1_10min,
        Facility_B_durations_index_1_10min[Facility_B_durations_index_1_10min$agent==agent & Facility_B_durations_index_1_10min$duration>agents_list_index_1$time_to_persistence[agent],]
      )
    } else if(agents_list_index_1$time_to_persistence[agent]==336 && agents_list_index_1$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_index_1_10min <- rbind(
        persistent_uncleanable_durations_list_index_1_10min,
        Facility_B_durations_index_1_10min[Facility_B_durations_index_1_10min$agent==agent & Facility_B_durations_index_1_10min$duration>agents_list_index_1$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_index_1$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_index_1_10min <- rbind(
      transient_short_durations_list_index_1_10min,
      Facility_B_durations_index_1_10min[Facility_B_durations_index_1_10min$agent==agent & Facility_B_durations_index_1_10min$duration<=agents_list_index_1$time_to_persistence[agent],]
    )
  } else if(agents_list_index_1$time_to_persistence[agent]==336 && agents_list_index_1$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_index_1_10min <- rbind(
      transient_long_durations_list_index_1_10min,
      Facility_B_durations_index_1_10min[Facility_B_durations_index_1_10min$agent==agent & Facility_B_durations_index_1_10min$duration<=agents_list_index_1$time_to_persistence[agent],]
    )
  } else if(agents_list_index_1$time_to_persistence[agent]==336 && agents_list_index_1$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_index_1_10min <- rbind(
      transient_uncleanable_durations_list_index_1_10min,
      Facility_B_durations_index_1_10min[Facility_B_durations_index_1_10min$agent==agent & Facility_B_durations_index_1_10min$duration<=agents_list_index_1$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

# Facility_B_index_1_agents_melted_monday_preop <- Facility_B_index_1_agents_melted[which(Facility_B_index_1_agents_melted$tick==33|Facility_B_index_1_agents_melted$tick==201|Facility_B_index_1_agents_melted$tick==369|Facility_B_index_1_agents_melted$tick==537|Facility_B_index_1_agents_melted$tick==705|Facility_B_index_1_agents_melted$tick==873|Facility_B_index_1_agents_melted$tick==1041|Facility_B_index_1_agents_melted$tick==1209),]
# 
# Facility_B_index_1_agents_melted_tuesday_preop <- Facility_B_index_1_agents_melted[which(Facility_B_index_1_agents_melted$tick==57|Facility_B_index_1_agents_melted$tick==225|Facility_B_index_1_agents_melted$tick==393|Facility_B_index_1_agents_melted$tick==561|Facility_B_index_1_agents_melted$tick==729|Facility_B_index_1_agents_melted$tick==897|Facility_B_index_1_agents_melted$tick==1065|Facility_B_index_1_agents_melted$tick==1233),]
# 
# Facility_B_index_1_agents_melted_wednesday_preop <- Facility_B_index_1_agents_melted[which(Facility_B_index_1_agents_melted$tick==81|Facility_B_index_1_agents_melted$tick==249|Facility_B_index_1_agents_melted$tick==417|Facility_B_index_1_agents_melted$tick==585|Facility_B_index_1_agents_melted$tick==753|Facility_B_index_1_agents_melted$tick==921|Facility_B_index_1_agents_melted$tick==1089|Facility_B_index_1_agents_melted$tick==1257),]
# 
# Facility_B_index_1_agents_melted_thursday_preop <- Facility_B_index_1_agents_melted[which(Facility_B_index_1_agents_melted$tick==105|Facility_B_index_1_agents_melted$tick==273|Facility_B_index_1_agents_melted$tick==441|Facility_B_index_1_agents_melted$tick==609|Facility_B_index_1_agents_melted$tick==777|Facility_B_index_1_agents_melted$tick==945|Facility_B_index_1_agents_melted$tick==1113|Facility_B_index_1_agents_melted$tick==1281),]
# 
# Facility_B_index_1_agents_melted_friday_preop <- Facility_B_index_1_agents_melted[which(Facility_B_index_1_agents_melted$tick==129|Facility_B_index_1_agents_melted$tick==297|Facility_B_index_1_agents_melted$tick==465|Facility_B_index_1_agents_melted$tick==633|Facility_B_index_1_agents_melted$tick==801|Facility_B_index_1_agents_melted$tick==969|Facility_B_index_1_agents_melted$tick==1137|Facility_B_index_1_agents_melted$tick==1305),]

Facility_B_index_1_agents_melted_ff <- as.ffdf(Facility_B_index_1_agents_melted)
rm(Facility_B_index_1_agents_melted)
gc()
```

```{r import Index Case 2}
NL_table_Index_2 <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-25-11-09 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Pre_Contamination-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Index_2 <- NL_table_Index_2[NL_table_Index_2$scenario==52,]

while (any(grepl('-', names(NL_table_Index_2), fixed = TRUE))) {
  NL_table_Index_2 <- NL_table_Index_2 %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Index_2), fixed = TRUE))) {
  NL_table_Index_2 <- NL_table_Index_2 %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Index_2), fixed = TRUE))) {
  NL_table_Index_2 <- NL_table_Index_2 %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Index_2), fixed = TRUE))) {
  NL_table_Index_2 <- NL_table_Index_2 %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Index_2[ , ..list_columns]

NL_table_Index_2[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Index_2 <- as.data.frame(NL_table_Index_2)

NL_table_Index_2[NL_table_Index_2==-1] <- NA

NL_table_Index_2 <- subset(NL_table_Index_2, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Index_2)[names(NL_table_Index_2)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Index_2)[names(NL_table_Index_2)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Index_2$loading_w1wed_conc_list
vector <- vector[vector!='[]']
index_2_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_loading_w1wed_conc_list <- append(index_2_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_loading_w1wed_conc_matrix <- matrix(unlist(index_2_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_2$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
index_2_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_cleaning_w1wed_conc_list <- append(index_2_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_cleaning_w1wed_conc_matrix <- matrix(unlist(index_2_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_2$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# index_2_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_2_drying_w1wed_conc_list <- append(index_2_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_2$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
index_2_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_sorting_w1wed_conc_list <- append(index_2_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_sorting_w1wed_conc_matrix <- matrix(unlist(index_2_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_2$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
index_2_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_tray_packing_w1wed_conc_list <- append(index_2_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_tray_packing_w1wed_conc_matrix <- matrix(unlist(index_2_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_2$reject_w1wed_conc_list
vector <- vector[vector!='[]']
index_2_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_reject_w1wed_conc_list <- append(index_2_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_reject_w1wed_conc_matrix <- matrix(unlist(index_2_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_2$other_w1wed_conc_list
vector <- vector[vector!='[]']
index_2_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_other_w1wed_conc_list <- append(index_2_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_other_w1wed_conc_matrix <- matrix(unlist(index_2_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

index_2_loading_concs <- as.data.frame(index_2_loading_w1wed_conc_list)
index_2_loading_concs$area <- as.factor('loading')
index_2_loading_concs$scenario <- as.factor('XI_02A2')
index_2_loading_concs$water <- as.factor('Wet')
names(index_2_loading_concs) <- c('concentration','area','scenario','water')

index_2_cleaning_concs <- as.data.frame(index_2_cleaning_w1wed_conc_list)
index_2_cleaning_concs$area <- as.factor('cleaning')
index_2_cleaning_concs$scenario <- as.factor('XI_02A2')
index_2_cleaning_concs$water <- as.factor('Wet')
names(index_2_cleaning_concs) <- c('concentration','area','scenario','water')

index_2_sorting_concs <- as.data.frame(index_2_sorting_w1wed_conc_list)
index_2_sorting_concs$area <- as.factor('sorting')
index_2_sorting_concs$scenario <- as.factor('XI_02A2')
index_2_sorting_concs$water <- as.factor('Dry')
names(index_2_sorting_concs) <- c('concentration','area','scenario','water')

index_2_reject_concs <- as.data.frame(index_2_reject_w1wed_conc_list)
index_2_reject_concs$area <- as.factor('reject')
index_2_reject_concs$scenario <- as.factor('XI_02A2')
index_2_reject_concs$water <- as.factor('Dry')
names(index_2_reject_concs) <- c('concentration','area','scenario','water')

index_2_tray_packing_concs <- as.data.frame(index_2_tray_packing_w1wed_conc_list)
index_2_tray_packing_concs$area <- as.factor('tray packing')
index_2_tray_packing_concs$scenario <- as.factor('XI_02A2')
index_2_tray_packing_concs$water <- as.factor('Dry')
names(index_2_tray_packing_concs) <- c('concentration','area','scenario','water')

index_2_other_concs <- as.data.frame(index_2_other_w1wed_conc_list)
index_2_other_concs$area <- as.factor('other')
index_2_other_concs$scenario <- as.factor('XI_02A2')
index_2_other_concs$water <- as.factor('Dry')
names(index_2_other_concs) <- c('concentration','area','scenario','water')

index_2_w1wed_concs <- rbind(index_2_loading_concs,index_2_cleaning_concs,index_2_sorting_concs,index_2_tray_packing_concs,index_2_reject_concs,index_2_other_concs)

index_2_loading_prev <- as.data.frame(NL_table_Index_2$loading_w1wed_prev[order(NL_table_Index_2$local_seed)])
index_2_loading_prev$area <- as.factor('loading')
index_2_loading_prev$scenario <- as.factor('XI_02A2')
index_2_loading_prev$water <- as.factor('Wet')
names(index_2_loading_prev) <- c('prevalence','area','scenario','water')

index_2_cleaning_prev <- as.data.frame(NL_table_Index_2$cleaning_w1wed_prev[order(NL_table_Index_2$local_seed)])
index_2_cleaning_prev$area <- as.factor('cleaning')
index_2_cleaning_prev$scenario <- as.factor('XI_02A2')
index_2_cleaning_prev$water <- as.factor('Wet')
names(index_2_cleaning_prev) <- c('prevalence','area','scenario','water')

index_2_sorting_prev <- as.data.frame(NL_table_Index_2$sorting_w1wed_prev[order(NL_table_Index_2$local_seed)])
index_2_sorting_prev$area <- as.factor('sorting')
index_2_sorting_prev$scenario <- as.factor('XI_02A2')
index_2_sorting_prev$water <- as.factor('Dry')
names(index_2_sorting_prev) <- c('prevalence','area','scenario','water')

index_2_reject_prev <- as.data.frame(NL_table_Index_2$reject_w1wed_prev[order(NL_table_Index_2$local_seed)])
index_2_reject_prev$area <- as.factor('reject')
index_2_reject_prev$scenario <- as.factor('XI_02A2')
index_2_reject_prev$water <- as.factor('Dry')
names(index_2_reject_prev) <- c('prevalence','area','scenario','water')

index_2_tray_packing_prev <- as.data.frame(NL_table_Index_2$tray_packing_w1wed_prev[order(NL_table_Index_2$local_seed)])
index_2_tray_packing_prev$area <- as.factor('tray packing')
index_2_tray_packing_prev$scenario <- as.factor('XI_02A2')
index_2_tray_packing_prev$water <- as.factor('Dry')
names(index_2_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_2_other_prev <- as.data.frame(NL_table_Index_2$other_w1wed_prev[order(NL_table_Index_2$local_seed)])
index_2_other_prev$area <- as.factor('other')
index_2_other_prev$scenario <- as.factor('XI_02A2')
index_2_other_prev$water <- as.factor('Dry')
names(index_2_other_prev) <- c('prevalence','area','scenario','water')

index_2_w1wed_prev <- rbind(index_2_loading_prev,index_2_cleaning_prev,index_2_sorting_prev,index_2_tray_packing_prev,index_2_reject_prev,index_2_other_prev)

index_2_w1wed_wet_prev <- as.data.frame(index_2_loading_prev$prevalence*21/100+index_2_cleaning_prev$prevalence*28/100)/49*100
index_2_w1wed_wet_prev$scenario <- as.factor('XI_02A2')
index_2_w1wed_wet_prev$water <- as.factor('Wet')
names(index_2_w1wed_wet_prev) <- c('prevalence','scenario','water')

index_2_w1wed_dry_prev <- as.data.frame(index_2_sorting_prev$prevalence*20/100+index_2_reject_prev$prevalence*23/100+index_2_tray_packing_prev$prevalence*123/100+index_2_other_prev$prevalence*10/100)/176*100
index_2_w1wed_dry_prev$scenario <- as.factor('XI_02A2')
index_2_w1wed_dry_prev$water <- as.factor('Dry')
names(index_2_w1wed_dry_prev) <- c('prevalence','scenario','water')

index_2_w1wed_recombined_prev <- rbind(index_2_w1wed_wet_prev, index_2_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Index_2$loading_w2wed_conc_list
vector <- vector[vector!='[]']
index_2_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_loading_w2wed_conc_list <- append(index_2_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_loading_w2wed_conc_matrix <- matrix(unlist(index_2_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_2$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
index_2_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_cleaning_w2wed_conc_list <- append(index_2_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_cleaning_w2wed_conc_matrix <- matrix(unlist(index_2_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_2$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# index_2_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_2_drying_w2wed_conc_list <- append(index_2_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_2$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
index_2_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_sorting_w2wed_conc_list <- append(index_2_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_sorting_w2wed_conc_matrix <- matrix(unlist(index_2_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_2$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
index_2_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_tray_packing_w2wed_conc_list <- append(index_2_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_tray_packing_w2wed_conc_matrix <- matrix(unlist(index_2_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_2$reject_w2wed_conc_list
vector <- vector[vector!='[]']
index_2_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_reject_w2wed_conc_list <- append(index_2_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_reject_w2wed_conc_matrix <- matrix(unlist(index_2_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_2$other_w2wed_conc_list
vector <- vector[vector!='[]']
index_2_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_other_w2wed_conc_list <- append(index_2_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_other_w2wed_conc_matrix <- matrix(unlist(index_2_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

index_2_loading_concs <- as.data.frame(index_2_loading_w2wed_conc_list)
index_2_loading_concs$area <- as.factor('loading')
index_2_loading_concs$scenario <- as.factor('XI_02A2')
index_2_loading_concs$water <- as.factor('Wet')
names(index_2_loading_concs) <- c('concentration','area','scenario','water')

index_2_cleaning_concs <- as.data.frame(index_2_cleaning_w2wed_conc_list)
index_2_cleaning_concs$area <- as.factor('cleaning')
index_2_cleaning_concs$scenario <- as.factor('XI_02A2')
index_2_cleaning_concs$water <- as.factor('Wet')
names(index_2_cleaning_concs) <- c('concentration','area','scenario','water')

index_2_sorting_concs <- as.data.frame(index_2_sorting_w2wed_conc_list)
index_2_sorting_concs$area <- as.factor('sorting')
index_2_sorting_concs$scenario <- as.factor('XI_02A2')
index_2_sorting_concs$water <- as.factor('Dry')
names(index_2_sorting_concs) <- c('concentration','area','scenario','water')

index_2_reject_concs <- as.data.frame(index_2_reject_w2wed_conc_list)
index_2_reject_concs$area <- as.factor('reject')
index_2_reject_concs$scenario <- as.factor('XI_02A2')
index_2_reject_concs$water <- as.factor('Dry')
names(index_2_reject_concs) <- c('concentration','area','scenario','water')

index_2_tray_packing_concs <- as.data.frame(index_2_tray_packing_w2wed_conc_list)
index_2_tray_packing_concs$area <- as.factor('tray packing')
index_2_tray_packing_concs$scenario <- as.factor('XI_02A2')
index_2_tray_packing_concs$water <- as.factor('Dry')
names(index_2_tray_packing_concs) <- c('concentration','area','scenario','water')

index_2_other_concs <- as.data.frame(index_2_other_w2wed_conc_list)
index_2_other_concs$area <- as.factor('other')
index_2_other_concs$scenario <- as.factor('XI_02A2')
index_2_other_concs$water <- as.factor('Dry')
names(index_2_other_concs) <- c('concentration','area','scenario','water')

index_2_w2wed_concs <- rbind(index_2_loading_concs,index_2_cleaning_concs,index_2_sorting_concs,index_2_tray_packing_concs,index_2_reject_concs,index_2_other_concs)

index_2_loading_prev <- as.data.frame(NL_table_Index_2$loading_w2wed_prev[order(NL_table_Index_2$local_seed)])
index_2_loading_prev$area <- as.factor('loading')
index_2_loading_prev$scenario <- as.factor('XI_02A2')
index_2_loading_prev$water <- as.factor('Wet')
names(index_2_loading_prev) <- c('prevalence','area','scenario','water')

index_2_cleaning_prev <- as.data.frame(NL_table_Index_2$cleaning_w2wed_prev[order(NL_table_Index_2$local_seed)])
index_2_cleaning_prev$area <- as.factor('cleaning')
index_2_cleaning_prev$scenario <- as.factor('XI_02A2')
index_2_cleaning_prev$water <- as.factor('Wet')
names(index_2_cleaning_prev) <- c('prevalence','area','scenario','water')

index_2_sorting_prev <- as.data.frame(NL_table_Index_2$sorting_w2wed_prev[order(NL_table_Index_2$local_seed)])
index_2_sorting_prev$area <- as.factor('sorting')
index_2_sorting_prev$scenario <- as.factor('XI_02A2')
index_2_sorting_prev$water <- as.factor('Dry')
names(index_2_sorting_prev) <- c('prevalence','area','scenario','water')

index_2_reject_prev <- as.data.frame(NL_table_Index_2$reject_w2wed_prev[order(NL_table_Index_2$local_seed)])
index_2_reject_prev$area <- as.factor('reject')
index_2_reject_prev$scenario <- as.factor('XI_02A2')
index_2_reject_prev$water <- as.factor('Dry')
names(index_2_reject_prev) <- c('prevalence','area','scenario','water')

index_2_tray_packing_prev <- as.data.frame(NL_table_Index_2$tray_packing_w2wed_prev[order(NL_table_Index_2$local_seed)])
index_2_tray_packing_prev$area <- as.factor('tray packing')
index_2_tray_packing_prev$scenario <- as.factor('XI_02A2')
index_2_tray_packing_prev$water <- as.factor('Dry')
names(index_2_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_2_other_prev <- as.data.frame(NL_table_Index_2$other_w2wed_prev[order(NL_table_Index_2$local_seed)])
index_2_other_prev$area <- as.factor('other')
index_2_other_prev$scenario <- as.factor('XI_02A2')
index_2_other_prev$water <- as.factor('Dry')
names(index_2_other_prev) <- c('prevalence','area','scenario','water')

index_2_w2wed_prev <- rbind(index_2_loading_prev,index_2_cleaning_prev,index_2_sorting_prev,index_2_tray_packing_prev,index_2_reject_prev,index_2_other_prev)

index_2_w2wed_wet_prev <- as.data.frame(index_2_loading_prev$prevalence*21/100+index_2_cleaning_prev$prevalence*28/100)/49*100
index_2_w2wed_wet_prev$scenario <- as.factor('XI_02A2')
index_2_w2wed_wet_prev$water <- as.factor('Wet')
names(index_2_w2wed_wet_prev) <- c('prevalence','scenario','water')

index_2_w2wed_dry_prev <- as.data.frame(index_2_sorting_prev$prevalence*20/100+index_2_reject_prev$prevalence*23/100+index_2_tray_packing_prev$prevalence*123/100+index_2_other_prev$prevalence*10/100)/176*100
index_2_w2wed_dry_prev$scenario <- as.factor('XI_02A2')
index_2_w2wed_dry_prev$water <- as.factor('Dry')
names(index_2_w2wed_dry_prev) <- c('prevalence','scenario','water')

index_2_w2wed_recombined_prev <- rbind(index_2_w2wed_wet_prev, index_2_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Index_2$loading_w3wed_conc_list
vector <- vector[vector!='[]']
index_2_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_loading_w3wed_conc_list <- append(index_2_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_loading_w3wed_conc_matrix <- matrix(unlist(index_2_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_2$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
index_2_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_cleaning_w3wed_conc_list <- append(index_2_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_cleaning_w3wed_conc_matrix <- matrix(unlist(index_2_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_2$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# index_2_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_2_drying_w3wed_conc_list <- append(index_2_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_2$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
index_2_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_sorting_w3wed_conc_list <- append(index_2_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_sorting_w3wed_conc_matrix <- matrix(unlist(index_2_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_2$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
index_2_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_tray_packing_w3wed_conc_list <- append(index_2_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_tray_packing_w3wed_conc_matrix <- matrix(unlist(index_2_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_2$reject_w3wed_conc_list
vector <- vector[vector!='[]']
index_2_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_reject_w3wed_conc_list <- append(index_2_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_reject_w3wed_conc_matrix <- matrix(unlist(index_2_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_2$other_w3wed_conc_list
vector <- vector[vector!='[]']
index_2_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_other_w3wed_conc_list <- append(index_2_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_other_w3wed_conc_matrix <- matrix(unlist(index_2_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

index_2_loading_concs <- as.data.frame(index_2_loading_w3wed_conc_list)
index_2_loading_concs$area <- as.factor('loading')
index_2_loading_concs$scenario <- as.factor('XI_02A2')
index_2_loading_concs$water <- as.factor('Wet')
names(index_2_loading_concs) <- c('concentration','area','scenario','water')

index_2_cleaning_concs <- as.data.frame(index_2_cleaning_w3wed_conc_list)
index_2_cleaning_concs$area <- as.factor('cleaning')
index_2_cleaning_concs$scenario <- as.factor('XI_02A2')
index_2_cleaning_concs$water <- as.factor('Wet')
names(index_2_cleaning_concs) <- c('concentration','area','scenario','water')

index_2_sorting_concs <- as.data.frame(index_2_sorting_w3wed_conc_list)
index_2_sorting_concs$area <- as.factor('sorting')
index_2_sorting_concs$scenario <- as.factor('XI_02A2')
index_2_sorting_concs$water <- as.factor('Dry')
names(index_2_sorting_concs) <- c('concentration','area','scenario','water')

index_2_reject_concs <- as.data.frame(index_2_reject_w3wed_conc_list)
index_2_reject_concs$area <- as.factor('reject')
index_2_reject_concs$scenario <- as.factor('XI_02A2')
index_2_reject_concs$water <- as.factor('Dry')
names(index_2_reject_concs) <- c('concentration','area','scenario','water')

index_2_tray_packing_concs <- as.data.frame(index_2_tray_packing_w3wed_conc_list)
index_2_tray_packing_concs$area <- as.factor('tray packing')
index_2_tray_packing_concs$scenario <- as.factor('XI_02A2')
index_2_tray_packing_concs$water <- as.factor('Dry')
names(index_2_tray_packing_concs) <- c('concentration','area','scenario','water')

index_2_other_concs <- as.data.frame(index_2_other_w3wed_conc_list)
index_2_other_concs$area <- as.factor('other')
index_2_other_concs$scenario <- as.factor('XI_02A2')
index_2_other_concs$water <- as.factor('Dry')
names(index_2_other_concs) <- c('concentration','area','scenario','water')

index_2_w3wed_concs <- rbind(index_2_loading_concs,index_2_cleaning_concs,index_2_sorting_concs,index_2_tray_packing_concs,index_2_reject_concs,index_2_other_concs)

index_2_loading_prev <- as.data.frame(NL_table_Index_2$loading_w3wed_prev[order(NL_table_Index_2$local_seed)])
index_2_loading_prev$area <- as.factor('loading')
index_2_loading_prev$scenario <- as.factor('XI_02A2')
index_2_loading_prev$water <- as.factor('Wet')
names(index_2_loading_prev) <- c('prevalence','area','scenario','water')

index_2_cleaning_prev <- as.data.frame(NL_table_Index_2$cleaning_w3wed_prev[order(NL_table_Index_2$local_seed)])
index_2_cleaning_prev$area <- as.factor('cleaning')
index_2_cleaning_prev$scenario <- as.factor('XI_02A2')
index_2_cleaning_prev$water <- as.factor('Wet')
names(index_2_cleaning_prev) <- c('prevalence','area','scenario','water')

index_2_sorting_prev <- as.data.frame(NL_table_Index_2$sorting_w3wed_prev[order(NL_table_Index_2$local_seed)])
index_2_sorting_prev$area <- as.factor('sorting')
index_2_sorting_prev$scenario <- as.factor('XI_02A2')
index_2_sorting_prev$water <- as.factor('Dry')
names(index_2_sorting_prev) <- c('prevalence','area','scenario','water')

index_2_reject_prev <- as.data.frame(NL_table_Index_2$reject_w3wed_prev[order(NL_table_Index_2$local_seed)])
index_2_reject_prev$area <- as.factor('reject')
index_2_reject_prev$scenario <- as.factor('XI_02A2')
index_2_reject_prev$water <- as.factor('Dry')
names(index_2_reject_prev) <- c('prevalence','area','scenario','water')

index_2_tray_packing_prev <- as.data.frame(NL_table_Index_2$tray_packing_w3wed_prev[order(NL_table_Index_2$local_seed)])
index_2_tray_packing_prev$area <- as.factor('tray packing')
index_2_tray_packing_prev$scenario <- as.factor('XI_02A2')
index_2_tray_packing_prev$water <- as.factor('Dry')
names(index_2_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_2_other_prev <- as.data.frame(NL_table_Index_2$other_w3wed_prev[order(NL_table_Index_2$local_seed)])
index_2_other_prev$area <- as.factor('other')
index_2_other_prev$scenario <- as.factor('XI_02A2')
index_2_other_prev$water <- as.factor('Dry')
names(index_2_other_prev) <- c('prevalence','area','scenario','water')

index_2_w3wed_prev <- rbind(index_2_loading_prev,index_2_cleaning_prev,index_2_sorting_prev,index_2_tray_packing_prev,index_2_reject_prev,index_2_other_prev)

index_2_w3wed_wet_prev <- as.data.frame(index_2_loading_prev$prevalence*21/100+index_2_cleaning_prev$prevalence*28/100)/49*100
index_2_w3wed_wet_prev$scenario <- as.factor('XI_02A2')
index_2_w3wed_wet_prev$water <- as.factor('Wet')
names(index_2_w3wed_wet_prev) <- c('prevalence','scenario','water')

index_2_w3wed_dry_prev <- as.data.frame(index_2_sorting_prev$prevalence*20/100+index_2_reject_prev$prevalence*23/100+index_2_tray_packing_prev$prevalence*123/100+index_2_other_prev$prevalence*10/100)/176*100
index_2_w3wed_dry_prev$scenario <- as.factor('XI_02A2')
index_2_w3wed_dry_prev$water <- as.factor('Dry')
names(index_2_w3wed_dry_prev) <- c('prevalence','scenario','water')

index_2_w3wed_recombined_prev <- rbind(index_2_w3wed_wet_prev, index_2_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Index_2$loading_w4wed_conc_list
vector <- vector[vector!='[]']
index_2_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_loading_w4wed_conc_list <- append(index_2_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_loading_w4wed_conc_matrix <- matrix(unlist(index_2_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_2$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
index_2_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_cleaning_w4wed_conc_list <- append(index_2_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_cleaning_w4wed_conc_matrix <- matrix(unlist(index_2_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_2$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# index_2_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_2_drying_w4wed_conc_list <- append(index_2_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_2$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
index_2_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_sorting_w4wed_conc_list <- append(index_2_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_sorting_w4wed_conc_matrix <- matrix(unlist(index_2_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_2$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
index_2_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_tray_packing_w4wed_conc_list <- append(index_2_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_tray_packing_w4wed_conc_matrix <- matrix(unlist(index_2_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_2$reject_w4wed_conc_list
vector <- vector[vector!='[]']
index_2_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_reject_w4wed_conc_list <- append(index_2_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_reject_w4wed_conc_matrix <- matrix(unlist(index_2_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_2$other_w4wed_conc_list
vector <- vector[vector!='[]']
index_2_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_other_w4wed_conc_list <- append(index_2_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_other_w4wed_conc_matrix <- matrix(unlist(index_2_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

index_2_loading_concs <- as.data.frame(index_2_loading_w4wed_conc_list)
index_2_loading_concs$area <- as.factor('loading')
index_2_loading_concs$scenario <- as.factor('XI_02A2')
index_2_loading_concs$water <- as.factor('Wet')
names(index_2_loading_concs) <- c('concentration','area','scenario','water')

index_2_cleaning_concs <- as.data.frame(index_2_cleaning_w4wed_conc_list)
index_2_cleaning_concs$area <- as.factor('cleaning')
index_2_cleaning_concs$scenario <- as.factor('XI_02A2')
index_2_cleaning_concs$water <- as.factor('Wet')
names(index_2_cleaning_concs) <- c('concentration','area','scenario','water')

index_2_sorting_concs <- as.data.frame(index_2_sorting_w4wed_conc_list)
index_2_sorting_concs$area <- as.factor('sorting')
index_2_sorting_concs$scenario <- as.factor('XI_02A2')
index_2_sorting_concs$water <- as.factor('Dry')
names(index_2_sorting_concs) <- c('concentration','area','scenario','water')

index_2_reject_concs <- as.data.frame(index_2_reject_w4wed_conc_list)
index_2_reject_concs$area <- as.factor('reject')
index_2_reject_concs$scenario <- as.factor('XI_02A2')
index_2_reject_concs$water <- as.factor('Dry')
names(index_2_reject_concs) <- c('concentration','area','scenario','water')

index_2_tray_packing_concs <- as.data.frame(index_2_tray_packing_w4wed_conc_list)
index_2_tray_packing_concs$area <- as.factor('tray packing')
index_2_tray_packing_concs$scenario <- as.factor('XI_02A2')
index_2_tray_packing_concs$water <- as.factor('Dry')
names(index_2_tray_packing_concs) <- c('concentration','area','scenario','water')

index_2_other_concs <- as.data.frame(index_2_other_w4wed_conc_list)
index_2_other_concs$area <- as.factor('other')
index_2_other_concs$scenario <- as.factor('XI_02A2')
index_2_other_concs$water <- as.factor('Dry')
names(index_2_other_concs) <- c('concentration','area','scenario','water')

index_2_w4wed_concs <- rbind(index_2_loading_concs,index_2_cleaning_concs,index_2_sorting_concs,index_2_tray_packing_concs,index_2_reject_concs,index_2_other_concs)

index_2_loading_prev <- as.data.frame(NL_table_Index_2$loading_w4wed_prev[order(NL_table_Index_2$local_seed)])
index_2_loading_prev$area <- as.factor('loading')
index_2_loading_prev$scenario <- as.factor('XI_02A2')
index_2_loading_prev$water <- as.factor('Wet')
names(index_2_loading_prev) <- c('prevalence','area','scenario','water')

index_2_cleaning_prev <- as.data.frame(NL_table_Index_2$cleaning_w4wed_prev[order(NL_table_Index_2$local_seed)])
index_2_cleaning_prev$area <- as.factor('cleaning')
index_2_cleaning_prev$scenario <- as.factor('XI_02A2')
index_2_cleaning_prev$water <- as.factor('Wet')
names(index_2_cleaning_prev) <- c('prevalence','area','scenario','water')

index_2_sorting_prev <- as.data.frame(NL_table_Index_2$sorting_w4wed_prev[order(NL_table_Index_2$local_seed)])
index_2_sorting_prev$area <- as.factor('sorting')
index_2_sorting_prev$scenario <- as.factor('XI_02A2')
index_2_sorting_prev$water <- as.factor('Dry')
names(index_2_sorting_prev) <- c('prevalence','area','scenario','water')

index_2_reject_prev <- as.data.frame(NL_table_Index_2$reject_w4wed_prev[order(NL_table_Index_2$local_seed)])
index_2_reject_prev$area <- as.factor('reject')
index_2_reject_prev$scenario <- as.factor('XI_02A2')
index_2_reject_prev$water <- as.factor('Dry')
names(index_2_reject_prev) <- c('prevalence','area','scenario','water')

index_2_tray_packing_prev <- as.data.frame(NL_table_Index_2$tray_packing_w4wed_prev[order(NL_table_Index_2$local_seed)])
index_2_tray_packing_prev$area <- as.factor('tray packing')
index_2_tray_packing_prev$scenario <- as.factor('XI_02A2')
index_2_tray_packing_prev$water <- as.factor('Dry')
names(index_2_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_2_other_prev <- as.data.frame(NL_table_Index_2$other_w4wed_prev[order(NL_table_Index_2$local_seed)])
index_2_other_prev$area <- as.factor('other')
index_2_other_prev$scenario <- as.factor('XI_02A2')
index_2_other_prev$water <- as.factor('Dry')
names(index_2_other_prev) <- c('prevalence','area','scenario','water')

index_2_w4wed_prev <- rbind(index_2_loading_prev,index_2_cleaning_prev,index_2_sorting_prev,index_2_tray_packing_prev,index_2_reject_prev,index_2_other_prev)

index_2_w4wed_wet_prev <- as.data.frame(index_2_loading_prev$prevalence*21/100+index_2_cleaning_prev$prevalence*28/100)/49*100
index_2_w4wed_wet_prev$scenario <- as.factor('XI_02A2')
index_2_w4wed_wet_prev$water <- as.factor('Wet')
names(index_2_w4wed_wet_prev) <- c('prevalence','scenario','water')

index_2_w4wed_dry_prev <- as.data.frame(index_2_sorting_prev$prevalence*20/100+index_2_reject_prev$prevalence*23/100+index_2_tray_packing_prev$prevalence*123/100+index_2_other_prev$prevalence*10/100)/176*100
index_2_w4wed_dry_prev$scenario <- as.factor('XI_02A2')
index_2_w4wed_dry_prev$water <- as.factor('Dry')
names(index_2_w4wed_dry_prev) <- c('prevalence','scenario','water')

index_2_w4wed_recombined_prev <- rbind(index_2_w4wed_wet_prev, index_2_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Index_2$loading_w5wed_conc_list
vector <- vector[vector!='[]']
index_2_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_loading_w5wed_conc_list <- append(index_2_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_loading_w5wed_conc_matrix <- matrix(unlist(index_2_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_2$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
index_2_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_cleaning_w5wed_conc_list <- append(index_2_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_cleaning_w5wed_conc_matrix <- matrix(unlist(index_2_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_2$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# index_2_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_2_drying_w5wed_conc_list <- append(index_2_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_2$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
index_2_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_sorting_w5wed_conc_list <- append(index_2_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_sorting_w5wed_conc_matrix <- matrix(unlist(index_2_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_2$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
index_2_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_tray_packing_w5wed_conc_list <- append(index_2_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_tray_packing_w5wed_conc_matrix <- matrix(unlist(index_2_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_2$reject_w5wed_conc_list
vector <- vector[vector!='[]']
index_2_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_reject_w5wed_conc_list <- append(index_2_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_reject_w5wed_conc_matrix <- matrix(unlist(index_2_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_2$other_w5wed_conc_list
vector <- vector[vector!='[]']
index_2_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_other_w5wed_conc_list <- append(index_2_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_other_w5wed_conc_matrix <- matrix(unlist(index_2_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

index_2_loading_concs <- as.data.frame(index_2_loading_w5wed_conc_list)
index_2_loading_concs$area <- as.factor('loading')
index_2_loading_concs$scenario <- as.factor('XI_02A2')
index_2_loading_concs$water <- as.factor('Wet')
names(index_2_loading_concs) <- c('concentration','area','scenario','water')

index_2_cleaning_concs <- as.data.frame(index_2_cleaning_w5wed_conc_list)
index_2_cleaning_concs$area <- as.factor('cleaning')
index_2_cleaning_concs$scenario <- as.factor('XI_02A2')
index_2_cleaning_concs$water <- as.factor('Wet')
names(index_2_cleaning_concs) <- c('concentration','area','scenario','water')

index_2_sorting_concs <- as.data.frame(index_2_sorting_w5wed_conc_list)
index_2_sorting_concs$area <- as.factor('sorting')
index_2_sorting_concs$scenario <- as.factor('XI_02A2')
index_2_sorting_concs$water <- as.factor('Dry')
names(index_2_sorting_concs) <- c('concentration','area','scenario','water')

index_2_reject_concs <- as.data.frame(index_2_reject_w5wed_conc_list)
index_2_reject_concs$area <- as.factor('reject')
index_2_reject_concs$scenario <- as.factor('XI_02A2')
index_2_reject_concs$water <- as.factor('Dry')
names(index_2_reject_concs) <- c('concentration','area','scenario','water')

index_2_tray_packing_concs <- as.data.frame(index_2_tray_packing_w5wed_conc_list)
index_2_tray_packing_concs$area <- as.factor('tray packing')
index_2_tray_packing_concs$scenario <- as.factor('XI_02A2')
index_2_tray_packing_concs$water <- as.factor('Dry')
names(index_2_tray_packing_concs) <- c('concentration','area','scenario','water')

index_2_other_concs <- as.data.frame(index_2_other_w5wed_conc_list)
index_2_other_concs$area <- as.factor('other')
index_2_other_concs$scenario <- as.factor('XI_02A2')
index_2_other_concs$water <- as.factor('Dry')
names(index_2_other_concs) <- c('concentration','area','scenario','water')

index_2_w5wed_concs <- rbind(index_2_loading_concs,index_2_cleaning_concs,index_2_sorting_concs,index_2_tray_packing_concs,index_2_reject_concs,index_2_other_concs)

index_2_loading_prev <- as.data.frame(NL_table_Index_2$loading_w5wed_prev[order(NL_table_Index_2$local_seed)])
index_2_loading_prev$area <- as.factor('loading')
index_2_loading_prev$scenario <- as.factor('XI_02A2')
index_2_loading_prev$water <- as.factor('Wet')
names(index_2_loading_prev) <- c('prevalence','area','scenario','water')

index_2_cleaning_prev <- as.data.frame(NL_table_Index_2$cleaning_w5wed_prev[order(NL_table_Index_2$local_seed)])
index_2_cleaning_prev$area <- as.factor('cleaning')
index_2_cleaning_prev$scenario <- as.factor('XI_02A2')
index_2_cleaning_prev$water <- as.factor('Wet')
names(index_2_cleaning_prev) <- c('prevalence','area','scenario','water')

index_2_sorting_prev <- as.data.frame(NL_table_Index_2$sorting_w5wed_prev[order(NL_table_Index_2$local_seed)])
index_2_sorting_prev$area <- as.factor('sorting')
index_2_sorting_prev$scenario <- as.factor('XI_02A2')
index_2_sorting_prev$water <- as.factor('Dry')
names(index_2_sorting_prev) <- c('prevalence','area','scenario','water')

index_2_reject_prev <- as.data.frame(NL_table_Index_2$reject_w5wed_prev[order(NL_table_Index_2$local_seed)])
index_2_reject_prev$area <- as.factor('reject')
index_2_reject_prev$scenario <- as.factor('XI_02A2')
index_2_reject_prev$water <- as.factor('Dry')
names(index_2_reject_prev) <- c('prevalence','area','scenario','water')

index_2_tray_packing_prev <- as.data.frame(NL_table_Index_2$tray_packing_w5wed_prev[order(NL_table_Index_2$local_seed)])
index_2_tray_packing_prev$area <- as.factor('tray packing')
index_2_tray_packing_prev$scenario <- as.factor('XI_02A2')
index_2_tray_packing_prev$water <- as.factor('Dry')
names(index_2_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_2_other_prev <- as.data.frame(NL_table_Index_2$other_w5wed_prev[order(NL_table_Index_2$local_seed)])
index_2_other_prev$area <- as.factor('other')
index_2_other_prev$scenario <- as.factor('XI_02A2')
index_2_other_prev$water <- as.factor('Dry')
names(index_2_other_prev) <- c('prevalence','area','scenario','water')

index_2_w5wed_prev <- rbind(index_2_loading_prev,index_2_cleaning_prev,index_2_sorting_prev,index_2_tray_packing_prev,index_2_reject_prev,index_2_other_prev)

index_2_w5wed_wet_prev <- as.data.frame(index_2_loading_prev$prevalence*21/100+index_2_cleaning_prev$prevalence*28/100)/49*100
index_2_w5wed_wet_prev$scenario <- as.factor('XI_02A2')
index_2_w5wed_wet_prev$water <- as.factor('Wet')
names(index_2_w5wed_wet_prev) <- c('prevalence','scenario','water')

index_2_w5wed_dry_prev <- as.data.frame(index_2_sorting_prev$prevalence*20/100+index_2_reject_prev$prevalence*23/100+index_2_tray_packing_prev$prevalence*123/100+index_2_other_prev$prevalence*10/100)/176*100
index_2_w5wed_dry_prev$scenario <- as.factor('XI_02A2')
index_2_w5wed_dry_prev$water <- as.factor('Dry')
names(index_2_w5wed_dry_prev) <- c('prevalence','scenario','water')

index_2_w5wed_recombined_prev <- rbind(index_2_w5wed_wet_prev, index_2_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Index_2$loading_w6wed_conc_list
vector <- vector[vector!='[]']
index_2_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_loading_w6wed_conc_list <- append(index_2_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_loading_w6wed_conc_matrix <- matrix(unlist(index_2_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_2$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
index_2_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_cleaning_w6wed_conc_list <- append(index_2_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_cleaning_w6wed_conc_matrix <- matrix(unlist(index_2_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_2$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# index_2_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_2_drying_w6wed_conc_list <- append(index_2_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_2$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
index_2_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_sorting_w6wed_conc_list <- append(index_2_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_sorting_w6wed_conc_matrix <- matrix(unlist(index_2_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_2$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
index_2_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_tray_packing_w6wed_conc_list <- append(index_2_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_tray_packing_w6wed_conc_matrix <- matrix(unlist(index_2_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_2$reject_w6wed_conc_list
vector <- vector[vector!='[]']
index_2_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_reject_w6wed_conc_list <- append(index_2_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_reject_w6wed_conc_matrix <- matrix(unlist(index_2_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_2$other_w6wed_conc_list
vector <- vector[vector!='[]']
index_2_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_other_w6wed_conc_list <- append(index_2_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_other_w6wed_conc_matrix <- matrix(unlist(index_2_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

index_2_loading_concs <- as.data.frame(index_2_loading_w6wed_conc_list)
index_2_loading_concs$area <- as.factor('loading')
index_2_loading_concs$scenario <- as.factor('XI_02A2')
index_2_loading_concs$water <- as.factor('Wet')
names(index_2_loading_concs) <- c('concentration','area','scenario','water')

index_2_cleaning_concs <- as.data.frame(index_2_cleaning_w6wed_conc_list)
index_2_cleaning_concs$area <- as.factor('cleaning')
index_2_cleaning_concs$scenario <- as.factor('XI_02A2')
index_2_cleaning_concs$water <- as.factor('Wet')
names(index_2_cleaning_concs) <- c('concentration','area','scenario','water')

index_2_sorting_concs <- as.data.frame(index_2_sorting_w6wed_conc_list)
index_2_sorting_concs$area <- as.factor('sorting')
index_2_sorting_concs$scenario <- as.factor('XI_02A2')
index_2_sorting_concs$water <- as.factor('Dry')
names(index_2_sorting_concs) <- c('concentration','area','scenario','water')

index_2_reject_concs <- as.data.frame(index_2_reject_w6wed_conc_list)
index_2_reject_concs$area <- as.factor('reject')
index_2_reject_concs$scenario <- as.factor('XI_02A2')
index_2_reject_concs$water <- as.factor('Dry')
names(index_2_reject_concs) <- c('concentration','area','scenario','water')

index_2_tray_packing_concs <- as.data.frame(index_2_tray_packing_w6wed_conc_list)
index_2_tray_packing_concs$area <- as.factor('tray packing')
index_2_tray_packing_concs$scenario <- as.factor('XI_02A2')
index_2_tray_packing_concs$water <- as.factor('Dry')
names(index_2_tray_packing_concs) <- c('concentration','area','scenario','water')

index_2_other_concs <- as.data.frame(index_2_other_w6wed_conc_list)
index_2_other_concs$area <- as.factor('other')
index_2_other_concs$scenario <- as.factor('XI_02A2')
index_2_other_concs$water <- as.factor('Dry')
names(index_2_other_concs) <- c('concentration','area','scenario','water')

index_2_w6wed_concs <- rbind(index_2_loading_concs,index_2_cleaning_concs,index_2_sorting_concs,index_2_tray_packing_concs,index_2_reject_concs,index_2_other_concs)

index_2_loading_prev <- as.data.frame(NL_table_Index_2$loading_w6wed_prev[order(NL_table_Index_2$local_seed)])
index_2_loading_prev$area <- as.factor('loading')
index_2_loading_prev$scenario <- as.factor('XI_02A2')
index_2_loading_prev$water <- as.factor('Wet')
names(index_2_loading_prev) <- c('prevalence','area','scenario','water')

index_2_cleaning_prev <- as.data.frame(NL_table_Index_2$cleaning_w6wed_prev[order(NL_table_Index_2$local_seed)])
index_2_cleaning_prev$area <- as.factor('cleaning')
index_2_cleaning_prev$scenario <- as.factor('XI_02A2')
index_2_cleaning_prev$water <- as.factor('Wet')
names(index_2_cleaning_prev) <- c('prevalence','area','scenario','water')

index_2_sorting_prev <- as.data.frame(NL_table_Index_2$sorting_w6wed_prev[order(NL_table_Index_2$local_seed)])
index_2_sorting_prev$area <- as.factor('sorting')
index_2_sorting_prev$scenario <- as.factor('XI_02A2')
index_2_sorting_prev$water <- as.factor('Dry')
names(index_2_sorting_prev) <- c('prevalence','area','scenario','water')

index_2_reject_prev <- as.data.frame(NL_table_Index_2$reject_w6wed_prev[order(NL_table_Index_2$local_seed)])
index_2_reject_prev$area <- as.factor('reject')
index_2_reject_prev$scenario <- as.factor('XI_02A2')
index_2_reject_prev$water <- as.factor('Dry')
names(index_2_reject_prev) <- c('prevalence','area','scenario','water')

index_2_tray_packing_prev <- as.data.frame(NL_table_Index_2$tray_packing_w6wed_prev[order(NL_table_Index_2$local_seed)])
index_2_tray_packing_prev$area <- as.factor('tray packing')
index_2_tray_packing_prev$scenario <- as.factor('XI_02A2')
index_2_tray_packing_prev$water <- as.factor('Dry')
names(index_2_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_2_other_prev <- as.data.frame(NL_table_Index_2$other_w6wed_prev[order(NL_table_Index_2$local_seed)])
index_2_other_prev$area <- as.factor('other')
index_2_other_prev$scenario <- as.factor('XI_02A2')
index_2_other_prev$water <- as.factor('Dry')
names(index_2_other_prev) <- c('prevalence','area','scenario','water')

index_2_w6wed_prev <- rbind(index_2_loading_prev,index_2_cleaning_prev,index_2_sorting_prev,index_2_tray_packing_prev,index_2_reject_prev,index_2_other_prev)

index_2_w6wed_wet_prev <- as.data.frame(index_2_loading_prev$prevalence*21/100+index_2_cleaning_prev$prevalence*28/100)/49*100
index_2_w6wed_wet_prev$scenario <- as.factor('XI_02A2')
index_2_w6wed_wet_prev$water <- as.factor('Wet')
names(index_2_w6wed_wet_prev) <- c('prevalence','scenario','water')

index_2_w6wed_dry_prev <- as.data.frame(index_2_sorting_prev$prevalence*20/100+index_2_reject_prev$prevalence*23/100+index_2_tray_packing_prev$prevalence*123/100+index_2_other_prev$prevalence*10/100)/176*100
index_2_w6wed_dry_prev$scenario <- as.factor('XI_02A2')
index_2_w6wed_dry_prev$water <- as.factor('Dry')
names(index_2_w6wed_dry_prev) <- c('prevalence','scenario','water')

index_2_w6wed_recombined_prev <- rbind(index_2_w6wed_wet_prev, index_2_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Index_2$loading_w7wed_conc_list
vector <- vector[vector!='[]']
index_2_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_loading_w7wed_conc_list <- append(index_2_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_loading_w7wed_conc_matrix <- matrix(unlist(index_2_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_2$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
index_2_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_cleaning_w7wed_conc_list <- append(index_2_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_cleaning_w7wed_conc_matrix <- matrix(unlist(index_2_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_2$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# index_2_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_2_drying_w7wed_conc_list <- append(index_2_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_2$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
index_2_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_sorting_w7wed_conc_list <- append(index_2_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_sorting_w7wed_conc_matrix <- matrix(unlist(index_2_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_2$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
index_2_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_tray_packing_w7wed_conc_list <- append(index_2_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_tray_packing_w7wed_conc_matrix <- matrix(unlist(index_2_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_2$reject_w7wed_conc_list
vector <- vector[vector!='[]']
index_2_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_reject_w7wed_conc_list <- append(index_2_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_reject_w7wed_conc_matrix <- matrix(unlist(index_2_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_2$other_w7wed_conc_list
vector <- vector[vector!='[]']
index_2_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_other_w7wed_conc_list <- append(index_2_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_other_w7wed_conc_matrix <- matrix(unlist(index_2_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

index_2_loading_concs <- as.data.frame(index_2_loading_w7wed_conc_list)
index_2_loading_concs$area <- as.factor('loading')
index_2_loading_concs$scenario <- as.factor('XI_02A2')
index_2_loading_concs$water <- as.factor('Wet')
names(index_2_loading_concs) <- c('concentration','area','scenario','water')

index_2_cleaning_concs <- as.data.frame(index_2_cleaning_w7wed_conc_list)
index_2_cleaning_concs$area <- as.factor('cleaning')
index_2_cleaning_concs$scenario <- as.factor('XI_02A2')
index_2_cleaning_concs$water <- as.factor('Wet')
names(index_2_cleaning_concs) <- c('concentration','area','scenario','water')

index_2_sorting_concs <- as.data.frame(index_2_sorting_w7wed_conc_list)
index_2_sorting_concs$area <- as.factor('sorting')
index_2_sorting_concs$scenario <- as.factor('XI_02A2')
index_2_sorting_concs$water <- as.factor('Dry')
names(index_2_sorting_concs) <- c('concentration','area','scenario','water')

index_2_reject_concs <- as.data.frame(index_2_reject_w7wed_conc_list)
index_2_reject_concs$area <- as.factor('reject')
index_2_reject_concs$scenario <- as.factor('XI_02A2')
index_2_reject_concs$water <- as.factor('Dry')
names(index_2_reject_concs) <- c('concentration','area','scenario','water')

index_2_tray_packing_concs <- as.data.frame(index_2_tray_packing_w7wed_conc_list)
index_2_tray_packing_concs$area <- as.factor('tray packing')
index_2_tray_packing_concs$scenario <- as.factor('XI_02A2')
index_2_tray_packing_concs$water <- as.factor('Dry')
names(index_2_tray_packing_concs) <- c('concentration','area','scenario','water')

index_2_other_concs <- as.data.frame(index_2_other_w7wed_conc_list)
index_2_other_concs$area <- as.factor('other')
index_2_other_concs$scenario <- as.factor('XI_02A2')
index_2_other_concs$water <- as.factor('Dry')
names(index_2_other_concs) <- c('concentration','area','scenario','water')

index_2_w7wed_concs <- rbind(index_2_loading_concs,index_2_cleaning_concs,index_2_sorting_concs,index_2_tray_packing_concs,index_2_reject_concs,index_2_other_concs)

index_2_loading_prev <- as.data.frame(NL_table_Index_2$loading_w7wed_prev[order(NL_table_Index_2$local_seed)])
index_2_loading_prev$area <- as.factor('loading')
index_2_loading_prev$scenario <- as.factor('XI_02A2')
index_2_loading_prev$water <- as.factor('Wet')
names(index_2_loading_prev) <- c('prevalence','area','scenario','water')

index_2_cleaning_prev <- as.data.frame(NL_table_Index_2$cleaning_w7wed_prev[order(NL_table_Index_2$local_seed)])
index_2_cleaning_prev$area <- as.factor('cleaning')
index_2_cleaning_prev$scenario <- as.factor('XI_02A2')
index_2_cleaning_prev$water <- as.factor('Wet')
names(index_2_cleaning_prev) <- c('prevalence','area','scenario','water')

index_2_sorting_prev <- as.data.frame(NL_table_Index_2$sorting_w7wed_prev[order(NL_table_Index_2$local_seed)])
index_2_sorting_prev$area <- as.factor('sorting')
index_2_sorting_prev$scenario <- as.factor('XI_02A2')
index_2_sorting_prev$water <- as.factor('Dry')
names(index_2_sorting_prev) <- c('prevalence','area','scenario','water')

index_2_reject_prev <- as.data.frame(NL_table_Index_2$reject_w7wed_prev[order(NL_table_Index_2$local_seed)])
index_2_reject_prev$area <- as.factor('reject')
index_2_reject_prev$scenario <- as.factor('XI_02A2')
index_2_reject_prev$water <- as.factor('Dry')
names(index_2_reject_prev) <- c('prevalence','area','scenario','water')

index_2_tray_packing_prev <- as.data.frame(NL_table_Index_2$tray_packing_w7wed_prev[order(NL_table_Index_2$local_seed)])
index_2_tray_packing_prev$area <- as.factor('tray packing')
index_2_tray_packing_prev$scenario <- as.factor('XI_02A2')
index_2_tray_packing_prev$water <- as.factor('Dry')
names(index_2_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_2_other_prev <- as.data.frame(NL_table_Index_2$other_w7wed_prev[order(NL_table_Index_2$local_seed)])
index_2_other_prev$area <- as.factor('other')
index_2_other_prev$scenario <- as.factor('XI_02A2')
index_2_other_prev$water <- as.factor('Dry')
names(index_2_other_prev) <- c('prevalence','area','scenario','water')

index_2_w7wed_prev <- rbind(index_2_loading_prev,index_2_cleaning_prev,index_2_sorting_prev,index_2_tray_packing_prev,index_2_reject_prev,index_2_other_prev)

index_2_w7wed_wet_prev <- as.data.frame(index_2_loading_prev$prevalence*21/100+index_2_cleaning_prev$prevalence*28/100)/49*100
index_2_w7wed_wet_prev$scenario <- as.factor('XI_02A2')
index_2_w7wed_wet_prev$water <- as.factor('Wet')
names(index_2_w7wed_wet_prev) <- c('prevalence','scenario','water')

index_2_w7wed_dry_prev <- as.data.frame(index_2_sorting_prev$prevalence*20/100+index_2_reject_prev$prevalence*23/100+index_2_tray_packing_prev$prevalence*123/100+index_2_other_prev$prevalence*10/100)/176*100
index_2_w7wed_dry_prev$scenario <- as.factor('XI_02A2')
index_2_w7wed_dry_prev$water <- as.factor('Dry')
names(index_2_w7wed_dry_prev) <- c('prevalence','scenario','water')

index_2_w7wed_recombined_prev <- rbind(index_2_w7wed_wet_prev, index_2_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Index_2$loading_w8wed_conc_list
vector <- vector[vector!='[]']
index_2_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_loading_w8wed_conc_list <- append(index_2_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_loading_w8wed_conc_matrix <- matrix(unlist(index_2_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_2$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
index_2_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_cleaning_w8wed_conc_list <- append(index_2_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_cleaning_w8wed_conc_matrix <- matrix(unlist(index_2_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_2$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# index_2_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_2_drying_w8wed_conc_list <- append(index_2_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_2$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
index_2_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_sorting_w8wed_conc_list <- append(index_2_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_sorting_w8wed_conc_matrix <- matrix(unlist(index_2_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_2$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
index_2_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_tray_packing_w8wed_conc_list <- append(index_2_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_tray_packing_w8wed_conc_matrix <- matrix(unlist(index_2_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_2$reject_w8wed_conc_list
vector <- vector[vector!='[]']
index_2_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_reject_w8wed_conc_list <- append(index_2_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_reject_w8wed_conc_matrix <- matrix(unlist(index_2_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_2$other_w8wed_conc_list
vector <- vector[vector!='[]']
index_2_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_2_other_w8wed_conc_list <- append(index_2_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_2_other_w8wed_conc_matrix <- matrix(unlist(index_2_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

index_2_loading_concs <- as.data.frame(index_2_loading_w8wed_conc_list)
index_2_loading_concs$area <- as.factor('loading')
index_2_loading_concs$scenario <- as.factor('XI_02A2')
index_2_loading_concs$water <- as.factor('Wet')
names(index_2_loading_concs) <- c('concentration','area','scenario','water')

index_2_cleaning_concs <- as.data.frame(index_2_cleaning_w8wed_conc_list)
index_2_cleaning_concs$area <- as.factor('cleaning')
index_2_cleaning_concs$scenario <- as.factor('XI_02A2')
index_2_cleaning_concs$water <- as.factor('Wet')
names(index_2_cleaning_concs) <- c('concentration','area','scenario','water')

index_2_sorting_concs <- as.data.frame(index_2_sorting_w8wed_conc_list)
index_2_sorting_concs$area <- as.factor('sorting')
index_2_sorting_concs$scenario <- as.factor('XI_02A2')
index_2_sorting_concs$water <- as.factor('Dry')
names(index_2_sorting_concs) <- c('concentration','area','scenario','water')

index_2_reject_concs <- as.data.frame(index_2_reject_w8wed_conc_list)
index_2_reject_concs$area <- as.factor('reject')
index_2_reject_concs$scenario <- as.factor('XI_02A2')
index_2_reject_concs$water <- as.factor('Dry')
names(index_2_reject_concs) <- c('concentration','area','scenario','water')

index_2_tray_packing_concs <- as.data.frame(index_2_tray_packing_w8wed_conc_list)
index_2_tray_packing_concs$area <- as.factor('tray packing')
index_2_tray_packing_concs$scenario <- as.factor('XI_02A2')
index_2_tray_packing_concs$water <- as.factor('Dry')
names(index_2_tray_packing_concs) <- c('concentration','area','scenario','water')

index_2_other_concs <- as.data.frame(index_2_other_w8wed_conc_list)
index_2_other_concs$area <- as.factor('other')
index_2_other_concs$scenario <- as.factor('XI_02A2')
index_2_other_concs$water <- as.factor('Dry')
names(index_2_other_concs) <- c('concentration','area','scenario','water')

index_2_w8wed_concs <- rbind(index_2_loading_concs,index_2_cleaning_concs,index_2_sorting_concs,index_2_tray_packing_concs,index_2_reject_concs,index_2_other_concs)

index_2_loading_prev <- as.data.frame(NL_table_Index_2$loading_w8wed_prev[order(NL_table_Index_2$local_seed)])
index_2_loading_prev$area <- as.factor('loading')
index_2_loading_prev$scenario <- as.factor('XI_02A2')
index_2_loading_prev$water <- as.factor('Wet')
names(index_2_loading_prev) <- c('prevalence','area','scenario','water')

index_2_cleaning_prev <- as.data.frame(NL_table_Index_2$cleaning_w8wed_prev[order(NL_table_Index_2$local_seed)])
index_2_cleaning_prev$area <- as.factor('cleaning')
index_2_cleaning_prev$scenario <- as.factor('XI_02A2')
index_2_cleaning_prev$water <- as.factor('Wet')
names(index_2_cleaning_prev) <- c('prevalence','area','scenario','water')

index_2_sorting_prev <- as.data.frame(NL_table_Index_2$sorting_w8wed_prev[order(NL_table_Index_2$local_seed)])
index_2_sorting_prev$area <- as.factor('sorting')
index_2_sorting_prev$scenario <- as.factor('XI_02A2')
index_2_sorting_prev$water <- as.factor('Dry')
names(index_2_sorting_prev) <- c('prevalence','area','scenario','water')

index_2_reject_prev <- as.data.frame(NL_table_Index_2$reject_w8wed_prev[order(NL_table_Index_2$local_seed)])
index_2_reject_prev$area <- as.factor('reject')
index_2_reject_prev$scenario <- as.factor('XI_02A2')
index_2_reject_prev$water <- as.factor('Dry')
names(index_2_reject_prev) <- c('prevalence','area','scenario','water')

index_2_tray_packing_prev <- as.data.frame(NL_table_Index_2$tray_packing_w8wed_prev[order(NL_table_Index_2$local_seed)])
index_2_tray_packing_prev$area <- as.factor('tray packing')
index_2_tray_packing_prev$scenario <- as.factor('XI_02A2')
index_2_tray_packing_prev$water <- as.factor('Dry')
names(index_2_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_2_other_prev <- as.data.frame(NL_table_Index_2$other_w8wed_prev[order(NL_table_Index_2$local_seed)])
index_2_other_prev$area <- as.factor('other')
index_2_other_prev$scenario <- as.factor('XI_02A2')
index_2_other_prev$water <- as.factor('Dry')
names(index_2_other_prev) <- c('prevalence','area','scenario','water')

index_2_w8wed_prev <- rbind(index_2_loading_prev,index_2_cleaning_prev,index_2_sorting_prev,index_2_tray_packing_prev,index_2_reject_prev,index_2_other_prev)

index_2_w8wed_wet_prev <- as.data.frame(index_2_loading_prev$prevalence*21/100+index_2_cleaning_prev$prevalence*28/100)/49*100
index_2_w8wed_wet_prev$scenario <- as.factor('XI_02A2')
index_2_w8wed_wet_prev$water <- as.factor('Wet')
names(index_2_w8wed_wet_prev) <- c('prevalence','scenario','water')

index_2_w8wed_dry_prev <- as.data.frame(index_2_sorting_prev$prevalence*20/100+index_2_reject_prev$prevalence*23/100+index_2_tray_packing_prev$prevalence*123/100+index_2_other_prev$prevalence*10/100)/176*100
index_2_w8wed_dry_prev$scenario <- as.factor('XI_02A2')
index_2_w8wed_dry_prev$water <- as.factor('Dry')
names(index_2_w8wed_dry_prev) <- c('prevalence','scenario','water')

index_2_w8wed_recombined_prev <- rbind(index_2_w8wed_wet_prev, index_2_w8wed_dry_prev)

index_2_w1wed_prev$week <- as.factor(1)
index_2_w2wed_prev$week <- as.factor(2)
index_2_w3wed_prev$week <- as.factor(3)
index_2_w4wed_prev$week <- as.factor(4)
index_2_w5wed_prev$week <- as.factor(5)
index_2_w6wed_prev$week <- as.factor(6)
index_2_w7wed_prev$week <- as.factor(7)
index_2_w8wed_prev$week <- as.factor(8)

index_2_w1wed_recombined_prev$week <- as.factor(1)
index_2_w2wed_recombined_prev$week <- as.factor(2)
index_2_w3wed_recombined_prev$week <- as.factor(3)
index_2_w4wed_recombined_prev$week <- as.factor(4)
index_2_w5wed_recombined_prev$week <- as.factor(5)
index_2_w6wed_recombined_prev$week <- as.factor(6)
index_2_w7wed_recombined_prev$week <- as.factor(7)
index_2_w8wed_recombined_prev$week <- as.factor(8)
index_2_allwed_prev <- rbind(index_2_w1wed_recombined_prev,index_2_w2wed_recombined_prev,index_2_w3wed_recombined_prev,index_2_w4wed_recombined_prev,index_2_w5wed_recombined_prev,index_2_w6wed_recombined_prev,index_2_w7wed_recombined_prev,index_2_w8wed_recombined_prev)

vector <- NL_table_Index_2$lifetime_conc_list[order(NL_table_Index_2$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

index_2_w1wed_recombined_prev$week <- as.factor(1)
index_2_w2wed_recombined_prev$week <- as.factor(2)
index_2_w3wed_recombined_prev$week <- as.factor(3)
index_2_w4wed_recombined_prev$week <- as.factor(4)
index_2_w5wed_recombined_prev$week <- as.factor(5)
index_2_w6wed_recombined_prev$week <- as.factor(6)
index_2_w7wed_recombined_prev$week <- as.factor(7)
index_2_w8wed_recombined_prev$week <- as.factor(8)
index_2_allwed_prev <- rbind(index_2_w1wed_recombined_prev,index_2_w2wed_recombined_prev,index_2_w3wed_recombined_prev,index_2_w4wed_recombined_prev,index_2_w5wed_recombined_prev,index_2_w6wed_recombined_prev,index_2_w7wed_recombined_prev,index_2_w8wed_recombined_prev)

Facility_B_index_2_agents_melted <- melt(mdarray)
colnames(Facility_B_index_2_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_index_2_agents_melted$agent <- Facility_B_index_2_agents_melted$agent-1
Facility_B_index_2_agents_melted$logical <- Facility_B_index_2_agents_melted$value>0
Facility_B_index_2_agents_melted$binary <- as.numeric(Facility_B_index_2_agents_melted$logical)
Facility_B_index_2_agents_melted$log10value <- log10(Facility_B_index_2_agents_melted$value)
Facility_B_index_2_agents_melted$log10value[is.infinite(Facility_B_index_2_agents_melted$log10value)] <- 0

agent <- Facility_B_index_2_agents_melted$agent
iteration <- Facility_B_index_2_agents_melted$iteration
tick <- Facility_B_index_2_agents_melted$tick
rle_matrix <- tapply(Facility_B_index_2_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_partial_prob_intervention_mean_value_matrix <- tapply(Facility_B_index_2_agents_melted$value, list(agent, tick), mean)
Facility_B_index_2_median_value_matrix <- tapply(Facility_B_index_2_agents_melted$value, list(agent, tick), median)
x <- Facility_B_index_2_agents_melted
x$value[x$value==0] <- NA
Facility_B_index_2_pos_median_value_matrix <- tapply(x$value, list(agent, tick), median, na.rm=TRUE)
Facility_B_index_2_prob_value_matrix <- tapply(Facility_B_index_2_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

#Maximum sensitivity####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_index_2 <- durations

agents_list_index_2 <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_index_2 <- agents_list_index_2[,c("V1","V7","V8","V9")]
colnames(agents_list_index_2) <- c("name","sanitation_status","schedule","area")
#Time to persistence
agents_list_index_2$time_to_persistence <- rep((168*2),225)
agents_list_index_2$time_to_persistence[agents_list_index_2$schedule=="daily"] <- (24*2)

persistent_short_durations_list_index_2 <- data.frame()
persistent_long_durations_list_index_2 <- data.frame()
persistent_uncleanable_durations_list_index_2 <- data.frame()
transient_short_durations_list_index_2 <- data.frame()
transient_long_durations_list_index_2 <- data.frame()
transient_uncleanable_durations_list_index_2 <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_index_2$min_duration[agent] <- ifelse(length(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent])==0,NA,min(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_index_2$mean_duration[agent] <- ifelse(length(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent])==0,NA,mean(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_index_2$median_duration[agent] <- ifelse(length(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent])==0,NA,median(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_index_2$max_duration[agent] <- ifelse(length(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent])==0,NA,max(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_index_2$contamination_events[agent] <- sum(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_index_2$times_persistent[agent] <- sum(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent]>agents_list_index_2$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_index_2$q1_duration[agent] <- quantile(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_index_2$q3_duration[agent] <- quantile(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_index_2$min_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent])==0) || (agents_list_index_2$times_persistent[agent]==0),NA,min(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent & Facility_B_durations_index_2$duration>=agents_list_index_2$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_index_2$mean_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent])==0) || (agents_list_index_2$times_persistent[agent]==0),NA,mean(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent & Facility_B_durations_index_2$duration>=agents_list_index_2$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_index_2$median_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent])==0) || (agents_list_index_2$times_persistent[agent]==0),NA,median(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent & Facility_B_durations_index_2$duration>=agents_list_index_2$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_index_2$max_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent])==0) || (agents_list_index_2$times_persistent[agent]==0),NA,max(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent & Facility_B_durations_index_2$duration>=agents_list_index_2$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_index_2$q1_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent])==0) || (agents_list_index_2$times_persistent[agent]==0),NA,quantile(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent & Facility_B_durations_index_2$duration>=agents_list_index_2$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_index_2$q3_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent])==0) || (agents_list_index_2$times_persistent[agent]==0),NA,quantile(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent & Facility_B_durations_index_2$duration>=agents_list_index_2$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations
  x <- Facility_B_durations_index_2[which(Facility_B_durations_index_2$agent==agent & Facility_B_durations_index_2$duration>agents_list_index_2$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean
  agents_list_index_2$mean_times_persistent[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_index_2$mean_times_persistent[which(is.na(agents_list_index_2$mean_times_persistent))] <- 0
  #Division by total number of iterations in simulation
  agents_list_index_2$balanced_times_persistent[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_index_2$duration[Facility_B_durations_index_2$agent==agent])!=0) || (agents_list_index_2$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_index_2$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_index_2 <- rbind(
        persistent_short_durations_list_index_2,
        Facility_B_durations_index_2[Facility_B_durations_index_2$agent==agent & Facility_B_durations_index_2$duration>agents_list_index_2$time_to_persistence[agent],]
      )
    } else if(agents_list_index_2$time_to_persistence[agent]==336 && agents_list_index_2$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_index_2 <- rbind(
        persistent_long_durations_list_index_2,
        Facility_B_durations_index_2[Facility_B_durations_index_2$agent==agent & Facility_B_durations_index_2$duration>agents_list_index_2$time_to_persistence[agent],]
      )
    } else if(agents_list_index_2$time_to_persistence[agent]==336 && agents_list_index_2$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_index_2 <- rbind(
        persistent_uncleanable_durations_list_index_2,
        Facility_B_durations_index_2[Facility_B_durations_index_2$agent==agent & Facility_B_durations_index_2$duration>agents_list_index_2$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_index_2$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_index_2 <- rbind(
      transient_short_durations_list_index_2,
      Facility_B_durations_index_2[Facility_B_durations_index_2$agent==agent & Facility_B_durations_index_2$duration<=agents_list_index_2$time_to_persistence[agent],]
    )
  } else if(agents_list_index_2$time_to_persistence[agent]==336 && agents_list_index_2$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_index_2 <- rbind(
      transient_long_durations_list_index_2,
      Facility_B_durations_index_2[Facility_B_durations_index_2$agent==agent & Facility_B_durations_index_2$duration<=agents_list_index_2$time_to_persistence[agent],]
    )
  } else if(agents_list_index_2$time_to_persistence[agent]==336 && agents_list_index_2$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_index_2 <- rbind(
      transient_uncleanable_durations_list_index_2,
      Facility_B_durations_index_2[Facility_B_durations_index_2$agent==agent & Facility_B_durations_index_2$duration<=agents_list_index_2$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

#10 cells minimum####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>9)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_index_2_10min <- durations

persistent_short_durations_list_index_2_10min <- data.frame()
persistent_long_durations_list_index_2_10min <- data.frame()
persistent_uncleanable_durations_list_index_2_10min <- data.frame()
transient_short_durations_list_index_2_10min <- data.frame()
transient_long_durations_list_index_2_10min <- data.frame()
transient_uncleanable_durations_list_index_2_10min <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_index_2$min_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent])==0,NA,min(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_index_2$mean_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent])==0,NA,mean(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_index_2$median_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent])==0,NA,median(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_index_2$max_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent])==0,NA,max(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_index_2$contamination_events_10min[agent] <- sum(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_index_2$times_persistent_10min[agent] <- sum(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent]>agents_list_index_2$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_index_2$q1_duration_10min[agent] <- quantile(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_index_2$q3_duration_10min[agent] <- quantile(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_index_2$min_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent])==0) || (agents_list_index_2$times_persistent_10min[agent]==0),NA,min(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent & Facility_B_durations_index_2_10min$duration>=agents_list_index_2$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_index_2$mean_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent])==0) || (agents_list_index_2$times_persistent_10min[agent]==0),NA,mean(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent & Facility_B_durations_index_2_10min$duration>=agents_list_index_2$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_index_2$median_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent])==0) || (agents_list_index_2$times_persistent_10min[agent]==0),NA,median(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent & Facility_B_durations_index_2_10min$duration>=agents_list_index_2$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_index_2$max_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent])==0) || (agents_list_index_2$times_persistent_10min[agent]==0),NA,max(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent & Facility_B_durations_index_2_10min$duration>=agents_list_index_2$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_index_2$q1_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent])==0) || (agents_list_index_2$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent & Facility_B_durations_index_2_10min$duration>=agents_list_index_2$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_index_2$q3_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent])==0) || (agents_list_index_2$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent & Facility_B_durations_index_2_10min$duration>=agents_list_index_2$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations (Does not account for iterations with 0 events)
  x <- Facility_B_durations_index_2_10min[which(Facility_B_durations_index_2_10min$agent==agent & Facility_B_durations_index_2_10min$duration>agents_list_index_2$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean (Does account for iterations with 0 events)
  agents_list_index_2$mean_times_persistent_10min[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_index_2$mean_times_persistent_10min[which(is.na(agents_list_index_2$mean_times_persistent_10min))] <- 0
  #Division by total number of iterations in simulation
  agents_list_index_2$balanced_times_persistent_10min[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_index_2_10min$duration[Facility_B_durations_index_2_10min$agent==agent])!=0) || (agents_list_index_2$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_index_2$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_index_2_10min <- rbind(
        persistent_short_durations_list_index_2_10min,
        Facility_B_durations_index_2_10min[Facility_B_durations_index_2_10min$agent==agent & Facility_B_durations_index_2_10min$duration>agents_list_index_2$time_to_persistence[agent],]
      )
    } else if(agents_list_index_2$time_to_persistence[agent]==336 && agents_list_index_2$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_index_2_10min <- rbind(
        persistent_long_durations_list_index_2_10min,
        Facility_B_durations_index_2_10min[Facility_B_durations_index_2_10min$agent==agent & Facility_B_durations_index_2_10min$duration>agents_list_index_2$time_to_persistence[agent],]
      )
    } else if(agents_list_index_2$time_to_persistence[agent]==336 && agents_list_index_2$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_index_2_10min <- rbind(
        persistent_uncleanable_durations_list_index_2_10min,
        Facility_B_durations_index_2_10min[Facility_B_durations_index_2_10min$agent==agent & Facility_B_durations_index_2_10min$duration>agents_list_index_2$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_index_2$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_index_2_10min <- rbind(
      transient_short_durations_list_index_2_10min,
      Facility_B_durations_index_2_10min[Facility_B_durations_index_2_10min$agent==agent & Facility_B_durations_index_2_10min$duration<=agents_list_index_2$time_to_persistence[agent],]
    )
  } else if(agents_list_index_2$time_to_persistence[agent]==336 && agents_list_index_2$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_index_2_10min <- rbind(
      transient_long_durations_list_index_2_10min,
      Facility_B_durations_index_2_10min[Facility_B_durations_index_2_10min$agent==agent & Facility_B_durations_index_2_10min$duration<=agents_list_index_2$time_to_persistence[agent],]
    )
  } else if(agents_list_index_2$time_to_persistence[agent]==336 && agents_list_index_2$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_index_2_10min <- rbind(
      transient_uncleanable_durations_list_index_2_10min,
      Facility_B_durations_index_2_10min[Facility_B_durations_index_2_10min$agent==agent & Facility_B_durations_index_2_10min$duration<=agents_list_index_2$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

# Facility_B_index_2_agents_melted_monday_preop <- Facility_B_index_2_agents_melted[which(Facility_B_index_2_agents_melted$tick==33|Facility_B_index_2_agents_melted$tick==201|Facility_B_index_2_agents_melted$tick==369|Facility_B_index_2_agents_melted$tick==537|Facility_B_index_2_agents_melted$tick==705|Facility_B_index_2_agents_melted$tick==873|Facility_B_index_2_agents_melted$tick==1041|Facility_B_index_2_agents_melted$tick==1209),]
# 
# Facility_B_index_2_agents_melted_tuesday_preop <- Facility_B_index_2_agents_melted[which(Facility_B_index_2_agents_melted$tick==57|Facility_B_index_2_agents_melted$tick==225|Facility_B_index_2_agents_melted$tick==393|Facility_B_index_2_agents_melted$tick==561|Facility_B_index_2_agents_melted$tick==729|Facility_B_index_2_agents_melted$tick==897|Facility_B_index_2_agents_melted$tick==1065|Facility_B_index_2_agents_melted$tick==1233),]
# 
# Facility_B_index_2_agents_melted_wednesday_preop <- Facility_B_index_2_agents_melted[which(Facility_B_index_2_agents_melted$tick==81|Facility_B_index_2_agents_melted$tick==249|Facility_B_index_2_agents_melted$tick==417|Facility_B_index_2_agents_melted$tick==585|Facility_B_index_2_agents_melted$tick==753|Facility_B_index_2_agents_melted$tick==921|Facility_B_index_2_agents_melted$tick==1089|Facility_B_index_2_agents_melted$tick==1257),]
# 
# Facility_B_index_2_agents_melted_thursday_preop <- Facility_B_index_2_agents_melted[which(Facility_B_index_2_agents_melted$tick==105|Facility_B_index_2_agents_melted$tick==273|Facility_B_index_2_agents_melted$tick==441|Facility_B_index_2_agents_melted$tick==609|Facility_B_index_2_agents_melted$tick==777|Facility_B_index_2_agents_melted$tick==945|Facility_B_index_2_agents_melted$tick==1113|Facility_B_index_2_agents_melted$tick==1281),]
# 
# Facility_B_index_2_agents_melted_friday_preop <- Facility_B_index_2_agents_melted[which(Facility_B_index_2_agents_melted$tick==129|Facility_B_index_2_agents_melted$tick==297|Facility_B_index_2_agents_melted$tick==465|Facility_B_index_2_agents_melted$tick==633|Facility_B_index_2_agents_melted$tick==801|Facility_B_index_2_agents_melted$tick==969|Facility_B_index_2_agents_melted$tick==1137|Facility_B_index_2_agents_melted$tick==1305),]

Facility_B_index_2_agents_melted_ff <- as.ffdf(Facility_B_index_2_agents_melted)
rm(Facility_B_index_2_agents_melted)
gc()
```

```{r import Index Case 3}
NL_table_Index_3 <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-25-11-09 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Pre_Contamination-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Index_3 <- NL_table_Index_3[NL_table_Index_3$scenario==53,]

while (any(grepl('-', names(NL_table_Index_3), fixed = TRUE))) {
  NL_table_Index_3 <- NL_table_Index_3 %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Index_3), fixed = TRUE))) {
  NL_table_Index_3 <- NL_table_Index_3 %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Index_3), fixed = TRUE))) {
  NL_table_Index_3 <- NL_table_Index_3 %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Index_3), fixed = TRUE))) {
  NL_table_Index_3 <- NL_table_Index_3 %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Index_3[ , ..list_columns]

NL_table_Index_3[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Index_3 <- as.data.frame(NL_table_Index_3)

NL_table_Index_3[NL_table_Index_3==-1] <- NA

NL_table_Index_3 <- subset(NL_table_Index_3, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Index_3)[names(NL_table_Index_3)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Index_3)[names(NL_table_Index_3)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Index_3$loading_w1wed_conc_list
vector <- vector[vector!='[]']
index_3_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_loading_w1wed_conc_list <- append(index_3_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_loading_w1wed_conc_matrix <- matrix(unlist(index_3_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_3$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
index_3_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_cleaning_w1wed_conc_list <- append(index_3_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_cleaning_w1wed_conc_matrix <- matrix(unlist(index_3_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_3$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# index_3_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_3_drying_w1wed_conc_list <- append(index_3_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_3$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
index_3_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_sorting_w1wed_conc_list <- append(index_3_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_sorting_w1wed_conc_matrix <- matrix(unlist(index_3_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_3$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
index_3_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_tray_packing_w1wed_conc_list <- append(index_3_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_tray_packing_w1wed_conc_matrix <- matrix(unlist(index_3_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_3$reject_w1wed_conc_list
vector <- vector[vector!='[]']
index_3_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_reject_w1wed_conc_list <- append(index_3_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_reject_w1wed_conc_matrix <- matrix(unlist(index_3_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_3$other_w1wed_conc_list
vector <- vector[vector!='[]']
index_3_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_other_w1wed_conc_list <- append(index_3_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_other_w1wed_conc_matrix <- matrix(unlist(index_3_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

index_3_loading_concs <- as.data.frame(index_3_loading_w1wed_conc_list)
index_3_loading_concs$area <- as.factor('loading')
index_3_loading_concs$scenario <- as.factor('XI_02A3')
index_3_loading_concs$water <- as.factor('Wet')
names(index_3_loading_concs) <- c('concentration','area','scenario','water')

index_3_cleaning_concs <- as.data.frame(index_3_cleaning_w1wed_conc_list)
index_3_cleaning_concs$area <- as.factor('cleaning')
index_3_cleaning_concs$scenario <- as.factor('XI_02A3')
index_3_cleaning_concs$water <- as.factor('Wet')
names(index_3_cleaning_concs) <- c('concentration','area','scenario','water')

index_3_sorting_concs <- as.data.frame(index_3_sorting_w1wed_conc_list)
index_3_sorting_concs$area <- as.factor('sorting')
index_3_sorting_concs$scenario <- as.factor('XI_02A3')
index_3_sorting_concs$water <- as.factor('Dry')
names(index_3_sorting_concs) <- c('concentration','area','scenario','water')

index_3_reject_concs <- as.data.frame(index_3_reject_w1wed_conc_list)
index_3_reject_concs$area <- as.factor('reject')
index_3_reject_concs$scenario <- as.factor('XI_02A3')
index_3_reject_concs$water <- as.factor('Dry')
names(index_3_reject_concs) <- c('concentration','area','scenario','water')

index_3_tray_packing_concs <- as.data.frame(index_3_tray_packing_w1wed_conc_list)
index_3_tray_packing_concs$area <- as.factor('tray packing')
index_3_tray_packing_concs$scenario <- as.factor('XI_02A3')
index_3_tray_packing_concs$water <- as.factor('Dry')
names(index_3_tray_packing_concs) <- c('concentration','area','scenario','water')

index_3_other_concs <- as.data.frame(index_3_other_w1wed_conc_list)
index_3_other_concs$area <- as.factor('other')
index_3_other_concs$scenario <- as.factor('XI_02A3')
index_3_other_concs$water <- as.factor('Dry')
names(index_3_other_concs) <- c('concentration','area','scenario','water')

index_3_w1wed_concs <- rbind(index_3_loading_concs,index_3_cleaning_concs,index_3_sorting_concs,index_3_tray_packing_concs,index_3_reject_concs,index_3_other_concs)

index_3_loading_prev <- as.data.frame(NL_table_Index_3$loading_w1wed_prev[order(NL_table_Index_3$local_seed)])
index_3_loading_prev$area <- as.factor('loading')
index_3_loading_prev$scenario <- as.factor('XI_02A3')
index_3_loading_prev$water <- as.factor('Wet')
names(index_3_loading_prev) <- c('prevalence','area','scenario','water')

index_3_cleaning_prev <- as.data.frame(NL_table_Index_3$cleaning_w1wed_prev[order(NL_table_Index_3$local_seed)])
index_3_cleaning_prev$area <- as.factor('cleaning')
index_3_cleaning_prev$scenario <- as.factor('XI_02A3')
index_3_cleaning_prev$water <- as.factor('Wet')
names(index_3_cleaning_prev) <- c('prevalence','area','scenario','water')

index_3_sorting_prev <- as.data.frame(NL_table_Index_3$sorting_w1wed_prev[order(NL_table_Index_3$local_seed)])
index_3_sorting_prev$area <- as.factor('sorting')
index_3_sorting_prev$scenario <- as.factor('XI_02A3')
index_3_sorting_prev$water <- as.factor('Dry')
names(index_3_sorting_prev) <- c('prevalence','area','scenario','water')

index_3_reject_prev <- as.data.frame(NL_table_Index_3$reject_w1wed_prev[order(NL_table_Index_3$local_seed)])
index_3_reject_prev$area <- as.factor('reject')
index_3_reject_prev$scenario <- as.factor('XI_02A3')
index_3_reject_prev$water <- as.factor('Dry')
names(index_3_reject_prev) <- c('prevalence','area','scenario','water')

index_3_tray_packing_prev <- as.data.frame(NL_table_Index_3$tray_packing_w1wed_prev[order(NL_table_Index_3$local_seed)])
index_3_tray_packing_prev$area <- as.factor('tray packing')
index_3_tray_packing_prev$scenario <- as.factor('XI_02A3')
index_3_tray_packing_prev$water <- as.factor('Dry')
names(index_3_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_3_other_prev <- as.data.frame(NL_table_Index_3$other_w1wed_prev[order(NL_table_Index_3$local_seed)])
index_3_other_prev$area <- as.factor('other')
index_3_other_prev$scenario <- as.factor('XI_02A3')
index_3_other_prev$water <- as.factor('Dry')
names(index_3_other_prev) <- c('prevalence','area','scenario','water')

index_3_w1wed_prev <- rbind(index_3_loading_prev,index_3_cleaning_prev,index_3_sorting_prev,index_3_tray_packing_prev,index_3_reject_prev,index_3_other_prev)

index_3_w1wed_wet_prev <- as.data.frame(index_3_loading_prev$prevalence*21/100+index_3_cleaning_prev$prevalence*28/100)/49*100
index_3_w1wed_wet_prev$scenario <- as.factor('XI_02A3')
index_3_w1wed_wet_prev$water <- as.factor('Wet')
names(index_3_w1wed_wet_prev) <- c('prevalence','scenario','water')

index_3_w1wed_dry_prev <- as.data.frame(index_3_sorting_prev$prevalence*20/100+index_3_reject_prev$prevalence*23/100+index_3_tray_packing_prev$prevalence*123/100+index_3_other_prev$prevalence*10/100)/176*100
index_3_w1wed_dry_prev$scenario <- as.factor('XI_02A3')
index_3_w1wed_dry_prev$water <- as.factor('Dry')
names(index_3_w1wed_dry_prev) <- c('prevalence','scenario','water')

index_3_w1wed_recombined_prev <- rbind(index_3_w1wed_wet_prev, index_3_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Index_3$loading_w2wed_conc_list
vector <- vector[vector!='[]']
index_3_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_loading_w2wed_conc_list <- append(index_3_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_loading_w2wed_conc_matrix <- matrix(unlist(index_3_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_3$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
index_3_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_cleaning_w2wed_conc_list <- append(index_3_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_cleaning_w2wed_conc_matrix <- matrix(unlist(index_3_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_3$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# index_3_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_3_drying_w2wed_conc_list <- append(index_3_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_3$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
index_3_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_sorting_w2wed_conc_list <- append(index_3_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_sorting_w2wed_conc_matrix <- matrix(unlist(index_3_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_3$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
index_3_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_tray_packing_w2wed_conc_list <- append(index_3_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_tray_packing_w2wed_conc_matrix <- matrix(unlist(index_3_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_3$reject_w2wed_conc_list
vector <- vector[vector!='[]']
index_3_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_reject_w2wed_conc_list <- append(index_3_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_reject_w2wed_conc_matrix <- matrix(unlist(index_3_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_3$other_w2wed_conc_list
vector <- vector[vector!='[]']
index_3_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_other_w2wed_conc_list <- append(index_3_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_other_w2wed_conc_matrix <- matrix(unlist(index_3_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

index_3_loading_concs <- as.data.frame(index_3_loading_w2wed_conc_list)
index_3_loading_concs$area <- as.factor('loading')
index_3_loading_concs$scenario <- as.factor('XI_02A3')
index_3_loading_concs$water <- as.factor('Wet')
names(index_3_loading_concs) <- c('concentration','area','scenario','water')

index_3_cleaning_concs <- as.data.frame(index_3_cleaning_w2wed_conc_list)
index_3_cleaning_concs$area <- as.factor('cleaning')
index_3_cleaning_concs$scenario <- as.factor('XI_02A3')
index_3_cleaning_concs$water <- as.factor('Wet')
names(index_3_cleaning_concs) <- c('concentration','area','scenario','water')

index_3_sorting_concs <- as.data.frame(index_3_sorting_w2wed_conc_list)
index_3_sorting_concs$area <- as.factor('sorting')
index_3_sorting_concs$scenario <- as.factor('XI_02A3')
index_3_sorting_concs$water <- as.factor('Dry')
names(index_3_sorting_concs) <- c('concentration','area','scenario','water')

index_3_reject_concs <- as.data.frame(index_3_reject_w2wed_conc_list)
index_3_reject_concs$area <- as.factor('reject')
index_3_reject_concs$scenario <- as.factor('XI_02A3')
index_3_reject_concs$water <- as.factor('Dry')
names(index_3_reject_concs) <- c('concentration','area','scenario','water')

index_3_tray_packing_concs <- as.data.frame(index_3_tray_packing_w2wed_conc_list)
index_3_tray_packing_concs$area <- as.factor('tray packing')
index_3_tray_packing_concs$scenario <- as.factor('XI_02A3')
index_3_tray_packing_concs$water <- as.factor('Dry')
names(index_3_tray_packing_concs) <- c('concentration','area','scenario','water')

index_3_other_concs <- as.data.frame(index_3_other_w2wed_conc_list)
index_3_other_concs$area <- as.factor('other')
index_3_other_concs$scenario <- as.factor('XI_02A3')
index_3_other_concs$water <- as.factor('Dry')
names(index_3_other_concs) <- c('concentration','area','scenario','water')

index_3_w2wed_concs <- rbind(index_3_loading_concs,index_3_cleaning_concs,index_3_sorting_concs,index_3_tray_packing_concs,index_3_reject_concs,index_3_other_concs)

index_3_loading_prev <- as.data.frame(NL_table_Index_3$loading_w2wed_prev[order(NL_table_Index_3$local_seed)])
index_3_loading_prev$area <- as.factor('loading')
index_3_loading_prev$scenario <- as.factor('XI_02A3')
index_3_loading_prev$water <- as.factor('Wet')
names(index_3_loading_prev) <- c('prevalence','area','scenario','water')

index_3_cleaning_prev <- as.data.frame(NL_table_Index_3$cleaning_w2wed_prev[order(NL_table_Index_3$local_seed)])
index_3_cleaning_prev$area <- as.factor('cleaning')
index_3_cleaning_prev$scenario <- as.factor('XI_02A3')
index_3_cleaning_prev$water <- as.factor('Wet')
names(index_3_cleaning_prev) <- c('prevalence','area','scenario','water')

index_3_sorting_prev <- as.data.frame(NL_table_Index_3$sorting_w2wed_prev[order(NL_table_Index_3$local_seed)])
index_3_sorting_prev$area <- as.factor('sorting')
index_3_sorting_prev$scenario <- as.factor('XI_02A3')
index_3_sorting_prev$water <- as.factor('Dry')
names(index_3_sorting_prev) <- c('prevalence','area','scenario','water')

index_3_reject_prev <- as.data.frame(NL_table_Index_3$reject_w2wed_prev[order(NL_table_Index_3$local_seed)])
index_3_reject_prev$area <- as.factor('reject')
index_3_reject_prev$scenario <- as.factor('XI_02A3')
index_3_reject_prev$water <- as.factor('Dry')
names(index_3_reject_prev) <- c('prevalence','area','scenario','water')

index_3_tray_packing_prev <- as.data.frame(NL_table_Index_3$tray_packing_w2wed_prev[order(NL_table_Index_3$local_seed)])
index_3_tray_packing_prev$area <- as.factor('tray packing')
index_3_tray_packing_prev$scenario <- as.factor('XI_02A3')
index_3_tray_packing_prev$water <- as.factor('Dry')
names(index_3_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_3_other_prev <- as.data.frame(NL_table_Index_3$other_w2wed_prev[order(NL_table_Index_3$local_seed)])
index_3_other_prev$area <- as.factor('other')
index_3_other_prev$scenario <- as.factor('XI_02A3')
index_3_other_prev$water <- as.factor('Dry')
names(index_3_other_prev) <- c('prevalence','area','scenario','water')

index_3_w2wed_prev <- rbind(index_3_loading_prev,index_3_cleaning_prev,index_3_sorting_prev,index_3_tray_packing_prev,index_3_reject_prev,index_3_other_prev)

index_3_w2wed_wet_prev <- as.data.frame(index_3_loading_prev$prevalence*21/100+index_3_cleaning_prev$prevalence*28/100)/49*100
index_3_w2wed_wet_prev$scenario <- as.factor('XI_02A3')
index_3_w2wed_wet_prev$water <- as.factor('Wet')
names(index_3_w2wed_wet_prev) <- c('prevalence','scenario','water')

index_3_w2wed_dry_prev <- as.data.frame(index_3_sorting_prev$prevalence*20/100+index_3_reject_prev$prevalence*23/100+index_3_tray_packing_prev$prevalence*123/100+index_3_other_prev$prevalence*10/100)/176*100
index_3_w2wed_dry_prev$scenario <- as.factor('XI_02A3')
index_3_w2wed_dry_prev$water <- as.factor('Dry')
names(index_3_w2wed_dry_prev) <- c('prevalence','scenario','water')

index_3_w2wed_recombined_prev <- rbind(index_3_w2wed_wet_prev, index_3_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Index_3$loading_w3wed_conc_list
vector <- vector[vector!='[]']
index_3_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_loading_w3wed_conc_list <- append(index_3_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_loading_w3wed_conc_matrix <- matrix(unlist(index_3_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_3$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
index_3_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_cleaning_w3wed_conc_list <- append(index_3_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_cleaning_w3wed_conc_matrix <- matrix(unlist(index_3_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_3$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# index_3_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_3_drying_w3wed_conc_list <- append(index_3_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_3$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
index_3_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_sorting_w3wed_conc_list <- append(index_3_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_sorting_w3wed_conc_matrix <- matrix(unlist(index_3_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_3$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
index_3_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_tray_packing_w3wed_conc_list <- append(index_3_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_tray_packing_w3wed_conc_matrix <- matrix(unlist(index_3_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_3$reject_w3wed_conc_list
vector <- vector[vector!='[]']
index_3_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_reject_w3wed_conc_list <- append(index_3_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_reject_w3wed_conc_matrix <- matrix(unlist(index_3_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_3$other_w3wed_conc_list
vector <- vector[vector!='[]']
index_3_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_other_w3wed_conc_list <- append(index_3_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_other_w3wed_conc_matrix <- matrix(unlist(index_3_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

index_3_loading_concs <- as.data.frame(index_3_loading_w3wed_conc_list)
index_3_loading_concs$area <- as.factor('loading')
index_3_loading_concs$scenario <- as.factor('XI_02A3')
index_3_loading_concs$water <- as.factor('Wet')
names(index_3_loading_concs) <- c('concentration','area','scenario','water')

index_3_cleaning_concs <- as.data.frame(index_3_cleaning_w3wed_conc_list)
index_3_cleaning_concs$area <- as.factor('cleaning')
index_3_cleaning_concs$scenario <- as.factor('XI_02A3')
index_3_cleaning_concs$water <- as.factor('Wet')
names(index_3_cleaning_concs) <- c('concentration','area','scenario','water')

index_3_sorting_concs <- as.data.frame(index_3_sorting_w3wed_conc_list)
index_3_sorting_concs$area <- as.factor('sorting')
index_3_sorting_concs$scenario <- as.factor('XI_02A3')
index_3_sorting_concs$water <- as.factor('Dry')
names(index_3_sorting_concs) <- c('concentration','area','scenario','water')

index_3_reject_concs <- as.data.frame(index_3_reject_w3wed_conc_list)
index_3_reject_concs$area <- as.factor('reject')
index_3_reject_concs$scenario <- as.factor('XI_02A3')
index_3_reject_concs$water <- as.factor('Dry')
names(index_3_reject_concs) <- c('concentration','area','scenario','water')

index_3_tray_packing_concs <- as.data.frame(index_3_tray_packing_w3wed_conc_list)
index_3_tray_packing_concs$area <- as.factor('tray packing')
index_3_tray_packing_concs$scenario <- as.factor('XI_02A3')
index_3_tray_packing_concs$water <- as.factor('Dry')
names(index_3_tray_packing_concs) <- c('concentration','area','scenario','water')

index_3_other_concs <- as.data.frame(index_3_other_w3wed_conc_list)
index_3_other_concs$area <- as.factor('other')
index_3_other_concs$scenario <- as.factor('XI_02A3')
index_3_other_concs$water <- as.factor('Dry')
names(index_3_other_concs) <- c('concentration','area','scenario','water')

index_3_w3wed_concs <- rbind(index_3_loading_concs,index_3_cleaning_concs,index_3_sorting_concs,index_3_tray_packing_concs,index_3_reject_concs,index_3_other_concs)

index_3_loading_prev <- as.data.frame(NL_table_Index_3$loading_w3wed_prev[order(NL_table_Index_3$local_seed)])
index_3_loading_prev$area <- as.factor('loading')
index_3_loading_prev$scenario <- as.factor('XI_02A3')
index_3_loading_prev$water <- as.factor('Wet')
names(index_3_loading_prev) <- c('prevalence','area','scenario','water')

index_3_cleaning_prev <- as.data.frame(NL_table_Index_3$cleaning_w3wed_prev[order(NL_table_Index_3$local_seed)])
index_3_cleaning_prev$area <- as.factor('cleaning')
index_3_cleaning_prev$scenario <- as.factor('XI_02A3')
index_3_cleaning_prev$water <- as.factor('Wet')
names(index_3_cleaning_prev) <- c('prevalence','area','scenario','water')

index_3_sorting_prev <- as.data.frame(NL_table_Index_3$sorting_w3wed_prev[order(NL_table_Index_3$local_seed)])
index_3_sorting_prev$area <- as.factor('sorting')
index_3_sorting_prev$scenario <- as.factor('XI_02A3')
index_3_sorting_prev$water <- as.factor('Dry')
names(index_3_sorting_prev) <- c('prevalence','area','scenario','water')

index_3_reject_prev <- as.data.frame(NL_table_Index_3$reject_w3wed_prev[order(NL_table_Index_3$local_seed)])
index_3_reject_prev$area <- as.factor('reject')
index_3_reject_prev$scenario <- as.factor('XI_02A3')
index_3_reject_prev$water <- as.factor('Dry')
names(index_3_reject_prev) <- c('prevalence','area','scenario','water')

index_3_tray_packing_prev <- as.data.frame(NL_table_Index_3$tray_packing_w3wed_prev[order(NL_table_Index_3$local_seed)])
index_3_tray_packing_prev$area <- as.factor('tray packing')
index_3_tray_packing_prev$scenario <- as.factor('XI_02A3')
index_3_tray_packing_prev$water <- as.factor('Dry')
names(index_3_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_3_other_prev <- as.data.frame(NL_table_Index_3$other_w3wed_prev[order(NL_table_Index_3$local_seed)])
index_3_other_prev$area <- as.factor('other')
index_3_other_prev$scenario <- as.factor('XI_02A3')
index_3_other_prev$water <- as.factor('Dry')
names(index_3_other_prev) <- c('prevalence','area','scenario','water')

index_3_w3wed_prev <- rbind(index_3_loading_prev,index_3_cleaning_prev,index_3_sorting_prev,index_3_tray_packing_prev,index_3_reject_prev,index_3_other_prev)

index_3_w3wed_wet_prev <- as.data.frame(index_3_loading_prev$prevalence*21/100+index_3_cleaning_prev$prevalence*28/100)/49*100
index_3_w3wed_wet_prev$scenario <- as.factor('XI_02A3')
index_3_w3wed_wet_prev$water <- as.factor('Wet')
names(index_3_w3wed_wet_prev) <- c('prevalence','scenario','water')

index_3_w3wed_dry_prev <- as.data.frame(index_3_sorting_prev$prevalence*20/100+index_3_reject_prev$prevalence*23/100+index_3_tray_packing_prev$prevalence*123/100+index_3_other_prev$prevalence*10/100)/176*100
index_3_w3wed_dry_prev$scenario <- as.factor('XI_02A3')
index_3_w3wed_dry_prev$water <- as.factor('Dry')
names(index_3_w3wed_dry_prev) <- c('prevalence','scenario','water')

index_3_w3wed_recombined_prev <- rbind(index_3_w3wed_wet_prev, index_3_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Index_3$loading_w4wed_conc_list
vector <- vector[vector!='[]']
index_3_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_loading_w4wed_conc_list <- append(index_3_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_loading_w4wed_conc_matrix <- matrix(unlist(index_3_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_3$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
index_3_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_cleaning_w4wed_conc_list <- append(index_3_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_cleaning_w4wed_conc_matrix <- matrix(unlist(index_3_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_3$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# index_3_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_3_drying_w4wed_conc_list <- append(index_3_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_3$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
index_3_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_sorting_w4wed_conc_list <- append(index_3_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_sorting_w4wed_conc_matrix <- matrix(unlist(index_3_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_3$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
index_3_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_tray_packing_w4wed_conc_list <- append(index_3_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_tray_packing_w4wed_conc_matrix <- matrix(unlist(index_3_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_3$reject_w4wed_conc_list
vector <- vector[vector!='[]']
index_3_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_reject_w4wed_conc_list <- append(index_3_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_reject_w4wed_conc_matrix <- matrix(unlist(index_3_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_3$other_w4wed_conc_list
vector <- vector[vector!='[]']
index_3_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_other_w4wed_conc_list <- append(index_3_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_other_w4wed_conc_matrix <- matrix(unlist(index_3_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

index_3_loading_concs <- as.data.frame(index_3_loading_w4wed_conc_list)
index_3_loading_concs$area <- as.factor('loading')
index_3_loading_concs$scenario <- as.factor('XI_02A3')
index_3_loading_concs$water <- as.factor('Wet')
names(index_3_loading_concs) <- c('concentration','area','scenario','water')

index_3_cleaning_concs <- as.data.frame(index_3_cleaning_w4wed_conc_list)
index_3_cleaning_concs$area <- as.factor('cleaning')
index_3_cleaning_concs$scenario <- as.factor('XI_02A3')
index_3_cleaning_concs$water <- as.factor('Wet')
names(index_3_cleaning_concs) <- c('concentration','area','scenario','water')

index_3_sorting_concs <- as.data.frame(index_3_sorting_w4wed_conc_list)
index_3_sorting_concs$area <- as.factor('sorting')
index_3_sorting_concs$scenario <- as.factor('XI_02A3')
index_3_sorting_concs$water <- as.factor('Dry')
names(index_3_sorting_concs) <- c('concentration','area','scenario','water')

index_3_reject_concs <- as.data.frame(index_3_reject_w4wed_conc_list)
index_3_reject_concs$area <- as.factor('reject')
index_3_reject_concs$scenario <- as.factor('XI_02A3')
index_3_reject_concs$water <- as.factor('Dry')
names(index_3_reject_concs) <- c('concentration','area','scenario','water')

index_3_tray_packing_concs <- as.data.frame(index_3_tray_packing_w4wed_conc_list)
index_3_tray_packing_concs$area <- as.factor('tray packing')
index_3_tray_packing_concs$scenario <- as.factor('XI_02A3')
index_3_tray_packing_concs$water <- as.factor('Dry')
names(index_3_tray_packing_concs) <- c('concentration','area','scenario','water')

index_3_other_concs <- as.data.frame(index_3_other_w4wed_conc_list)
index_3_other_concs$area <- as.factor('other')
index_3_other_concs$scenario <- as.factor('XI_02A3')
index_3_other_concs$water <- as.factor('Dry')
names(index_3_other_concs) <- c('concentration','area','scenario','water')

index_3_w4wed_concs <- rbind(index_3_loading_concs,index_3_cleaning_concs,index_3_sorting_concs,index_3_tray_packing_concs,index_3_reject_concs,index_3_other_concs)

index_3_loading_prev <- as.data.frame(NL_table_Index_3$loading_w4wed_prev[order(NL_table_Index_3$local_seed)])
index_3_loading_prev$area <- as.factor('loading')
index_3_loading_prev$scenario <- as.factor('XI_02A3')
index_3_loading_prev$water <- as.factor('Wet')
names(index_3_loading_prev) <- c('prevalence','area','scenario','water')

index_3_cleaning_prev <- as.data.frame(NL_table_Index_3$cleaning_w4wed_prev[order(NL_table_Index_3$local_seed)])
index_3_cleaning_prev$area <- as.factor('cleaning')
index_3_cleaning_prev$scenario <- as.factor('XI_02A3')
index_3_cleaning_prev$water <- as.factor('Wet')
names(index_3_cleaning_prev) <- c('prevalence','area','scenario','water')

index_3_sorting_prev <- as.data.frame(NL_table_Index_3$sorting_w4wed_prev[order(NL_table_Index_3$local_seed)])
index_3_sorting_prev$area <- as.factor('sorting')
index_3_sorting_prev$scenario <- as.factor('XI_02A3')
index_3_sorting_prev$water <- as.factor('Dry')
names(index_3_sorting_prev) <- c('prevalence','area','scenario','water')

index_3_reject_prev <- as.data.frame(NL_table_Index_3$reject_w4wed_prev[order(NL_table_Index_3$local_seed)])
index_3_reject_prev$area <- as.factor('reject')
index_3_reject_prev$scenario <- as.factor('XI_02A3')
index_3_reject_prev$water <- as.factor('Dry')
names(index_3_reject_prev) <- c('prevalence','area','scenario','water')

index_3_tray_packing_prev <- as.data.frame(NL_table_Index_3$tray_packing_w4wed_prev[order(NL_table_Index_3$local_seed)])
index_3_tray_packing_prev$area <- as.factor('tray packing')
index_3_tray_packing_prev$scenario <- as.factor('XI_02A3')
index_3_tray_packing_prev$water <- as.factor('Dry')
names(index_3_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_3_other_prev <- as.data.frame(NL_table_Index_3$other_w4wed_prev[order(NL_table_Index_3$local_seed)])
index_3_other_prev$area <- as.factor('other')
index_3_other_prev$scenario <- as.factor('XI_02A3')
index_3_other_prev$water <- as.factor('Dry')
names(index_3_other_prev) <- c('prevalence','area','scenario','water')

index_3_w4wed_prev <- rbind(index_3_loading_prev,index_3_cleaning_prev,index_3_sorting_prev,index_3_tray_packing_prev,index_3_reject_prev,index_3_other_prev)

index_3_w4wed_wet_prev <- as.data.frame(index_3_loading_prev$prevalence*21/100+index_3_cleaning_prev$prevalence*28/100)/49*100
index_3_w4wed_wet_prev$scenario <- as.factor('XI_02A3')
index_3_w4wed_wet_prev$water <- as.factor('Wet')
names(index_3_w4wed_wet_prev) <- c('prevalence','scenario','water')

index_3_w4wed_dry_prev <- as.data.frame(index_3_sorting_prev$prevalence*20/100+index_3_reject_prev$prevalence*23/100+index_3_tray_packing_prev$prevalence*123/100+index_3_other_prev$prevalence*10/100)/176*100
index_3_w4wed_dry_prev$scenario <- as.factor('XI_02A3')
index_3_w4wed_dry_prev$water <- as.factor('Dry')
names(index_3_w4wed_dry_prev) <- c('prevalence','scenario','water')

index_3_w4wed_recombined_prev <- rbind(index_3_w4wed_wet_prev, index_3_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Index_3$loading_w5wed_conc_list
vector <- vector[vector!='[]']
index_3_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_loading_w5wed_conc_list <- append(index_3_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_loading_w5wed_conc_matrix <- matrix(unlist(index_3_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_3$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
index_3_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_cleaning_w5wed_conc_list <- append(index_3_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_cleaning_w5wed_conc_matrix <- matrix(unlist(index_3_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_3$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# index_3_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_3_drying_w5wed_conc_list <- append(index_3_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_3$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
index_3_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_sorting_w5wed_conc_list <- append(index_3_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_sorting_w5wed_conc_matrix <- matrix(unlist(index_3_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_3$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
index_3_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_tray_packing_w5wed_conc_list <- append(index_3_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_tray_packing_w5wed_conc_matrix <- matrix(unlist(index_3_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_3$reject_w5wed_conc_list
vector <- vector[vector!='[]']
index_3_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_reject_w5wed_conc_list <- append(index_3_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_reject_w5wed_conc_matrix <- matrix(unlist(index_3_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_3$other_w5wed_conc_list
vector <- vector[vector!='[]']
index_3_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_other_w5wed_conc_list <- append(index_3_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_other_w5wed_conc_matrix <- matrix(unlist(index_3_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

index_3_loading_concs <- as.data.frame(index_3_loading_w5wed_conc_list)
index_3_loading_concs$area <- as.factor('loading')
index_3_loading_concs$scenario <- as.factor('XI_02A3')
index_3_loading_concs$water <- as.factor('Wet')
names(index_3_loading_concs) <- c('concentration','area','scenario','water')

index_3_cleaning_concs <- as.data.frame(index_3_cleaning_w5wed_conc_list)
index_3_cleaning_concs$area <- as.factor('cleaning')
index_3_cleaning_concs$scenario <- as.factor('XI_02A3')
index_3_cleaning_concs$water <- as.factor('Wet')
names(index_3_cleaning_concs) <- c('concentration','area','scenario','water')

index_3_sorting_concs <- as.data.frame(index_3_sorting_w5wed_conc_list)
index_3_sorting_concs$area <- as.factor('sorting')
index_3_sorting_concs$scenario <- as.factor('XI_02A3')
index_3_sorting_concs$water <- as.factor('Dry')
names(index_3_sorting_concs) <- c('concentration','area','scenario','water')

index_3_reject_concs <- as.data.frame(index_3_reject_w5wed_conc_list)
index_3_reject_concs$area <- as.factor('reject')
index_3_reject_concs$scenario <- as.factor('XI_02A3')
index_3_reject_concs$water <- as.factor('Dry')
names(index_3_reject_concs) <- c('concentration','area','scenario','water')

index_3_tray_packing_concs <- as.data.frame(index_3_tray_packing_w5wed_conc_list)
index_3_tray_packing_concs$area <- as.factor('tray packing')
index_3_tray_packing_concs$scenario <- as.factor('XI_02A3')
index_3_tray_packing_concs$water <- as.factor('Dry')
names(index_3_tray_packing_concs) <- c('concentration','area','scenario','water')

index_3_other_concs <- as.data.frame(index_3_other_w5wed_conc_list)
index_3_other_concs$area <- as.factor('other')
index_3_other_concs$scenario <- as.factor('XI_02A3')
index_3_other_concs$water <- as.factor('Dry')
names(index_3_other_concs) <- c('concentration','area','scenario','water')

index_3_w5wed_concs <- rbind(index_3_loading_concs,index_3_cleaning_concs,index_3_sorting_concs,index_3_tray_packing_concs,index_3_reject_concs,index_3_other_concs)

index_3_loading_prev <- as.data.frame(NL_table_Index_3$loading_w5wed_prev[order(NL_table_Index_3$local_seed)])
index_3_loading_prev$area <- as.factor('loading')
index_3_loading_prev$scenario <- as.factor('XI_02A3')
index_3_loading_prev$water <- as.factor('Wet')
names(index_3_loading_prev) <- c('prevalence','area','scenario','water')

index_3_cleaning_prev <- as.data.frame(NL_table_Index_3$cleaning_w5wed_prev[order(NL_table_Index_3$local_seed)])
index_3_cleaning_prev$area <- as.factor('cleaning')
index_3_cleaning_prev$scenario <- as.factor('XI_02A3')
index_3_cleaning_prev$water <- as.factor('Wet')
names(index_3_cleaning_prev) <- c('prevalence','area','scenario','water')

index_3_sorting_prev <- as.data.frame(NL_table_Index_3$sorting_w5wed_prev[order(NL_table_Index_3$local_seed)])
index_3_sorting_prev$area <- as.factor('sorting')
index_3_sorting_prev$scenario <- as.factor('XI_02A3')
index_3_sorting_prev$water <- as.factor('Dry')
names(index_3_sorting_prev) <- c('prevalence','area','scenario','water')

index_3_reject_prev <- as.data.frame(NL_table_Index_3$reject_w5wed_prev[order(NL_table_Index_3$local_seed)])
index_3_reject_prev$area <- as.factor('reject')
index_3_reject_prev$scenario <- as.factor('XI_02A3')
index_3_reject_prev$water <- as.factor('Dry')
names(index_3_reject_prev) <- c('prevalence','area','scenario','water')

index_3_tray_packing_prev <- as.data.frame(NL_table_Index_3$tray_packing_w5wed_prev[order(NL_table_Index_3$local_seed)])
index_3_tray_packing_prev$area <- as.factor('tray packing')
index_3_tray_packing_prev$scenario <- as.factor('XI_02A3')
index_3_tray_packing_prev$water <- as.factor('Dry')
names(index_3_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_3_other_prev <- as.data.frame(NL_table_Index_3$other_w5wed_prev[order(NL_table_Index_3$local_seed)])
index_3_other_prev$area <- as.factor('other')
index_3_other_prev$scenario <- as.factor('XI_02A3')
index_3_other_prev$water <- as.factor('Dry')
names(index_3_other_prev) <- c('prevalence','area','scenario','water')

index_3_w5wed_prev <- rbind(index_3_loading_prev,index_3_cleaning_prev,index_3_sorting_prev,index_3_tray_packing_prev,index_3_reject_prev,index_3_other_prev)

index_3_w5wed_wet_prev <- as.data.frame(index_3_loading_prev$prevalence*21/100+index_3_cleaning_prev$prevalence*28/100)/49*100
index_3_w5wed_wet_prev$scenario <- as.factor('XI_02A3')
index_3_w5wed_wet_prev$water <- as.factor('Wet')
names(index_3_w5wed_wet_prev) <- c('prevalence','scenario','water')

index_3_w5wed_dry_prev <- as.data.frame(index_3_sorting_prev$prevalence*20/100+index_3_reject_prev$prevalence*23/100+index_3_tray_packing_prev$prevalence*123/100+index_3_other_prev$prevalence*10/100)/176*100
index_3_w5wed_dry_prev$scenario <- as.factor('XI_02A3')
index_3_w5wed_dry_prev$water <- as.factor('Dry')
names(index_3_w5wed_dry_prev) <- c('prevalence','scenario','water')

index_3_w5wed_recombined_prev <- rbind(index_3_w5wed_wet_prev, index_3_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Index_3$loading_w6wed_conc_list
vector <- vector[vector!='[]']
index_3_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_loading_w6wed_conc_list <- append(index_3_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_loading_w6wed_conc_matrix <- matrix(unlist(index_3_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_3$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
index_3_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_cleaning_w6wed_conc_list <- append(index_3_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_cleaning_w6wed_conc_matrix <- matrix(unlist(index_3_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_3$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# index_3_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_3_drying_w6wed_conc_list <- append(index_3_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_3$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
index_3_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_sorting_w6wed_conc_list <- append(index_3_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_sorting_w6wed_conc_matrix <- matrix(unlist(index_3_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_3$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
index_3_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_tray_packing_w6wed_conc_list <- append(index_3_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_tray_packing_w6wed_conc_matrix <- matrix(unlist(index_3_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_3$reject_w6wed_conc_list
vector <- vector[vector!='[]']
index_3_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_reject_w6wed_conc_list <- append(index_3_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_reject_w6wed_conc_matrix <- matrix(unlist(index_3_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_3$other_w6wed_conc_list
vector <- vector[vector!='[]']
index_3_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_other_w6wed_conc_list <- append(index_3_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_other_w6wed_conc_matrix <- matrix(unlist(index_3_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

index_3_loading_concs <- as.data.frame(index_3_loading_w6wed_conc_list)
index_3_loading_concs$area <- as.factor('loading')
index_3_loading_concs$scenario <- as.factor('XI_02A3')
index_3_loading_concs$water <- as.factor('Wet')
names(index_3_loading_concs) <- c('concentration','area','scenario','water')

index_3_cleaning_concs <- as.data.frame(index_3_cleaning_w6wed_conc_list)
index_3_cleaning_concs$area <- as.factor('cleaning')
index_3_cleaning_concs$scenario <- as.factor('XI_02A3')
index_3_cleaning_concs$water <- as.factor('Wet')
names(index_3_cleaning_concs) <- c('concentration','area','scenario','water')

index_3_sorting_concs <- as.data.frame(index_3_sorting_w6wed_conc_list)
index_3_sorting_concs$area <- as.factor('sorting')
index_3_sorting_concs$scenario <- as.factor('XI_02A3')
index_3_sorting_concs$water <- as.factor('Dry')
names(index_3_sorting_concs) <- c('concentration','area','scenario','water')

index_3_reject_concs <- as.data.frame(index_3_reject_w6wed_conc_list)
index_3_reject_concs$area <- as.factor('reject')
index_3_reject_concs$scenario <- as.factor('XI_02A3')
index_3_reject_concs$water <- as.factor('Dry')
names(index_3_reject_concs) <- c('concentration','area','scenario','water')

index_3_tray_packing_concs <- as.data.frame(index_3_tray_packing_w6wed_conc_list)
index_3_tray_packing_concs$area <- as.factor('tray packing')
index_3_tray_packing_concs$scenario <- as.factor('XI_02A3')
index_3_tray_packing_concs$water <- as.factor('Dry')
names(index_3_tray_packing_concs) <- c('concentration','area','scenario','water')

index_3_other_concs <- as.data.frame(index_3_other_w6wed_conc_list)
index_3_other_concs$area <- as.factor('other')
index_3_other_concs$scenario <- as.factor('XI_02A3')
index_3_other_concs$water <- as.factor('Dry')
names(index_3_other_concs) <- c('concentration','area','scenario','water')

index_3_w6wed_concs <- rbind(index_3_loading_concs,index_3_cleaning_concs,index_3_sorting_concs,index_3_tray_packing_concs,index_3_reject_concs,index_3_other_concs)

index_3_loading_prev <- as.data.frame(NL_table_Index_3$loading_w6wed_prev[order(NL_table_Index_3$local_seed)])
index_3_loading_prev$area <- as.factor('loading')
index_3_loading_prev$scenario <- as.factor('XI_02A3')
index_3_loading_prev$water <- as.factor('Wet')
names(index_3_loading_prev) <- c('prevalence','area','scenario','water')

index_3_cleaning_prev <- as.data.frame(NL_table_Index_3$cleaning_w6wed_prev[order(NL_table_Index_3$local_seed)])
index_3_cleaning_prev$area <- as.factor('cleaning')
index_3_cleaning_prev$scenario <- as.factor('XI_02A3')
index_3_cleaning_prev$water <- as.factor('Wet')
names(index_3_cleaning_prev) <- c('prevalence','area','scenario','water')

index_3_sorting_prev <- as.data.frame(NL_table_Index_3$sorting_w6wed_prev[order(NL_table_Index_3$local_seed)])
index_3_sorting_prev$area <- as.factor('sorting')
index_3_sorting_prev$scenario <- as.factor('XI_02A3')
index_3_sorting_prev$water <- as.factor('Dry')
names(index_3_sorting_prev) <- c('prevalence','area','scenario','water')

index_3_reject_prev <- as.data.frame(NL_table_Index_3$reject_w6wed_prev[order(NL_table_Index_3$local_seed)])
index_3_reject_prev$area <- as.factor('reject')
index_3_reject_prev$scenario <- as.factor('XI_02A3')
index_3_reject_prev$water <- as.factor('Dry')
names(index_3_reject_prev) <- c('prevalence','area','scenario','water')

index_3_tray_packing_prev <- as.data.frame(NL_table_Index_3$tray_packing_w6wed_prev[order(NL_table_Index_3$local_seed)])
index_3_tray_packing_prev$area <- as.factor('tray packing')
index_3_tray_packing_prev$scenario <- as.factor('XI_02A3')
index_3_tray_packing_prev$water <- as.factor('Dry')
names(index_3_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_3_other_prev <- as.data.frame(NL_table_Index_3$other_w6wed_prev[order(NL_table_Index_3$local_seed)])
index_3_other_prev$area <- as.factor('other')
index_3_other_prev$scenario <- as.factor('XI_02A3')
index_3_other_prev$water <- as.factor('Dry')
names(index_3_other_prev) <- c('prevalence','area','scenario','water')

index_3_w6wed_prev <- rbind(index_3_loading_prev,index_3_cleaning_prev,index_3_sorting_prev,index_3_tray_packing_prev,index_3_reject_prev,index_3_other_prev)

index_3_w6wed_wet_prev <- as.data.frame(index_3_loading_prev$prevalence*21/100+index_3_cleaning_prev$prevalence*28/100)/49*100
index_3_w6wed_wet_prev$scenario <- as.factor('XI_02A3')
index_3_w6wed_wet_prev$water <- as.factor('Wet')
names(index_3_w6wed_wet_prev) <- c('prevalence','scenario','water')

index_3_w6wed_dry_prev <- as.data.frame(index_3_sorting_prev$prevalence*20/100+index_3_reject_prev$prevalence*23/100+index_3_tray_packing_prev$prevalence*123/100+index_3_other_prev$prevalence*10/100)/176*100
index_3_w6wed_dry_prev$scenario <- as.factor('XI_02A3')
index_3_w6wed_dry_prev$water <- as.factor('Dry')
names(index_3_w6wed_dry_prev) <- c('prevalence','scenario','water')

index_3_w6wed_recombined_prev <- rbind(index_3_w6wed_wet_prev, index_3_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Index_3$loading_w7wed_conc_list
vector <- vector[vector!='[]']
index_3_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_loading_w7wed_conc_list <- append(index_3_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_loading_w7wed_conc_matrix <- matrix(unlist(index_3_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_3$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
index_3_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_cleaning_w7wed_conc_list <- append(index_3_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_cleaning_w7wed_conc_matrix <- matrix(unlist(index_3_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_3$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# index_3_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_3_drying_w7wed_conc_list <- append(index_3_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_3$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
index_3_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_sorting_w7wed_conc_list <- append(index_3_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_sorting_w7wed_conc_matrix <- matrix(unlist(index_3_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_3$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
index_3_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_tray_packing_w7wed_conc_list <- append(index_3_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_tray_packing_w7wed_conc_matrix <- matrix(unlist(index_3_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_3$reject_w7wed_conc_list
vector <- vector[vector!='[]']
index_3_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_reject_w7wed_conc_list <- append(index_3_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_reject_w7wed_conc_matrix <- matrix(unlist(index_3_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_3$other_w7wed_conc_list
vector <- vector[vector!='[]']
index_3_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_other_w7wed_conc_list <- append(index_3_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_other_w7wed_conc_matrix <- matrix(unlist(index_3_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

index_3_loading_concs <- as.data.frame(index_3_loading_w7wed_conc_list)
index_3_loading_concs$area <- as.factor('loading')
index_3_loading_concs$scenario <- as.factor('XI_02A3')
index_3_loading_concs$water <- as.factor('Wet')
names(index_3_loading_concs) <- c('concentration','area','scenario','water')

index_3_cleaning_concs <- as.data.frame(index_3_cleaning_w7wed_conc_list)
index_3_cleaning_concs$area <- as.factor('cleaning')
index_3_cleaning_concs$scenario <- as.factor('XI_02A3')
index_3_cleaning_concs$water <- as.factor('Wet')
names(index_3_cleaning_concs) <- c('concentration','area','scenario','water')

index_3_sorting_concs <- as.data.frame(index_3_sorting_w7wed_conc_list)
index_3_sorting_concs$area <- as.factor('sorting')
index_3_sorting_concs$scenario <- as.factor('XI_02A3')
index_3_sorting_concs$water <- as.factor('Dry')
names(index_3_sorting_concs) <- c('concentration','area','scenario','water')

index_3_reject_concs <- as.data.frame(index_3_reject_w7wed_conc_list)
index_3_reject_concs$area <- as.factor('reject')
index_3_reject_concs$scenario <- as.factor('XI_02A3')
index_3_reject_concs$water <- as.factor('Dry')
names(index_3_reject_concs) <- c('concentration','area','scenario','water')

index_3_tray_packing_concs <- as.data.frame(index_3_tray_packing_w7wed_conc_list)
index_3_tray_packing_concs$area <- as.factor('tray packing')
index_3_tray_packing_concs$scenario <- as.factor('XI_02A3')
index_3_tray_packing_concs$water <- as.factor('Dry')
names(index_3_tray_packing_concs) <- c('concentration','area','scenario','water')

index_3_other_concs <- as.data.frame(index_3_other_w7wed_conc_list)
index_3_other_concs$area <- as.factor('other')
index_3_other_concs$scenario <- as.factor('XI_02A3')
index_3_other_concs$water <- as.factor('Dry')
names(index_3_other_concs) <- c('concentration','area','scenario','water')

index_3_w7wed_concs <- rbind(index_3_loading_concs,index_3_cleaning_concs,index_3_sorting_concs,index_3_tray_packing_concs,index_3_reject_concs,index_3_other_concs)

index_3_loading_prev <- as.data.frame(NL_table_Index_3$loading_w7wed_prev[order(NL_table_Index_3$local_seed)])
index_3_loading_prev$area <- as.factor('loading')
index_3_loading_prev$scenario <- as.factor('XI_02A3')
index_3_loading_prev$water <- as.factor('Wet')
names(index_3_loading_prev) <- c('prevalence','area','scenario','water')

index_3_cleaning_prev <- as.data.frame(NL_table_Index_3$cleaning_w7wed_prev[order(NL_table_Index_3$local_seed)])
index_3_cleaning_prev$area <- as.factor('cleaning')
index_3_cleaning_prev$scenario <- as.factor('XI_02A3')
index_3_cleaning_prev$water <- as.factor('Wet')
names(index_3_cleaning_prev) <- c('prevalence','area','scenario','water')

index_3_sorting_prev <- as.data.frame(NL_table_Index_3$sorting_w7wed_prev[order(NL_table_Index_3$local_seed)])
index_3_sorting_prev$area <- as.factor('sorting')
index_3_sorting_prev$scenario <- as.factor('XI_02A3')
index_3_sorting_prev$water <- as.factor('Dry')
names(index_3_sorting_prev) <- c('prevalence','area','scenario','water')

index_3_reject_prev <- as.data.frame(NL_table_Index_3$reject_w7wed_prev[order(NL_table_Index_3$local_seed)])
index_3_reject_prev$area <- as.factor('reject')
index_3_reject_prev$scenario <- as.factor('XI_02A3')
index_3_reject_prev$water <- as.factor('Dry')
names(index_3_reject_prev) <- c('prevalence','area','scenario','water')

index_3_tray_packing_prev <- as.data.frame(NL_table_Index_3$tray_packing_w7wed_prev[order(NL_table_Index_3$local_seed)])
index_3_tray_packing_prev$area <- as.factor('tray packing')
index_3_tray_packing_prev$scenario <- as.factor('XI_02A3')
index_3_tray_packing_prev$water <- as.factor('Dry')
names(index_3_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_3_other_prev <- as.data.frame(NL_table_Index_3$other_w7wed_prev[order(NL_table_Index_3$local_seed)])
index_3_other_prev$area <- as.factor('other')
index_3_other_prev$scenario <- as.factor('XI_02A3')
index_3_other_prev$water <- as.factor('Dry')
names(index_3_other_prev) <- c('prevalence','area','scenario','water')

index_3_w7wed_prev <- rbind(index_3_loading_prev,index_3_cleaning_prev,index_3_sorting_prev,index_3_tray_packing_prev,index_3_reject_prev,index_3_other_prev)

index_3_w7wed_wet_prev <- as.data.frame(index_3_loading_prev$prevalence*21/100+index_3_cleaning_prev$prevalence*28/100)/49*100
index_3_w7wed_wet_prev$scenario <- as.factor('XI_02A3')
index_3_w7wed_wet_prev$water <- as.factor('Wet')
names(index_3_w7wed_wet_prev) <- c('prevalence','scenario','water')

index_3_w7wed_dry_prev <- as.data.frame(index_3_sorting_prev$prevalence*20/100+index_3_reject_prev$prevalence*23/100+index_3_tray_packing_prev$prevalence*123/100+index_3_other_prev$prevalence*10/100)/176*100
index_3_w7wed_dry_prev$scenario <- as.factor('XI_02A3')
index_3_w7wed_dry_prev$water <- as.factor('Dry')
names(index_3_w7wed_dry_prev) <- c('prevalence','scenario','water')

index_3_w7wed_recombined_prev <- rbind(index_3_w7wed_wet_prev, index_3_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Index_3$loading_w8wed_conc_list
vector <- vector[vector!='[]']
index_3_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_loading_w8wed_conc_list <- append(index_3_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_loading_w8wed_conc_matrix <- matrix(unlist(index_3_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_3$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
index_3_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_cleaning_w8wed_conc_list <- append(index_3_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_cleaning_w8wed_conc_matrix <- matrix(unlist(index_3_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_3$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# index_3_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_3_drying_w8wed_conc_list <- append(index_3_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_3$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
index_3_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_sorting_w8wed_conc_list <- append(index_3_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_sorting_w8wed_conc_matrix <- matrix(unlist(index_3_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_3$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
index_3_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_tray_packing_w8wed_conc_list <- append(index_3_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_tray_packing_w8wed_conc_matrix <- matrix(unlist(index_3_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_3$reject_w8wed_conc_list
vector <- vector[vector!='[]']
index_3_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_reject_w8wed_conc_list <- append(index_3_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_reject_w8wed_conc_matrix <- matrix(unlist(index_3_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_3$other_w8wed_conc_list
vector <- vector[vector!='[]']
index_3_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_3_other_w8wed_conc_list <- append(index_3_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_3_other_w8wed_conc_matrix <- matrix(unlist(index_3_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

index_3_loading_concs <- as.data.frame(index_3_loading_w8wed_conc_list)
index_3_loading_concs$area <- as.factor('loading')
index_3_loading_concs$scenario <- as.factor('XI_02A3')
index_3_loading_concs$water <- as.factor('Wet')
names(index_3_loading_concs) <- c('concentration','area','scenario','water')

index_3_cleaning_concs <- as.data.frame(index_3_cleaning_w8wed_conc_list)
index_3_cleaning_concs$area <- as.factor('cleaning')
index_3_cleaning_concs$scenario <- as.factor('XI_02A3')
index_3_cleaning_concs$water <- as.factor('Wet')
names(index_3_cleaning_concs) <- c('concentration','area','scenario','water')

index_3_sorting_concs <- as.data.frame(index_3_sorting_w8wed_conc_list)
index_3_sorting_concs$area <- as.factor('sorting')
index_3_sorting_concs$scenario <- as.factor('XI_02A3')
index_3_sorting_concs$water <- as.factor('Dry')
names(index_3_sorting_concs) <- c('concentration','area','scenario','water')

index_3_reject_concs <- as.data.frame(index_3_reject_w8wed_conc_list)
index_3_reject_concs$area <- as.factor('reject')
index_3_reject_concs$scenario <- as.factor('XI_02A3')
index_3_reject_concs$water <- as.factor('Dry')
names(index_3_reject_concs) <- c('concentration','area','scenario','water')

index_3_tray_packing_concs <- as.data.frame(index_3_tray_packing_w8wed_conc_list)
index_3_tray_packing_concs$area <- as.factor('tray packing')
index_3_tray_packing_concs$scenario <- as.factor('XI_02A3')
index_3_tray_packing_concs$water <- as.factor('Dry')
names(index_3_tray_packing_concs) <- c('concentration','area','scenario','water')

index_3_other_concs <- as.data.frame(index_3_other_w8wed_conc_list)
index_3_other_concs$area <- as.factor('other')
index_3_other_concs$scenario <- as.factor('XI_02A3')
index_3_other_concs$water <- as.factor('Dry')
names(index_3_other_concs) <- c('concentration','area','scenario','water')

index_3_w8wed_concs <- rbind(index_3_loading_concs,index_3_cleaning_concs,index_3_sorting_concs,index_3_tray_packing_concs,index_3_reject_concs,index_3_other_concs)

index_3_loading_prev <- as.data.frame(NL_table_Index_3$loading_w8wed_prev[order(NL_table_Index_3$local_seed)])
index_3_loading_prev$area <- as.factor('loading')
index_3_loading_prev$scenario <- as.factor('XI_02A3')
index_3_loading_prev$water <- as.factor('Wet')
names(index_3_loading_prev) <- c('prevalence','area','scenario','water')

index_3_cleaning_prev <- as.data.frame(NL_table_Index_3$cleaning_w8wed_prev[order(NL_table_Index_3$local_seed)])
index_3_cleaning_prev$area <- as.factor('cleaning')
index_3_cleaning_prev$scenario <- as.factor('XI_02A3')
index_3_cleaning_prev$water <- as.factor('Wet')
names(index_3_cleaning_prev) <- c('prevalence','area','scenario','water')

index_3_sorting_prev <- as.data.frame(NL_table_Index_3$sorting_w8wed_prev[order(NL_table_Index_3$local_seed)])
index_3_sorting_prev$area <- as.factor('sorting')
index_3_sorting_prev$scenario <- as.factor('XI_02A3')
index_3_sorting_prev$water <- as.factor('Dry')
names(index_3_sorting_prev) <- c('prevalence','area','scenario','water')

index_3_reject_prev <- as.data.frame(NL_table_Index_3$reject_w8wed_prev[order(NL_table_Index_3$local_seed)])
index_3_reject_prev$area <- as.factor('reject')
index_3_reject_prev$scenario <- as.factor('XI_02A3')
index_3_reject_prev$water <- as.factor('Dry')
names(index_3_reject_prev) <- c('prevalence','area','scenario','water')

index_3_tray_packing_prev <- as.data.frame(NL_table_Index_3$tray_packing_w8wed_prev[order(NL_table_Index_3$local_seed)])
index_3_tray_packing_prev$area <- as.factor('tray packing')
index_3_tray_packing_prev$scenario <- as.factor('XI_02A3')
index_3_tray_packing_prev$water <- as.factor('Dry')
names(index_3_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_3_other_prev <- as.data.frame(NL_table_Index_3$other_w8wed_prev[order(NL_table_Index_3$local_seed)])
index_3_other_prev$area <- as.factor('other')
index_3_other_prev$scenario <- as.factor('XI_02A3')
index_3_other_prev$water <- as.factor('Dry')
names(index_3_other_prev) <- c('prevalence','area','scenario','water')

index_3_w8wed_prev <- rbind(index_3_loading_prev,index_3_cleaning_prev,index_3_sorting_prev,index_3_tray_packing_prev,index_3_reject_prev,index_3_other_prev)

index_3_w8wed_wet_prev <- as.data.frame(index_3_loading_prev$prevalence*21/100+index_3_cleaning_prev$prevalence*28/100)/49*100
index_3_w8wed_wet_prev$scenario <- as.factor('XI_02A3')
index_3_w8wed_wet_prev$water <- as.factor('Wet')
names(index_3_w8wed_wet_prev) <- c('prevalence','scenario','water')

index_3_w8wed_dry_prev <- as.data.frame(index_3_sorting_prev$prevalence*20/100+index_3_reject_prev$prevalence*23/100+index_3_tray_packing_prev$prevalence*123/100+index_3_other_prev$prevalence*10/100)/176*100
index_3_w8wed_dry_prev$scenario <- as.factor('XI_02A3')
index_3_w8wed_dry_prev$water <- as.factor('Dry')
names(index_3_w8wed_dry_prev) <- c('prevalence','scenario','water')

index_3_w8wed_recombined_prev <- rbind(index_3_w8wed_wet_prev, index_3_w8wed_dry_prev)

index_3_w1wed_prev$week <- as.factor(1)
index_3_w2wed_prev$week <- as.factor(2)
index_3_w3wed_prev$week <- as.factor(3)
index_3_w4wed_prev$week <- as.factor(4)
index_3_w5wed_prev$week <- as.factor(5)
index_3_w6wed_prev$week <- as.factor(6)
index_3_w7wed_prev$week <- as.factor(7)
index_3_w8wed_prev$week <- as.factor(8)

index_3_w1wed_recombined_prev$week <- as.factor(1)
index_3_w2wed_recombined_prev$week <- as.factor(2)
index_3_w3wed_recombined_prev$week <- as.factor(3)
index_3_w4wed_recombined_prev$week <- as.factor(4)
index_3_w5wed_recombined_prev$week <- as.factor(5)
index_3_w6wed_recombined_prev$week <- as.factor(6)
index_3_w7wed_recombined_prev$week <- as.factor(7)
index_3_w8wed_recombined_prev$week <- as.factor(8)
index_3_allwed_prev <- rbind(index_3_w1wed_recombined_prev,index_3_w2wed_recombined_prev,index_3_w3wed_recombined_prev,index_3_w4wed_recombined_prev,index_3_w5wed_recombined_prev,index_3_w6wed_recombined_prev,index_3_w7wed_recombined_prev,index_3_w8wed_recombined_prev)

vector <- NL_table_Index_3$lifetime_conc_list[order(NL_table_Index_3$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

index_3_w1wed_recombined_prev$week <- as.factor(1)
index_3_w2wed_recombined_prev$week <- as.factor(2)
index_3_w3wed_recombined_prev$week <- as.factor(3)
index_3_w4wed_recombined_prev$week <- as.factor(4)
index_3_w5wed_recombined_prev$week <- as.factor(5)
index_3_w6wed_recombined_prev$week <- as.factor(6)
index_3_w7wed_recombined_prev$week <- as.factor(7)
index_3_w8wed_recombined_prev$week <- as.factor(8)
index_3_allwed_prev <- rbind(index_3_w1wed_recombined_prev,index_3_w2wed_recombined_prev,index_3_w3wed_recombined_prev,index_3_w4wed_recombined_prev,index_3_w5wed_recombined_prev,index_3_w6wed_recombined_prev,index_3_w7wed_recombined_prev,index_3_w8wed_recombined_prev)

Facility_B_index_3_agents_melted <- melt(mdarray)
colnames(Facility_B_index_3_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_index_3_agents_melted$agent <- Facility_B_index_3_agents_melted$agent-1
Facility_B_index_3_agents_melted$logical <- Facility_B_index_3_agents_melted$value>0
Facility_B_index_3_agents_melted$binary <- as.numeric(Facility_B_index_3_agents_melted$logical)
Facility_B_index_3_agents_melted$log10value <- log10(Facility_B_index_3_agents_melted$value)
Facility_B_index_3_agents_melted$log10value[is.infinite(Facility_B_index_3_agents_melted$log10value)] <- 0

agent <- Facility_B_index_3_agents_melted$agent
iteration <- Facility_B_index_3_agents_melted$iteration
tick <- Facility_B_index_3_agents_melted$tick
rle_matrix <- tapply(Facility_B_index_3_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_partial_prob_intervention_mean_value_matrix <- tapply(Facility_B_index_3_agents_melted$value, list(agent, tick), mean)
Facility_B_index_3_median_value_matrix <- tapply(Facility_B_index_3_agents_melted$value, list(agent, tick), median)
x <- Facility_B_index_3_agents_melted
x$value[x$value==0] <- NA
Facility_B_index_3_pos_median_value_matrix <- tapply(x$value, list(agent, tick), median, na.rm=TRUE)
Facility_B_index_3_prob_value_matrix <- tapply(Facility_B_index_3_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

#Maximum sensitivity####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_index_3 <- durations

agents_list_index_3 <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_index_3 <- agents_list_index_3[,c("V1","V7","V8","V9")]
colnames(agents_list_index_3) <- c("name","sanitation_status","schedule","area")
#Time to persistence
agents_list_index_3$time_to_persistence <- rep((168*2),225)
agents_list_index_3$time_to_persistence[agents_list_index_3$schedule=="daily"] <- (24*2)

persistent_short_durations_list_index_3 <- data.frame()
persistent_long_durations_list_index_3 <- data.frame()
persistent_uncleanable_durations_list_index_3 <- data.frame()
transient_short_durations_list_index_3 <- data.frame()
transient_long_durations_list_index_3 <- data.frame()
transient_uncleanable_durations_list_index_3 <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_index_3$min_duration[agent] <- ifelse(length(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent])==0,NA,min(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_index_3$mean_duration[agent] <- ifelse(length(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent])==0,NA,mean(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_index_3$median_duration[agent] <- ifelse(length(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent])==0,NA,median(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_index_3$max_duration[agent] <- ifelse(length(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent])==0,NA,max(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_index_3$contamination_events[agent] <- sum(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_index_3$times_persistent[agent] <- sum(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent]>agents_list_index_3$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_index_3$q1_duration[agent] <- quantile(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_index_3$q3_duration[agent] <- quantile(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_index_3$min_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent])==0) || (agents_list_index_3$times_persistent[agent]==0),NA,min(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent & Facility_B_durations_index_3$duration>=agents_list_index_3$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_index_3$mean_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent])==0) || (agents_list_index_3$times_persistent[agent]==0),NA,mean(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent & Facility_B_durations_index_3$duration>=agents_list_index_3$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_index_3$median_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent])==0) || (agents_list_index_3$times_persistent[agent]==0),NA,median(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent & Facility_B_durations_index_3$duration>=agents_list_index_3$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_index_3$max_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent])==0) || (agents_list_index_3$times_persistent[agent]==0),NA,max(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent & Facility_B_durations_index_3$duration>=agents_list_index_3$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_index_3$q1_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent])==0) || (agents_list_index_3$times_persistent[agent]==0),NA,quantile(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent & Facility_B_durations_index_3$duration>=agents_list_index_3$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_index_3$q3_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent])==0) || (agents_list_index_3$times_persistent[agent]==0),NA,quantile(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent & Facility_B_durations_index_3$duration>=agents_list_index_3$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations
  x <- Facility_B_durations_index_3[which(Facility_B_durations_index_3$agent==agent & Facility_B_durations_index_3$duration>agents_list_index_3$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean
  agents_list_index_3$mean_times_persistent[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_index_3$mean_times_persistent[which(is.na(agents_list_index_3$mean_times_persistent))] <- 0
  #Division by total number of iterations in simulation
  agents_list_index_3$balanced_times_persistent[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_index_3$duration[Facility_B_durations_index_3$agent==agent])!=0) || (agents_list_index_3$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_index_3$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_index_3 <- rbind(
        persistent_short_durations_list_index_3,
        Facility_B_durations_index_3[Facility_B_durations_index_3$agent==agent & Facility_B_durations_index_3$duration>agents_list_index_3$time_to_persistence[agent],]
      )
    } else if(agents_list_index_3$time_to_persistence[agent]==336 && agents_list_index_3$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_index_3 <- rbind(
        persistent_long_durations_list_index_3,
        Facility_B_durations_index_3[Facility_B_durations_index_3$agent==agent & Facility_B_durations_index_3$duration>agents_list_index_3$time_to_persistence[agent],]
      )
    } else if(agents_list_index_3$time_to_persistence[agent]==336 && agents_list_index_3$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_index_3 <- rbind(
        persistent_uncleanable_durations_list_index_3,
        Facility_B_durations_index_3[Facility_B_durations_index_3$agent==agent & Facility_B_durations_index_3$duration>agents_list_index_3$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_index_3$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_index_3 <- rbind(
      transient_short_durations_list_index_3,
      Facility_B_durations_index_3[Facility_B_durations_index_3$agent==agent & Facility_B_durations_index_3$duration<=agents_list_index_3$time_to_persistence[agent],]
    )
  } else if(agents_list_index_3$time_to_persistence[agent]==336 && agents_list_index_3$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_index_3 <- rbind(
      transient_long_durations_list_index_3,
      Facility_B_durations_index_3[Facility_B_durations_index_3$agent==agent & Facility_B_durations_index_3$duration<=agents_list_index_3$time_to_persistence[agent],]
    )
  } else if(agents_list_index_3$time_to_persistence[agent]==336 && agents_list_index_3$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_index_3 <- rbind(
      transient_uncleanable_durations_list_index_3,
      Facility_B_durations_index_3[Facility_B_durations_index_3$agent==agent & Facility_B_durations_index_3$duration<=agents_list_index_3$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

#10 cells minimum####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>9)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_index_3_10min <- durations

persistent_short_durations_list_index_3_10min <- data.frame()
persistent_long_durations_list_index_3_10min <- data.frame()
persistent_uncleanable_durations_list_index_3_10min <- data.frame()
transient_short_durations_list_index_3_10min <- data.frame()
transient_long_durations_list_index_3_10min <- data.frame()
transient_uncleanable_durations_list_index_3_10min <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_index_3$min_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent])==0,NA,min(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_index_3$mean_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent])==0,NA,mean(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_index_3$median_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent])==0,NA,median(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_index_3$max_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent])==0,NA,max(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_index_3$contamination_events_10min[agent] <- sum(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_index_3$times_persistent_10min[agent] <- sum(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent]>agents_list_index_3$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_index_3$q1_duration_10min[agent] <- quantile(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_index_3$q3_duration_10min[agent] <- quantile(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_index_3$min_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent])==0) || (agents_list_index_3$times_persistent_10min[agent]==0),NA,min(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent & Facility_B_durations_index_3_10min$duration>=agents_list_index_3$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_index_3$mean_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent])==0) || (agents_list_index_3$times_persistent_10min[agent]==0),NA,mean(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent & Facility_B_durations_index_3_10min$duration>=agents_list_index_3$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_index_3$median_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent])==0) || (agents_list_index_3$times_persistent_10min[agent]==0),NA,median(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent & Facility_B_durations_index_3_10min$duration>=agents_list_index_3$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_index_3$max_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent])==0) || (agents_list_index_3$times_persistent_10min[agent]==0),NA,max(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent & Facility_B_durations_index_3_10min$duration>=agents_list_index_3$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_index_3$q1_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent])==0) || (agents_list_index_3$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent & Facility_B_durations_index_3_10min$duration>=agents_list_index_3$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_index_3$q3_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent])==0) || (agents_list_index_3$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent & Facility_B_durations_index_3_10min$duration>=agents_list_index_3$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations (Does not account for iterations with 0 events)
  x <- Facility_B_durations_index_3_10min[which(Facility_B_durations_index_3_10min$agent==agent & Facility_B_durations_index_3_10min$duration>agents_list_index_3$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean (Does account for iterations with 0 events)
  agents_list_index_3$mean_times_persistent_10min[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_index_3$mean_times_persistent_10min[which(is.na(agents_list_index_3$mean_times_persistent_10min))] <- 0
  #Division by total number of iterations in simulation
  agents_list_index_3$balanced_times_persistent_10min[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_index_3_10min$duration[Facility_B_durations_index_3_10min$agent==agent])!=0) || (agents_list_index_3$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_index_3$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_index_3_10min <- rbind(
        persistent_short_durations_list_index_3_10min,
        Facility_B_durations_index_3_10min[Facility_B_durations_index_3_10min$agent==agent & Facility_B_durations_index_3_10min$duration>agents_list_index_3$time_to_persistence[agent],]
      )
    } else if(agents_list_index_3$time_to_persistence[agent]==336 && agents_list_index_3$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_index_3_10min <- rbind(
        persistent_long_durations_list_index_3_10min,
        Facility_B_durations_index_3_10min[Facility_B_durations_index_3_10min$agent==agent & Facility_B_durations_index_3_10min$duration>agents_list_index_3$time_to_persistence[agent],]
      )
    } else if(agents_list_index_3$time_to_persistence[agent]==336 && agents_list_index_3$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_index_3_10min <- rbind(
        persistent_uncleanable_durations_list_index_3_10min,
        Facility_B_durations_index_3_10min[Facility_B_durations_index_3_10min$agent==agent & Facility_B_durations_index_3_10min$duration>agents_list_index_3$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_index_3$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_index_3_10min <- rbind(
      transient_short_durations_list_index_3_10min,
      Facility_B_durations_index_3_10min[Facility_B_durations_index_3_10min$agent==agent & Facility_B_durations_index_3_10min$duration<=agents_list_index_3$time_to_persistence[agent],]
    )
  } else if(agents_list_index_3$time_to_persistence[agent]==336 && agents_list_index_3$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_index_3_10min <- rbind(
      transient_long_durations_list_index_3_10min,
      Facility_B_durations_index_3_10min[Facility_B_durations_index_3_10min$agent==agent & Facility_B_durations_index_3_10min$duration<=agents_list_index_3$time_to_persistence[agent],]
    )
  } else if(agents_list_index_3$time_to_persistence[agent]==336 && agents_list_index_3$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_index_3_10min <- rbind(
      transient_uncleanable_durations_list_index_3_10min,
      Facility_B_durations_index_3_10min[Facility_B_durations_index_3_10min$agent==agent & Facility_B_durations_index_3_10min$duration<=agents_list_index_3$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}
        
# Facility_B_index_3_agents_melted_monday_preop <- Facility_B_index_3_agents_melted[which(Facility_B_index_3_agents_melted$tick==33|Facility_B_index_3_agents_melted$tick==201|Facility_B_index_3_agents_melted$tick==369|Facility_B_index_3_agents_melted$tick==537|Facility_B_index_3_agents_melted$tick==705|Facility_B_index_3_agents_melted$tick==873|Facility_B_index_3_agents_melted$tick==1041|Facility_B_index_3_agents_melted$tick==1209),]
# 
# Facility_B_index_3_agents_melted_tuesday_preop <- Facility_B_index_3_agents_melted[which(Facility_B_index_3_agents_melted$tick==57|Facility_B_index_3_agents_melted$tick==225|Facility_B_index_3_agents_melted$tick==393|Facility_B_index_3_agents_melted$tick==561|Facility_B_index_3_agents_melted$tick==729|Facility_B_index_3_agents_melted$tick==897|Facility_B_index_3_agents_melted$tick==1065|Facility_B_index_3_agents_melted$tick==1233),]
# 
# Facility_B_index_3_agents_melted_wednesday_preop <- Facility_B_index_3_agents_melted[which(Facility_B_index_3_agents_melted$tick==81|Facility_B_index_3_agents_melted$tick==249|Facility_B_index_3_agents_melted$tick==417|Facility_B_index_3_agents_melted$tick==585|Facility_B_index_3_agents_melted$tick==753|Facility_B_index_3_agents_melted$tick==921|Facility_B_index_3_agents_melted$tick==1089|Facility_B_index_3_agents_melted$tick==1257),]
# 
# Facility_B_index_3_agents_melted_thursday_preop <- Facility_B_index_3_agents_melted[which(Facility_B_index_3_agents_melted$tick==105|Facility_B_index_3_agents_melted$tick==273|Facility_B_index_3_agents_melted$tick==441|Facility_B_index_3_agents_melted$tick==609|Facility_B_index_3_agents_melted$tick==777|Facility_B_index_3_agents_melted$tick==945|Facility_B_index_3_agents_melted$tick==1113|Facility_B_index_3_agents_melted$tick==1281),]
# 
# Facility_B_index_3_agents_melted_friday_preop <- Facility_B_index_3_agents_melted[which(Facility_B_index_3_agents_melted$tick==129|Facility_B_index_3_agents_melted$tick==297|Facility_B_index_3_agents_melted$tick==465|Facility_B_index_3_agents_melted$tick==633|Facility_B_index_3_agents_melted$tick==801|Facility_B_index_3_agents_melted$tick==969|Facility_B_index_3_agents_melted$tick==1137|Facility_B_index_3_agents_melted$tick==1305),]

Facility_B_index_3_agents_melted_ff <- as.ffdf(Facility_B_index_3_agents_melted)
rm(Facility_B_index_3_agents_melted)
gc()
```
        
```{r import Index Case 4}
NL_table_Index_4 <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-25-11-09 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Pre_Contamination-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Index_4 <- NL_table_Index_4[NL_table_Index_4$scenario==54,]

while (any(grepl('-', names(NL_table_Index_4), fixed = TRUE))) {
  NL_table_Index_4 <- NL_table_Index_4 %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Index_4), fixed = TRUE))) {
  NL_table_Index_4 <- NL_table_Index_4 %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Index_4), fixed = TRUE))) {
  NL_table_Index_4 <- NL_table_Index_4 %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Index_4), fixed = TRUE))) {
  NL_table_Index_4 <- NL_table_Index_4 %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Index_4[ , ..list_columns]

NL_table_Index_4[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Index_4 <- as.data.frame(NL_table_Index_4)

NL_table_Index_4[NL_table_Index_4==-1] <- NA

NL_table_Index_4 <- subset(NL_table_Index_4, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Index_4)[names(NL_table_Index_4)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Index_4)[names(NL_table_Index_4)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Index_4$loading_w1wed_conc_list
vector <- vector[vector!='[]']
index_4_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_loading_w1wed_conc_list <- append(index_4_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_loading_w1wed_conc_matrix <- matrix(unlist(index_4_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_4$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
index_4_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_cleaning_w1wed_conc_list <- append(index_4_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_cleaning_w1wed_conc_matrix <- matrix(unlist(index_4_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_4$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# index_4_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_4_drying_w1wed_conc_list <- append(index_4_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_4$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
index_4_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_sorting_w1wed_conc_list <- append(index_4_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_sorting_w1wed_conc_matrix <- matrix(unlist(index_4_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_4$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
index_4_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_tray_packing_w1wed_conc_list <- append(index_4_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_tray_packing_w1wed_conc_matrix <- matrix(unlist(index_4_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_4$reject_w1wed_conc_list
vector <- vector[vector!='[]']
index_4_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_reject_w1wed_conc_list <- append(index_4_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_reject_w1wed_conc_matrix <- matrix(unlist(index_4_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_4$other_w1wed_conc_list
vector <- vector[vector!='[]']
index_4_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_other_w1wed_conc_list <- append(index_4_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_other_w1wed_conc_matrix <- matrix(unlist(index_4_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

index_4_loading_concs <- as.data.frame(index_4_loading_w1wed_conc_list)
index_4_loading_concs$area <- as.factor('loading')
index_4_loading_concs$scenario <- as.factor('XI_02A4')
index_4_loading_concs$water <- as.factor('Wet')
names(index_4_loading_concs) <- c('concentration','area','scenario','water')

index_4_cleaning_concs <- as.data.frame(index_4_cleaning_w1wed_conc_list)
index_4_cleaning_concs$area <- as.factor('cleaning')
index_4_cleaning_concs$scenario <- as.factor('XI_02A4')
index_4_cleaning_concs$water <- as.factor('Wet')
names(index_4_cleaning_concs) <- c('concentration','area','scenario','water')

index_4_sorting_concs <- as.data.frame(index_4_sorting_w1wed_conc_list)
index_4_sorting_concs$area <- as.factor('sorting')
index_4_sorting_concs$scenario <- as.factor('XI_02A4')
index_4_sorting_concs$water <- as.factor('Dry')
names(index_4_sorting_concs) <- c('concentration','area','scenario','water')

index_4_reject_concs <- as.data.frame(index_4_reject_w1wed_conc_list)
index_4_reject_concs$area <- as.factor('reject')
index_4_reject_concs$scenario <- as.factor('XI_02A4')
index_4_reject_concs$water <- as.factor('Dry')
names(index_4_reject_concs) <- c('concentration','area','scenario','water')

index_4_tray_packing_concs <- as.data.frame(index_4_tray_packing_w1wed_conc_list)
index_4_tray_packing_concs$area <- as.factor('tray packing')
index_4_tray_packing_concs$scenario <- as.factor('XI_02A4')
index_4_tray_packing_concs$water <- as.factor('Dry')
names(index_4_tray_packing_concs) <- c('concentration','area','scenario','water')

index_4_other_concs <- as.data.frame(index_4_other_w1wed_conc_list)
index_4_other_concs$area <- as.factor('other')
index_4_other_concs$scenario <- as.factor('XI_02A4')
index_4_other_concs$water <- as.factor('Dry')
names(index_4_other_concs) <- c('concentration','area','scenario','water')

index_4_w1wed_concs <- rbind(index_4_loading_concs,index_4_cleaning_concs,index_4_sorting_concs,index_4_tray_packing_concs,index_4_reject_concs,index_4_other_concs)

index_4_loading_prev <- as.data.frame(NL_table_Index_4$loading_w1wed_prev[order(NL_table_Index_4$local_seed)])
index_4_loading_prev$area <- as.factor('loading')
index_4_loading_prev$scenario <- as.factor('XI_02A4')
index_4_loading_prev$water <- as.factor('Wet')
names(index_4_loading_prev) <- c('prevalence','area','scenario','water')

index_4_cleaning_prev <- as.data.frame(NL_table_Index_4$cleaning_w1wed_prev[order(NL_table_Index_4$local_seed)])
index_4_cleaning_prev$area <- as.factor('cleaning')
index_4_cleaning_prev$scenario <- as.factor('XI_02A4')
index_4_cleaning_prev$water <- as.factor('Wet')
names(index_4_cleaning_prev) <- c('prevalence','area','scenario','water')

index_4_sorting_prev <- as.data.frame(NL_table_Index_4$sorting_w1wed_prev[order(NL_table_Index_4$local_seed)])
index_4_sorting_prev$area <- as.factor('sorting')
index_4_sorting_prev$scenario <- as.factor('XI_02A4')
index_4_sorting_prev$water <- as.factor('Dry')
names(index_4_sorting_prev) <- c('prevalence','area','scenario','water')

index_4_reject_prev <- as.data.frame(NL_table_Index_4$reject_w1wed_prev[order(NL_table_Index_4$local_seed)])
index_4_reject_prev$area <- as.factor('reject')
index_4_reject_prev$scenario <- as.factor('XI_02A4')
index_4_reject_prev$water <- as.factor('Dry')
names(index_4_reject_prev) <- c('prevalence','area','scenario','water')

index_4_tray_packing_prev <- as.data.frame(NL_table_Index_4$tray_packing_w1wed_prev[order(NL_table_Index_4$local_seed)])
index_4_tray_packing_prev$area <- as.factor('tray packing')
index_4_tray_packing_prev$scenario <- as.factor('XI_02A4')
index_4_tray_packing_prev$water <- as.factor('Dry')
names(index_4_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_4_other_prev <- as.data.frame(NL_table_Index_4$other_w1wed_prev[order(NL_table_Index_4$local_seed)])
index_4_other_prev$area <- as.factor('other')
index_4_other_prev$scenario <- as.factor('XI_02A4')
index_4_other_prev$water <- as.factor('Dry')
names(index_4_other_prev) <- c('prevalence','area','scenario','water')

index_4_w1wed_prev <- rbind(index_4_loading_prev,index_4_cleaning_prev,index_4_sorting_prev,index_4_tray_packing_prev,index_4_reject_prev,index_4_other_prev)

index_4_w1wed_wet_prev <- as.data.frame(index_4_loading_prev$prevalence*21/100+index_4_cleaning_prev$prevalence*28/100)/49*100
index_4_w1wed_wet_prev$scenario <- as.factor('XI_02A4')
index_4_w1wed_wet_prev$water <- as.factor('Wet')
names(index_4_w1wed_wet_prev) <- c('prevalence','scenario','water')

index_4_w1wed_dry_prev <- as.data.frame(index_4_sorting_prev$prevalence*20/100+index_4_reject_prev$prevalence*23/100+index_4_tray_packing_prev$prevalence*123/100+index_4_other_prev$prevalence*10/100)/176*100
index_4_w1wed_dry_prev$scenario <- as.factor('XI_02A4')
index_4_w1wed_dry_prev$water <- as.factor('Dry')
names(index_4_w1wed_dry_prev) <- c('prevalence','scenario','water')

index_4_w1wed_recombined_prev <- rbind(index_4_w1wed_wet_prev, index_4_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Index_4$loading_w2wed_conc_list
vector <- vector[vector!='[]']
index_4_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_loading_w2wed_conc_list <- append(index_4_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_loading_w2wed_conc_matrix <- matrix(unlist(index_4_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_4$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
index_4_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_cleaning_w2wed_conc_list <- append(index_4_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_cleaning_w2wed_conc_matrix <- matrix(unlist(index_4_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_4$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# index_4_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_4_drying_w2wed_conc_list <- append(index_4_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_4$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
index_4_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_sorting_w2wed_conc_list <- append(index_4_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_sorting_w2wed_conc_matrix <- matrix(unlist(index_4_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_4$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
index_4_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_tray_packing_w2wed_conc_list <- append(index_4_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_tray_packing_w2wed_conc_matrix <- matrix(unlist(index_4_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_4$reject_w2wed_conc_list
vector <- vector[vector!='[]']
index_4_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_reject_w2wed_conc_list <- append(index_4_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_reject_w2wed_conc_matrix <- matrix(unlist(index_4_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_4$other_w2wed_conc_list
vector <- vector[vector!='[]']
index_4_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_other_w2wed_conc_list <- append(index_4_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_other_w2wed_conc_matrix <- matrix(unlist(index_4_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

index_4_loading_concs <- as.data.frame(index_4_loading_w2wed_conc_list)
index_4_loading_concs$area <- as.factor('loading')
index_4_loading_concs$scenario <- as.factor('XI_02A4')
index_4_loading_concs$water <- as.factor('Wet')
names(index_4_loading_concs) <- c('concentration','area','scenario','water')

index_4_cleaning_concs <- as.data.frame(index_4_cleaning_w2wed_conc_list)
index_4_cleaning_concs$area <- as.factor('cleaning')
index_4_cleaning_concs$scenario <- as.factor('XI_02A4')
index_4_cleaning_concs$water <- as.factor('Wet')
names(index_4_cleaning_concs) <- c('concentration','area','scenario','water')

index_4_sorting_concs <- as.data.frame(index_4_sorting_w2wed_conc_list)
index_4_sorting_concs$area <- as.factor('sorting')
index_4_sorting_concs$scenario <- as.factor('XI_02A4')
index_4_sorting_concs$water <- as.factor('Dry')
names(index_4_sorting_concs) <- c('concentration','area','scenario','water')

index_4_reject_concs <- as.data.frame(index_4_reject_w2wed_conc_list)
index_4_reject_concs$area <- as.factor('reject')
index_4_reject_concs$scenario <- as.factor('XI_02A4')
index_4_reject_concs$water <- as.factor('Dry')
names(index_4_reject_concs) <- c('concentration','area','scenario','water')

index_4_tray_packing_concs <- as.data.frame(index_4_tray_packing_w2wed_conc_list)
index_4_tray_packing_concs$area <- as.factor('tray packing')
index_4_tray_packing_concs$scenario <- as.factor('XI_02A4')
index_4_tray_packing_concs$water <- as.factor('Dry')
names(index_4_tray_packing_concs) <- c('concentration','area','scenario','water')

index_4_other_concs <- as.data.frame(index_4_other_w2wed_conc_list)
index_4_other_concs$area <- as.factor('other')
index_4_other_concs$scenario <- as.factor('XI_02A4')
index_4_other_concs$water <- as.factor('Dry')
names(index_4_other_concs) <- c('concentration','area','scenario','water')

index_4_w2wed_concs <- rbind(index_4_loading_concs,index_4_cleaning_concs,index_4_sorting_concs,index_4_tray_packing_concs,index_4_reject_concs,index_4_other_concs)

index_4_loading_prev <- as.data.frame(NL_table_Index_4$loading_w2wed_prev[order(NL_table_Index_4$local_seed)])
index_4_loading_prev$area <- as.factor('loading')
index_4_loading_prev$scenario <- as.factor('XI_02A4')
index_4_loading_prev$water <- as.factor('Wet')
names(index_4_loading_prev) <- c('prevalence','area','scenario','water')

index_4_cleaning_prev <- as.data.frame(NL_table_Index_4$cleaning_w2wed_prev[order(NL_table_Index_4$local_seed)])
index_4_cleaning_prev$area <- as.factor('cleaning')
index_4_cleaning_prev$scenario <- as.factor('XI_02A4')
index_4_cleaning_prev$water <- as.factor('Wet')
names(index_4_cleaning_prev) <- c('prevalence','area','scenario','water')

index_4_sorting_prev <- as.data.frame(NL_table_Index_4$sorting_w2wed_prev[order(NL_table_Index_4$local_seed)])
index_4_sorting_prev$area <- as.factor('sorting')
index_4_sorting_prev$scenario <- as.factor('XI_02A4')
index_4_sorting_prev$water <- as.factor('Dry')
names(index_4_sorting_prev) <- c('prevalence','area','scenario','water')

index_4_reject_prev <- as.data.frame(NL_table_Index_4$reject_w2wed_prev[order(NL_table_Index_4$local_seed)])
index_4_reject_prev$area <- as.factor('reject')
index_4_reject_prev$scenario <- as.factor('XI_02A4')
index_4_reject_prev$water <- as.factor('Dry')
names(index_4_reject_prev) <- c('prevalence','area','scenario','water')

index_4_tray_packing_prev <- as.data.frame(NL_table_Index_4$tray_packing_w2wed_prev[order(NL_table_Index_4$local_seed)])
index_4_tray_packing_prev$area <- as.factor('tray packing')
index_4_tray_packing_prev$scenario <- as.factor('XI_02A4')
index_4_tray_packing_prev$water <- as.factor('Dry')
names(index_4_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_4_other_prev <- as.data.frame(NL_table_Index_4$other_w2wed_prev[order(NL_table_Index_4$local_seed)])
index_4_other_prev$area <- as.factor('other')
index_4_other_prev$scenario <- as.factor('XI_02A4')
index_4_other_prev$water <- as.factor('Dry')
names(index_4_other_prev) <- c('prevalence','area','scenario','water')

index_4_w2wed_prev <- rbind(index_4_loading_prev,index_4_cleaning_prev,index_4_sorting_prev,index_4_tray_packing_prev,index_4_reject_prev,index_4_other_prev)

index_4_w2wed_wet_prev <- as.data.frame(index_4_loading_prev$prevalence*21/100+index_4_cleaning_prev$prevalence*28/100)/49*100
index_4_w2wed_wet_prev$scenario <- as.factor('XI_02A4')
index_4_w2wed_wet_prev$water <- as.factor('Wet')
names(index_4_w2wed_wet_prev) <- c('prevalence','scenario','water')

index_4_w2wed_dry_prev <- as.data.frame(index_4_sorting_prev$prevalence*20/100+index_4_reject_prev$prevalence*23/100+index_4_tray_packing_prev$prevalence*123/100+index_4_other_prev$prevalence*10/100)/176*100
index_4_w2wed_dry_prev$scenario <- as.factor('XI_02A4')
index_4_w2wed_dry_prev$water <- as.factor('Dry')
names(index_4_w2wed_dry_prev) <- c('prevalence','scenario','water')

index_4_w2wed_recombined_prev <- rbind(index_4_w2wed_wet_prev, index_4_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Index_4$loading_w3wed_conc_list
vector <- vector[vector!='[]']
index_4_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_loading_w3wed_conc_list <- append(index_4_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_loading_w3wed_conc_matrix <- matrix(unlist(index_4_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_4$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
index_4_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_cleaning_w3wed_conc_list <- append(index_4_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_cleaning_w3wed_conc_matrix <- matrix(unlist(index_4_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_4$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# index_4_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_4_drying_w3wed_conc_list <- append(index_4_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_4$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
index_4_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_sorting_w3wed_conc_list <- append(index_4_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_sorting_w3wed_conc_matrix <- matrix(unlist(index_4_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_4$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
index_4_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_tray_packing_w3wed_conc_list <- append(index_4_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_tray_packing_w3wed_conc_matrix <- matrix(unlist(index_4_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_4$reject_w3wed_conc_list
vector <- vector[vector!='[]']
index_4_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_reject_w3wed_conc_list <- append(index_4_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_reject_w3wed_conc_matrix <- matrix(unlist(index_4_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_4$other_w3wed_conc_list
vector <- vector[vector!='[]']
index_4_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_other_w3wed_conc_list <- append(index_4_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_other_w3wed_conc_matrix <- matrix(unlist(index_4_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

index_4_loading_concs <- as.data.frame(index_4_loading_w3wed_conc_list)
index_4_loading_concs$area <- as.factor('loading')
index_4_loading_concs$scenario <- as.factor('XI_02A4')
index_4_loading_concs$water <- as.factor('Wet')
names(index_4_loading_concs) <- c('concentration','area','scenario','water')

index_4_cleaning_concs <- as.data.frame(index_4_cleaning_w3wed_conc_list)
index_4_cleaning_concs$area <- as.factor('cleaning')
index_4_cleaning_concs$scenario <- as.factor('XI_02A4')
index_4_cleaning_concs$water <- as.factor('Wet')
names(index_4_cleaning_concs) <- c('concentration','area','scenario','water')

index_4_sorting_concs <- as.data.frame(index_4_sorting_w3wed_conc_list)
index_4_sorting_concs$area <- as.factor('sorting')
index_4_sorting_concs$scenario <- as.factor('XI_02A4')
index_4_sorting_concs$water <- as.factor('Dry')
names(index_4_sorting_concs) <- c('concentration','area','scenario','water')

index_4_reject_concs <- as.data.frame(index_4_reject_w3wed_conc_list)
index_4_reject_concs$area <- as.factor('reject')
index_4_reject_concs$scenario <- as.factor('XI_02A4')
index_4_reject_concs$water <- as.factor('Dry')
names(index_4_reject_concs) <- c('concentration','area','scenario','water')

index_4_tray_packing_concs <- as.data.frame(index_4_tray_packing_w3wed_conc_list)
index_4_tray_packing_concs$area <- as.factor('tray packing')
index_4_tray_packing_concs$scenario <- as.factor('XI_02A4')
index_4_tray_packing_concs$water <- as.factor('Dry')
names(index_4_tray_packing_concs) <- c('concentration','area','scenario','water')

index_4_other_concs <- as.data.frame(index_4_other_w3wed_conc_list)
index_4_other_concs$area <- as.factor('other')
index_4_other_concs$scenario <- as.factor('XI_02A4')
index_4_other_concs$water <- as.factor('Dry')
names(index_4_other_concs) <- c('concentration','area','scenario','water')

index_4_w3wed_concs <- rbind(index_4_loading_concs,index_4_cleaning_concs,index_4_sorting_concs,index_4_tray_packing_concs,index_4_reject_concs,index_4_other_concs)

index_4_loading_prev <- as.data.frame(NL_table_Index_4$loading_w3wed_prev[order(NL_table_Index_4$local_seed)])
index_4_loading_prev$area <- as.factor('loading')
index_4_loading_prev$scenario <- as.factor('XI_02A4')
index_4_loading_prev$water <- as.factor('Wet')
names(index_4_loading_prev) <- c('prevalence','area','scenario','water')

index_4_cleaning_prev <- as.data.frame(NL_table_Index_4$cleaning_w3wed_prev[order(NL_table_Index_4$local_seed)])
index_4_cleaning_prev$area <- as.factor('cleaning')
index_4_cleaning_prev$scenario <- as.factor('XI_02A4')
index_4_cleaning_prev$water <- as.factor('Wet')
names(index_4_cleaning_prev) <- c('prevalence','area','scenario','water')

index_4_sorting_prev <- as.data.frame(NL_table_Index_4$sorting_w3wed_prev[order(NL_table_Index_4$local_seed)])
index_4_sorting_prev$area <- as.factor('sorting')
index_4_sorting_prev$scenario <- as.factor('XI_02A4')
index_4_sorting_prev$water <- as.factor('Dry')
names(index_4_sorting_prev) <- c('prevalence','area','scenario','water')

index_4_reject_prev <- as.data.frame(NL_table_Index_4$reject_w3wed_prev[order(NL_table_Index_4$local_seed)])
index_4_reject_prev$area <- as.factor('reject')
index_4_reject_prev$scenario <- as.factor('XI_02A4')
index_4_reject_prev$water <- as.factor('Dry')
names(index_4_reject_prev) <- c('prevalence','area','scenario','water')

index_4_tray_packing_prev <- as.data.frame(NL_table_Index_4$tray_packing_w3wed_prev[order(NL_table_Index_4$local_seed)])
index_4_tray_packing_prev$area <- as.factor('tray packing')
index_4_tray_packing_prev$scenario <- as.factor('XI_02A4')
index_4_tray_packing_prev$water <- as.factor('Dry')
names(index_4_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_4_other_prev <- as.data.frame(NL_table_Index_4$other_w3wed_prev[order(NL_table_Index_4$local_seed)])
index_4_other_prev$area <- as.factor('other')
index_4_other_prev$scenario <- as.factor('XI_02A4')
index_4_other_prev$water <- as.factor('Dry')
names(index_4_other_prev) <- c('prevalence','area','scenario','water')

index_4_w3wed_prev <- rbind(index_4_loading_prev,index_4_cleaning_prev,index_4_sorting_prev,index_4_tray_packing_prev,index_4_reject_prev,index_4_other_prev)

index_4_w3wed_wet_prev <- as.data.frame(index_4_loading_prev$prevalence*21/100+index_4_cleaning_prev$prevalence*28/100)/49*100
index_4_w3wed_wet_prev$scenario <- as.factor('XI_02A4')
index_4_w3wed_wet_prev$water <- as.factor('Wet')
names(index_4_w3wed_wet_prev) <- c('prevalence','scenario','water')

index_4_w3wed_dry_prev <- as.data.frame(index_4_sorting_prev$prevalence*20/100+index_4_reject_prev$prevalence*23/100+index_4_tray_packing_prev$prevalence*123/100+index_4_other_prev$prevalence*10/100)/176*100
index_4_w3wed_dry_prev$scenario <- as.factor('XI_02A4')
index_4_w3wed_dry_prev$water <- as.factor('Dry')
names(index_4_w3wed_dry_prev) <- c('prevalence','scenario','water')

index_4_w3wed_recombined_prev <- rbind(index_4_w3wed_wet_prev, index_4_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Index_4$loading_w4wed_conc_list
vector <- vector[vector!='[]']
index_4_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_loading_w4wed_conc_list <- append(index_4_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_loading_w4wed_conc_matrix <- matrix(unlist(index_4_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_4$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
index_4_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_cleaning_w4wed_conc_list <- append(index_4_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_cleaning_w4wed_conc_matrix <- matrix(unlist(index_4_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_4$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# index_4_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_4_drying_w4wed_conc_list <- append(index_4_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_4$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
index_4_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_sorting_w4wed_conc_list <- append(index_4_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_sorting_w4wed_conc_matrix <- matrix(unlist(index_4_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_4$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
index_4_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_tray_packing_w4wed_conc_list <- append(index_4_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_tray_packing_w4wed_conc_matrix <- matrix(unlist(index_4_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_4$reject_w4wed_conc_list
vector <- vector[vector!='[]']
index_4_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_reject_w4wed_conc_list <- append(index_4_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_reject_w4wed_conc_matrix <- matrix(unlist(index_4_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_4$other_w4wed_conc_list
vector <- vector[vector!='[]']
index_4_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_other_w4wed_conc_list <- append(index_4_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_other_w4wed_conc_matrix <- matrix(unlist(index_4_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

index_4_loading_concs <- as.data.frame(index_4_loading_w4wed_conc_list)
index_4_loading_concs$area <- as.factor('loading')
index_4_loading_concs$scenario <- as.factor('XI_02A4')
index_4_loading_concs$water <- as.factor('Wet')
names(index_4_loading_concs) <- c('concentration','area','scenario','water')

index_4_cleaning_concs <- as.data.frame(index_4_cleaning_w4wed_conc_list)
index_4_cleaning_concs$area <- as.factor('cleaning')
index_4_cleaning_concs$scenario <- as.factor('XI_02A4')
index_4_cleaning_concs$water <- as.factor('Wet')
names(index_4_cleaning_concs) <- c('concentration','area','scenario','water')

index_4_sorting_concs <- as.data.frame(index_4_sorting_w4wed_conc_list)
index_4_sorting_concs$area <- as.factor('sorting')
index_4_sorting_concs$scenario <- as.factor('XI_02A4')
index_4_sorting_concs$water <- as.factor('Dry')
names(index_4_sorting_concs) <- c('concentration','area','scenario','water')

index_4_reject_concs <- as.data.frame(index_4_reject_w4wed_conc_list)
index_4_reject_concs$area <- as.factor('reject')
index_4_reject_concs$scenario <- as.factor('XI_02A4')
index_4_reject_concs$water <- as.factor('Dry')
names(index_4_reject_concs) <- c('concentration','area','scenario','water')

index_4_tray_packing_concs <- as.data.frame(index_4_tray_packing_w4wed_conc_list)
index_4_tray_packing_concs$area <- as.factor('tray packing')
index_4_tray_packing_concs$scenario <- as.factor('XI_02A4')
index_4_tray_packing_concs$water <- as.factor('Dry')
names(index_4_tray_packing_concs) <- c('concentration','area','scenario','water')

index_4_other_concs <- as.data.frame(index_4_other_w4wed_conc_list)
index_4_other_concs$area <- as.factor('other')
index_4_other_concs$scenario <- as.factor('XI_02A4')
index_4_other_concs$water <- as.factor('Dry')
names(index_4_other_concs) <- c('concentration','area','scenario','water')

index_4_w4wed_concs <- rbind(index_4_loading_concs,index_4_cleaning_concs,index_4_sorting_concs,index_4_tray_packing_concs,index_4_reject_concs,index_4_other_concs)

index_4_loading_prev <- as.data.frame(NL_table_Index_4$loading_w4wed_prev[order(NL_table_Index_4$local_seed)])
index_4_loading_prev$area <- as.factor('loading')
index_4_loading_prev$scenario <- as.factor('XI_02A4')
index_4_loading_prev$water <- as.factor('Wet')
names(index_4_loading_prev) <- c('prevalence','area','scenario','water')

index_4_cleaning_prev <- as.data.frame(NL_table_Index_4$cleaning_w4wed_prev[order(NL_table_Index_4$local_seed)])
index_4_cleaning_prev$area <- as.factor('cleaning')
index_4_cleaning_prev$scenario <- as.factor('XI_02A4')
index_4_cleaning_prev$water <- as.factor('Wet')
names(index_4_cleaning_prev) <- c('prevalence','area','scenario','water')

index_4_sorting_prev <- as.data.frame(NL_table_Index_4$sorting_w4wed_prev[order(NL_table_Index_4$local_seed)])
index_4_sorting_prev$area <- as.factor('sorting')
index_4_sorting_prev$scenario <- as.factor('XI_02A4')
index_4_sorting_prev$water <- as.factor('Dry')
names(index_4_sorting_prev) <- c('prevalence','area','scenario','water')

index_4_reject_prev <- as.data.frame(NL_table_Index_4$reject_w4wed_prev[order(NL_table_Index_4$local_seed)])
index_4_reject_prev$area <- as.factor('reject')
index_4_reject_prev$scenario <- as.factor('XI_02A4')
index_4_reject_prev$water <- as.factor('Dry')
names(index_4_reject_prev) <- c('prevalence','area','scenario','water')

index_4_tray_packing_prev <- as.data.frame(NL_table_Index_4$tray_packing_w4wed_prev[order(NL_table_Index_4$local_seed)])
index_4_tray_packing_prev$area <- as.factor('tray packing')
index_4_tray_packing_prev$scenario <- as.factor('XI_02A4')
index_4_tray_packing_prev$water <- as.factor('Dry')
names(index_4_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_4_other_prev <- as.data.frame(NL_table_Index_4$other_w4wed_prev[order(NL_table_Index_4$local_seed)])
index_4_other_prev$area <- as.factor('other')
index_4_other_prev$scenario <- as.factor('XI_02A4')
index_4_other_prev$water <- as.factor('Dry')
names(index_4_other_prev) <- c('prevalence','area','scenario','water')

index_4_w4wed_prev <- rbind(index_4_loading_prev,index_4_cleaning_prev,index_4_sorting_prev,index_4_tray_packing_prev,index_4_reject_prev,index_4_other_prev)

index_4_w4wed_wet_prev <- as.data.frame(index_4_loading_prev$prevalence*21/100+index_4_cleaning_prev$prevalence*28/100)/49*100
index_4_w4wed_wet_prev$scenario <- as.factor('XI_02A4')
index_4_w4wed_wet_prev$water <- as.factor('Wet')
names(index_4_w4wed_wet_prev) <- c('prevalence','scenario','water')

index_4_w4wed_dry_prev <- as.data.frame(index_4_sorting_prev$prevalence*20/100+index_4_reject_prev$prevalence*23/100+index_4_tray_packing_prev$prevalence*123/100+index_4_other_prev$prevalence*10/100)/176*100
index_4_w4wed_dry_prev$scenario <- as.factor('XI_02A4')
index_4_w4wed_dry_prev$water <- as.factor('Dry')
names(index_4_w4wed_dry_prev) <- c('prevalence','scenario','water')

index_4_w4wed_recombined_prev <- rbind(index_4_w4wed_wet_prev, index_4_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Index_4$loading_w5wed_conc_list
vector <- vector[vector!='[]']
index_4_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_loading_w5wed_conc_list <- append(index_4_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_loading_w5wed_conc_matrix <- matrix(unlist(index_4_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_4$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
index_4_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_cleaning_w5wed_conc_list <- append(index_4_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_cleaning_w5wed_conc_matrix <- matrix(unlist(index_4_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_4$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# index_4_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_4_drying_w5wed_conc_list <- append(index_4_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_4$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
index_4_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_sorting_w5wed_conc_list <- append(index_4_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_sorting_w5wed_conc_matrix <- matrix(unlist(index_4_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_4$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
index_4_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_tray_packing_w5wed_conc_list <- append(index_4_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_tray_packing_w5wed_conc_matrix <- matrix(unlist(index_4_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_4$reject_w5wed_conc_list
vector <- vector[vector!='[]']
index_4_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_reject_w5wed_conc_list <- append(index_4_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_reject_w5wed_conc_matrix <- matrix(unlist(index_4_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_4$other_w5wed_conc_list
vector <- vector[vector!='[]']
index_4_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_other_w5wed_conc_list <- append(index_4_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_other_w5wed_conc_matrix <- matrix(unlist(index_4_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

index_4_loading_concs <- as.data.frame(index_4_loading_w5wed_conc_list)
index_4_loading_concs$area <- as.factor('loading')
index_4_loading_concs$scenario <- as.factor('XI_02A4')
index_4_loading_concs$water <- as.factor('Wet')
names(index_4_loading_concs) <- c('concentration','area','scenario','water')

index_4_cleaning_concs <- as.data.frame(index_4_cleaning_w5wed_conc_list)
index_4_cleaning_concs$area <- as.factor('cleaning')
index_4_cleaning_concs$scenario <- as.factor('XI_02A4')
index_4_cleaning_concs$water <- as.factor('Wet')
names(index_4_cleaning_concs) <- c('concentration','area','scenario','water')

index_4_sorting_concs <- as.data.frame(index_4_sorting_w5wed_conc_list)
index_4_sorting_concs$area <- as.factor('sorting')
index_4_sorting_concs$scenario <- as.factor('XI_02A4')
index_4_sorting_concs$water <- as.factor('Dry')
names(index_4_sorting_concs) <- c('concentration','area','scenario','water')

index_4_reject_concs <- as.data.frame(index_4_reject_w5wed_conc_list)
index_4_reject_concs$area <- as.factor('reject')
index_4_reject_concs$scenario <- as.factor('XI_02A4')
index_4_reject_concs$water <- as.factor('Dry')
names(index_4_reject_concs) <- c('concentration','area','scenario','water')

index_4_tray_packing_concs <- as.data.frame(index_4_tray_packing_w5wed_conc_list)
index_4_tray_packing_concs$area <- as.factor('tray packing')
index_4_tray_packing_concs$scenario <- as.factor('XI_02A4')
index_4_tray_packing_concs$water <- as.factor('Dry')
names(index_4_tray_packing_concs) <- c('concentration','area','scenario','water')

index_4_other_concs <- as.data.frame(index_4_other_w5wed_conc_list)
index_4_other_concs$area <- as.factor('other')
index_4_other_concs$scenario <- as.factor('XI_02A4')
index_4_other_concs$water <- as.factor('Dry')
names(index_4_other_concs) <- c('concentration','area','scenario','water')

index_4_w5wed_concs <- rbind(index_4_loading_concs,index_4_cleaning_concs,index_4_sorting_concs,index_4_tray_packing_concs,index_4_reject_concs,index_4_other_concs)

index_4_loading_prev <- as.data.frame(NL_table_Index_4$loading_w5wed_prev[order(NL_table_Index_4$local_seed)])
index_4_loading_prev$area <- as.factor('loading')
index_4_loading_prev$scenario <- as.factor('XI_02A4')
index_4_loading_prev$water <- as.factor('Wet')
names(index_4_loading_prev) <- c('prevalence','area','scenario','water')

index_4_cleaning_prev <- as.data.frame(NL_table_Index_4$cleaning_w5wed_prev[order(NL_table_Index_4$local_seed)])
index_4_cleaning_prev$area <- as.factor('cleaning')
index_4_cleaning_prev$scenario <- as.factor('XI_02A4')
index_4_cleaning_prev$water <- as.factor('Wet')
names(index_4_cleaning_prev) <- c('prevalence','area','scenario','water')

index_4_sorting_prev <- as.data.frame(NL_table_Index_4$sorting_w5wed_prev[order(NL_table_Index_4$local_seed)])
index_4_sorting_prev$area <- as.factor('sorting')
index_4_sorting_prev$scenario <- as.factor('XI_02A4')
index_4_sorting_prev$water <- as.factor('Dry')
names(index_4_sorting_prev) <- c('prevalence','area','scenario','water')

index_4_reject_prev <- as.data.frame(NL_table_Index_4$reject_w5wed_prev[order(NL_table_Index_4$local_seed)])
index_4_reject_prev$area <- as.factor('reject')
index_4_reject_prev$scenario <- as.factor('XI_02A4')
index_4_reject_prev$water <- as.factor('Dry')
names(index_4_reject_prev) <- c('prevalence','area','scenario','water')

index_4_tray_packing_prev <- as.data.frame(NL_table_Index_4$tray_packing_w5wed_prev[order(NL_table_Index_4$local_seed)])
index_4_tray_packing_prev$area <- as.factor('tray packing')
index_4_tray_packing_prev$scenario <- as.factor('XI_02A4')
index_4_tray_packing_prev$water <- as.factor('Dry')
names(index_4_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_4_other_prev <- as.data.frame(NL_table_Index_4$other_w5wed_prev[order(NL_table_Index_4$local_seed)])
index_4_other_prev$area <- as.factor('other')
index_4_other_prev$scenario <- as.factor('XI_02A4')
index_4_other_prev$water <- as.factor('Dry')
names(index_4_other_prev) <- c('prevalence','area','scenario','water')

index_4_w5wed_prev <- rbind(index_4_loading_prev,index_4_cleaning_prev,index_4_sorting_prev,index_4_tray_packing_prev,index_4_reject_prev,index_4_other_prev)

index_4_w5wed_wet_prev <- as.data.frame(index_4_loading_prev$prevalence*21/100+index_4_cleaning_prev$prevalence*28/100)/49*100
index_4_w5wed_wet_prev$scenario <- as.factor('XI_02A4')
index_4_w5wed_wet_prev$water <- as.factor('Wet')
names(index_4_w5wed_wet_prev) <- c('prevalence','scenario','water')

index_4_w5wed_dry_prev <- as.data.frame(index_4_sorting_prev$prevalence*20/100+index_4_reject_prev$prevalence*23/100+index_4_tray_packing_prev$prevalence*123/100+index_4_other_prev$prevalence*10/100)/176*100
index_4_w5wed_dry_prev$scenario <- as.factor('XI_02A4')
index_4_w5wed_dry_prev$water <- as.factor('Dry')
names(index_4_w5wed_dry_prev) <- c('prevalence','scenario','water')

index_4_w5wed_recombined_prev <- rbind(index_4_w5wed_wet_prev, index_4_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Index_4$loading_w6wed_conc_list
vector <- vector[vector!='[]']
index_4_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_loading_w6wed_conc_list <- append(index_4_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_loading_w6wed_conc_matrix <- matrix(unlist(index_4_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_4$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
index_4_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_cleaning_w6wed_conc_list <- append(index_4_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_cleaning_w6wed_conc_matrix <- matrix(unlist(index_4_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_4$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# index_4_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_4_drying_w6wed_conc_list <- append(index_4_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_4$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
index_4_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_sorting_w6wed_conc_list <- append(index_4_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_sorting_w6wed_conc_matrix <- matrix(unlist(index_4_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_4$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
index_4_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_tray_packing_w6wed_conc_list <- append(index_4_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_tray_packing_w6wed_conc_matrix <- matrix(unlist(index_4_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_4$reject_w6wed_conc_list
vector <- vector[vector!='[]']
index_4_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_reject_w6wed_conc_list <- append(index_4_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_reject_w6wed_conc_matrix <- matrix(unlist(index_4_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_4$other_w6wed_conc_list
vector <- vector[vector!='[]']
index_4_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_other_w6wed_conc_list <- append(index_4_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_other_w6wed_conc_matrix <- matrix(unlist(index_4_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

index_4_loading_concs <- as.data.frame(index_4_loading_w6wed_conc_list)
index_4_loading_concs$area <- as.factor('loading')
index_4_loading_concs$scenario <- as.factor('XI_02A4')
index_4_loading_concs$water <- as.factor('Wet')
names(index_4_loading_concs) <- c('concentration','area','scenario','water')

index_4_cleaning_concs <- as.data.frame(index_4_cleaning_w6wed_conc_list)
index_4_cleaning_concs$area <- as.factor('cleaning')
index_4_cleaning_concs$scenario <- as.factor('XI_02A4')
index_4_cleaning_concs$water <- as.factor('Wet')
names(index_4_cleaning_concs) <- c('concentration','area','scenario','water')

index_4_sorting_concs <- as.data.frame(index_4_sorting_w6wed_conc_list)
index_4_sorting_concs$area <- as.factor('sorting')
index_4_sorting_concs$scenario <- as.factor('XI_02A4')
index_4_sorting_concs$water <- as.factor('Dry')
names(index_4_sorting_concs) <- c('concentration','area','scenario','water')

index_4_reject_concs <- as.data.frame(index_4_reject_w6wed_conc_list)
index_4_reject_concs$area <- as.factor('reject')
index_4_reject_concs$scenario <- as.factor('XI_02A4')
index_4_reject_concs$water <- as.factor('Dry')
names(index_4_reject_concs) <- c('concentration','area','scenario','water')

index_4_tray_packing_concs <- as.data.frame(index_4_tray_packing_w6wed_conc_list)
index_4_tray_packing_concs$area <- as.factor('tray packing')
index_4_tray_packing_concs$scenario <- as.factor('XI_02A4')
index_4_tray_packing_concs$water <- as.factor('Dry')
names(index_4_tray_packing_concs) <- c('concentration','area','scenario','water')

index_4_other_concs <- as.data.frame(index_4_other_w6wed_conc_list)
index_4_other_concs$area <- as.factor('other')
index_4_other_concs$scenario <- as.factor('XI_02A4')
index_4_other_concs$water <- as.factor('Dry')
names(index_4_other_concs) <- c('concentration','area','scenario','water')

index_4_w6wed_concs <- rbind(index_4_loading_concs,index_4_cleaning_concs,index_4_sorting_concs,index_4_tray_packing_concs,index_4_reject_concs,index_4_other_concs)

index_4_loading_prev <- as.data.frame(NL_table_Index_4$loading_w6wed_prev[order(NL_table_Index_4$local_seed)])
index_4_loading_prev$area <- as.factor('loading')
index_4_loading_prev$scenario <- as.factor('XI_02A4')
index_4_loading_prev$water <- as.factor('Wet')
names(index_4_loading_prev) <- c('prevalence','area','scenario','water')

index_4_cleaning_prev <- as.data.frame(NL_table_Index_4$cleaning_w6wed_prev[order(NL_table_Index_4$local_seed)])
index_4_cleaning_prev$area <- as.factor('cleaning')
index_4_cleaning_prev$scenario <- as.factor('XI_02A4')
index_4_cleaning_prev$water <- as.factor('Wet')
names(index_4_cleaning_prev) <- c('prevalence','area','scenario','water')

index_4_sorting_prev <- as.data.frame(NL_table_Index_4$sorting_w6wed_prev[order(NL_table_Index_4$local_seed)])
index_4_sorting_prev$area <- as.factor('sorting')
index_4_sorting_prev$scenario <- as.factor('XI_02A4')
index_4_sorting_prev$water <- as.factor('Dry')
names(index_4_sorting_prev) <- c('prevalence','area','scenario','water')

index_4_reject_prev <- as.data.frame(NL_table_Index_4$reject_w6wed_prev[order(NL_table_Index_4$local_seed)])
index_4_reject_prev$area <- as.factor('reject')
index_4_reject_prev$scenario <- as.factor('XI_02A4')
index_4_reject_prev$water <- as.factor('Dry')
names(index_4_reject_prev) <- c('prevalence','area','scenario','water')

index_4_tray_packing_prev <- as.data.frame(NL_table_Index_4$tray_packing_w6wed_prev[order(NL_table_Index_4$local_seed)])
index_4_tray_packing_prev$area <- as.factor('tray packing')
index_4_tray_packing_prev$scenario <- as.factor('XI_02A4')
index_4_tray_packing_prev$water <- as.factor('Dry')
names(index_4_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_4_other_prev <- as.data.frame(NL_table_Index_4$other_w6wed_prev[order(NL_table_Index_4$local_seed)])
index_4_other_prev$area <- as.factor('other')
index_4_other_prev$scenario <- as.factor('XI_02A4')
index_4_other_prev$water <- as.factor('Dry')
names(index_4_other_prev) <- c('prevalence','area','scenario','water')

index_4_w6wed_prev <- rbind(index_4_loading_prev,index_4_cleaning_prev,index_4_sorting_prev,index_4_tray_packing_prev,index_4_reject_prev,index_4_other_prev)

index_4_w6wed_wet_prev <- as.data.frame(index_4_loading_prev$prevalence*21/100+index_4_cleaning_prev$prevalence*28/100)/49*100
index_4_w6wed_wet_prev$scenario <- as.factor('XI_02A4')
index_4_w6wed_wet_prev$water <- as.factor('Wet')
names(index_4_w6wed_wet_prev) <- c('prevalence','scenario','water')

index_4_w6wed_dry_prev <- as.data.frame(index_4_sorting_prev$prevalence*20/100+index_4_reject_prev$prevalence*23/100+index_4_tray_packing_prev$prevalence*123/100+index_4_other_prev$prevalence*10/100)/176*100
index_4_w6wed_dry_prev$scenario <- as.factor('XI_02A4')
index_4_w6wed_dry_prev$water <- as.factor('Dry')
names(index_4_w6wed_dry_prev) <- c('prevalence','scenario','water')

index_4_w6wed_recombined_prev <- rbind(index_4_w6wed_wet_prev, index_4_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Index_4$loading_w7wed_conc_list
vector <- vector[vector!='[]']
index_4_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_loading_w7wed_conc_list <- append(index_4_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_loading_w7wed_conc_matrix <- matrix(unlist(index_4_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_4$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
index_4_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_cleaning_w7wed_conc_list <- append(index_4_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_cleaning_w7wed_conc_matrix <- matrix(unlist(index_4_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_4$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# index_4_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_4_drying_w7wed_conc_list <- append(index_4_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_4$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
index_4_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_sorting_w7wed_conc_list <- append(index_4_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_sorting_w7wed_conc_matrix <- matrix(unlist(index_4_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_4$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
index_4_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_tray_packing_w7wed_conc_list <- append(index_4_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_tray_packing_w7wed_conc_matrix <- matrix(unlist(index_4_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_4$reject_w7wed_conc_list
vector <- vector[vector!='[]']
index_4_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_reject_w7wed_conc_list <- append(index_4_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_reject_w7wed_conc_matrix <- matrix(unlist(index_4_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_4$other_w7wed_conc_list
vector <- vector[vector!='[]']
index_4_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_other_w7wed_conc_list <- append(index_4_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_other_w7wed_conc_matrix <- matrix(unlist(index_4_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

index_4_loading_concs <- as.data.frame(index_4_loading_w7wed_conc_list)
index_4_loading_concs$area <- as.factor('loading')
index_4_loading_concs$scenario <- as.factor('XI_02A4')
index_4_loading_concs$water <- as.factor('Wet')
names(index_4_loading_concs) <- c('concentration','area','scenario','water')

index_4_cleaning_concs <- as.data.frame(index_4_cleaning_w7wed_conc_list)
index_4_cleaning_concs$area <- as.factor('cleaning')
index_4_cleaning_concs$scenario <- as.factor('XI_02A4')
index_4_cleaning_concs$water <- as.factor('Wet')
names(index_4_cleaning_concs) <- c('concentration','area','scenario','water')

index_4_sorting_concs <- as.data.frame(index_4_sorting_w7wed_conc_list)
index_4_sorting_concs$area <- as.factor('sorting')
index_4_sorting_concs$scenario <- as.factor('XI_02A4')
index_4_sorting_concs$water <- as.factor('Dry')
names(index_4_sorting_concs) <- c('concentration','area','scenario','water')

index_4_reject_concs <- as.data.frame(index_4_reject_w7wed_conc_list)
index_4_reject_concs$area <- as.factor('reject')
index_4_reject_concs$scenario <- as.factor('XI_02A4')
index_4_reject_concs$water <- as.factor('Dry')
names(index_4_reject_concs) <- c('concentration','area','scenario','water')

index_4_tray_packing_concs <- as.data.frame(index_4_tray_packing_w7wed_conc_list)
index_4_tray_packing_concs$area <- as.factor('tray packing')
index_4_tray_packing_concs$scenario <- as.factor('XI_02A4')
index_4_tray_packing_concs$water <- as.factor('Dry')
names(index_4_tray_packing_concs) <- c('concentration','area','scenario','water')

index_4_other_concs <- as.data.frame(index_4_other_w7wed_conc_list)
index_4_other_concs$area <- as.factor('other')
index_4_other_concs$scenario <- as.factor('XI_02A4')
index_4_other_concs$water <- as.factor('Dry')
names(index_4_other_concs) <- c('concentration','area','scenario','water')

index_4_w7wed_concs <- rbind(index_4_loading_concs,index_4_cleaning_concs,index_4_sorting_concs,index_4_tray_packing_concs,index_4_reject_concs,index_4_other_concs)

index_4_loading_prev <- as.data.frame(NL_table_Index_4$loading_w7wed_prev[order(NL_table_Index_4$local_seed)])
index_4_loading_prev$area <- as.factor('loading')
index_4_loading_prev$scenario <- as.factor('XI_02A4')
index_4_loading_prev$water <- as.factor('Wet')
names(index_4_loading_prev) <- c('prevalence','area','scenario','water')

index_4_cleaning_prev <- as.data.frame(NL_table_Index_4$cleaning_w7wed_prev[order(NL_table_Index_4$local_seed)])
index_4_cleaning_prev$area <- as.factor('cleaning')
index_4_cleaning_prev$scenario <- as.factor('XI_02A4')
index_4_cleaning_prev$water <- as.factor('Wet')
names(index_4_cleaning_prev) <- c('prevalence','area','scenario','water')

index_4_sorting_prev <- as.data.frame(NL_table_Index_4$sorting_w7wed_prev[order(NL_table_Index_4$local_seed)])
index_4_sorting_prev$area <- as.factor('sorting')
index_4_sorting_prev$scenario <- as.factor('XI_02A4')
index_4_sorting_prev$water <- as.factor('Dry')
names(index_4_sorting_prev) <- c('prevalence','area','scenario','water')

index_4_reject_prev <- as.data.frame(NL_table_Index_4$reject_w7wed_prev[order(NL_table_Index_4$local_seed)])
index_4_reject_prev$area <- as.factor('reject')
index_4_reject_prev$scenario <- as.factor('XI_02A4')
index_4_reject_prev$water <- as.factor('Dry')
names(index_4_reject_prev) <- c('prevalence','area','scenario','water')

index_4_tray_packing_prev <- as.data.frame(NL_table_Index_4$tray_packing_w7wed_prev[order(NL_table_Index_4$local_seed)])
index_4_tray_packing_prev$area <- as.factor('tray packing')
index_4_tray_packing_prev$scenario <- as.factor('XI_02A4')
index_4_tray_packing_prev$water <- as.factor('Dry')
names(index_4_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_4_other_prev <- as.data.frame(NL_table_Index_4$other_w7wed_prev[order(NL_table_Index_4$local_seed)])
index_4_other_prev$area <- as.factor('other')
index_4_other_prev$scenario <- as.factor('XI_02A4')
index_4_other_prev$water <- as.factor('Dry')
names(index_4_other_prev) <- c('prevalence','area','scenario','water')

index_4_w7wed_prev <- rbind(index_4_loading_prev,index_4_cleaning_prev,index_4_sorting_prev,index_4_tray_packing_prev,index_4_reject_prev,index_4_other_prev)

index_4_w7wed_wet_prev <- as.data.frame(index_4_loading_prev$prevalence*21/100+index_4_cleaning_prev$prevalence*28/100)/49*100
index_4_w7wed_wet_prev$scenario <- as.factor('XI_02A4')
index_4_w7wed_wet_prev$water <- as.factor('Wet')
names(index_4_w7wed_wet_prev) <- c('prevalence','scenario','water')

index_4_w7wed_dry_prev <- as.data.frame(index_4_sorting_prev$prevalence*20/100+index_4_reject_prev$prevalence*23/100+index_4_tray_packing_prev$prevalence*123/100+index_4_other_prev$prevalence*10/100)/176*100
index_4_w7wed_dry_prev$scenario <- as.factor('XI_02A4')
index_4_w7wed_dry_prev$water <- as.factor('Dry')
names(index_4_w7wed_dry_prev) <- c('prevalence','scenario','water')

index_4_w7wed_recombined_prev <- rbind(index_4_w7wed_wet_prev, index_4_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Index_4$loading_w8wed_conc_list
vector <- vector[vector!='[]']
index_4_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_loading_w8wed_conc_list <- append(index_4_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_loading_w8wed_conc_matrix <- matrix(unlist(index_4_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_4$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
index_4_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_cleaning_w8wed_conc_list <- append(index_4_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_cleaning_w8wed_conc_matrix <- matrix(unlist(index_4_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_4$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# index_4_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_4_drying_w8wed_conc_list <- append(index_4_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_4$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
index_4_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_sorting_w8wed_conc_list <- append(index_4_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_sorting_w8wed_conc_matrix <- matrix(unlist(index_4_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_4$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
index_4_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_tray_packing_w8wed_conc_list <- append(index_4_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_tray_packing_w8wed_conc_matrix <- matrix(unlist(index_4_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_4$reject_w8wed_conc_list
vector <- vector[vector!='[]']
index_4_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_reject_w8wed_conc_list <- append(index_4_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_reject_w8wed_conc_matrix <- matrix(unlist(index_4_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_4$other_w8wed_conc_list
vector <- vector[vector!='[]']
index_4_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_4_other_w8wed_conc_list <- append(index_4_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_4_other_w8wed_conc_matrix <- matrix(unlist(index_4_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

index_4_loading_concs <- as.data.frame(index_4_loading_w8wed_conc_list)
index_4_loading_concs$area <- as.factor('loading')
index_4_loading_concs$scenario <- as.factor('XI_02A4')
index_4_loading_concs$water <- as.factor('Wet')
names(index_4_loading_concs) <- c('concentration','area','scenario','water')

index_4_cleaning_concs <- as.data.frame(index_4_cleaning_w8wed_conc_list)
index_4_cleaning_concs$area <- as.factor('cleaning')
index_4_cleaning_concs$scenario <- as.factor('XI_02A4')
index_4_cleaning_concs$water <- as.factor('Wet')
names(index_4_cleaning_concs) <- c('concentration','area','scenario','water')

index_4_sorting_concs <- as.data.frame(index_4_sorting_w8wed_conc_list)
index_4_sorting_concs$area <- as.factor('sorting')
index_4_sorting_concs$scenario <- as.factor('XI_02A4')
index_4_sorting_concs$water <- as.factor('Dry')
names(index_4_sorting_concs) <- c('concentration','area','scenario','water')

index_4_reject_concs <- as.data.frame(index_4_reject_w8wed_conc_list)
index_4_reject_concs$area <- as.factor('reject')
index_4_reject_concs$scenario <- as.factor('XI_02A4')
index_4_reject_concs$water <- as.factor('Dry')
names(index_4_reject_concs) <- c('concentration','area','scenario','water')

index_4_tray_packing_concs <- as.data.frame(index_4_tray_packing_w8wed_conc_list)
index_4_tray_packing_concs$area <- as.factor('tray packing')
index_4_tray_packing_concs$scenario <- as.factor('XI_02A4')
index_4_tray_packing_concs$water <- as.factor('Dry')
names(index_4_tray_packing_concs) <- c('concentration','area','scenario','water')

index_4_other_concs <- as.data.frame(index_4_other_w8wed_conc_list)
index_4_other_concs$area <- as.factor('other')
index_4_other_concs$scenario <- as.factor('XI_02A4')
index_4_other_concs$water <- as.factor('Dry')
names(index_4_other_concs) <- c('concentration','area','scenario','water')

index_4_w8wed_concs <- rbind(index_4_loading_concs,index_4_cleaning_concs,index_4_sorting_concs,index_4_tray_packing_concs,index_4_reject_concs,index_4_other_concs)

index_4_loading_prev <- as.data.frame(NL_table_Index_4$loading_w8wed_prev[order(NL_table_Index_4$local_seed)])
index_4_loading_prev$area <- as.factor('loading')
index_4_loading_prev$scenario <- as.factor('XI_02A4')
index_4_loading_prev$water <- as.factor('Wet')
names(index_4_loading_prev) <- c('prevalence','area','scenario','water')

index_4_cleaning_prev <- as.data.frame(NL_table_Index_4$cleaning_w8wed_prev[order(NL_table_Index_4$local_seed)])
index_4_cleaning_prev$area <- as.factor('cleaning')
index_4_cleaning_prev$scenario <- as.factor('XI_02A4')
index_4_cleaning_prev$water <- as.factor('Wet')
names(index_4_cleaning_prev) <- c('prevalence','area','scenario','water')

index_4_sorting_prev <- as.data.frame(NL_table_Index_4$sorting_w8wed_prev[order(NL_table_Index_4$local_seed)])
index_4_sorting_prev$area <- as.factor('sorting')
index_4_sorting_prev$scenario <- as.factor('XI_02A4')
index_4_sorting_prev$water <- as.factor('Dry')
names(index_4_sorting_prev) <- c('prevalence','area','scenario','water')

index_4_reject_prev <- as.data.frame(NL_table_Index_4$reject_w8wed_prev[order(NL_table_Index_4$local_seed)])
index_4_reject_prev$area <- as.factor('reject')
index_4_reject_prev$scenario <- as.factor('XI_02A4')
index_4_reject_prev$water <- as.factor('Dry')
names(index_4_reject_prev) <- c('prevalence','area','scenario','water')

index_4_tray_packing_prev <- as.data.frame(NL_table_Index_4$tray_packing_w8wed_prev[order(NL_table_Index_4$local_seed)])
index_4_tray_packing_prev$area <- as.factor('tray packing')
index_4_tray_packing_prev$scenario <- as.factor('XI_02A4')
index_4_tray_packing_prev$water <- as.factor('Dry')
names(index_4_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_4_other_prev <- as.data.frame(NL_table_Index_4$other_w8wed_prev[order(NL_table_Index_4$local_seed)])
index_4_other_prev$area <- as.factor('other')
index_4_other_prev$scenario <- as.factor('XI_02A4')
index_4_other_prev$water <- as.factor('Dry')
names(index_4_other_prev) <- c('prevalence','area','scenario','water')

index_4_w8wed_prev <- rbind(index_4_loading_prev,index_4_cleaning_prev,index_4_sorting_prev,index_4_tray_packing_prev,index_4_reject_prev,index_4_other_prev)

index_4_w8wed_wet_prev <- as.data.frame(index_4_loading_prev$prevalence*21/100+index_4_cleaning_prev$prevalence*28/100)/49*100
index_4_w8wed_wet_prev$scenario <- as.factor('XI_02A4')
index_4_w8wed_wet_prev$water <- as.factor('Wet')
names(index_4_w8wed_wet_prev) <- c('prevalence','scenario','water')

index_4_w8wed_dry_prev <- as.data.frame(index_4_sorting_prev$prevalence*20/100+index_4_reject_prev$prevalence*23/100+index_4_tray_packing_prev$prevalence*123/100+index_4_other_prev$prevalence*10/100)/176*100
index_4_w8wed_dry_prev$scenario <- as.factor('XI_02A4')
index_4_w8wed_dry_prev$water <- as.factor('Dry')
names(index_4_w8wed_dry_prev) <- c('prevalence','scenario','water')

index_4_w8wed_recombined_prev <- rbind(index_4_w8wed_wet_prev, index_4_w8wed_dry_prev)

index_4_w1wed_prev$week <- as.factor(1)
index_4_w2wed_prev$week <- as.factor(2)
index_4_w3wed_prev$week <- as.factor(3)
index_4_w4wed_prev$week <- as.factor(4)
index_4_w5wed_prev$week <- as.factor(5)
index_4_w6wed_prev$week <- as.factor(6)
index_4_w7wed_prev$week <- as.factor(7)
index_4_w8wed_prev$week <- as.factor(8)

index_4_w1wed_recombined_prev$week <- as.factor(1)
index_4_w2wed_recombined_prev$week <- as.factor(2)
index_4_w3wed_recombined_prev$week <- as.factor(3)
index_4_w4wed_recombined_prev$week <- as.factor(4)
index_4_w5wed_recombined_prev$week <- as.factor(5)
index_4_w6wed_recombined_prev$week <- as.factor(6)
index_4_w7wed_recombined_prev$week <- as.factor(7)
index_4_w8wed_recombined_prev$week <- as.factor(8)
index_4_allwed_prev <- rbind(index_4_w1wed_recombined_prev,index_4_w2wed_recombined_prev,index_4_w3wed_recombined_prev,index_4_w4wed_recombined_prev,index_4_w5wed_recombined_prev,index_4_w6wed_recombined_prev,index_4_w7wed_recombined_prev,index_4_w8wed_recombined_prev)

vector <- NL_table_Index_4$lifetime_conc_list[order(NL_table_Index_4$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

index_4_w1wed_recombined_prev$week <- as.factor(1)
index_4_w2wed_recombined_prev$week <- as.factor(2)
index_4_w3wed_recombined_prev$week <- as.factor(3)
index_4_w4wed_recombined_prev$week <- as.factor(4)
index_4_w5wed_recombined_prev$week <- as.factor(5)
index_4_w6wed_recombined_prev$week <- as.factor(6)
index_4_w7wed_recombined_prev$week <- as.factor(7)
index_4_w8wed_recombined_prev$week <- as.factor(8)
index_4_allwed_prev <- rbind(index_4_w1wed_recombined_prev,index_4_w2wed_recombined_prev,index_4_w3wed_recombined_prev,index_4_w4wed_recombined_prev,index_4_w5wed_recombined_prev,index_4_w6wed_recombined_prev,index_4_w7wed_recombined_prev,index_4_w8wed_recombined_prev)

Facility_B_index_4_agents_melted <- melt(mdarray)
colnames(Facility_B_index_4_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_index_4_agents_melted$agent <- Facility_B_index_4_agents_melted$agent-1
Facility_B_index_4_agents_melted$logical <- Facility_B_index_4_agents_melted$value>0
Facility_B_index_4_agents_melted$binary <- as.numeric(Facility_B_index_4_agents_melted$logical)
Facility_B_index_4_agents_melted$log10value <- log10(Facility_B_index_4_agents_melted$value)
Facility_B_index_4_agents_melted$log10value[is.infinite(Facility_B_index_4_agents_melted$log10value)] <- 0

agent <- Facility_B_index_4_agents_melted$agent
iteration <- Facility_B_index_4_agents_melted$iteration
tick <- Facility_B_index_4_agents_melted$tick
rle_matrix <- tapply(Facility_B_index_4_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_partial_prob_intervention_mean_value_matrix <- tapply(Facility_B_index_4_agents_melted$value, list(agent, tick), mean)
Facility_B_index_4_median_value_matrix <- tapply(Facility_B_index_4_agents_melted$value, list(agent, tick), median)
x <- Facility_B_index_4_agents_melted
x$value[x$value==0] <- NA
Facility_B_index_4_pos_median_value_matrix <- tapply(x$value, list(agent, tick), median, na.rm=TRUE)
Facility_B_index_4_prob_value_matrix <- tapply(Facility_B_index_4_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

#Maximum sensitivity####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_index_4 <- durations

agents_list_index_4 <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_index_4 <- agents_list_index_4[,c("V1","V7","V8","V9")]
colnames(agents_list_index_4) <- c("name","sanitation_status","schedule","area")
#Time to persistence
agents_list_index_4$time_to_persistence <- rep((168*2),225)
agents_list_index_4$time_to_persistence[agents_list_index_4$schedule=="daily"] <- (24*2)

persistent_short_durations_list_index_4 <- data.frame()
persistent_long_durations_list_index_4 <- data.frame()
persistent_uncleanable_durations_list_index_4 <- data.frame()
transient_short_durations_list_index_4 <- data.frame()
transient_long_durations_list_index_4 <- data.frame()
transient_uncleanable_durations_list_index_4 <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_index_4$min_duration[agent] <- ifelse(length(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent])==0,NA,min(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_index_4$mean_duration[agent] <- ifelse(length(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent])==0,NA,mean(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_index_4$median_duration[agent] <- ifelse(length(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent])==0,NA,median(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_index_4$max_duration[agent] <- ifelse(length(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent])==0,NA,max(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_index_4$contamination_events[agent] <- sum(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_index_4$times_persistent[agent] <- sum(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent]>agents_list_index_4$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_index_4$q1_duration[agent] <- quantile(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_index_4$q3_duration[agent] <- quantile(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_index_4$min_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent])==0) || (agents_list_index_4$times_persistent[agent]==0),NA,min(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent & Facility_B_durations_index_4$duration>=agents_list_index_4$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_index_4$mean_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent])==0) || (agents_list_index_4$times_persistent[agent]==0),NA,mean(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent & Facility_B_durations_index_4$duration>=agents_list_index_4$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_index_4$median_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent])==0) || (agents_list_index_4$times_persistent[agent]==0),NA,median(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent & Facility_B_durations_index_4$duration>=agents_list_index_4$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_index_4$max_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent])==0) || (agents_list_index_4$times_persistent[agent]==0),NA,max(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent & Facility_B_durations_index_4$duration>=agents_list_index_4$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_index_4$q1_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent])==0) || (agents_list_index_4$times_persistent[agent]==0),NA,quantile(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent & Facility_B_durations_index_4$duration>=agents_list_index_4$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_index_4$q3_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent])==0) || (agents_list_index_4$times_persistent[agent]==0),NA,quantile(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent & Facility_B_durations_index_4$duration>=agents_list_index_4$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations
  x <- Facility_B_durations_index_4[which(Facility_B_durations_index_4$agent==agent & Facility_B_durations_index_4$duration>agents_list_index_4$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean
  agents_list_index_4$mean_times_persistent[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_index_4$mean_times_persistent[which(is.na(agents_list_index_4$mean_times_persistent))] <- 0
  #Division by total number of iterations in simulation
  agents_list_index_4$balanced_times_persistent[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_index_4$duration[Facility_B_durations_index_4$agent==agent])!=0) || (agents_list_index_4$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_index_4$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_index_4 <- rbind(
        persistent_short_durations_list_index_4,
        Facility_B_durations_index_4[Facility_B_durations_index_4$agent==agent & Facility_B_durations_index_4$duration>agents_list_index_4$time_to_persistence[agent],]
      )
    } else if(agents_list_index_4$time_to_persistence[agent]==336 && agents_list_index_4$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_index_4 <- rbind(
        persistent_long_durations_list_index_4,
        Facility_B_durations_index_4[Facility_B_durations_index_4$agent==agent & Facility_B_durations_index_4$duration>agents_list_index_4$time_to_persistence[agent],]
      )
    } else if(agents_list_index_4$time_to_persistence[agent]==336 && agents_list_index_4$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_index_4 <- rbind(
        persistent_uncleanable_durations_list_index_4,
        Facility_B_durations_index_4[Facility_B_durations_index_4$agent==agent & Facility_B_durations_index_4$duration>agents_list_index_4$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_index_4$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_index_4 <- rbind(
      transient_short_durations_list_index_4,
      Facility_B_durations_index_4[Facility_B_durations_index_4$agent==agent & Facility_B_durations_index_4$duration<=agents_list_index_4$time_to_persistence[agent],]
    )
  } else if(agents_list_index_4$time_to_persistence[agent]==336 && agents_list_index_4$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_index_4 <- rbind(
      transient_long_durations_list_index_4,
      Facility_B_durations_index_4[Facility_B_durations_index_4$agent==agent & Facility_B_durations_index_4$duration<=agents_list_index_4$time_to_persistence[agent],]
    )
  } else if(agents_list_index_4$time_to_persistence[agent]==336 && agents_list_index_4$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_index_4 <- rbind(
      transient_uncleanable_durations_list_index_4,
      Facility_B_durations_index_4[Facility_B_durations_index_4$agent==agent & Facility_B_durations_index_4$duration<=agents_list_index_4$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

#10 cells minimum####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>9)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_index_4_10min <- durations

persistent_short_durations_list_index_4_10min <- data.frame()
persistent_long_durations_list_index_4_10min <- data.frame()
persistent_uncleanable_durations_list_index_4_10min <- data.frame()
transient_short_durations_list_index_4_10min <- data.frame()
transient_long_durations_list_index_4_10min <- data.frame()
transient_uncleanable_durations_list_index_4_10min <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_index_4$min_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent])==0,NA,min(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_index_4$mean_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent])==0,NA,mean(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_index_4$median_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent])==0,NA,median(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_index_4$max_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent])==0,NA,max(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_index_4$contamination_events_10min[agent] <- sum(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_index_4$times_persistent_10min[agent] <- sum(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent]>agents_list_index_4$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_index_4$q1_duration_10min[agent] <- quantile(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_index_4$q3_duration_10min[agent] <- quantile(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_index_4$min_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent])==0) || (agents_list_index_4$times_persistent_10min[agent]==0),NA,min(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent & Facility_B_durations_index_4_10min$duration>=agents_list_index_4$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_index_4$mean_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent])==0) || (agents_list_index_4$times_persistent_10min[agent]==0),NA,mean(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent & Facility_B_durations_index_4_10min$duration>=agents_list_index_4$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_index_4$median_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent])==0) || (agents_list_index_4$times_persistent_10min[agent]==0),NA,median(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent & Facility_B_durations_index_4_10min$duration>=agents_list_index_4$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_index_4$max_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent])==0) || (agents_list_index_4$times_persistent_10min[agent]==0),NA,max(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent & Facility_B_durations_index_4_10min$duration>=agents_list_index_4$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_index_4$q1_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent])==0) || (agents_list_index_4$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent & Facility_B_durations_index_4_10min$duration>=agents_list_index_4$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_index_4$q3_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent])==0) || (agents_list_index_4$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent & Facility_B_durations_index_4_10min$duration>=agents_list_index_4$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations (Does not account for iterations with 0 events)
  x <- Facility_B_durations_index_4_10min[which(Facility_B_durations_index_4_10min$agent==agent & Facility_B_durations_index_4_10min$duration>agents_list_index_4$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean (Does account for iterations with 0 events)
  agents_list_index_4$mean_times_persistent_10min[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_index_4$mean_times_persistent_10min[which(is.na(agents_list_index_4$mean_times_persistent_10min))] <- 0
  #Division by total number of iterations in simulation
  agents_list_index_4$balanced_times_persistent_10min[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_index_4_10min$duration[Facility_B_durations_index_4_10min$agent==agent])!=0) || (agents_list_index_4$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_index_4$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_index_4_10min <- rbind(
        persistent_short_durations_list_index_4_10min,
        Facility_B_durations_index_4_10min[Facility_B_durations_index_4_10min$agent==agent & Facility_B_durations_index_4_10min$duration>agents_list_index_4$time_to_persistence[agent],]
      )
    } else if(agents_list_index_4$time_to_persistence[agent]==336 && agents_list_index_4$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_index_4_10min <- rbind(
        persistent_long_durations_list_index_4_10min,
        Facility_B_durations_index_4_10min[Facility_B_durations_index_4_10min$agent==agent & Facility_B_durations_index_4_10min$duration>agents_list_index_4$time_to_persistence[agent],]
      )
    } else if(agents_list_index_4$time_to_persistence[agent]==336 && agents_list_index_4$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_index_4_10min <- rbind(
        persistent_uncleanable_durations_list_index_4_10min,
        Facility_B_durations_index_4_10min[Facility_B_durations_index_4_10min$agent==agent & Facility_B_durations_index_4_10min$duration>agents_list_index_4$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_index_4$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_index_4_10min <- rbind(
      transient_short_durations_list_index_4_10min,
      Facility_B_durations_index_4_10min[Facility_B_durations_index_4_10min$agent==agent & Facility_B_durations_index_4_10min$duration<=agents_list_index_4$time_to_persistence[agent],]
    )
  } else if(agents_list_index_4$time_to_persistence[agent]==336 && agents_list_index_4$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_index_4_10min <- rbind(
      transient_long_durations_list_index_4_10min,
      Facility_B_durations_index_4_10min[Facility_B_durations_index_4_10min$agent==agent & Facility_B_durations_index_4_10min$duration<=agents_list_index_4$time_to_persistence[agent],]
    )
  } else if(agents_list_index_4$time_to_persistence[agent]==336 && agents_list_index_4$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_index_4_10min <- rbind(
      transient_uncleanable_durations_list_index_4_10min,
      Facility_B_durations_index_4_10min[Facility_B_durations_index_4_10min$agent==agent & Facility_B_durations_index_4_10min$duration<=agents_list_index_4$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

# Facility_B_index_4_agents_melted_monday_preop <- Facility_B_index_4_agents_melted[which(Facility_B_index_4_agents_melted$tick==33|Facility_B_index_4_agents_melted$tick==201|Facility_B_index_4_agents_melted$tick==369|Facility_B_index_4_agents_melted$tick==537|Facility_B_index_4_agents_melted$tick==705|Facility_B_index_4_agents_melted$tick==873|Facility_B_index_4_agents_melted$tick==1041|Facility_B_index_4_agents_melted$tick==1209),]
# 
# Facility_B_index_4_agents_melted_tuesday_preop <- Facility_B_index_4_agents_melted[which(Facility_B_index_4_agents_melted$tick==57|Facility_B_index_4_agents_melted$tick==225|Facility_B_index_4_agents_melted$tick==393|Facility_B_index_4_agents_melted$tick==561|Facility_B_index_4_agents_melted$tick==729|Facility_B_index_4_agents_melted$tick==897|Facility_B_index_4_agents_melted$tick==1065|Facility_B_index_4_agents_melted$tick==1233),]
# 
# Facility_B_index_4_agents_melted_wednesday_preop <- Facility_B_index_4_agents_melted[which(Facility_B_index_4_agents_melted$tick==81|Facility_B_index_4_agents_melted$tick==249|Facility_B_index_4_agents_melted$tick==417|Facility_B_index_4_agents_melted$tick==585|Facility_B_index_4_agents_melted$tick==753|Facility_B_index_4_agents_melted$tick==921|Facility_B_index_4_agents_melted$tick==1089|Facility_B_index_4_agents_melted$tick==1257),]
# 
# Facility_B_index_4_agents_melted_thursday_preop <- Facility_B_index_4_agents_melted[which(Facility_B_index_4_agents_melted$tick==105|Facility_B_index_4_agents_melted$tick==273|Facility_B_index_4_agents_melted$tick==441|Facility_B_index_4_agents_melted$tick==609|Facility_B_index_4_agents_melted$tick==777|Facility_B_index_4_agents_melted$tick==945|Facility_B_index_4_agents_melted$tick==1113|Facility_B_index_4_agents_melted$tick==1281),]
# 
# Facility_B_index_4_agents_melted_friday_preop <- Facility_B_index_4_agents_melted[which(Facility_B_index_4_agents_melted$tick==129|Facility_B_index_4_agents_melted$tick==297|Facility_B_index_4_agents_melted$tick==465|Facility_B_index_4_agents_melted$tick==633|Facility_B_index_4_agents_melted$tick==801|Facility_B_index_4_agents_melted$tick==969|Facility_B_index_4_agents_melted$tick==1137|Facility_B_index_4_agents_melted$tick==1305),]

Facility_B_index_4_agents_melted_ff <- as.ffdf(Facility_B_index_4_agents_melted)
rm(Facility_B_index_4_agents_melted)
gc()
```
        
```{r import Idex Case 5}
NL_table_Index_5 <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-25-11-09 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Pre_Contamination-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Index_5 <- NL_table_Index_5[NL_table_Index_5$scenario==55,]

while (any(grepl('-', names(NL_table_Index_5), fixed = TRUE))) {
  NL_table_Index_5 <- NL_table_Index_5 %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Index_5), fixed = TRUE))) {
  NL_table_Index_5 <- NL_table_Index_5 %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Index_5), fixed = TRUE))) {
  NL_table_Index_5 <- NL_table_Index_5 %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Index_5), fixed = TRUE))) {
  NL_table_Index_5 <- NL_table_Index_5 %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Index_5[ , ..list_columns]

NL_table_Index_5[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Index_5 <- as.data.frame(NL_table_Index_5)

NL_table_Index_5[NL_table_Index_5==-1] <- NA

NL_table_Index_5 <- subset(NL_table_Index_5, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Index_5)[names(NL_table_Index_5)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Index_5)[names(NL_table_Index_5)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Index_5$loading_w1wed_conc_list
vector <- vector[vector!='[]']
index_5_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_loading_w1wed_conc_list <- append(index_5_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_loading_w1wed_conc_matrix <- matrix(unlist(index_5_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_5$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
index_5_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_cleaning_w1wed_conc_list <- append(index_5_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_cleaning_w1wed_conc_matrix <- matrix(unlist(index_5_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_5$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# index_5_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_5_drying_w1wed_conc_list <- append(index_5_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_5$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
index_5_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_sorting_w1wed_conc_list <- append(index_5_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_sorting_w1wed_conc_matrix <- matrix(unlist(index_5_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_5$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
index_5_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_tray_packing_w1wed_conc_list <- append(index_5_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_tray_packing_w1wed_conc_matrix <- matrix(unlist(index_5_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_5$reject_w1wed_conc_list
vector <- vector[vector!='[]']
index_5_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_reject_w1wed_conc_list <- append(index_5_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_reject_w1wed_conc_matrix <- matrix(unlist(index_5_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_5$other_w1wed_conc_list
vector <- vector[vector!='[]']
index_5_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_other_w1wed_conc_list <- append(index_5_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_other_w1wed_conc_matrix <- matrix(unlist(index_5_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

index_5_loading_concs <- as.data.frame(index_5_loading_w1wed_conc_list)
index_5_loading_concs$area <- as.factor('loading')
index_5_loading_concs$scenario <- as.factor('XI_02A5')
index_5_loading_concs$water <- as.factor('Wet')
names(index_5_loading_concs) <- c('concentration','area','scenario','water')

index_5_cleaning_concs <- as.data.frame(index_5_cleaning_w1wed_conc_list)
index_5_cleaning_concs$area <- as.factor('cleaning')
index_5_cleaning_concs$scenario <- as.factor('XI_02A5')
index_5_cleaning_concs$water <- as.factor('Wet')
names(index_5_cleaning_concs) <- c('concentration','area','scenario','water')

index_5_sorting_concs <- as.data.frame(index_5_sorting_w1wed_conc_list)
index_5_sorting_concs$area <- as.factor('sorting')
index_5_sorting_concs$scenario <- as.factor('XI_02A5')
index_5_sorting_concs$water <- as.factor('Dry')
names(index_5_sorting_concs) <- c('concentration','area','scenario','water')

index_5_reject_concs <- as.data.frame(index_5_reject_w1wed_conc_list)
index_5_reject_concs$area <- as.factor('reject')
index_5_reject_concs$scenario <- as.factor('XI_02A5')
index_5_reject_concs$water <- as.factor('Dry')
names(index_5_reject_concs) <- c('concentration','area','scenario','water')

index_5_tray_packing_concs <- as.data.frame(index_5_tray_packing_w1wed_conc_list)
index_5_tray_packing_concs$area <- as.factor('tray packing')
index_5_tray_packing_concs$scenario <- as.factor('XI_02A5')
index_5_tray_packing_concs$water <- as.factor('Dry')
names(index_5_tray_packing_concs) <- c('concentration','area','scenario','water')

index_5_other_concs <- as.data.frame(index_5_other_w1wed_conc_list)
index_5_other_concs$area <- as.factor('other')
index_5_other_concs$scenario <- as.factor('XI_02A5')
index_5_other_concs$water <- as.factor('Dry')
names(index_5_other_concs) <- c('concentration','area','scenario','water')

index_5_w1wed_concs <- rbind(index_5_loading_concs,index_5_cleaning_concs,index_5_sorting_concs,index_5_tray_packing_concs,index_5_reject_concs,index_5_other_concs)

index_5_loading_prev <- as.data.frame(NL_table_Index_5$loading_w1wed_prev[order(NL_table_Index_5$local_seed)])
index_5_loading_prev$area <- as.factor('loading')
index_5_loading_prev$scenario <- as.factor('XI_02A5')
index_5_loading_prev$water <- as.factor('Wet')
names(index_5_loading_prev) <- c('prevalence','area','scenario','water')

index_5_cleaning_prev <- as.data.frame(NL_table_Index_5$cleaning_w1wed_prev[order(NL_table_Index_5$local_seed)])
index_5_cleaning_prev$area <- as.factor('cleaning')
index_5_cleaning_prev$scenario <- as.factor('XI_02A5')
index_5_cleaning_prev$water <- as.factor('Wet')
names(index_5_cleaning_prev) <- c('prevalence','area','scenario','water')

index_5_sorting_prev <- as.data.frame(NL_table_Index_5$sorting_w1wed_prev[order(NL_table_Index_5$local_seed)])
index_5_sorting_prev$area <- as.factor('sorting')
index_5_sorting_prev$scenario <- as.factor('XI_02A5')
index_5_sorting_prev$water <- as.factor('Dry')
names(index_5_sorting_prev) <- c('prevalence','area','scenario','water')

index_5_reject_prev <- as.data.frame(NL_table_Index_5$reject_w1wed_prev[order(NL_table_Index_5$local_seed)])
index_5_reject_prev$area <- as.factor('reject')
index_5_reject_prev$scenario <- as.factor('XI_02A5')
index_5_reject_prev$water <- as.factor('Dry')
names(index_5_reject_prev) <- c('prevalence','area','scenario','water')

index_5_tray_packing_prev <- as.data.frame(NL_table_Index_5$tray_packing_w1wed_prev[order(NL_table_Index_5$local_seed)])
index_5_tray_packing_prev$area <- as.factor('tray packing')
index_5_tray_packing_prev$scenario <- as.factor('XI_02A5')
index_5_tray_packing_prev$water <- as.factor('Dry')
names(index_5_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_5_other_prev <- as.data.frame(NL_table_Index_5$other_w1wed_prev[order(NL_table_Index_5$local_seed)])
index_5_other_prev$area <- as.factor('other')
index_5_other_prev$scenario <- as.factor('XI_02A5')
index_5_other_prev$water <- as.factor('Dry')
names(index_5_other_prev) <- c('prevalence','area','scenario','water')

index_5_w1wed_prev <- rbind(index_5_loading_prev,index_5_cleaning_prev,index_5_sorting_prev,index_5_tray_packing_prev,index_5_reject_prev,index_5_other_prev)

index_5_w1wed_wet_prev <- as.data.frame(index_5_loading_prev$prevalence*21/100+index_5_cleaning_prev$prevalence*28/100)/49*100
index_5_w1wed_wet_prev$scenario <- as.factor('XI_02A5')
index_5_w1wed_wet_prev$water <- as.factor('Wet')
names(index_5_w1wed_wet_prev) <- c('prevalence','scenario','water')

index_5_w1wed_dry_prev <- as.data.frame(index_5_sorting_prev$prevalence*20/100+index_5_reject_prev$prevalence*23/100+index_5_tray_packing_prev$prevalence*123/100+index_5_other_prev$prevalence*10/100)/176*100
index_5_w1wed_dry_prev$scenario <- as.factor('XI_02A5')
index_5_w1wed_dry_prev$water <- as.factor('Dry')
names(index_5_w1wed_dry_prev) <- c('prevalence','scenario','water')

index_5_w1wed_recombined_prev <- rbind(index_5_w1wed_wet_prev, index_5_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Index_5$loading_w2wed_conc_list
vector <- vector[vector!='[]']
index_5_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_loading_w2wed_conc_list <- append(index_5_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_loading_w2wed_conc_matrix <- matrix(unlist(index_5_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_5$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
index_5_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_cleaning_w2wed_conc_list <- append(index_5_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_cleaning_w2wed_conc_matrix <- matrix(unlist(index_5_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_5$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# index_5_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_5_drying_w2wed_conc_list <- append(index_5_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_5$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
index_5_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_sorting_w2wed_conc_list <- append(index_5_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_sorting_w2wed_conc_matrix <- matrix(unlist(index_5_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_5$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
index_5_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_tray_packing_w2wed_conc_list <- append(index_5_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_tray_packing_w2wed_conc_matrix <- matrix(unlist(index_5_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_5$reject_w2wed_conc_list
vector <- vector[vector!='[]']
index_5_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_reject_w2wed_conc_list <- append(index_5_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_reject_w2wed_conc_matrix <- matrix(unlist(index_5_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_5$other_w2wed_conc_list
vector <- vector[vector!='[]']
index_5_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_other_w2wed_conc_list <- append(index_5_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_other_w2wed_conc_matrix <- matrix(unlist(index_5_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

index_5_loading_concs <- as.data.frame(index_5_loading_w2wed_conc_list)
index_5_loading_concs$area <- as.factor('loading')
index_5_loading_concs$scenario <- as.factor('XI_02A5')
index_5_loading_concs$water <- as.factor('Wet')
names(index_5_loading_concs) <- c('concentration','area','scenario','water')

index_5_cleaning_concs <- as.data.frame(index_5_cleaning_w2wed_conc_list)
index_5_cleaning_concs$area <- as.factor('cleaning')
index_5_cleaning_concs$scenario <- as.factor('XI_02A5')
index_5_cleaning_concs$water <- as.factor('Wet')
names(index_5_cleaning_concs) <- c('concentration','area','scenario','water')

index_5_sorting_concs <- as.data.frame(index_5_sorting_w2wed_conc_list)
index_5_sorting_concs$area <- as.factor('sorting')
index_5_sorting_concs$scenario <- as.factor('XI_02A5')
index_5_sorting_concs$water <- as.factor('Dry')
names(index_5_sorting_concs) <- c('concentration','area','scenario','water')

index_5_reject_concs <- as.data.frame(index_5_reject_w2wed_conc_list)
index_5_reject_concs$area <- as.factor('reject')
index_5_reject_concs$scenario <- as.factor('XI_02A5')
index_5_reject_concs$water <- as.factor('Dry')
names(index_5_reject_concs) <- c('concentration','area','scenario','water')

index_5_tray_packing_concs <- as.data.frame(index_5_tray_packing_w2wed_conc_list)
index_5_tray_packing_concs$area <- as.factor('tray packing')
index_5_tray_packing_concs$scenario <- as.factor('XI_02A5')
index_5_tray_packing_concs$water <- as.factor('Dry')
names(index_5_tray_packing_concs) <- c('concentration','area','scenario','water')

index_5_other_concs <- as.data.frame(index_5_other_w2wed_conc_list)
index_5_other_concs$area <- as.factor('other')
index_5_other_concs$scenario <- as.factor('XI_02A5')
index_5_other_concs$water <- as.factor('Dry')
names(index_5_other_concs) <- c('concentration','area','scenario','water')

index_5_w2wed_concs <- rbind(index_5_loading_concs,index_5_cleaning_concs,index_5_sorting_concs,index_5_tray_packing_concs,index_5_reject_concs,index_5_other_concs)

index_5_loading_prev <- as.data.frame(NL_table_Index_5$loading_w2wed_prev[order(NL_table_Index_5$local_seed)])
index_5_loading_prev$area <- as.factor('loading')
index_5_loading_prev$scenario <- as.factor('XI_02A5')
index_5_loading_prev$water <- as.factor('Wet')
names(index_5_loading_prev) <- c('prevalence','area','scenario','water')

index_5_cleaning_prev <- as.data.frame(NL_table_Index_5$cleaning_w2wed_prev[order(NL_table_Index_5$local_seed)])
index_5_cleaning_prev$area <- as.factor('cleaning')
index_5_cleaning_prev$scenario <- as.factor('XI_02A5')
index_5_cleaning_prev$water <- as.factor('Wet')
names(index_5_cleaning_prev) <- c('prevalence','area','scenario','water')

index_5_sorting_prev <- as.data.frame(NL_table_Index_5$sorting_w2wed_prev[order(NL_table_Index_5$local_seed)])
index_5_sorting_prev$area <- as.factor('sorting')
index_5_sorting_prev$scenario <- as.factor('XI_02A5')
index_5_sorting_prev$water <- as.factor('Dry')
names(index_5_sorting_prev) <- c('prevalence','area','scenario','water')

index_5_reject_prev <- as.data.frame(NL_table_Index_5$reject_w2wed_prev[order(NL_table_Index_5$local_seed)])
index_5_reject_prev$area <- as.factor('reject')
index_5_reject_prev$scenario <- as.factor('XI_02A5')
index_5_reject_prev$water <- as.factor('Dry')
names(index_5_reject_prev) <- c('prevalence','area','scenario','water')

index_5_tray_packing_prev <- as.data.frame(NL_table_Index_5$tray_packing_w2wed_prev[order(NL_table_Index_5$local_seed)])
index_5_tray_packing_prev$area <- as.factor('tray packing')
index_5_tray_packing_prev$scenario <- as.factor('XI_02A5')
index_5_tray_packing_prev$water <- as.factor('Dry')
names(index_5_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_5_other_prev <- as.data.frame(NL_table_Index_5$other_w2wed_prev[order(NL_table_Index_5$local_seed)])
index_5_other_prev$area <- as.factor('other')
index_5_other_prev$scenario <- as.factor('XI_02A5')
index_5_other_prev$water <- as.factor('Dry')
names(index_5_other_prev) <- c('prevalence','area','scenario','water')

index_5_w2wed_prev <- rbind(index_5_loading_prev,index_5_cleaning_prev,index_5_sorting_prev,index_5_tray_packing_prev,index_5_reject_prev,index_5_other_prev)

index_5_w2wed_wet_prev <- as.data.frame(index_5_loading_prev$prevalence*21/100+index_5_cleaning_prev$prevalence*28/100)/49*100
index_5_w2wed_wet_prev$scenario <- as.factor('XI_02A5')
index_5_w2wed_wet_prev$water <- as.factor('Wet')
names(index_5_w2wed_wet_prev) <- c('prevalence','scenario','water')

index_5_w2wed_dry_prev <- as.data.frame(index_5_sorting_prev$prevalence*20/100+index_5_reject_prev$prevalence*23/100+index_5_tray_packing_prev$prevalence*123/100+index_5_other_prev$prevalence*10/100)/176*100
index_5_w2wed_dry_prev$scenario <- as.factor('XI_02A5')
index_5_w2wed_dry_prev$water <- as.factor('Dry')
names(index_5_w2wed_dry_prev) <- c('prevalence','scenario','water')

index_5_w2wed_recombined_prev <- rbind(index_5_w2wed_wet_prev, index_5_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Index_5$loading_w3wed_conc_list
vector <- vector[vector!='[]']
index_5_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_loading_w3wed_conc_list <- append(index_5_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_loading_w3wed_conc_matrix <- matrix(unlist(index_5_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_5$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
index_5_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_cleaning_w3wed_conc_list <- append(index_5_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_cleaning_w3wed_conc_matrix <- matrix(unlist(index_5_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_5$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# index_5_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_5_drying_w3wed_conc_list <- append(index_5_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_5$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
index_5_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_sorting_w3wed_conc_list <- append(index_5_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_sorting_w3wed_conc_matrix <- matrix(unlist(index_5_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_5$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
index_5_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_tray_packing_w3wed_conc_list <- append(index_5_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_tray_packing_w3wed_conc_matrix <- matrix(unlist(index_5_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_5$reject_w3wed_conc_list
vector <- vector[vector!='[]']
index_5_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_reject_w3wed_conc_list <- append(index_5_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_reject_w3wed_conc_matrix <- matrix(unlist(index_5_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_5$other_w3wed_conc_list
vector <- vector[vector!='[]']
index_5_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_other_w3wed_conc_list <- append(index_5_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_other_w3wed_conc_matrix <- matrix(unlist(index_5_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

index_5_loading_concs <- as.data.frame(index_5_loading_w3wed_conc_list)
index_5_loading_concs$area <- as.factor('loading')
index_5_loading_concs$scenario <- as.factor('XI_02A5')
index_5_loading_concs$water <- as.factor('Wet')
names(index_5_loading_concs) <- c('concentration','area','scenario','water')

index_5_cleaning_concs <- as.data.frame(index_5_cleaning_w3wed_conc_list)
index_5_cleaning_concs$area <- as.factor('cleaning')
index_5_cleaning_concs$scenario <- as.factor('XI_02A5')
index_5_cleaning_concs$water <- as.factor('Wet')
names(index_5_cleaning_concs) <- c('concentration','area','scenario','water')

index_5_sorting_concs <- as.data.frame(index_5_sorting_w3wed_conc_list)
index_5_sorting_concs$area <- as.factor('sorting')
index_5_sorting_concs$scenario <- as.factor('XI_02A5')
index_5_sorting_concs$water <- as.factor('Dry')
names(index_5_sorting_concs) <- c('concentration','area','scenario','water')

index_5_reject_concs <- as.data.frame(index_5_reject_w3wed_conc_list)
index_5_reject_concs$area <- as.factor('reject')
index_5_reject_concs$scenario <- as.factor('XI_02A5')
index_5_reject_concs$water <- as.factor('Dry')
names(index_5_reject_concs) <- c('concentration','area','scenario','water')

index_5_tray_packing_concs <- as.data.frame(index_5_tray_packing_w3wed_conc_list)
index_5_tray_packing_concs$area <- as.factor('tray packing')
index_5_tray_packing_concs$scenario <- as.factor('XI_02A5')
index_5_tray_packing_concs$water <- as.factor('Dry')
names(index_5_tray_packing_concs) <- c('concentration','area','scenario','water')

index_5_other_concs <- as.data.frame(index_5_other_w3wed_conc_list)
index_5_other_concs$area <- as.factor('other')
index_5_other_concs$scenario <- as.factor('XI_02A5')
index_5_other_concs$water <- as.factor('Dry')
names(index_5_other_concs) <- c('concentration','area','scenario','water')

index_5_w3wed_concs <- rbind(index_5_loading_concs,index_5_cleaning_concs,index_5_sorting_concs,index_5_tray_packing_concs,index_5_reject_concs,index_5_other_concs)

index_5_loading_prev <- as.data.frame(NL_table_Index_5$loading_w3wed_prev[order(NL_table_Index_5$local_seed)])
index_5_loading_prev$area <- as.factor('loading')
index_5_loading_prev$scenario <- as.factor('XI_02A5')
index_5_loading_prev$water <- as.factor('Wet')
names(index_5_loading_prev) <- c('prevalence','area','scenario','water')

index_5_cleaning_prev <- as.data.frame(NL_table_Index_5$cleaning_w3wed_prev[order(NL_table_Index_5$local_seed)])
index_5_cleaning_prev$area <- as.factor('cleaning')
index_5_cleaning_prev$scenario <- as.factor('XI_02A5')
index_5_cleaning_prev$water <- as.factor('Wet')
names(index_5_cleaning_prev) <- c('prevalence','area','scenario','water')

index_5_sorting_prev <- as.data.frame(NL_table_Index_5$sorting_w3wed_prev[order(NL_table_Index_5$local_seed)])
index_5_sorting_prev$area <- as.factor('sorting')
index_5_sorting_prev$scenario <- as.factor('XI_02A5')
index_5_sorting_prev$water <- as.factor('Dry')
names(index_5_sorting_prev) <- c('prevalence','area','scenario','water')

index_5_reject_prev <- as.data.frame(NL_table_Index_5$reject_w3wed_prev[order(NL_table_Index_5$local_seed)])
index_5_reject_prev$area <- as.factor('reject')
index_5_reject_prev$scenario <- as.factor('XI_02A5')
index_5_reject_prev$water <- as.factor('Dry')
names(index_5_reject_prev) <- c('prevalence','area','scenario','water')

index_5_tray_packing_prev <- as.data.frame(NL_table_Index_5$tray_packing_w3wed_prev[order(NL_table_Index_5$local_seed)])
index_5_tray_packing_prev$area <- as.factor('tray packing')
index_5_tray_packing_prev$scenario <- as.factor('XI_02A5')
index_5_tray_packing_prev$water <- as.factor('Dry')
names(index_5_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_5_other_prev <- as.data.frame(NL_table_Index_5$other_w3wed_prev[order(NL_table_Index_5$local_seed)])
index_5_other_prev$area <- as.factor('other')
index_5_other_prev$scenario <- as.factor('XI_02A5')
index_5_other_prev$water <- as.factor('Dry')
names(index_5_other_prev) <- c('prevalence','area','scenario','water')

index_5_w3wed_prev <- rbind(index_5_loading_prev,index_5_cleaning_prev,index_5_sorting_prev,index_5_tray_packing_prev,index_5_reject_prev,index_5_other_prev)

index_5_w3wed_wet_prev <- as.data.frame(index_5_loading_prev$prevalence*21/100+index_5_cleaning_prev$prevalence*28/100)/49*100
index_5_w3wed_wet_prev$scenario <- as.factor('XI_02A5')
index_5_w3wed_wet_prev$water <- as.factor('Wet')
names(index_5_w3wed_wet_prev) <- c('prevalence','scenario','water')

index_5_w3wed_dry_prev <- as.data.frame(index_5_sorting_prev$prevalence*20/100+index_5_reject_prev$prevalence*23/100+index_5_tray_packing_prev$prevalence*123/100+index_5_other_prev$prevalence*10/100)/176*100
index_5_w3wed_dry_prev$scenario <- as.factor('XI_02A5')
index_5_w3wed_dry_prev$water <- as.factor('Dry')
names(index_5_w3wed_dry_prev) <- c('prevalence','scenario','water')

index_5_w3wed_recombined_prev <- rbind(index_5_w3wed_wet_prev, index_5_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Index_5$loading_w4wed_conc_list
vector <- vector[vector!='[]']
index_5_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_loading_w4wed_conc_list <- append(index_5_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_loading_w4wed_conc_matrix <- matrix(unlist(index_5_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_5$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
index_5_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_cleaning_w4wed_conc_list <- append(index_5_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_cleaning_w4wed_conc_matrix <- matrix(unlist(index_5_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_5$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# index_5_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_5_drying_w4wed_conc_list <- append(index_5_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_5$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
index_5_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_sorting_w4wed_conc_list <- append(index_5_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_sorting_w4wed_conc_matrix <- matrix(unlist(index_5_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_5$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
index_5_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_tray_packing_w4wed_conc_list <- append(index_5_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_tray_packing_w4wed_conc_matrix <- matrix(unlist(index_5_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_5$reject_w4wed_conc_list
vector <- vector[vector!='[]']
index_5_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_reject_w4wed_conc_list <- append(index_5_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_reject_w4wed_conc_matrix <- matrix(unlist(index_5_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_5$other_w4wed_conc_list
vector <- vector[vector!='[]']
index_5_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_other_w4wed_conc_list <- append(index_5_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_other_w4wed_conc_matrix <- matrix(unlist(index_5_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

index_5_loading_concs <- as.data.frame(index_5_loading_w4wed_conc_list)
index_5_loading_concs$area <- as.factor('loading')
index_5_loading_concs$scenario <- as.factor('XI_02A5')
index_5_loading_concs$water <- as.factor('Wet')
names(index_5_loading_concs) <- c('concentration','area','scenario','water')

index_5_cleaning_concs <- as.data.frame(index_5_cleaning_w4wed_conc_list)
index_5_cleaning_concs$area <- as.factor('cleaning')
index_5_cleaning_concs$scenario <- as.factor('XI_02A5')
index_5_cleaning_concs$water <- as.factor('Wet')
names(index_5_cleaning_concs) <- c('concentration','area','scenario','water')

index_5_sorting_concs <- as.data.frame(index_5_sorting_w4wed_conc_list)
index_5_sorting_concs$area <- as.factor('sorting')
index_5_sorting_concs$scenario <- as.factor('XI_02A5')
index_5_sorting_concs$water <- as.factor('Dry')
names(index_5_sorting_concs) <- c('concentration','area','scenario','water')

index_5_reject_concs <- as.data.frame(index_5_reject_w4wed_conc_list)
index_5_reject_concs$area <- as.factor('reject')
index_5_reject_concs$scenario <- as.factor('XI_02A5')
index_5_reject_concs$water <- as.factor('Dry')
names(index_5_reject_concs) <- c('concentration','area','scenario','water')

index_5_tray_packing_concs <- as.data.frame(index_5_tray_packing_w4wed_conc_list)
index_5_tray_packing_concs$area <- as.factor('tray packing')
index_5_tray_packing_concs$scenario <- as.factor('XI_02A5')
index_5_tray_packing_concs$water <- as.factor('Dry')
names(index_5_tray_packing_concs) <- c('concentration','area','scenario','water')

index_5_other_concs <- as.data.frame(index_5_other_w4wed_conc_list)
index_5_other_concs$area <- as.factor('other')
index_5_other_concs$scenario <- as.factor('XI_02A5')
index_5_other_concs$water <- as.factor('Dry')
names(index_5_other_concs) <- c('concentration','area','scenario','water')

index_5_w4wed_concs <- rbind(index_5_loading_concs,index_5_cleaning_concs,index_5_sorting_concs,index_5_tray_packing_concs,index_5_reject_concs,index_5_other_concs)

index_5_loading_prev <- as.data.frame(NL_table_Index_5$loading_w4wed_prev[order(NL_table_Index_5$local_seed)])
index_5_loading_prev$area <- as.factor('loading')
index_5_loading_prev$scenario <- as.factor('XI_02A5')
index_5_loading_prev$water <- as.factor('Wet')
names(index_5_loading_prev) <- c('prevalence','area','scenario','water')

index_5_cleaning_prev <- as.data.frame(NL_table_Index_5$cleaning_w4wed_prev[order(NL_table_Index_5$local_seed)])
index_5_cleaning_prev$area <- as.factor('cleaning')
index_5_cleaning_prev$scenario <- as.factor('XI_02A5')
index_5_cleaning_prev$water <- as.factor('Wet')
names(index_5_cleaning_prev) <- c('prevalence','area','scenario','water')

index_5_sorting_prev <- as.data.frame(NL_table_Index_5$sorting_w4wed_prev[order(NL_table_Index_5$local_seed)])
index_5_sorting_prev$area <- as.factor('sorting')
index_5_sorting_prev$scenario <- as.factor('XI_02A5')
index_5_sorting_prev$water <- as.factor('Dry')
names(index_5_sorting_prev) <- c('prevalence','area','scenario','water')

index_5_reject_prev <- as.data.frame(NL_table_Index_5$reject_w4wed_prev[order(NL_table_Index_5$local_seed)])
index_5_reject_prev$area <- as.factor('reject')
index_5_reject_prev$scenario <- as.factor('XI_02A5')
index_5_reject_prev$water <- as.factor('Dry')
names(index_5_reject_prev) <- c('prevalence','area','scenario','water')

index_5_tray_packing_prev <- as.data.frame(NL_table_Index_5$tray_packing_w4wed_prev[order(NL_table_Index_5$local_seed)])
index_5_tray_packing_prev$area <- as.factor('tray packing')
index_5_tray_packing_prev$scenario <- as.factor('XI_02A5')
index_5_tray_packing_prev$water <- as.factor('Dry')
names(index_5_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_5_other_prev <- as.data.frame(NL_table_Index_5$other_w4wed_prev[order(NL_table_Index_5$local_seed)])
index_5_other_prev$area <- as.factor('other')
index_5_other_prev$scenario <- as.factor('XI_02A5')
index_5_other_prev$water <- as.factor('Dry')
names(index_5_other_prev) <- c('prevalence','area','scenario','water')

index_5_w4wed_prev <- rbind(index_5_loading_prev,index_5_cleaning_prev,index_5_sorting_prev,index_5_tray_packing_prev,index_5_reject_prev,index_5_other_prev)

index_5_w4wed_wet_prev <- as.data.frame(index_5_loading_prev$prevalence*21/100+index_5_cleaning_prev$prevalence*28/100)/49*100
index_5_w4wed_wet_prev$scenario <- as.factor('XI_02A5')
index_5_w4wed_wet_prev$water <- as.factor('Wet')
names(index_5_w4wed_wet_prev) <- c('prevalence','scenario','water')

index_5_w4wed_dry_prev <- as.data.frame(index_5_sorting_prev$prevalence*20/100+index_5_reject_prev$prevalence*23/100+index_5_tray_packing_prev$prevalence*123/100+index_5_other_prev$prevalence*10/100)/176*100
index_5_w4wed_dry_prev$scenario <- as.factor('XI_02A5')
index_5_w4wed_dry_prev$water <- as.factor('Dry')
names(index_5_w4wed_dry_prev) <- c('prevalence','scenario','water')

index_5_w4wed_recombined_prev <- rbind(index_5_w4wed_wet_prev, index_5_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Index_5$loading_w5wed_conc_list
vector <- vector[vector!='[]']
index_5_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_loading_w5wed_conc_list <- append(index_5_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_loading_w5wed_conc_matrix <- matrix(unlist(index_5_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_5$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
index_5_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_cleaning_w5wed_conc_list <- append(index_5_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_cleaning_w5wed_conc_matrix <- matrix(unlist(index_5_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_5$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# index_5_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_5_drying_w5wed_conc_list <- append(index_5_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_5$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
index_5_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_sorting_w5wed_conc_list <- append(index_5_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_sorting_w5wed_conc_matrix <- matrix(unlist(index_5_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_5$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
index_5_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_tray_packing_w5wed_conc_list <- append(index_5_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_tray_packing_w5wed_conc_matrix <- matrix(unlist(index_5_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_5$reject_w5wed_conc_list
vector <- vector[vector!='[]']
index_5_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_reject_w5wed_conc_list <- append(index_5_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_reject_w5wed_conc_matrix <- matrix(unlist(index_5_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_5$other_w5wed_conc_list
vector <- vector[vector!='[]']
index_5_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_other_w5wed_conc_list <- append(index_5_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_other_w5wed_conc_matrix <- matrix(unlist(index_5_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

index_5_loading_concs <- as.data.frame(index_5_loading_w5wed_conc_list)
index_5_loading_concs$area <- as.factor('loading')
index_5_loading_concs$scenario <- as.factor('XI_02A5')
index_5_loading_concs$water <- as.factor('Wet')
names(index_5_loading_concs) <- c('concentration','area','scenario','water')

index_5_cleaning_concs <- as.data.frame(index_5_cleaning_w5wed_conc_list)
index_5_cleaning_concs$area <- as.factor('cleaning')
index_5_cleaning_concs$scenario <- as.factor('XI_02A5')
index_5_cleaning_concs$water <- as.factor('Wet')
names(index_5_cleaning_concs) <- c('concentration','area','scenario','water')

index_5_sorting_concs <- as.data.frame(index_5_sorting_w5wed_conc_list)
index_5_sorting_concs$area <- as.factor('sorting')
index_5_sorting_concs$scenario <- as.factor('XI_02A5')
index_5_sorting_concs$water <- as.factor('Dry')
names(index_5_sorting_concs) <- c('concentration','area','scenario','water')

index_5_reject_concs <- as.data.frame(index_5_reject_w5wed_conc_list)
index_5_reject_concs$area <- as.factor('reject')
index_5_reject_concs$scenario <- as.factor('XI_02A5')
index_5_reject_concs$water <- as.factor('Dry')
names(index_5_reject_concs) <- c('concentration','area','scenario','water')

index_5_tray_packing_concs <- as.data.frame(index_5_tray_packing_w5wed_conc_list)
index_5_tray_packing_concs$area <- as.factor('tray packing')
index_5_tray_packing_concs$scenario <- as.factor('XI_02A5')
index_5_tray_packing_concs$water <- as.factor('Dry')
names(index_5_tray_packing_concs) <- c('concentration','area','scenario','water')

index_5_other_concs <- as.data.frame(index_5_other_w5wed_conc_list)
index_5_other_concs$area <- as.factor('other')
index_5_other_concs$scenario <- as.factor('XI_02A5')
index_5_other_concs$water <- as.factor('Dry')
names(index_5_other_concs) <- c('concentration','area','scenario','water')

index_5_w5wed_concs <- rbind(index_5_loading_concs,index_5_cleaning_concs,index_5_sorting_concs,index_5_tray_packing_concs,index_5_reject_concs,index_5_other_concs)

index_5_loading_prev <- as.data.frame(NL_table_Index_5$loading_w5wed_prev[order(NL_table_Index_5$local_seed)])
index_5_loading_prev$area <- as.factor('loading')
index_5_loading_prev$scenario <- as.factor('XI_02A5')
index_5_loading_prev$water <- as.factor('Wet')
names(index_5_loading_prev) <- c('prevalence','area','scenario','water')

index_5_cleaning_prev <- as.data.frame(NL_table_Index_5$cleaning_w5wed_prev[order(NL_table_Index_5$local_seed)])
index_5_cleaning_prev$area <- as.factor('cleaning')
index_5_cleaning_prev$scenario <- as.factor('XI_02A5')
index_5_cleaning_prev$water <- as.factor('Wet')
names(index_5_cleaning_prev) <- c('prevalence','area','scenario','water')

index_5_sorting_prev <- as.data.frame(NL_table_Index_5$sorting_w5wed_prev[order(NL_table_Index_5$local_seed)])
index_5_sorting_prev$area <- as.factor('sorting')
index_5_sorting_prev$scenario <- as.factor('XI_02A5')
index_5_sorting_prev$water <- as.factor('Dry')
names(index_5_sorting_prev) <- c('prevalence','area','scenario','water')

index_5_reject_prev <- as.data.frame(NL_table_Index_5$reject_w5wed_prev[order(NL_table_Index_5$local_seed)])
index_5_reject_prev$area <- as.factor('reject')
index_5_reject_prev$scenario <- as.factor('XI_02A5')
index_5_reject_prev$water <- as.factor('Dry')
names(index_5_reject_prev) <- c('prevalence','area','scenario','water')

index_5_tray_packing_prev <- as.data.frame(NL_table_Index_5$tray_packing_w5wed_prev[order(NL_table_Index_5$local_seed)])
index_5_tray_packing_prev$area <- as.factor('tray packing')
index_5_tray_packing_prev$scenario <- as.factor('XI_02A5')
index_5_tray_packing_prev$water <- as.factor('Dry')
names(index_5_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_5_other_prev <- as.data.frame(NL_table_Index_5$other_w5wed_prev[order(NL_table_Index_5$local_seed)])
index_5_other_prev$area <- as.factor('other')
index_5_other_prev$scenario <- as.factor('XI_02A5')
index_5_other_prev$water <- as.factor('Dry')
names(index_5_other_prev) <- c('prevalence','area','scenario','water')

index_5_w5wed_prev <- rbind(index_5_loading_prev,index_5_cleaning_prev,index_5_sorting_prev,index_5_tray_packing_prev,index_5_reject_prev,index_5_other_prev)

index_5_w5wed_wet_prev <- as.data.frame(index_5_loading_prev$prevalence*21/100+index_5_cleaning_prev$prevalence*28/100)/49*100
index_5_w5wed_wet_prev$scenario <- as.factor('XI_02A5')
index_5_w5wed_wet_prev$water <- as.factor('Wet')
names(index_5_w5wed_wet_prev) <- c('prevalence','scenario','water')

index_5_w5wed_dry_prev <- as.data.frame(index_5_sorting_prev$prevalence*20/100+index_5_reject_prev$prevalence*23/100+index_5_tray_packing_prev$prevalence*123/100+index_5_other_prev$prevalence*10/100)/176*100
index_5_w5wed_dry_prev$scenario <- as.factor('XI_02A5')
index_5_w5wed_dry_prev$water <- as.factor('Dry')
names(index_5_w5wed_dry_prev) <- c('prevalence','scenario','water')

index_5_w5wed_recombined_prev <- rbind(index_5_w5wed_wet_prev, index_5_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Index_5$loading_w6wed_conc_list
vector <- vector[vector!='[]']
index_5_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_loading_w6wed_conc_list <- append(index_5_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_loading_w6wed_conc_matrix <- matrix(unlist(index_5_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_5$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
index_5_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_cleaning_w6wed_conc_list <- append(index_5_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_cleaning_w6wed_conc_matrix <- matrix(unlist(index_5_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_5$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# index_5_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_5_drying_w6wed_conc_list <- append(index_5_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_5$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
index_5_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_sorting_w6wed_conc_list <- append(index_5_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_sorting_w6wed_conc_matrix <- matrix(unlist(index_5_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_5$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
index_5_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_tray_packing_w6wed_conc_list <- append(index_5_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_tray_packing_w6wed_conc_matrix <- matrix(unlist(index_5_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_5$reject_w6wed_conc_list
vector <- vector[vector!='[]']
index_5_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_reject_w6wed_conc_list <- append(index_5_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_reject_w6wed_conc_matrix <- matrix(unlist(index_5_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_5$other_w6wed_conc_list
vector <- vector[vector!='[]']
index_5_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_other_w6wed_conc_list <- append(index_5_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_other_w6wed_conc_matrix <- matrix(unlist(index_5_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

index_5_loading_concs <- as.data.frame(index_5_loading_w6wed_conc_list)
index_5_loading_concs$area <- as.factor('loading')
index_5_loading_concs$scenario <- as.factor('XI_02A5')
index_5_loading_concs$water <- as.factor('Wet')
names(index_5_loading_concs) <- c('concentration','area','scenario','water')

index_5_cleaning_concs <- as.data.frame(index_5_cleaning_w6wed_conc_list)
index_5_cleaning_concs$area <- as.factor('cleaning')
index_5_cleaning_concs$scenario <- as.factor('XI_02A5')
index_5_cleaning_concs$water <- as.factor('Wet')
names(index_5_cleaning_concs) <- c('concentration','area','scenario','water')

index_5_sorting_concs <- as.data.frame(index_5_sorting_w6wed_conc_list)
index_5_sorting_concs$area <- as.factor('sorting')
index_5_sorting_concs$scenario <- as.factor('XI_02A5')
index_5_sorting_concs$water <- as.factor('Dry')
names(index_5_sorting_concs) <- c('concentration','area','scenario','water')

index_5_reject_concs <- as.data.frame(index_5_reject_w6wed_conc_list)
index_5_reject_concs$area <- as.factor('reject')
index_5_reject_concs$scenario <- as.factor('XI_02A5')
index_5_reject_concs$water <- as.factor('Dry')
names(index_5_reject_concs) <- c('concentration','area','scenario','water')

index_5_tray_packing_concs <- as.data.frame(index_5_tray_packing_w6wed_conc_list)
index_5_tray_packing_concs$area <- as.factor('tray packing')
index_5_tray_packing_concs$scenario <- as.factor('XI_02A5')
index_5_tray_packing_concs$water <- as.factor('Dry')
names(index_5_tray_packing_concs) <- c('concentration','area','scenario','water')

index_5_other_concs <- as.data.frame(index_5_other_w6wed_conc_list)
index_5_other_concs$area <- as.factor('other')
index_5_other_concs$scenario <- as.factor('XI_02A5')
index_5_other_concs$water <- as.factor('Dry')
names(index_5_other_concs) <- c('concentration','area','scenario','water')

index_5_w6wed_concs <- rbind(index_5_loading_concs,index_5_cleaning_concs,index_5_sorting_concs,index_5_tray_packing_concs,index_5_reject_concs,index_5_other_concs)

index_5_loading_prev <- as.data.frame(NL_table_Index_5$loading_w6wed_prev[order(NL_table_Index_5$local_seed)])
index_5_loading_prev$area <- as.factor('loading')
index_5_loading_prev$scenario <- as.factor('XI_02A5')
index_5_loading_prev$water <- as.factor('Wet')
names(index_5_loading_prev) <- c('prevalence','area','scenario','water')

index_5_cleaning_prev <- as.data.frame(NL_table_Index_5$cleaning_w6wed_prev[order(NL_table_Index_5$local_seed)])
index_5_cleaning_prev$area <- as.factor('cleaning')
index_5_cleaning_prev$scenario <- as.factor('XI_02A5')
index_5_cleaning_prev$water <- as.factor('Wet')
names(index_5_cleaning_prev) <- c('prevalence','area','scenario','water')

index_5_sorting_prev <- as.data.frame(NL_table_Index_5$sorting_w6wed_prev[order(NL_table_Index_5$local_seed)])
index_5_sorting_prev$area <- as.factor('sorting')
index_5_sorting_prev$scenario <- as.factor('XI_02A5')
index_5_sorting_prev$water <- as.factor('Dry')
names(index_5_sorting_prev) <- c('prevalence','area','scenario','water')

index_5_reject_prev <- as.data.frame(NL_table_Index_5$reject_w6wed_prev[order(NL_table_Index_5$local_seed)])
index_5_reject_prev$area <- as.factor('reject')
index_5_reject_prev$scenario <- as.factor('XI_02A5')
index_5_reject_prev$water <- as.factor('Dry')
names(index_5_reject_prev) <- c('prevalence','area','scenario','water')

index_5_tray_packing_prev <- as.data.frame(NL_table_Index_5$tray_packing_w6wed_prev[order(NL_table_Index_5$local_seed)])
index_5_tray_packing_prev$area <- as.factor('tray packing')
index_5_tray_packing_prev$scenario <- as.factor('XI_02A5')
index_5_tray_packing_prev$water <- as.factor('Dry')
names(index_5_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_5_other_prev <- as.data.frame(NL_table_Index_5$other_w6wed_prev[order(NL_table_Index_5$local_seed)])
index_5_other_prev$area <- as.factor('other')
index_5_other_prev$scenario <- as.factor('XI_02A5')
index_5_other_prev$water <- as.factor('Dry')
names(index_5_other_prev) <- c('prevalence','area','scenario','water')

index_5_w6wed_prev <- rbind(index_5_loading_prev,index_5_cleaning_prev,index_5_sorting_prev,index_5_tray_packing_prev,index_5_reject_prev,index_5_other_prev)

index_5_w6wed_wet_prev <- as.data.frame(index_5_loading_prev$prevalence*21/100+index_5_cleaning_prev$prevalence*28/100)/49*100
index_5_w6wed_wet_prev$scenario <- as.factor('XI_02A5')
index_5_w6wed_wet_prev$water <- as.factor('Wet')
names(index_5_w6wed_wet_prev) <- c('prevalence','scenario','water')

index_5_w6wed_dry_prev <- as.data.frame(index_5_sorting_prev$prevalence*20/100+index_5_reject_prev$prevalence*23/100+index_5_tray_packing_prev$prevalence*123/100+index_5_other_prev$prevalence*10/100)/176*100
index_5_w6wed_dry_prev$scenario <- as.factor('XI_02A5')
index_5_w6wed_dry_prev$water <- as.factor('Dry')
names(index_5_w6wed_dry_prev) <- c('prevalence','scenario','water')

index_5_w6wed_recombined_prev <- rbind(index_5_w6wed_wet_prev, index_5_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Index_5$loading_w7wed_conc_list
vector <- vector[vector!='[]']
index_5_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_loading_w7wed_conc_list <- append(index_5_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_loading_w7wed_conc_matrix <- matrix(unlist(index_5_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_5$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
index_5_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_cleaning_w7wed_conc_list <- append(index_5_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_cleaning_w7wed_conc_matrix <- matrix(unlist(index_5_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_5$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# index_5_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_5_drying_w7wed_conc_list <- append(index_5_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_5$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
index_5_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_sorting_w7wed_conc_list <- append(index_5_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_sorting_w7wed_conc_matrix <- matrix(unlist(index_5_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_5$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
index_5_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_tray_packing_w7wed_conc_list <- append(index_5_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_tray_packing_w7wed_conc_matrix <- matrix(unlist(index_5_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_5$reject_w7wed_conc_list
vector <- vector[vector!='[]']
index_5_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_reject_w7wed_conc_list <- append(index_5_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_reject_w7wed_conc_matrix <- matrix(unlist(index_5_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_5$other_w7wed_conc_list
vector <- vector[vector!='[]']
index_5_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_other_w7wed_conc_list <- append(index_5_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_other_w7wed_conc_matrix <- matrix(unlist(index_5_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

index_5_loading_concs <- as.data.frame(index_5_loading_w7wed_conc_list)
index_5_loading_concs$area <- as.factor('loading')
index_5_loading_concs$scenario <- as.factor('XI_02A5')
index_5_loading_concs$water <- as.factor('Wet')
names(index_5_loading_concs) <- c('concentration','area','scenario','water')

index_5_cleaning_concs <- as.data.frame(index_5_cleaning_w7wed_conc_list)
index_5_cleaning_concs$area <- as.factor('cleaning')
index_5_cleaning_concs$scenario <- as.factor('XI_02A5')
index_5_cleaning_concs$water <- as.factor('Wet')
names(index_5_cleaning_concs) <- c('concentration','area','scenario','water')

index_5_sorting_concs <- as.data.frame(index_5_sorting_w7wed_conc_list)
index_5_sorting_concs$area <- as.factor('sorting')
index_5_sorting_concs$scenario <- as.factor('XI_02A5')
index_5_sorting_concs$water <- as.factor('Dry')
names(index_5_sorting_concs) <- c('concentration','area','scenario','water')

index_5_reject_concs <- as.data.frame(index_5_reject_w7wed_conc_list)
index_5_reject_concs$area <- as.factor('reject')
index_5_reject_concs$scenario <- as.factor('XI_02A5')
index_5_reject_concs$water <- as.factor('Dry')
names(index_5_reject_concs) <- c('concentration','area','scenario','water')

index_5_tray_packing_concs <- as.data.frame(index_5_tray_packing_w7wed_conc_list)
index_5_tray_packing_concs$area <- as.factor('tray packing')
index_5_tray_packing_concs$scenario <- as.factor('XI_02A5')
index_5_tray_packing_concs$water <- as.factor('Dry')
names(index_5_tray_packing_concs) <- c('concentration','area','scenario','water')

index_5_other_concs <- as.data.frame(index_5_other_w7wed_conc_list)
index_5_other_concs$area <- as.factor('other')
index_5_other_concs$scenario <- as.factor('XI_02A5')
index_5_other_concs$water <- as.factor('Dry')
names(index_5_other_concs) <- c('concentration','area','scenario','water')

index_5_w7wed_concs <- rbind(index_5_loading_concs,index_5_cleaning_concs,index_5_sorting_concs,index_5_tray_packing_concs,index_5_reject_concs,index_5_other_concs)

index_5_loading_prev <- as.data.frame(NL_table_Index_5$loading_w7wed_prev[order(NL_table_Index_5$local_seed)])
index_5_loading_prev$area <- as.factor('loading')
index_5_loading_prev$scenario <- as.factor('XI_02A5')
index_5_loading_prev$water <- as.factor('Wet')
names(index_5_loading_prev) <- c('prevalence','area','scenario','water')

index_5_cleaning_prev <- as.data.frame(NL_table_Index_5$cleaning_w7wed_prev[order(NL_table_Index_5$local_seed)])
index_5_cleaning_prev$area <- as.factor('cleaning')
index_5_cleaning_prev$scenario <- as.factor('XI_02A5')
index_5_cleaning_prev$water <- as.factor('Wet')
names(index_5_cleaning_prev) <- c('prevalence','area','scenario','water')

index_5_sorting_prev <- as.data.frame(NL_table_Index_5$sorting_w7wed_prev[order(NL_table_Index_5$local_seed)])
index_5_sorting_prev$area <- as.factor('sorting')
index_5_sorting_prev$scenario <- as.factor('XI_02A5')
index_5_sorting_prev$water <- as.factor('Dry')
names(index_5_sorting_prev) <- c('prevalence','area','scenario','water')

index_5_reject_prev <- as.data.frame(NL_table_Index_5$reject_w7wed_prev[order(NL_table_Index_5$local_seed)])
index_5_reject_prev$area <- as.factor('reject')
index_5_reject_prev$scenario <- as.factor('XI_02A5')
index_5_reject_prev$water <- as.factor('Dry')
names(index_5_reject_prev) <- c('prevalence','area','scenario','water')

index_5_tray_packing_prev <- as.data.frame(NL_table_Index_5$tray_packing_w7wed_prev[order(NL_table_Index_5$local_seed)])
index_5_tray_packing_prev$area <- as.factor('tray packing')
index_5_tray_packing_prev$scenario <- as.factor('XI_02A5')
index_5_tray_packing_prev$water <- as.factor('Dry')
names(index_5_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_5_other_prev <- as.data.frame(NL_table_Index_5$other_w7wed_prev[order(NL_table_Index_5$local_seed)])
index_5_other_prev$area <- as.factor('other')
index_5_other_prev$scenario <- as.factor('XI_02A5')
index_5_other_prev$water <- as.factor('Dry')
names(index_5_other_prev) <- c('prevalence','area','scenario','water')

index_5_w7wed_prev <- rbind(index_5_loading_prev,index_5_cleaning_prev,index_5_sorting_prev,index_5_tray_packing_prev,index_5_reject_prev,index_5_other_prev)

index_5_w7wed_wet_prev <- as.data.frame(index_5_loading_prev$prevalence*21/100+index_5_cleaning_prev$prevalence*28/100)/49*100
index_5_w7wed_wet_prev$scenario <- as.factor('XI_02A5')
index_5_w7wed_wet_prev$water <- as.factor('Wet')
names(index_5_w7wed_wet_prev) <- c('prevalence','scenario','water')

index_5_w7wed_dry_prev <- as.data.frame(index_5_sorting_prev$prevalence*20/100+index_5_reject_prev$prevalence*23/100+index_5_tray_packing_prev$prevalence*123/100+index_5_other_prev$prevalence*10/100)/176*100
index_5_w7wed_dry_prev$scenario <- as.factor('XI_02A5')
index_5_w7wed_dry_prev$water <- as.factor('Dry')
names(index_5_w7wed_dry_prev) <- c('prevalence','scenario','water')

index_5_w7wed_recombined_prev <- rbind(index_5_w7wed_wet_prev, index_5_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Index_5$loading_w8wed_conc_list
vector <- vector[vector!='[]']
index_5_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_loading_w8wed_conc_list <- append(index_5_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_loading_w8wed_conc_matrix <- matrix(unlist(index_5_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_5$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
index_5_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_cleaning_w8wed_conc_list <- append(index_5_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_cleaning_w8wed_conc_matrix <- matrix(unlist(index_5_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_5$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# index_5_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_5_drying_w8wed_conc_list <- append(index_5_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_5$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
index_5_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_sorting_w8wed_conc_list <- append(index_5_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_sorting_w8wed_conc_matrix <- matrix(unlist(index_5_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_5$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
index_5_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_tray_packing_w8wed_conc_list <- append(index_5_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_tray_packing_w8wed_conc_matrix <- matrix(unlist(index_5_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_5$reject_w8wed_conc_list
vector <- vector[vector!='[]']
index_5_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_reject_w8wed_conc_list <- append(index_5_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_reject_w8wed_conc_matrix <- matrix(unlist(index_5_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_5$other_w8wed_conc_list
vector <- vector[vector!='[]']
index_5_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_5_other_w8wed_conc_list <- append(index_5_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_5_other_w8wed_conc_matrix <- matrix(unlist(index_5_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

index_5_loading_concs <- as.data.frame(index_5_loading_w8wed_conc_list)
index_5_loading_concs$area <- as.factor('loading')
index_5_loading_concs$scenario <- as.factor('XI_02A5')
index_5_loading_concs$water <- as.factor('Wet')
names(index_5_loading_concs) <- c('concentration','area','scenario','water')

index_5_cleaning_concs <- as.data.frame(index_5_cleaning_w8wed_conc_list)
index_5_cleaning_concs$area <- as.factor('cleaning')
index_5_cleaning_concs$scenario <- as.factor('XI_02A5')
index_5_cleaning_concs$water <- as.factor('Wet')
names(index_5_cleaning_concs) <- c('concentration','area','scenario','water')

index_5_sorting_concs <- as.data.frame(index_5_sorting_w8wed_conc_list)
index_5_sorting_concs$area <- as.factor('sorting')
index_5_sorting_concs$scenario <- as.factor('XI_02A5')
index_5_sorting_concs$water <- as.factor('Dry')
names(index_5_sorting_concs) <- c('concentration','area','scenario','water')

index_5_reject_concs <- as.data.frame(index_5_reject_w8wed_conc_list)
index_5_reject_concs$area <- as.factor('reject')
index_5_reject_concs$scenario <- as.factor('XI_02A5')
index_5_reject_concs$water <- as.factor('Dry')
names(index_5_reject_concs) <- c('concentration','area','scenario','water')

index_5_tray_packing_concs <- as.data.frame(index_5_tray_packing_w8wed_conc_list)
index_5_tray_packing_concs$area <- as.factor('tray packing')
index_5_tray_packing_concs$scenario <- as.factor('XI_02A5')
index_5_tray_packing_concs$water <- as.factor('Dry')
names(index_5_tray_packing_concs) <- c('concentration','area','scenario','water')

index_5_other_concs <- as.data.frame(index_5_other_w8wed_conc_list)
index_5_other_concs$area <- as.factor('other')
index_5_other_concs$scenario <- as.factor('XI_02A5')
index_5_other_concs$water <- as.factor('Dry')
names(index_5_other_concs) <- c('concentration','area','scenario','water')

index_5_w8wed_concs <- rbind(index_5_loading_concs,index_5_cleaning_concs,index_5_sorting_concs,index_5_tray_packing_concs,index_5_reject_concs,index_5_other_concs)

index_5_loading_prev <- as.data.frame(NL_table_Index_5$loading_w8wed_prev[order(NL_table_Index_5$local_seed)])
index_5_loading_prev$area <- as.factor('loading')
index_5_loading_prev$scenario <- as.factor('XI_02A5')
index_5_loading_prev$water <- as.factor('Wet')
names(index_5_loading_prev) <- c('prevalence','area','scenario','water')

index_5_cleaning_prev <- as.data.frame(NL_table_Index_5$cleaning_w8wed_prev[order(NL_table_Index_5$local_seed)])
index_5_cleaning_prev$area <- as.factor('cleaning')
index_5_cleaning_prev$scenario <- as.factor('XI_02A5')
index_5_cleaning_prev$water <- as.factor('Wet')
names(index_5_cleaning_prev) <- c('prevalence','area','scenario','water')

index_5_sorting_prev <- as.data.frame(NL_table_Index_5$sorting_w8wed_prev[order(NL_table_Index_5$local_seed)])
index_5_sorting_prev$area <- as.factor('sorting')
index_5_sorting_prev$scenario <- as.factor('XI_02A5')
index_5_sorting_prev$water <- as.factor('Dry')
names(index_5_sorting_prev) <- c('prevalence','area','scenario','water')

index_5_reject_prev <- as.data.frame(NL_table_Index_5$reject_w8wed_prev[order(NL_table_Index_5$local_seed)])
index_5_reject_prev$area <- as.factor('reject')
index_5_reject_prev$scenario <- as.factor('XI_02A5')
index_5_reject_prev$water <- as.factor('Dry')
names(index_5_reject_prev) <- c('prevalence','area','scenario','water')

index_5_tray_packing_prev <- as.data.frame(NL_table_Index_5$tray_packing_w8wed_prev[order(NL_table_Index_5$local_seed)])
index_5_tray_packing_prev$area <- as.factor('tray packing')
index_5_tray_packing_prev$scenario <- as.factor('XI_02A5')
index_5_tray_packing_prev$water <- as.factor('Dry')
names(index_5_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_5_other_prev <- as.data.frame(NL_table_Index_5$other_w8wed_prev[order(NL_table_Index_5$local_seed)])
index_5_other_prev$area <- as.factor('other')
index_5_other_prev$scenario <- as.factor('XI_02A5')
index_5_other_prev$water <- as.factor('Dry')
names(index_5_other_prev) <- c('prevalence','area','scenario','water')

index_5_w8wed_prev <- rbind(index_5_loading_prev,index_5_cleaning_prev,index_5_sorting_prev,index_5_tray_packing_prev,index_5_reject_prev,index_5_other_prev)

index_5_w8wed_wet_prev <- as.data.frame(index_5_loading_prev$prevalence*21/100+index_5_cleaning_prev$prevalence*28/100)/49*100
index_5_w8wed_wet_prev$scenario <- as.factor('XI_02A5')
index_5_w8wed_wet_prev$water <- as.factor('Wet')
names(index_5_w8wed_wet_prev) <- c('prevalence','scenario','water')

index_5_w8wed_dry_prev <- as.data.frame(index_5_sorting_prev$prevalence*20/100+index_5_reject_prev$prevalence*23/100+index_5_tray_packing_prev$prevalence*123/100+index_5_other_prev$prevalence*10/100)/176*100
index_5_w8wed_dry_prev$scenario <- as.factor('XI_02A5')
index_5_w8wed_dry_prev$water <- as.factor('Dry')
names(index_5_w8wed_dry_prev) <- c('prevalence','scenario','water')

index_5_w8wed_recombined_prev <- rbind(index_5_w8wed_wet_prev, index_5_w8wed_dry_prev)

index_5_w1wed_prev$week <- as.factor(1)
index_5_w2wed_prev$week <- as.factor(2)
index_5_w3wed_prev$week <- as.factor(3)
index_5_w4wed_prev$week <- as.factor(4)
index_5_w5wed_prev$week <- as.factor(5)
index_5_w6wed_prev$week <- as.factor(6)
index_5_w7wed_prev$week <- as.factor(7)
index_5_w8wed_prev$week <- as.factor(8)

index_5_w1wed_recombined_prev$week <- as.factor(1)
index_5_w2wed_recombined_prev$week <- as.factor(2)
index_5_w3wed_recombined_prev$week <- as.factor(3)
index_5_w4wed_recombined_prev$week <- as.factor(4)
index_5_w5wed_recombined_prev$week <- as.factor(5)
index_5_w6wed_recombined_prev$week <- as.factor(6)
index_5_w7wed_recombined_prev$week <- as.factor(7)
index_5_w8wed_recombined_prev$week <- as.factor(8)
index_5_allwed_prev <- rbind(index_5_w1wed_recombined_prev,index_5_w2wed_recombined_prev,index_5_w3wed_recombined_prev,index_5_w4wed_recombined_prev,index_5_w5wed_recombined_prev,index_5_w6wed_recombined_prev,index_5_w7wed_recombined_prev,index_5_w8wed_recombined_prev)

vector <- NL_table_Index_5$lifetime_conc_list[order(NL_table_Index_5$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

index_5_w1wed_recombined_prev$week <- as.factor(1)
index_5_w2wed_recombined_prev$week <- as.factor(2)
index_5_w3wed_recombined_prev$week <- as.factor(3)
index_5_w4wed_recombined_prev$week <- as.factor(4)
index_5_w5wed_recombined_prev$week <- as.factor(5)
index_5_w6wed_recombined_prev$week <- as.factor(6)
index_5_w7wed_recombined_prev$week <- as.factor(7)
index_5_w8wed_recombined_prev$week <- as.factor(8)
index_5_allwed_prev <- rbind(index_5_w1wed_recombined_prev,index_5_w2wed_recombined_prev,index_5_w3wed_recombined_prev,index_5_w4wed_recombined_prev,index_5_w5wed_recombined_prev,index_5_w6wed_recombined_prev,index_5_w7wed_recombined_prev,index_5_w8wed_recombined_prev)

Facility_B_index_5_agents_melted <- melt(mdarray)
colnames(Facility_B_index_5_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_index_5_agents_melted$agent <- Facility_B_index_5_agents_melted$agent-1
Facility_B_index_5_agents_melted$logical <- Facility_B_index_5_agents_melted$value>0
Facility_B_index_5_agents_melted$binary <- as.numeric(Facility_B_index_5_agents_melted$logical)
Facility_B_index_5_agents_melted$log10value <- log10(Facility_B_index_5_agents_melted$value)
Facility_B_index_5_agents_melted$log10value[is.infinite(Facility_B_index_5_agents_melted$log10value)] <- 0

agent <- Facility_B_index_5_agents_melted$agent
iteration <- Facility_B_index_5_agents_melted$iteration
tick <- Facility_B_index_5_agents_melted$tick
rle_matrix <- tapply(Facility_B_index_5_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_partial_prob_intervention_mean_value_matrix <- tapply(Facility_B_index_5_agents_melted$value, list(agent, tick), mean)
Facility_B_index_5_median_value_matrix <- tapply(Facility_B_index_5_agents_melted$value, list(agent, tick), median)
x <- Facility_B_index_5_agents_melted
x$value[x$value==0] <- NA
Facility_B_index_5_pos_median_value_matrix <- tapply(x$value, list(agent, tick), median, na.rm=TRUE)
Facility_B_index_5_prob_value_matrix <- tapply(Facility_B_index_5_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

#Maximum sensitivity####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_index_5 <- durations

agents_list_index_5 <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_index_5 <- agents_list_index_5[,c("V1","V7","V8","V9")]
colnames(agents_list_index_5) <- c("name","sanitation_status","schedule","area")
#Time to persistence
agents_list_index_5$time_to_persistence <- rep((168*2),225)
agents_list_index_5$time_to_persistence[agents_list_index_5$schedule=="daily"] <- (24*2)

persistent_short_durations_list_index_5 <- data.frame()
persistent_long_durations_list_index_5 <- data.frame()
persistent_uncleanable_durations_list_index_5 <- data.frame()
transient_short_durations_list_index_5 <- data.frame()
transient_long_durations_list_index_5 <- data.frame()
transient_uncleanable_durations_list_index_5 <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_index_5$min_duration[agent] <- ifelse(length(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent])==0,NA,min(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_index_5$mean_duration[agent] <- ifelse(length(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent])==0,NA,mean(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_index_5$median_duration[agent] <- ifelse(length(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent])==0,NA,median(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_index_5$max_duration[agent] <- ifelse(length(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent])==0,NA,max(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_index_5$contamination_events[agent] <- sum(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_index_5$times_persistent[agent] <- sum(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent]>agents_list_index_5$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_index_5$q1_duration[agent] <- quantile(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_index_5$q3_duration[agent] <- quantile(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_index_5$min_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent])==0) || (agents_list_index_5$times_persistent[agent]==0),NA,min(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent & Facility_B_durations_index_5$duration>=agents_list_index_5$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_index_5$mean_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent])==0) || (agents_list_index_5$times_persistent[agent]==0),NA,mean(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent & Facility_B_durations_index_5$duration>=agents_list_index_5$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_index_5$median_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent])==0) || (agents_list_index_5$times_persistent[agent]==0),NA,median(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent & Facility_B_durations_index_5$duration>=agents_list_index_5$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_index_5$max_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent])==0) || (agents_list_index_5$times_persistent[agent]==0),NA,max(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent & Facility_B_durations_index_5$duration>=agents_list_index_5$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_index_5$q1_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent])==0) || (agents_list_index_5$times_persistent[agent]==0),NA,quantile(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent & Facility_B_durations_index_5$duration>=agents_list_index_5$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_index_5$q3_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent])==0) || (agents_list_index_5$times_persistent[agent]==0),NA,quantile(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent & Facility_B_durations_index_5$duration>=agents_list_index_5$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations
  x <- Facility_B_durations_index_5[which(Facility_B_durations_index_5$agent==agent & Facility_B_durations_index_5$duration>agents_list_index_5$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean
  agents_list_index_5$mean_times_persistent[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_index_5$mean_times_persistent[which(is.na(agents_list_index_5$mean_times_persistent))] <- 0
  #Division by total number of iterations in simulation
  agents_list_index_5$balanced_times_persistent[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_index_5$duration[Facility_B_durations_index_5$agent==agent])!=0) || (agents_list_index_5$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_index_5$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_index_5 <- rbind(
        persistent_short_durations_list_index_5,
        Facility_B_durations_index_5[Facility_B_durations_index_5$agent==agent & Facility_B_durations_index_5$duration>agents_list_index_5$time_to_persistence[agent],]
      )
    } else if(agents_list_index_5$time_to_persistence[agent]==336 && agents_list_index_5$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_index_5 <- rbind(
        persistent_long_durations_list_index_5,
        Facility_B_durations_index_5[Facility_B_durations_index_5$agent==agent & Facility_B_durations_index_5$duration>agents_list_index_5$time_to_persistence[agent],]
      )
    } else if(agents_list_index_5$time_to_persistence[agent]==336 && agents_list_index_5$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_index_5 <- rbind(
        persistent_uncleanable_durations_list_index_5,
        Facility_B_durations_index_5[Facility_B_durations_index_5$agent==agent & Facility_B_durations_index_5$duration>agents_list_index_5$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_index_5$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_index_5 <- rbind(
      transient_short_durations_list_index_5,
      Facility_B_durations_index_5[Facility_B_durations_index_5$agent==agent & Facility_B_durations_index_5$duration<=agents_list_index_5$time_to_persistence[agent],]
    )
  } else if(agents_list_index_5$time_to_persistence[agent]==336 && agents_list_index_5$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_index_5 <- rbind(
      transient_long_durations_list_index_5,
      Facility_B_durations_index_5[Facility_B_durations_index_5$agent==agent & Facility_B_durations_index_5$duration<=agents_list_index_5$time_to_persistence[agent],]
    )
  } else if(agents_list_index_5$time_to_persistence[agent]==336 && agents_list_index_5$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_index_5 <- rbind(
      transient_uncleanable_durations_list_index_5,
      Facility_B_durations_index_5[Facility_B_durations_index_5$agent==agent & Facility_B_durations_index_5$duration<=agents_list_index_5$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

#10 cells minimum####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>9)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_index_5_10min <- durations

persistent_short_durations_list_index_5_10min <- data.frame()
persistent_long_durations_list_index_5_10min <- data.frame()
persistent_uncleanable_durations_list_index_5_10min <- data.frame()
transient_short_durations_list_index_5_10min <- data.frame()
transient_long_durations_list_index_5_10min <- data.frame()
transient_uncleanable_durations_list_index_5_10min <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_index_5$min_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent])==0,NA,min(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_index_5$mean_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent])==0,NA,mean(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_index_5$median_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent])==0,NA,median(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_index_5$max_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent])==0,NA,max(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_index_5$contamination_events_10min[agent] <- sum(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_index_5$times_persistent_10min[agent] <- sum(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent]>agents_list_index_5$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_index_5$q1_duration_10min[agent] <- quantile(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_index_5$q3_duration_10min[agent] <- quantile(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_index_5$min_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent])==0) || (agents_list_index_5$times_persistent_10min[agent]==0),NA,min(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent & Facility_B_durations_index_5_10min$duration>=agents_list_index_5$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_index_5$mean_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent])==0) || (agents_list_index_5$times_persistent_10min[agent]==0),NA,mean(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent & Facility_B_durations_index_5_10min$duration>=agents_list_index_5$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_index_5$median_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent])==0) || (agents_list_index_5$times_persistent_10min[agent]==0),NA,median(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent & Facility_B_durations_index_5_10min$duration>=agents_list_index_5$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_index_5$max_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent])==0) || (agents_list_index_5$times_persistent_10min[agent]==0),NA,max(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent & Facility_B_durations_index_5_10min$duration>=agents_list_index_5$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_index_5$q1_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent])==0) || (agents_list_index_5$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent & Facility_B_durations_index_5_10min$duration>=agents_list_index_5$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_index_5$q3_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent])==0) || (agents_list_index_5$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent & Facility_B_durations_index_5_10min$duration>=agents_list_index_5$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations (Does not account for iterations with 0 events)
  x <- Facility_B_durations_index_5_10min[which(Facility_B_durations_index_5_10min$agent==agent & Facility_B_durations_index_5_10min$duration>agents_list_index_5$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean (Does account for iterations with 0 events)
  agents_list_index_5$mean_times_persistent_10min[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_index_5$mean_times_persistent_10min[which(is.na(agents_list_index_5$mean_times_persistent_10min))] <- 0
  #Division by total number of iterations in simulation
  agents_list_index_5$balanced_times_persistent_10min[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_index_5_10min$duration[Facility_B_durations_index_5_10min$agent==agent])!=0) || (agents_list_index_5$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_index_5$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_index_5_10min <- rbind(
        persistent_short_durations_list_index_5_10min,
        Facility_B_durations_index_5_10min[Facility_B_durations_index_5_10min$agent==agent & Facility_B_durations_index_5_10min$duration>agents_list_index_5$time_to_persistence[agent],]
      )
    } else if(agents_list_index_5$time_to_persistence[agent]==336 && agents_list_index_5$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_index_5_10min <- rbind(
        persistent_long_durations_list_index_5_10min,
        Facility_B_durations_index_5_10min[Facility_B_durations_index_5_10min$agent==agent & Facility_B_durations_index_5_10min$duration>agents_list_index_5$time_to_persistence[agent],]
      )
    } else if(agents_list_index_5$time_to_persistence[agent]==336 && agents_list_index_5$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_index_5_10min <- rbind(
        persistent_uncleanable_durations_list_index_5_10min,
        Facility_B_durations_index_5_10min[Facility_B_durations_index_5_10min$agent==agent & Facility_B_durations_index_5_10min$duration>agents_list_index_5$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_index_5$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_index_5_10min <- rbind(
      transient_short_durations_list_index_5_10min,
      Facility_B_durations_index_5_10min[Facility_B_durations_index_5_10min$agent==agent & Facility_B_durations_index_5_10min$duration<=agents_list_index_5$time_to_persistence[agent],]
    )
  } else if(agents_list_index_5$time_to_persistence[agent]==336 && agents_list_index_5$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_index_5_10min <- rbind(
      transient_long_durations_list_index_5_10min,
      Facility_B_durations_index_5_10min[Facility_B_durations_index_5_10min$agent==agent & Facility_B_durations_index_5_10min$duration<=agents_list_index_5$time_to_persistence[agent],]
    )
  } else if(agents_list_index_5$time_to_persistence[agent]==336 && agents_list_index_5$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_index_5_10min <- rbind(
      transient_uncleanable_durations_list_index_5_10min,
      Facility_B_durations_index_5_10min[Facility_B_durations_index_5_10min$agent==agent & Facility_B_durations_index_5_10min$duration<=agents_list_index_5$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

# Facility_B_index_5_agents_melted_monday_preop <- Facility_B_index_5_agents_melted[which(Facility_B_index_5_agents_melted$tick==33|Facility_B_index_5_agents_melted$tick==201|Facility_B_index_5_agents_melted$tick==369|Facility_B_index_5_agents_melted$tick==537|Facility_B_index_5_agents_melted$tick==705|Facility_B_index_5_agents_melted$tick==873|Facility_B_index_5_agents_melted$tick==1041|Facility_B_index_5_agents_melted$tick==1209),]
# 
# Facility_B_index_5_agents_melted_tuesday_preop <- Facility_B_index_5_agents_melted[which(Facility_B_index_5_agents_melted$tick==57|Facility_B_index_5_agents_melted$tick==225|Facility_B_index_5_agents_melted$tick==393|Facility_B_index_5_agents_melted$tick==561|Facility_B_index_5_agents_melted$tick==729|Facility_B_index_5_agents_melted$tick==897|Facility_B_index_5_agents_melted$tick==1065|Facility_B_index_5_agents_melted$tick==1233),]
# 
# Facility_B_index_5_agents_melted_wednesday_preop <- Facility_B_index_5_agents_melted[which(Facility_B_index_5_agents_melted$tick==81|Facility_B_index_5_agents_melted$tick==249|Facility_B_index_5_agents_melted$tick==417|Facility_B_index_5_agents_melted$tick==585|Facility_B_index_5_agents_melted$tick==753|Facility_B_index_5_agents_melted$tick==921|Facility_B_index_5_agents_melted$tick==1089|Facility_B_index_5_agents_melted$tick==1257),]
# 
# Facility_B_index_5_agents_melted_thursday_preop <- Facility_B_index_5_agents_melted[which(Facility_B_index_5_agents_melted$tick==105|Facility_B_index_5_agents_melted$tick==273|Facility_B_index_5_agents_melted$tick==441|Facility_B_index_5_agents_melted$tick==609|Facility_B_index_5_agents_melted$tick==777|Facility_B_index_5_agents_melted$tick==945|Facility_B_index_5_agents_melted$tick==1113|Facility_B_index_5_agents_melted$tick==1281),]
# 
# Facility_B_index_5_agents_melted_friday_preop <- Facility_B_index_5_agents_melted[which(Facility_B_index_5_agents_melted$tick==129|Facility_B_index_5_agents_melted$tick==297|Facility_B_index_5_agents_melted$tick==465|Facility_B_index_5_agents_melted$tick==633|Facility_B_index_5_agents_melted$tick==801|Facility_B_index_5_agents_melted$tick==969|Facility_B_index_5_agents_melted$tick==1137|Facility_B_index_5_agents_melted$tick==1305),]

Facility_B_index_5_agents_melted_ff <- as.ffdf(Facility_B_index_5_agents_melted)
rm(Facility_B_index_5_agents_melted)
gc()
```
        
```{r Index Case 6}
NL_table_Index_6 <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-01-26-01-16 ENABLE-Facility_B-50cm_05-Persistence 100_Runs_8_Pre_Contamination_Stand-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_Index_6 <- NL_table_Index_6[NL_table_Index_6$scenario==56,]

while (any(grepl('-', names(NL_table_Index_6), fixed = TRUE))) {
  NL_table_Index_6 <- NL_table_Index_6 %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_Index_6), fixed = TRUE))) {
  NL_table_Index_6 <- NL_table_Index_6 %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_Index_6), fixed = TRUE))) {
  NL_table_Index_6 <- NL_table_Index_6 %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_Index_6), fixed = TRUE))) {
  NL_table_Index_6 <- NL_table_Index_6 %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_Index_6[ , ..list_columns]

NL_table_Index_6[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_Index_6 <- as.data.frame(NL_table_Index_6)

NL_table_Index_6[NL_table_Index_6==-1] <- NA

NL_table_Index_6 <- subset(NL_table_Index_6, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_Index_6)[names(NL_table_Index_6)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_Index_6)[names(NL_table_Index_6)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_Index_6$loading_w1wed_conc_list
vector <- vector[vector!='[]']
index_6_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_loading_w1wed_conc_list <- append(index_6_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_loading_w1wed_conc_matrix <- matrix(unlist(index_6_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_6$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
index_6_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_cleaning_w1wed_conc_list <- append(index_6_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_cleaning_w1wed_conc_matrix <- matrix(unlist(index_6_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_6$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# index_6_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_6_drying_w1wed_conc_list <- append(index_6_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_6$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
index_6_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_sorting_w1wed_conc_list <- append(index_6_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_sorting_w1wed_conc_matrix <- matrix(unlist(index_6_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_6$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
index_6_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_tray_packing_w1wed_conc_list <- append(index_6_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_tray_packing_w1wed_conc_matrix <- matrix(unlist(index_6_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_6$reject_w1wed_conc_list
vector <- vector[vector!='[]']
index_6_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_reject_w1wed_conc_list <- append(index_6_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_reject_w1wed_conc_matrix <- matrix(unlist(index_6_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_6$other_w1wed_conc_list
vector <- vector[vector!='[]']
index_6_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_other_w1wed_conc_list <- append(index_6_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_other_w1wed_conc_matrix <- matrix(unlist(index_6_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

index_6_loading_concs <- as.data.frame(index_6_loading_w1wed_conc_list)
index_6_loading_concs$area <- as.factor('loading')
index_6_loading_concs$scenario <- as.factor('XI_02A6')
index_6_loading_concs$water <- as.factor('Wet')
names(index_6_loading_concs) <- c('concentration','area','scenario','water')

index_6_cleaning_concs <- as.data.frame(index_6_cleaning_w1wed_conc_list)
index_6_cleaning_concs$area <- as.factor('cleaning')
index_6_cleaning_concs$scenario <- as.factor('XI_02A6')
index_6_cleaning_concs$water <- as.factor('Wet')
names(index_6_cleaning_concs) <- c('concentration','area','scenario','water')

index_6_sorting_concs <- as.data.frame(index_6_sorting_w1wed_conc_list)
index_6_sorting_concs$area <- as.factor('sorting')
index_6_sorting_concs$scenario <- as.factor('XI_02A6')
index_6_sorting_concs$water <- as.factor('Dry')
names(index_6_sorting_concs) <- c('concentration','area','scenario','water')

index_6_reject_concs <- as.data.frame(index_6_reject_w1wed_conc_list)
index_6_reject_concs$area <- as.factor('reject')
index_6_reject_concs$scenario <- as.factor('XI_02A6')
index_6_reject_concs$water <- as.factor('Dry')
names(index_6_reject_concs) <- c('concentration','area','scenario','water')

index_6_tray_packing_concs <- as.data.frame(index_6_tray_packing_w1wed_conc_list)
index_6_tray_packing_concs$area <- as.factor('tray packing')
index_6_tray_packing_concs$scenario <- as.factor('XI_02A6')
index_6_tray_packing_concs$water <- as.factor('Dry')
names(index_6_tray_packing_concs) <- c('concentration','area','scenario','water')

index_6_other_concs <- as.data.frame(index_6_other_w1wed_conc_list)
index_6_other_concs$area <- as.factor('other')
index_6_other_concs$scenario <- as.factor('XI_02A6')
index_6_other_concs$water <- as.factor('Dry')
names(index_6_other_concs) <- c('concentration','area','scenario','water')

index_6_w1wed_concs <- rbind(index_6_loading_concs,index_6_cleaning_concs,index_6_sorting_concs,index_6_tray_packing_concs,index_6_reject_concs,index_6_other_concs)

index_6_loading_prev <- as.data.frame(NL_table_Index_6$loading_w1wed_prev[order(NL_table_Index_6$local_seed)])
index_6_loading_prev$area <- as.factor('loading')
index_6_loading_prev$scenario <- as.factor('XI_02A6')
index_6_loading_prev$water <- as.factor('Wet')
names(index_6_loading_prev) <- c('prevalence','area','scenario','water')

index_6_cleaning_prev <- as.data.frame(NL_table_Index_6$cleaning_w1wed_prev[order(NL_table_Index_6$local_seed)])
index_6_cleaning_prev$area <- as.factor('cleaning')
index_6_cleaning_prev$scenario <- as.factor('XI_02A6')
index_6_cleaning_prev$water <- as.factor('Wet')
names(index_6_cleaning_prev) <- c('prevalence','area','scenario','water')

index_6_sorting_prev <- as.data.frame(NL_table_Index_6$sorting_w1wed_prev[order(NL_table_Index_6$local_seed)])
index_6_sorting_prev$area <- as.factor('sorting')
index_6_sorting_prev$scenario <- as.factor('XI_02A6')
index_6_sorting_prev$water <- as.factor('Dry')
names(index_6_sorting_prev) <- c('prevalence','area','scenario','water')

index_6_reject_prev <- as.data.frame(NL_table_Index_6$reject_w1wed_prev[order(NL_table_Index_6$local_seed)])
index_6_reject_prev$area <- as.factor('reject')
index_6_reject_prev$scenario <- as.factor('XI_02A6')
index_6_reject_prev$water <- as.factor('Dry')
names(index_6_reject_prev) <- c('prevalence','area','scenario','water')

index_6_tray_packing_prev <- as.data.frame(NL_table_Index_6$tray_packing_w1wed_prev[order(NL_table_Index_6$local_seed)])
index_6_tray_packing_prev$area <- as.factor('tray packing')
index_6_tray_packing_prev$scenario <- as.factor('XI_02A6')
index_6_tray_packing_prev$water <- as.factor('Dry')
names(index_6_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_6_other_prev <- as.data.frame(NL_table_Index_6$other_w1wed_prev[order(NL_table_Index_6$local_seed)])
index_6_other_prev$area <- as.factor('other')
index_6_other_prev$scenario <- as.factor('XI_02A6')
index_6_other_prev$water <- as.factor('Dry')
names(index_6_other_prev) <- c('prevalence','area','scenario','water')

index_6_w1wed_prev <- rbind(index_6_loading_prev,index_6_cleaning_prev,index_6_sorting_prev,index_6_tray_packing_prev,index_6_reject_prev,index_6_other_prev)

index_6_w1wed_wet_prev <- as.data.frame(index_6_loading_prev$prevalence*21/100+index_6_cleaning_prev$prevalence*28/100)/49*100
index_6_w1wed_wet_prev$scenario <- as.factor('XI_02A6')
index_6_w1wed_wet_prev$water <- as.factor('Wet')
names(index_6_w1wed_wet_prev) <- c('prevalence','scenario','water')

index_6_w1wed_dry_prev <- as.data.frame(index_6_sorting_prev$prevalence*20/100+index_6_reject_prev$prevalence*23/100+index_6_tray_packing_prev$prevalence*123/100+index_6_other_prev$prevalence*10/100)/176*100
index_6_w1wed_dry_prev$scenario <- as.factor('XI_02A6')
index_6_w1wed_dry_prev$water <- as.factor('Dry')
names(index_6_w1wed_dry_prev) <- c('prevalence','scenario','water')

index_6_w1wed_recombined_prev <- rbind(index_6_w1wed_wet_prev, index_6_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_Index_6$loading_w2wed_conc_list
vector <- vector[vector!='[]']
index_6_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_loading_w2wed_conc_list <- append(index_6_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_loading_w2wed_conc_matrix <- matrix(unlist(index_6_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_6$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
index_6_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_cleaning_w2wed_conc_list <- append(index_6_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_cleaning_w2wed_conc_matrix <- matrix(unlist(index_6_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_6$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# index_6_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_6_drying_w2wed_conc_list <- append(index_6_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_6$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
index_6_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_sorting_w2wed_conc_list <- append(index_6_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_sorting_w2wed_conc_matrix <- matrix(unlist(index_6_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_6$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
index_6_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_tray_packing_w2wed_conc_list <- append(index_6_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_tray_packing_w2wed_conc_matrix <- matrix(unlist(index_6_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_6$reject_w2wed_conc_list
vector <- vector[vector!='[]']
index_6_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_reject_w2wed_conc_list <- append(index_6_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_reject_w2wed_conc_matrix <- matrix(unlist(index_6_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_6$other_w2wed_conc_list
vector <- vector[vector!='[]']
index_6_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_other_w2wed_conc_list <- append(index_6_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_other_w2wed_conc_matrix <- matrix(unlist(index_6_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

index_6_loading_concs <- as.data.frame(index_6_loading_w2wed_conc_list)
index_6_loading_concs$area <- as.factor('loading')
index_6_loading_concs$scenario <- as.factor('XI_02A6')
index_6_loading_concs$water <- as.factor('Wet')
names(index_6_loading_concs) <- c('concentration','area','scenario','water')

index_6_cleaning_concs <- as.data.frame(index_6_cleaning_w2wed_conc_list)
index_6_cleaning_concs$area <- as.factor('cleaning')
index_6_cleaning_concs$scenario <- as.factor('XI_02A6')
index_6_cleaning_concs$water <- as.factor('Wet')
names(index_6_cleaning_concs) <- c('concentration','area','scenario','water')

index_6_sorting_concs <- as.data.frame(index_6_sorting_w2wed_conc_list)
index_6_sorting_concs$area <- as.factor('sorting')
index_6_sorting_concs$scenario <- as.factor('XI_02A6')
index_6_sorting_concs$water <- as.factor('Dry')
names(index_6_sorting_concs) <- c('concentration','area','scenario','water')

index_6_reject_concs <- as.data.frame(index_6_reject_w2wed_conc_list)
index_6_reject_concs$area <- as.factor('reject')
index_6_reject_concs$scenario <- as.factor('XI_02A6')
index_6_reject_concs$water <- as.factor('Dry')
names(index_6_reject_concs) <- c('concentration','area','scenario','water')

index_6_tray_packing_concs <- as.data.frame(index_6_tray_packing_w2wed_conc_list)
index_6_tray_packing_concs$area <- as.factor('tray packing')
index_6_tray_packing_concs$scenario <- as.factor('XI_02A6')
index_6_tray_packing_concs$water <- as.factor('Dry')
names(index_6_tray_packing_concs) <- c('concentration','area','scenario','water')

index_6_other_concs <- as.data.frame(index_6_other_w2wed_conc_list)
index_6_other_concs$area <- as.factor('other')
index_6_other_concs$scenario <- as.factor('XI_02A6')
index_6_other_concs$water <- as.factor('Dry')
names(index_6_other_concs) <- c('concentration','area','scenario','water')

index_6_w2wed_concs <- rbind(index_6_loading_concs,index_6_cleaning_concs,index_6_sorting_concs,index_6_tray_packing_concs,index_6_reject_concs,index_6_other_concs)

index_6_loading_prev <- as.data.frame(NL_table_Index_6$loading_w2wed_prev[order(NL_table_Index_6$local_seed)])
index_6_loading_prev$area <- as.factor('loading')
index_6_loading_prev$scenario <- as.factor('XI_02A6')
index_6_loading_prev$water <- as.factor('Wet')
names(index_6_loading_prev) <- c('prevalence','area','scenario','water')

index_6_cleaning_prev <- as.data.frame(NL_table_Index_6$cleaning_w2wed_prev[order(NL_table_Index_6$local_seed)])
index_6_cleaning_prev$area <- as.factor('cleaning')
index_6_cleaning_prev$scenario <- as.factor('XI_02A6')
index_6_cleaning_prev$water <- as.factor('Wet')
names(index_6_cleaning_prev) <- c('prevalence','area','scenario','water')

index_6_sorting_prev <- as.data.frame(NL_table_Index_6$sorting_w2wed_prev[order(NL_table_Index_6$local_seed)])
index_6_sorting_prev$area <- as.factor('sorting')
index_6_sorting_prev$scenario <- as.factor('XI_02A6')
index_6_sorting_prev$water <- as.factor('Dry')
names(index_6_sorting_prev) <- c('prevalence','area','scenario','water')

index_6_reject_prev <- as.data.frame(NL_table_Index_6$reject_w2wed_prev[order(NL_table_Index_6$local_seed)])
index_6_reject_prev$area <- as.factor('reject')
index_6_reject_prev$scenario <- as.factor('XI_02A6')
index_6_reject_prev$water <- as.factor('Dry')
names(index_6_reject_prev) <- c('prevalence','area','scenario','water')

index_6_tray_packing_prev <- as.data.frame(NL_table_Index_6$tray_packing_w2wed_prev[order(NL_table_Index_6$local_seed)])
index_6_tray_packing_prev$area <- as.factor('tray packing')
index_6_tray_packing_prev$scenario <- as.factor('XI_02A6')
index_6_tray_packing_prev$water <- as.factor('Dry')
names(index_6_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_6_other_prev <- as.data.frame(NL_table_Index_6$other_w2wed_prev[order(NL_table_Index_6$local_seed)])
index_6_other_prev$area <- as.factor('other')
index_6_other_prev$scenario <- as.factor('XI_02A6')
index_6_other_prev$water <- as.factor('Dry')
names(index_6_other_prev) <- c('prevalence','area','scenario','water')

index_6_w2wed_prev <- rbind(index_6_loading_prev,index_6_cleaning_prev,index_6_sorting_prev,index_6_tray_packing_prev,index_6_reject_prev,index_6_other_prev)

index_6_w2wed_wet_prev <- as.data.frame(index_6_loading_prev$prevalence*21/100+index_6_cleaning_prev$prevalence*28/100)/49*100
index_6_w2wed_wet_prev$scenario <- as.factor('XI_02A6')
index_6_w2wed_wet_prev$water <- as.factor('Wet')
names(index_6_w2wed_wet_prev) <- c('prevalence','scenario','water')

index_6_w2wed_dry_prev <- as.data.frame(index_6_sorting_prev$prevalence*20/100+index_6_reject_prev$prevalence*23/100+index_6_tray_packing_prev$prevalence*123/100+index_6_other_prev$prevalence*10/100)/176*100
index_6_w2wed_dry_prev$scenario <- as.factor('XI_02A6')
index_6_w2wed_dry_prev$water <- as.factor('Dry')
names(index_6_w2wed_dry_prev) <- c('prevalence','scenario','water')

index_6_w2wed_recombined_prev <- rbind(index_6_w2wed_wet_prev, index_6_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_Index_6$loading_w3wed_conc_list
vector <- vector[vector!='[]']
index_6_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_loading_w3wed_conc_list <- append(index_6_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_loading_w3wed_conc_matrix <- matrix(unlist(index_6_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_6$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
index_6_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_cleaning_w3wed_conc_list <- append(index_6_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_cleaning_w3wed_conc_matrix <- matrix(unlist(index_6_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_6$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# index_6_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_6_drying_w3wed_conc_list <- append(index_6_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_6$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
index_6_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_sorting_w3wed_conc_list <- append(index_6_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_sorting_w3wed_conc_matrix <- matrix(unlist(index_6_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_6$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
index_6_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_tray_packing_w3wed_conc_list <- append(index_6_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_tray_packing_w3wed_conc_matrix <- matrix(unlist(index_6_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_6$reject_w3wed_conc_list
vector <- vector[vector!='[]']
index_6_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_reject_w3wed_conc_list <- append(index_6_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_reject_w3wed_conc_matrix <- matrix(unlist(index_6_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_6$other_w3wed_conc_list
vector <- vector[vector!='[]']
index_6_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_other_w3wed_conc_list <- append(index_6_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_other_w3wed_conc_matrix <- matrix(unlist(index_6_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

index_6_loading_concs <- as.data.frame(index_6_loading_w3wed_conc_list)
index_6_loading_concs$area <- as.factor('loading')
index_6_loading_concs$scenario <- as.factor('XI_02A6')
index_6_loading_concs$water <- as.factor('Wet')
names(index_6_loading_concs) <- c('concentration','area','scenario','water')

index_6_cleaning_concs <- as.data.frame(index_6_cleaning_w3wed_conc_list)
index_6_cleaning_concs$area <- as.factor('cleaning')
index_6_cleaning_concs$scenario <- as.factor('XI_02A6')
index_6_cleaning_concs$water <- as.factor('Wet')
names(index_6_cleaning_concs) <- c('concentration','area','scenario','water')

index_6_sorting_concs <- as.data.frame(index_6_sorting_w3wed_conc_list)
index_6_sorting_concs$area <- as.factor('sorting')
index_6_sorting_concs$scenario <- as.factor('XI_02A6')
index_6_sorting_concs$water <- as.factor('Dry')
names(index_6_sorting_concs) <- c('concentration','area','scenario','water')

index_6_reject_concs <- as.data.frame(index_6_reject_w3wed_conc_list)
index_6_reject_concs$area <- as.factor('reject')
index_6_reject_concs$scenario <- as.factor('XI_02A6')
index_6_reject_concs$water <- as.factor('Dry')
names(index_6_reject_concs) <- c('concentration','area','scenario','water')

index_6_tray_packing_concs <- as.data.frame(index_6_tray_packing_w3wed_conc_list)
index_6_tray_packing_concs$area <- as.factor('tray packing')
index_6_tray_packing_concs$scenario <- as.factor('XI_02A6')
index_6_tray_packing_concs$water <- as.factor('Dry')
names(index_6_tray_packing_concs) <- c('concentration','area','scenario','water')

index_6_other_concs <- as.data.frame(index_6_other_w3wed_conc_list)
index_6_other_concs$area <- as.factor('other')
index_6_other_concs$scenario <- as.factor('XI_02A6')
index_6_other_concs$water <- as.factor('Dry')
names(index_6_other_concs) <- c('concentration','area','scenario','water')

index_6_w3wed_concs <- rbind(index_6_loading_concs,index_6_cleaning_concs,index_6_sorting_concs,index_6_tray_packing_concs,index_6_reject_concs,index_6_other_concs)

index_6_loading_prev <- as.data.frame(NL_table_Index_6$loading_w3wed_prev[order(NL_table_Index_6$local_seed)])
index_6_loading_prev$area <- as.factor('loading')
index_6_loading_prev$scenario <- as.factor('XI_02A6')
index_6_loading_prev$water <- as.factor('Wet')
names(index_6_loading_prev) <- c('prevalence','area','scenario','water')

index_6_cleaning_prev <- as.data.frame(NL_table_Index_6$cleaning_w3wed_prev[order(NL_table_Index_6$local_seed)])
index_6_cleaning_prev$area <- as.factor('cleaning')
index_6_cleaning_prev$scenario <- as.factor('XI_02A6')
index_6_cleaning_prev$water <- as.factor('Wet')
names(index_6_cleaning_prev) <- c('prevalence','area','scenario','water')

index_6_sorting_prev <- as.data.frame(NL_table_Index_6$sorting_w3wed_prev[order(NL_table_Index_6$local_seed)])
index_6_sorting_prev$area <- as.factor('sorting')
index_6_sorting_prev$scenario <- as.factor('XI_02A6')
index_6_sorting_prev$water <- as.factor('Dry')
names(index_6_sorting_prev) <- c('prevalence','area','scenario','water')

index_6_reject_prev <- as.data.frame(NL_table_Index_6$reject_w3wed_prev[order(NL_table_Index_6$local_seed)])
index_6_reject_prev$area <- as.factor('reject')
index_6_reject_prev$scenario <- as.factor('XI_02A6')
index_6_reject_prev$water <- as.factor('Dry')
names(index_6_reject_prev) <- c('prevalence','area','scenario','water')

index_6_tray_packing_prev <- as.data.frame(NL_table_Index_6$tray_packing_w3wed_prev[order(NL_table_Index_6$local_seed)])
index_6_tray_packing_prev$area <- as.factor('tray packing')
index_6_tray_packing_prev$scenario <- as.factor('XI_02A6')
index_6_tray_packing_prev$water <- as.factor('Dry')
names(index_6_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_6_other_prev <- as.data.frame(NL_table_Index_6$other_w3wed_prev[order(NL_table_Index_6$local_seed)])
index_6_other_prev$area <- as.factor('other')
index_6_other_prev$scenario <- as.factor('XI_02A6')
index_6_other_prev$water <- as.factor('Dry')
names(index_6_other_prev) <- c('prevalence','area','scenario','water')

index_6_w3wed_prev <- rbind(index_6_loading_prev,index_6_cleaning_prev,index_6_sorting_prev,index_6_tray_packing_prev,index_6_reject_prev,index_6_other_prev)

index_6_w3wed_wet_prev <- as.data.frame(index_6_loading_prev$prevalence*21/100+index_6_cleaning_prev$prevalence*28/100)/49*100
index_6_w3wed_wet_prev$scenario <- as.factor('XI_02A6')
index_6_w3wed_wet_prev$water <- as.factor('Wet')
names(index_6_w3wed_wet_prev) <- c('prevalence','scenario','water')

index_6_w3wed_dry_prev <- as.data.frame(index_6_sorting_prev$prevalence*20/100+index_6_reject_prev$prevalence*23/100+index_6_tray_packing_prev$prevalence*123/100+index_6_other_prev$prevalence*10/100)/176*100
index_6_w3wed_dry_prev$scenario <- as.factor('XI_02A6')
index_6_w3wed_dry_prev$water <- as.factor('Dry')
names(index_6_w3wed_dry_prev) <- c('prevalence','scenario','water')

index_6_w3wed_recombined_prev <- rbind(index_6_w3wed_wet_prev, index_6_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_Index_6$loading_w4wed_conc_list
vector <- vector[vector!='[]']
index_6_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_loading_w4wed_conc_list <- append(index_6_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_loading_w4wed_conc_matrix <- matrix(unlist(index_6_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_6$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
index_6_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_cleaning_w4wed_conc_list <- append(index_6_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_cleaning_w4wed_conc_matrix <- matrix(unlist(index_6_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_6$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# index_6_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_6_drying_w4wed_conc_list <- append(index_6_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_6$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
index_6_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_sorting_w4wed_conc_list <- append(index_6_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_sorting_w4wed_conc_matrix <- matrix(unlist(index_6_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_6$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
index_6_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_tray_packing_w4wed_conc_list <- append(index_6_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_tray_packing_w4wed_conc_matrix <- matrix(unlist(index_6_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_6$reject_w4wed_conc_list
vector <- vector[vector!='[]']
index_6_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_reject_w4wed_conc_list <- append(index_6_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_reject_w4wed_conc_matrix <- matrix(unlist(index_6_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_6$other_w4wed_conc_list
vector <- vector[vector!='[]']
index_6_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_other_w4wed_conc_list <- append(index_6_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_other_w4wed_conc_matrix <- matrix(unlist(index_6_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

index_6_loading_concs <- as.data.frame(index_6_loading_w4wed_conc_list)
index_6_loading_concs$area <- as.factor('loading')
index_6_loading_concs$scenario <- as.factor('XI_02A6')
index_6_loading_concs$water <- as.factor('Wet')
names(index_6_loading_concs) <- c('concentration','area','scenario','water')

index_6_cleaning_concs <- as.data.frame(index_6_cleaning_w4wed_conc_list)
index_6_cleaning_concs$area <- as.factor('cleaning')
index_6_cleaning_concs$scenario <- as.factor('XI_02A6')
index_6_cleaning_concs$water <- as.factor('Wet')
names(index_6_cleaning_concs) <- c('concentration','area','scenario','water')

index_6_sorting_concs <- as.data.frame(index_6_sorting_w4wed_conc_list)
index_6_sorting_concs$area <- as.factor('sorting')
index_6_sorting_concs$scenario <- as.factor('XI_02A6')
index_6_sorting_concs$water <- as.factor('Dry')
names(index_6_sorting_concs) <- c('concentration','area','scenario','water')

index_6_reject_concs <- as.data.frame(index_6_reject_w4wed_conc_list)
index_6_reject_concs$area <- as.factor('reject')
index_6_reject_concs$scenario <- as.factor('XI_02A6')
index_6_reject_concs$water <- as.factor('Dry')
names(index_6_reject_concs) <- c('concentration','area','scenario','water')

index_6_tray_packing_concs <- as.data.frame(index_6_tray_packing_w4wed_conc_list)
index_6_tray_packing_concs$area <- as.factor('tray packing')
index_6_tray_packing_concs$scenario <- as.factor('XI_02A6')
index_6_tray_packing_concs$water <- as.factor('Dry')
names(index_6_tray_packing_concs) <- c('concentration','area','scenario','water')

index_6_other_concs <- as.data.frame(index_6_other_w4wed_conc_list)
index_6_other_concs$area <- as.factor('other')
index_6_other_concs$scenario <- as.factor('XI_02A6')
index_6_other_concs$water <- as.factor('Dry')
names(index_6_other_concs) <- c('concentration','area','scenario','water')

index_6_w4wed_concs <- rbind(index_6_loading_concs,index_6_cleaning_concs,index_6_sorting_concs,index_6_tray_packing_concs,index_6_reject_concs,index_6_other_concs)

index_6_loading_prev <- as.data.frame(NL_table_Index_6$loading_w4wed_prev[order(NL_table_Index_6$local_seed)])
index_6_loading_prev$area <- as.factor('loading')
index_6_loading_prev$scenario <- as.factor('XI_02A6')
index_6_loading_prev$water <- as.factor('Wet')
names(index_6_loading_prev) <- c('prevalence','area','scenario','water')

index_6_cleaning_prev <- as.data.frame(NL_table_Index_6$cleaning_w4wed_prev[order(NL_table_Index_6$local_seed)])
index_6_cleaning_prev$area <- as.factor('cleaning')
index_6_cleaning_prev$scenario <- as.factor('XI_02A6')
index_6_cleaning_prev$water <- as.factor('Wet')
names(index_6_cleaning_prev) <- c('prevalence','area','scenario','water')

index_6_sorting_prev <- as.data.frame(NL_table_Index_6$sorting_w4wed_prev[order(NL_table_Index_6$local_seed)])
index_6_sorting_prev$area <- as.factor('sorting')
index_6_sorting_prev$scenario <- as.factor('XI_02A6')
index_6_sorting_prev$water <- as.factor('Dry')
names(index_6_sorting_prev) <- c('prevalence','area','scenario','water')

index_6_reject_prev <- as.data.frame(NL_table_Index_6$reject_w4wed_prev[order(NL_table_Index_6$local_seed)])
index_6_reject_prev$area <- as.factor('reject')
index_6_reject_prev$scenario <- as.factor('XI_02A6')
index_6_reject_prev$water <- as.factor('Dry')
names(index_6_reject_prev) <- c('prevalence','area','scenario','water')

index_6_tray_packing_prev <- as.data.frame(NL_table_Index_6$tray_packing_w4wed_prev[order(NL_table_Index_6$local_seed)])
index_6_tray_packing_prev$area <- as.factor('tray packing')
index_6_tray_packing_prev$scenario <- as.factor('XI_02A6')
index_6_tray_packing_prev$water <- as.factor('Dry')
names(index_6_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_6_other_prev <- as.data.frame(NL_table_Index_6$other_w4wed_prev[order(NL_table_Index_6$local_seed)])
index_6_other_prev$area <- as.factor('other')
index_6_other_prev$scenario <- as.factor('XI_02A6')
index_6_other_prev$water <- as.factor('Dry')
names(index_6_other_prev) <- c('prevalence','area','scenario','water')

index_6_w4wed_prev <- rbind(index_6_loading_prev,index_6_cleaning_prev,index_6_sorting_prev,index_6_tray_packing_prev,index_6_reject_prev,index_6_other_prev)

index_6_w4wed_wet_prev <- as.data.frame(index_6_loading_prev$prevalence*21/100+index_6_cleaning_prev$prevalence*28/100)/49*100
index_6_w4wed_wet_prev$scenario <- as.factor('XI_02A6')
index_6_w4wed_wet_prev$water <- as.factor('Wet')
names(index_6_w4wed_wet_prev) <- c('prevalence','scenario','water')

index_6_w4wed_dry_prev <- as.data.frame(index_6_sorting_prev$prevalence*20/100+index_6_reject_prev$prevalence*23/100+index_6_tray_packing_prev$prevalence*123/100+index_6_other_prev$prevalence*10/100)/176*100
index_6_w4wed_dry_prev$scenario <- as.factor('XI_02A6')
index_6_w4wed_dry_prev$water <- as.factor('Dry')
names(index_6_w4wed_dry_prev) <- c('prevalence','scenario','water')

index_6_w4wed_recombined_prev <- rbind(index_6_w4wed_wet_prev, index_6_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_Index_6$loading_w5wed_conc_list
vector <- vector[vector!='[]']
index_6_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_loading_w5wed_conc_list <- append(index_6_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_loading_w5wed_conc_matrix <- matrix(unlist(index_6_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_6$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
index_6_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_cleaning_w5wed_conc_list <- append(index_6_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_cleaning_w5wed_conc_matrix <- matrix(unlist(index_6_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_6$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# index_6_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_6_drying_w5wed_conc_list <- append(index_6_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_6$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
index_6_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_sorting_w5wed_conc_list <- append(index_6_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_sorting_w5wed_conc_matrix <- matrix(unlist(index_6_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_6$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
index_6_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_tray_packing_w5wed_conc_list <- append(index_6_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_tray_packing_w5wed_conc_matrix <- matrix(unlist(index_6_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_6$reject_w5wed_conc_list
vector <- vector[vector!='[]']
index_6_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_reject_w5wed_conc_list <- append(index_6_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_reject_w5wed_conc_matrix <- matrix(unlist(index_6_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_6$other_w5wed_conc_list
vector <- vector[vector!='[]']
index_6_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_other_w5wed_conc_list <- append(index_6_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_other_w5wed_conc_matrix <- matrix(unlist(index_6_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

index_6_loading_concs <- as.data.frame(index_6_loading_w5wed_conc_list)
index_6_loading_concs$area <- as.factor('loading')
index_6_loading_concs$scenario <- as.factor('XI_02A6')
index_6_loading_concs$water <- as.factor('Wet')
names(index_6_loading_concs) <- c('concentration','area','scenario','water')

index_6_cleaning_concs <- as.data.frame(index_6_cleaning_w5wed_conc_list)
index_6_cleaning_concs$area <- as.factor('cleaning')
index_6_cleaning_concs$scenario <- as.factor('XI_02A6')
index_6_cleaning_concs$water <- as.factor('Wet')
names(index_6_cleaning_concs) <- c('concentration','area','scenario','water')

index_6_sorting_concs <- as.data.frame(index_6_sorting_w5wed_conc_list)
index_6_sorting_concs$area <- as.factor('sorting')
index_6_sorting_concs$scenario <- as.factor('XI_02A6')
index_6_sorting_concs$water <- as.factor('Dry')
names(index_6_sorting_concs) <- c('concentration','area','scenario','water')

index_6_reject_concs <- as.data.frame(index_6_reject_w5wed_conc_list)
index_6_reject_concs$area <- as.factor('reject')
index_6_reject_concs$scenario <- as.factor('XI_02A6')
index_6_reject_concs$water <- as.factor('Dry')
names(index_6_reject_concs) <- c('concentration','area','scenario','water')

index_6_tray_packing_concs <- as.data.frame(index_6_tray_packing_w5wed_conc_list)
index_6_tray_packing_concs$area <- as.factor('tray packing')
index_6_tray_packing_concs$scenario <- as.factor('XI_02A6')
index_6_tray_packing_concs$water <- as.factor('Dry')
names(index_6_tray_packing_concs) <- c('concentration','area','scenario','water')

index_6_other_concs <- as.data.frame(index_6_other_w5wed_conc_list)
index_6_other_concs$area <- as.factor('other')
index_6_other_concs$scenario <- as.factor('XI_02A6')
index_6_other_concs$water <- as.factor('Dry')
names(index_6_other_concs) <- c('concentration','area','scenario','water')

index_6_w5wed_concs <- rbind(index_6_loading_concs,index_6_cleaning_concs,index_6_sorting_concs,index_6_tray_packing_concs,index_6_reject_concs,index_6_other_concs)

index_6_loading_prev <- as.data.frame(NL_table_Index_6$loading_w5wed_prev[order(NL_table_Index_6$local_seed)])
index_6_loading_prev$area <- as.factor('loading')
index_6_loading_prev$scenario <- as.factor('XI_02A6')
index_6_loading_prev$water <- as.factor('Wet')
names(index_6_loading_prev) <- c('prevalence','area','scenario','water')

index_6_cleaning_prev <- as.data.frame(NL_table_Index_6$cleaning_w5wed_prev[order(NL_table_Index_6$local_seed)])
index_6_cleaning_prev$area <- as.factor('cleaning')
index_6_cleaning_prev$scenario <- as.factor('XI_02A6')
index_6_cleaning_prev$water <- as.factor('Wet')
names(index_6_cleaning_prev) <- c('prevalence','area','scenario','water')

index_6_sorting_prev <- as.data.frame(NL_table_Index_6$sorting_w5wed_prev[order(NL_table_Index_6$local_seed)])
index_6_sorting_prev$area <- as.factor('sorting')
index_6_sorting_prev$scenario <- as.factor('XI_02A6')
index_6_sorting_prev$water <- as.factor('Dry')
names(index_6_sorting_prev) <- c('prevalence','area','scenario','water')

index_6_reject_prev <- as.data.frame(NL_table_Index_6$reject_w5wed_prev[order(NL_table_Index_6$local_seed)])
index_6_reject_prev$area <- as.factor('reject')
index_6_reject_prev$scenario <- as.factor('XI_02A6')
index_6_reject_prev$water <- as.factor('Dry')
names(index_6_reject_prev) <- c('prevalence','area','scenario','water')

index_6_tray_packing_prev <- as.data.frame(NL_table_Index_6$tray_packing_w5wed_prev[order(NL_table_Index_6$local_seed)])
index_6_tray_packing_prev$area <- as.factor('tray packing')
index_6_tray_packing_prev$scenario <- as.factor('XI_02A6')
index_6_tray_packing_prev$water <- as.factor('Dry')
names(index_6_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_6_other_prev <- as.data.frame(NL_table_Index_6$other_w5wed_prev[order(NL_table_Index_6$local_seed)])
index_6_other_prev$area <- as.factor('other')
index_6_other_prev$scenario <- as.factor('XI_02A6')
index_6_other_prev$water <- as.factor('Dry')
names(index_6_other_prev) <- c('prevalence','area','scenario','water')

index_6_w5wed_prev <- rbind(index_6_loading_prev,index_6_cleaning_prev,index_6_sorting_prev,index_6_tray_packing_prev,index_6_reject_prev,index_6_other_prev)

index_6_w5wed_wet_prev <- as.data.frame(index_6_loading_prev$prevalence*21/100+index_6_cleaning_prev$prevalence*28/100)/49*100
index_6_w5wed_wet_prev$scenario <- as.factor('XI_02A6')
index_6_w5wed_wet_prev$water <- as.factor('Wet')
names(index_6_w5wed_wet_prev) <- c('prevalence','scenario','water')

index_6_w5wed_dry_prev <- as.data.frame(index_6_sorting_prev$prevalence*20/100+index_6_reject_prev$prevalence*23/100+index_6_tray_packing_prev$prevalence*123/100+index_6_other_prev$prevalence*10/100)/176*100
index_6_w5wed_dry_prev$scenario <- as.factor('XI_02A6')
index_6_w5wed_dry_prev$water <- as.factor('Dry')
names(index_6_w5wed_dry_prev) <- c('prevalence','scenario','water')

index_6_w5wed_recombined_prev <- rbind(index_6_w5wed_wet_prev, index_6_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_Index_6$loading_w6wed_conc_list
vector <- vector[vector!='[]']
index_6_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_loading_w6wed_conc_list <- append(index_6_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_loading_w6wed_conc_matrix <- matrix(unlist(index_6_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_6$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
index_6_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_cleaning_w6wed_conc_list <- append(index_6_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_cleaning_w6wed_conc_matrix <- matrix(unlist(index_6_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_6$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# index_6_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_6_drying_w6wed_conc_list <- append(index_6_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_6$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
index_6_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_sorting_w6wed_conc_list <- append(index_6_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_sorting_w6wed_conc_matrix <- matrix(unlist(index_6_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_6$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
index_6_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_tray_packing_w6wed_conc_list <- append(index_6_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_tray_packing_w6wed_conc_matrix <- matrix(unlist(index_6_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_6$reject_w6wed_conc_list
vector <- vector[vector!='[]']
index_6_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_reject_w6wed_conc_list <- append(index_6_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_reject_w6wed_conc_matrix <- matrix(unlist(index_6_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_6$other_w6wed_conc_list
vector <- vector[vector!='[]']
index_6_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_other_w6wed_conc_list <- append(index_6_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_other_w6wed_conc_matrix <- matrix(unlist(index_6_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

index_6_loading_concs <- as.data.frame(index_6_loading_w6wed_conc_list)
index_6_loading_concs$area <- as.factor('loading')
index_6_loading_concs$scenario <- as.factor('XI_02A6')
index_6_loading_concs$water <- as.factor('Wet')
names(index_6_loading_concs) <- c('concentration','area','scenario','water')

index_6_cleaning_concs <- as.data.frame(index_6_cleaning_w6wed_conc_list)
index_6_cleaning_concs$area <- as.factor('cleaning')
index_6_cleaning_concs$scenario <- as.factor('XI_02A6')
index_6_cleaning_concs$water <- as.factor('Wet')
names(index_6_cleaning_concs) <- c('concentration','area','scenario','water')

index_6_sorting_concs <- as.data.frame(index_6_sorting_w6wed_conc_list)
index_6_sorting_concs$area <- as.factor('sorting')
index_6_sorting_concs$scenario <- as.factor('XI_02A6')
index_6_sorting_concs$water <- as.factor('Dry')
names(index_6_sorting_concs) <- c('concentration','area','scenario','water')

index_6_reject_concs <- as.data.frame(index_6_reject_w6wed_conc_list)
index_6_reject_concs$area <- as.factor('reject')
index_6_reject_concs$scenario <- as.factor('XI_02A6')
index_6_reject_concs$water <- as.factor('Dry')
names(index_6_reject_concs) <- c('concentration','area','scenario','water')

index_6_tray_packing_concs <- as.data.frame(index_6_tray_packing_w6wed_conc_list)
index_6_tray_packing_concs$area <- as.factor('tray packing')
index_6_tray_packing_concs$scenario <- as.factor('XI_02A6')
index_6_tray_packing_concs$water <- as.factor('Dry')
names(index_6_tray_packing_concs) <- c('concentration','area','scenario','water')

index_6_other_concs <- as.data.frame(index_6_other_w6wed_conc_list)
index_6_other_concs$area <- as.factor('other')
index_6_other_concs$scenario <- as.factor('XI_02A6')
index_6_other_concs$water <- as.factor('Dry')
names(index_6_other_concs) <- c('concentration','area','scenario','water')

index_6_w6wed_concs <- rbind(index_6_loading_concs,index_6_cleaning_concs,index_6_sorting_concs,index_6_tray_packing_concs,index_6_reject_concs,index_6_other_concs)

index_6_loading_prev <- as.data.frame(NL_table_Index_6$loading_w6wed_prev[order(NL_table_Index_6$local_seed)])
index_6_loading_prev$area <- as.factor('loading')
index_6_loading_prev$scenario <- as.factor('XI_02A6')
index_6_loading_prev$water <- as.factor('Wet')
names(index_6_loading_prev) <- c('prevalence','area','scenario','water')

index_6_cleaning_prev <- as.data.frame(NL_table_Index_6$cleaning_w6wed_prev[order(NL_table_Index_6$local_seed)])
index_6_cleaning_prev$area <- as.factor('cleaning')
index_6_cleaning_prev$scenario <- as.factor('XI_02A6')
index_6_cleaning_prev$water <- as.factor('Wet')
names(index_6_cleaning_prev) <- c('prevalence','area','scenario','water')

index_6_sorting_prev <- as.data.frame(NL_table_Index_6$sorting_w6wed_prev[order(NL_table_Index_6$local_seed)])
index_6_sorting_prev$area <- as.factor('sorting')
index_6_sorting_prev$scenario <- as.factor('XI_02A6')
index_6_sorting_prev$water <- as.factor('Dry')
names(index_6_sorting_prev) <- c('prevalence','area','scenario','water')

index_6_reject_prev <- as.data.frame(NL_table_Index_6$reject_w6wed_prev[order(NL_table_Index_6$local_seed)])
index_6_reject_prev$area <- as.factor('reject')
index_6_reject_prev$scenario <- as.factor('XI_02A6')
index_6_reject_prev$water <- as.factor('Dry')
names(index_6_reject_prev) <- c('prevalence','area','scenario','water')

index_6_tray_packing_prev <- as.data.frame(NL_table_Index_6$tray_packing_w6wed_prev[order(NL_table_Index_6$local_seed)])
index_6_tray_packing_prev$area <- as.factor('tray packing')
index_6_tray_packing_prev$scenario <- as.factor('XI_02A6')
index_6_tray_packing_prev$water <- as.factor('Dry')
names(index_6_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_6_other_prev <- as.data.frame(NL_table_Index_6$other_w6wed_prev[order(NL_table_Index_6$local_seed)])
index_6_other_prev$area <- as.factor('other')
index_6_other_prev$scenario <- as.factor('XI_02A6')
index_6_other_prev$water <- as.factor('Dry')
names(index_6_other_prev) <- c('prevalence','area','scenario','water')

index_6_w6wed_prev <- rbind(index_6_loading_prev,index_6_cleaning_prev,index_6_sorting_prev,index_6_tray_packing_prev,index_6_reject_prev,index_6_other_prev)

index_6_w6wed_wet_prev <- as.data.frame(index_6_loading_prev$prevalence*21/100+index_6_cleaning_prev$prevalence*28/100)/49*100
index_6_w6wed_wet_prev$scenario <- as.factor('XI_02A6')
index_6_w6wed_wet_prev$water <- as.factor('Wet')
names(index_6_w6wed_wet_prev) <- c('prevalence','scenario','water')

index_6_w6wed_dry_prev <- as.data.frame(index_6_sorting_prev$prevalence*20/100+index_6_reject_prev$prevalence*23/100+index_6_tray_packing_prev$prevalence*123/100+index_6_other_prev$prevalence*10/100)/176*100
index_6_w6wed_dry_prev$scenario <- as.factor('XI_02A6')
index_6_w6wed_dry_prev$water <- as.factor('Dry')
names(index_6_w6wed_dry_prev) <- c('prevalence','scenario','water')

index_6_w6wed_recombined_prev <- rbind(index_6_w6wed_wet_prev, index_6_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_Index_6$loading_w7wed_conc_list
vector <- vector[vector!='[]']
index_6_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_loading_w7wed_conc_list <- append(index_6_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_loading_w7wed_conc_matrix <- matrix(unlist(index_6_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_6$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
index_6_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_cleaning_w7wed_conc_list <- append(index_6_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_cleaning_w7wed_conc_matrix <- matrix(unlist(index_6_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_6$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# index_6_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_6_drying_w7wed_conc_list <- append(index_6_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_6$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
index_6_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_sorting_w7wed_conc_list <- append(index_6_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_sorting_w7wed_conc_matrix <- matrix(unlist(index_6_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_6$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
index_6_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_tray_packing_w7wed_conc_list <- append(index_6_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_tray_packing_w7wed_conc_matrix <- matrix(unlist(index_6_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_6$reject_w7wed_conc_list
vector <- vector[vector!='[]']
index_6_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_reject_w7wed_conc_list <- append(index_6_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_reject_w7wed_conc_matrix <- matrix(unlist(index_6_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_6$other_w7wed_conc_list
vector <- vector[vector!='[]']
index_6_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_other_w7wed_conc_list <- append(index_6_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_other_w7wed_conc_matrix <- matrix(unlist(index_6_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

index_6_loading_concs <- as.data.frame(index_6_loading_w7wed_conc_list)
index_6_loading_concs$area <- as.factor('loading')
index_6_loading_concs$scenario <- as.factor('XI_02A6')
index_6_loading_concs$water <- as.factor('Wet')
names(index_6_loading_concs) <- c('concentration','area','scenario','water')

index_6_cleaning_concs <- as.data.frame(index_6_cleaning_w7wed_conc_list)
index_6_cleaning_concs$area <- as.factor('cleaning')
index_6_cleaning_concs$scenario <- as.factor('XI_02A6')
index_6_cleaning_concs$water <- as.factor('Wet')
names(index_6_cleaning_concs) <- c('concentration','area','scenario','water')

index_6_sorting_concs <- as.data.frame(index_6_sorting_w7wed_conc_list)
index_6_sorting_concs$area <- as.factor('sorting')
index_6_sorting_concs$scenario <- as.factor('XI_02A6')
index_6_sorting_concs$water <- as.factor('Dry')
names(index_6_sorting_concs) <- c('concentration','area','scenario','water')

index_6_reject_concs <- as.data.frame(index_6_reject_w7wed_conc_list)
index_6_reject_concs$area <- as.factor('reject')
index_6_reject_concs$scenario <- as.factor('XI_02A6')
index_6_reject_concs$water <- as.factor('Dry')
names(index_6_reject_concs) <- c('concentration','area','scenario','water')

index_6_tray_packing_concs <- as.data.frame(index_6_tray_packing_w7wed_conc_list)
index_6_tray_packing_concs$area <- as.factor('tray packing')
index_6_tray_packing_concs$scenario <- as.factor('XI_02A6')
index_6_tray_packing_concs$water <- as.factor('Dry')
names(index_6_tray_packing_concs) <- c('concentration','area','scenario','water')

index_6_other_concs <- as.data.frame(index_6_other_w7wed_conc_list)
index_6_other_concs$area <- as.factor('other')
index_6_other_concs$scenario <- as.factor('XI_02A6')
index_6_other_concs$water <- as.factor('Dry')
names(index_6_other_concs) <- c('concentration','area','scenario','water')

index_6_w7wed_concs <- rbind(index_6_loading_concs,index_6_cleaning_concs,index_6_sorting_concs,index_6_tray_packing_concs,index_6_reject_concs,index_6_other_concs)

index_6_loading_prev <- as.data.frame(NL_table_Index_6$loading_w7wed_prev[order(NL_table_Index_6$local_seed)])
index_6_loading_prev$area <- as.factor('loading')
index_6_loading_prev$scenario <- as.factor('XI_02A6')
index_6_loading_prev$water <- as.factor('Wet')
names(index_6_loading_prev) <- c('prevalence','area','scenario','water')

index_6_cleaning_prev <- as.data.frame(NL_table_Index_6$cleaning_w7wed_prev[order(NL_table_Index_6$local_seed)])
index_6_cleaning_prev$area <- as.factor('cleaning')
index_6_cleaning_prev$scenario <- as.factor('XI_02A6')
index_6_cleaning_prev$water <- as.factor('Wet')
names(index_6_cleaning_prev) <- c('prevalence','area','scenario','water')

index_6_sorting_prev <- as.data.frame(NL_table_Index_6$sorting_w7wed_prev[order(NL_table_Index_6$local_seed)])
index_6_sorting_prev$area <- as.factor('sorting')
index_6_sorting_prev$scenario <- as.factor('XI_02A6')
index_6_sorting_prev$water <- as.factor('Dry')
names(index_6_sorting_prev) <- c('prevalence','area','scenario','water')

index_6_reject_prev <- as.data.frame(NL_table_Index_6$reject_w7wed_prev[order(NL_table_Index_6$local_seed)])
index_6_reject_prev$area <- as.factor('reject')
index_6_reject_prev$scenario <- as.factor('XI_02A6')
index_6_reject_prev$water <- as.factor('Dry')
names(index_6_reject_prev) <- c('prevalence','area','scenario','water')

index_6_tray_packing_prev <- as.data.frame(NL_table_Index_6$tray_packing_w7wed_prev[order(NL_table_Index_6$local_seed)])
index_6_tray_packing_prev$area <- as.factor('tray packing')
index_6_tray_packing_prev$scenario <- as.factor('XI_02A6')
index_6_tray_packing_prev$water <- as.factor('Dry')
names(index_6_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_6_other_prev <- as.data.frame(NL_table_Index_6$other_w7wed_prev[order(NL_table_Index_6$local_seed)])
index_6_other_prev$area <- as.factor('other')
index_6_other_prev$scenario <- as.factor('XI_02A6')
index_6_other_prev$water <- as.factor('Dry')
names(index_6_other_prev) <- c('prevalence','area','scenario','water')

index_6_w7wed_prev <- rbind(index_6_loading_prev,index_6_cleaning_prev,index_6_sorting_prev,index_6_tray_packing_prev,index_6_reject_prev,index_6_other_prev)

index_6_w7wed_wet_prev <- as.data.frame(index_6_loading_prev$prevalence*21/100+index_6_cleaning_prev$prevalence*28/100)/49*100
index_6_w7wed_wet_prev$scenario <- as.factor('XI_02A6')
index_6_w7wed_wet_prev$water <- as.factor('Wet')
names(index_6_w7wed_wet_prev) <- c('prevalence','scenario','water')

index_6_w7wed_dry_prev <- as.data.frame(index_6_sorting_prev$prevalence*20/100+index_6_reject_prev$prevalence*23/100+index_6_tray_packing_prev$prevalence*123/100+index_6_other_prev$prevalence*10/100)/176*100
index_6_w7wed_dry_prev$scenario <- as.factor('XI_02A6')
index_6_w7wed_dry_prev$water <- as.factor('Dry')
names(index_6_w7wed_dry_prev) <- c('prevalence','scenario','water')

index_6_w7wed_recombined_prev <- rbind(index_6_w7wed_wet_prev, index_6_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_Index_6$loading_w8wed_conc_list
vector <- vector[vector!='[]']
index_6_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_loading_w8wed_conc_list <- append(index_6_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_loading_w8wed_conc_matrix <- matrix(unlist(index_6_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_Index_6$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
index_6_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_cleaning_w8wed_conc_list <- append(index_6_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_cleaning_w8wed_conc_matrix <- matrix(unlist(index_6_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_Index_6$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# index_6_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   index_6_drying_w8wed_conc_list <- append(index_6_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_Index_6$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
index_6_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_sorting_w8wed_conc_list <- append(index_6_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_sorting_w8wed_conc_matrix <- matrix(unlist(index_6_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_Index_6$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
index_6_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_tray_packing_w8wed_conc_list <- append(index_6_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_tray_packing_w8wed_conc_matrix <- matrix(unlist(index_6_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_Index_6$reject_w8wed_conc_list
vector <- vector[vector!='[]']
index_6_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_reject_w8wed_conc_list <- append(index_6_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_reject_w8wed_conc_matrix <- matrix(unlist(index_6_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_Index_6$other_w8wed_conc_list
vector <- vector[vector!='[]']
index_6_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  index_6_other_w8wed_conc_list <- append(index_6_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
index_6_other_w8wed_conc_matrix <- matrix(unlist(index_6_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

index_6_loading_concs <- as.data.frame(index_6_loading_w8wed_conc_list)
index_6_loading_concs$area <- as.factor('loading')
index_6_loading_concs$scenario <- as.factor('XI_02A6')
index_6_loading_concs$water <- as.factor('Wet')
names(index_6_loading_concs) <- c('concentration','area','scenario','water')

index_6_cleaning_concs <- as.data.frame(index_6_cleaning_w8wed_conc_list)
index_6_cleaning_concs$area <- as.factor('cleaning')
index_6_cleaning_concs$scenario <- as.factor('XI_02A6')
index_6_cleaning_concs$water <- as.factor('Wet')
names(index_6_cleaning_concs) <- c('concentration','area','scenario','water')

index_6_sorting_concs <- as.data.frame(index_6_sorting_w8wed_conc_list)
index_6_sorting_concs$area <- as.factor('sorting')
index_6_sorting_concs$scenario <- as.factor('XI_02A6')
index_6_sorting_concs$water <- as.factor('Dry')
names(index_6_sorting_concs) <- c('concentration','area','scenario','water')

index_6_reject_concs <- as.data.frame(index_6_reject_w8wed_conc_list)
index_6_reject_concs$area <- as.factor('reject')
index_6_reject_concs$scenario <- as.factor('XI_02A6')
index_6_reject_concs$water <- as.factor('Dry')
names(index_6_reject_concs) <- c('concentration','area','scenario','water')

index_6_tray_packing_concs <- as.data.frame(index_6_tray_packing_w8wed_conc_list)
index_6_tray_packing_concs$area <- as.factor('tray packing')
index_6_tray_packing_concs$scenario <- as.factor('XI_02A6')
index_6_tray_packing_concs$water <- as.factor('Dry')
names(index_6_tray_packing_concs) <- c('concentration','area','scenario','water')

index_6_other_concs <- as.data.frame(index_6_other_w8wed_conc_list)
index_6_other_concs$area <- as.factor('other')
index_6_other_concs$scenario <- as.factor('XI_02A6')
index_6_other_concs$water <- as.factor('Dry')
names(index_6_other_concs) <- c('concentration','area','scenario','water')

index_6_w8wed_concs <- rbind(index_6_loading_concs,index_6_cleaning_concs,index_6_sorting_concs,index_6_tray_packing_concs,index_6_reject_concs,index_6_other_concs)

index_6_loading_prev <- as.data.frame(NL_table_Index_6$loading_w8wed_prev[order(NL_table_Index_6$local_seed)])
index_6_loading_prev$area <- as.factor('loading')
index_6_loading_prev$scenario <- as.factor('XI_02A6')
index_6_loading_prev$water <- as.factor('Wet')
names(index_6_loading_prev) <- c('prevalence','area','scenario','water')

index_6_cleaning_prev <- as.data.frame(NL_table_Index_6$cleaning_w8wed_prev[order(NL_table_Index_6$local_seed)])
index_6_cleaning_prev$area <- as.factor('cleaning')
index_6_cleaning_prev$scenario <- as.factor('XI_02A6')
index_6_cleaning_prev$water <- as.factor('Wet')
names(index_6_cleaning_prev) <- c('prevalence','area','scenario','water')

index_6_sorting_prev <- as.data.frame(NL_table_Index_6$sorting_w8wed_prev[order(NL_table_Index_6$local_seed)])
index_6_sorting_prev$area <- as.factor('sorting')
index_6_sorting_prev$scenario <- as.factor('XI_02A6')
index_6_sorting_prev$water <- as.factor('Dry')
names(index_6_sorting_prev) <- c('prevalence','area','scenario','water')

index_6_reject_prev <- as.data.frame(NL_table_Index_6$reject_w8wed_prev[order(NL_table_Index_6$local_seed)])
index_6_reject_prev$area <- as.factor('reject')
index_6_reject_prev$scenario <- as.factor('XI_02A6')
index_6_reject_prev$water <- as.factor('Dry')
names(index_6_reject_prev) <- c('prevalence','area','scenario','water')

index_6_tray_packing_prev <- as.data.frame(NL_table_Index_6$tray_packing_w8wed_prev[order(NL_table_Index_6$local_seed)])
index_6_tray_packing_prev$area <- as.factor('tray packing')
index_6_tray_packing_prev$scenario <- as.factor('XI_02A6')
index_6_tray_packing_prev$water <- as.factor('Dry')
names(index_6_tray_packing_prev) <- c('prevalence','area','scenario','water')

index_6_other_prev <- as.data.frame(NL_table_Index_6$other_w8wed_prev[order(NL_table_Index_6$local_seed)])
index_6_other_prev$area <- as.factor('other')
index_6_other_prev$scenario <- as.factor('XI_02A6')
index_6_other_prev$water <- as.factor('Dry')
names(index_6_other_prev) <- c('prevalence','area','scenario','water')

index_6_w8wed_prev <- rbind(index_6_loading_prev,index_6_cleaning_prev,index_6_sorting_prev,index_6_tray_packing_prev,index_6_reject_prev,index_6_other_prev)

index_6_w8wed_wet_prev <- as.data.frame(index_6_loading_prev$prevalence*21/100+index_6_cleaning_prev$prevalence*28/100)/49*100
index_6_w8wed_wet_prev$scenario <- as.factor('XI_02A6')
index_6_w8wed_wet_prev$water <- as.factor('Wet')
names(index_6_w8wed_wet_prev) <- c('prevalence','scenario','water')

index_6_w8wed_dry_prev <- as.data.frame(index_6_sorting_prev$prevalence*20/100+index_6_reject_prev$prevalence*23/100+index_6_tray_packing_prev$prevalence*123/100+index_6_other_prev$prevalence*10/100)/176*100
index_6_w8wed_dry_prev$scenario <- as.factor('XI_02A6')
index_6_w8wed_dry_prev$water <- as.factor('Dry')
names(index_6_w8wed_dry_prev) <- c('prevalence','scenario','water')

index_6_w8wed_recombined_prev <- rbind(index_6_w8wed_wet_prev, index_6_w8wed_dry_prev)

index_6_w1wed_prev$week <- as.factor(1)
index_6_w2wed_prev$week <- as.factor(2)
index_6_w3wed_prev$week <- as.factor(3)
index_6_w4wed_prev$week <- as.factor(4)
index_6_w5wed_prev$week <- as.factor(5)
index_6_w6wed_prev$week <- as.factor(6)
index_6_w7wed_prev$week <- as.factor(7)
index_6_w8wed_prev$week <- as.factor(8)

index_6_w1wed_recombined_prev$week <- as.factor(1)
index_6_w2wed_recombined_prev$week <- as.factor(2)
index_6_w3wed_recombined_prev$week <- as.factor(3)
index_6_w4wed_recombined_prev$week <- as.factor(4)
index_6_w5wed_recombined_prev$week <- as.factor(5)
index_6_w6wed_recombined_prev$week <- as.factor(6)
index_6_w7wed_recombined_prev$week <- as.factor(7)
index_6_w8wed_recombined_prev$week <- as.factor(8)
index_6_allwed_prev <- rbind(index_6_w1wed_recombined_prev,index_6_w2wed_recombined_prev,index_6_w3wed_recombined_prev,index_6_w4wed_recombined_prev,index_6_w5wed_recombined_prev,index_6_w6wed_recombined_prev,index_6_w7wed_recombined_prev,index_6_w8wed_recombined_prev)

vector <- NL_table_Index_6$lifetime_conc_list[order(NL_table_Index_6$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

index_6_w1wed_recombined_prev$week <- as.factor(1)
index_6_w2wed_recombined_prev$week <- as.factor(2)
index_6_w3wed_recombined_prev$week <- as.factor(3)
index_6_w4wed_recombined_prev$week <- as.factor(4)
index_6_w5wed_recombined_prev$week <- as.factor(5)
index_6_w6wed_recombined_prev$week <- as.factor(6)
index_6_w7wed_recombined_prev$week <- as.factor(7)
index_6_w8wed_recombined_prev$week <- as.factor(8)
index_6_allwed_prev <- rbind(index_6_w1wed_recombined_prev,index_6_w2wed_recombined_prev,index_6_w3wed_recombined_prev,index_6_w4wed_recombined_prev,index_6_w5wed_recombined_prev,index_6_w6wed_recombined_prev,index_6_w7wed_recombined_prev,index_6_w8wed_recombined_prev)

Facility_B_index_6_agents_melted <- melt(mdarray)
colnames(Facility_B_index_6_agents_melted) <- c("agent", "tick", "iteration", "value")
Facility_B_index_6_agents_melted$agent <- Facility_B_index_6_agents_melted$agent-1
Facility_B_index_6_agents_melted$logical <- Facility_B_index_6_agents_melted$value>0
Facility_B_index_6_agents_melted$binary <- as.numeric(Facility_B_index_6_agents_melted$logical)
Facility_B_index_6_agents_melted$log10value <- log10(Facility_B_index_6_agents_melted$value)
Facility_B_index_6_agents_melted$log10value[is.infinite(Facility_B_index_6_agents_melted$log10value)] <- 0

agent <- Facility_B_index_6_agents_melted$agent
iteration <- Facility_B_index_6_agents_melted$iteration
tick <- Facility_B_index_6_agents_melted$tick
rle_matrix <- tapply(Facility_B_index_6_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_partial_prob_intervention_mean_value_matrix <- tapply(Facility_B_index_6_agents_melted$value, list(agent, tick), mean)
Facility_B_index_6_median_value_matrix <- tapply(Facility_B_index_6_agents_melted$value, list(agent, tick), median)
x <- Facility_B_index_6_agents_melted
x$value[x$value==0] <- NA
Facility_B_index_6_pos_median_value_matrix <- tapply(x$value, list(agent, tick), median, na.rm=TRUE)
Facility_B_index_6_prob_value_matrix <- tapply(Facility_B_index_6_agents_melted$binary, list(agent, tick), sum)/100

durations <- data.frame(
  duration=integer(),
  agent=integer(),
  iteration=integer(),
  stringsAsFactors=FALSE
)

#Maximum sensitivity####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_index_6 <- durations

agents_list_index_6 <- read.table(paste0(getwd(),'/Data/Agents - Original.txt'))
agents_list_index_6 <- agents_list_index_6[,c("V1","V7","V8","V9")]
colnames(agents_list_index_6) <- c("name","sanitation_status","schedule","area")
#Time to persistence
agents_list_index_6$time_to_persistence <- rep((168*2),225)
agents_list_index_6$time_to_persistence[agents_list_index_6$schedule=="daily"] <- (24*2)

persistent_short_durations_list_index_6 <- data.frame()
persistent_long_durations_list_index_6 <- data.frame()
persistent_uncleanable_durations_list_index_6 <- data.frame()
transient_short_durations_list_index_6 <- data.frame()
transient_long_durations_list_index_6 <- data.frame()
transient_uncleanable_durations_list_index_6 <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_index_6$min_duration[agent] <- ifelse(length(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent])==0,NA,min(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_index_6$mean_duration[agent] <- ifelse(length(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent])==0,NA,mean(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_index_6$median_duration[agent] <- ifelse(length(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent])==0,NA,median(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_index_6$max_duration[agent] <- ifelse(length(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent])==0,NA,max(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_index_6$contamination_events[agent] <- sum(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_index_6$times_persistent[agent] <- sum(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent]>agents_list_index_6$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_index_6$q1_duration[agent] <- quantile(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_index_6$q3_duration[agent] <- quantile(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_index_6$min_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent])==0) || (agents_list_index_6$times_persistent[agent]==0),NA,min(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent & Facility_B_durations_index_6$duration>=agents_list_index_6$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_index_6$mean_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent])==0) || (agents_list_index_6$times_persistent[agent]==0),NA,mean(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent & Facility_B_durations_index_6$duration>=agents_list_index_6$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_index_6$median_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent])==0) || (agents_list_index_6$times_persistent[agent]==0),NA,median(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent & Facility_B_durations_index_6$duration>=agents_list_index_6$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_index_6$max_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent])==0) || (agents_list_index_6$times_persistent[agent]==0),NA,max(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent & Facility_B_durations_index_6$duration>=agents_list_index_6$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_index_6$q1_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent])==0) || (agents_list_index_6$times_persistent[agent]==0),NA,quantile(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent & Facility_B_durations_index_6$duration>=agents_list_index_6$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_index_6$q3_persistent_duration[agent] <- ifelse((length(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent])==0) || (agents_list_index_6$times_persistent[agent]==0),NA,quantile(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent & Facility_B_durations_index_6$duration>=agents_list_index_6$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations
  x <- Facility_B_durations_index_6[which(Facility_B_durations_index_6$agent==agent & Facility_B_durations_index_6$duration>agents_list_index_6$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean
  agents_list_index_6$mean_times_persistent[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_index_6$mean_times_persistent[which(is.na(agents_list_index_6$mean_times_persistent))] <- 0
  #Division by total number of iterations in simulation
  agents_list_index_6$balanced_times_persistent[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_index_6$duration[Facility_B_durations_index_6$agent==agent])!=0) || (agents_list_index_6$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_index_6$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_index_6 <- rbind(
        persistent_short_durations_list_index_6,
        Facility_B_durations_index_6[Facility_B_durations_index_6$agent==agent & Facility_B_durations_index_6$duration>agents_list_index_6$time_to_persistence[agent],]
      )
    } else if(agents_list_index_6$time_to_persistence[agent]==336 && agents_list_index_6$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_index_6 <- rbind(
        persistent_long_durations_list_index_6,
        Facility_B_durations_index_6[Facility_B_durations_index_6$agent==agent & Facility_B_durations_index_6$duration>agents_list_index_6$time_to_persistence[agent],]
      )
    } else if(agents_list_index_6$time_to_persistence[agent]==336 && agents_list_index_6$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_index_6 <- rbind(
        persistent_uncleanable_durations_list_index_6,
        Facility_B_durations_index_6[Facility_B_durations_index_6$agent==agent & Facility_B_durations_index_6$duration>agents_list_index_6$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_index_6$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_index_6 <- rbind(
      transient_short_durations_list_index_6,
      Facility_B_durations_index_6[Facility_B_durations_index_6$agent==agent & Facility_B_durations_index_6$duration<=agents_list_index_6$time_to_persistence[agent],]
    )
  } else if(agents_list_index_6$time_to_persistence[agent]==336 && agents_list_index_6$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_index_6 <- rbind(
      transient_long_durations_list_index_6,
      Facility_B_durations_index_6[Facility_B_durations_index_6$agent==agent & Facility_B_durations_index_6$duration<=agents_list_index_6$time_to_persistence[agent],]
    )
  } else if(agents_list_index_6$time_to_persistence[agent]==336 && agents_list_index_6$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_index_6 <- rbind(
      transient_uncleanable_durations_list_index_6,
      Facility_B_durations_index_6[Facility_B_durations_index_6$agent==agent & Facility_B_durations_index_6$duration<=agents_list_index_6$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

#10 cells minimum####
agent <- 1
while(agent<=225) {
  iteration <- 1
  while(iteration<=100) {
    if(any(rle_matrix[agent,iteration][[1]]$values>9)) {
      df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
      colnames(df) <- c('duration', 'agent', 'iteration')
      durations <- rbind(durations, df)
    }
    iteration <- iteration + 1
  }
  agent <- agent+1
}

Facility_B_durations_index_6_10min <- durations

persistent_short_durations_list_index_6_10min <- data.frame()
persistent_long_durations_list_index_6_10min <- data.frame()
persistent_uncleanable_durations_list_index_6_10min <- data.frame()
transient_short_durations_list_index_6_10min <- data.frame()
transient_long_durations_list_index_6_10min <- data.frame()
transient_uncleanable_durations_list_index_6_10min <- data.frame()
agent <- 1
while(agent<=225) {
  ##All Durations####
  #Minimum Contamination Duration
  agents_list_index_6$min_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent])==0,NA,min(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent], na.rm = TRUE))
  #Mean Contamination Duration
  agents_list_index_6$mean_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent])==0,NA,mean(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent], na.rm = TRUE))
  #Median Contamination Duration
  agents_list_index_6$median_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent])==0,NA,median(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent], na.rm = TRUE))
  #Maximum Contamination Duration
  agents_list_index_6$max_duration_10min[agent] <- ifelse(length(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent])==0,NA,max(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent], na.rm = TRUE))
  #Times Contaminated
  #Count number of events for that agent
  agents_list_index_6$contamination_events_10min[agent] <- sum(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent]>0)
  #Times Persistent
  #Count number of events for that agent that exceed time to persistence
  agents_list_index_6$times_persistent_10min[agent] <- sum(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent]>agents_list_index_6$time_to_persistence[agent])
  #Lower Duration Quartile
  agents_list_index_6$q1_duration_10min[agent] <- quantile(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent])[2]
  #Upper Duration Quartile
  agents_list_index_6$q3_duration_10min[agent] <- quantile(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent])[4]
  #Persistent Durations####
  #Minimum Persistent Contamination Duration
  agents_list_index_6$min_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent])==0) || (agents_list_index_6$times_persistent_10min[agent]==0),NA,min(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent & Facility_B_durations_index_6_10min$duration>=agents_list_index_6$time_to_persistence[agent]], na.rm = TRUE))
  #Mean Persistent Contamination Duration
  agents_list_index_6$mean_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent])==0) || (agents_list_index_6$times_persistent_10min[agent]==0),NA,mean(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent & Facility_B_durations_index_6_10min$duration>=agents_list_index_6$time_to_persistence[agent]], na.rm = TRUE))
  #Median Persistent Contamination Duration
  agents_list_index_6$median_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent])==0) || (agents_list_index_6$times_persistent_10min[agent]==0),NA,median(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent & Facility_B_durations_index_6_10min$duration>=agents_list_index_6$time_to_persistence[agent]], na.rm = TRUE))
  #Max Persistent Contamination Duration
  agents_list_index_6$max_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent])==0) || (agents_list_index_6$times_persistent_10min[agent]==0),NA,max(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent & Facility_B_durations_index_6_10min$duration>=agents_list_index_6$time_to_persistence[agent]], na.rm = TRUE))
  #Lower Duration Quartile Persistent Contamination Duration
  agents_list_index_6$q1_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent])==0) || (agents_list_index_6$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent & Facility_B_durations_index_6_10min$duration>=agents_list_index_6$time_to_persistence[agent]])[2])
  #Upper Duration Quartile Persistent Contamination Duration
  agents_list_index_6$q3_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent])==0) || (agents_list_index_6$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent & Facility_B_durations_index_6_10min$duration>=agents_list_index_6$time_to_persistence[agent]])[4])
  #Average number of times an agent was persistently contaminated across iterations (Does not account for iterations with 0 events)
  x <- Facility_B_durations_index_6_10min[which(Facility_B_durations_index_6_10min$agent==agent & Facility_B_durations_index_6_10min$duration>agents_list_index_6$time_to_persistence[agent]),]
  ##Count number of times in each iteration persistence occurred for the agent and take the mean (Does account for iterations with 0 events)
  agents_list_index_6$mean_times_persistent_10min[agent] <- mean(plyr::count(x, 'iteration')$freq)
  agents_list_index_6$mean_times_persistent_10min[which(is.na(agents_list_index_6$mean_times_persistent_10min))] <- 0
  #Division by total number of iterations in simulation
  agents_list_index_6$balanced_times_persistent_10min[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
  if((length(Facility_B_durations_index_6_10min$duration[Facility_B_durations_index_6_10min$agent==agent])!=0) || (agents_list_index_6$times_persistent[agent]!=0)) {
    #Persistent
    if(agents_list_index_6$time_to_persistence[agent]==48) {
      #Short
      persistent_short_durations_list_index_6_10min <- rbind(
        persistent_short_durations_list_index_6_10min,
        Facility_B_durations_index_6_10min[Facility_B_durations_index_6_10min$agent==agent & Facility_B_durations_index_6_10min$duration>agents_list_index_6$time_to_persistence[agent],]
      )
    } else if(agents_list_index_6$time_to_persistence[agent]==336 && agents_list_index_6$sanitation_status[agent]==1) {
      #Long
      persistent_long_durations_list_index_6_10min <- rbind(
        persistent_long_durations_list_index_6_10min,
        Facility_B_durations_index_6_10min[Facility_B_durations_index_6_10min$agent==agent & Facility_B_durations_index_6_10min$duration>agents_list_index_6$time_to_persistence[agent],]
      )
    } else if(agents_list_index_6$time_to_persistence[agent]==336 && agents_list_index_6$sanitation_status[agent]==0) {
      #Uncleanable
      persistent_uncleanable_durations_list_index_6_10min <- rbind(
        persistent_uncleanable_durations_list_index_6_10min,
        Facility_B_durations_index_6_10min[Facility_B_durations_index_6_10min$agent==agent & Facility_B_durations_index_6_10min$duration>agents_list_index_6$time_to_persistence[agent],]
      )	
    }
  }
  #Transient
  if(agents_list_index_6$time_to_persistence[agent]==48) {
    #Short
    transient_short_durations_list_index_6_10min <- rbind(
      transient_short_durations_list_index_6_10min,
      Facility_B_durations_index_6_10min[Facility_B_durations_index_6_10min$agent==agent & Facility_B_durations_index_6_10min$duration<=agents_list_index_6$time_to_persistence[agent],]
    )
  } else if(agents_list_index_6$time_to_persistence[agent]==336 && agents_list_index_6$sanitation_status[agent]==1) {
    #Long
    transient_long_durations_list_index_6_10min <- rbind(
      transient_long_durations_list_index_6_10min,
      Facility_B_durations_index_6_10min[Facility_B_durations_index_6_10min$agent==agent & Facility_B_durations_index_6_10min$duration<=agents_list_index_6$time_to_persistence[agent],]
    )
  } else if(agents_list_index_6$time_to_persistence[agent]==336 && agents_list_index_6$sanitation_status[agent]==0) {
    #Uncleanable
    transient_uncleanable_durations_list_index_6_10min <- rbind(
      transient_uncleanable_durations_list_index_6_10min,
      Facility_B_durations_index_6_10min[Facility_B_durations_index_6_10min$agent==agent & Facility_B_durations_index_6_10min$duration<=agents_list_index_6$time_to_persistence[agent],]
    )	
  }
  agent <- agent+1
}

# Facility_B_index_6_agents_melted_monday_preop <- Facility_B_index_6_agents_melted[which(Facility_B_index_6_agents_melted$tick==33|Facility_B_index_6_agents_melted$tick==201|Facility_B_index_6_agents_melted$tick==369|Facility_B_index_6_agents_melted$tick==537|Facility_B_index_6_agents_melted$tick==705|Facility_B_index_6_agents_melted$tick==873|Facility_B_index_6_agents_melted$tick==1041|Facility_B_index_6_agents_melted$tick==1209),]
# 
# Facility_B_index_6_agents_melted_tuesday_preop <- Facility_B_index_6_agents_melted[which(Facility_B_index_6_agents_melted$tick==57|Facility_B_index_6_agents_melted$tick==225|Facility_B_index_6_agents_melted$tick==393|Facility_B_index_6_agents_melted$tick==561|Facility_B_index_6_agents_melted$tick==729|Facility_B_index_6_agents_melted$tick==897|Facility_B_index_6_agents_melted$tick==1065|Facility_B_index_6_agents_melted$tick==1233),]
# 
# Facility_B_index_6_agents_melted_wednesday_preop <- Facility_B_index_6_agents_melted[which(Facility_B_index_6_agents_melted$tick==81|Facility_B_index_6_agents_melted$tick==249|Facility_B_index_6_agents_melted$tick==417|Facility_B_index_6_agents_melted$tick==585|Facility_B_index_6_agents_melted$tick==753|Facility_B_index_6_agents_melted$tick==921|Facility_B_index_6_agents_melted$tick==1089|Facility_B_index_6_agents_melted$tick==1257),]
# 
# Facility_B_index_6_agents_melted_thursday_preop <- Facility_B_index_6_agents_melted[which(Facility_B_index_6_agents_melted$tick==105|Facility_B_index_6_agents_melted$tick==273|Facility_B_index_6_agents_melted$tick==441|Facility_B_index_6_agents_melted$tick==609|Facility_B_index_6_agents_melted$tick==777|Facility_B_index_6_agents_melted$tick==945|Facility_B_index_6_agents_melted$tick==1113|Facility_B_index_6_agents_melted$tick==1281),]
# 
# Facility_B_index_6_agents_melted_friday_preop <- Facility_B_index_6_agents_melted[which(Facility_B_index_6_agents_melted$tick==129|Facility_B_index_6_agents_melted$tick==297|Facility_B_index_6_agents_melted$tick==465|Facility_B_index_6_agents_melted$tick==633|Facility_B_index_6_agents_melted$tick==801|Facility_B_index_6_agents_melted$tick==969|Facility_B_index_6_agents_melted$tick==1137|Facility_B_index_6_agents_melted$tick==1305),]

Facility_B_index_6_agents_melted_ff <- as.ffdf(Facility_B_index_6_agents_melted)
rm(Facility_B_index_6_agents_melted)
gc()
```

```{r import New Gamma/Delta}
NL_table_new_gd <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-02-16-22-44 ENABLE-Facility_B-50cm_05-Persistence 1000_Runs_8_Weeks_Variable_Prob_Clean-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_new_gd <- NL_table_new_gd[NL_table_new_gd$scenario==57,]

while (any(grepl('-', names(NL_table_new_gd), fixed = TRUE))) {
  NL_table_new_gd <- NL_table_new_gd %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_new_gd), fixed = TRUE))) {
  NL_table_new_gd <- NL_table_new_gd %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_new_gd), fixed = TRUE))) {
  NL_table_new_gd <- NL_table_new_gd %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_new_gd), fixed = TRUE))) {
  NL_table_new_gd <- NL_table_new_gd %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_new_gd[ , ..list_columns]

NL_table_new_gd[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_new_gd <- as.data.frame(NL_table_new_gd)

NL_table_new_gd[NL_table_new_gd==-1] <- NA

NL_table_new_gd <- subset(NL_table_new_gd, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_new_gd)[names(NL_table_new_gd)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_new_gd)[names(NL_table_new_gd)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_new_gd$w1wed_conc_list
vector <- vector[vector!='[]']
new_gd_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
    new_gd_w1wed_conc_list <- append(new_gd_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
    i <- i+1
}
new_gd_w1wed_conc_matrix <- matrix(unlist(new_gd_w1wed_conc_list), ncol = 225, byrow = TRUE)

vector <- NL_table_new_gd$loading_w1wed_conc_list
vector <- vector[vector!='[]']
new_gd_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_loading_w1wed_conc_list <- append(new_gd_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_loading_w1wed_conc_matrix <- matrix(unlist(new_gd_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_new_gd$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
new_gd_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_cleaning_w1wed_conc_list <- append(new_gd_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_cleaning_w1wed_conc_matrix <- matrix(unlist(new_gd_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_new_gd$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# new_gd_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   new_gd_drying_w1wed_conc_list <- append(new_gd_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_new_gd$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
new_gd_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_sorting_w1wed_conc_list <- append(new_gd_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_sorting_w1wed_conc_matrix <- matrix(unlist(new_gd_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_new_gd$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
new_gd_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_tray_packing_w1wed_conc_list <- append(new_gd_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_tray_packing_w1wed_conc_matrix <- matrix(unlist(new_gd_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_new_gd$reject_w1wed_conc_list
vector <- vector[vector!='[]']
new_gd_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_reject_w1wed_conc_list <- append(new_gd_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_reject_w1wed_conc_matrix <- matrix(unlist(new_gd_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_new_gd$other_w1wed_conc_list
vector <- vector[vector!='[]']
new_gd_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_other_w1wed_conc_list <- append(new_gd_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_other_w1wed_conc_matrix <- matrix(unlist(new_gd_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

new_gd_loading_concs <- as.data.frame(new_gd_loading_w1wed_conc_list)
new_gd_loading_concs$area <- as.factor('loading')
new_gd_loading_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_loading_concs$water <- as.factor('Wet')
names(new_gd_loading_concs) <- c('concentration','area','scenario','water')

new_gd_cleaning_concs <- as.data.frame(new_gd_cleaning_w1wed_conc_list)
new_gd_cleaning_concs$area <- as.factor('cleaning')
new_gd_cleaning_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_cleaning_concs$water <- as.factor('Wet')
names(new_gd_cleaning_concs) <- c('concentration','area','scenario','water')

new_gd_sorting_concs <- as.data.frame(new_gd_sorting_w1wed_conc_list)
new_gd_sorting_concs$area <- as.factor('sorting')
new_gd_sorting_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_sorting_concs$water <- as.factor('Dry')
names(new_gd_sorting_concs) <- c('concentration','area','scenario','water')

new_gd_reject_concs <- as.data.frame(new_gd_reject_w1wed_conc_list)
new_gd_reject_concs$area <- as.factor('reject')
new_gd_reject_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_reject_concs$water <- as.factor('Dry')
names(new_gd_reject_concs) <- c('concentration','area','scenario','water')

new_gd_tray_packing_concs <- as.data.frame(new_gd_tray_packing_w1wed_conc_list)
new_gd_tray_packing_concs$area <- as.factor('tray packing')
new_gd_tray_packing_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_tray_packing_concs$water <- as.factor('Dry')
names(new_gd_tray_packing_concs) <- c('concentration','area','scenario','water')

new_gd_other_concs <- as.data.frame(new_gd_other_w1wed_conc_list)
new_gd_other_concs$area <- as.factor('other')
new_gd_other_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_other_concs$water <- as.factor('Dry')
names(new_gd_other_concs) <- c('concentration','area','scenario','water')

new_gd_w1wed_concs <- rbind(new_gd_loading_concs,new_gd_cleaning_concs,new_gd_sorting_concs,new_gd_tray_packing_concs,new_gd_reject_concs,new_gd_other_concs)

new_gd_loading_prev <- as.data.frame(NL_table_new_gd$loading_w1wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_loading_prev$area <- as.factor('loading')
new_gd_loading_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_loading_prev$water <- as.factor('Wet')
names(new_gd_loading_prev) <- c('prevalence','area','scenario','water')

new_gd_cleaning_prev <- as.data.frame(NL_table_new_gd$cleaning_w1wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_cleaning_prev$area <- as.factor('cleaning')
new_gd_cleaning_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_cleaning_prev$water <- as.factor('Wet')
names(new_gd_cleaning_prev) <- c('prevalence','area','scenario','water')

new_gd_sorting_prev <- as.data.frame(NL_table_new_gd$sorting_w1wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_sorting_prev$area <- as.factor('sorting')
new_gd_sorting_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_sorting_prev$water <- as.factor('Dry')
names(new_gd_sorting_prev) <- c('prevalence','area','scenario','water')

new_gd_reject_prev <- as.data.frame(NL_table_new_gd$reject_w1wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_reject_prev$area <- as.factor('reject')
new_gd_reject_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_reject_prev$water <- as.factor('Dry')
names(new_gd_reject_prev) <- c('prevalence','area','scenario','water')

new_gd_tray_packing_prev <- as.data.frame(NL_table_new_gd$tray_packing_w1wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_tray_packing_prev$area <- as.factor('tray packing')
new_gd_tray_packing_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_tray_packing_prev$water <- as.factor('Dry')
names(new_gd_tray_packing_prev) <- c('prevalence','area','scenario','water')

new_gd_other_prev <- as.data.frame(NL_table_new_gd$other_w1wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_other_prev$area <- as.factor('other')
new_gd_other_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_other_prev$water <- as.factor('Dry')
names(new_gd_other_prev) <- c('prevalence','area','scenario','water')

new_gd_w1wed_prev <- rbind(new_gd_loading_prev,new_gd_cleaning_prev,new_gd_sorting_prev,new_gd_tray_packing_prev,new_gd_reject_prev,new_gd_other_prev)

new_gd_w1wed_wet_prev <- as.data.frame(new_gd_loading_prev$prevalence*21/100+new_gd_cleaning_prev$prevalence*28/100)/49*100
new_gd_w1wed_wet_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_w1wed_wet_prev$water <- as.factor('Wet')
names(new_gd_w1wed_wet_prev) <- c('prevalence','scenario','water')

new_gd_w1wed_dry_prev <- as.data.frame(new_gd_sorting_prev$prevalence*20/100+new_gd_reject_prev$prevalence*23/100+new_gd_tray_packing_prev$prevalence*123/100+new_gd_other_prev$prevalence*10/100)/176*100
new_gd_w1wed_dry_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_w1wed_dry_prev$water <- as.factor('Dry')
names(new_gd_w1wed_dry_prev) <- c('prevalence','scenario','water')

new_gd_w1wed_recombined_prev <- rbind(new_gd_w1wed_wet_prev, new_gd_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_new_gd$w2wed_conc_list
vector <- vector[vector!='[]']
new_gd_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
    new_gd_w2wed_conc_list <- append(new_gd_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
    i <- i+1
}
new_gd_w2wed_conc_matrix <- matrix(unlist(new_gd_w2wed_conc_list), ncol = 225, byrow = TRUE)

vector <- NL_table_new_gd$loading_w2wed_conc_list
vector <- vector[vector!='[]']
new_gd_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_loading_w2wed_conc_list <- append(new_gd_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_loading_w2wed_conc_matrix <- matrix(unlist(new_gd_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_new_gd$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
new_gd_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_cleaning_w2wed_conc_list <- append(new_gd_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_cleaning_w2wed_conc_matrix <- matrix(unlist(new_gd_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_new_gd$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# new_gd_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   new_gd_drying_w2wed_conc_list <- append(new_gd_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_new_gd$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
new_gd_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_sorting_w2wed_conc_list <- append(new_gd_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_sorting_w2wed_conc_matrix <- matrix(unlist(new_gd_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_new_gd$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
new_gd_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_tray_packing_w2wed_conc_list <- append(new_gd_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_tray_packing_w2wed_conc_matrix <- matrix(unlist(new_gd_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_new_gd$reject_w2wed_conc_list
vector <- vector[vector!='[]']
new_gd_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_reject_w2wed_conc_list <- append(new_gd_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_reject_w2wed_conc_matrix <- matrix(unlist(new_gd_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_new_gd$other_w2wed_conc_list
vector <- vector[vector!='[]']
new_gd_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_other_w2wed_conc_list <- append(new_gd_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_other_w2wed_conc_matrix <- matrix(unlist(new_gd_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

new_gd_loading_concs <- as.data.frame(new_gd_loading_w2wed_conc_list)
new_gd_loading_concs$area <- as.factor('loading')
new_gd_loading_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_loading_concs$water <- as.factor('Wet')
names(new_gd_loading_concs) <- c('concentration','area','scenario','water')

new_gd_cleaning_concs <- as.data.frame(new_gd_cleaning_w2wed_conc_list)
new_gd_cleaning_concs$area <- as.factor('cleaning')
new_gd_cleaning_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_cleaning_concs$water <- as.factor('Wet')
names(new_gd_cleaning_concs) <- c('concentration','area','scenario','water')

new_gd_sorting_concs <- as.data.frame(new_gd_sorting_w2wed_conc_list)
new_gd_sorting_concs$area <- as.factor('sorting')
new_gd_sorting_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_sorting_concs$water <- as.factor('Dry')
names(new_gd_sorting_concs) <- c('concentration','area','scenario','water')

new_gd_reject_concs <- as.data.frame(new_gd_reject_w2wed_conc_list)
new_gd_reject_concs$area <- as.factor('reject')
new_gd_reject_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_reject_concs$water <- as.factor('Dry')
names(new_gd_reject_concs) <- c('concentration','area','scenario','water')

new_gd_tray_packing_concs <- as.data.frame(new_gd_tray_packing_w2wed_conc_list)
new_gd_tray_packing_concs$area <- as.factor('tray packing')
new_gd_tray_packing_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_tray_packing_concs$water <- as.factor('Dry')
names(new_gd_tray_packing_concs) <- c('concentration','area','scenario','water')

new_gd_other_concs <- as.data.frame(new_gd_other_w2wed_conc_list)
new_gd_other_concs$area <- as.factor('other')
new_gd_other_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_other_concs$water <- as.factor('Dry')
names(new_gd_other_concs) <- c('concentration','area','scenario','water')

new_gd_w2wed_concs <- rbind(new_gd_loading_concs,new_gd_cleaning_concs,new_gd_sorting_concs,new_gd_tray_packing_concs,new_gd_reject_concs,new_gd_other_concs)

new_gd_loading_prev <- as.data.frame(NL_table_new_gd$loading_w2wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_loading_prev$area <- as.factor('loading')
new_gd_loading_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_loading_prev$water <- as.factor('Wet')
names(new_gd_loading_prev) <- c('prevalence','area','scenario','water')

new_gd_cleaning_prev <- as.data.frame(NL_table_new_gd$cleaning_w2wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_cleaning_prev$area <- as.factor('cleaning')
new_gd_cleaning_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_cleaning_prev$water <- as.factor('Wet')
names(new_gd_cleaning_prev) <- c('prevalence','area','scenario','water')

new_gd_sorting_prev <- as.data.frame(NL_table_new_gd$sorting_w2wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_sorting_prev$area <- as.factor('sorting')
new_gd_sorting_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_sorting_prev$water <- as.factor('Dry')
names(new_gd_sorting_prev) <- c('prevalence','area','scenario','water')

new_gd_reject_prev <- as.data.frame(NL_table_new_gd$reject_w2wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_reject_prev$area <- as.factor('reject')
new_gd_reject_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_reject_prev$water <- as.factor('Dry')
names(new_gd_reject_prev) <- c('prevalence','area','scenario','water')

new_gd_tray_packing_prev <- as.data.frame(NL_table_new_gd$tray_packing_w2wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_tray_packing_prev$area <- as.factor('tray packing')
new_gd_tray_packing_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_tray_packing_prev$water <- as.factor('Dry')
names(new_gd_tray_packing_prev) <- c('prevalence','area','scenario','water')

new_gd_other_prev <- as.data.frame(NL_table_new_gd$other_w2wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_other_prev$area <- as.factor('other')
new_gd_other_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_other_prev$water <- as.factor('Dry')
names(new_gd_other_prev) <- c('prevalence','area','scenario','water')

new_gd_w2wed_prev <- rbind(new_gd_loading_prev,new_gd_cleaning_prev,new_gd_sorting_prev,new_gd_tray_packing_prev,new_gd_reject_prev,new_gd_other_prev)

new_gd_w2wed_wet_prev <- as.data.frame(new_gd_loading_prev$prevalence*21/100+new_gd_cleaning_prev$prevalence*28/100)/49*100
new_gd_w2wed_wet_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_w2wed_wet_prev$water <- as.factor('Wet')
names(new_gd_w2wed_wet_prev) <- c('prevalence','scenario','water')

new_gd_w2wed_dry_prev <- as.data.frame(new_gd_sorting_prev$prevalence*20/100+new_gd_reject_prev$prevalence*23/100+new_gd_tray_packing_prev$prevalence*123/100+new_gd_other_prev$prevalence*10/100)/176*100
new_gd_w2wed_dry_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_w2wed_dry_prev$water <- as.factor('Dry')
names(new_gd_w2wed_dry_prev) <- c('prevalence','scenario','water')

new_gd_w2wed_recombined_prev <- rbind(new_gd_w2wed_wet_prev, new_gd_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_new_gd$w3wed_conc_list
vector <- vector[vector!='[]']
new_gd_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
    new_gd_w3wed_conc_list <- append(new_gd_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
    i <- i+1
}
new_gd_w3wed_conc_matrix <- matrix(unlist(new_gd_w3wed_conc_list), ncol = 225, byrow = TRUE)

vector <- NL_table_new_gd$loading_w3wed_conc_list
vector <- vector[vector!='[]']
new_gd_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_loading_w3wed_conc_list <- append(new_gd_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_loading_w3wed_conc_matrix <- matrix(unlist(new_gd_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_new_gd$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
new_gd_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_cleaning_w3wed_conc_list <- append(new_gd_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_cleaning_w3wed_conc_matrix <- matrix(unlist(new_gd_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_new_gd$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# new_gd_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   new_gd_drying_w3wed_conc_list <- append(new_gd_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_new_gd$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
new_gd_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_sorting_w3wed_conc_list <- append(new_gd_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_sorting_w3wed_conc_matrix <- matrix(unlist(new_gd_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_new_gd$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
new_gd_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_tray_packing_w3wed_conc_list <- append(new_gd_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_tray_packing_w3wed_conc_matrix <- matrix(unlist(new_gd_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_new_gd$reject_w3wed_conc_list
vector <- vector[vector!='[]']
new_gd_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_reject_w3wed_conc_list <- append(new_gd_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_reject_w3wed_conc_matrix <- matrix(unlist(new_gd_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_new_gd$other_w3wed_conc_list
vector <- vector[vector!='[]']
new_gd_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_other_w3wed_conc_list <- append(new_gd_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_other_w3wed_conc_matrix <- matrix(unlist(new_gd_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

new_gd_loading_concs <- as.data.frame(new_gd_loading_w3wed_conc_list)
new_gd_loading_concs$area <- as.factor('loading')
new_gd_loading_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_loading_concs$water <- as.factor('Wet')
names(new_gd_loading_concs) <- c('concentration','area','scenario','water')

new_gd_cleaning_concs <- as.data.frame(new_gd_cleaning_w3wed_conc_list)
new_gd_cleaning_concs$area <- as.factor('cleaning')
new_gd_cleaning_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_cleaning_concs$water <- as.factor('Wet')
names(new_gd_cleaning_concs) <- c('concentration','area','scenario','water')

new_gd_sorting_concs <- as.data.frame(new_gd_sorting_w3wed_conc_list)
new_gd_sorting_concs$area <- as.factor('sorting')
new_gd_sorting_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_sorting_concs$water <- as.factor('Dry')
names(new_gd_sorting_concs) <- c('concentration','area','scenario','water')

new_gd_reject_concs <- as.data.frame(new_gd_reject_w3wed_conc_list)
new_gd_reject_concs$area <- as.factor('reject')
new_gd_reject_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_reject_concs$water <- as.factor('Dry')
names(new_gd_reject_concs) <- c('concentration','area','scenario','water')

new_gd_tray_packing_concs <- as.data.frame(new_gd_tray_packing_w3wed_conc_list)
new_gd_tray_packing_concs$area <- as.factor('tray packing')
new_gd_tray_packing_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_tray_packing_concs$water <- as.factor('Dry')
names(new_gd_tray_packing_concs) <- c('concentration','area','scenario','water')

new_gd_other_concs <- as.data.frame(new_gd_other_w3wed_conc_list)
new_gd_other_concs$area <- as.factor('other')
new_gd_other_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_other_concs$water <- as.factor('Dry')
names(new_gd_other_concs) <- c('concentration','area','scenario','water')

new_gd_w3wed_concs <- rbind(new_gd_loading_concs,new_gd_cleaning_concs,new_gd_sorting_concs,new_gd_tray_packing_concs,new_gd_reject_concs,new_gd_other_concs)

new_gd_loading_prev <- as.data.frame(NL_table_new_gd$loading_w3wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_loading_prev$area <- as.factor('loading')
new_gd_loading_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_loading_prev$water <- as.factor('Wet')
names(new_gd_loading_prev) <- c('prevalence','area','scenario','water')

new_gd_cleaning_prev <- as.data.frame(NL_table_new_gd$cleaning_w3wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_cleaning_prev$area <- as.factor('cleaning')
new_gd_cleaning_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_cleaning_prev$water <- as.factor('Wet')
names(new_gd_cleaning_prev) <- c('prevalence','area','scenario','water')

new_gd_sorting_prev <- as.data.frame(NL_table_new_gd$sorting_w3wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_sorting_prev$area <- as.factor('sorting')
new_gd_sorting_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_sorting_prev$water <- as.factor('Dry')
names(new_gd_sorting_prev) <- c('prevalence','area','scenario','water')

new_gd_reject_prev <- as.data.frame(NL_table_new_gd$reject_w3wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_reject_prev$area <- as.factor('reject')
new_gd_reject_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_reject_prev$water <- as.factor('Dry')
names(new_gd_reject_prev) <- c('prevalence','area','scenario','water')

new_gd_tray_packing_prev <- as.data.frame(NL_table_new_gd$tray_packing_w3wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_tray_packing_prev$area <- as.factor('tray packing')
new_gd_tray_packing_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_tray_packing_prev$water <- as.factor('Dry')
names(new_gd_tray_packing_prev) <- c('prevalence','area','scenario','water')

new_gd_other_prev <- as.data.frame(NL_table_new_gd$other_w3wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_other_prev$area <- as.factor('other')
new_gd_other_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_other_prev$water <- as.factor('Dry')
names(new_gd_other_prev) <- c('prevalence','area','scenario','water')

new_gd_w3wed_prev <- rbind(new_gd_loading_prev,new_gd_cleaning_prev,new_gd_sorting_prev,new_gd_tray_packing_prev,new_gd_reject_prev,new_gd_other_prev)

new_gd_w3wed_wet_prev <- as.data.frame(new_gd_loading_prev$prevalence*21/100+new_gd_cleaning_prev$prevalence*28/100)/49*100
new_gd_w3wed_wet_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_w3wed_wet_prev$water <- as.factor('Wet')
names(new_gd_w3wed_wet_prev) <- c('prevalence','scenario','water')

new_gd_w3wed_dry_prev <- as.data.frame(new_gd_sorting_prev$prevalence*20/100+new_gd_reject_prev$prevalence*23/100+new_gd_tray_packing_prev$prevalence*123/100+new_gd_other_prev$prevalence*10/100)/176*100
new_gd_w3wed_dry_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_w3wed_dry_prev$water <- as.factor('Dry')
names(new_gd_w3wed_dry_prev) <- c('prevalence','scenario','water')

new_gd_w3wed_recombined_prev <- rbind(new_gd_w3wed_wet_prev, new_gd_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_new_gd$w4wed_conc_list
vector <- vector[vector!='[]']
new_gd_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
    new_gd_w4wed_conc_list <- append(new_gd_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
    i <- i+1
}
new_gd_w4wed_conc_matrix <- matrix(unlist(new_gd_w4wed_conc_list), ncol = 225, byrow = TRUE)

vector <- NL_table_new_gd$loading_w4wed_conc_list
vector <- vector[vector!='[]']
new_gd_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_loading_w4wed_conc_list <- append(new_gd_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_loading_w4wed_conc_matrix <- matrix(unlist(new_gd_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_new_gd$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
new_gd_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_cleaning_w4wed_conc_list <- append(new_gd_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_cleaning_w4wed_conc_matrix <- matrix(unlist(new_gd_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_new_gd$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# new_gd_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   new_gd_drying_w4wed_conc_list <- append(new_gd_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_new_gd$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
new_gd_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_sorting_w4wed_conc_list <- append(new_gd_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_sorting_w4wed_conc_matrix <- matrix(unlist(new_gd_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_new_gd$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
new_gd_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_tray_packing_w4wed_conc_list <- append(new_gd_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_tray_packing_w4wed_conc_matrix <- matrix(unlist(new_gd_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_new_gd$reject_w4wed_conc_list
vector <- vector[vector!='[]']
new_gd_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_reject_w4wed_conc_list <- append(new_gd_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_reject_w4wed_conc_matrix <- matrix(unlist(new_gd_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_new_gd$other_w4wed_conc_list
vector <- vector[vector!='[]']
new_gd_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_other_w4wed_conc_list <- append(new_gd_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_other_w4wed_conc_matrix <- matrix(unlist(new_gd_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

new_gd_loading_concs <- as.data.frame(new_gd_loading_w4wed_conc_list)
new_gd_loading_concs$area <- as.factor('loading')
new_gd_loading_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_loading_concs$water <- as.factor('Wet')
names(new_gd_loading_concs) <- c('concentration','area','scenario','water')

new_gd_cleaning_concs <- as.data.frame(new_gd_cleaning_w4wed_conc_list)
new_gd_cleaning_concs$area <- as.factor('cleaning')
new_gd_cleaning_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_cleaning_concs$water <- as.factor('Wet')
names(new_gd_cleaning_concs) <- c('concentration','area','scenario','water')

new_gd_sorting_concs <- as.data.frame(new_gd_sorting_w4wed_conc_list)
new_gd_sorting_concs$area <- as.factor('sorting')
new_gd_sorting_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_sorting_concs$water <- as.factor('Dry')
names(new_gd_sorting_concs) <- c('concentration','area','scenario','water')

new_gd_reject_concs <- as.data.frame(new_gd_reject_w4wed_conc_list)
new_gd_reject_concs$area <- as.factor('reject')
new_gd_reject_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_reject_concs$water <- as.factor('Dry')
names(new_gd_reject_concs) <- c('concentration','area','scenario','water')

new_gd_tray_packing_concs <- as.data.frame(new_gd_tray_packing_w4wed_conc_list)
new_gd_tray_packing_concs$area <- as.factor('tray packing')
new_gd_tray_packing_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_tray_packing_concs$water <- as.factor('Dry')
names(new_gd_tray_packing_concs) <- c('concentration','area','scenario','water')

new_gd_other_concs <- as.data.frame(new_gd_other_w4wed_conc_list)
new_gd_other_concs$area <- as.factor('other')
new_gd_other_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_other_concs$water <- as.factor('Dry')
names(new_gd_other_concs) <- c('concentration','area','scenario','water')

new_gd_w4wed_concs <- rbind(new_gd_loading_concs,new_gd_cleaning_concs,new_gd_sorting_concs,new_gd_tray_packing_concs,new_gd_reject_concs,new_gd_other_concs)

new_gd_loading_prev <- as.data.frame(NL_table_new_gd$loading_w4wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_loading_prev$area <- as.factor('loading')
new_gd_loading_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_loading_prev$water <- as.factor('Wet')
names(new_gd_loading_prev) <- c('prevalence','area','scenario','water')

new_gd_cleaning_prev <- as.data.frame(NL_table_new_gd$cleaning_w4wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_cleaning_prev$area <- as.factor('cleaning')
new_gd_cleaning_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_cleaning_prev$water <- as.factor('Wet')
names(new_gd_cleaning_prev) <- c('prevalence','area','scenario','water')

new_gd_sorting_prev <- as.data.frame(NL_table_new_gd$sorting_w4wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_sorting_prev$area <- as.factor('sorting')
new_gd_sorting_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_sorting_prev$water <- as.factor('Dry')
names(new_gd_sorting_prev) <- c('prevalence','area','scenario','water')

new_gd_reject_prev <- as.data.frame(NL_table_new_gd$reject_w4wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_reject_prev$area <- as.factor('reject')
new_gd_reject_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_reject_prev$water <- as.factor('Dry')
names(new_gd_reject_prev) <- c('prevalence','area','scenario','water')

new_gd_tray_packing_prev <- as.data.frame(NL_table_new_gd$tray_packing_w4wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_tray_packing_prev$area <- as.factor('tray packing')
new_gd_tray_packing_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_tray_packing_prev$water <- as.factor('Dry')
names(new_gd_tray_packing_prev) <- c('prevalence','area','scenario','water')

new_gd_other_prev <- as.data.frame(NL_table_new_gd$other_w4wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_other_prev$area <- as.factor('other')
new_gd_other_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_other_prev$water <- as.factor('Dry')
names(new_gd_other_prev) <- c('prevalence','area','scenario','water')

new_gd_w4wed_prev <- rbind(new_gd_loading_prev,new_gd_cleaning_prev,new_gd_sorting_prev,new_gd_tray_packing_prev,new_gd_reject_prev,new_gd_other_prev)

new_gd_w4wed_wet_prev <- as.data.frame(new_gd_loading_prev$prevalence*21/100+new_gd_cleaning_prev$prevalence*28/100)/49*100
new_gd_w4wed_wet_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_w4wed_wet_prev$water <- as.factor('Wet')
names(new_gd_w4wed_wet_prev) <- c('prevalence','scenario','water')

new_gd_w4wed_dry_prev <- as.data.frame(new_gd_sorting_prev$prevalence*20/100+new_gd_reject_prev$prevalence*23/100+new_gd_tray_packing_prev$prevalence*123/100+new_gd_other_prev$prevalence*10/100)/176*100
new_gd_w4wed_dry_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_w4wed_dry_prev$water <- as.factor('Dry')
names(new_gd_w4wed_dry_prev) <- c('prevalence','scenario','water')

new_gd_w4wed_recombined_prev <- rbind(new_gd_w4wed_wet_prev, new_gd_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_new_gd$w5wed_conc_list
vector <- vector[vector!='[]']
new_gd_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
    new_gd_w5wed_conc_list <- append(new_gd_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
    i <- i+1
}
new_gd_w5wed_conc_matrix <- matrix(unlist(new_gd_w5wed_conc_list), ncol = 225, byrow = TRUE)

vector <- NL_table_new_gd$loading_w5wed_conc_list
vector <- vector[vector!='[]']
new_gd_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_loading_w5wed_conc_list <- append(new_gd_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_loading_w5wed_conc_matrix <- matrix(unlist(new_gd_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_new_gd$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
new_gd_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_cleaning_w5wed_conc_list <- append(new_gd_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_cleaning_w5wed_conc_matrix <- matrix(unlist(new_gd_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_new_gd$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# new_gd_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   new_gd_drying_w5wed_conc_list <- append(new_gd_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_new_gd$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
new_gd_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_sorting_w5wed_conc_list <- append(new_gd_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_sorting_w5wed_conc_matrix <- matrix(unlist(new_gd_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_new_gd$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
new_gd_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_tray_packing_w5wed_conc_list <- append(new_gd_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_tray_packing_w5wed_conc_matrix <- matrix(unlist(new_gd_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_new_gd$reject_w5wed_conc_list
vector <- vector[vector!='[]']
new_gd_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_reject_w5wed_conc_list <- append(new_gd_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_reject_w5wed_conc_matrix <- matrix(unlist(new_gd_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_new_gd$other_w5wed_conc_list
vector <- vector[vector!='[]']
new_gd_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_other_w5wed_conc_list <- append(new_gd_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_other_w5wed_conc_matrix <- matrix(unlist(new_gd_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

new_gd_loading_concs <- as.data.frame(new_gd_loading_w5wed_conc_list)
new_gd_loading_concs$area <- as.factor('loading')
new_gd_loading_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_loading_concs$water <- as.factor('Wet')
names(new_gd_loading_concs) <- c('concentration','area','scenario','water')

new_gd_cleaning_concs <- as.data.frame(new_gd_cleaning_w5wed_conc_list)
new_gd_cleaning_concs$area <- as.factor('cleaning')
new_gd_cleaning_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_cleaning_concs$water <- as.factor('Wet')
names(new_gd_cleaning_concs) <- c('concentration','area','scenario','water')

new_gd_sorting_concs <- as.data.frame(new_gd_sorting_w5wed_conc_list)
new_gd_sorting_concs$area <- as.factor('sorting')
new_gd_sorting_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_sorting_concs$water <- as.factor('Dry')
names(new_gd_sorting_concs) <- c('concentration','area','scenario','water')

new_gd_reject_concs <- as.data.frame(new_gd_reject_w5wed_conc_list)
new_gd_reject_concs$area <- as.factor('reject')
new_gd_reject_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_reject_concs$water <- as.factor('Dry')
names(new_gd_reject_concs) <- c('concentration','area','scenario','water')

new_gd_tray_packing_concs <- as.data.frame(new_gd_tray_packing_w5wed_conc_list)
new_gd_tray_packing_concs$area <- as.factor('tray packing')
new_gd_tray_packing_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_tray_packing_concs$water <- as.factor('Dry')
names(new_gd_tray_packing_concs) <- c('concentration','area','scenario','water')

new_gd_other_concs <- as.data.frame(new_gd_other_w5wed_conc_list)
new_gd_other_concs$area <- as.factor('other')
new_gd_other_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_other_concs$water <- as.factor('Dry')
names(new_gd_other_concs) <- c('concentration','area','scenario','water')

new_gd_w5wed_concs <- rbind(new_gd_loading_concs,new_gd_cleaning_concs,new_gd_sorting_concs,new_gd_tray_packing_concs,new_gd_reject_concs,new_gd_other_concs)

new_gd_loading_prev <- as.data.frame(NL_table_new_gd$loading_w5wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_loading_prev$area <- as.factor('loading')
new_gd_loading_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_loading_prev$water <- as.factor('Wet')
names(new_gd_loading_prev) <- c('prevalence','area','scenario','water')

new_gd_cleaning_prev <- as.data.frame(NL_table_new_gd$cleaning_w5wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_cleaning_prev$area <- as.factor('cleaning')
new_gd_cleaning_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_cleaning_prev$water <- as.factor('Wet')
names(new_gd_cleaning_prev) <- c('prevalence','area','scenario','water')

new_gd_sorting_prev <- as.data.frame(NL_table_new_gd$sorting_w5wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_sorting_prev$area <- as.factor('sorting')
new_gd_sorting_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_sorting_prev$water <- as.factor('Dry')
names(new_gd_sorting_prev) <- c('prevalence','area','scenario','water')

new_gd_reject_prev <- as.data.frame(NL_table_new_gd$reject_w5wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_reject_prev$area <- as.factor('reject')
new_gd_reject_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_reject_prev$water <- as.factor('Dry')
names(new_gd_reject_prev) <- c('prevalence','area','scenario','water')

new_gd_tray_packing_prev <- as.data.frame(NL_table_new_gd$tray_packing_w5wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_tray_packing_prev$area <- as.factor('tray packing')
new_gd_tray_packing_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_tray_packing_prev$water <- as.factor('Dry')
names(new_gd_tray_packing_prev) <- c('prevalence','area','scenario','water')

new_gd_other_prev <- as.data.frame(NL_table_new_gd$other_w5wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_other_prev$area <- as.factor('other')
new_gd_other_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_other_prev$water <- as.factor('Dry')
names(new_gd_other_prev) <- c('prevalence','area','scenario','water')

new_gd_w5wed_prev <- rbind(new_gd_loading_prev,new_gd_cleaning_prev,new_gd_sorting_prev,new_gd_tray_packing_prev,new_gd_reject_prev,new_gd_other_prev)

new_gd_w5wed_wet_prev <- as.data.frame(new_gd_loading_prev$prevalence*21/100+new_gd_cleaning_prev$prevalence*28/100)/49*100
new_gd_w5wed_wet_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_w5wed_wet_prev$water <- as.factor('Wet')
names(new_gd_w5wed_wet_prev) <- c('prevalence','scenario','water')

new_gd_w5wed_dry_prev <- as.data.frame(new_gd_sorting_prev$prevalence*20/100+new_gd_reject_prev$prevalence*23/100+new_gd_tray_packing_prev$prevalence*123/100+new_gd_other_prev$prevalence*10/100)/176*100
new_gd_w5wed_dry_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_w5wed_dry_prev$water <- as.factor('Dry')
names(new_gd_w5wed_dry_prev) <- c('prevalence','scenario','water')

new_gd_w5wed_recombined_prev <- rbind(new_gd_w5wed_wet_prev, new_gd_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_new_gd$w6wed_conc_list
vector <- vector[vector!='[]']
new_gd_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
    new_gd_w6wed_conc_list <- append(new_gd_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
    i <- i+1
}
new_gd_w6wed_conc_matrix <- matrix(unlist(new_gd_w6wed_conc_list), ncol = 225, byrow = TRUE)

vector <- NL_table_new_gd$loading_w6wed_conc_list
vector <- vector[vector!='[]']
new_gd_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_loading_w6wed_conc_list <- append(new_gd_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_loading_w6wed_conc_matrix <- matrix(unlist(new_gd_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_new_gd$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
new_gd_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_cleaning_w6wed_conc_list <- append(new_gd_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_cleaning_w6wed_conc_matrix <- matrix(unlist(new_gd_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_new_gd$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# new_gd_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   new_gd_drying_w6wed_conc_list <- append(new_gd_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_new_gd$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
new_gd_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_sorting_w6wed_conc_list <- append(new_gd_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_sorting_w6wed_conc_matrix <- matrix(unlist(new_gd_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_new_gd$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
new_gd_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_tray_packing_w6wed_conc_list <- append(new_gd_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_tray_packing_w6wed_conc_matrix <- matrix(unlist(new_gd_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_new_gd$reject_w6wed_conc_list
vector <- vector[vector!='[]']
new_gd_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_reject_w6wed_conc_list <- append(new_gd_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_reject_w6wed_conc_matrix <- matrix(unlist(new_gd_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_new_gd$other_w6wed_conc_list
vector <- vector[vector!='[]']
new_gd_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_other_w6wed_conc_list <- append(new_gd_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_other_w6wed_conc_matrix <- matrix(unlist(new_gd_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

new_gd_loading_concs <- as.data.frame(new_gd_loading_w6wed_conc_list)
new_gd_loading_concs$area <- as.factor('loading')
new_gd_loading_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_loading_concs$water <- as.factor('Wet')
names(new_gd_loading_concs) <- c('concentration','area','scenario','water')

new_gd_cleaning_concs <- as.data.frame(new_gd_cleaning_w6wed_conc_list)
new_gd_cleaning_concs$area <- as.factor('cleaning')
new_gd_cleaning_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_cleaning_concs$water <- as.factor('Wet')
names(new_gd_cleaning_concs) <- c('concentration','area','scenario','water')

new_gd_sorting_concs <- as.data.frame(new_gd_sorting_w6wed_conc_list)
new_gd_sorting_concs$area <- as.factor('sorting')
new_gd_sorting_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_sorting_concs$water <- as.factor('Dry')
names(new_gd_sorting_concs) <- c('concentration','area','scenario','water')

new_gd_reject_concs <- as.data.frame(new_gd_reject_w6wed_conc_list)
new_gd_reject_concs$area <- as.factor('reject')
new_gd_reject_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_reject_concs$water <- as.factor('Dry')
names(new_gd_reject_concs) <- c('concentration','area','scenario','water')

new_gd_tray_packing_concs <- as.data.frame(new_gd_tray_packing_w6wed_conc_list)
new_gd_tray_packing_concs$area <- as.factor('tray packing')
new_gd_tray_packing_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_tray_packing_concs$water <- as.factor('Dry')
names(new_gd_tray_packing_concs) <- c('concentration','area','scenario','water')

new_gd_other_concs <- as.data.frame(new_gd_other_w6wed_conc_list)
new_gd_other_concs$area <- as.factor('other')
new_gd_other_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_other_concs$water <- as.factor('Dry')
names(new_gd_other_concs) <- c('concentration','area','scenario','water')

new_gd_w6wed_concs <- rbind(new_gd_loading_concs,new_gd_cleaning_concs,new_gd_sorting_concs,new_gd_tray_packing_concs,new_gd_reject_concs,new_gd_other_concs)

new_gd_loading_prev <- as.data.frame(NL_table_new_gd$loading_w6wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_loading_prev$area <- as.factor('loading')
new_gd_loading_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_loading_prev$water <- as.factor('Wet')
names(new_gd_loading_prev) <- c('prevalence','area','scenario','water')

new_gd_cleaning_prev <- as.data.frame(NL_table_new_gd$cleaning_w6wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_cleaning_prev$area <- as.factor('cleaning')
new_gd_cleaning_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_cleaning_prev$water <- as.factor('Wet')
names(new_gd_cleaning_prev) <- c('prevalence','area','scenario','water')

new_gd_sorting_prev <- as.data.frame(NL_table_new_gd$sorting_w6wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_sorting_prev$area <- as.factor('sorting')
new_gd_sorting_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_sorting_prev$water <- as.factor('Dry')
names(new_gd_sorting_prev) <- c('prevalence','area','scenario','water')

new_gd_reject_prev <- as.data.frame(NL_table_new_gd$reject_w6wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_reject_prev$area <- as.factor('reject')
new_gd_reject_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_reject_prev$water <- as.factor('Dry')
names(new_gd_reject_prev) <- c('prevalence','area','scenario','water')

new_gd_tray_packing_prev <- as.data.frame(NL_table_new_gd$tray_packing_w6wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_tray_packing_prev$area <- as.factor('tray packing')
new_gd_tray_packing_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_tray_packing_prev$water <- as.factor('Dry')
names(new_gd_tray_packing_prev) <- c('prevalence','area','scenario','water')

new_gd_other_prev <- as.data.frame(NL_table_new_gd$other_w6wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_other_prev$area <- as.factor('other')
new_gd_other_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_other_prev$water <- as.factor('Dry')
names(new_gd_other_prev) <- c('prevalence','area','scenario','water')

new_gd_w6wed_prev <- rbind(new_gd_loading_prev,new_gd_cleaning_prev,new_gd_sorting_prev,new_gd_tray_packing_prev,new_gd_reject_prev,new_gd_other_prev)

new_gd_w6wed_wet_prev <- as.data.frame(new_gd_loading_prev$prevalence*21/100+new_gd_cleaning_prev$prevalence*28/100)/49*100
new_gd_w6wed_wet_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_w6wed_wet_prev$water <- as.factor('Wet')
names(new_gd_w6wed_wet_prev) <- c('prevalence','scenario','water')

new_gd_w6wed_dry_prev <- as.data.frame(new_gd_sorting_prev$prevalence*20/100+new_gd_reject_prev$prevalence*23/100+new_gd_tray_packing_prev$prevalence*123/100+new_gd_other_prev$prevalence*10/100)/176*100
new_gd_w6wed_dry_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_w6wed_dry_prev$water <- as.factor('Dry')
names(new_gd_w6wed_dry_prev) <- c('prevalence','scenario','water')

new_gd_w6wed_recombined_prev <- rbind(new_gd_w6wed_wet_prev, new_gd_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_new_gd$w7wed_conc_list
vector <- vector[vector!='[]']
new_gd_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
    new_gd_w7wed_conc_list <- append(new_gd_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
    i <- i+1
}
new_gd_w7wed_conc_matrix <- matrix(unlist(new_gd_w7wed_conc_list), ncol = 225, byrow = TRUE)

vector <- NL_table_new_gd$loading_w7wed_conc_list
vector <- vector[vector!='[]']
new_gd_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_loading_w7wed_conc_list <- append(new_gd_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_loading_w7wed_conc_matrix <- matrix(unlist(new_gd_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_new_gd$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
new_gd_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_cleaning_w7wed_conc_list <- append(new_gd_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_cleaning_w7wed_conc_matrix <- matrix(unlist(new_gd_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_new_gd$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# new_gd_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   new_gd_drying_w7wed_conc_list <- append(new_gd_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_new_gd$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
new_gd_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_sorting_w7wed_conc_list <- append(new_gd_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_sorting_w7wed_conc_matrix <- matrix(unlist(new_gd_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_new_gd$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
new_gd_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_tray_packing_w7wed_conc_list <- append(new_gd_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_tray_packing_w7wed_conc_matrix <- matrix(unlist(new_gd_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_new_gd$reject_w7wed_conc_list
vector <- vector[vector!='[]']
new_gd_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_reject_w7wed_conc_list <- append(new_gd_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_reject_w7wed_conc_matrix <- matrix(unlist(new_gd_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_new_gd$other_w7wed_conc_list
vector <- vector[vector!='[]']
new_gd_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_other_w7wed_conc_list <- append(new_gd_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_other_w7wed_conc_matrix <- matrix(unlist(new_gd_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

new_gd_loading_concs <- as.data.frame(new_gd_loading_w7wed_conc_list)
new_gd_loading_concs$area <- as.factor('loading')
new_gd_loading_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_loading_concs$water <- as.factor('Wet')
names(new_gd_loading_concs) <- c('concentration','area','scenario','water')

new_gd_cleaning_concs <- as.data.frame(new_gd_cleaning_w7wed_conc_list)
new_gd_cleaning_concs$area <- as.factor('cleaning')
new_gd_cleaning_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_cleaning_concs$water <- as.factor('Wet')
names(new_gd_cleaning_concs) <- c('concentration','area','scenario','water')

new_gd_sorting_concs <- as.data.frame(new_gd_sorting_w7wed_conc_list)
new_gd_sorting_concs$area <- as.factor('sorting')
new_gd_sorting_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_sorting_concs$water <- as.factor('Dry')
names(new_gd_sorting_concs) <- c('concentration','area','scenario','water')

new_gd_reject_concs <- as.data.frame(new_gd_reject_w7wed_conc_list)
new_gd_reject_concs$area <- as.factor('reject')
new_gd_reject_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_reject_concs$water <- as.factor('Dry')
names(new_gd_reject_concs) <- c('concentration','area','scenario','water')

new_gd_tray_packing_concs <- as.data.frame(new_gd_tray_packing_w7wed_conc_list)
new_gd_tray_packing_concs$area <- as.factor('tray packing')
new_gd_tray_packing_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_tray_packing_concs$water <- as.factor('Dry')
names(new_gd_tray_packing_concs) <- c('concentration','area','scenario','water')

new_gd_other_concs <- as.data.frame(new_gd_other_w7wed_conc_list)
new_gd_other_concs$area <- as.factor('other')
new_gd_other_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_other_concs$water <- as.factor('Dry')
names(new_gd_other_concs) <- c('concentration','area','scenario','water')

new_gd_w7wed_concs <- rbind(new_gd_loading_concs,new_gd_cleaning_concs,new_gd_sorting_concs,new_gd_tray_packing_concs,new_gd_reject_concs,new_gd_other_concs)

new_gd_loading_prev <- as.data.frame(NL_table_new_gd$loading_w7wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_loading_prev$area <- as.factor('loading')
new_gd_loading_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_loading_prev$water <- as.factor('Wet')
names(new_gd_loading_prev) <- c('prevalence','area','scenario','water')

new_gd_cleaning_prev <- as.data.frame(NL_table_new_gd$cleaning_w7wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_cleaning_prev$area <- as.factor('cleaning')
new_gd_cleaning_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_cleaning_prev$water <- as.factor('Wet')
names(new_gd_cleaning_prev) <- c('prevalence','area','scenario','water')

new_gd_sorting_prev <- as.data.frame(NL_table_new_gd$sorting_w7wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_sorting_prev$area <- as.factor('sorting')
new_gd_sorting_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_sorting_prev$water <- as.factor('Dry')
names(new_gd_sorting_prev) <- c('prevalence','area','scenario','water')

new_gd_reject_prev <- as.data.frame(NL_table_new_gd$reject_w7wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_reject_prev$area <- as.factor('reject')
new_gd_reject_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_reject_prev$water <- as.factor('Dry')
names(new_gd_reject_prev) <- c('prevalence','area','scenario','water')

new_gd_tray_packing_prev <- as.data.frame(NL_table_new_gd$tray_packing_w7wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_tray_packing_prev$area <- as.factor('tray packing')
new_gd_tray_packing_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_tray_packing_prev$water <- as.factor('Dry')
names(new_gd_tray_packing_prev) <- c('prevalence','area','scenario','water')

new_gd_other_prev <- as.data.frame(NL_table_new_gd$other_w7wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_other_prev$area <- as.factor('other')
new_gd_other_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_other_prev$water <- as.factor('Dry')
names(new_gd_other_prev) <- c('prevalence','area','scenario','water')

new_gd_w7wed_prev <- rbind(new_gd_loading_prev,new_gd_cleaning_prev,new_gd_sorting_prev,new_gd_tray_packing_prev,new_gd_reject_prev,new_gd_other_prev)

new_gd_w7wed_wet_prev <- as.data.frame(new_gd_loading_prev$prevalence*21/100+new_gd_cleaning_prev$prevalence*28/100)/49*100
new_gd_w7wed_wet_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_w7wed_wet_prev$water <- as.factor('Wet')
names(new_gd_w7wed_wet_prev) <- c('prevalence','scenario','water')

new_gd_w7wed_dry_prev <- as.data.frame(new_gd_sorting_prev$prevalence*20/100+new_gd_reject_prev$prevalence*23/100+new_gd_tray_packing_prev$prevalence*123/100+new_gd_other_prev$prevalence*10/100)/176*100
new_gd_w7wed_dry_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_w7wed_dry_prev$water <- as.factor('Dry')
names(new_gd_w7wed_dry_prev) <- c('prevalence','scenario','water')

new_gd_w7wed_recombined_prev <- rbind(new_gd_w7wed_wet_prev, new_gd_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_new_gd$w8wed_conc_list
vector <- vector[vector!='[]']
new_gd_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
    new_gd_w8wed_conc_list <- append(new_gd_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
    i <- i+1
}
new_gd_w8wed_conc_matrix <- matrix(unlist(new_gd_w8wed_conc_list), ncol = 225, byrow = TRUE)

vector <- NL_table_new_gd$loading_w8wed_conc_list
vector <- vector[vector!='[]']
new_gd_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_loading_w8wed_conc_list <- append(new_gd_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_loading_w8wed_conc_matrix <- matrix(unlist(new_gd_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_new_gd$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
new_gd_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_cleaning_w8wed_conc_list <- append(new_gd_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_cleaning_w8wed_conc_matrix <- matrix(unlist(new_gd_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_new_gd$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# new_gd_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   new_gd_drying_w8wed_conc_list <- append(new_gd_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_new_gd$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
new_gd_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_sorting_w8wed_conc_list <- append(new_gd_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_sorting_w8wed_conc_matrix <- matrix(unlist(new_gd_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_new_gd$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
new_gd_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_tray_packing_w8wed_conc_list <- append(new_gd_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_tray_packing_w8wed_conc_matrix <- matrix(unlist(new_gd_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_new_gd$reject_w8wed_conc_list
vector <- vector[vector!='[]']
new_gd_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_reject_w8wed_conc_list <- append(new_gd_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_reject_w8wed_conc_matrix <- matrix(unlist(new_gd_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_new_gd$other_w8wed_conc_list
vector <- vector[vector!='[]']
new_gd_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  new_gd_other_w8wed_conc_list <- append(new_gd_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
new_gd_other_w8wed_conc_matrix <- matrix(unlist(new_gd_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

new_gd_loading_concs <- as.data.frame(new_gd_loading_w8wed_conc_list)
new_gd_loading_concs$area <- as.factor('loading')
new_gd_loading_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_loading_concs$water <- as.factor('Wet')
names(new_gd_loading_concs) <- c('concentration','area','scenario','water')

new_gd_cleaning_concs <- as.data.frame(new_gd_cleaning_w8wed_conc_list)
new_gd_cleaning_concs$area <- as.factor('cleaning')
new_gd_cleaning_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_cleaning_concs$water <- as.factor('Wet')
names(new_gd_cleaning_concs) <- c('concentration','area','scenario','water')

new_gd_sorting_concs <- as.data.frame(new_gd_sorting_w8wed_conc_list)
new_gd_sorting_concs$area <- as.factor('sorting')
new_gd_sorting_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_sorting_concs$water <- as.factor('Dry')
names(new_gd_sorting_concs) <- c('concentration','area','scenario','water')

new_gd_reject_concs <- as.data.frame(new_gd_reject_w8wed_conc_list)
new_gd_reject_concs$area <- as.factor('reject')
new_gd_reject_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_reject_concs$water <- as.factor('Dry')
names(new_gd_reject_concs) <- c('concentration','area','scenario','water')

new_gd_tray_packing_concs <- as.data.frame(new_gd_tray_packing_w8wed_conc_list)
new_gd_tray_packing_concs$area <- as.factor('tray packing')
new_gd_tray_packing_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_tray_packing_concs$water <- as.factor('Dry')
names(new_gd_tray_packing_concs) <- c('concentration','area','scenario','water')

new_gd_other_concs <- as.data.frame(new_gd_other_w8wed_conc_list)
new_gd_other_concs$area <- as.factor('other')
new_gd_other_concs$scenario <- as.factor('New Gamma/Delta')
new_gd_other_concs$water <- as.factor('Dry')
names(new_gd_other_concs) <- c('concentration','area','scenario','water')

new_gd_w8wed_concs <- rbind(new_gd_loading_concs,new_gd_cleaning_concs,new_gd_sorting_concs,new_gd_tray_packing_concs,new_gd_reject_concs,new_gd_other_concs)

new_gd_loading_prev <- as.data.frame(NL_table_new_gd$loading_w8wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_loading_prev$area <- as.factor('loading')
new_gd_loading_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_loading_prev$water <- as.factor('Wet')
names(new_gd_loading_prev) <- c('prevalence','area','scenario','water')

new_gd_cleaning_prev <- as.data.frame(NL_table_new_gd$cleaning_w8wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_cleaning_prev$area <- as.factor('cleaning')
new_gd_cleaning_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_cleaning_prev$water <- as.factor('Wet')
names(new_gd_cleaning_prev) <- c('prevalence','area','scenario','water')

new_gd_sorting_prev <- as.data.frame(NL_table_new_gd$sorting_w8wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_sorting_prev$area <- as.factor('sorting')
new_gd_sorting_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_sorting_prev$water <- as.factor('Dry')
names(new_gd_sorting_prev) <- c('prevalence','area','scenario','water')

new_gd_reject_prev <- as.data.frame(NL_table_new_gd$reject_w8wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_reject_prev$area <- as.factor('reject')
new_gd_reject_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_reject_prev$water <- as.factor('Dry')
names(new_gd_reject_prev) <- c('prevalence','area','scenario','water')

new_gd_tray_packing_prev <- as.data.frame(NL_table_new_gd$tray_packing_w8wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_tray_packing_prev$area <- as.factor('tray packing')
new_gd_tray_packing_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_tray_packing_prev$water <- as.factor('Dry')
names(new_gd_tray_packing_prev) <- c('prevalence','area','scenario','water')

new_gd_other_prev <- as.data.frame(NL_table_new_gd$other_w8wed_prev[order(NL_table_new_gd$local_seed)])
new_gd_other_prev$area <- as.factor('other')
new_gd_other_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_other_prev$water <- as.factor('Dry')
names(new_gd_other_prev) <- c('prevalence','area','scenario','water')

new_gd_w8wed_prev <- rbind(new_gd_loading_prev,new_gd_cleaning_prev,new_gd_sorting_prev,new_gd_tray_packing_prev,new_gd_reject_prev,new_gd_other_prev)

new_gd_w8wed_wet_prev <- as.data.frame(new_gd_loading_prev$prevalence*21/100+new_gd_cleaning_prev$prevalence*28/100)/49*100
new_gd_w8wed_wet_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_w8wed_wet_prev$water <- as.factor('Wet')
names(new_gd_w8wed_wet_prev) <- c('prevalence','scenario','water')

new_gd_w8wed_dry_prev <- as.data.frame(new_gd_sorting_prev$prevalence*20/100+new_gd_reject_prev$prevalence*23/100+new_gd_tray_packing_prev$prevalence*123/100+new_gd_other_prev$prevalence*10/100)/176*100
new_gd_w8wed_dry_prev$scenario <- as.factor('New Gamma/Delta')
new_gd_w8wed_dry_prev$water <- as.factor('Dry')
names(new_gd_w8wed_dry_prev) <- c('prevalence','scenario','water')

new_gd_w8wed_recombined_prev <- rbind(new_gd_w8wed_wet_prev, new_gd_w8wed_dry_prev)

vector <- NL_table_new_gd$lifetime_conc_list[order(NL_table_new_gd$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

new_gd_w1wed_recombined_prev$week <- as.factor(1)
new_gd_w2wed_recombined_prev$week <- as.factor(2)
new_gd_w3wed_recombined_prev$week <- as.factor(3)
new_gd_w4wed_recombined_prev$week <- as.factor(4)
new_gd_w5wed_recombined_prev$week <- as.factor(5)
new_gd_w6wed_recombined_prev$week <- as.factor(6)
new_gd_w7wed_recombined_prev$week <- as.factor(7)
new_gd_w8wed_recombined_prev$week <- as.factor(8)
new_gd_allwed_prev <- rbind(new_gd_w1wed_recombined_prev,new_gd_w2wed_recombined_prev,new_gd_w3wed_recombined_prev,new_gd_w4wed_recombined_prev,new_gd_w5wed_recombined_prev,new_gd_w6wed_recombined_prev,new_gd_w7wed_recombined_prev,new_gd_w8wed_recombined_prev)

# Facility_B_new_gd_agents_melted <- melt(mdarray)
# colnames(Facility_B_new_gd_agents_melted) <- c("agent", "tick", "iteration", "value")
# Facility_B_new_gd_agents_melted$agent <- Facility_B_new_gd_agents_melted$agent-1
# Facility_B_new_gd_agents_melted$logical <- Facility_B_new_gd_agents_melted$value>0
# Facility_B_new_gd_agents_melted$binary <- as.numeric(Facility_B_new_gd_agents_melted$logical)
# Facility_B_new_gd_agents_melted$log10value <- log10(Facility_B_new_gd_agents_melted$value)
# Facility_B_new_gd_agents_melted$log10value[is.infinite(Facility_B_new_gd_agents_melted$log10value)] <- 0
# 
# agent <- Facility_B_new_gd_agents_melted$agent
# iteration <- Facility_B_new_gd_agents_melted$iteration
# tick <- Facility_B_new_gd_agents_melted$tick
# rle_matrix <- tapply(Facility_B_new_gd_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_new_gd_mean_value_matrix <- tapply(Facility_B_new_gd_agents_melted$value, list(agent, tick), mean)
# Facility_B_new_gd_median_value_matrix <- tapply(Facility_B_new_gd_agents_melted$value, list(agent, tick), median)
# x <- Facility_B_new_gd_agents_melted
# x$value[x$value==0] <- NA
# Facility_B_new_gd_pos_median_value_matrix <- tapply(x$value, list(agent, tick), median, na.rm=TRUE)
# Facility_B_new_gd_prob_value_matrix <- tapply(Facility_B_new_gd_agents_melted$binary, list(agent, tick), sum)/100
# 
# durations <- data.frame(
#   duration=integer(),
#   agent=integer(),
#   iteration=integer(),
#   stringsAsFactors=FALSE
# )

# #Maximum sensitivity####
# agent <- 1
# while(agent<=225) {
#   iteration <- 1
#   while(iteration<=100) {
#     if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
#       df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
#       colnames(df) <- c('duration', 'agent', 'iteration')
#       durations <- rbind(durations, df)
#     }
#     iteration <- iteration + 1
#   }
#   agent <- agent+1
# }
# 
# Facility_B_durations_new_gd <- durations
# 
# agents_list_new_gd <- read.table(paste0(getwd(),'/Data/Agents - No Niches.txt'))
# agents_list_new_gd <- agents_list_new_gd[,c("V1","V7","V8","V9")]
# colnames(agents_list_new_gd) <- c("name","sanitation_status","schedule","area")
# #Time to persistence
# agents_list_new_gd$time_to_persistence <- rep((168*2),225)
# agents_list_new_gd$time_to_persistence[agents_list_new_gd$schedule=="daily"] <- (24*2)
# 
# persistent_short_durations_list_new_gd <- data.frame()
# persistent_long_durations_list_new_gd <- data.frame()
# persistent_uncleanable_durations_list_new_gd <- data.frame()
# transient_short_durations_list_new_gd <- data.frame()
# transient_long_durations_list_new_gd <- data.frame()
# transient_uncleanable_durations_list_new_gd <- data.frame()
# agent <- 1
# while(agent<=225) {
#   ##All Durations####
#   #Minimum Contamination Duration
#   agents_list_new_gd$min_duration[agent] <- ifelse(length(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent])==0,NA,min(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent], na.rm = TRUE))
#   #Mean Contamination Duration
#   agents_list_new_gd$mean_duration[agent] <- ifelse(length(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent])==0,NA,mean(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent], na.rm = TRUE))
#   #Median Contamination Duration
#   agents_list_new_gd$median_duration[agent] <- ifelse(length(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent])==0,NA,median(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent], na.rm = TRUE))
#   #Maximum Contamination Duration
#   agents_list_new_gd$max_duration[agent] <- ifelse(length(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent])==0,NA,max(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent], na.rm = TRUE))
#   #Times Contaminated
#   #Count number of events for that agent
#   agents_list_new_gd$contamination_events[agent] <- sum(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent]>0)
#   #Times Persistent
#   #Count number of events for that agent that exceed time to persistence
#   agents_list_new_gd$times_persistent[agent] <- sum(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent]>agents_list_new_gd$time_to_persistence[agent])
#   #Lower Duration Quartile
#   agents_list_new_gd$q1_duration[agent] <- quantile(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent])[2]
#   #Upper Duration Quartile
#   agents_list_new_gd$q3_duration[agent] <- quantile(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent])[4]
#   #Persistent Durations####
#   #Minimum Persistent Contamination Duration
#   agents_list_new_gd$min_persistent_duration[agent] <- ifelse((length(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent])==0) || (agents_list_new_gd$times_persistent[agent]==0),NA,min(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent & Facility_B_durations_new_gd$duration>=agents_list_new_gd$time_to_persistence[agent]], na.rm = TRUE))
#   #Mean Persistent Contamination Duration
#   agents_list_new_gd$mean_persistent_duration[agent] <- ifelse((length(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent])==0) || (agents_list_new_gd$times_persistent[agent]==0),NA,mean(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent & Facility_B_durations_new_gd$duration>=agents_list_new_gd$time_to_persistence[agent]], na.rm = TRUE))
#   #Median Persistent Contamination Duration
#   agents_list_new_gd$median_persistent_duration[agent] <- ifelse((length(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent])==0) || (agents_list_new_gd$times_persistent[agent]==0),NA,median(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent & Facility_B_durations_new_gd$duration>=agents_list_new_gd$time_to_persistence[agent]], na.rm = TRUE))
#   #Max Persistent Contamination Duration
#   agents_list_new_gd$max_persistent_duration[agent] <- ifelse((length(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent])==0) || (agents_list_new_gd$times_persistent[agent]==0),NA,max(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent & Facility_B_durations_new_gd$duration>=agents_list_new_gd$time_to_persistence[agent]], na.rm = TRUE))
#   #Lower Duration Quartile Persistent Contamination Duration
#   agents_list_new_gd$q1_persistent_duration[agent] <- ifelse((length(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent])==0) || (agents_list_new_gd$times_persistent[agent]==0),NA,quantile(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent & Facility_B_durations_new_gd$duration>=agents_list_new_gd$time_to_persistence[agent]])[2])
#   #Upper Duration Quartile Persistent Contamination Duration
#   agents_list_new_gd$q3_persistent_duration[agent] <- ifelse((length(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent])==0) || (agents_list_new_gd$times_persistent[agent]==0),NA,quantile(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent & Facility_B_durations_new_gd$duration>=agents_list_new_gd$time_to_persistence[agent]])[4])
#   #Average number of times an agent was persistently contaminated across iterations
#   x <- Facility_B_durations_new_gd[which(Facility_B_durations_new_gd$agent==agent & Facility_B_durations_new_gd$duration>agents_list_new_gd$time_to_persistence[agent]),]
#   ##Count number of times in each iteration persistence occurred for the agent and take the mean
#   agents_list_new_gd$mean_times_persistent[agent] <- mean(plyr::count(x, 'iteration')$freq)
#   agents_list_new_gd$mean_times_persistent[which(is.na(agents_list_new_gd$mean_times_persistent))] <- 0
#   #Division by total number of iterations in simulation
#   agents_list_new_gd$balanced_times_persistent[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
#   if((length(Facility_B_durations_new_gd$duration[Facility_B_durations_new_gd$agent==agent])!=0) || (agents_list_new_gd$times_persistent[agent]!=0)) {
#     #Persistent
#     if(agents_list_new_gd$time_to_persistence[agent]==48) {
#       #Short
#       persistent_short_durations_list_new_gd <- rbind(
#         persistent_short_durations_list_new_gd,
#         Facility_B_durations_new_gd[Facility_B_durations_new_gd$agent==agent & Facility_B_durations_new_gd$duration>agents_list_new_gd$time_to_persistence[agent],]
#       )
#     } else if(agents_list_new_gd$time_to_persistence[agent]==336 && agents_list_new_gd$sanitation_status[agent]==1) {
#       #Long
#       persistent_long_durations_list_new_gd <- rbind(
#         persistent_long_durations_list_new_gd,
#         Facility_B_durations_new_gd[Facility_B_durations_new_gd$agent==agent & Facility_B_durations_new_gd$duration>agents_list_new_gd$time_to_persistence[agent],]
#       )
#     } else if(agents_list_new_gd$time_to_persistence[agent]==336 && agents_list_new_gd$sanitation_status[agent]==0) {
#       #Uncleanable
#       persistent_uncleanable_durations_list_new_gd <- rbind(
#         persistent_uncleanable_durations_list_new_gd,
#         Facility_B_durations_new_gd[Facility_B_durations_new_gd$agent==agent & Facility_B_durations_new_gd$duration>agents_list_new_gd$time_to_persistence[agent],]
#       )	
#     }
#   }
#   #Transient
#   if(agents_list_new_gd$time_to_persistence[agent]==48) {
#     #Short
#     transient_short_durations_list_new_gd <- rbind(
#       transient_short_durations_list_new_gd,
#       Facility_B_durations_new_gd[Facility_B_durations_new_gd$agent==agent & Facility_B_durations_new_gd$duration<=agents_list_new_gd$time_to_persistence[agent],]
#     )
#   } else if(agents_list_new_gd$time_to_persistence[agent]==336 && agents_list_new_gd$sanitation_status[agent]==1) {
#     #Long
#     transient_long_durations_list_new_gd <- rbind(
#       transient_long_durations_list_new_gd,
#       Facility_B_durations_new_gd[Facility_B_durations_new_gd$agent==agent & Facility_B_durations_new_gd$duration<=agents_list_new_gd$time_to_persistence[agent],]
#     )
#   } else if(agents_list_new_gd$time_to_persistence[agent]==336 && agents_list_new_gd$sanitation_status[agent]==0) {
#     #Uncleanable
#     transient_uncleanable_durations_list_new_gd <- rbind(
#       transient_uncleanable_durations_list_new_gd,
#       Facility_B_durations_new_gd[Facility_B_durations_new_gd$agent==agent & Facility_B_durations_new_gd$duration<=agents_list_new_gd$time_to_persistence[agent],]
#     )	
#   }
#   agent <- agent+1
# }
# 
# #10 cells minimum####
# agent <- 1
# while(agent<=225) {
#   iteration <- 1
#   while(iteration<=100) {
#     if(any(rle_matrix[agent,iteration][[1]]$values>9)) {
#       df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
#       colnames(df) <- c('duration', 'agent', 'iteration')
#       durations <- rbind(durations, df)
#     }
#     iteration <- iteration + 1
#   }
#   agent <- agent+1
# }
# 
# Facility_B_durations_new_gd_10min <- durations
# 
# persistent_short_durations_list_new_gd_10min <- data.frame()
# persistent_long_durations_list_new_gd_10min <- data.frame()
# persistent_uncleanable_durations_list_new_gd_10min <- data.frame()
# transient_short_durations_list_new_gd_10min <- data.frame()
# transient_long_durations_list_new_gd_10min <- data.frame()
# transient_uncleanable_durations_list_new_gd_10min <- data.frame()
# agent <- 1
# while(agent<=225) {
#   ##All Durations####
#   #Minimum Contamination Duration
#   agents_list_new_gd$min_duration_10min[agent] <- ifelse(length(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent])==0,NA,min(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent], na.rm = TRUE))
#   #Mean Contamination Duration
#   agents_list_new_gd$mean_duration_10min[agent] <- ifelse(length(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent])==0,NA,mean(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent], na.rm = TRUE))
#   #Median Contamination Duration
#   agents_list_new_gd$median_duration_10min[agent] <- ifelse(length(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent])==0,NA,median(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent], na.rm = TRUE))
#   #Maximum Contamination Duration
#   agents_list_new_gd$max_duration_10min[agent] <- ifelse(length(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent])==0,NA,max(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent], na.rm = TRUE))
#   #Times Contaminated
#   #Count number of events for that agent
#   agents_list_new_gd$contamination_events_10min[agent] <- sum(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent]>0)
#   #Times Persistent
#   #Count number of events for that agent that exceed time to persistence
#   agents_list_new_gd$times_persistent_10min[agent] <- sum(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent]>agents_list_new_gd$time_to_persistence[agent])
#   #Lower Duration Quartile
#   agents_list_new_gd$q1_duration_10min[agent] <- quantile(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent])[2]
#   #Upper Duration Quartile
#   agents_list_new_gd$q3_duration_10min[agent] <- quantile(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent])[4]
#   #Persistent Durations####
#   #Minimum Persistent Contamination Duration
#   agents_list_new_gd$min_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent])==0) || (agents_list_new_gd$times_persistent_10min[agent]==0),NA,min(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent & Facility_B_durations_new_gd_10min$duration>=agents_list_new_gd$time_to_persistence[agent]], na.rm = TRUE))
#   #Mean Persistent Contamination Duration
#   agents_list_new_gd$mean_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent])==0) || (agents_list_new_gd$times_persistent_10min[agent]==0),NA,mean(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent & Facility_B_durations_new_gd_10min$duration>=agents_list_new_gd$time_to_persistence[agent]], na.rm = TRUE))
#   #Median Persistent Contamination Duration
#   agents_list_new_gd$median_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent])==0) || (agents_list_new_gd$times_persistent_10min[agent]==0),NA,median(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent & Facility_B_durations_new_gd_10min$duration>=agents_list_new_gd$time_to_persistence[agent]], na.rm = TRUE))
#   #Max Persistent Contamination Duration
#   agents_list_new_gd$max_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent])==0) || (agents_list_new_gd$times_persistent_10min[agent]==0),NA,max(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent & Facility_B_durations_new_gd_10min$duration>=agents_list_new_gd$time_to_persistence[agent]], na.rm = TRUE))
#   #Lower Duration Quartile Persistent Contamination Duration
#   agents_list_new_gd$q1_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent])==0) || (agents_list_new_gd$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent & Facility_B_durations_new_gd_10min$duration>=agents_list_new_gd$time_to_persistence[agent]])[2])
#   #Upper Duration Quartile Persistent Contamination Duration
#   agents_list_new_gd$q3_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent])==0) || (agents_list_new_gd$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent & Facility_B_durations_new_gd_10min$duration>=agents_list_new_gd$time_to_persistence[agent]])[4])
#   #Average number of times an agent was persistently contaminated across iterations (Does not account for iterations with 0 events)
#   x <- Facility_B_durations_new_gd_10min[which(Facility_B_durations_new_gd_10min$agent==agent & Facility_B_durations_new_gd_10min$duration>agents_list_new_gd$time_to_persistence[agent]),]
#   ##Count number of times in each iteration persistence occurred for the agent and take the mean (Does account for iterations with 0 events)
#   agents_list_new_gd$mean_times_persistent_10min[agent] <- mean(plyr::count(x, 'iteration')$freq)
#   agents_list_new_gd$mean_times_persistent_10min[which(is.na(agents_list_new_gd$mean_times_persistent_10min))] <- 0
#   #Division by total number of iterations in simulation
#   agents_list_new_gd$balanced_times_persistent_10min[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
#   if((length(Facility_B_durations_new_gd_10min$duration[Facility_B_durations_new_gd_10min$agent==agent])!=0) || (agents_list_new_gd$times_persistent[agent]!=0)) {
#     #Persistent
#     if(agents_list_new_gd$time_to_persistence[agent]==48) {
#       #Short
#       persistent_short_durations_list_new_gd_10min <- rbind(
#         persistent_short_durations_list_new_gd_10min,
#         Facility_B_durations_new_gd_10min[Facility_B_durations_new_gd_10min$agent==agent & Facility_B_durations_new_gd_10min$duration>agents_list_new_gd$time_to_persistence[agent],]
#       )
#     } else if(agents_list_new_gd$time_to_persistence[agent]==336 && agents_list_new_gd$sanitation_status[agent]==1) {
#       #Long
#       persistent_long_durations_list_new_gd_10min <- rbind(
#         persistent_long_durations_list_new_gd_10min,
#         Facility_B_durations_new_gd_10min[Facility_B_durations_new_gd_10min$agent==agent & Facility_B_durations_new_gd_10min$duration>agents_list_new_gd$time_to_persistence[agent],]
#       )
#     } else if(agents_list_new_gd$time_to_persistence[agent]==336 && agents_list_new_gd$sanitation_status[agent]==0) {
#       #Uncleanable
#       persistent_uncleanable_durations_list_new_gd_10min <- rbind(
#         persistent_uncleanable_durations_list_new_gd_10min,
#         Facility_B_durations_new_gd_10min[Facility_B_durations_new_gd_10min$agent==agent & Facility_B_durations_new_gd_10min$duration>agents_list_new_gd$time_to_persistence[agent],]
#       )	
#     }
#   }
#   #Transient
#   if(agents_list_new_gd$time_to_persistence[agent]==48) {
#     #Short
#     transient_short_durations_list_new_gd_10min <- rbind(
#       transient_short_durations_list_new_gd_10min,
#       Facility_B_durations_new_gd_10min[Facility_B_durations_new_gd_10min$agent==agent & Facility_B_durations_new_gd_10min$duration<=agents_list_new_gd$time_to_persistence[agent],]
#     )
#   } else if(agents_list_new_gd$time_to_persistence[agent]==336 && agents_list_new_gd$sanitation_status[agent]==1) {
#     #Long
#     transient_long_durations_list_new_gd_10min <- rbind(
#       transient_long_durations_list_new_gd_10min,
#       Facility_B_durations_new_gd_10min[Facility_B_durations_new_gd_10min$agent==agent & Facility_B_durations_new_gd_10min$duration<=agents_list_new_gd$time_to_persistence[agent],]
#     )
#   } else if(agents_list_new_gd$time_to_persistence[agent]==336 && agents_list_new_gd$sanitation_status[agent]==0) {
#     #Uncleanable
#     transient_uncleanable_durations_list_new_gd_10min <- rbind(
#       transient_uncleanable_durations_list_new_gd_10min,
#       Facility_B_durations_new_gd_10min[Facility_B_durations_new_gd_10min$agent==agent & Facility_B_durations_new_gd_10min$duration<=agents_list_new_gd$time_to_persistence[agent],]
#     )	
#   }
#   agent <- agent+1
# }

# Facility_B_new_gd_agents_melted_monday_preop <- Facility_B_new_gd_agents_melted[which(Facility_B_new_gd_agents_melted$tick==33|Facility_B_new_gd_agents_melted$tick==201|Facility_B_new_gd_agents_melted$tick==369|Facility_B_new_gd_agents_melted$tick==537|Facility_B_new_gd_agents_melted$tick==705|Facility_B_new_gd_agents_melted$tick==873|Facility_B_new_gd_agents_melted$tick==1041|Facility_B_new_gd_agents_melted$tick==1209),]
# 
# Facility_B_new_gd_agents_melted_tuesday_preop <- Facility_B_new_gd_agents_melted[which(Facility_B_new_gd_agents_melted$tick==57|Facility_B_new_gd_agents_melted$tick==225|Facility_B_new_gd_agents_melted$tick==393|Facility_B_new_gd_agents_melted$tick==561|Facility_B_new_gd_agents_melted$tick==729|Facility_B_new_gd_agents_melted$tick==897|Facility_B_new_gd_agents_melted$tick==1065|Facility_B_new_gd_agents_melted$tick==1233),]
# 
# Facility_B_new_gd_agents_melted_wednesday_preop <- Facility_B_new_gd_agents_melted[which(Facility_B_new_gd_agents_melted$tick==81|Facility_B_new_gd_agents_melted$tick==249|Facility_B_new_gd_agents_melted$tick==417|Facility_B_new_gd_agents_melted$tick==585|Facility_B_new_gd_agents_melted$tick==753|Facility_B_new_gd_agents_melted$tick==921|Facility_B_new_gd_agents_melted$tick==1089|Facility_B_new_gd_agents_melted$tick==1257),]
# 
# Facility_B_new_gd_agents_melted_thursday_preop <- Facility_B_new_gd_agents_melted[which(Facility_B_new_gd_agents_melted$tick==105|Facility_B_new_gd_agents_melted$tick==273|Facility_B_new_gd_agents_melted$tick==441|Facility_B_new_gd_agents_melted$tick==609|Facility_B_new_gd_agents_melted$tick==777|Facility_B_new_gd_agents_melted$tick==945|Facility_B_new_gd_agents_melted$tick==1113|Facility_B_new_gd_agents_melted$tick==1281),]
# 
# Facility_B_new_gd_agents_melted_friday_preop <- Facility_B_new_gd_agents_melted[which(Facility_B_new_gd_agents_melted$tick==129|Facility_B_new_gd_agents_melted$tick==297|Facility_B_new_gd_agents_melted$tick==465|Facility_B_new_gd_agents_melted$tick==633|Facility_B_new_gd_agents_melted$tick==801|Facility_B_new_gd_agents_melted$tick==969|Facility_B_new_gd_agents_melted$tick==1137|Facility_B_new_gd_agents_melted$tick==1305),]

# Facility_B_new_gd_agents_melted_ff <- as.ffdf(Facility_B_new_gd_agents_melted)
# rm(Facility_B_new_gd_agents_melted)
gc()
```

```{r import SA Check}
NL_table_sa_check <- fread(paste0(getwd(),'/Data/BehaviorSpace/2022-02-24-03-19 ENABLE-Facility_B-50cm_05-Persistence 1000_Runs_8_Weeks_Baseline_No_Hourly_Data-table.csv'), skip = 6, sep = ",", header = TRUE)
NL_table_sa_check <- NL_table_sa_check[NL_table_sa_check$scenario==0,]

while (any(grepl('-', names(NL_table_sa_check), fixed = TRUE))) {
  NL_table_sa_check <- NL_table_sa_check %>% dplyr::rename_all(list(~stringr::str_replace(., "-", "_")))
}
while (any(grepl(' ', names(NL_table_sa_check), fixed = TRUE))) {
  NL_table_sa_check <- NL_table_sa_check %>% dplyr::rename_all(list(~stringr::str_replace(., " ", "_")))
}
while (any(grepl('[', names(NL_table_sa_check), fixed = TRUE))) {
  NL_table_sa_check <- NL_table_sa_check %>% dplyr::rename_all(list(~stringr::str_replace(., "\\[", "")))
}
while (any(grepl(']', names(NL_table_sa_check), fixed = TRUE))) {
  NL_table_sa_check <- NL_table_sa_check %>% dplyr::rename_all(list(~stringr::str_replace(., "\\]", "")))
}

list_columns <- c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list')

list_outputs <- NL_table_sa_check[ , ..list_columns]

NL_table_sa_check[, c('z1_conc_time_list','z1_conc_time_cleanable_list','z1_conc_time_uncleanable_list','z2_conc_time_list','z2_conc_time_cleanable_list','z2_conc_time_uncleanable_list','z3_conc_time_list','z3_conc_time_cleanable_list','z3_conc_time_uncleanable_list','cleaning_conc_time_list','drying_conc_time_list','loading_conc_time_list','reject_conc_time_list','sorting_conc_time_list','other_conc_time_list','cleaning_conc_time_cleanable_list','drying_conc_time_cleanable_list','loading_conc_time_cleanable_list','reject_conc_time_cleanable_list','sorting_conc_time_cleanable_list','other_conc_time_cleanable_list','cleaning_conc_time_uncleanable_list','drying_conc_time_uncleanable_list','loading_conc_time_uncleanable_list','reject_conc_time_uncleanable_list','sorting_conc_time_uncleanable_list','other_conc_time_uncleanable_list','cluster_conc_mid_mon_list','cluster_conc_mid_tue_list','cluster_conc_mid_wed_list','cluster_conc_mid_thu_list','cluster_conc_mid_fri_list','cluster_conc_mid_mon_median_list','cluster_conc_mid_tue_median_list','cluster_conc_mid_wed_median_list','cluster_conc_mid_thu_median_list','cluster_conc_mid_fri_median_list','cluster_conc_mid_mon_mean_list','cluster_conc_mid_tue_mean_list','cluster_conc_mid_wed_mean_list','cluster_conc_mid_thu_mean_list','cluster_conc_mid_fri_mean_list'):=NULL]

NL_table_sa_check <- as.data.frame(NL_table_sa_check)

NL_table_sa_check[NL_table_sa_check==-1] <- NA

NL_table_sa_check <- subset(NL_table_sa_check, select = -c(t_crate_prevalence, w_crate_prevalence, r_crate_prevalence, f_crate_prevalence, t_san_reduction, w_san_reduction, r_san_reduction, f_san_reduction))
names(NL_table_sa_check)[names(NL_table_sa_check)=='m_crate_prevalence'] <- 'crate_prevalence'
names(NL_table_sa_check)[names(NL_table_sa_check)=='m_san_reduction'] <- 'san_reduction'

header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

####W1Wed####
vector <- NL_table_sa_check$w1wed_conc_list
vector <- vector[vector!='[]']
sa_check_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
    sa_check_w1wed_conc_list <- append(sa_check_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
    i <- i+1
}
sa_check_w1wed_conc_matrix <- matrix(unlist(sa_check_w1wed_conc_list), ncol = 225, byrow = TRUE)

vector <- NL_table_sa_check$loading_w1wed_conc_list
vector <- vector[vector!='[]']
sa_check_loading_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_loading_w1wed_conc_list <- append(sa_check_loading_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_loading_w1wed_conc_matrix <- matrix(unlist(sa_check_loading_w1wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_sa_check$cleaning_w1wed_conc_list
vector <- vector[vector!='[]']
sa_check_cleaning_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_cleaning_w1wed_conc_list <- append(sa_check_cleaning_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_cleaning_w1wed_conc_matrix <- matrix(unlist(sa_check_cleaning_w1wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_sa_check$drying_w1wed_conc_list
# vector <- vector[vector!='[]']
# sa_check_drying_w1wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   sa_check_drying_w1wed_conc_list <- append(sa_check_drying_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_sa_check$sorting_w1wed_conc_list
vector <- vector[vector!='[]']
sa_check_sorting_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_sorting_w1wed_conc_list <- append(sa_check_sorting_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_sorting_w1wed_conc_matrix <- matrix(unlist(sa_check_sorting_w1wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_sa_check$tray_packing_w1wed_conc_list
vector <- vector[vector!='[]']
sa_check_tray_packing_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_tray_packing_w1wed_conc_list <- append(sa_check_tray_packing_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_tray_packing_w1wed_conc_matrix <- matrix(unlist(sa_check_tray_packing_w1wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_sa_check$reject_w1wed_conc_list
vector <- vector[vector!='[]']
sa_check_reject_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_reject_w1wed_conc_list <- append(sa_check_reject_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_reject_w1wed_conc_matrix <- matrix(unlist(sa_check_reject_w1wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_sa_check$other_w1wed_conc_list
vector <- vector[vector!='[]']
sa_check_other_w1wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_other_w1wed_conc_list <- append(sa_check_other_w1wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_other_w1wed_conc_matrix <- matrix(unlist(sa_check_other_w1wed_conc_list), ncol = 10, byrow = TRUE)

sa_check_loading_concs <- as.data.frame(sa_check_loading_w1wed_conc_list)
sa_check_loading_concs$area <- as.factor('loading')
sa_check_loading_concs$scenario <- as.factor('SA Check')
sa_check_loading_concs$water <- as.factor('Wet')
names(sa_check_loading_concs) <- c('concentration','area','scenario','water')

sa_check_cleaning_concs <- as.data.frame(sa_check_cleaning_w1wed_conc_list)
sa_check_cleaning_concs$area <- as.factor('cleaning')
sa_check_cleaning_concs$scenario <- as.factor('SA Check')
sa_check_cleaning_concs$water <- as.factor('Wet')
names(sa_check_cleaning_concs) <- c('concentration','area','scenario','water')

sa_check_sorting_concs <- as.data.frame(sa_check_sorting_w1wed_conc_list)
sa_check_sorting_concs$area <- as.factor('sorting')
sa_check_sorting_concs$scenario <- as.factor('SA Check')
sa_check_sorting_concs$water <- as.factor('Dry')
names(sa_check_sorting_concs) <- c('concentration','area','scenario','water')

sa_check_reject_concs <- as.data.frame(sa_check_reject_w1wed_conc_list)
sa_check_reject_concs$area <- as.factor('reject')
sa_check_reject_concs$scenario <- as.factor('SA Check')
sa_check_reject_concs$water <- as.factor('Dry')
names(sa_check_reject_concs) <- c('concentration','area','scenario','water')

sa_check_tray_packing_concs <- as.data.frame(sa_check_tray_packing_w1wed_conc_list)
sa_check_tray_packing_concs$area <- as.factor('tray packing')
sa_check_tray_packing_concs$scenario <- as.factor('SA Check')
sa_check_tray_packing_concs$water <- as.factor('Dry')
names(sa_check_tray_packing_concs) <- c('concentration','area','scenario','water')

sa_check_other_concs <- as.data.frame(sa_check_other_w1wed_conc_list)
sa_check_other_concs$area <- as.factor('other')
sa_check_other_concs$scenario <- as.factor('SA Check')
sa_check_other_concs$water <- as.factor('Dry')
names(sa_check_other_concs) <- c('concentration','area','scenario','water')

sa_check_w1wed_concs <- rbind(sa_check_loading_concs,sa_check_cleaning_concs,sa_check_sorting_concs,sa_check_tray_packing_concs,sa_check_reject_concs,sa_check_other_concs)

sa_check_loading_prev <- as.data.frame(NL_table_sa_check$loading_w1wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_loading_prev$area <- as.factor('loading')
sa_check_loading_prev$scenario <- as.factor('SA Check')
sa_check_loading_prev$water <- as.factor('Wet')
names(sa_check_loading_prev) <- c('prevalence','area','scenario','water')

sa_check_cleaning_prev <- as.data.frame(NL_table_sa_check$cleaning_w1wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_cleaning_prev$area <- as.factor('cleaning')
sa_check_cleaning_prev$scenario <- as.factor('SA Check')
sa_check_cleaning_prev$water <- as.factor('Wet')
names(sa_check_cleaning_prev) <- c('prevalence','area','scenario','water')

sa_check_sorting_prev <- as.data.frame(NL_table_sa_check$sorting_w1wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_sorting_prev$area <- as.factor('sorting')
sa_check_sorting_prev$scenario <- as.factor('SA Check')
sa_check_sorting_prev$water <- as.factor('Dry')
names(sa_check_sorting_prev) <- c('prevalence','area','scenario','water')

sa_check_reject_prev <- as.data.frame(NL_table_sa_check$reject_w1wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_reject_prev$area <- as.factor('reject')
sa_check_reject_prev$scenario <- as.factor('SA Check')
sa_check_reject_prev$water <- as.factor('Dry')
names(sa_check_reject_prev) <- c('prevalence','area','scenario','water')

sa_check_tray_packing_prev <- as.data.frame(NL_table_sa_check$tray_packing_w1wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_tray_packing_prev$area <- as.factor('tray packing')
sa_check_tray_packing_prev$scenario <- as.factor('SA Check')
sa_check_tray_packing_prev$water <- as.factor('Dry')
names(sa_check_tray_packing_prev) <- c('prevalence','area','scenario','water')

sa_check_other_prev <- as.data.frame(NL_table_sa_check$other_w1wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_other_prev$area <- as.factor('other')
sa_check_other_prev$scenario <- as.factor('SA Check')
sa_check_other_prev$water <- as.factor('Dry')
names(sa_check_other_prev) <- c('prevalence','area','scenario','water')

sa_check_w1wed_prev <- rbind(sa_check_loading_prev,sa_check_cleaning_prev,sa_check_sorting_prev,sa_check_tray_packing_prev,sa_check_reject_prev,sa_check_other_prev)

sa_check_w1wed_wet_prev <- as.data.frame(sa_check_loading_prev$prevalence*21/100+sa_check_cleaning_prev$prevalence*28/100)/49*100
sa_check_w1wed_wet_prev$scenario <- as.factor('SA Check')
sa_check_w1wed_wet_prev$water <- as.factor('Wet')
names(sa_check_w1wed_wet_prev) <- c('prevalence','scenario','water')

sa_check_w1wed_dry_prev <- as.data.frame(sa_check_sorting_prev$prevalence*20/100+sa_check_reject_prev$prevalence*23/100+sa_check_tray_packing_prev$prevalence*123/100+sa_check_other_prev$prevalence*10/100)/176*100
sa_check_w1wed_dry_prev$scenario <- as.factor('SA Check')
sa_check_w1wed_dry_prev$water <- as.factor('Dry')
names(sa_check_w1wed_dry_prev) <- c('prevalence','scenario','water')

sa_check_w1wed_recombined_prev <- rbind(sa_check_w1wed_wet_prev, sa_check_w1wed_dry_prev)

####W2Wed####
vector <- NL_table_sa_check$w2wed_conc_list
vector <- vector[vector!='[]']
sa_check_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
    sa_check_w2wed_conc_list <- append(sa_check_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
    i <- i+1
}
sa_check_w2wed_conc_matrix <- matrix(unlist(sa_check_w2wed_conc_list), ncol = 225, byrow = TRUE)

vector <- NL_table_sa_check$loading_w2wed_conc_list
vector <- vector[vector!='[]']
sa_check_loading_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_loading_w2wed_conc_list <- append(sa_check_loading_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_loading_w2wed_conc_matrix <- matrix(unlist(sa_check_loading_w2wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_sa_check$cleaning_w2wed_conc_list
vector <- vector[vector!='[]']
sa_check_cleaning_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_cleaning_w2wed_conc_list <- append(sa_check_cleaning_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_cleaning_w2wed_conc_matrix <- matrix(unlist(sa_check_cleaning_w2wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_sa_check$drying_w2wed_conc_list
# vector <- vector[vector!='[]']
# sa_check_drying_w2wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   sa_check_drying_w2wed_conc_list <- append(sa_check_drying_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_sa_check$sorting_w2wed_conc_list
vector <- vector[vector!='[]']
sa_check_sorting_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_sorting_w2wed_conc_list <- append(sa_check_sorting_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_sorting_w2wed_conc_matrix <- matrix(unlist(sa_check_sorting_w2wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_sa_check$tray_packing_w2wed_conc_list
vector <- vector[vector!='[]']
sa_check_tray_packing_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_tray_packing_w2wed_conc_list <- append(sa_check_tray_packing_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_tray_packing_w2wed_conc_matrix <- matrix(unlist(sa_check_tray_packing_w2wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_sa_check$reject_w2wed_conc_list
vector <- vector[vector!='[]']
sa_check_reject_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_reject_w2wed_conc_list <- append(sa_check_reject_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_reject_w2wed_conc_matrix <- matrix(unlist(sa_check_reject_w2wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_sa_check$other_w2wed_conc_list
vector <- vector[vector!='[]']
sa_check_other_w2wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_other_w2wed_conc_list <- append(sa_check_other_w2wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_other_w2wed_conc_matrix <- matrix(unlist(sa_check_other_w2wed_conc_list), ncol = 10, byrow = TRUE)

sa_check_loading_concs <- as.data.frame(sa_check_loading_w2wed_conc_list)
sa_check_loading_concs$area <- as.factor('loading')
sa_check_loading_concs$scenario <- as.factor('SA Check')
sa_check_loading_concs$water <- as.factor('Wet')
names(sa_check_loading_concs) <- c('concentration','area','scenario','water')

sa_check_cleaning_concs <- as.data.frame(sa_check_cleaning_w2wed_conc_list)
sa_check_cleaning_concs$area <- as.factor('cleaning')
sa_check_cleaning_concs$scenario <- as.factor('SA Check')
sa_check_cleaning_concs$water <- as.factor('Wet')
names(sa_check_cleaning_concs) <- c('concentration','area','scenario','water')

sa_check_sorting_concs <- as.data.frame(sa_check_sorting_w2wed_conc_list)
sa_check_sorting_concs$area <- as.factor('sorting')
sa_check_sorting_concs$scenario <- as.factor('SA Check')
sa_check_sorting_concs$water <- as.factor('Dry')
names(sa_check_sorting_concs) <- c('concentration','area','scenario','water')

sa_check_reject_concs <- as.data.frame(sa_check_reject_w2wed_conc_list)
sa_check_reject_concs$area <- as.factor('reject')
sa_check_reject_concs$scenario <- as.factor('SA Check')
sa_check_reject_concs$water <- as.factor('Dry')
names(sa_check_reject_concs) <- c('concentration','area','scenario','water')

sa_check_tray_packing_concs <- as.data.frame(sa_check_tray_packing_w2wed_conc_list)
sa_check_tray_packing_concs$area <- as.factor('tray packing')
sa_check_tray_packing_concs$scenario <- as.factor('SA Check')
sa_check_tray_packing_concs$water <- as.factor('Dry')
names(sa_check_tray_packing_concs) <- c('concentration','area','scenario','water')

sa_check_other_concs <- as.data.frame(sa_check_other_w2wed_conc_list)
sa_check_other_concs$area <- as.factor('other')
sa_check_other_concs$scenario <- as.factor('SA Check')
sa_check_other_concs$water <- as.factor('Dry')
names(sa_check_other_concs) <- c('concentration','area','scenario','water')

sa_check_w2wed_concs <- rbind(sa_check_loading_concs,sa_check_cleaning_concs,sa_check_sorting_concs,sa_check_tray_packing_concs,sa_check_reject_concs,sa_check_other_concs)

sa_check_loading_prev <- as.data.frame(NL_table_sa_check$loading_w2wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_loading_prev$area <- as.factor('loading')
sa_check_loading_prev$scenario <- as.factor('SA Check')
sa_check_loading_prev$water <- as.factor('Wet')
names(sa_check_loading_prev) <- c('prevalence','area','scenario','water')

sa_check_cleaning_prev <- as.data.frame(NL_table_sa_check$cleaning_w2wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_cleaning_prev$area <- as.factor('cleaning')
sa_check_cleaning_prev$scenario <- as.factor('SA Check')
sa_check_cleaning_prev$water <- as.factor('Wet')
names(sa_check_cleaning_prev) <- c('prevalence','area','scenario','water')

sa_check_sorting_prev <- as.data.frame(NL_table_sa_check$sorting_w2wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_sorting_prev$area <- as.factor('sorting')
sa_check_sorting_prev$scenario <- as.factor('SA Check')
sa_check_sorting_prev$water <- as.factor('Dry')
names(sa_check_sorting_prev) <- c('prevalence','area','scenario','water')

sa_check_reject_prev <- as.data.frame(NL_table_sa_check$reject_w2wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_reject_prev$area <- as.factor('reject')
sa_check_reject_prev$scenario <- as.factor('SA Check')
sa_check_reject_prev$water <- as.factor('Dry')
names(sa_check_reject_prev) <- c('prevalence','area','scenario','water')

sa_check_tray_packing_prev <- as.data.frame(NL_table_sa_check$tray_packing_w2wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_tray_packing_prev$area <- as.factor('tray packing')
sa_check_tray_packing_prev$scenario <- as.factor('SA Check')
sa_check_tray_packing_prev$water <- as.factor('Dry')
names(sa_check_tray_packing_prev) <- c('prevalence','area','scenario','water')

sa_check_other_prev <- as.data.frame(NL_table_sa_check$other_w2wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_other_prev$area <- as.factor('other')
sa_check_other_prev$scenario <- as.factor('SA Check')
sa_check_other_prev$water <- as.factor('Dry')
names(sa_check_other_prev) <- c('prevalence','area','scenario','water')

sa_check_w2wed_prev <- rbind(sa_check_loading_prev,sa_check_cleaning_prev,sa_check_sorting_prev,sa_check_tray_packing_prev,sa_check_reject_prev,sa_check_other_prev)

sa_check_w2wed_wet_prev <- as.data.frame(sa_check_loading_prev$prevalence*21/100+sa_check_cleaning_prev$prevalence*28/100)/49*100
sa_check_w2wed_wet_prev$scenario <- as.factor('SA Check')
sa_check_w2wed_wet_prev$water <- as.factor('Wet')
names(sa_check_w2wed_wet_prev) <- c('prevalence','scenario','water')

sa_check_w2wed_dry_prev <- as.data.frame(sa_check_sorting_prev$prevalence*20/100+sa_check_reject_prev$prevalence*23/100+sa_check_tray_packing_prev$prevalence*123/100+sa_check_other_prev$prevalence*10/100)/176*100
sa_check_w2wed_dry_prev$scenario <- as.factor('SA Check')
sa_check_w2wed_dry_prev$water <- as.factor('Dry')
names(sa_check_w2wed_dry_prev) <- c('prevalence','scenario','water')

sa_check_w2wed_recombined_prev <- rbind(sa_check_w2wed_wet_prev, sa_check_w2wed_dry_prev)

####W3Wed####
vector <- NL_table_sa_check$w3wed_conc_list
vector <- vector[vector!='[]']
sa_check_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
    sa_check_w3wed_conc_list <- append(sa_check_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
    i <- i+1
}
sa_check_w3wed_conc_matrix <- matrix(unlist(sa_check_w3wed_conc_list), ncol = 225, byrow = TRUE)

vector <- NL_table_sa_check$loading_w3wed_conc_list
vector <- vector[vector!='[]']
sa_check_loading_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_loading_w3wed_conc_list <- append(sa_check_loading_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_loading_w3wed_conc_matrix <- matrix(unlist(sa_check_loading_w3wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_sa_check$cleaning_w3wed_conc_list
vector <- vector[vector!='[]']
sa_check_cleaning_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_cleaning_w3wed_conc_list <- append(sa_check_cleaning_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_cleaning_w3wed_conc_matrix <- matrix(unlist(sa_check_cleaning_w3wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_sa_check$drying_w3wed_conc_list
# vector <- vector[vector!='[]']
# sa_check_drying_w3wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   sa_check_drying_w3wed_conc_list <- append(sa_check_drying_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_sa_check$sorting_w3wed_conc_list
vector <- vector[vector!='[]']
sa_check_sorting_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_sorting_w3wed_conc_list <- append(sa_check_sorting_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_sorting_w3wed_conc_matrix <- matrix(unlist(sa_check_sorting_w3wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_sa_check$tray_packing_w3wed_conc_list
vector <- vector[vector!='[]']
sa_check_tray_packing_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_tray_packing_w3wed_conc_list <- append(sa_check_tray_packing_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_tray_packing_w3wed_conc_matrix <- matrix(unlist(sa_check_tray_packing_w3wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_sa_check$reject_w3wed_conc_list
vector <- vector[vector!='[]']
sa_check_reject_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_reject_w3wed_conc_list <- append(sa_check_reject_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_reject_w3wed_conc_matrix <- matrix(unlist(sa_check_reject_w3wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_sa_check$other_w3wed_conc_list
vector <- vector[vector!='[]']
sa_check_other_w3wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_other_w3wed_conc_list <- append(sa_check_other_w3wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_other_w3wed_conc_matrix <- matrix(unlist(sa_check_other_w3wed_conc_list), ncol = 10, byrow = TRUE)

sa_check_loading_concs <- as.data.frame(sa_check_loading_w3wed_conc_list)
sa_check_loading_concs$area <- as.factor('loading')
sa_check_loading_concs$scenario <- as.factor('SA Check')
sa_check_loading_concs$water <- as.factor('Wet')
names(sa_check_loading_concs) <- c('concentration','area','scenario','water')

sa_check_cleaning_concs <- as.data.frame(sa_check_cleaning_w3wed_conc_list)
sa_check_cleaning_concs$area <- as.factor('cleaning')
sa_check_cleaning_concs$scenario <- as.factor('SA Check')
sa_check_cleaning_concs$water <- as.factor('Wet')
names(sa_check_cleaning_concs) <- c('concentration','area','scenario','water')

sa_check_sorting_concs <- as.data.frame(sa_check_sorting_w3wed_conc_list)
sa_check_sorting_concs$area <- as.factor('sorting')
sa_check_sorting_concs$scenario <- as.factor('SA Check')
sa_check_sorting_concs$water <- as.factor('Dry')
names(sa_check_sorting_concs) <- c('concentration','area','scenario','water')

sa_check_reject_concs <- as.data.frame(sa_check_reject_w3wed_conc_list)
sa_check_reject_concs$area <- as.factor('reject')
sa_check_reject_concs$scenario <- as.factor('SA Check')
sa_check_reject_concs$water <- as.factor('Dry')
names(sa_check_reject_concs) <- c('concentration','area','scenario','water')

sa_check_tray_packing_concs <- as.data.frame(sa_check_tray_packing_w3wed_conc_list)
sa_check_tray_packing_concs$area <- as.factor('tray packing')
sa_check_tray_packing_concs$scenario <- as.factor('SA Check')
sa_check_tray_packing_concs$water <- as.factor('Dry')
names(sa_check_tray_packing_concs) <- c('concentration','area','scenario','water')

sa_check_other_concs <- as.data.frame(sa_check_other_w3wed_conc_list)
sa_check_other_concs$area <- as.factor('other')
sa_check_other_concs$scenario <- as.factor('SA Check')
sa_check_other_concs$water <- as.factor('Dry')
names(sa_check_other_concs) <- c('concentration','area','scenario','water')

sa_check_w3wed_concs <- rbind(sa_check_loading_concs,sa_check_cleaning_concs,sa_check_sorting_concs,sa_check_tray_packing_concs,sa_check_reject_concs,sa_check_other_concs)

sa_check_loading_prev <- as.data.frame(NL_table_sa_check$loading_w3wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_loading_prev$area <- as.factor('loading')
sa_check_loading_prev$scenario <- as.factor('SA Check')
sa_check_loading_prev$water <- as.factor('Wet')
names(sa_check_loading_prev) <- c('prevalence','area','scenario','water')

sa_check_cleaning_prev <- as.data.frame(NL_table_sa_check$cleaning_w3wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_cleaning_prev$area <- as.factor('cleaning')
sa_check_cleaning_prev$scenario <- as.factor('SA Check')
sa_check_cleaning_prev$water <- as.factor('Wet')
names(sa_check_cleaning_prev) <- c('prevalence','area','scenario','water')

sa_check_sorting_prev <- as.data.frame(NL_table_sa_check$sorting_w3wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_sorting_prev$area <- as.factor('sorting')
sa_check_sorting_prev$scenario <- as.factor('SA Check')
sa_check_sorting_prev$water <- as.factor('Dry')
names(sa_check_sorting_prev) <- c('prevalence','area','scenario','water')

sa_check_reject_prev <- as.data.frame(NL_table_sa_check$reject_w3wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_reject_prev$area <- as.factor('reject')
sa_check_reject_prev$scenario <- as.factor('SA Check')
sa_check_reject_prev$water <- as.factor('Dry')
names(sa_check_reject_prev) <- c('prevalence','area','scenario','water')

sa_check_tray_packing_prev <- as.data.frame(NL_table_sa_check$tray_packing_w3wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_tray_packing_prev$area <- as.factor('tray packing')
sa_check_tray_packing_prev$scenario <- as.factor('SA Check')
sa_check_tray_packing_prev$water <- as.factor('Dry')
names(sa_check_tray_packing_prev) <- c('prevalence','area','scenario','water')

sa_check_other_prev <- as.data.frame(NL_table_sa_check$other_w3wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_other_prev$area <- as.factor('other')
sa_check_other_prev$scenario <- as.factor('SA Check')
sa_check_other_prev$water <- as.factor('Dry')
names(sa_check_other_prev) <- c('prevalence','area','scenario','water')

sa_check_w3wed_prev <- rbind(sa_check_loading_prev,sa_check_cleaning_prev,sa_check_sorting_prev,sa_check_tray_packing_prev,sa_check_reject_prev,sa_check_other_prev)

sa_check_w3wed_wet_prev <- as.data.frame(sa_check_loading_prev$prevalence*21/100+sa_check_cleaning_prev$prevalence*28/100)/49*100
sa_check_w3wed_wet_prev$scenario <- as.factor('SA Check')
sa_check_w3wed_wet_prev$water <- as.factor('Wet')
names(sa_check_w3wed_wet_prev) <- c('prevalence','scenario','water')

sa_check_w3wed_dry_prev <- as.data.frame(sa_check_sorting_prev$prevalence*20/100+sa_check_reject_prev$prevalence*23/100+sa_check_tray_packing_prev$prevalence*123/100+sa_check_other_prev$prevalence*10/100)/176*100
sa_check_w3wed_dry_prev$scenario <- as.factor('SA Check')
sa_check_w3wed_dry_prev$water <- as.factor('Dry')
names(sa_check_w3wed_dry_prev) <- c('prevalence','scenario','water')

sa_check_w3wed_recombined_prev <- rbind(sa_check_w3wed_wet_prev, sa_check_w3wed_dry_prev)

####W4Wed####
vector <- NL_table_sa_check$w4wed_conc_list
vector <- vector[vector!='[]']
sa_check_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
    sa_check_w4wed_conc_list <- append(sa_check_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
    i <- i+1
}
sa_check_w4wed_conc_matrix <- matrix(unlist(sa_check_w4wed_conc_list), ncol = 225, byrow = TRUE)

vector <- NL_table_sa_check$loading_w4wed_conc_list
vector <- vector[vector!='[]']
sa_check_loading_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_loading_w4wed_conc_list <- append(sa_check_loading_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_loading_w4wed_conc_matrix <- matrix(unlist(sa_check_loading_w4wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_sa_check$cleaning_w4wed_conc_list
vector <- vector[vector!='[]']
sa_check_cleaning_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_cleaning_w4wed_conc_list <- append(sa_check_cleaning_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_cleaning_w4wed_conc_matrix <- matrix(unlist(sa_check_cleaning_w4wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_sa_check$drying_w4wed_conc_list
# vector <- vector[vector!='[]']
# sa_check_drying_w4wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   sa_check_drying_w4wed_conc_list <- append(sa_check_drying_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_sa_check$sorting_w4wed_conc_list
vector <- vector[vector!='[]']
sa_check_sorting_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_sorting_w4wed_conc_list <- append(sa_check_sorting_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_sorting_w4wed_conc_matrix <- matrix(unlist(sa_check_sorting_w4wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_sa_check$tray_packing_w4wed_conc_list
vector <- vector[vector!='[]']
sa_check_tray_packing_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_tray_packing_w4wed_conc_list <- append(sa_check_tray_packing_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_tray_packing_w4wed_conc_matrix <- matrix(unlist(sa_check_tray_packing_w4wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_sa_check$reject_w4wed_conc_list
vector <- vector[vector!='[]']
sa_check_reject_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_reject_w4wed_conc_list <- append(sa_check_reject_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_reject_w4wed_conc_matrix <- matrix(unlist(sa_check_reject_w4wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_sa_check$other_w4wed_conc_list
vector <- vector[vector!='[]']
sa_check_other_w4wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_other_w4wed_conc_list <- append(sa_check_other_w4wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_other_w4wed_conc_matrix <- matrix(unlist(sa_check_other_w4wed_conc_list), ncol = 10, byrow = TRUE)

sa_check_loading_concs <- as.data.frame(sa_check_loading_w4wed_conc_list)
sa_check_loading_concs$area <- as.factor('loading')
sa_check_loading_concs$scenario <- as.factor('SA Check')
sa_check_loading_concs$water <- as.factor('Wet')
names(sa_check_loading_concs) <- c('concentration','area','scenario','water')

sa_check_cleaning_concs <- as.data.frame(sa_check_cleaning_w4wed_conc_list)
sa_check_cleaning_concs$area <- as.factor('cleaning')
sa_check_cleaning_concs$scenario <- as.factor('SA Check')
sa_check_cleaning_concs$water <- as.factor('Wet')
names(sa_check_cleaning_concs) <- c('concentration','area','scenario','water')

sa_check_sorting_concs <- as.data.frame(sa_check_sorting_w4wed_conc_list)
sa_check_sorting_concs$area <- as.factor('sorting')
sa_check_sorting_concs$scenario <- as.factor('SA Check')
sa_check_sorting_concs$water <- as.factor('Dry')
names(sa_check_sorting_concs) <- c('concentration','area','scenario','water')

sa_check_reject_concs <- as.data.frame(sa_check_reject_w4wed_conc_list)
sa_check_reject_concs$area <- as.factor('reject')
sa_check_reject_concs$scenario <- as.factor('SA Check')
sa_check_reject_concs$water <- as.factor('Dry')
names(sa_check_reject_concs) <- c('concentration','area','scenario','water')

sa_check_tray_packing_concs <- as.data.frame(sa_check_tray_packing_w4wed_conc_list)
sa_check_tray_packing_concs$area <- as.factor('tray packing')
sa_check_tray_packing_concs$scenario <- as.factor('SA Check')
sa_check_tray_packing_concs$water <- as.factor('Dry')
names(sa_check_tray_packing_concs) <- c('concentration','area','scenario','water')

sa_check_other_concs <- as.data.frame(sa_check_other_w4wed_conc_list)
sa_check_other_concs$area <- as.factor('other')
sa_check_other_concs$scenario <- as.factor('SA Check')
sa_check_other_concs$water <- as.factor('Dry')
names(sa_check_other_concs) <- c('concentration','area','scenario','water')

sa_check_w4wed_concs <- rbind(sa_check_loading_concs,sa_check_cleaning_concs,sa_check_sorting_concs,sa_check_tray_packing_concs,sa_check_reject_concs,sa_check_other_concs)

sa_check_loading_prev <- as.data.frame(NL_table_sa_check$loading_w4wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_loading_prev$area <- as.factor('loading')
sa_check_loading_prev$scenario <- as.factor('SA Check')
sa_check_loading_prev$water <- as.factor('Wet')
names(sa_check_loading_prev) <- c('prevalence','area','scenario','water')

sa_check_cleaning_prev <- as.data.frame(NL_table_sa_check$cleaning_w4wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_cleaning_prev$area <- as.factor('cleaning')
sa_check_cleaning_prev$scenario <- as.factor('SA Check')
sa_check_cleaning_prev$water <- as.factor('Wet')
names(sa_check_cleaning_prev) <- c('prevalence','area','scenario','water')

sa_check_sorting_prev <- as.data.frame(NL_table_sa_check$sorting_w4wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_sorting_prev$area <- as.factor('sorting')
sa_check_sorting_prev$scenario <- as.factor('SA Check')
sa_check_sorting_prev$water <- as.factor('Dry')
names(sa_check_sorting_prev) <- c('prevalence','area','scenario','water')

sa_check_reject_prev <- as.data.frame(NL_table_sa_check$reject_w4wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_reject_prev$area <- as.factor('reject')
sa_check_reject_prev$scenario <- as.factor('SA Check')
sa_check_reject_prev$water <- as.factor('Dry')
names(sa_check_reject_prev) <- c('prevalence','area','scenario','water')

sa_check_tray_packing_prev <- as.data.frame(NL_table_sa_check$tray_packing_w4wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_tray_packing_prev$area <- as.factor('tray packing')
sa_check_tray_packing_prev$scenario <- as.factor('SA Check')
sa_check_tray_packing_prev$water <- as.factor('Dry')
names(sa_check_tray_packing_prev) <- c('prevalence','area','scenario','water')

sa_check_other_prev <- as.data.frame(NL_table_sa_check$other_w4wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_other_prev$area <- as.factor('other')
sa_check_other_prev$scenario <- as.factor('SA Check')
sa_check_other_prev$water <- as.factor('Dry')
names(sa_check_other_prev) <- c('prevalence','area','scenario','water')

sa_check_w4wed_prev <- rbind(sa_check_loading_prev,sa_check_cleaning_prev,sa_check_sorting_prev,sa_check_tray_packing_prev,sa_check_reject_prev,sa_check_other_prev)

sa_check_w4wed_wet_prev <- as.data.frame(sa_check_loading_prev$prevalence*21/100+sa_check_cleaning_prev$prevalence*28/100)/49*100
sa_check_w4wed_wet_prev$scenario <- as.factor('SA Check')
sa_check_w4wed_wet_prev$water <- as.factor('Wet')
names(sa_check_w4wed_wet_prev) <- c('prevalence','scenario','water')

sa_check_w4wed_dry_prev <- as.data.frame(sa_check_sorting_prev$prevalence*20/100+sa_check_reject_prev$prevalence*23/100+sa_check_tray_packing_prev$prevalence*123/100+sa_check_other_prev$prevalence*10/100)/176*100
sa_check_w4wed_dry_prev$scenario <- as.factor('SA Check')
sa_check_w4wed_dry_prev$water <- as.factor('Dry')
names(sa_check_w4wed_dry_prev) <- c('prevalence','scenario','water')

sa_check_w4wed_recombined_prev <- rbind(sa_check_w4wed_wet_prev, sa_check_w4wed_dry_prev)

####W5Wed####
vector <- NL_table_sa_check$w5wed_conc_list
vector <- vector[vector!='[]']
sa_check_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
    sa_check_w5wed_conc_list <- append(sa_check_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
    i <- i+1
}
sa_check_w5wed_conc_matrix <- matrix(unlist(sa_check_w5wed_conc_list), ncol = 225, byrow = TRUE)

vector <- NL_table_sa_check$loading_w5wed_conc_list
vector <- vector[vector!='[]']
sa_check_loading_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_loading_w5wed_conc_list <- append(sa_check_loading_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_loading_w5wed_conc_matrix <- matrix(unlist(sa_check_loading_w5wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_sa_check$cleaning_w5wed_conc_list
vector <- vector[vector!='[]']
sa_check_cleaning_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_cleaning_w5wed_conc_list <- append(sa_check_cleaning_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_cleaning_w5wed_conc_matrix <- matrix(unlist(sa_check_cleaning_w5wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_sa_check$drying_w5wed_conc_list
# vector <- vector[vector!='[]']
# sa_check_drying_w5wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   sa_check_drying_w5wed_conc_list <- append(sa_check_drying_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_sa_check$sorting_w5wed_conc_list
vector <- vector[vector!='[]']
sa_check_sorting_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_sorting_w5wed_conc_list <- append(sa_check_sorting_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_sorting_w5wed_conc_matrix <- matrix(unlist(sa_check_sorting_w5wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_sa_check$tray_packing_w5wed_conc_list
vector <- vector[vector!='[]']
sa_check_tray_packing_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_tray_packing_w5wed_conc_list <- append(sa_check_tray_packing_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_tray_packing_w5wed_conc_matrix <- matrix(unlist(sa_check_tray_packing_w5wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_sa_check$reject_w5wed_conc_list
vector <- vector[vector!='[]']
sa_check_reject_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_reject_w5wed_conc_list <- append(sa_check_reject_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_reject_w5wed_conc_matrix <- matrix(unlist(sa_check_reject_w5wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_sa_check$other_w5wed_conc_list
vector <- vector[vector!='[]']
sa_check_other_w5wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_other_w5wed_conc_list <- append(sa_check_other_w5wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_other_w5wed_conc_matrix <- matrix(unlist(sa_check_other_w5wed_conc_list), ncol = 10, byrow = TRUE)

sa_check_loading_concs <- as.data.frame(sa_check_loading_w5wed_conc_list)
sa_check_loading_concs$area <- as.factor('loading')
sa_check_loading_concs$scenario <- as.factor('SA Check')
sa_check_loading_concs$water <- as.factor('Wet')
names(sa_check_loading_concs) <- c('concentration','area','scenario','water')

sa_check_cleaning_concs <- as.data.frame(sa_check_cleaning_w5wed_conc_list)
sa_check_cleaning_concs$area <- as.factor('cleaning')
sa_check_cleaning_concs$scenario <- as.factor('SA Check')
sa_check_cleaning_concs$water <- as.factor('Wet')
names(sa_check_cleaning_concs) <- c('concentration','area','scenario','water')

sa_check_sorting_concs <- as.data.frame(sa_check_sorting_w5wed_conc_list)
sa_check_sorting_concs$area <- as.factor('sorting')
sa_check_sorting_concs$scenario <- as.factor('SA Check')
sa_check_sorting_concs$water <- as.factor('Dry')
names(sa_check_sorting_concs) <- c('concentration','area','scenario','water')

sa_check_reject_concs <- as.data.frame(sa_check_reject_w5wed_conc_list)
sa_check_reject_concs$area <- as.factor('reject')
sa_check_reject_concs$scenario <- as.factor('SA Check')
sa_check_reject_concs$water <- as.factor('Dry')
names(sa_check_reject_concs) <- c('concentration','area','scenario','water')

sa_check_tray_packing_concs <- as.data.frame(sa_check_tray_packing_w5wed_conc_list)
sa_check_tray_packing_concs$area <- as.factor('tray packing')
sa_check_tray_packing_concs$scenario <- as.factor('SA Check')
sa_check_tray_packing_concs$water <- as.factor('Dry')
names(sa_check_tray_packing_concs) <- c('concentration','area','scenario','water')

sa_check_other_concs <- as.data.frame(sa_check_other_w5wed_conc_list)
sa_check_other_concs$area <- as.factor('other')
sa_check_other_concs$scenario <- as.factor('SA Check')
sa_check_other_concs$water <- as.factor('Dry')
names(sa_check_other_concs) <- c('concentration','area','scenario','water')

sa_check_w5wed_concs <- rbind(sa_check_loading_concs,sa_check_cleaning_concs,sa_check_sorting_concs,sa_check_tray_packing_concs,sa_check_reject_concs,sa_check_other_concs)

sa_check_loading_prev <- as.data.frame(NL_table_sa_check$loading_w5wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_loading_prev$area <- as.factor('loading')
sa_check_loading_prev$scenario <- as.factor('SA Check')
sa_check_loading_prev$water <- as.factor('Wet')
names(sa_check_loading_prev) <- c('prevalence','area','scenario','water')

sa_check_cleaning_prev <- as.data.frame(NL_table_sa_check$cleaning_w5wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_cleaning_prev$area <- as.factor('cleaning')
sa_check_cleaning_prev$scenario <- as.factor('SA Check')
sa_check_cleaning_prev$water <- as.factor('Wet')
names(sa_check_cleaning_prev) <- c('prevalence','area','scenario','water')

sa_check_sorting_prev <- as.data.frame(NL_table_sa_check$sorting_w5wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_sorting_prev$area <- as.factor('sorting')
sa_check_sorting_prev$scenario <- as.factor('SA Check')
sa_check_sorting_prev$water <- as.factor('Dry')
names(sa_check_sorting_prev) <- c('prevalence','area','scenario','water')

sa_check_reject_prev <- as.data.frame(NL_table_sa_check$reject_w5wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_reject_prev$area <- as.factor('reject')
sa_check_reject_prev$scenario <- as.factor('SA Check')
sa_check_reject_prev$water <- as.factor('Dry')
names(sa_check_reject_prev) <- c('prevalence','area','scenario','water')

sa_check_tray_packing_prev <- as.data.frame(NL_table_sa_check$tray_packing_w5wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_tray_packing_prev$area <- as.factor('tray packing')
sa_check_tray_packing_prev$scenario <- as.factor('SA Check')
sa_check_tray_packing_prev$water <- as.factor('Dry')
names(sa_check_tray_packing_prev) <- c('prevalence','area','scenario','water')

sa_check_other_prev <- as.data.frame(NL_table_sa_check$other_w5wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_other_prev$area <- as.factor('other')
sa_check_other_prev$scenario <- as.factor('SA Check')
sa_check_other_prev$water <- as.factor('Dry')
names(sa_check_other_prev) <- c('prevalence','area','scenario','water')

sa_check_w5wed_prev <- rbind(sa_check_loading_prev,sa_check_cleaning_prev,sa_check_sorting_prev,sa_check_tray_packing_prev,sa_check_reject_prev,sa_check_other_prev)

sa_check_w5wed_wet_prev <- as.data.frame(sa_check_loading_prev$prevalence*21/100+sa_check_cleaning_prev$prevalence*28/100)/49*100
sa_check_w5wed_wet_prev$scenario <- as.factor('SA Check')
sa_check_w5wed_wet_prev$water <- as.factor('Wet')
names(sa_check_w5wed_wet_prev) <- c('prevalence','scenario','water')

sa_check_w5wed_dry_prev <- as.data.frame(sa_check_sorting_prev$prevalence*20/100+sa_check_reject_prev$prevalence*23/100+sa_check_tray_packing_prev$prevalence*123/100+sa_check_other_prev$prevalence*10/100)/176*100
sa_check_w5wed_dry_prev$scenario <- as.factor('SA Check')
sa_check_w5wed_dry_prev$water <- as.factor('Dry')
names(sa_check_w5wed_dry_prev) <- c('prevalence','scenario','water')

sa_check_w5wed_recombined_prev <- rbind(sa_check_w5wed_wet_prev, sa_check_w5wed_dry_prev)

####W6Wed####
vector <- NL_table_sa_check$w6wed_conc_list
vector <- vector[vector!='[]']
sa_check_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
    sa_check_w6wed_conc_list <- append(sa_check_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
    i <- i+1
}
sa_check_w6wed_conc_matrix <- matrix(unlist(sa_check_w6wed_conc_list), ncol = 225, byrow = TRUE)

vector <- NL_table_sa_check$loading_w6wed_conc_list
vector <- vector[vector!='[]']
sa_check_loading_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_loading_w6wed_conc_list <- append(sa_check_loading_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_loading_w6wed_conc_matrix <- matrix(unlist(sa_check_loading_w6wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_sa_check$cleaning_w6wed_conc_list
vector <- vector[vector!='[]']
sa_check_cleaning_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_cleaning_w6wed_conc_list <- append(sa_check_cleaning_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_cleaning_w6wed_conc_matrix <- matrix(unlist(sa_check_cleaning_w6wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_sa_check$drying_w6wed_conc_list
# vector <- vector[vector!='[]']
# sa_check_drying_w6wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   sa_check_drying_w6wed_conc_list <- append(sa_check_drying_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_sa_check$sorting_w6wed_conc_list
vector <- vector[vector!='[]']
sa_check_sorting_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_sorting_w6wed_conc_list <- append(sa_check_sorting_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_sorting_w6wed_conc_matrix <- matrix(unlist(sa_check_sorting_w6wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_sa_check$tray_packing_w6wed_conc_list
vector <- vector[vector!='[]']
sa_check_tray_packing_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_tray_packing_w6wed_conc_list <- append(sa_check_tray_packing_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_tray_packing_w6wed_conc_matrix <- matrix(unlist(sa_check_tray_packing_w6wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_sa_check$reject_w6wed_conc_list
vector <- vector[vector!='[]']
sa_check_reject_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_reject_w6wed_conc_list <- append(sa_check_reject_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_reject_w6wed_conc_matrix <- matrix(unlist(sa_check_reject_w6wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_sa_check$other_w6wed_conc_list
vector <- vector[vector!='[]']
sa_check_other_w6wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_other_w6wed_conc_list <- append(sa_check_other_w6wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_other_w6wed_conc_matrix <- matrix(unlist(sa_check_other_w6wed_conc_list), ncol = 10, byrow = TRUE)

sa_check_loading_concs <- as.data.frame(sa_check_loading_w6wed_conc_list)
sa_check_loading_concs$area <- as.factor('loading')
sa_check_loading_concs$scenario <- as.factor('SA Check')
sa_check_loading_concs$water <- as.factor('Wet')
names(sa_check_loading_concs) <- c('concentration','area','scenario','water')

sa_check_cleaning_concs <- as.data.frame(sa_check_cleaning_w6wed_conc_list)
sa_check_cleaning_concs$area <- as.factor('cleaning')
sa_check_cleaning_concs$scenario <- as.factor('SA Check')
sa_check_cleaning_concs$water <- as.factor('Wet')
names(sa_check_cleaning_concs) <- c('concentration','area','scenario','water')

sa_check_sorting_concs <- as.data.frame(sa_check_sorting_w6wed_conc_list)
sa_check_sorting_concs$area <- as.factor('sorting')
sa_check_sorting_concs$scenario <- as.factor('SA Check')
sa_check_sorting_concs$water <- as.factor('Dry')
names(sa_check_sorting_concs) <- c('concentration','area','scenario','water')

sa_check_reject_concs <- as.data.frame(sa_check_reject_w6wed_conc_list)
sa_check_reject_concs$area <- as.factor('reject')
sa_check_reject_concs$scenario <- as.factor('SA Check')
sa_check_reject_concs$water <- as.factor('Dry')
names(sa_check_reject_concs) <- c('concentration','area','scenario','water')

sa_check_tray_packing_concs <- as.data.frame(sa_check_tray_packing_w6wed_conc_list)
sa_check_tray_packing_concs$area <- as.factor('tray packing')
sa_check_tray_packing_concs$scenario <- as.factor('SA Check')
sa_check_tray_packing_concs$water <- as.factor('Dry')
names(sa_check_tray_packing_concs) <- c('concentration','area','scenario','water')

sa_check_other_concs <- as.data.frame(sa_check_other_w6wed_conc_list)
sa_check_other_concs$area <- as.factor('other')
sa_check_other_concs$scenario <- as.factor('SA Check')
sa_check_other_concs$water <- as.factor('Dry')
names(sa_check_other_concs) <- c('concentration','area','scenario','water')

sa_check_w6wed_concs <- rbind(sa_check_loading_concs,sa_check_cleaning_concs,sa_check_sorting_concs,sa_check_tray_packing_concs,sa_check_reject_concs,sa_check_other_concs)

sa_check_loading_prev <- as.data.frame(NL_table_sa_check$loading_w6wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_loading_prev$area <- as.factor('loading')
sa_check_loading_prev$scenario <- as.factor('SA Check')
sa_check_loading_prev$water <- as.factor('Wet')
names(sa_check_loading_prev) <- c('prevalence','area','scenario','water')

sa_check_cleaning_prev <- as.data.frame(NL_table_sa_check$cleaning_w6wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_cleaning_prev$area <- as.factor('cleaning')
sa_check_cleaning_prev$scenario <- as.factor('SA Check')
sa_check_cleaning_prev$water <- as.factor('Wet')
names(sa_check_cleaning_prev) <- c('prevalence','area','scenario','water')

sa_check_sorting_prev <- as.data.frame(NL_table_sa_check$sorting_w6wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_sorting_prev$area <- as.factor('sorting')
sa_check_sorting_prev$scenario <- as.factor('SA Check')
sa_check_sorting_prev$water <- as.factor('Dry')
names(sa_check_sorting_prev) <- c('prevalence','area','scenario','water')

sa_check_reject_prev <- as.data.frame(NL_table_sa_check$reject_w6wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_reject_prev$area <- as.factor('reject')
sa_check_reject_prev$scenario <- as.factor('SA Check')
sa_check_reject_prev$water <- as.factor('Dry')
names(sa_check_reject_prev) <- c('prevalence','area','scenario','water')

sa_check_tray_packing_prev <- as.data.frame(NL_table_sa_check$tray_packing_w6wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_tray_packing_prev$area <- as.factor('tray packing')
sa_check_tray_packing_prev$scenario <- as.factor('SA Check')
sa_check_tray_packing_prev$water <- as.factor('Dry')
names(sa_check_tray_packing_prev) <- c('prevalence','area','scenario','water')

sa_check_other_prev <- as.data.frame(NL_table_sa_check$other_w6wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_other_prev$area <- as.factor('other')
sa_check_other_prev$scenario <- as.factor('SA Check')
sa_check_other_prev$water <- as.factor('Dry')
names(sa_check_other_prev) <- c('prevalence','area','scenario','water')

sa_check_w6wed_prev <- rbind(sa_check_loading_prev,sa_check_cleaning_prev,sa_check_sorting_prev,sa_check_tray_packing_prev,sa_check_reject_prev,sa_check_other_prev)

sa_check_w6wed_wet_prev <- as.data.frame(sa_check_loading_prev$prevalence*21/100+sa_check_cleaning_prev$prevalence*28/100)/49*100
sa_check_w6wed_wet_prev$scenario <- as.factor('SA Check')
sa_check_w6wed_wet_prev$water <- as.factor('Wet')
names(sa_check_w6wed_wet_prev) <- c('prevalence','scenario','water')

sa_check_w6wed_dry_prev <- as.data.frame(sa_check_sorting_prev$prevalence*20/100+sa_check_reject_prev$prevalence*23/100+sa_check_tray_packing_prev$prevalence*123/100+sa_check_other_prev$prevalence*10/100)/176*100
sa_check_w6wed_dry_prev$scenario <- as.factor('SA Check')
sa_check_w6wed_dry_prev$water <- as.factor('Dry')
names(sa_check_w6wed_dry_prev) <- c('prevalence','scenario','water')

sa_check_w6wed_recombined_prev <- rbind(sa_check_w6wed_wet_prev, sa_check_w6wed_dry_prev)

####W7Wed####
vector <- NL_table_sa_check$w7wed_conc_list
vector <- vector[vector!='[]']
sa_check_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
    sa_check_w7wed_conc_list <- append(sa_check_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
    i <- i+1
}
sa_check_w7wed_conc_matrix <- matrix(unlist(sa_check_w7wed_conc_list), ncol = 225, byrow = TRUE)

vector <- NL_table_sa_check$loading_w7wed_conc_list
vector <- vector[vector!='[]']
sa_check_loading_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_loading_w7wed_conc_list <- append(sa_check_loading_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_loading_w7wed_conc_matrix <- matrix(unlist(sa_check_loading_w7wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_sa_check$cleaning_w7wed_conc_list
vector <- vector[vector!='[]']
sa_check_cleaning_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_cleaning_w7wed_conc_list <- append(sa_check_cleaning_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_cleaning_w7wed_conc_matrix <- matrix(unlist(sa_check_cleaning_w7wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_sa_check$drying_w7wed_conc_list
# vector <- vector[vector!='[]']
# sa_check_drying_w7wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   sa_check_drying_w7wed_conc_list <- append(sa_check_drying_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_sa_check$sorting_w7wed_conc_list
vector <- vector[vector!='[]']
sa_check_sorting_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_sorting_w7wed_conc_list <- append(sa_check_sorting_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_sorting_w7wed_conc_matrix <- matrix(unlist(sa_check_sorting_w7wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_sa_check$tray_packing_w7wed_conc_list
vector <- vector[vector!='[]']
sa_check_tray_packing_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_tray_packing_w7wed_conc_list <- append(sa_check_tray_packing_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_tray_packing_w7wed_conc_matrix <- matrix(unlist(sa_check_tray_packing_w7wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_sa_check$reject_w7wed_conc_list
vector <- vector[vector!='[]']
sa_check_reject_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_reject_w7wed_conc_list <- append(sa_check_reject_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_reject_w7wed_conc_matrix <- matrix(unlist(sa_check_reject_w7wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_sa_check$other_w7wed_conc_list
vector <- vector[vector!='[]']
sa_check_other_w7wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_other_w7wed_conc_list <- append(sa_check_other_w7wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_other_w7wed_conc_matrix <- matrix(unlist(sa_check_other_w7wed_conc_list), ncol = 10, byrow = TRUE)

sa_check_loading_concs <- as.data.frame(sa_check_loading_w7wed_conc_list)
sa_check_loading_concs$area <- as.factor('loading')
sa_check_loading_concs$scenario <- as.factor('SA Check')
sa_check_loading_concs$water <- as.factor('Wet')
names(sa_check_loading_concs) <- c('concentration','area','scenario','water')

sa_check_cleaning_concs <- as.data.frame(sa_check_cleaning_w7wed_conc_list)
sa_check_cleaning_concs$area <- as.factor('cleaning')
sa_check_cleaning_concs$scenario <- as.factor('SA Check')
sa_check_cleaning_concs$water <- as.factor('Wet')
names(sa_check_cleaning_concs) <- c('concentration','area','scenario','water')

sa_check_sorting_concs <- as.data.frame(sa_check_sorting_w7wed_conc_list)
sa_check_sorting_concs$area <- as.factor('sorting')
sa_check_sorting_concs$scenario <- as.factor('SA Check')
sa_check_sorting_concs$water <- as.factor('Dry')
names(sa_check_sorting_concs) <- c('concentration','area','scenario','water')

sa_check_reject_concs <- as.data.frame(sa_check_reject_w7wed_conc_list)
sa_check_reject_concs$area <- as.factor('reject')
sa_check_reject_concs$scenario <- as.factor('SA Check')
sa_check_reject_concs$water <- as.factor('Dry')
names(sa_check_reject_concs) <- c('concentration','area','scenario','water')

sa_check_tray_packing_concs <- as.data.frame(sa_check_tray_packing_w7wed_conc_list)
sa_check_tray_packing_concs$area <- as.factor('tray packing')
sa_check_tray_packing_concs$scenario <- as.factor('SA Check')
sa_check_tray_packing_concs$water <- as.factor('Dry')
names(sa_check_tray_packing_concs) <- c('concentration','area','scenario','water')

sa_check_other_concs <- as.data.frame(sa_check_other_w7wed_conc_list)
sa_check_other_concs$area <- as.factor('other')
sa_check_other_concs$scenario <- as.factor('SA Check')
sa_check_other_concs$water <- as.factor('Dry')
names(sa_check_other_concs) <- c('concentration','area','scenario','water')

sa_check_w7wed_concs <- rbind(sa_check_loading_concs,sa_check_cleaning_concs,sa_check_sorting_concs,sa_check_tray_packing_concs,sa_check_reject_concs,sa_check_other_concs)

sa_check_loading_prev <- as.data.frame(NL_table_sa_check$loading_w7wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_loading_prev$area <- as.factor('loading')
sa_check_loading_prev$scenario <- as.factor('SA Check')
sa_check_loading_prev$water <- as.factor('Wet')
names(sa_check_loading_prev) <- c('prevalence','area','scenario','water')

sa_check_cleaning_prev <- as.data.frame(NL_table_sa_check$cleaning_w7wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_cleaning_prev$area <- as.factor('cleaning')
sa_check_cleaning_prev$scenario <- as.factor('SA Check')
sa_check_cleaning_prev$water <- as.factor('Wet')
names(sa_check_cleaning_prev) <- c('prevalence','area','scenario','water')

sa_check_sorting_prev <- as.data.frame(NL_table_sa_check$sorting_w7wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_sorting_prev$area <- as.factor('sorting')
sa_check_sorting_prev$scenario <- as.factor('SA Check')
sa_check_sorting_prev$water <- as.factor('Dry')
names(sa_check_sorting_prev) <- c('prevalence','area','scenario','water')

sa_check_reject_prev <- as.data.frame(NL_table_sa_check$reject_w7wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_reject_prev$area <- as.factor('reject')
sa_check_reject_prev$scenario <- as.factor('SA Check')
sa_check_reject_prev$water <- as.factor('Dry')
names(sa_check_reject_prev) <- c('prevalence','area','scenario','water')

sa_check_tray_packing_prev <- as.data.frame(NL_table_sa_check$tray_packing_w7wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_tray_packing_prev$area <- as.factor('tray packing')
sa_check_tray_packing_prev$scenario <- as.factor('SA Check')
sa_check_tray_packing_prev$water <- as.factor('Dry')
names(sa_check_tray_packing_prev) <- c('prevalence','area','scenario','water')

sa_check_other_prev <- as.data.frame(NL_table_sa_check$other_w7wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_other_prev$area <- as.factor('other')
sa_check_other_prev$scenario <- as.factor('SA Check')
sa_check_other_prev$water <- as.factor('Dry')
names(sa_check_other_prev) <- c('prevalence','area','scenario','water')

sa_check_w7wed_prev <- rbind(sa_check_loading_prev,sa_check_cleaning_prev,sa_check_sorting_prev,sa_check_tray_packing_prev,sa_check_reject_prev,sa_check_other_prev)

sa_check_w7wed_wet_prev <- as.data.frame(sa_check_loading_prev$prevalence*21/100+sa_check_cleaning_prev$prevalence*28/100)/49*100
sa_check_w7wed_wet_prev$scenario <- as.factor('SA Check')
sa_check_w7wed_wet_prev$water <- as.factor('Wet')
names(sa_check_w7wed_wet_prev) <- c('prevalence','scenario','water')

sa_check_w7wed_dry_prev <- as.data.frame(sa_check_sorting_prev$prevalence*20/100+sa_check_reject_prev$prevalence*23/100+sa_check_tray_packing_prev$prevalence*123/100+sa_check_other_prev$prevalence*10/100)/176*100
sa_check_w7wed_dry_prev$scenario <- as.factor('SA Check')
sa_check_w7wed_dry_prev$water <- as.factor('Dry')
names(sa_check_w7wed_dry_prev) <- c('prevalence','scenario','water')

sa_check_w7wed_recombined_prev <- rbind(sa_check_w7wed_wet_prev, sa_check_w7wed_dry_prev)

####W8Wed####
vector <- NL_table_sa_check$w8wed_conc_list
vector <- vector[vector!='[]']
sa_check_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
    sa_check_w8wed_conc_list <- append(sa_check_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
    i <- i+1
}
sa_check_w8wed_conc_matrix <- matrix(unlist(sa_check_w8wed_conc_list), ncol = 225, byrow = TRUE)

vector <- NL_table_sa_check$loading_w8wed_conc_list
vector <- vector[vector!='[]']
sa_check_loading_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_loading_w8wed_conc_list <- append(sa_check_loading_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_loading_w8wed_conc_matrix <- matrix(unlist(sa_check_loading_w8wed_conc_list), ncol = 21, byrow = TRUE)

vector <- NL_table_sa_check$cleaning_w8wed_conc_list
vector <- vector[vector!='[]']
sa_check_cleaning_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_cleaning_w8wed_conc_list <- append(sa_check_cleaning_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_cleaning_w8wed_conc_matrix <- matrix(unlist(sa_check_cleaning_w8wed_conc_list), ncol = 28, byrow = TRUE)

# vector <- NL_table_sa_check$drying_w8wed_conc_list
# vector <- vector[vector!='[]']
# sa_check_drying_w8wed_conc_list <- numeric()
# i <- 1
# while (i<=length(vector)) {
#   sa_check_drying_w8wed_conc_list <- append(sa_check_drying_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
#   i <- i+1
# }

vector <- NL_table_sa_check$sorting_w8wed_conc_list
vector <- vector[vector!='[]']
sa_check_sorting_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_sorting_w8wed_conc_list <- append(sa_check_sorting_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_sorting_w8wed_conc_matrix <- matrix(unlist(sa_check_sorting_w8wed_conc_list), ncol = 20, byrow = TRUE)

vector <- NL_table_sa_check$tray_packing_w8wed_conc_list
vector <- vector[vector!='[]']
sa_check_tray_packing_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_tray_packing_w8wed_conc_list <- append(sa_check_tray_packing_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_tray_packing_w8wed_conc_matrix <- matrix(unlist(sa_check_tray_packing_w8wed_conc_list), ncol = 123, byrow = TRUE)

vector <- NL_table_sa_check$reject_w8wed_conc_list
vector <- vector[vector!='[]']
sa_check_reject_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_reject_w8wed_conc_list <- append(sa_check_reject_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_reject_w8wed_conc_matrix <- matrix(unlist(sa_check_reject_w8wed_conc_list), ncol = 23, byrow = TRUE)

vector <- NL_table_sa_check$other_w8wed_conc_list
vector <- vector[vector!='[]']
sa_check_other_w8wed_conc_list <- numeric()
i <- 1
while (i<=length(vector)) {
  sa_check_other_w8wed_conc_list <- append(sa_check_other_w8wed_conc_list, as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]])))
  i <- i+1
}
sa_check_other_w8wed_conc_matrix <- matrix(unlist(sa_check_other_w8wed_conc_list), ncol = 10, byrow = TRUE)

sa_check_loading_concs <- as.data.frame(sa_check_loading_w8wed_conc_list)
sa_check_loading_concs$area <- as.factor('loading')
sa_check_loading_concs$scenario <- as.factor('SA Check')
sa_check_loading_concs$water <- as.factor('Wet')
names(sa_check_loading_concs) <- c('concentration','area','scenario','water')

sa_check_cleaning_concs <- as.data.frame(sa_check_cleaning_w8wed_conc_list)
sa_check_cleaning_concs$area <- as.factor('cleaning')
sa_check_cleaning_concs$scenario <- as.factor('SA Check')
sa_check_cleaning_concs$water <- as.factor('Wet')
names(sa_check_cleaning_concs) <- c('concentration','area','scenario','water')

sa_check_sorting_concs <- as.data.frame(sa_check_sorting_w8wed_conc_list)
sa_check_sorting_concs$area <- as.factor('sorting')
sa_check_sorting_concs$scenario <- as.factor('SA Check')
sa_check_sorting_concs$water <- as.factor('Dry')
names(sa_check_sorting_concs) <- c('concentration','area','scenario','water')

sa_check_reject_concs <- as.data.frame(sa_check_reject_w8wed_conc_list)
sa_check_reject_concs$area <- as.factor('reject')
sa_check_reject_concs$scenario <- as.factor('SA Check')
sa_check_reject_concs$water <- as.factor('Dry')
names(sa_check_reject_concs) <- c('concentration','area','scenario','water')

sa_check_tray_packing_concs <- as.data.frame(sa_check_tray_packing_w8wed_conc_list)
sa_check_tray_packing_concs$area <- as.factor('tray packing')
sa_check_tray_packing_concs$scenario <- as.factor('SA Check')
sa_check_tray_packing_concs$water <- as.factor('Dry')
names(sa_check_tray_packing_concs) <- c('concentration','area','scenario','water')

sa_check_other_concs <- as.data.frame(sa_check_other_w8wed_conc_list)
sa_check_other_concs$area <- as.factor('other')
sa_check_other_concs$scenario <- as.factor('SA Check')
sa_check_other_concs$water <- as.factor('Dry')
names(sa_check_other_concs) <- c('concentration','area','scenario','water')

sa_check_w8wed_concs <- rbind(sa_check_loading_concs,sa_check_cleaning_concs,sa_check_sorting_concs,sa_check_tray_packing_concs,sa_check_reject_concs,sa_check_other_concs)

sa_check_loading_prev <- as.data.frame(NL_table_sa_check$loading_w8wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_loading_prev$area <- as.factor('loading')
sa_check_loading_prev$scenario <- as.factor('SA Check')
sa_check_loading_prev$water <- as.factor('Wet')
names(sa_check_loading_prev) <- c('prevalence','area','scenario','water')

sa_check_cleaning_prev <- as.data.frame(NL_table_sa_check$cleaning_w8wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_cleaning_prev$area <- as.factor('cleaning')
sa_check_cleaning_prev$scenario <- as.factor('SA Check')
sa_check_cleaning_prev$water <- as.factor('Wet')
names(sa_check_cleaning_prev) <- c('prevalence','area','scenario','water')

sa_check_sorting_prev <- as.data.frame(NL_table_sa_check$sorting_w8wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_sorting_prev$area <- as.factor('sorting')
sa_check_sorting_prev$scenario <- as.factor('SA Check')
sa_check_sorting_prev$water <- as.factor('Dry')
names(sa_check_sorting_prev) <- c('prevalence','area','scenario','water')

sa_check_reject_prev <- as.data.frame(NL_table_sa_check$reject_w8wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_reject_prev$area <- as.factor('reject')
sa_check_reject_prev$scenario <- as.factor('SA Check')
sa_check_reject_prev$water <- as.factor('Dry')
names(sa_check_reject_prev) <- c('prevalence','area','scenario','water')

sa_check_tray_packing_prev <- as.data.frame(NL_table_sa_check$tray_packing_w8wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_tray_packing_prev$area <- as.factor('tray packing')
sa_check_tray_packing_prev$scenario <- as.factor('SA Check')
sa_check_tray_packing_prev$water <- as.factor('Dry')
names(sa_check_tray_packing_prev) <- c('prevalence','area','scenario','water')

sa_check_other_prev <- as.data.frame(NL_table_sa_check$other_w8wed_prev[order(NL_table_sa_check$local_seed)])
sa_check_other_prev$area <- as.factor('other')
sa_check_other_prev$scenario <- as.factor('SA Check')
sa_check_other_prev$water <- as.factor('Dry')
names(sa_check_other_prev) <- c('prevalence','area','scenario','water')

sa_check_w8wed_prev <- rbind(sa_check_loading_prev,sa_check_cleaning_prev,sa_check_sorting_prev,sa_check_tray_packing_prev,sa_check_reject_prev,sa_check_other_prev)

sa_check_w8wed_wet_prev <- as.data.frame(sa_check_loading_prev$prevalence*21/100+sa_check_cleaning_prev$prevalence*28/100)/49*100
sa_check_w8wed_wet_prev$scenario <- as.factor('SA Check')
sa_check_w8wed_wet_prev$water <- as.factor('Wet')
names(sa_check_w8wed_wet_prev) <- c('prevalence','scenario','water')

sa_check_w8wed_dry_prev <- as.data.frame(sa_check_sorting_prev$prevalence*20/100+sa_check_reject_prev$prevalence*23/100+sa_check_tray_packing_prev$prevalence*123/100+sa_check_other_prev$prevalence*10/100)/176*100
sa_check_w8wed_dry_prev$scenario <- as.factor('SA Check')
sa_check_w8wed_dry_prev$water <- as.factor('Dry')
names(sa_check_w8wed_dry_prev) <- c('prevalence','scenario','water')

sa_check_w8wed_recombined_prev <- rbind(sa_check_w8wed_wet_prev, sa_check_w8wed_dry_prev)

vector <- NL_table_sa_check$lifetime_conc_list[order(NL_table_sa_check$run_number)]
i <- 1
matrix_1 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
i <- i+1
matrix_2 <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
mdarray <- abind(matrix_1, matrix_2, along = 3)
i <- i+1
while (i<=length(vector)) {
  matrix_n <- matrix(unlist(as.numeric(as.vector(strsplit(gsub('\\[|\\]', '', as.character(vector[i])), "\\s+")[[1]]))), ncol = 1343, byrow = TRUE)
  mdarray <- abind(mdarray, matrix_n, along = 3)
  i <- i+1
}

sa_check_w1wed_recombined_prev$week <- as.factor(1)
sa_check_w2wed_recombined_prev$week <- as.factor(2)
sa_check_w3wed_recombined_prev$week <- as.factor(3)
sa_check_w4wed_recombined_prev$week <- as.factor(4)
sa_check_w5wed_recombined_prev$week <- as.factor(5)
sa_check_w6wed_recombined_prev$week <- as.factor(6)
sa_check_w7wed_recombined_prev$week <- as.factor(7)
sa_check_w8wed_recombined_prev$week <- as.factor(8)
sa_check_allwed_prev <- rbind(sa_check_w1wed_recombined_prev,sa_check_w2wed_recombined_prev,sa_check_w3wed_recombined_prev,sa_check_w4wed_recombined_prev,sa_check_w5wed_recombined_prev,sa_check_w6wed_recombined_prev,sa_check_w7wed_recombined_prev,sa_check_w8wed_recombined_prev)

# Facility_B_sa_check_agents_melted <- melt(mdarray)
# colnames(Facility_B_sa_check_agents_melted) <- c("agent", "tick", "iteration", "value")
# Facility_B_sa_check_agents_melted$agent <- Facility_B_sa_check_agents_melted$agent-1
# Facility_B_sa_check_agents_melted$logical <- Facility_B_sa_check_agents_melted$value>0
# Facility_B_sa_check_agents_melted$binary <- as.numeric(Facility_B_sa_check_agents_melted$logical)
# Facility_B_sa_check_agents_melted$log10value <- log10(Facility_B_sa_check_agents_melted$value)
# Facility_B_sa_check_agents_melted$log10value[is.infinite(Facility_B_sa_check_agents_melted$log10value)] <- 0
# 
# agent <- Facility_B_sa_check_agents_melted$agent
# iteration <- Facility_B_sa_check_agents_melted$iteration
# tick <- Facility_B_sa_check_agents_melted$tick
# rle_matrix <- tapply(Facility_B_sa_check_agents_melted$binary, list(agent, iteration), rle)
# Facility_B_sa_check_mean_value_matrix <- tapply(Facility_B_sa_check_agents_melted$value, list(agent, tick), mean)
# Facility_B_sa_check_median_value_matrix <- tapply(Facility_B_sa_check_agents_melted$value, list(agent, tick), median)
# x <- Facility_B_sa_check_agents_melted
# x$value[x$value==0] <- NA
# Facility_B_sa_check_pos_median_value_matrix <- tapply(x$value, list(agent, tick), median, na.rm=TRUE)
# Facility_B_sa_check_prob_value_matrix <- tapply(Facility_B_sa_check_agents_melted$binary, list(agent, tick), sum)/100
# 
# durations <- data.frame(
#   duration=integer(),
#   agent=integer(),
#   iteration=integer(),
#   stringsAsFactors=FALSE
# )

# #Maximum sensitivity####
# agent <- 1
# while(agent<=225) {
#   iteration <- 1
#   while(iteration<=100) {
#     if(any(rle_matrix[agent,iteration][[1]]$values>0)) {
#       df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
#       colnames(df) <- c('duration', 'agent', 'iteration')
#       durations <- rbind(durations, df)
#     }
#     iteration <- iteration + 1
#   }
#   agent <- agent+1
# }
# 
# Facility_B_durations_sa_check <- durations
# 
# agents_list_sa_check <- read.table(paste0(getwd(),'/Data/Agents - No Niches.txt'))
# agents_list_sa_check <- agents_list_sa_check[,c("V1","V7","V8","V9")]
# colnames(agents_list_sa_check) <- c("name","sanitation_status","schedule","area")
# #Time to persistence
# agents_list_sa_check$time_to_persistence <- rep((168*2),225)
# agents_list_sa_check$time_to_persistence[agents_list_sa_check$schedule=="daily"] <- (24*2)
# 
# persistent_short_durations_list_sa_check <- data.frame()
# persistent_long_durations_list_sa_check <- data.frame()
# persistent_uncleanable_durations_list_sa_check <- data.frame()
# transient_short_durations_list_sa_check <- data.frame()
# transient_long_durations_list_sa_check <- data.frame()
# transient_uncleanable_durations_list_sa_check <- data.frame()
# agent <- 1
# while(agent<=225) {
#   ##All Durations####
#   #Minimum Contamination Duration
#   agents_list_sa_check$min_duration[agent] <- ifelse(length(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent])==0,NA,min(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent], na.rm = TRUE))
#   #Mean Contamination Duration
#   agents_list_sa_check$mean_duration[agent] <- ifelse(length(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent])==0,NA,mean(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent], na.rm = TRUE))
#   #Median Contamination Duration
#   agents_list_sa_check$median_duration[agent] <- ifelse(length(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent])==0,NA,median(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent], na.rm = TRUE))
#   #Maximum Contamination Duration
#   agents_list_sa_check$max_duration[agent] <- ifelse(length(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent])==0,NA,max(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent], na.rm = TRUE))
#   #Times Contaminated
#   #Count number of events for that agent
#   agents_list_sa_check$contamination_events[agent] <- sum(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent]>0)
#   #Times Persistent
#   #Count number of events for that agent that exceed time to persistence
#   agents_list_sa_check$times_persistent[agent] <- sum(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent]>agents_list_sa_check$time_to_persistence[agent])
#   #Lower Duration Quartile
#   agents_list_sa_check$q1_duration[agent] <- quantile(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent])[2]
#   #Upper Duration Quartile
#   agents_list_sa_check$q3_duration[agent] <- quantile(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent])[4]
#   #Persistent Durations####
#   #Minimum Persistent Contamination Duration
#   agents_list_sa_check$min_persistent_duration[agent] <- ifelse((length(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent])==0) || (agents_list_sa_check$times_persistent[agent]==0),NA,min(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent & Facility_B_durations_sa_check$duration>=agents_list_sa_check$time_to_persistence[agent]], na.rm = TRUE))
#   #Mean Persistent Contamination Duration
#   agents_list_sa_check$mean_persistent_duration[agent] <- ifelse((length(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent])==0) || (agents_list_sa_check$times_persistent[agent]==0),NA,mean(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent & Facility_B_durations_sa_check$duration>=agents_list_sa_check$time_to_persistence[agent]], na.rm = TRUE))
#   #Median Persistent Contamination Duration
#   agents_list_sa_check$median_persistent_duration[agent] <- ifelse((length(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent])==0) || (agents_list_sa_check$times_persistent[agent]==0),NA,median(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent & Facility_B_durations_sa_check$duration>=agents_list_sa_check$time_to_persistence[agent]], na.rm = TRUE))
#   #Max Persistent Contamination Duration
#   agents_list_sa_check$max_persistent_duration[agent] <- ifelse((length(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent])==0) || (agents_list_sa_check$times_persistent[agent]==0),NA,max(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent & Facility_B_durations_sa_check$duration>=agents_list_sa_check$time_to_persistence[agent]], na.rm = TRUE))
#   #Lower Duration Quartile Persistent Contamination Duration
#   agents_list_sa_check$q1_persistent_duration[agent] <- ifelse((length(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent])==0) || (agents_list_sa_check$times_persistent[agent]==0),NA,quantile(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent & Facility_B_durations_sa_check$duration>=agents_list_sa_check$time_to_persistence[agent]])[2])
#   #Upper Duration Quartile Persistent Contamination Duration
#   agents_list_sa_check$q3_persistent_duration[agent] <- ifelse((length(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent])==0) || (agents_list_sa_check$times_persistent[agent]==0),NA,quantile(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent & Facility_B_durations_sa_check$duration>=agents_list_sa_check$time_to_persistence[agent]])[4])
#   #Average number of times an agent was persistently contaminated across iterations
#   x <- Facility_B_durations_sa_check[which(Facility_B_durations_sa_check$agent==agent & Facility_B_durations_sa_check$duration>agents_list_sa_check$time_to_persistence[agent]),]
#   ##Count number of times in each iteration persistence occurred for the agent and take the mean
#   agents_list_sa_check$mean_times_persistent[agent] <- mean(plyr::count(x, 'iteration')$freq)
#   agents_list_sa_check$mean_times_persistent[which(is.na(agents_list_sa_check$mean_times_persistent))] <- 0
#   #Division by total number of iterations in simulation
#   agents_list_sa_check$balanced_times_persistent[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
#   if((length(Facility_B_durations_sa_check$duration[Facility_B_durations_sa_check$agent==agent])!=0) || (agents_list_sa_check$times_persistent[agent]!=0)) {
#     #Persistent
#     if(agents_list_sa_check$time_to_persistence[agent]==48) {
#       #Short
#       persistent_short_durations_list_sa_check <- rbind(
#         persistent_short_durations_list_sa_check,
#         Facility_B_durations_sa_check[Facility_B_durations_sa_check$agent==agent & Facility_B_durations_sa_check$duration>agents_list_sa_check$time_to_persistence[agent],]
#       )
#     } else if(agents_list_sa_check$time_to_persistence[agent]==336 && agents_list_sa_check$sanitation_status[agent]==1) {
#       #Long
#       persistent_long_durations_list_sa_check <- rbind(
#         persistent_long_durations_list_sa_check,
#         Facility_B_durations_sa_check[Facility_B_durations_sa_check$agent==agent & Facility_B_durations_sa_check$duration>agents_list_sa_check$time_to_persistence[agent],]
#       )
#     } else if(agents_list_sa_check$time_to_persistence[agent]==336 && agents_list_sa_check$sanitation_status[agent]==0) {
#       #Uncleanable
#       persistent_uncleanable_durations_list_sa_check <- rbind(
#         persistent_uncleanable_durations_list_sa_check,
#         Facility_B_durations_sa_check[Facility_B_durations_sa_check$agent==agent & Facility_B_durations_sa_check$duration>agents_list_sa_check$time_to_persistence[agent],]
#       )	
#     }
#   }
#   #Transient
#   if(agents_list_sa_check$time_to_persistence[agent]==48) {
#     #Short
#     transient_short_durations_list_sa_check <- rbind(
#       transient_short_durations_list_sa_check,
#       Facility_B_durations_sa_check[Facility_B_durations_sa_check$agent==agent & Facility_B_durations_sa_check$duration<=agents_list_sa_check$time_to_persistence[agent],]
#     )
#   } else if(agents_list_sa_check$time_to_persistence[agent]==336 && agents_list_sa_check$sanitation_status[agent]==1) {
#     #Long
#     transient_long_durations_list_sa_check <- rbind(
#       transient_long_durations_list_sa_check,
#       Facility_B_durations_sa_check[Facility_B_durations_sa_check$agent==agent & Facility_B_durations_sa_check$duration<=agents_list_sa_check$time_to_persistence[agent],]
#     )
#   } else if(agents_list_sa_check$time_to_persistence[agent]==336 && agents_list_sa_check$sanitation_status[agent]==0) {
#     #Uncleanable
#     transient_uncleanable_durations_list_sa_check <- rbind(
#       transient_uncleanable_durations_list_sa_check,
#       Facility_B_durations_sa_check[Facility_B_durations_sa_check$agent==agent & Facility_B_durations_sa_check$duration<=agents_list_sa_check$time_to_persistence[agent],]
#     )	
#   }
#   agent <- agent+1
# }
# 
# #10 cells minimum####
# agent <- 1
# while(agent<=225) {
#   iteration <- 1
#   while(iteration<=100) {
#     if(any(rle_matrix[agent,iteration][[1]]$values>9)) {
#       df <- cbind(as.data.frame(rle_matrix[agent,iteration][[1]]$lengths[rle_matrix[agent,iteration][[1]]$values>0]),agent,iteration)
#       colnames(df) <- c('duration', 'agent', 'iteration')
#       durations <- rbind(durations, df)
#     }
#     iteration <- iteration + 1
#   }
#   agent <- agent+1
# }
# 
# Facility_B_durations_sa_check_10min <- durations
# 
# persistent_short_durations_list_sa_check_10min <- data.frame()
# persistent_long_durations_list_sa_check_10min <- data.frame()
# persistent_uncleanable_durations_list_sa_check_10min <- data.frame()
# transient_short_durations_list_sa_check_10min <- data.frame()
# transient_long_durations_list_sa_check_10min <- data.frame()
# transient_uncleanable_durations_list_sa_check_10min <- data.frame()
# agent <- 1
# while(agent<=225) {
#   ##All Durations####
#   #Minimum Contamination Duration
#   agents_list_sa_check$min_duration_10min[agent] <- ifelse(length(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent])==0,NA,min(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent], na.rm = TRUE))
#   #Mean Contamination Duration
#   agents_list_sa_check$mean_duration_10min[agent] <- ifelse(length(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent])==0,NA,mean(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent], na.rm = TRUE))
#   #Median Contamination Duration
#   agents_list_sa_check$median_duration_10min[agent] <- ifelse(length(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent])==0,NA,median(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent], na.rm = TRUE))
#   #Maximum Contamination Duration
#   agents_list_sa_check$max_duration_10min[agent] <- ifelse(length(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent])==0,NA,max(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent], na.rm = TRUE))
#   #Times Contaminated
#   #Count number of events for that agent
#   agents_list_sa_check$contamination_events_10min[agent] <- sum(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent]>0)
#   #Times Persistent
#   #Count number of events for that agent that exceed time to persistence
#   agents_list_sa_check$times_persistent_10min[agent] <- sum(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent]>agents_list_sa_check$time_to_persistence[agent])
#   #Lower Duration Quartile
#   agents_list_sa_check$q1_duration_10min[agent] <- quantile(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent])[2]
#   #Upper Duration Quartile
#   agents_list_sa_check$q3_duration_10min[agent] <- quantile(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent])[4]
#   #Persistent Durations####
#   #Minimum Persistent Contamination Duration
#   agents_list_sa_check$min_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent])==0) || (agents_list_sa_check$times_persistent_10min[agent]==0),NA,min(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent & Facility_B_durations_sa_check_10min$duration>=agents_list_sa_check$time_to_persistence[agent]], na.rm = TRUE))
#   #Mean Persistent Contamination Duration
#   agents_list_sa_check$mean_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent])==0) || (agents_list_sa_check$times_persistent_10min[agent]==0),NA,mean(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent & Facility_B_durations_sa_check_10min$duration>=agents_list_sa_check$time_to_persistence[agent]], na.rm = TRUE))
#   #Median Persistent Contamination Duration
#   agents_list_sa_check$median_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent])==0) || (agents_list_sa_check$times_persistent_10min[agent]==0),NA,median(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent & Facility_B_durations_sa_check_10min$duration>=agents_list_sa_check$time_to_persistence[agent]], na.rm = TRUE))
#   #Max Persistent Contamination Duration
#   agents_list_sa_check$max_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent])==0) || (agents_list_sa_check$times_persistent_10min[agent]==0),NA,max(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent & Facility_B_durations_sa_check_10min$duration>=agents_list_sa_check$time_to_persistence[agent]], na.rm = TRUE))
#   #Lower Duration Quartile Persistent Contamination Duration
#   agents_list_sa_check$q1_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent])==0) || (agents_list_sa_check$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent & Facility_B_durations_sa_check_10min$duration>=agents_list_sa_check$time_to_persistence[agent]])[2])
#   #Upper Duration Quartile Persistent Contamination Duration
#   agents_list_sa_check$q3_persistent_duration_10min[agent] <- ifelse((length(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent])==0) || (agents_list_sa_check$times_persistent_10min[agent]==0),NA,quantile(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent & Facility_B_durations_sa_check_10min$duration>=agents_list_sa_check$time_to_persistence[agent]])[4])
#   #Average number of times an agent was persistently contaminated across iterations (Does not account for iterations with 0 events)
#   x <- Facility_B_durations_sa_check_10min[which(Facility_B_durations_sa_check_10min$agent==agent & Facility_B_durations_sa_check_10min$duration>agents_list_sa_check$time_to_persistence[agent]),]
#   ##Count number of times in each iteration persistence occurred for the agent and take the mean (Does account for iterations with 0 events)
#   agents_list_sa_check$mean_times_persistent_10min[agent] <- mean(plyr::count(x, 'iteration')$freq)
#   agents_list_sa_check$mean_times_persistent_10min[which(is.na(agents_list_sa_check$mean_times_persistent_10min))] <- 0
#   #Division by total number of iterations in simulation
#   agents_list_sa_check$balanced_times_persistent_10min[agent] <- sum(plyr::count(x, 'iteration')$freq)/100
#   if((length(Facility_B_durations_sa_check_10min$duration[Facility_B_durations_sa_check_10min$agent==agent])!=0) || (agents_list_sa_check$times_persistent[agent]!=0)) {
#     #Persistent
#     if(agents_list_sa_check$time_to_persistence[agent]==48) {
#       #Short
#       persistent_short_durations_list_sa_check_10min <- rbind(
#         persistent_short_durations_list_sa_check_10min,
#         Facility_B_durations_sa_check_10min[Facility_B_durations_sa_check_10min$agent==agent & Facility_B_durations_sa_check_10min$duration>agents_list_sa_check$time_to_persistence[agent],]
#       )
#     } else if(agents_list_sa_check$time_to_persistence[agent]==336 && agents_list_sa_check$sanitation_status[agent]==1) {
#       #Long
#       persistent_long_durations_list_sa_check_10min <- rbind(
#         persistent_long_durations_list_sa_check_10min,
#         Facility_B_durations_sa_check_10min[Facility_B_durations_sa_check_10min$agent==agent & Facility_B_durations_sa_check_10min$duration>agents_list_sa_check$time_to_persistence[agent],]
#       )
#     } else if(agents_list_sa_check$time_to_persistence[agent]==336 && agents_list_sa_check$sanitation_status[agent]==0) {
#       #Uncleanable
#       persistent_uncleanable_durations_list_sa_check_10min <- rbind(
#         persistent_uncleanable_durations_list_sa_check_10min,
#         Facility_B_durations_sa_check_10min[Facility_B_durations_sa_check_10min$agent==agent & Facility_B_durations_sa_check_10min$duration>agents_list_sa_check$time_to_persistence[agent],]
#       )	
#     }
#   }
#   #Transient
#   if(agents_list_sa_check$time_to_persistence[agent]==48) {
#     #Short
#     transient_short_durations_list_sa_check_10min <- rbind(
#       transient_short_durations_list_sa_check_10min,
#       Facility_B_durations_sa_check_10min[Facility_B_durations_sa_check_10min$agent==agent & Facility_B_durations_sa_check_10min$duration<=agents_list_sa_check$time_to_persistence[agent],]
#     )
#   } else if(agents_list_sa_check$time_to_persistence[agent]==336 && agents_list_sa_check$sanitation_status[agent]==1) {
#     #Long
#     transient_long_durations_list_sa_check_10min <- rbind(
#       transient_long_durations_list_sa_check_10min,
#       Facility_B_durations_sa_check_10min[Facility_B_durations_sa_check_10min$agent==agent & Facility_B_durations_sa_check_10min$duration<=agents_list_sa_check$time_to_persistence[agent],]
#     )
#   } else if(agents_list_sa_check$time_to_persistence[agent]==336 && agents_list_sa_check$sanitation_status[agent]==0) {
#     #Uncleanable
#     transient_uncleanable_durations_list_sa_check_10min <- rbind(
#       transient_uncleanable_durations_list_sa_check_10min,
#       Facility_B_durations_sa_check_10min[Facility_B_durations_sa_check_10min$agent==agent & Facility_B_durations_sa_check_10min$duration<=agents_list_sa_check$time_to_persistence[agent],]
#     )	
#   }
#   agent <- agent+1
# }

# Facility_B_sa_check_agents_melted_monday_preop <- Facility_B_sa_check_agents_melted[which(Facility_B_sa_check_agents_melted$tick==33|Facility_B_sa_check_agents_melted$tick==201|Facility_B_sa_check_agents_melted$tick==369|Facility_B_sa_check_agents_melted$tick==537|Facility_B_sa_check_agents_melted$tick==705|Facility_B_sa_check_agents_melted$tick==873|Facility_B_sa_check_agents_melted$tick==1041|Facility_B_sa_check_agents_melted$tick==1209),]
# 
# Facility_B_sa_check_agents_melted_tuesday_preop <- Facility_B_sa_check_agents_melted[which(Facility_B_sa_check_agents_melted$tick==57|Facility_B_sa_check_agents_melted$tick==225|Facility_B_sa_check_agents_melted$tick==393|Facility_B_sa_check_agents_melted$tick==561|Facility_B_sa_check_agents_melted$tick==729|Facility_B_sa_check_agents_melted$tick==897|Facility_B_sa_check_agents_melted$tick==1065|Facility_B_sa_check_agents_melted$tick==1233),]
# 
# Facility_B_sa_check_agents_melted_wednesday_preop <- Facility_B_sa_check_agents_melted[which(Facility_B_sa_check_agents_melted$tick==81|Facility_B_sa_check_agents_melted$tick==249|Facility_B_sa_check_agents_melted$tick==417|Facility_B_sa_check_agents_melted$tick==585|Facility_B_sa_check_agents_melted$tick==753|Facility_B_sa_check_agents_melted$tick==921|Facility_B_sa_check_agents_melted$tick==1089|Facility_B_sa_check_agents_melted$tick==1257),]
# 
# Facility_B_sa_check_agents_melted_thursday_preop <- Facility_B_sa_check_agents_melted[which(Facility_B_sa_check_agents_melted$tick==105|Facility_B_sa_check_agents_melted$tick==273|Facility_B_sa_check_agents_melted$tick==441|Facility_B_sa_check_agents_melted$tick==609|Facility_B_sa_check_agents_melted$tick==777|Facility_B_sa_check_agents_melted$tick==945|Facility_B_sa_check_agents_melted$tick==1113|Facility_B_sa_check_agents_melted$tick==1281),]
# 
# Facility_B_sa_check_agents_melted_friday_preop <- Facility_B_sa_check_agents_melted[which(Facility_B_sa_check_agents_melted$tick==129|Facility_B_sa_check_agents_melted$tick==297|Facility_B_sa_check_agents_melted$tick==465|Facility_B_sa_check_agents_melted$tick==633|Facility_B_sa_check_agents_melted$tick==801|Facility_B_sa_check_agents_melted$tick==969|Facility_B_sa_check_agents_melted$tick==1137|Facility_B_sa_check_agents_melted$tick==1305),]

# Facility_B_sa_check_agents_melted_ff <- as.ffdf(Facility_B_sa_check_agents_melted)
# rm(Facility_B_sa_check_agents_melted)
gc()
```

```{r Model-wide Midday Sampling Sensitivity Analysis Week 1-8 New Gamma/Delta}
#Subset data with model-wide midday sampling prevalence
header_list <- c('spread_tc','crate_prevalence','food_conc','food_tc','zone4_load','random_load','san_reduction','prob_cleanable','p_patch_spread','p_water_spread','p_food_dropped','p_condensation','p_random_noise','p_zone4_intro','p11','p12','p13','p14','p21','p22','p23','p24','p31','p32','p33','p34','p41','p42','p43','p44','tc11','tc12','tc13','tc14','tc21','tc22','tc23','tc24','tc31','tc32','tc33','tc34','tc41','tc42','tc43','tc44')

all_prevs <- rowSums(new_gd_w1wed_conc_matrix>0)/225*100
data_sub <- data.frame(cbind(NL_table_new_gd[header_list],all_prevs))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$est,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
# print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
# print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)[2:3]
data_matrix_melted <- transform(data_matrix_melted, variable=reorder(Var2, value))
ggplot(data_matrix_melted, aes(x = variable, y = value)) +
  geom_bar(stat = "identity") +
  ggtitle('A') +
  xlab('') +
  ylab('') +
  ylim(-0.5,1.0) +
  coord_flip() +
  geom_hline(yintercept = 0)

#ggplot of significant - Confirm custom labels
# ordered_data_matrix_melted <- reshape2::melt(data_matrix)[2:3]
# ordered_data_matrix_melted <- transform(ordered_data_matrix_melted, variable=reorder(Var2, value))
# ggplot(ordered_data_matrix_melted, aes(x = variable, y = value)) +
#   geom_bar(stat = "identity") +
#   ggtitle('A') +
#   xlab('') +
#   ylab('') +
#   ylim(-0.25,0.75) +
#   coord_flip() +
#   geom_hline(yintercept = 0) +
#   scale_x_discrete(labels = c(expression(tau[33]),expression("P"["r"]),expression(tau[11]),expression(alpha),expression("P"["z"]),expression("P"[33]),expression("R"["d"]),expression("P"[11]),expression("N"["R"])))
# ggsave("Fig 4_A.tiff", device = "tiff", dpi = 600)

all_prevs <- rowSums(new_gd_w2wed_conc_matrix>0)/225*100
data_sub <- data.frame(cbind(NL_table_new_gd[header_list],all_prevs))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$est,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
# print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
# print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)[2:3]
data_matrix_melted <- transform(data_matrix_melted, variable=reorder(Var2, value))
ggplot(data_matrix_melted, aes(x = variable, y = value)) +
  geom_bar(stat = "identity") +
  ggtitle('B') +
  xlab('') +
  ylab('') +
  ylim(-0.5,1.0) +
  coord_flip() +
  geom_hline(yintercept = 0)

#ggplot of significant - Confirm custom labels
# ordered_data_matrix_melted <- reshape2::melt(data_matrix)[2:3]
# ordered_data_matrix_melted <- transform(ordered_data_matrix_melted, variable=reorder(Var2, value))
# ggplot(ordered_data_matrix_melted, aes(x = variable, y = value)) +
#   geom_bar(stat = "identity") +
#   ggtitle('A') +
#   xlab('') +
#   ylab('') +
#   ylim(-0.25,0.75) +
#   coord_flip() +
#   geom_hline(yintercept = 0) +
#   scale_x_discrete(labels = c(expression(tau[33]),expression("P"["r"]),expression(tau[11]),expression(alpha),expression("P"["z"]),expression("P"[33]),expression("R"["d"]),expression("P"[11]),expression("N"["R"])))
# ggsave("Fig 4_A.tiff", device = "tiff", dpi = 600)

all_prevs <- rowSums(new_gd_w3wed_conc_matrix>0)/225*100
data_sub <- data.frame(cbind(NL_table_new_gd[header_list],all_prevs))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$est,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
# print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
# print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)[2:3]
data_matrix_melted <- transform(data_matrix_melted, variable=reorder(Var2, value))
ggplot(data_matrix_melted, aes(x = variable, y = value)) +
  geom_bar(stat = "identity") +
  ggtitle('C') +
  xlab('') +
  ylab('') +
  ylim(-0.5,1.0) +
  coord_flip() +
  geom_hline(yintercept = 0)

#ggplot of significant - Confirm custom labels
# ordered_data_matrix_melted <- reshape2::melt(data_matrix)[2:3]
# ordered_data_matrix_melted <- transform(ordered_data_matrix_melted, variable=reorder(Var2, value))
# ggplot(ordered_data_matrix_melted, aes(x = variable, y = value)) +
#   geom_bar(stat = "identity") +
#   ggtitle('A') +
#   xlab('') +
#   ylab('') +
#   ylim(-0.25,0.75) +
#   coord_flip() +
#   geom_hline(yintercept = 0) +
#   scale_x_discrete(labels = c(expression(tau[33]),expression("P"["r"]),expression(tau[11]),expression(alpha),expression("P"["z"]),expression("P"[33]),expression("R"["d"]),expression("P"[11]),expression("N"["R"])))
# ggsave("Fig 4_A.tiff", device = "tiff", dpi = 600)

all_prevs <- rowSums(new_gd_w4wed_conc_matrix>0)/225*100
data_sub <- data.frame(cbind(NL_table_new_gd[header_list],all_prevs))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$est,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
# print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
# print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)[2:3]
data_matrix_melted <- transform(data_matrix_melted, variable=reorder(Var2, value))
ggplot(data_matrix_melted, aes(x = variable, y = value)) +
  geom_bar(stat = "identity") +
  ggtitle('D') +
  xlab('') +
  ylab('') +
  ylim(-0.5,1.0) +
  coord_flip() +
  geom_hline(yintercept = 0)

#ggplot of significant - Confirm custom labels
# ordered_data_matrix_melted <- reshape2::melt(data_matrix)[2:3]
# ordered_data_matrix_melted <- transform(ordered_data_matrix_melted, variable=reorder(Var2, value))
# ggplot(ordered_data_matrix_melted, aes(x = variable, y = value)) +
#   geom_bar(stat = "identity") +
#   ggtitle('A') +
#   xlab('') +
#   ylab('') +
#   ylim(-0.25,0.75) +
#   coord_flip() +
#   geom_hline(yintercept = 0) +
#   scale_x_discrete(labels = c(expression(tau[33]),expression("P"["r"]),expression(tau[11]),expression(alpha),expression("P"["z"]),expression("P"[33]),expression("R"["d"]),expression("P"[11]),expression("N"["R"])))
# ggsave("Fig 4_A.tiff", device = "tiff", dpi = 600)

all_prevs <- rowSums(new_gd_w5wed_conc_matrix>0)/225*100
data_sub <- data.frame(cbind(NL_table_new_gd[header_list],all_prevs))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$est,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
# print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
# print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)[2:3]
data_matrix_melted <- transform(data_matrix_melted, variable=reorder(Var2, value))
ggplot(data_matrix_melted, aes(x = variable, y = value)) +
  geom_bar(stat = "identity") +
  ggtitle('E') +
  xlab('') +
  ylab('') +
  ylim(-0.5,1.0) +
  coord_flip() +
  geom_hline(yintercept = 0)

#ggplot of significant - Confirm custom labels
# ordered_data_matrix_melted <- reshape2::melt(data_matrix)[2:3]
# ordered_data_matrix_melted <- transform(ordered_data_matrix_melted, variable=reorder(Var2, value))
# ggplot(ordered_data_matrix_melted, aes(x = variable, y = value)) +
#   geom_bar(stat = "identity") +
#   ggtitle('A') +
#   xlab('') +
#   ylab('') +
#   ylim(-0.25,0.75) +
#   coord_flip() +
#   geom_hline(yintercept = 0) +
#   scale_x_discrete(labels = c(expression(tau[33]),expression("P"["r"]),expression(tau[11]),expression(alpha),expression("P"["z"]),expression("P"[33]),expression("R"["d"]),expression("P"[11]),expression("N"["R"])))
# ggsave("Fig 4_A.tiff", device = "tiff", dpi = 600)

all_prevs <- rowSums(new_gd_w6wed_conc_matrix>0)/225*100
data_sub <- data.frame(cbind(NL_table_new_gd[header_list],all_prevs))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$est,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
# print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
# print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)[2:3]
data_matrix_melted <- transform(data_matrix_melted, variable=reorder(Var2, value))
ggplot(data_matrix_melted, aes(x = variable, y = value)) +
  geom_bar(stat = "identity") +
  ggtitle('F') +
  xlab('') +
  ylab('') +
  ylim(-0.5,1.0) +
  coord_flip() +
  geom_hline(yintercept = 0)

#ggplot of significant - Confirm custom labels
# ordered_data_matrix_melted <- reshape2::melt(data_matrix)[2:3]
# ordered_data_matrix_melted <- transform(ordered_data_matrix_melted, variable=reorder(Var2, value))
# ggplot(ordered_data_matrix_melted, aes(x = variable, y = value)) +
#   geom_bar(stat = "identity") +
#   ggtitle('A') +
#   xlab('') +
#   ylab('') +
#   ylim(-0.25,0.75) +
#   coord_flip() +
#   geom_hline(yintercept = 0) +
#   scale_x_discrete(labels = c(expression(tau[33]),expression("P"["r"]),expression(tau[11]),expression(alpha),expression("P"["z"]),expression("P"[33]),expression("R"["d"]),expression("P"[11]),expression("N"["R"])))
# ggsave("Fig 4_A.tiff", device = "tiff", dpi = 600)

all_prevs <- rowSums(new_gd_w7wed_conc_matrix>0)/225*100
data_sub <- data.frame(cbind(NL_table_new_gd[header_list],all_prevs))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$est,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
# print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
# print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)[2:3]
data_matrix_melted <- transform(data_matrix_melted, variable=reorder(Var2, value))
ggplot(data_matrix_melted, aes(x = variable, y = value)) +
  geom_bar(stat = "identity") +
  ggtitle('G') +
  xlab('') +
  ylab('') +
  ylim(-0.5,1.0) +
  coord_flip() +
  geom_hline(yintercept = 0)

#ggplot of significant - Confirm custom labels
# ordered_data_matrix_melted <- reshape2::melt(data_matrix)[2:3]
# ordered_data_matrix_melted <- transform(ordered_data_matrix_melted, variable=reorder(Var2, value))
# ggplot(ordered_data_matrix_melted, aes(x = variable, y = value)) +
#   geom_bar(stat = "identity") +
#   ggtitle('A') +
#   xlab('') +
#   ylab('') +
#   ylim(-0.25,0.75) +
#   coord_flip() +
#   geom_hline(yintercept = 0) +
#   scale_x_discrete(labels = c(expression(tau[33]),expression("P"["r"]),expression(tau[11]),expression(alpha),expression("P"["z"]),expression("P"[33]),expression("R"["d"]),expression("P"[11]),expression("N"["R"])))
# ggsave("Fig 4_A.tiff", device = "tiff", dpi = 600)

all_prevs <- rowSums(new_gd_w8wed_conc_matrix>0)/225*100
data_sub <- data.frame(cbind(NL_table_new_gd[header_list],all_prevs))

z <- epi.prcc(data_sub, sided.test = 2)
prcc <- data.frame(cbind(z$est,z$p.value))
rownames(prcc) <- colnames(data_sub[,1:length(header_list)])
colnames(prcc) <- (c("PRCC", "p.Value"))
# print(prcc)

prcc$abs <- abs(prcc$PRCC)
new_prcc <- prcc[order(prcc$abs),]
data_matrix <- matrix(c(new_prcc$PRCC), ncol=length(header_list))
colnames(data_matrix) <- rownames(new_prcc)
sig_prcc<-subset(prcc, p.Value<(0.05/length(header_list)))
sig_prcc$abs<-abs(sig_prcc$PRCC)
# print(sig_prcc)
# new_sig_prcc<-sig_prcc[order(sig_prcc$abs),]
new_sig_prcc<-sig_prcc
data_matrix <- matrix(c(new_sig_prcc$PRCC), ncol=length(new_sig_prcc$PRCC))
colnames(data_matrix) <- rownames(new_sig_prcc)

#ggplot of significant
data_matrix_melted <- reshape2::melt(data_matrix)[2:3]
data_matrix_melted <- transform(data_matrix_melted, variable=reorder(Var2, value))
ggplot(data_matrix_melted, aes(x = variable, y = value)) +
  geom_bar(stat = "identity") +
  ggtitle('B') +
  xlab('') +
  ylab('') +
  ylim(-0.5,1.0) +
  coord_flip() +
  geom_hline(yintercept = 0) +
  scale_x_discrete(labels = c(expression(tau[33]),expression("P"[13]),expression("P"["Z"]),expression("N"["r"]),expression("P"[31]),expression(tau[11]),expression(alpha),expression("R"["d"]),expression("P"[11]),expression("N"["R"])))

#ggplot of significant - Confirm custom labels
# ordered_data_matrix_melted <- reshape2::melt(data_matrix)[2:3]
# ordered_data_matrix_melted <- transform(ordered_data_matrix_melted, variable=reorder(Var2, value))
# ggplot(ordered_data_matrix_melted, aes(x = variable, y = value)) +
#   geom_bar(stat = "identity") +
#   ggtitle('A') +
#   xlab('') +
#   ylab('') +
#   ylim(-0.25,0.75) +
#   coord_flip() +
#   geom_hline(yintercept = 0) +
#   scale_x_discrete(labels = c(expression(tau[33]),expression("P"["r"]),expression(tau[11]),expression(alpha),expression("P"["z"]),expression("P"[33]),expression("R"["d"]),expression("P"[11]),expression("N"["R"])))
# ggsave("Fig 4_A.tiff", device = "tiff", dpi = 600)
```

```{r Figure 1 and Figure 2 (And others)}
figure <- ggarrange(ggplot(baseline_allwed_prev, aes(x=week, y=prevalence, fill=water)) + 
                      geom_boxplot() +
                      xlab('') +
                      ylab('Prevalence %') +
                      ylim(0,100) +
                      # ggtitle("B") +
                      # scale_fill_manual(values=c("#0C7BDC","#FFC20A")) +
                      scale_fill_manual(values=c("black","white")) +
                      theme_bw() +
                      theme(
                        legend.position = "none",
                        axis.text.x = element_text(size = 16, angle = 0, hjust = .5, vjust = .5, face = "plain"),
                        axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
                        axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")
                      )
)
annotate_figure(
  figure,fig.lab = "B",
  fig.lab.face = "bold",
  bottom = text_grob("Week", size = 20, y = 1)
)

figure <- ggarrange(ggplot(rbind(baseline_allwed_concs), aes(x=week, y=log10(concentration), fill=water)) + 
                      geom_boxplot() +
                      xlab('') +
                      ylab(expression(Log["10"]*" CFU/cm sq.")) +
                      ylim(-10,10) +
                      # ggtitle("D") +
                      # scale_fill_manual(values=c("#0C7BDC","#FFC20A")) +
                      scale_fill_manual(values=c("black","white")) +
                      theme_bw() +
                      theme(
                        legend.position = "none",axis.text.x = element_text(size = 16, angle = 0, hjust = .5, vjust = .5, face = "plain"),
                        axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
                        axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")
                      )
)
annotate_figure(
  figure,fig.lab = "D",
  fig.lab.face = "bold",
  bottom = text_grob("Week", size = 20, y = 1)
)

week_plot_prev <- ggplot(rbind(baseline_w1wed_prev,baseline_w8wed_prev), aes(x=area, y=prevalence, fill=week)) +
  geom_boxplot() +
  xlab('') +
  ylab('Prevalence %') +
  ylim(0,100) +
  theme_bw() +
  # ggtitle('B') +
  # scale_fill_manual(values=c("#0C7BDC")) +
  scale_fill_manual(values=c("black","white")) +
  theme(
    legend.position = "none", 
    axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
    axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
    axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")
  )

figure <- ggarrange(week_plot_prev)
annotate_figure(
  figure,fig.lab = "B",
  fig.lab.face = "bold",
  bottom = text_grob("Area", size = 20, y = 1)
)

week_plot_concs <- ggplot(rbind(baseline_w1wed_concs,baseline_w8wed_concs), aes(x=area, y=log10(concentration), fill=week)) +
  geom_boxplot() +
  xlab('') +
  ylab(expression(Log["10"]*" CFU/cm sq.")) +
  ylim(-10,10) +
  theme_bw() +
  # ggtitle('B') +
  # scale_fill_manual(values=c("#0C7BDC")) +
  scale_fill_manual(values=c("black","white")) +
  theme(
    legend.position = "none",
    axis.text.x = element_text(size = 16, angle = 45, hjust = 1, vjust = 1, face = "plain"),
    axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
    axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")
  )

figure <- ggarrange(week_plot_concs)
annotate_figure(
  figure,fig.lab = "D",
  fig.lab.face = "bold",
  bottom = text_grob("Area", size = 20, y = 1)
)

all_prevs_allwed <- rbind(baseline_allwed_prev,crate_prev_75pc_allwed_prev,crate_prev_50pc_allwed_prev,crate_prev_25pc_allwed_prev,crate_prev_0pc_allwed_prev)

all_prevs_allwed_wet <- all_prevs_allwed[all_prevs_allwed$water=="Wet",]
all_prevs_allwed_dry <- all_prevs_allwed[all_prevs_allwed$water=="Dry",]

wet_plot <- ggplot(all_prevs_allwed_wet, aes(x=week, y=prevalence, fill=scenario)) + 
  # geom_boxplot() +
  stat_summary(fun=median, geom="line", aes(group=scenario, color = scenario))  + 
  stat_summary(fun=median, geom="point") +
  xlab('') +
  ylab('Median Prevalence %') +
  ylim(0,100) +
  # ggtitle("B") +
  # scale_fill_manual(values=c("#0C7BDC","#FFC20A")) +
  theme(legend.position = "none") +
  theme(
    axis.text.x = element_text(size = 16, angle = 0, hjust = .5, vjust = .5, face = "plain"),
    axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
    axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")
  )

figure <- ggarrange(wet_plot)
annotate_figure(
  figure,fig.lab = "B",
  fig.lab.face = "bold",
  bottom = text_grob("Week", size = 20, y = 1)
)

dry_plot <- ggplot(all_prevs_allwed_dry, aes(x=week, y=prevalence, fill=scenario)) + 
  # geom_boxplot() +
  stat_summary(fun=median, geom="line", aes(group=scenario, color = scenario))  + 
  stat_summary(fun=median, geom="point") +
  xlab('') +
  ylab('Median Prevalence %') +
  ylim(0,100) +
  # ggtitle("B") +
  # scale_fill_manual(values=c("#0C7BDC","#FFC20A")) +
  theme(legend.position = "none") +
  theme(
    axis.text.x = element_text(size = 16, angle = 0, hjust = .5, vjust = .5, face = "plain"),
    axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
    axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")
  )

figure <- ggarrange(dry_plot)
annotate_figure(
  figure,fig.lab = "D",
  fig.lab.face = "bold",
  bottom = text_grob("Week", size = 20, y = 1)
)


all_prevs_allwed <- rbind(baseline_allwed_prev,prob_intervention_allwed_prev,partial_prob_intervention_allwed_prev,connections_intervention_allwed_prev)

all_prevs_allwed_wet <- all_prevs_allwed[all_prevs_allwed$water=="Wet",]
all_prevs_allwed_dry <- all_prevs_allwed[all_prevs_allwed$water=="Dry",]

wet_plot <- ggplot(all_prevs_allwed_wet, aes(x=week, y=prevalence, fill=scenario)) + 
  # geom_boxplot() +
  stat_summary(fun=median, geom="line", aes(group=scenario, color = scenario))  + 
  stat_summary(fun=median, geom="point") +
  xlab('') +
  ylab('Median Prevalence %') +
  ylim(0,100) +
  # ggtitle("B") +
  # scale_fill_manual(values=c("#0C7BDC","#FFC20A")) +
  theme(legend.position = "none") +
  theme(
    axis.text.x = element_text(size = 16, angle = 0, hjust = .5, vjust = .5, face = "plain"),
    axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
    axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")
  )

figure <- ggarrange(wet_plot)
annotate_figure(
  figure,fig.lab = "B",
  fig.lab.face = "bold",
  bottom = text_grob("Week", size = 20, y = 1)
)

dry_plot <- ggplot(all_prevs_allwed_dry, aes(x=week, y=prevalence, fill=scenario)) + 
  # geom_boxplot() +
  stat_summary(fun=median, geom="line", aes(group=scenario, color = scenario))  + 
  stat_summary(fun=median, geom="point") +
  xlab('') +
  ylab('Median Prevalence %') +
  ylim(0,100) +
  # ggtitle("B") +
  # scale_fill_manual(values=c("#0C7BDC","#FFC20A")) +
  theme(legend.position = "none") +
  theme(
    axis.text.x = element_text(size = 16, angle = 0, hjust = .5, vjust = .5, face = "plain"),
    axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
    axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")
  )

figure <- ggarrange(dry_plot)
annotate_figure(
  figure,fig.lab = "D",
  fig.lab.face = "bold",
  bottom = text_grob("Week", size = 20, y = 1)
)

all_prevs_allwed <- rbind(baseline_allwed_prev,random_load_1_log_red_allwed_prev,random_load_2_log_red_allwed_prev,random_load_3_log_red_allwed_prev)

all_prevs_allwed_wet <- all_prevs_allwed[all_prevs_allwed$water=="Wet",]
all_prevs_allwed_dry <- all_prevs_allwed[all_prevs_allwed$water=="Dry",]

wet_plot <- ggplot(all_prevs_allwed_wet, aes(x=week, y=prevalence, fill=scenario)) + 
  # geom_boxplot() +
  stat_summary(fun=median, geom="line", aes(group=scenario, color = scenario))  + 
  stat_summary(fun=median, geom="point") +
  xlab('') +
  ylab('Median Prevalence %') +
  ylim(0,100) +
  # ggtitle("B") +
  # scale_fill_manual(values=c("#0C7BDC","#FFC20A")) +
  theme(legend.position = "none") +
  theme(
    axis.text.x = element_text(size = 16, angle = 0, hjust = .5, vjust = .5, face = "plain"),
    axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
    axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")
  )

figure <- ggarrange(wet_plot)
annotate_figure(
  figure,fig.lab = "B",
  fig.lab.face = "bold",
  bottom = text_grob("Week", size = 20, y = 1)
)

dry_plot <- ggplot(all_prevs_allwed_dry, aes(x=week, y=prevalence, fill=scenario)) + 
  # geom_boxplot() +
  stat_summary(fun=median, geom="line", aes(group=scenario, color = scenario))  + 
  stat_summary(fun=median, geom="point") +
  xlab('') +
  ylab('Median Prevalence %') +
  ylim(0,100) +
  # ggtitle("B") +
  # scale_fill_manual(values=c("#0C7BDC","#FFC20A")) +
  theme(legend.position = "none") +
  theme(
    axis.text.x = element_text(size = 16, angle = 0, hjust = .5, vjust = .5, face = "plain"),
    axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
    axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")
  )

figure <- ggarrange(dry_plot)
annotate_figure(
  figure,fig.lab = "D",
  fig.lab.face = "bold",
  bottom = text_grob("Week", size = 20, y = 1)
)

all_prevs_allwed <- rbind(baseline_allwed_prev,z4_load_1_log_red_allwed_prev,z4_load_2_log_red_allwed_prev,z4_load_3_log_red_allwed_prev,z4_prob_0pc_allwed_prev)

all_prevs_allwed_wet <- all_prevs_allwed[all_prevs_allwed$water=="Wet",]
all_prevs_allwed_dry <- all_prevs_allwed[all_prevs_allwed$water=="Dry",]

wet_plot <- ggplot(all_prevs_allwed_wet, aes(x=week, y=prevalence, fill=scenario)) + 
  # geom_boxplot() +
  stat_summary(fun=median, geom="line", aes(group=scenario, color = scenario))  + 
  stat_summary(fun=median, geom="point") +
  xlab('') +
  ylab('Median Prevalence %') +
  ylim(0,100) +
  # ggtitle("B") +
  # scale_fill_manual(values=c("#0C7BDC","#FFC20A")) +
  theme(legend.position = "none") +
  theme(
    axis.text.x = element_text(size = 16, angle = 0, hjust = .5, vjust = .5, face = "plain"),
    axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
    axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")
  )

figure <- ggarrange(wet_plot)
annotate_figure(
  figure,fig.lab = "B",
  fig.lab.face = "bold",
  bottom = text_grob("Week", size = 20, y = 1)
)

dry_plot <- ggplot(all_prevs_allwed_dry, aes(x=week, y=prevalence, fill=scenario)) + 
  # geom_boxplot() +
  stat_summary(fun=median, geom="line", aes(group=scenario, color = scenario))  + 
  stat_summary(fun=median, geom="point") +
  xlab('') +
  ylab('Median Prevalence %') +
  ylim(0,100) +
  # ggtitle("B") +
  # scale_fill_manual(values=c("#0C7BDC","#FFC20A")) +
  theme(legend.position = "none") +
  theme(
    axis.text.x = element_text(size = 16, angle = 0, hjust = .5, vjust = .5, face = "plain"),
    axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
    axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")
  )

figure <- ggarrange(dry_plot)
annotate_figure(
  figure,fig.lab = "D",
  fig.lab.face = "bold",
  bottom = text_grob("Week", size = 20, y = 1)
)

all_prevs_allwed <- rbind(baseline_allwed_prev,random_prob_150pc_allwed_prev,random_prob_200pc_allwed_prev,random_prob_250pc_allwed_prev)

all_prevs_allwed_wet <- all_prevs_allwed[all_prevs_allwed$water=="Wet",]
all_prevs_allwed_dry <- all_prevs_allwed[all_prevs_allwed$water=="Dry",]

wet_plot <- ggplot(all_prevs_allwed_wet, aes(x=week, y=prevalence, fill=scenario)) + 
  # geom_boxplot() +
  stat_summary(fun=median, geom="line", aes(group=scenario, color = scenario))  + 
  stat_summary(fun=median, geom="point") +
  xlab('') +
  ylab('Median Prevalence %') +
  ylim(0,100) +
  # ggtitle("B") +
  # scale_fill_manual(values=c("#0C7BDC","#FFC20A")) +
  theme(legend.position = "none") +
  theme(
    axis.text.x = element_text(size = 16, angle = 0, hjust = .5, vjust = .5, face = "plain"),
    axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
    axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")
  )

figure <- ggarrange(wet_plot)
annotate_figure(
  figure,fig.lab = "B",
  fig.lab.face = "bold",
  bottom = text_grob("Week", size = 20, y = 1)
)

dry_plot <- ggplot(all_prevs_allwed_dry, aes(x=week, y=prevalence, fill=scenario)) + 
  # geom_boxplot() +
  stat_summary(fun=median, geom="line", aes(group=scenario, color = scenario))  + 
  stat_summary(fun=median, geom="point") +
  xlab('') +
  ylab('Median Prevalence %') +
  ylim(0,100) +
  # ggtitle("B") +
  # scale_fill_manual(values=c("#0C7BDC","#FFC20A")) +
  theme(legend.position = "none") +
  theme(
    axis.text.x = element_text(size = 16, angle = 0, hjust = .5, vjust = .5, face = "plain"),
    axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
    axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")
  )

figure <- ggarrange(dry_plot)
annotate_figure(
  figure,fig.lab = "D",
  fig.lab.face = "bold",
  bottom = text_grob("Week", size = 20, y = 1)
)

all_prevs_allwed <- rbind(baseline_allwed_prev,z4_prob_75pc_allwed_prev,z4_prob_50pc_allwed_prev,z4_prob_25pc_allwed_prev,z4_prob_0pc_allwed_prev)

all_prevs_allwed_wet <- all_prevs_allwed[all_prevs_allwed$water=="Wet",]
all_prevs_allwed_dry <- all_prevs_allwed[all_prevs_allwed$water=="Dry",]

wet_plot <- ggplot(all_prevs_allwed_wet, aes(x=week, y=prevalence, fill=scenario)) + 
  # geom_boxplot() +
  stat_summary(fun=median, geom="line", aes(group=scenario, color = scenario))  + 
  stat_summary(fun=median, geom="point") +
  xlab('') +
  ylab('Median Prevalence %') +
  ylim(0,100) +
  # ggtitle("B") +
  # scale_fill_manual(values=c("#0C7BDC","#FFC20A")) +
  theme(legend.position = "none") +
  theme(
    axis.text.x = element_text(size = 16, angle = 0, hjust = .5, vjust = .5, face = "plain"),
    axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
    axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")
  )

figure <- ggarrange(wet_plot)
annotate_figure(
  figure,fig.lab = "B",
  fig.lab.face = "bold",
  bottom = text_grob("Week", size = 20, y = 1)
)

dry_plot <- ggplot(all_prevs_allwed_dry, aes(x=week, y=prevalence, fill=scenario)) + 
  # geom_boxplot() +
  stat_summary(fun=median, geom="line", aes(group=scenario, color = scenario))  + 
  stat_summary(fun=median, geom="point") +
  xlab('') +
  ylab('Median Prevalence %') +
  ylim(0,100) +
  # ggtitle("B") +
  # scale_fill_manual(values=c("#0C7BDC","#FFC20A")) +
  theme(legend.position = "none") +
  theme(
    axis.text.x = element_text(size = 16, angle = 0, hjust = .5, vjust = .5, face = "plain"),
    axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
    axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")
  )

figure <- ggarrange(dry_plot)
annotate_figure(
  figure,fig.lab = "D",
  fig.lab.face = "bold",
  bottom = text_grob("Week", size = 20, y = 1)
)
```

```{r Aux Data Baseline}
agent_list_areas <- as.vector(agents_list_baseline$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_baseline$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_baseline$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("Baseline")

aux_data_baseline <- aux_data

aux_data_baseline_durations_all <- aux_data_baseline[which(aux_data_baseline$type=="Minimum Duration (All)" | aux_data_baseline$type=="Mean Duration (All)" | aux_data_baseline$type=="C. Duration Q1 (All)" | aux_data_baseline$type=="Median Duration (All)" | aux_data_baseline$type=="C. Duration Q3 (All)" | aux_data_baseline$type=="Maximum Duration (All)"),]

aux_data_baseline_durations_per <- aux_data_baseline[which(aux_data_baseline$type=="Minimum Duration (Per)" | aux_data_baseline$type=="Mean Duration (Per)" | aux_data_baseline$type=="C. Duration Q1 (Per)" | aux_data_baseline$type=="Median Duration (Per)" | aux_data_baseline$type=="C. Duration Q3 (Per)" | aux_data_baseline$type=="Maximum Duration (Per)"),]

aux_data_baseline_freq_count <- aux_data_baseline[which(aux_data_baseline$type=="Times Contaminated" | aux_data_baseline$type=="Times Persistent"),]

aux_data_baseline_mean_per_freq <- aux_data_baseline[which(aux_data_baseline$type=="Mean Times Persistent (Overall)" | aux_data_baseline$type=="Mean Times Persistent (Per It.)"),]

aux_data_baseline_durations_list <- Facility_B_durations_baseline
aux_data_baseline_durations_list$scenario <- as.factor("Baseline")
aux_data_baseline_durations_list$type <- as.factor("All")

# aux_data_baseline_transient_durations_list <- as.data.frame(transient_durations_list_baseline)
# aux_data_baseline_transient_durations_list$scenario <- as.factor("Baseline")
# aux_data_baseline_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_baseline_transient_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_baseline_persistent_durations_list <- as.data.frame(persistent_durations_list_baseline)
# aux_data_baseline_persistent_durations_list$scenario <- as.factor("Baseline")
# aux_data_baseline_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_baseline_persistent_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_baseline_excess_durations_list <- as.data.frame(excess_durations_list_baseline)
# aux_data_baseline_excess_durations_list$scenario <- as.factor("Baseline")
# aux_data_baseline_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_baseline_excess_durations_list) <- c("duration", "scenario","type")
# 
# mine.heatmap <- ggplot() +
#   geom_tile(
#     data = aux_data_baseline_durations_all,
#     mapping = aes(
#         x = type,
#         y = id,
#         fill = value
#         )
#   ) +
#   scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
#   geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
#   scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
#   xlab("") +
#   ylab("Agent Functional Group") +
#   theme_minimal() +
#   theme(
#     legend.position = "right",
#     #axis.text.y = element_text(angle = 45, size = 16),
#     axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
#     #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
#     legend.text=element_text(size=16, hjust = .5, vjust = .5),
#     panel.grid.major = element_line(size = 0, colour = "white"), 
#     panel.grid.minor = element_line(size = 0, colour = "white")
#   )
# mine.heatmap

# mine.heatmap <- ggplot() +
#   geom_tile(
#     data = aux_data_baseline_durations_per,
#     mapping = aes(
#         x = type,
#         y = id,
#         fill = value
#         )
#   ) +
#   scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
#   geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
#   scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
#   xlab("") +
#   ylab("Agent Functional Group") +
#   theme_minimal() +
#   theme(
#     legend.position = "right",
#     #axis.text.y = element_text(angle = 45, size = 16),
#     axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
#     #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
#     legend.text=element_text(size=16, hjust = .5, vjust = .5),
#     panel.grid.major = element_line(size = 0, colour = "white"), 
#     panel.grid.minor = element_line(size = 0, colour = "white")
#   )
# mine.heatmap
# 
# mine.heatmap <- ggplot() +
#   geom_tile(
#     data = aux_data_baseline_freq_count,
#     mapping = aes(
#         x = type,
#         y = id,
#         fill = value
#         )
#   ) +
#   scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
#   geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
#   scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
#   xlab("") +
#   ylab("Agent Functional Group") +
#   theme_minimal() +
#   theme(
#     legend.position = "right",
#     #axis.text.y = element_text(angle = 45, size = 16),
#     axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
#     #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
#     legend.text=element_text(size=16, hjust = .5, vjust = .5),
#     panel.grid.major = element_line(size = 0, colour = "white"), 
#     panel.grid.minor = element_line(size = 0, colour = "white")
#   )
# mine.heatmap

mine.heatmap <- ggplot() +
  geom_tile(
    data = aux_data_baseline_freq_count[which(aux_data_baseline_freq_count$type=="Times Persistent"),],
    mapping = aes(
      x = type,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "#F9F9F9", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_x_discrete(expand = c(0.1,0.1)) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing"), expand = c(0.1,0.1)) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    axis.text.x = element_text(color = "grey20", hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )
mine.heatmap

mine.heatmap <- ggplot() +
  geom_tile(
    data = aux_data_baseline_freq_count[which(aux_data_baseline_freq_count$type=="Times Contaminated"),],
    mapping = aes(
      x = type,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "#F9F9F9", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_x_discrete(expand = c(0.1,0.1)) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing"), expand = c(0.1,0.1)) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    axis.text.x = element_text(color = "grey20", hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )
mine.heatmap

# mine.heatmap <- ggplot() +
#   geom_tile(
#     data = aux_data_baseline_mean_per_freq,
#     mapping = aes(
#         x = type,
#         y = id,
#         fill = value
#         )
#   ) +
#   scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
#   geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
#   scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
#   xlab("") +
#   ylab("Agent Functional Group") +
#   theme_minimal() +
#   theme(
#     legend.position = "right",
#     #axis.text.y = element_text(angle = 45, size = 16),
#     axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
#     #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
#     legend.text=element_text(size=16, hjust = .5, vjust = .5),
#     panel.grid.major = element_line(size = 0, colour = "white"), 
#     panel.grid.minor = element_line(size = 0, colour = "white")
#   )
# mine.heatmap

mine.heatmap <- ggplot() +
  geom_tile(
    data = aux_data_baseline_mean_per_freq[which(aux_data_baseline_mean_per_freq$type=="Mean Times Persistent (Overall)"),],
    mapping = aes(
      x = type,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "#F9F9F9", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_x_discrete(expand = c(0.1,0.1)) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing"), expand = c(0.1,0.1)) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    #axis.text.x = element_text(color = "grey20", hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )
mine.heatmap

mine.heatmap <- ggplot() +
  geom_tile(
    data = aux_data_baseline_mean_per_freq[which(aux_data_baseline_mean_per_freq$type=="Mean Times Persistent (Per It.)"),],
    mapping = aes(
      x = type,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "#F9F9F9", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_x_discrete(expand = c(0.1,0.1)) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing"), expand = c(0.1,0.1)) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    #axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text = element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )
mine.heatmap

# plot <- ggplot() +
#   geom_boxplot(
#     data = rbind(aux_data_baseline_durations_list[c("duration","scenario","type")],aux_data_baseline_transient_durations_list,aux_data_baseline_persistent_durations_list),
#     mapping = aes(
#       x = type,
#       y = duration
#     )
#   )
# plot

plot <- ggplot() +
  geom_boxplot(
    data = rbind(aux_data_baseline_transient_durations_list,aux_data_baseline_persistent_durations_list,aux_data_baseline_excess_durations_list),
    mapping = aes(
      x = type,
      y = duration
    )
  ) +
  xlab("Contamination Type") +
  ylab("Contamination Duration (Hours)") +
  ggtitle("B") +
  theme(
    plot.title = element_text(size=20),
    axis.text.x = element_text(size=20),
    axis.text.y = element_text(size=15),
    axis.title.x = element_text(size=20),
    axis.title.y = element_text(size=20)
  )
plot
```

```{r Aux Data XI_01}
agent_list_areas <- as.vector(agents_list_no_niches$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_no_niches$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_no_niches$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_01")

aux_data_no_niches <- aux_data

aux_data_no_niches_durations_all <- aux_data_no_niches[which(aux_data_no_niches$type=="Minimum Duration (All)" | aux_data_no_niches$type=="Mean Duration (All)" | aux_data_no_niches$type=="C. Duration Q1 (All)" | aux_data_no_niches$type=="Median Duration (All)" | aux_data_no_niches$type=="C. Duration Q3 (All)" | aux_data_no_niches$type=="Maximum Duration (All)"),]

aux_data_no_niches_durations_per <- aux_data_no_niches[which(aux_data_no_niches$type=="Minimum Duration (Per)" | aux_data_no_niches$type=="Mean Duration (Per)" | aux_data_no_niches$type=="C. Duration Q1 (Per)" | aux_data_no_niches$type=="Median Duration (Per)" | aux_data_no_niches$type=="C. Duration Q3 (Per)" | aux_data_no_niches$type=="Maximum Duration (Per)"),]

aux_data_no_niches_freq_count <- aux_data_no_niches[which(aux_data_no_niches$type=="Times Contaminated" | aux_data_no_niches$type=="Times Persistent"),]

aux_data_no_niches_mean_per_freq <- aux_data_no_niches[which(aux_data_no_niches$type=="Mean Times Persistent (Overall)" | aux_data_no_niches$type=="Mean Times Persistent (Per It.)"),]

aux_data_no_niches_durations_list <- Facility_B_durations_no_niches
aux_data_no_niches_durations_list$scenario <- as.factor("XI_01")
aux_data_no_niches_durations_list$type <- as.factor("All")

# aux_data_no_niches_transient_durations_list <- as.data.frame(transient_durations_list_no_niches)
# aux_data_no_niches_transient_durations_list$scenario <- as.factor("XI_01")
# aux_data_no_niches_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_no_niches_transient_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_no_niches_persistent_durations_list <- as.data.frame(persistent_durations_list_no_niches)
# aux_data_no_niches_persistent_durations_list$scenario <- as.factor("XI_01")
# aux_data_no_niches_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_no_niches_persistent_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_no_niches_excess_durations_list <- as.data.frame(excess_durations_list_no_niches)
# aux_data_no_niches_excess_durations_list$scenario <- as.factor("XI_01")
# aux_data_no_niches_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_no_niches_excess_durations_list) <- c("duration", "scenario","type")

aux_data_no_niches_series_durations_all <- rbind(
  aux_data_baseline_durations_all,
  aux_data_no_niches_durations_all
)

aux_data_no_niches_series_durations_per <- rbind(
  aux_data_baseline_durations_per,
  aux_data_no_niches_durations_per
)

aux_data_no_niches_series_freq_count <- rbind(
  aux_data_baseline_freq_count,
  aux_data_no_niches_freq_count
)
aux_data_no_niches_series_freq_count$unique_scenario <- as.factor(paste0(aux_data_no_niches_series_freq_count$type, " (", aux_data_no_niches_series_freq_count$scenario, ")"))

aux_data_no_niches_series_mean_per_freq <- rbind(
  aux_data_baseline_mean_per_freq,
  aux_data_no_niches_mean_per_freq
)
aux_data_no_niches_series_mean_per_freq$unique_scenario <- as.factor(paste0(aux_data_no_niches_series_mean_per_freq$type, " (", aux_data_no_niches_series_mean_per_freq$scenario, ")"))

aux_data_no_niches_series_durations_list <- rbind(
  aux_data_baseline_durations_list,
  aux_data_no_niches_durations_list
)

aux_data_no_niches_series_transient_durations_list <- rbind(
  aux_data_baseline_transient_durations_list,
  aux_data_no_niches_transient_durations_list
)

aux_data_no_niches_series_persistent_durations_list <- rbind(
  aux_data_baseline_persistent_durations_list,
  aux_data_no_niches_persistent_durations_list
)

aux_data_no_niches_series_excess_durations_list <- rbind(
  aux_data_baseline_excess_durations_list,
  aux_data_no_niches_excess_durations_list
)

ggplot() +
  geom_tile(
    data = aux_data_no_niches_series_mean_per_freq,
    mapping = aes(
      x = unique_scenario,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )

ggplot() +
  geom_boxplot(
    data = rbind(aux_data_no_niches_series_transient_durations_list,aux_data_no_niches_series_persistent_durations_list,aux_data_no_niches_series_excess_durations_list),
    mapping = aes(
      x = type,
      y = duration,
      fill = scenario
    )
  ) +
  xlab("Contamination Type") +
  ylab("Contamination Duration (Hours)") +
  ggtitle("B") +
  theme(
    legend.position = "bottom",
    plot.title = element_text(size=20),
    axis.text.x = element_text(size=20),
    axis.text.y = element_text(size=15),
    axis.title.x = element_text(size=20),
    axis.title.y = element_text(size=20),
    legend.text = element_text(size = 15)
  )

ggplot() +
  geom_tile(
    data = aux_data_no_niches_series_freq_count,
    mapping = aes(
      x = unique_scenario,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )

ggplot() +
  geom_tile(
    data = aux_data_no_niches_series_freq_count[which(aux_data_no_niches_series_freq_count$unique_scenario=="Times Persistent (Baseline)" | aux_data_no_niches_series_freq_count$unique_scenario=="Times Persistent (XI_01)"),],
    mapping = aes(
      x = unique_scenario,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )

ggplot() +
  geom_tile(
    data = aux_data_no_niches_series_freq_count[which(aux_data_no_niches_series_freq_count$unique_scenario=="Times Contaminated (Baseline)" | aux_data_no_niches_series_freq_count$unique_scenario=="Times Contaminated (XI_01)"),],
    mapping = aes(
      x = unique_scenario,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )
```

```{r Aux Data XI_02}
agent_list_areas <- as.vector(agents_list_highest_undirected$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_highest_undirected$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_highest_undirected$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_undirected$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_undirected$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_undirected$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_undirected$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_undirected$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_undirected$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_undirected$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_undirected$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_undirected$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_undirected$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_undirected$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_undirected$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_undirected$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_undirected$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_02U1")

aux_data_highest_undirected <- aux_data

aux_data_highest_undirected_durations_all <- aux_data_highest_undirected[which(aux_data_highest_undirected$type=="Minimum Duration (All)" | aux_data_highest_undirected$type=="Mean Duration (All)" | aux_data_highest_undirected$type=="C. Duration Q1 (All)" | aux_data_highest_undirected$type=="Median Duration (All)" | aux_data_highest_undirected$type=="C. Duration Q3 (All)" | aux_data_highest_undirected$type=="Maximum Duration (All)"),]

aux_data_highest_undirected_durations_per <- aux_data_highest_undirected[which(aux_data_highest_undirected$type=="Minimum Duration (Per)" | aux_data_highest_undirected$type=="Mean Duration (Per)" | aux_data_highest_undirected$type=="C. Duration Q1 (Per)" | aux_data_highest_undirected$type=="Median Duration (Per)" | aux_data_highest_undirected$type=="C. Duration Q3 (Per)" | aux_data_highest_undirected$type=="Maximum Duration (Per)"),]

aux_data_highest_undirected_freq_count <- aux_data_highest_undirected[which(aux_data_highest_undirected$type=="Times Contaminated" | aux_data_highest_undirected$type=="Times Persistent"),]

aux_data_highest_undirected_mean_per_freq <- aux_data_highest_undirected[which(aux_data_highest_undirected$type=="Mean Times Persistent (Overall)" | aux_data_highest_undirected$type=="Mean Times Persistent (Per It.)"),]

aux_data_highest_undirected_durations_list <- Facility_B_durations_highest_undirected
aux_data_highest_undirected_durations_list$scenario <- as.factor("XI_02U1")
aux_data_highest_undirected_durations_list$type <- as.factor("All")

# aux_data_highest_undirected_transient_durations_list <- as.data.frame(transient_durations_list_highest_undirected)
# aux_data_highest_undirected_transient_durations_list$scenario <- as.factor("High Undirected (XI_02U1)")
# aux_data_highest_undirected_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_highest_undirected_transient_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_highest_undirected_persistent_durations_list <- as.data.frame(persistent_durations_list_highest_undirected)
# aux_data_highest_undirected_persistent_durations_list$scenario <- as.factor("High Undirected (XI_02U1)")
# aux_data_highest_undirected_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_highest_undirected_persistent_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_highest_undirected_excess_durations_list <- as.data.frame(excess_durations_list_highest_undirected)
# aux_data_highest_undirected_excess_durations_list$scenario <- as.factor("High Undirected (XI_02U1)")
# aux_data_highest_undirected_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_highest_undirected_excess_durations_list) <- c("duration", "scenario","type")

agent_list_areas <- as.vector(agents_list_medium_undirected$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_medium_undirected$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_medium_undirected$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_undirected$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_undirected$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_undirected$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_undirected$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_undirected$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_undirected$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_undirected$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_undirected$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_undirected$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_undirected$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_undirected$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_undirected$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_undirected$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_undirected$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_02U2")

aux_data_medium_undirected <- aux_data

aux_data_medium_undirected_durations_all <- aux_data_medium_undirected[which(aux_data_medium_undirected$type=="Minimum Duration (All)" | aux_data_medium_undirected$type=="Mean Duration (All)" | aux_data_medium_undirected$type=="C. Duration Q1 (All)" | aux_data_medium_undirected$type=="Median Duration (All)" | aux_data_medium_undirected$type=="C. Duration Q3 (All)" | aux_data_medium_undirected$type=="Maximum Duration (All)"),]

aux_data_medium_undirected_durations_per <- aux_data_medium_undirected[which(aux_data_medium_undirected$type=="Minimum Duration (Per)" | aux_data_medium_undirected$type=="Mean Duration (Per)" | aux_data_medium_undirected$type=="C. Duration Q1 (Per)" | aux_data_medium_undirected$type=="Median Duration (Per)" | aux_data_medium_undirected$type=="C. Duration Q3 (Per)" | aux_data_medium_undirected$type=="Maximum Duration (Per)"),]

aux_data_medium_undirected_freq_count <- aux_data_medium_undirected[which(aux_data_medium_undirected$type=="Times Contaminated" | aux_data_medium_undirected$type=="Times Persistent"),]

aux_data_medium_undirected_mean_per_freq <- aux_data_medium_undirected[which(aux_data_medium_undirected$type=="Mean Times Persistent (Overall)" | aux_data_medium_undirected$type=="Mean Times Persistent (Per It.)"),]

aux_data_medium_undirected_durations_list <- Facility_B_durations_medium_undirected
aux_data_medium_undirected_durations_list$scenario <- as.factor("XI_02U2")
aux_data_medium_undirected_durations_list$type <- as.factor("All")

# aux_data_medium_undirected_transient_durations_list <- as.data.frame(transient_durations_list_medium_undirected)
# aux_data_medium_undirected_transient_durations_list$scenario <- as.factor("Medium Undirected (XI_02U2)")
# aux_data_medium_undirected_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_medium_undirected_transient_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_medium_undirected_persistent_durations_list <- as.data.frame(persistent_durations_list_medium_undirected)
# aux_data_medium_undirected_persistent_durations_list$scenario <- as.factor("Medium Undirected (XI_02U2)")
# aux_data_medium_undirected_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_medium_undirected_persistent_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_medium_undirected_excess_durations_list <- as.data.frame(excess_durations_list_medium_undirected)
# aux_data_medium_undirected_excess_durations_list$scenario <- as.factor("Medium Undirected (XI_02U2)")
# aux_data_medium_undirected_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_medium_undirected_excess_durations_list) <- c("duration", "scenario","type")

agent_list_areas <- as.vector(agents_list_highest_outgoing$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_highest_outgoing$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_highest_outgoing$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_outgoing$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_outgoing$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_outgoing$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_outgoing$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_outgoing$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_outgoing$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_outgoing$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_outgoing$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_outgoing$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_outgoing$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_outgoing$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_outgoing$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_outgoing$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_highest_outgoing$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_02O1")

aux_data_highest_outgoing <- aux_data

aux_data_highest_outgoing_durations_all <- aux_data_highest_outgoing[which(aux_data_highest_outgoing$type=="Minimum Duration (All)" | aux_data_highest_outgoing$type=="Mean Duration (All)" | aux_data_highest_outgoing$type=="C. Duration Q1 (All)" | aux_data_highest_outgoing$type=="Median Duration (All)" | aux_data_highest_outgoing$type=="C. Duration Q3 (All)" | aux_data_highest_outgoing$type=="Maximum Duration (All)"),]

aux_data_highest_outgoing_durations_per <- aux_data_highest_outgoing[which(aux_data_highest_outgoing$type=="Minimum Duration (Per)" | aux_data_highest_outgoing$type=="Mean Duration (Per)" | aux_data_highest_outgoing$type=="C. Duration Q1 (Per)" | aux_data_highest_outgoing$type=="Median Duration (Per)" | aux_data_highest_outgoing$type=="C. Duration Q3 (Per)" | aux_data_highest_outgoing$type=="Maximum Duration (Per)"),]

aux_data_highest_outgoing_freq_count <- aux_data_highest_outgoing[which(aux_data_highest_outgoing$type=="Times Contaminated" | aux_data_highest_outgoing$type=="Times Persistent"),]

aux_data_highest_outgoing_mean_per_freq <- aux_data_highest_outgoing[which(aux_data_highest_outgoing$type=="Mean Times Persistent (Overall)" | aux_data_highest_outgoing$type=="Mean Times Persistent (Per It.)"),]

aux_data_highest_outgoing_durations_list <- Facility_B_durations_highest_outgoing
aux_data_highest_outgoing_durations_list$scenario <- as.factor("XI_02O1")
aux_data_highest_outgoing_durations_list$type <- as.factor("All")

# aux_data_highest_outgoing_transient_durations_list <- as.data.frame(transient_durations_list_highest_outgoing)
# aux_data_highest_outgoing_transient_durations_list$scenario <- as.factor("High Outgoing (XI_02O2)")
# aux_data_highest_outgoing_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_highest_outgoing_transient_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_highest_outgoing_persistent_durations_list <- as.data.frame(persistent_durations_list_highest_outgoing)
# aux_data_highest_outgoing_persistent_durations_list$scenario <- as.factor("High Outgoing (XI_02O2)")
# aux_data_highest_outgoing_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_highest_outgoing_persistent_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_highest_outgoing_excess_durations_list <- as.data.frame(excess_durations_list_highest_outgoing)
# aux_data_highest_outgoing_excess_durations_list$scenario <- as.factor("High Outgoing (XI_02O2)")
# aux_data_highest_outgoing_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_highest_outgoing_excess_durations_list) <- c("duration", "scenario","type")

agent_list_areas <- as.vector(agents_list_medium_outgoing$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_medium_outgoing$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_medium_outgoing$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_outgoing$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_outgoing$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_outgoing$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_outgoing$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_outgoing$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_outgoing$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_outgoing$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_outgoing$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_outgoing$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_outgoing$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_outgoing$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_outgoing$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_outgoing$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_medium_outgoing$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_02O2")

aux_data_medium_outgoing <- aux_data

aux_data_medium_outgoing_durations_all <- aux_data_medium_outgoing[which(aux_data_medium_outgoing$type=="Minimum Duration (All)" | aux_data_medium_outgoing$type=="Mean Duration (All)" | aux_data_medium_outgoing$type=="C. Duration Q1 (All)" | aux_data_medium_outgoing$type=="Median Duration (All)" | aux_data_medium_outgoing$type=="C. Duration Q3 (All)" | aux_data_medium_outgoing$type=="Maximum Duration (All)"),]

aux_data_medium_outgoing_durations_per <- aux_data_medium_outgoing[which(aux_data_medium_outgoing$type=="Minimum Duration (Per)" | aux_data_medium_outgoing$type=="Mean Duration (Per)" | aux_data_medium_outgoing$type=="C. Duration Q1 (Per)" | aux_data_medium_outgoing$type=="Median Duration (Per)" | aux_data_medium_outgoing$type=="C. Duration Q3 (Per)" | aux_data_medium_outgoing$type=="Maximum Duration (Per)"),]

aux_data_medium_outgoing_freq_count <- aux_data_medium_outgoing[which(aux_data_medium_outgoing$type=="Times Contaminated" | aux_data_medium_outgoing$type=="Times Persistent"),]

aux_data_medium_outgoing_mean_per_freq <- aux_data_medium_outgoing[which(aux_data_medium_outgoing$type=="Mean Times Persistent (Overall)" | aux_data_medium_outgoing$type=="Mean Times Persistent (Per It.)"),]

aux_data_medium_outgoing_durations_list <- Facility_B_durations_medium_outgoing
aux_data_medium_outgoing_durations_list$scenario <- as.factor("XI_02O2")
aux_data_medium_outgoing_durations_list$type <- as.factor("All")

# aux_data_medium_outgoing_transient_durations_list <- as.data.frame(transient_durations_list_medium_outgoing)
# aux_data_medium_outgoing_transient_durations_list$scenario <- as.factor("Medium Outgoing (XI_02O2)")
# aux_data_medium_outgoing_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_medium_outgoing_transient_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_medium_outgoing_persistent_durations_list <- as.data.frame(persistent_durations_list_medium_outgoing)
# aux_data_medium_outgoing_persistent_durations_list$scenario <- as.factor("Medium Outgoing (XI_02O2)")
# aux_data_medium_outgoing_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_medium_outgoing_persistent_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_medium_outgoing_excess_durations_list <- as.data.frame(excess_durations_list_medium_outgoing)
# aux_data_medium_outgoing_excess_durations_list$scenario <- as.factor("Medium Outgoing (XI_02O2)")
# aux_data_medium_outgoing_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_medium_outgoing_excess_durations_list) <- c("duration", "scenario","type")

agent_list_areas <- as.vector(agents_list_low_connections$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_low_connections$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_low_connections$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_low_connections$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_low_connections$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_low_connections$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_low_connections$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_low_connections$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_low_connections$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_low_connections$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_low_connections$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_low_connections$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_low_connections$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_low_connections$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_low_connections$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_low_connections$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_low_connections$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_02L")

aux_data_low_connections <- aux_data

aux_data_low_connections_durations_all <- aux_data_low_connections[which(aux_data_low_connections$type=="Minimum Duration (All)" | aux_data_low_connections$type=="Mean Duration (All)" | aux_data_low_connections$type=="C. Duration Q1 (All)" | aux_data_low_connections$type=="Median Duration (All)" | aux_data_low_connections$type=="C. Duration Q3 (All)" | aux_data_low_connections$type=="Maximum Duration (All)"),]

aux_data_low_connections_durations_per <- aux_data_low_connections[which(aux_data_low_connections$type=="Minimum Duration (Per)" | aux_data_low_connections$type=="Mean Duration (Per)" | aux_data_low_connections$type=="C. Duration Q1 (Per)" | aux_data_low_connections$type=="Median Duration (Per)" | aux_data_low_connections$type=="C. Duration Q3 (Per)" | aux_data_low_connections$type=="Maximum Duration (Per)"),]

aux_data_low_connections_freq_count <- aux_data_low_connections[which(aux_data_low_connections$type=="Times Contaminated" | aux_data_low_connections$type=="Times Persistent"),]

aux_data_low_connections_mean_per_freq <- aux_data_low_connections[which(aux_data_low_connections$type=="Mean Times Persistent (Overall)" | aux_data_low_connections$type=="Mean Times Persistent (Per It.)"),]

aux_data_low_connections_durations_list <- Facility_B_durations_low_connections
aux_data_low_connections_durations_list$scenario <- as.factor("XI_02L")
aux_data_low_connections_durations_list$type <- as.factor("All")

# aux_data_low_connections_transient_durations_list <- as.data.frame(transient_durations_list_low_connections)
# aux_data_low_connections_transient_durations_list$scenario <- as.factor("Low Outgoing & Undirected (XI_02L)")
# aux_data_low_connections_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_low_connections_transient_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_low_connections_persistent_durations_list <- as.data.frame(persistent_durations_list_low_connections)
# aux_data_low_connections_persistent_durations_list$scenario <- as.factor("Low Outgoing & Undirected (XI_02L)")
# aux_data_low_connections_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_low_connections_persistent_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_low_connections_excess_durations_list <- as.data.frame(excess_durations_list_low_connections)
# aux_data_low_connections_excess_durations_list$scenario <- as.factor("Low Outgoing & Undirected (XI_02L)")
# aux_data_low_connections_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_low_connections_excess_durations_list) <- c("duration", "scenario","type")

aux_data_precontamination_series_durations_all <- rbind(
  aux_data_baseline_durations_all,
  aux_data_highest_undirected_durations_all,
  aux_data_medium_undirected_durations_all,
  aux_data_highest_outgoing_durations_all,
  aux_data_medium_outgoing_durations_all,
  aux_data_low_connections_durations_all
)

aux_data_precontamination_series_durations_per <- rbind(
  aux_data_baseline_durations_per,
  aux_data_highest_undirected_durations_per,
  aux_data_medium_undirected_durations_per,
  aux_data_highest_outgoing_durations_per,
  aux_data_medium_outgoing_durations_per,
  aux_data_low_connections_durations_per
)

aux_data_precontamination_series_freq_count <- rbind(
  aux_data_baseline_freq_count,
  aux_data_highest_undirected_freq_count,
  aux_data_medium_undirected_freq_count,
  aux_data_highest_outgoing_freq_count,
  aux_data_medium_outgoing_freq_count,
  aux_data_low_connections_freq_count
)
aux_data_precontamination_series_freq_count$unique_scenario <- as.factor(paste0(aux_data_precontamination_series_freq_count$type, " (", aux_data_precontamination_series_freq_count$scenario, ")"))

aux_data_precontamination_series_mean_per_freq <- rbind(
  aux_data_baseline_mean_per_freq,
  aux_data_highest_undirected_mean_per_freq,
  aux_data_medium_undirected_mean_per_freq,
  aux_data_highest_outgoing_mean_per_freq,
  aux_data_medium_outgoing_mean_per_freq,
  aux_data_low_connections_mean_per_freq
)
aux_data_precontamination_series_mean_per_freq$unique_scenario <- as.factor(paste0(aux_data_precontamination_series_mean_per_freq$type, " (", aux_data_precontamination_series_mean_per_freq$scenario, ")"))

aux_data_precontamination_series_durations_list <- rbind(
  aux_data_baseline_durations_list,
  aux_data_highest_undirected_durations_list,
  aux_data_medium_undirected_durations_list,
  aux_data_highest_outgoing_durations_list,
  aux_data_medium_outgoing_durations_list,
  aux_data_low_connections_durations_list
)

aux_data_precontamination_series_transient_durations_list <- rbind(
  aux_data_baseline_transient_durations_list,
  aux_data_highest_undirected_transient_durations_list,
  aux_data_medium_undirected_transient_durations_list,
  aux_data_highest_outgoing_transient_durations_list,
  aux_data_medium_outgoing_transient_durations_list,
  aux_data_low_connections_transient_durations_list
)

aux_data_precontamination_series_persistent_durations_list <- rbind(
  aux_data_baseline_persistent_durations_list,
  aux_data_highest_undirected_persistent_durations_list,
  aux_data_medium_undirected_persistent_durations_list,
  aux_data_highest_outgoing_persistent_durations_list,
  aux_data_medium_outgoing_persistent_durations_list,
  aux_data_low_connections_persistent_durations_list
)

aux_data_precontamination_series_excess_durations_list <- rbind(
  aux_data_baseline_excess_durations_list,
  aux_data_highest_undirected_excess_durations_list,
  aux_data_medium_undirected_excess_durations_list,
  aux_data_highest_outgoing_excess_durations_list,
  aux_data_medium_outgoing_excess_durations_list,
  aux_data_low_connections_excess_durations_list
)

ggplot() +
  geom_tile(
    data = aux_data_precontamination_series_mean_per_freq,
    mapping = aes(
      x = unique_scenario,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )

ggplot() +
  geom_boxplot(
    data = rbind(aux_data_precontamination_series_transient_durations_list,aux_data_precontamination_series_persistent_durations_list,aux_data_precontamination_series_excess_durations_list),
    mapping = aes(
      x = type,
      y = duration,
      fill = scenario
    )
  ) +
  xlab("Contamination Type") +
  ylab("Contamination Duration (Hours)") +
  ggtitle("B") +
  theme(
    legend.position = "bottom",
    plot.title = element_text(size=20),
    axis.text.x = element_text(size=20),
    axis.text.y = element_text(size=15),
    axis.title.x = element_text(size=20),
    axis.title.y = element_text(size=20),
    legend.text = element_text(size = 15)
  )

ggplot() +
  geom_tile(
    data = aux_data_precontamination_series_freq_count,
    mapping = aes(
      x = unique_scenario,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )

ggplot() +
  geom_tile(
    data = aux_data_precontamination_series_freq_count[which(aux_data_precontamination_series_freq_count$unique_scenario=="Times Persistent (Baseline)" | aux_data_precontamination_series_freq_count$unique_scenario=="Times Persistent (XI_02U1)" | aux_data_precontamination_series_freq_count$unique_scenario=="Times Persistent (XI_02U2)" | aux_data_precontamination_series_freq_count$unique_scenario=="Times Persistent (XI_02O1)" | aux_data_precontamination_series_freq_count$unique_scenario=="Times Persistent (XI_02O2)" | aux_data_precontamination_series_freq_count$unique_scenario=="Times Persistent (XI_02L)"),],
    mapping = aes(
      x = unique_scenario,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_x_discrete(limits = c("Times Persistent (Baseline)","Times Persistent (XI_02U1)","Times Persistent (XI_02U2)","Times Persistent (XI_02O1)","Times Persistent (XI_02O2)","Times Persistent (XI_02L)")) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )

ggplot() +
  geom_tile(
    data = aux_data_precontamination_series_freq_count[which(aux_data_precontamination_series_freq_count$unique_scenario=="Times Contaminated (Baseline)" | aux_data_precontamination_series_freq_count$unique_scenario=="Times Contaminated (XI_02U1)" | aux_data_precontamination_series_freq_count$unique_scenario=="Times Contaminated (XI_02U2)" | aux_data_precontamination_series_freq_count$unique_scenario=="Times Contaminated (XI_02O1)" | aux_data_precontamination_series_freq_count$unique_scenario=="Times Contaminated (XI_02O2)" | aux_data_precontamination_series_freq_count$unique_scenario=="Times Contaminated (XI_02L)"),],
    mapping = aes(
      x = unique_scenario,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_x_discrete(limits = c("Times Contaminated (Baseline)","Times Contaminated (XI_02U1)","Times Contaminated (XI_02U2)","Times Contaminated (XI_02O1)","Times Contaminated (XI_02O2)","Times Contaminated (XI_02L)")) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )
```

```{r Aux Data EC}
agent_list_areas <- as.vector(agents_list_crate_prev_75pc$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_crate_prev_75pc$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("EC_01")

aux_data_crate_prev_75pc <- aux_data

aux_data_crate_prev_75pc_durations_all <- aux_data_crate_prev_75pc[which(aux_data_crate_prev_75pc$type=="Minimum Duration (All)" | aux_data_crate_prev_75pc$type=="Mean Duration (All)" | aux_data_crate_prev_75pc$type=="C. Duration Q1 (All)" | aux_data_crate_prev_75pc$type=="Median Duration (All)" | aux_data_crate_prev_75pc$type=="C. Duration Q3 (All)" | aux_data_crate_prev_75pc$type=="Maximum Duration (All)"),]

aux_data_crate_prev_75pc_durations_per <- aux_data_crate_prev_75pc[which(aux_data_crate_prev_75pc$type=="Minimum Duration (Per)" | aux_data_crate_prev_75pc$type=="Mean Duration (Per)" | aux_data_crate_prev_75pc$type=="C. Duration Q1 (Per)" | aux_data_crate_prev_75pc$type=="Median Duration (Per)" | aux_data_crate_prev_75pc$type=="C. Duration Q3 (Per)" | aux_data_crate_prev_75pc$type=="Maximum Duration (Per)"),]

aux_data_crate_prev_75pc_freq_count <- aux_data_crate_prev_75pc[which(aux_data_crate_prev_75pc$type=="Times Contaminated" | aux_data_crate_prev_75pc$type=="Times Persistent"),]

aux_data_crate_prev_75pc_mean_per_freq <- aux_data_crate_prev_75pc[which(aux_data_crate_prev_75pc$type=="Mean Times Persistent (Overall)" | aux_data_crate_prev_75pc$type=="Mean Times Persistent (Per It.)"),]

aux_data_crate_prev_75pc_durations_list <- Facility_B_durations_crate_prev_75pc
aux_data_crate_prev_75pc_durations_list$scenario <- as.factor("EC_01")
aux_data_crate_prev_75pc_durations_list$type <- as.factor("All")

# aux_data_crate_prev_75pc_transient_durations_list <- as.data.frame(transient_durations_list_crate_prev_75pc)
# aux_data_crate_prev_75pc_transient_durations_list$scenario <- as.factor("EC_01")
# aux_data_crate_prev_75pc_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_crate_prev_75pc_transient_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_crate_prev_75pc_persistent_durations_list <- as.data.frame(persistent_durations_list_crate_prev_75pc)
# aux_data_crate_prev_75pc_persistent_durations_list$scenario <- as.factor("EC_01")
# aux_data_crate_prev_75pc_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_crate_prev_75pc_persistent_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_crate_prev_75pc_excess_durations_list <- as.data.frame(excess_durations_list_crate_prev_75pc)
# aux_data_crate_prev_75pc_excess_durations_list$scenario <- as.factor("EC_01")
# aux_data_crate_prev_75pc_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_crate_prev_75pc_excess_durations_list) <- c("duration", "scenario","type")

agent_list_areas <- as.vector(agents_list_crate_prev_50pc$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_crate_prev_50pc$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("EC_02")

aux_data_crate_prev_50pc <- aux_data

aux_data_crate_prev_50pc_durations_all <- aux_data_crate_prev_50pc[which(aux_data_crate_prev_50pc$type=="Minimum Duration (All)" | aux_data_crate_prev_50pc$type=="Mean Duration (All)" | aux_data_crate_prev_50pc$type=="C. Duration Q1 (All)" | aux_data_crate_prev_50pc$type=="Median Duration (All)" | aux_data_crate_prev_50pc$type=="C. Duration Q3 (All)" | aux_data_crate_prev_50pc$type=="Maximum Duration (All)"),]

aux_data_crate_prev_50pc_durations_per <- aux_data_crate_prev_50pc[which(aux_data_crate_prev_50pc$type=="Minimum Duration (Per)" | aux_data_crate_prev_50pc$type=="Mean Duration (Per)" | aux_data_crate_prev_50pc$type=="C. Duration Q1 (Per)" | aux_data_crate_prev_50pc$type=="Median Duration (Per)" | aux_data_crate_prev_50pc$type=="C. Duration Q3 (Per)" | aux_data_crate_prev_50pc$type=="Maximum Duration (Per)"),]

aux_data_crate_prev_50pc_freq_count <- aux_data_crate_prev_50pc[which(aux_data_crate_prev_50pc$type=="Times Contaminated" | aux_data_crate_prev_50pc$type=="Times Persistent"),]

aux_data_crate_prev_50pc_mean_per_freq <- aux_data_crate_prev_50pc[which(aux_data_crate_prev_50pc$type=="Mean Times Persistent (Overall)" | aux_data_crate_prev_50pc$type=="Mean Times Persistent (Per It.)"),]

aux_data_crate_prev_50pc_durations_list <- Facility_B_durations_crate_prev_50pc
aux_data_crate_prev_50pc_durations_list$scenario <- as.factor("EC_02")
aux_data_crate_prev_50pc_durations_list$type <- as.factor("All")

# aux_data_crate_prev_50pc_transient_durations_list <- as.data.frame(transient_durations_list_crate_prev_50pc)
# aux_data_crate_prev_50pc_transient_durations_list$scenario <- as.factor("EC_02")
# aux_data_crate_prev_50pc_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_crate_prev_50pc_transient_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_crate_prev_50pc_persistent_durations_list <- as.data.frame(persistent_durations_list_crate_prev_50pc)
# aux_data_crate_prev_50pc_persistent_durations_list$scenario <- as.factor("EC_02")
# aux_data_crate_prev_50pc_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_crate_prev_50pc_persistent_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_crate_prev_50pc_excess_durations_list <- as.data.frame(excess_durations_list_crate_prev_50pc)
# aux_data_crate_prev_50pc_excess_durations_list$scenario <- as.factor("EC_02")
# aux_data_crate_prev_50pc_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_crate_prev_50pc_excess_durations_list) <- c("duration", "scenario","type")

agent_list_areas <- as.vector(agents_list_crate_prev_25pc$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_crate_prev_25pc$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("EC_03")

aux_data_crate_prev_25pc <- aux_data

aux_data_crate_prev_25pc_durations_all <- aux_data_crate_prev_25pc[which(aux_data_crate_prev_25pc$type=="Minimum Duration (All)" | aux_data_crate_prev_25pc$type=="Mean Duration (All)" | aux_data_crate_prev_25pc$type=="C. Duration Q1 (All)" | aux_data_crate_prev_25pc$type=="Median Duration (All)" | aux_data_crate_prev_25pc$type=="C. Duration Q3 (All)" | aux_data_crate_prev_25pc$type=="Maximum Duration (All)"),]

aux_data_crate_prev_25pc_durations_per <- aux_data_crate_prev_25pc[which(aux_data_crate_prev_25pc$type=="Minimum Duration (Per)" | aux_data_crate_prev_25pc$type=="Mean Duration (Per)" | aux_data_crate_prev_25pc$type=="C. Duration Q1 (Per)" | aux_data_crate_prev_25pc$type=="Median Duration (Per)" | aux_data_crate_prev_25pc$type=="C. Duration Q3 (Per)" | aux_data_crate_prev_25pc$type=="Maximum Duration (Per)"),]

aux_data_crate_prev_25pc_freq_count <- aux_data_crate_prev_25pc[which(aux_data_crate_prev_25pc$type=="Times Contaminated" | aux_data_crate_prev_25pc$type=="Times Persistent"),]

aux_data_crate_prev_25pc_mean_per_freq <- aux_data_crate_prev_25pc[which(aux_data_crate_prev_25pc$type=="Mean Times Persistent (Overall)" | aux_data_crate_prev_25pc$type=="Mean Times Persistent (Per It.)"),]

aux_data_crate_prev_25pc_durations_list <- Facility_B_durations_crate_prev_25pc
aux_data_crate_prev_25pc_durations_list$scenario <- as.factor("EC_03")
aux_data_crate_prev_25pc_durations_list$type <- as.factor("All")

# aux_data_crate_prev_25pc_transient_durations_list <- as.data.frame(transient_durations_list_crate_prev_25pc)
# aux_data_crate_prev_25pc_transient_durations_list$scenario <- as.factor("EC_03")
# aux_data_crate_prev_25pc_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_crate_prev_25pc_transient_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_crate_prev_25pc_persistent_durations_list <- as.data.frame(persistent_durations_list_crate_prev_25pc)
# aux_data_crate_prev_25pc_persistent_durations_list$scenario <- as.factor("EC_03")
# aux_data_crate_prev_25pc_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_crate_prev_25pc_persistent_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_crate_prev_25pc_excess_durations_list <- as.data.frame(excess_durations_list_crate_prev_25pc)
# aux_data_crate_prev_25pc_excess_durations_list$scenario <- as.factor("EC_03")
# aux_data_crate_prev_25pc_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_crate_prev_25pc_excess_durations_list) <- c("duration", "scenario","type")

agent_list_areas <- as.vector(agents_list_crate_prev_0pc$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_crate_prev_0pc$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("EC_04")

aux_data_crate_prev_0pc <- aux_data

aux_data_crate_prev_0pc_durations_all <- aux_data_crate_prev_0pc[which(aux_data_crate_prev_0pc$type=="Minimum Duration (All)" | aux_data_crate_prev_0pc$type=="Mean Duration (All)" | aux_data_crate_prev_0pc$type=="C. Duration Q1 (All)" | aux_data_crate_prev_0pc$type=="Median Duration (All)" | aux_data_crate_prev_0pc$type=="C. Duration Q3 (All)" | aux_data_crate_prev_0pc$type=="Maximum Duration (All)"),]

aux_data_crate_prev_0pc_durations_per <- aux_data_crate_prev_0pc[which(aux_data_crate_prev_0pc$type=="Minimum Duration (Per)" | aux_data_crate_prev_0pc$type=="Mean Duration (Per)" | aux_data_crate_prev_0pc$type=="C. Duration Q1 (Per)" | aux_data_crate_prev_0pc$type=="Median Duration (Per)" | aux_data_crate_prev_0pc$type=="C. Duration Q3 (Per)" | aux_data_crate_prev_0pc$type=="Maximum Duration (Per)"),]

aux_data_crate_prev_0pc_freq_count <- aux_data_crate_prev_0pc[which(aux_data_crate_prev_0pc$type=="Times Contaminated" | aux_data_crate_prev_0pc$type=="Times Persistent"),]

aux_data_crate_prev_0pc_mean_per_freq <- aux_data_crate_prev_0pc[which(aux_data_crate_prev_0pc$type=="Mean Times Persistent (Overall)" | aux_data_crate_prev_0pc$type=="Mean Times Persistent (Per It.)"),]

aux_data_crate_prev_0pc_durations_list <- Facility_B_durations_crate_prev_0pc
aux_data_crate_prev_0pc_durations_list$scenario <- as.factor("EC_04")
aux_data_crate_prev_0pc_durations_list$type <- as.factor("All")

# aux_data_crate_prev_0pc_transient_durations_list <- as.data.frame(transient_durations_list_crate_prev_0pc)
# aux_data_crate_prev_0pc_transient_durations_list$scenario <- as.factor("EC_04")
# aux_data_crate_prev_0pc_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_crate_prev_0pc_transient_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_crate_prev_0pc_persistent_durations_list <- as.data.frame(persistent_durations_list_crate_prev_0pc)
# aux_data_crate_prev_0pc_persistent_durations_list$scenario <- as.factor("EC_04")
# aux_data_crate_prev_0pc_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_crate_prev_0pc_persistent_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_crate_prev_0pc_excess_durations_list <- as.data.frame(excess_durations_list_crate_prev_0pc)
# aux_data_crate_prev_0pc_excess_durations_list$scenario <- as.factor("EC_04")
# aux_data_crate_prev_0pc_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_crate_prev_0pc_excess_durations_list) <- c("duration", "scenario","type")

aux_data_crate_prev_series_durations_all <- rbind(
  aux_data_baseline_durations_all,
  aux_data_crate_prev_75pc_durations_all,
  aux_data_crate_prev_50pc_durations_all,
  aux_data_crate_prev_25pc_durations_all,
  aux_data_crate_prev_0pc_durations_all
)

aux_data_crate_prev_0pc_only_durations_all <- rbind(
  aux_data_baseline_durations_all,
  aux_data_crate_prev_0pc_durations_all
)

aux_data_crate_prev_series_durations_per <- rbind(
  aux_data_baseline_durations_per,
  aux_data_crate_prev_75pc_durations_per,
  aux_data_crate_prev_50pc_durations_per,
  aux_data_crate_prev_25pc_durations_per,
  aux_data_crate_prev_0pc_durations_per
)

aux_data_crate_prev_0pc_only_durations_per <- rbind(
  aux_data_baseline_durations_per,
  aux_data_crate_prev_0pc_durations_per
)

aux_data_crate_prev_series_freq_count <- rbind(
  aux_data_baseline_freq_count,
  aux_data_crate_prev_75pc_freq_count,
  aux_data_crate_prev_50pc_freq_count,
  aux_data_crate_prev_25pc_freq_count,
  aux_data_crate_prev_0pc_freq_count
)
aux_data_crate_prev_series_freq_count$unique_scenario <- as.factor(paste0(aux_data_crate_prev_series_freq_count$type, " (", aux_data_crate_prev_series_freq_count$scenario, ")"))

aux_data_crate_prev_0pc_only_freq_count <- rbind(
  aux_data_baseline_freq_count,
  aux_data_crate_prev_0pc_freq_count
)
aux_data_crate_prev_0pc_only_freq_count$unique_scenario <- as.factor(paste0(aux_data_crate_prev_0pc_only_freq_count$type, " (", aux_data_crate_prev_0pc_only_freq_count$scenario, ")"))

aux_data_crate_prev_series_mean_per_freq <- rbind(
  aux_data_baseline_mean_per_freq,
  aux_data_crate_prev_75pc_mean_per_freq,
  aux_data_crate_prev_50pc_mean_per_freq,
  aux_data_crate_prev_25pc_mean_per_freq,
  aux_data_crate_prev_0pc_mean_per_freq
)
aux_data_crate_prev_series_mean_per_freq$unique_scenario <- as.factor(paste0(aux_data_crate_prev_series_mean_per_freq$type, " (", aux_data_crate_prev_series_mean_per_freq$scenario, ")"))

aux_data_crate_prev_0pc_only_mean_per_freq <- rbind(
  aux_data_baseline_mean_per_freq,
  aux_data_crate_prev_0pc_mean_per_freq
)
aux_data_crate_prev_0pc_only_mean_per_freq$unique_scenario <- as.factor(paste0(aux_data_crate_prev_0pc_only_mean_per_freq$type, " (", aux_data_crate_prev_0pc_only_mean_per_freq$scenario, ")"))

aux_data_crate_prev_series_durations_list <- rbind(
  aux_data_baseline_durations_list,
  aux_data_crate_prev_75pc_durations_list,
  aux_data_crate_prev_50pc_durations_list,
  aux_data_crate_prev_25pc_durations_list,
  aux_data_crate_prev_0pc_durations_list
)

aux_data_crate_prev_0pc_only_durations_list <- rbind(
  aux_data_baseline_durations_list,
  aux_data_crate_prev_0pc_durations_list
)

aux_data_crate_prev_series_transient_durations_list <- rbind(
  aux_data_baseline_transient_durations_list,
  aux_data_crate_prev_75pc_transient_durations_list,
  aux_data_crate_prev_50pc_transient_durations_list,
  aux_data_crate_prev_25pc_transient_durations_list,
  aux_data_crate_prev_0pc_transient_durations_list
)

aux_data_crate_prev_0pc_only_transient_durations_list <- rbind(
  aux_data_baseline_transient_durations_list,
  aux_data_crate_prev_0pc_transient_durations_list
)

aux_data_crate_prev_series_persistent_durations_list <- rbind(
  aux_data_baseline_persistent_durations_list,
  aux_data_crate_prev_75pc_persistent_durations_list,
  aux_data_crate_prev_50pc_persistent_durations_list,
  aux_data_crate_prev_25pc_persistent_durations_list,
  aux_data_crate_prev_0pc_persistent_durations_list
)

aux_data_crate_prev_0pc_only_persistent_durations_list <- rbind(
  aux_data_baseline_persistent_durations_list,
  aux_data_crate_prev_0pc_persistent_durations_list
)

aux_data_crate_prev_series_excess_durations_list <- rbind(
  aux_data_baseline_excess_durations_list,
  aux_data_crate_prev_75pc_excess_durations_list,
  aux_data_crate_prev_50pc_excess_durations_list,
  aux_data_crate_prev_25pc_excess_durations_list,
  aux_data_crate_prev_0pc_excess_durations_list
)

aux_data_crate_prev_0pc_only_excess_durations_list <- rbind(
  aux_data_baseline_excess_durations_list,
  aux_data_crate_prev_0pc_excess_durations_list
)


ggplot() +
  geom_tile(
    data = aux_data_crate_prev_series_mean_per_freq,
    mapping = aes(
      x = unique_scenario,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )

ggplot() +
  geom_boxplot(
    data = rbind(aux_data_crate_prev_series_transient_durations_list,aux_data_crate_prev_series_persistent_durations_list,aux_data_crate_prev_series_excess_durations_list),
    mapping = aes(
      x = type,
      y = duration,
      fill = scenario
    )
  ) +
  xlab("Contamination Type") +
  ylab("Contamination Duration (Hours)") +
  ggtitle("B") +
  theme(
    legend.position = "bottom",
    plot.title = element_text(size=20),
    axis.text.x = element_text(size=20),
    axis.text.y = element_text(size=15),
    axis.title.x = element_text(size=20),
    axis.title.y = element_text(size=20),
    legend.text = element_text(size = 15)
  )

ggplot() +
  geom_boxplot(
    data = rbind(aux_data_crate_prev_0pc_only_transient_durations_list,aux_data_crate_prev_0pc_only_persistent_durations_list,aux_data_crate_prev_0pc_only_excess_durations_list),
    mapping = aes(
      x = type,
      y = duration,
      fill = scenario
    )
  ) +
  xlab("Contamination Type") +
  ylab("Contamination Duration (Hours)") +
  ggtitle("B") +
  theme(
    legend.position = "bottom",
    plot.title = element_text(size=20),
    axis.text.x = element_text(size=20),
    axis.text.y = element_text(size=15),
    axis.title.x = element_text(size=20),
    axis.title.y = element_text(size=20),
    legend.text = element_text(size = 15)
  )

ggplot() +
  geom_tile(
    data = aux_data_crate_prev_series_freq_count,
    mapping = aes(
      x = unique_scenario,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )

ggplot() +
  geom_tile(
    data = aux_data_crate_prev_series_freq_count[which(aux_data_crate_prev_series_freq_count$unique_scenario=="Times Persistent (Baseline)" | aux_data_crate_prev_series_freq_count$unique_scenario=="Times Persistent (EC_01)" | aux_data_crate_prev_series_freq_count$unique_scenario=="Times Persistent (EC_02)" | aux_data_crate_prev_series_freq_count$unique_scenario=="Times Persistent (EC_03)" | aux_data_crate_prev_series_freq_count$unique_scenario=="Times Persistent (EC_04)"),],
    mapping = aes(
      x = unique_scenario,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )

ggplot() +
  geom_tile(
    data = aux_data_crate_prev_series_freq_count[which(aux_data_crate_prev_series_freq_count$unique_scenario=="Times Contaminated (Baseline)" | aux_data_crate_prev_series_freq_count$unique_scenario=="Times Contaminated (EC_01)" | aux_data_crate_prev_series_freq_count$unique_scenario=="Times Contaminated (EC_02)" | aux_data_crate_prev_series_freq_count$unique_scenario=="Times Contaminated (EC_03)" | aux_data_crate_prev_series_freq_count$unique_scenario=="Times Contaminated (EC_04)"),],
    mapping = aes(
      x = unique_scenario,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )
```

```{r Aux Data AI}
agent_list_areas <- as.vector(agents_list_prob_intervention$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_prob_intervention$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_prob_intervention$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("AI_02")

aux_data_prob_intervention <- aux_data

aux_data_prob_intervention_durations_all <- aux_data_prob_intervention[which(aux_data_prob_intervention$type=="Minimum Duration (All)" | aux_data_prob_intervention$type=="Mean Duration (All)" | aux_data_prob_intervention$type=="C. Duration Q1 (All)" | aux_data_prob_intervention$type=="Median Duration (All)" | aux_data_prob_intervention$type=="C. Duration Q3 (All)" | aux_data_prob_intervention$type=="Maximum Duration (All)"),]

aux_data_prob_intervention_durations_per <- aux_data_prob_intervention[which(aux_data_prob_intervention$type=="Minimum Duration (Per)" | aux_data_prob_intervention$type=="Mean Duration (Per)" | aux_data_prob_intervention$type=="C. Duration Q1 (Per)" | aux_data_prob_intervention$type=="Median Duration (Per)" | aux_data_prob_intervention$type=="C. Duration Q3 (Per)" | aux_data_prob_intervention$type=="Maximum Duration (Per)"),]

aux_data_prob_intervention_freq_count <- aux_data_prob_intervention[which(aux_data_prob_intervention$type=="Times Contaminated" | aux_data_prob_intervention$type=="Times Persistent"),]

aux_data_prob_intervention_mean_per_freq <- aux_data_prob_intervention[which(aux_data_prob_intervention$type=="Mean Times Persistent (Overall)" | aux_data_prob_intervention$type=="Mean Times Persistent (Per It.)"),]

aux_data_prob_intervention_durations_list <- Facility_B_durations_prob_intervention
aux_data_prob_intervention_durations_list$scenario <- as.factor("AI_02")
aux_data_prob_intervention_durations_list$type <- as.factor("All")

# aux_data_prob_intervention_transient_durations_list <- as.data.frame(transient_durations_list_prob_intervention)
# aux_data_prob_intervention_transient_durations_list$scenario <- as.factor("AI_02")
# aux_data_prob_intervention_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_prob_intervention_transient_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_prob_intervention_persistent_durations_list <- as.data.frame(persistent_durations_list_prob_intervention)
# aux_data_prob_intervention_persistent_durations_list$scenario <- as.factor("AI_02")
# aux_data_prob_intervention_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_prob_intervention_persistent_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_prob_intervention_excess_durations_list <- as.data.frame(excess_durations_list_prob_intervention)
# aux_data_prob_intervention_excess_durations_list$scenario <- as.factor("AI_02")
# aux_data_prob_intervention_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_prob_intervention_excess_durations_list) <- c("duration", "scenario","type")

agent_list_areas <- as.vector(agents_list_partial_prob_intervention$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_partial_prob_intervention$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("AI_03")

aux_data_partial_prob_intervention <- aux_data

aux_data_partial_prob_intervention_durations_all <- aux_data_partial_prob_intervention[which(aux_data_partial_prob_intervention$type=="Minimum Duration (All)" | aux_data_partial_prob_intervention$type=="Mean Duration (All)" | aux_data_partial_prob_intervention$type=="C. Duration Q1 (All)" | aux_data_partial_prob_intervention$type=="Median Duration (All)" | aux_data_partial_prob_intervention$type=="C. Duration Q3 (All)" | aux_data_partial_prob_intervention$type=="Maximum Duration (All)"),]

aux_data_partial_prob_intervention_durations_per <- aux_data_partial_prob_intervention[which(aux_data_partial_prob_intervention$type=="Minimum Duration (Per)" | aux_data_partial_prob_intervention$type=="Mean Duration (Per)" | aux_data_partial_prob_intervention$type=="C. Duration Q1 (Per)" | aux_data_partial_prob_intervention$type=="Median Duration (Per)" | aux_data_partial_prob_intervention$type=="C. Duration Q3 (Per)" | aux_data_partial_prob_intervention$type=="Maximum Duration (Per)"),]

aux_data_partial_prob_intervention_freq_count <- aux_data_partial_prob_intervention[which(aux_data_partial_prob_intervention$type=="Times Contaminated" | aux_data_partial_prob_intervention$type=="Times Persistent"),]

aux_data_partial_prob_intervention_mean_per_freq <- aux_data_partial_prob_intervention[which(aux_data_partial_prob_intervention$type=="Mean Times Persistent (Overall)" | aux_data_partial_prob_intervention$type=="Mean Times Persistent (Per It.)"),]

aux_data_partial_prob_intervention_durations_list <- Facility_B_durations_partial_prob_intervention
aux_data_partial_prob_intervention_durations_list$scenario <- as.factor("AI_03")
aux_data_partial_prob_intervention_durations_list$type <- as.factor("All")

# aux_data_partial_prob_intervention_transient_durations_list <- as.data.frame(transient_durations_list_partial_prob_intervention)
# aux_data_partial_prob_intervention_transient_durations_list$scenario <- as.factor("AI_03")
# aux_data_partial_prob_intervention_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_partial_prob_intervention_transient_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_partial_prob_intervention_persistent_durations_list <- as.data.frame(persistent_durations_list_partial_prob_intervention)
# aux_data_partial_prob_intervention_persistent_durations_list$scenario <- as.factor("AI_03")
# aux_data_partial_prob_intervention_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_partial_prob_intervention_persistent_durations_list) <- c("duration", "scenario","type")
# 
# aux_data_partial_prob_intervention_excess_durations_list <- as.data.frame(excess_durations_list_partial_prob_intervention)
# aux_data_partial_prob_intervention_excess_durations_list$scenario <- as.factor("AI_03")
# aux_data_partial_prob_intervention_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_partial_prob_intervention_excess_durations_list) <- c("duration", "scenario","type")

aux_data_prob_intervention_series_durations_all <- rbind(
  aux_data_baseline_durations_all,
  aux_data_prob_intervention_durations_all,
  aux_data_partial_prob_intervention_durations_all
)

aux_data_prob_intervention_series_durations_per <- rbind(
  aux_data_baseline_durations_per,
  aux_data_prob_intervention_durations_per,
  aux_data_partial_prob_intervention_durations_per
)

aux_data_prob_intervention_series_freq_count <- rbind(
  aux_data_baseline_freq_count,
  aux_data_prob_intervention_freq_count,
  aux_data_partial_prob_intervention_freq_count
)
aux_data_prob_intervention_series_freq_count$unique_scenario <- as.factor(paste0(aux_data_prob_intervention_series_freq_count$type, " (", aux_data_prob_intervention_series_freq_count$scenario, ")"))

aux_data_prob_intervention_series_mean_per_freq <- rbind(
  aux_data_baseline_mean_per_freq,
  aux_data_prob_intervention_mean_per_freq,
  aux_data_partial_prob_intervention_mean_per_freq
)
aux_data_prob_intervention_series_mean_per_freq$unique_scenario <- as.factor(paste0(aux_data_prob_intervention_series_mean_per_freq$type, " (", aux_data_prob_intervention_series_mean_per_freq$scenario, ")"))

aux_data_prob_intervention_series_durations_list <- rbind(
  aux_data_baseline_durations_list,
  aux_data_prob_intervention_durations_list,
  aux_data_partial_prob_intervention_durations_list
)

aux_data_prob_intervention_series_transient_durations_list <- rbind(
  aux_data_baseline_transient_durations_list,
  aux_data_prob_intervention_transient_durations_list,
  aux_data_partial_prob_intervention_transient_durations_list
)

aux_data_prob_intervention_series_persistent_durations_list <- rbind(
  aux_data_baseline_persistent_durations_list,
  aux_data_prob_intervention_persistent_durations_list,
  aux_data_partial_prob_intervention_persistent_durations_list
)

aux_data_prob_intervention_series_excess_durations_list <- rbind(
  aux_data_baseline_excess_durations_list,
  aux_data_prob_intervention_excess_durations_list,
  aux_data_partial_prob_intervention_excess_durations_list
)

ggplot() +
  geom_tile(
    data = aux_data_prob_intervention_series_mean_per_freq,
    mapping = aes(
      x = unique_scenario,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )

ggplot() +
  geom_boxplot(
    data = rbind(aux_data_prob_intervention_series_transient_durations_list,aux_data_prob_intervention_series_persistent_durations_list,aux_data_prob_intervention_series_excess_durations_list),
    mapping = aes(
      x = type,
      y = duration,
      fill = scenario
    )
  ) +
  xlab("Contamination Type") +
  ylab("Contamination Duration (Hours)") +
  ggtitle("B") +
  theme(
    legend.position = "bottom",
    plot.title = element_text(size=20),
    axis.text.x = element_text(size=20),
    axis.text.y = element_text(size=15),
    axis.title.x = element_text(size=20),
    axis.title.y = element_text(size=20),
    legend.text = element_text(size = 15)
  )

ggplot() +
  geom_tile(
    data = aux_data_prob_intervention_series_freq_count,
    mapping = aes(
      x = unique_scenario,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_x_discrete(limits = c("Times Persistent (Baseline)","Times Persistent (AI_02)","Times Persistent (AI_03)","Times Contaminated (Baseline)","Times Contaminated (AI_02)","Times Contaminated (AI_03)")) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )

ggplot() +
  geom_tile(
    data = aux_data_prob_intervention_series_freq_count[which(aux_data_prob_intervention_series_freq_count$unique_scenario=="Times Persistent (Baseline)" | aux_data_prob_intervention_series_freq_count$unique_scenario=="Times Persistent (AI_02)" | aux_data_prob_intervention_series_freq_count$unique_scenario=="Times Persistent (AI_03)"),],
    mapping = aes(
      x = unique_scenario,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_x_discrete(limits = c("Times Persistent (Baseline)","Times Persistent (AI_02)","Times Persistent (AI_03)")) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )

ggplot() +
  geom_tile(
    data = aux_data_prob_intervention_series_freq_count[which(aux_data_prob_intervention_series_freq_count$unique_scenario=="Times Contaminated (Baseline)" | aux_data_prob_intervention_series_freq_count$unique_scenario=="Times Contaminated (AI_02)" | aux_data_prob_intervention_series_freq_count$unique_scenario=="Times Contaminated (AI_03)"),],
    mapping = aes(
      x = unique_scenario,
      y = id,
      fill = value
    )
  ) +
  scale_fill_continuous(name = "Value", low = "white", high = "red", na.value = "black") +
  geom_hline(yintercept = c(28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.1) +
  scale_x_discrete(limits = c("Times Contaminated (Baseline)","Times Contaminated (AI_02)","Times Contaminated (AI_03)")) +
  scale_y_continuous(breaks = c(28, 49, 59, 82, 102, 225)+0.5, labels = c("cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
  xlab("") +
  ylab("Agent Functional Group") +
  theme_minimal() +
  theme(
    legend.position = "right",
    #axis.text.y = element_text(angle = 45, size = 16),
    axis.text.x = element_text(color = "grey20", angle = 90, hjust = 1, vjust = 0, face = "plain"),
    #axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain"),
    legend.text=element_text(size=16, hjust = .5, vjust = .5),
    panel.grid.major = element_line(size = 0, colour = "white"), 
    panel.grid.minor = element_line(size = 0, colour = "white")
  )
```

```{r Aux Data Compiler}
#Baseline####
agent_list_areas <- as.vector(agents_list_baseline$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_baseline$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_baseline$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("Baseline")

aux_data_baseline <- aux_data

aux_data_baseline_durations_all <- aux_data_baseline[which(aux_data_baseline$type=="Minimum Duration (All)" | aux_data_baseline$type=="Mean Duration (All)" | aux_data_baseline$type=="C. Duration Q1 (All)" | aux_data_baseline$type=="Median Duration (All)" | aux_data_baseline$type=="C. Duration Q3 (All)" | aux_data_baseline$type=="Maximum Duration (All)"),]

aux_data_baseline_durations_per <- aux_data_baseline[which(aux_data_baseline$type=="Minimum Duration (Per)" | aux_data_baseline$type=="Mean Duration (Per)" | aux_data_baseline$type=="C. Duration Q1 (Per)" | aux_data_baseline$type=="Median Duration (Per)" | aux_data_baseline$type=="C. Duration Q3 (Per)" | aux_data_baseline$type=="Maximum Duration (Per)"),]

aux_data_baseline_freq_count <- aux_data_baseline[which(aux_data_baseline$type=="Times Contaminated" | aux_data_baseline$type=="Times Persistent"),]

aux_data_baseline_mean_per_freq <- aux_data_baseline[which(aux_data_baseline$type=="Mean Times Persistent (Overall)" | aux_data_baseline$type=="Mean Times Persistent (Per It.)"),]

aux_data_baseline_durations_list <- Facility_B_durations_baseline
aux_data_baseline_durations_list$scenario <- as.factor("Baseline")
aux_data_baseline_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_baseline)==0) {
#   aux_data_baseline_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_baseline_transient_durations_list <- as.data.frame(transient_durations_list_baseline)
# }
# aux_data_baseline_transient_durations_list$scenario <- as.factor("Baseline")
# aux_data_baseline_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_baseline_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_baseline$duration)==0) {
  aux_data_baseline_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_baseline_long_transient_durations_list <- as.data.frame(transient_long_durations_list_baseline) 
}
aux_data_baseline_long_transient_durations_list$scenario <- as.factor("Baseline")
aux_data_baseline_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_baseline_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_baseline_long_transient_durations_list <- subset(aux_data_baseline_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_baseline$duration)==0) {
  aux_data_baseline_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_baseline_short_transient_durations_list <- as.data.frame(transient_short_durations_list_baseline) 
}
aux_data_baseline_short_transient_durations_list$scenario <- as.factor("Baseline")
aux_data_baseline_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_baseline_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_baseline_short_transient_durations_list <- subset(aux_data_baseline_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_baseline$duration)==0) {
  aux_data_baseline_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_baseline_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_baseline) 
}
aux_data_baseline_uncleanable_transient_durations_list$scenario <- as.factor("Baseline")
aux_data_baseline_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_baseline_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_baseline_uncleanable_transient_durations_list <- subset(aux_data_baseline_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_baseline)==0) {
#   aux_data_baseline_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_baseline_persistent_durations_list <- as.data.frame(persistent_durations_list_baseline) 
# }
# aux_data_baseline_persistent_durations_list$scenario <- as.factor("Baseline")
# aux_data_baseline_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_baseline_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(excess_durations_list_baseline$duration)==0) {
#   aux_data_baseline_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_baseline_excess_durations_list <- as.data.frame(excess_durations_list_baseline) 
# }
# aux_data_baseline_excess_durations_list$scenario <- as.factor("Baseline")
# aux_data_baseline_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_baseline_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_baseline$duration)==0) {
  aux_data_baseline_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_baseline_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_baseline) 
}
aux_data_baseline_long_persistent_durations_list$scenario <- as.factor("Baseline")
aux_data_baseline_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_baseline_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_baseline_long_persistent_durations_list <- subset(aux_data_baseline_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_baseline$duration)==0) {
  aux_data_baseline_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_baseline_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_baseline) 
}
aux_data_baseline_short_persistent_durations_list$scenario <- as.factor("Baseline")
aux_data_baseline_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_baseline_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_baseline_short_persistent_durations_list <- subset(aux_data_baseline_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_baseline$duration)==0) {
  aux_data_baseline_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_baseline_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_baseline) 
}
aux_data_baseline_uncleanable_persistent_durations_list$scenario <- as.factor("Baseline")
aux_data_baseline_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_baseline_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_baseline_uncleanable_persistent_durations_list <- subset(aux_data_baseline_uncleanable_persistent_durations_list, select=-c(agent,iteration))

agent_list_areas <- as.vector(agents_list_baseline$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_baseline$min_duration_10min)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_baseline$mean_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$q1_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$median_duration_10min)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$q3_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$max_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$contamination_events_10min)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$times_persistent_10min)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$min_persistent_duration_10min)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$mean_persistent_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$q1_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$median_persistent_duration_10min)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$q3_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$max_persistent_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$mean_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_baseline$balanced_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("Baseline")

aux_data_baseline_10min <- aux_data

aux_data_baseline_10min_durations_all <- aux_data_baseline_10min[which(aux_data_baseline_10min$type=="Minimum Duration (All)" | aux_data_baseline_10min$type=="Mean Duration (All)" | aux_data_baseline_10min$type=="C. Duration Q1 (All)" | aux_data_baseline_10min$type=="Median Duration (All)" | aux_data_baseline_10min$type=="C. Duration Q3 (All)" | aux_data_baseline_10min$type=="Maximum Duration (All)"),]

aux_data_baseline_10min_durations_per <- aux_data_baseline_10min[which(aux_data_baseline_10min$type=="Minimum Duration (Per)" | aux_data_baseline_10min$type=="Mean Duration (Per)" | aux_data_baseline_10min$type=="C. Duration Q1 (Per)" | aux_data_baseline_10min$type=="Median Duration (Per)" | aux_data_baseline_10min$type=="C. Duration Q3 (Per)" | aux_data_baseline_10min$type=="Maximum Duration (Per)"),]

aux_data_baseline_10min_freq_count <- aux_data_baseline_10min[which(aux_data_baseline_10min$type=="Times Contaminated" | aux_data_baseline_10min$type=="Times Persistent"),]

aux_data_baseline_10min_mean_per_freq <- aux_data_baseline_10min[which(aux_data_baseline_10min$type=="Mean Times Persistent (Overall)" | aux_data_baseline_10min$type=="Mean Times Persistent (Per It.)"),]

aux_data_baseline_10min_durations_list <- Facility_B_durations_baseline
aux_data_baseline_10min_durations_list$scenario <- as.factor("Baseline")
aux_data_baseline_10min_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_baseline_10min)==0) {
#   aux_data_baseline_10min_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_baseline_10min_transient_durations_list <- as.data.frame(transient_durations_list_baseline_10min) 
# }
# aux_data_baseline_10min_transient_durations_list$scenario <- as.factor("Baseline")
# aux_data_baseline_10min_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_baseline_10min_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_baseline_10min$duration)==0) {
  aux_data_baseline_10min_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_baseline_10min_long_transient_durations_list <- as.data.frame(transient_long_durations_list_baseline_10min) 
}
aux_data_baseline_10min_long_transient_durations_list$scenario <- as.factor("Baseline")
aux_data_baseline_10min_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_baseline_10min_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_baseline_10min_long_transient_durations_list <- subset(aux_data_baseline_10min_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_baseline_10min$duration)==0) {
  aux_data_baseline_10min_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_baseline_10min_short_transient_durations_list <- as.data.frame(transient_short_durations_list_baseline_10min) 
}
aux_data_baseline_10min_short_transient_durations_list$scenario <- as.factor("Baseline")
aux_data_baseline_10min_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_baseline_10min_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_baseline_10min_short_transient_durations_list <- subset(aux_data_baseline_10min_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_baseline_10min$duration)==0) {
  aux_data_baseline_10min_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_baseline_10min_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_baseline_10min) 
}
aux_data_baseline_10min_uncleanable_transient_durations_list$scenario <- as.factor("Baseline")
aux_data_baseline_10min_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_baseline_10min_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_baseline_10min_uncleanable_transient_durations_list <- subset(aux_data_baseline_10min_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_baseline_10min)==0) {
#   aux_data_baseline_10min_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_baseline_10min_persistent_durations_list <- as.data.frame(persistent_durations_list_baseline_10min) 
# }
# aux_data_baseline_10min_persistent_durations_list$scenario <- as.factor("Baseline")
# aux_data_baseline_10min_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_baseline_10min_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(excess_durations_list_baseline_10min)==0) {
#   aux_data_baseline_10min_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_baseline_10min_excess_durations_list <- as.data.frame(excess_durations_list_baseline_10min) 
# }
# aux_data_baseline_10min_excess_durations_list$scenario <- as.factor("Baseline")
# aux_data_baseline_10min_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_baseline_10min_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_baseline_10min$duration)==0) {
  aux_data_baseline_10min_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_baseline_10min_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_baseline_10min) 
}
aux_data_baseline_10min_long_persistent_durations_list$scenario <- as.factor("Baseline")
aux_data_baseline_10min_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_baseline_10min_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_baseline_10min_long_persistent_durations_list <- subset(aux_data_baseline_10min_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_baseline_10min$duration)==0) {
  aux_data_baseline_10min_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_baseline_10min_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_baseline_10min) 
}
aux_data_baseline_10min_short_persistent_durations_list$scenario <- as.factor("Baseline")
aux_data_baseline_10min_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_baseline_10min_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_baseline_10min_short_persistent_durations_list <- subset(aux_data_baseline_10min_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_baseline_10min$duration)==0) {
  aux_data_baseline_10min_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_baseline_10min_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_baseline_10min) 
}
aux_data_baseline_10min_uncleanable_persistent_durations_list$scenario <- as.factor("Baseline")
aux_data_baseline_10min_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_baseline_10min_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_baseline_10min_uncleanable_persistent_durations_list <- subset(aux_data_baseline_10min_uncleanable_persistent_durations_list, select=-c(agent,iteration))

#XI_01####
agent_list_areas <- as.vector(agents_list_no_niches$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_no_niches$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_no_niches$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_01")

aux_data_no_niches <- aux_data

aux_data_no_niches_durations_all <- aux_data_no_niches[which(aux_data_no_niches$type=="Minimum Duration (All)" | aux_data_no_niches$type=="Mean Duration (All)" | aux_data_no_niches$type=="C. Duration Q1 (All)" | aux_data_no_niches$type=="Median Duration (All)" | aux_data_no_niches$type=="C. Duration Q3 (All)" | aux_data_no_niches$type=="Maximum Duration (All)"),]

aux_data_no_niches_durations_per <- aux_data_no_niches[which(aux_data_no_niches$type=="Minimum Duration (Per)" | aux_data_no_niches$type=="Mean Duration (Per)" | aux_data_no_niches$type=="C. Duration Q1 (Per)" | aux_data_no_niches$type=="Median Duration (Per)" | aux_data_no_niches$type=="C. Duration Q3 (Per)" | aux_data_no_niches$type=="Maximum Duration (Per)"),]

aux_data_no_niches_freq_count <- aux_data_no_niches[which(aux_data_no_niches$type=="Times Contaminated" | aux_data_no_niches$type=="Times Persistent"),]

aux_data_no_niches_mean_per_freq <- aux_data_no_niches[which(aux_data_no_niches$type=="Mean Times Persistent (Overall)" | aux_data_no_niches$type=="Mean Times Persistent (Per It.)"),]

aux_data_no_niches_durations_list <- Facility_B_durations_no_niches
aux_data_no_niches_durations_list$scenario <- as.factor("XI_01")
aux_data_no_niches_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_no_niches)==0) {
#   aux_data_no_niches_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_no_niches_transient_durations_list <- as.data.frame(transient_durations_list_no_niches)
# }
# aux_data_no_niches_transient_durations_list$scenario <- as.factor("XI_01")
# aux_data_no_niches_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_no_niches_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_no_niches$duration)==0) {
  aux_data_no_niches_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_no_niches_long_transient_durations_list <- as.data.frame(transient_long_durations_list_no_niches) 
}
aux_data_no_niches_long_transient_durations_list$scenario <- as.factor("XI_01")
aux_data_no_niches_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_no_niches_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_no_niches_long_transient_durations_list <- subset(aux_data_no_niches_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_no_niches$duration)==0) {
  aux_data_no_niches_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_no_niches_short_transient_durations_list <- as.data.frame(transient_short_durations_list_no_niches) 
}
aux_data_no_niches_short_transient_durations_list$scenario <- as.factor("XI_01")
aux_data_no_niches_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_no_niches_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_no_niches_short_transient_durations_list <- subset(aux_data_no_niches_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_no_niches$duration)==0) {
  aux_data_no_niches_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_no_niches_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_no_niches) 
}
aux_data_no_niches_uncleanable_transient_durations_list$scenario <- as.factor("XI_01")
aux_data_no_niches_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_no_niches_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_no_niches_uncleanable_transient_durations_list <- subset(aux_data_no_niches_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_no_niches)==0) {
#   aux_data_no_niches_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_no_niches_persistent_durations_list <- as.data.frame(persistent_durations_list_no_niches) 
# }
# aux_data_no_niches_persistent_durations_list$scenario <- as.factor("XI_01")
# aux_data_no_niches_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_no_niches_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(persistent_long_durations_list_no_niches$duration)==0) {
#   aux_data_no_niches_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_no_niches_excess_durations_list <- as.data.frame(excess_durations_list_no_niches) 
# }
# aux_data_no_niches_excess_durations_list$scenario <- as.factor("XI_01")
# aux_data_no_niches_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_no_niches_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_no_niches$duration)==0) {
  aux_data_no_niches_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_no_niches_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_no_niches) 
}
aux_data_no_niches_long_persistent_durations_list$scenario <- as.factor("XI_01")
aux_data_no_niches_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_no_niches_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_no_niches_long_persistent_durations_list <- subset(aux_data_no_niches_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_no_niches$duration)==0) {
  aux_data_no_niches_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_no_niches_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_no_niches) 
}
aux_data_no_niches_short_persistent_durations_list$scenario <- as.factor("XI_01")
aux_data_no_niches_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_no_niches_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_no_niches_short_persistent_durations_list <- subset(aux_data_no_niches_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_no_niches$duration)==0) {
  aux_data_no_niches_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_no_niches_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_no_niches) 
}
aux_data_no_niches_uncleanable_persistent_durations_list$scenario <- as.factor("XI_01")
aux_data_no_niches_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_no_niches_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_no_niches_uncleanable_persistent_durations_list <- subset(aux_data_no_niches_uncleanable_persistent_durations_list, select=-c(agent,iteration))

agent_list_areas <- as.vector(agents_list_no_niches$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_no_niches$min_duration_10min)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_no_niches$mean_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$q1_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$median_duration_10min)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$q3_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$max_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$contamination_events_10min)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$times_persistent_10min)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$min_persistent_duration_10min)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$mean_persistent_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$q1_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$median_persistent_duration_10min)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$q3_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$max_persistent_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$mean_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_no_niches$balanced_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_01")

aux_data_no_niches_10min <- aux_data

aux_data_no_niches_10min_durations_all <- aux_data_no_niches_10min[which(aux_data_no_niches_10min$type=="Minimum Duration (All)" | aux_data_no_niches_10min$type=="Mean Duration (All)" | aux_data_no_niches_10min$type=="C. Duration Q1 (All)" | aux_data_no_niches_10min$type=="Median Duration (All)" | aux_data_no_niches_10min$type=="C. Duration Q3 (All)" | aux_data_no_niches_10min$type=="Maximum Duration (All)"),]

aux_data_no_niches_10min_durations_per <- aux_data_no_niches_10min[which(aux_data_no_niches_10min$type=="Minimum Duration (Per)" | aux_data_no_niches_10min$type=="Mean Duration (Per)" | aux_data_no_niches_10min$type=="C. Duration Q1 (Per)" | aux_data_no_niches_10min$type=="Median Duration (Per)" | aux_data_no_niches_10min$type=="C. Duration Q3 (Per)" | aux_data_no_niches_10min$type=="Maximum Duration (Per)"),]

aux_data_no_niches_10min_freq_count <- aux_data_no_niches_10min[which(aux_data_no_niches_10min$type=="Times Contaminated" | aux_data_no_niches_10min$type=="Times Persistent"),]

aux_data_no_niches_10min_mean_per_freq <- aux_data_no_niches_10min[which(aux_data_no_niches_10min$type=="Mean Times Persistent (Overall)" | aux_data_no_niches_10min$type=="Mean Times Persistent (Per It.)"),]

aux_data_no_niches_10min_durations_list <- Facility_B_durations_no_niches
aux_data_no_niches_10min_durations_list$scenario <- as.factor("XI_01")
aux_data_no_niches_10min_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_no_niches_10min)==0) {
#   aux_data_no_niches_10min_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_no_niches_10min_transient_durations_list <- as.data.frame(transient_durations_list_no_niches_10min) 
# }
# aux_data_no_niches_10min_transient_durations_list$scenario <- as.factor("XI_01")
# aux_data_no_niches_10min_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_no_niches_10min_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_no_niches_10min$duration)==0) {
  aux_data_no_niches_10min_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_no_niches_10min_long_transient_durations_list <- as.data.frame(transient_long_durations_list_no_niches_10min) 
}
aux_data_no_niches_10min_long_transient_durations_list$scenario <- as.factor("XI_01")
aux_data_no_niches_10min_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_no_niches_10min_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_no_niches_10min_long_transient_durations_list <- subset(aux_data_no_niches_10min_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_no_niches_10min$duration)==0) {
  aux_data_no_niches_10min_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_no_niches_10min_short_transient_durations_list <- as.data.frame(transient_short_durations_list_no_niches_10min) 
}
aux_data_no_niches_10min_short_transient_durations_list$scenario <- as.factor("XI_01")
aux_data_no_niches_10min_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_no_niches_10min_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_no_niches_10min_short_transient_durations_list <- subset(aux_data_no_niches_10min_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_no_niches_10min$duration)==0) {
  aux_data_no_niches_10min_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_no_niches_10min_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_no_niches_10min) 
}
aux_data_no_niches_10min_uncleanable_transient_durations_list$scenario <- as.factor("XI_01")
aux_data_no_niches_10min_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_no_niches_10min_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_no_niches_10min_uncleanable_transient_durations_list <- subset(aux_data_no_niches_10min_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_no_niches_10min)==0) {
#   aux_data_no_niches_10min_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_no_niches_10min_persistent_durations_list <- as.data.frame(persistent_durations_list_no_niches_10min) 
# }
# aux_data_no_niches_10min_persistent_durations_list$scenario <- as.factor("XI_01")
# aux_data_no_niches_10min_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_no_niches_10min_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(excess_durations_list_no_niches_10min)==0) {
#   aux_data_no_niches_10min_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_no_niches_10min_excess_durations_list <- as.data.frame(excess_durations_list_no_niches_10min) 
# }
# aux_data_no_niches_10min_excess_durations_list$scenario <- as.factor("XI_01")
# aux_data_no_niches_10min_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_no_niches_10min_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_no_niches_10min$duration)==0) {
  aux_data_no_niches_10min_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_no_niches_10min_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_no_niches_10min) 
}
aux_data_no_niches_10min_long_persistent_durations_list$scenario <- as.factor("XI_01")
aux_data_no_niches_10min_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_no_niches_10min_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_no_niches_10min_long_persistent_durations_list <- subset(aux_data_no_niches_10min_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_no_niches_10min$duration)==0) {
  aux_data_no_niches_10min_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_no_niches_10min_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_no_niches_10min) 
}
aux_data_no_niches_10min_short_persistent_durations_list$scenario <- as.factor("XI_01")
aux_data_no_niches_10min_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_no_niches_10min_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_no_niches_10min_short_persistent_durations_list <- subset(aux_data_no_niches_10min_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_no_niches_10min$duration)==0) {
  aux_data_no_niches_10min_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_no_niches_10min_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_no_niches_10min) 
}
aux_data_no_niches_10min_uncleanable_persistent_durations_list$scenario <- as.factor("XI_01")
aux_data_no_niches_10min_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_no_niches_10min_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_no_niches_10min_uncleanable_persistent_durations_list <- subset(aux_data_no_niches_10min_uncleanable_persistent_durations_list, select=-c(agent,iteration))

#XI_02A1####
agent_list_areas <- as.vector(agents_list_index_1$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_index_1$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_index_1$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_02A1")

aux_data_index_1 <- aux_data

aux_data_index_1_durations_all <- aux_data_index_1[which(aux_data_index_1$type=="Minimum Duration (All)" | aux_data_index_1$type=="Mean Duration (All)" | aux_data_index_1$type=="C. Duration Q1 (All)" | aux_data_index_1$type=="Median Duration (All)" | aux_data_index_1$type=="C. Duration Q3 (All)" | aux_data_index_1$type=="Maximum Duration (All)"),]

aux_data_index_1_durations_per <- aux_data_index_1[which(aux_data_index_1$type=="Minimum Duration (Per)" | aux_data_index_1$type=="Mean Duration (Per)" | aux_data_index_1$type=="C. Duration Q1 (Per)" | aux_data_index_1$type=="Median Duration (Per)" | aux_data_index_1$type=="C. Duration Q3 (Per)" | aux_data_index_1$type=="Maximum Duration (Per)"),]

aux_data_index_1_freq_count <- aux_data_index_1[which(aux_data_index_1$type=="Times Contaminated" | aux_data_index_1$type=="Times Persistent"),]

aux_data_index_1_mean_per_freq <- aux_data_index_1[which(aux_data_index_1$type=="Mean Times Persistent (Overall)" | aux_data_index_1$type=="Mean Times Persistent (Per It.)"),]

aux_data_index_1_durations_list <- Facility_B_durations_index_1
aux_data_index_1_durations_list$scenario <- as.factor("XI_02A1")
aux_data_index_1_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_index_1)==0) {
#   aux_data_index_1_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_1_transient_durations_list <- as.data.frame(transient_durations_list_index_1)
# }
# aux_data_index_1_transient_durations_list$scenario <- as.factor("XI_02A1")
# aux_data_index_1_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_index_1_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_index_1$duration)==0) {
  aux_data_index_1_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_1_long_transient_durations_list <- as.data.frame(transient_long_durations_list_index_1) 
}
aux_data_index_1_long_transient_durations_list$scenario <- as.factor("XI_02A1")
aux_data_index_1_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_index_1_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_1_long_transient_durations_list <- subset(aux_data_index_1_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_index_1$duration)==0) {
  aux_data_index_1_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_1_short_transient_durations_list <- as.data.frame(transient_short_durations_list_index_1) 
}
aux_data_index_1_short_transient_durations_list$scenario <- as.factor("XI_02A1")
aux_data_index_1_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_index_1_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_1_short_transient_durations_list <- subset(aux_data_index_1_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_index_1$duration)==0) {
  aux_data_index_1_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_1_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_index_1) 
}
aux_data_index_1_uncleanable_transient_durations_list$scenario <- as.factor("XI_02A1")
aux_data_index_1_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_index_1_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_1_uncleanable_transient_durations_list <- subset(aux_data_index_1_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_index_1)==0) {
#   aux_data_index_1_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_1_persistent_durations_list <- as.data.frame(persistent_durations_list_index_1) 
# }
# aux_data_index_1_persistent_durations_list$scenario <- as.factor("XI_02A1")
# aux_data_index_1_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_index_1_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(persistent_long_durations_list_index_1$duration)==0) {
#   aux_data_index_1_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_1_excess_durations_list <- as.data.frame(excess_durations_list_index_1) 
# }
# aux_data_index_1_excess_durations_list$scenario <- as.factor("XI_02A1")
# aux_data_index_1_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_index_1_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_index_1$duration)==0) {
  aux_data_index_1_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_1_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_index_1) 
}
aux_data_index_1_long_persistent_durations_list$scenario <- as.factor("XI_02A1")
aux_data_index_1_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_index_1_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_1_long_persistent_durations_list <- subset(aux_data_index_1_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_index_1$duration)==0) {
  aux_data_index_1_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_1_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_index_1) 
}
aux_data_index_1_short_persistent_durations_list$scenario <- as.factor("XI_02A1")
aux_data_index_1_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_index_1_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_1_short_persistent_durations_list <- subset(aux_data_index_1_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_index_1$duration)==0) {
  aux_data_index_1_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_1_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_index_1) 
}
aux_data_index_1_uncleanable_persistent_durations_list$scenario <- as.factor("XI_02A1")
aux_data_index_1_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_index_1_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_1_uncleanable_persistent_durations_list <- subset(aux_data_index_1_uncleanable_persistent_durations_list, select=-c(agent,iteration))

agent_list_areas <- as.vector(agents_list_index_1$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_index_1$min_duration_10min)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_index_1$mean_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$q1_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$median_duration_10min)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$q3_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$max_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$contamination_events_10min)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$times_persistent_10min)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$min_persistent_duration_10min)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$mean_persistent_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$q1_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$median_persistent_duration_10min)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$q3_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$max_persistent_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$mean_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_1$balanced_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_02A1")

aux_data_index_1_10min <- aux_data

aux_data_index_1_10min_durations_all <- aux_data_index_1_10min[which(aux_data_index_1_10min$type=="Minimum Duration (All)" | aux_data_index_1_10min$type=="Mean Duration (All)" | aux_data_index_1_10min$type=="C. Duration Q1 (All)" | aux_data_index_1_10min$type=="Median Duration (All)" | aux_data_index_1_10min$type=="C. Duration Q3 (All)" | aux_data_index_1_10min$type=="Maximum Duration (All)"),]

aux_data_index_1_10min_durations_per <- aux_data_index_1_10min[which(aux_data_index_1_10min$type=="Minimum Duration (Per)" | aux_data_index_1_10min$type=="Mean Duration (Per)" | aux_data_index_1_10min$type=="C. Duration Q1 (Per)" | aux_data_index_1_10min$type=="Median Duration (Per)" | aux_data_index_1_10min$type=="C. Duration Q3 (Per)" | aux_data_index_1_10min$type=="Maximum Duration (Per)"),]

aux_data_index_1_10min_freq_count <- aux_data_index_1_10min[which(aux_data_index_1_10min$type=="Times Contaminated" | aux_data_index_1_10min$type=="Times Persistent"),]

aux_data_index_1_10min_mean_per_freq <- aux_data_index_1_10min[which(aux_data_index_1_10min$type=="Mean Times Persistent (Overall)" | aux_data_index_1_10min$type=="Mean Times Persistent (Per It.)"),]

aux_data_index_1_10min_durations_list <- Facility_B_durations_index_1
aux_data_index_1_10min_durations_list$scenario <- as.factor("XI_02A1")
aux_data_index_1_10min_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_index_1_10min)==0) {
#   aux_data_index_1_10min_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_1_10min_transient_durations_list <- as.data.frame(transient_durations_list_index_1_10min) 
# }
# aux_data_index_1_10min_transient_durations_list$scenario <- as.factor("XI_02A1")
# aux_data_index_1_10min_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_index_1_10min_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_index_1_10min$duration)==0) {
  aux_data_index_1_10min_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_1_10min_long_transient_durations_list <- as.data.frame(transient_long_durations_list_index_1_10min) 
}
aux_data_index_1_10min_long_transient_durations_list$scenario <- as.factor("XI_02A1")
aux_data_index_1_10min_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_index_1_10min_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_1_10min_long_transient_durations_list <- subset(aux_data_index_1_10min_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_index_1_10min$duration)==0) {
  aux_data_index_1_10min_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_1_10min_short_transient_durations_list <- as.data.frame(transient_short_durations_list_index_1_10min) 
}
aux_data_index_1_10min_short_transient_durations_list$scenario <- as.factor("XI_02A1")
aux_data_index_1_10min_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_index_1_10min_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_1_10min_short_transient_durations_list <- subset(aux_data_index_1_10min_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_index_1_10min$duration)==0) {
  aux_data_index_1_10min_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_1_10min_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_index_1_10min) 
}
aux_data_index_1_10min_uncleanable_transient_durations_list$scenario <- as.factor("XI_02A1")
aux_data_index_1_10min_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_index_1_10min_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_1_10min_uncleanable_transient_durations_list <- subset(aux_data_index_1_10min_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_index_1_10min)==0) {
#   aux_data_index_1_10min_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_1_10min_persistent_durations_list <- as.data.frame(persistent_durations_list_index_1_10min) 
# }
# aux_data_index_1_10min_persistent_durations_list$scenario <- as.factor("XI_02A1")
# aux_data_index_1_10min_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_index_1_10min_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(excess_durations_list_index_1_10min)==0) {
#   aux_data_index_1_10min_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_1_10min_excess_durations_list <- as.data.frame(excess_durations_list_index_1_10min) 
# }
# aux_data_index_1_10min_excess_durations_list$scenario <- as.factor("XI_02A1")
# aux_data_index_1_10min_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_index_1_10min_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_index_1_10min$duration)==0) {
  aux_data_index_1_10min_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_1_10min_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_index_1_10min) 
}
aux_data_index_1_10min_long_persistent_durations_list$scenario <- as.factor("XI_02A1")
aux_data_index_1_10min_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_index_1_10min_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_1_10min_long_persistent_durations_list <- subset(aux_data_index_1_10min_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_index_1_10min$duration)==0) {
  aux_data_index_1_10min_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_1_10min_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_index_1_10min) 
}
aux_data_index_1_10min_short_persistent_durations_list$scenario <- as.factor("XI_02A1")
aux_data_index_1_10min_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_index_1_10min_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_1_10min_short_persistent_durations_list <- subset(aux_data_index_1_10min_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_index_1_10min$duration)==0) {
  aux_data_index_1_10min_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_1_10min_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_index_1_10min) 
}
aux_data_index_1_10min_uncleanable_persistent_durations_list$scenario <- as.factor("XI_02A1")
aux_data_index_1_10min_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_index_1_10min_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_1_10min_uncleanable_persistent_durations_list <- subset(aux_data_index_1_10min_uncleanable_persistent_durations_list, select=-c(agent,iteration))

#XI_02A2####
agent_list_areas <- as.vector(agents_list_index_2$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_index_2$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_index_2$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_02A2")

aux_data_index_2 <- aux_data

aux_data_index_2_durations_all <- aux_data_index_2[which(aux_data_index_2$type=="Minimum Duration (All)" | aux_data_index_2$type=="Mean Duration (All)" | aux_data_index_2$type=="C. Duration Q1 (All)" | aux_data_index_2$type=="Median Duration (All)" | aux_data_index_2$type=="C. Duration Q3 (All)" | aux_data_index_2$type=="Maximum Duration (All)"),]

aux_data_index_2_durations_per <- aux_data_index_2[which(aux_data_index_2$type=="Minimum Duration (Per)" | aux_data_index_2$type=="Mean Duration (Per)" | aux_data_index_2$type=="C. Duration Q1 (Per)" | aux_data_index_2$type=="Median Duration (Per)" | aux_data_index_2$type=="C. Duration Q3 (Per)" | aux_data_index_2$type=="Maximum Duration (Per)"),]

aux_data_index_2_freq_count <- aux_data_index_2[which(aux_data_index_2$type=="Times Contaminated" | aux_data_index_2$type=="Times Persistent"),]

aux_data_index_2_mean_per_freq <- aux_data_index_2[which(aux_data_index_2$type=="Mean Times Persistent (Overall)" | aux_data_index_2$type=="Mean Times Persistent (Per It.)"),]

aux_data_index_2_durations_list <- Facility_B_durations_index_2
aux_data_index_2_durations_list$scenario <- as.factor("XI_02A2")
aux_data_index_2_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_index_2)==0) {
#   aux_data_index_2_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_2_transient_durations_list <- as.data.frame(transient_durations_list_index_2)
# }
# aux_data_index_2_transient_durations_list$scenario <- as.factor("XI_02A2")
# aux_data_index_2_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_index_2_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_index_2$duration)==0) {
  aux_data_index_2_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_2_long_transient_durations_list <- as.data.frame(transient_long_durations_list_index_2) 
}
aux_data_index_2_long_transient_durations_list$scenario <- as.factor("XI_02A2")
aux_data_index_2_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_index_2_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_2_long_transient_durations_list <- subset(aux_data_index_2_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_index_2$duration)==0) {
  aux_data_index_2_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_2_short_transient_durations_list <- as.data.frame(transient_short_durations_list_index_2) 
}
aux_data_index_2_short_transient_durations_list$scenario <- as.factor("XI_02A2")
aux_data_index_2_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_index_2_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_2_short_transient_durations_list <- subset(aux_data_index_2_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_index_2$duration)==0) {
  aux_data_index_2_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_2_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_index_2) 
}
aux_data_index_2_uncleanable_transient_durations_list$scenario <- as.factor("XI_02A2")
aux_data_index_2_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_index_2_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_2_uncleanable_transient_durations_list <- subset(aux_data_index_2_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_index_2)==0) {
#   aux_data_index_2_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_2_persistent_durations_list <- as.data.frame(persistent_durations_list_index_2) 
# }
# aux_data_index_2_persistent_durations_list$scenario <- as.factor("XI_02A2")
# aux_data_index_2_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_index_2_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(persistent_long_durations_list_index_2$duration)==0) {
#   aux_data_index_2_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_2_excess_durations_list <- as.data.frame(excess_durations_list_index_2) 
# }
# aux_data_index_2_excess_durations_list$scenario <- as.factor("XI_02A2")
# aux_data_index_2_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_index_2_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_index_2$duration)==0) {
  aux_data_index_2_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_2_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_index_2) 
}
aux_data_index_2_long_persistent_durations_list$scenario <- as.factor("XI_02A2")
aux_data_index_2_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_index_2_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_2_long_persistent_durations_list <- subset(aux_data_index_2_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_index_2$duration)==0) {
  aux_data_index_2_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_2_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_index_2) 
}
aux_data_index_2_short_persistent_durations_list$scenario <- as.factor("XI_02A2")
aux_data_index_2_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_index_2_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_2_short_persistent_durations_list <- subset(aux_data_index_2_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_index_2$duration)==0) {
  aux_data_index_2_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_2_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_index_2) 
}
aux_data_index_2_uncleanable_persistent_durations_list$scenario <- as.factor("XI_02A2")
aux_data_index_2_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_index_2_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_2_uncleanable_persistent_durations_list <- subset(aux_data_index_2_uncleanable_persistent_durations_list, select=-c(agent,iteration))

agent_list_areas <- as.vector(agents_list_index_2$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_index_2$min_duration_10min)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_index_2$mean_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$q1_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$median_duration_10min)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$q3_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$max_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$contamination_events_10min)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$times_persistent_10min)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$min_persistent_duration_10min)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$mean_persistent_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$q1_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$median_persistent_duration_10min)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$q3_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$max_persistent_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$mean_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_2$balanced_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_02A2")

aux_data_index_2_10min <- aux_data

aux_data_index_2_10min_durations_all <- aux_data_index_2_10min[which(aux_data_index_2_10min$type=="Minimum Duration (All)" | aux_data_index_2_10min$type=="Mean Duration (All)" | aux_data_index_2_10min$type=="C. Duration Q1 (All)" | aux_data_index_2_10min$type=="Median Duration (All)" | aux_data_index_2_10min$type=="C. Duration Q3 (All)" | aux_data_index_2_10min$type=="Maximum Duration (All)"),]

aux_data_index_2_10min_durations_per <- aux_data_index_2_10min[which(aux_data_index_2_10min$type=="Minimum Duration (Per)" | aux_data_index_2_10min$type=="Mean Duration (Per)" | aux_data_index_2_10min$type=="C. Duration Q1 (Per)" | aux_data_index_2_10min$type=="Median Duration (Per)" | aux_data_index_2_10min$type=="C. Duration Q3 (Per)" | aux_data_index_2_10min$type=="Maximum Duration (Per)"),]

aux_data_index_2_10min_freq_count <- aux_data_index_2_10min[which(aux_data_index_2_10min$type=="Times Contaminated" | aux_data_index_2_10min$type=="Times Persistent"),]

aux_data_index_2_10min_mean_per_freq <- aux_data_index_2_10min[which(aux_data_index_2_10min$type=="Mean Times Persistent (Overall)" | aux_data_index_2_10min$type=="Mean Times Persistent (Per It.)"),]

aux_data_index_2_10min_durations_list <- Facility_B_durations_index_2
aux_data_index_2_10min_durations_list$scenario <- as.factor("XI_02A2")
aux_data_index_2_10min_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_index_2_10min)==0) {
#   aux_data_index_2_10min_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_2_10min_transient_durations_list <- as.data.frame(transient_durations_list_index_2_10min) 
# }
# aux_data_index_2_10min_transient_durations_list$scenario <- as.factor("XI_02A2")
# aux_data_index_2_10min_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_index_2_10min_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_index_2_10min$duration)==0) {
  aux_data_index_2_10min_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_2_10min_long_transient_durations_list <- as.data.frame(transient_long_durations_list_index_2_10min) 
}
aux_data_index_2_10min_long_transient_durations_list$scenario <- as.factor("XI_02A2")
aux_data_index_2_10min_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_index_2_10min_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_2_10min_long_transient_durations_list <- subset(aux_data_index_2_10min_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_index_2_10min$duration)==0) {
  aux_data_index_2_10min_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_2_10min_short_transient_durations_list <- as.data.frame(transient_short_durations_list_index_2_10min) 
}
aux_data_index_2_10min_short_transient_durations_list$scenario <- as.factor("XI_02A2")
aux_data_index_2_10min_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_index_2_10min_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_2_10min_short_transient_durations_list <- subset(aux_data_index_2_10min_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_index_2_10min$duration)==0) {
  aux_data_index_2_10min_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_2_10min_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_index_2_10min) 
}
aux_data_index_2_10min_uncleanable_transient_durations_list$scenario <- as.factor("XI_02A2")
aux_data_index_2_10min_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_index_2_10min_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_2_10min_uncleanable_transient_durations_list <- subset(aux_data_index_2_10min_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_index_2_10min)==0) {
#   aux_data_index_2_10min_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_2_10min_persistent_durations_list <- as.data.frame(persistent_durations_list_index_2_10min) 
# }
# aux_data_index_2_10min_persistent_durations_list$scenario <- as.factor("XI_02A2")
# aux_data_index_2_10min_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_index_2_10min_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(excess_durations_list_index_2_10min)==0) {
#   aux_data_index_2_10min_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_2_10min_excess_durations_list <- as.data.frame(excess_durations_list_index_2_10min) 
# }
# aux_data_index_2_10min_excess_durations_list$scenario <- as.factor("XI_02A2")
# aux_data_index_2_10min_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_index_2_10min_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_index_2_10min$duration)==0) {
  aux_data_index_2_10min_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_2_10min_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_index_2_10min) 
}
aux_data_index_2_10min_long_persistent_durations_list$scenario <- as.factor("XI_02A2")
aux_data_index_2_10min_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_index_2_10min_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_2_10min_long_persistent_durations_list <- subset(aux_data_index_2_10min_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_index_2_10min$duration)==0) {
  aux_data_index_2_10min_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_2_10min_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_index_2_10min) 
}
aux_data_index_2_10min_short_persistent_durations_list$scenario <- as.factor("XI_02A2")
aux_data_index_2_10min_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_index_2_10min_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_2_10min_short_persistent_durations_list <- subset(aux_data_index_2_10min_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_index_2_10min$duration)==0) {
  aux_data_index_2_10min_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_2_10min_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_index_2_10min) 
}
aux_data_index_2_10min_uncleanable_persistent_durations_list$scenario <- as.factor("XI_02A2")
aux_data_index_2_10min_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_index_2_10min_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_2_10min_uncleanable_persistent_durations_list <- subset(aux_data_index_2_10min_uncleanable_persistent_durations_list, select=-c(agent,iteration))

#XI_02A3####
agent_list_areas <- as.vector(agents_list_index_3$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_index_3$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_index_3$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_02A3")

aux_data_index_3 <- aux_data

aux_data_index_3_durations_all <- aux_data_index_3[which(aux_data_index_3$type=="Minimum Duration (All)" | aux_data_index_3$type=="Mean Duration (All)" | aux_data_index_3$type=="C. Duration Q1 (All)" | aux_data_index_3$type=="Median Duration (All)" | aux_data_index_3$type=="C. Duration Q3 (All)" | aux_data_index_3$type=="Maximum Duration (All)"),]

aux_data_index_3_durations_per <- aux_data_index_3[which(aux_data_index_3$type=="Minimum Duration (Per)" | aux_data_index_3$type=="Mean Duration (Per)" | aux_data_index_3$type=="C. Duration Q1 (Per)" | aux_data_index_3$type=="Median Duration (Per)" | aux_data_index_3$type=="C. Duration Q3 (Per)" | aux_data_index_3$type=="Maximum Duration (Per)"),]

aux_data_index_3_freq_count <- aux_data_index_3[which(aux_data_index_3$type=="Times Contaminated" | aux_data_index_3$type=="Times Persistent"),]

aux_data_index_3_mean_per_freq <- aux_data_index_3[which(aux_data_index_3$type=="Mean Times Persistent (Overall)" | aux_data_index_3$type=="Mean Times Persistent (Per It.)"),]

aux_data_index_3_durations_list <- Facility_B_durations_index_3
aux_data_index_3_durations_list$scenario <- as.factor("XI_02A3")
aux_data_index_3_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_index_3)==0) {
#   aux_data_index_3_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_3_transient_durations_list <- as.data.frame(transient_durations_list_index_3)
# }
# aux_data_index_3_transient_durations_list$scenario <- as.factor("XI_02A3")
# aux_data_index_3_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_index_3_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_index_3$duration)==0) {
  aux_data_index_3_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_3_long_transient_durations_list <- as.data.frame(transient_long_durations_list_index_3) 
}
aux_data_index_3_long_transient_durations_list$scenario <- as.factor("XI_02A3")
aux_data_index_3_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_index_3_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_3_long_transient_durations_list <- subset(aux_data_index_3_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_index_3$duration)==0) {
  aux_data_index_3_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_3_short_transient_durations_list <- as.data.frame(transient_short_durations_list_index_3) 
}
aux_data_index_3_short_transient_durations_list$scenario <- as.factor("XI_02A3")
aux_data_index_3_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_index_3_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_3_short_transient_durations_list <- subset(aux_data_index_3_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_index_3$duration)==0) {
  aux_data_index_3_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_3_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_index_3) 
}
aux_data_index_3_uncleanable_transient_durations_list$scenario <- as.factor("XI_02A3")
aux_data_index_3_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_index_3_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_3_uncleanable_transient_durations_list <- subset(aux_data_index_3_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_index_3)==0) {
#   aux_data_index_3_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_3_persistent_durations_list <- as.data.frame(persistent_durations_list_index_3) 
# }
# aux_data_index_3_persistent_durations_list$scenario <- as.factor("XI_02A3")
# aux_data_index_3_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_index_3_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(persistent_long_durations_list_index_3$duration)==0) {
#   aux_data_index_3_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_3_excess_durations_list <- as.data.frame(excess_durations_list_index_3) 
# }
# aux_data_index_3_excess_durations_list$scenario <- as.factor("XI_02A3")
# aux_data_index_3_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_index_3_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_index_3$duration)==0) {
  aux_data_index_3_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_3_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_index_3) 
}
aux_data_index_3_long_persistent_durations_list$scenario <- as.factor("XI_02A3")
aux_data_index_3_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_index_3_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_3_long_persistent_durations_list <- subset(aux_data_index_3_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_index_3$duration)==0) {
  aux_data_index_3_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_3_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_index_3) 
}
aux_data_index_3_short_persistent_durations_list$scenario <- as.factor("XI_02A3")
aux_data_index_3_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_index_3_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_3_short_persistent_durations_list <- subset(aux_data_index_3_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_index_3$duration)==0) {
  aux_data_index_3_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_3_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_index_3) 
}
aux_data_index_3_uncleanable_persistent_durations_list$scenario <- as.factor("XI_02A3")
aux_data_index_3_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_index_3_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_3_uncleanable_persistent_durations_list <- subset(aux_data_index_3_uncleanable_persistent_durations_list, select=-c(agent,iteration))

agent_list_areas <- as.vector(agents_list_index_3$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_index_3$min_duration_10min)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_index_3$mean_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$q1_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$median_duration_10min)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$q3_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$max_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$contamination_events_10min)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$times_persistent_10min)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$min_persistent_duration_10min)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$mean_persistent_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$q1_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$median_persistent_duration_10min)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$q3_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$max_persistent_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$mean_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_3$balanced_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_02A3")

aux_data_index_3_10min <- aux_data

aux_data_index_3_10min_durations_all <- aux_data_index_3_10min[which(aux_data_index_3_10min$type=="Minimum Duration (All)" | aux_data_index_3_10min$type=="Mean Duration (All)" | aux_data_index_3_10min$type=="C. Duration Q1 (All)" | aux_data_index_3_10min$type=="Median Duration (All)" | aux_data_index_3_10min$type=="C. Duration Q3 (All)" | aux_data_index_3_10min$type=="Maximum Duration (All)"),]

aux_data_index_3_10min_durations_per <- aux_data_index_3_10min[which(aux_data_index_3_10min$type=="Minimum Duration (Per)" | aux_data_index_3_10min$type=="Mean Duration (Per)" | aux_data_index_3_10min$type=="C. Duration Q1 (Per)" | aux_data_index_3_10min$type=="Median Duration (Per)" | aux_data_index_3_10min$type=="C. Duration Q3 (Per)" | aux_data_index_3_10min$type=="Maximum Duration (Per)"),]

aux_data_index_3_10min_freq_count <- aux_data_index_3_10min[which(aux_data_index_3_10min$type=="Times Contaminated" | aux_data_index_3_10min$type=="Times Persistent"),]

aux_data_index_3_10min_mean_per_freq <- aux_data_index_3_10min[which(aux_data_index_3_10min$type=="Mean Times Persistent (Overall)" | aux_data_index_3_10min$type=="Mean Times Persistent (Per It.)"),]

aux_data_index_3_10min_durations_list <- Facility_B_durations_index_3
aux_data_index_3_10min_durations_list$scenario <- as.factor("XI_02A3")
aux_data_index_3_10min_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_index_3_10min)==0) {
#   aux_data_index_3_10min_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_3_10min_transient_durations_list <- as.data.frame(transient_durations_list_index_3_10min) 
# }
# aux_data_index_3_10min_transient_durations_list$scenario <- as.factor("XI_02A3")
# aux_data_index_3_10min_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_index_3_10min_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_index_3_10min$duration)==0) {
  aux_data_index_3_10min_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_3_10min_long_transient_durations_list <- as.data.frame(transient_long_durations_list_index_3_10min) 
}
aux_data_index_3_10min_long_transient_durations_list$scenario <- as.factor("XI_02A3")
aux_data_index_3_10min_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_index_3_10min_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_3_10min_long_transient_durations_list <- subset(aux_data_index_3_10min_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_index_3_10min$duration)==0) {
  aux_data_index_3_10min_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_3_10min_short_transient_durations_list <- as.data.frame(transient_short_durations_list_index_3_10min) 
}
aux_data_index_3_10min_short_transient_durations_list$scenario <- as.factor("XI_02A3")
aux_data_index_3_10min_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_index_3_10min_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_3_10min_short_transient_durations_list <- subset(aux_data_index_3_10min_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_index_3_10min$duration)==0) {
  aux_data_index_3_10min_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_3_10min_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_index_3_10min) 
}
aux_data_index_3_10min_uncleanable_transient_durations_list$scenario <- as.factor("XI_02A3")
aux_data_index_3_10min_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_index_3_10min_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_3_10min_uncleanable_transient_durations_list <- subset(aux_data_index_3_10min_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_index_3_10min)==0) {
#   aux_data_index_3_10min_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_3_10min_persistent_durations_list <- as.data.frame(persistent_durations_list_index_3_10min) 
# }
# aux_data_index_3_10min_persistent_durations_list$scenario <- as.factor("XI_02A3")
# aux_data_index_3_10min_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_index_3_10min_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(excess_durations_list_index_3_10min)==0) {
#   aux_data_index_3_10min_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_3_10min_excess_durations_list <- as.data.frame(excess_durations_list_index_3_10min) 
# }
# aux_data_index_3_10min_excess_durations_list$scenario <- as.factor("XI_02A3")
# aux_data_index_3_10min_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_index_3_10min_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_index_3_10min$duration)==0) {
  aux_data_index_3_10min_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_3_10min_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_index_3_10min) 
}
aux_data_index_3_10min_long_persistent_durations_list$scenario <- as.factor("XI_02A3")
aux_data_index_3_10min_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_index_3_10min_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_3_10min_long_persistent_durations_list <- subset(aux_data_index_3_10min_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_index_3_10min$duration)==0) {
  aux_data_index_3_10min_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_3_10min_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_index_3_10min) 
}
aux_data_index_3_10min_short_persistent_durations_list$scenario <- as.factor("XI_02A3")
aux_data_index_3_10min_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_index_3_10min_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_3_10min_short_persistent_durations_list <- subset(aux_data_index_3_10min_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_index_3_10min$duration)==0) {
  aux_data_index_3_10min_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_3_10min_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_index_3_10min) 
}
aux_data_index_3_10min_uncleanable_persistent_durations_list$scenario <- as.factor("XI_02A3")
aux_data_index_3_10min_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_index_3_10min_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_3_10min_uncleanable_persistent_durations_list <- subset(aux_data_index_3_10min_uncleanable_persistent_durations_list, select=-c(agent,iteration))

#XI_02A4####
agent_list_areas <- as.vector(agents_list_index_4$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_index_4$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_index_4$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_02A4")

aux_data_index_4 <- aux_data

aux_data_index_4_durations_all <- aux_data_index_4[which(aux_data_index_4$type=="Minimum Duration (All)" | aux_data_index_4$type=="Mean Duration (All)" | aux_data_index_4$type=="C. Duration Q1 (All)" | aux_data_index_4$type=="Median Duration (All)" | aux_data_index_4$type=="C. Duration Q3 (All)" | aux_data_index_4$type=="Maximum Duration (All)"),]

aux_data_index_4_durations_per <- aux_data_index_4[which(aux_data_index_4$type=="Minimum Duration (Per)" | aux_data_index_4$type=="Mean Duration (Per)" | aux_data_index_4$type=="C. Duration Q1 (Per)" | aux_data_index_4$type=="Median Duration (Per)" | aux_data_index_4$type=="C. Duration Q3 (Per)" | aux_data_index_4$type=="Maximum Duration (Per)"),]

aux_data_index_4_freq_count <- aux_data_index_4[which(aux_data_index_4$type=="Times Contaminated" | aux_data_index_4$type=="Times Persistent"),]

aux_data_index_4_mean_per_freq <- aux_data_index_4[which(aux_data_index_4$type=="Mean Times Persistent (Overall)" | aux_data_index_4$type=="Mean Times Persistent (Per It.)"),]

aux_data_index_4_durations_list <- Facility_B_durations_index_4
aux_data_index_4_durations_list$scenario <- as.factor("XI_02A4")
aux_data_index_4_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_index_4)==0) {
#   aux_data_index_4_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_4_transient_durations_list <- as.data.frame(transient_durations_list_index_4)
# }
# aux_data_index_4_transient_durations_list$scenario <- as.factor("XI_02A4")
# aux_data_index_4_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_index_4_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_index_4$duration)==0) {
  aux_data_index_4_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_4_long_transient_durations_list <- as.data.frame(transient_long_durations_list_index_4) 
}
aux_data_index_4_long_transient_durations_list$scenario <- as.factor("XI_02A4")
aux_data_index_4_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_index_4_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_4_long_transient_durations_list <- subset(aux_data_index_4_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_index_4$duration)==0) {
  aux_data_index_4_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_4_short_transient_durations_list <- as.data.frame(transient_short_durations_list_index_4) 
}
aux_data_index_4_short_transient_durations_list$scenario <- as.factor("XI_02A4")
aux_data_index_4_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_index_4_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_4_short_transient_durations_list <- subset(aux_data_index_4_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_index_4$duration)==0) {
  aux_data_index_4_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_4_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_index_4) 
}
aux_data_index_4_uncleanable_transient_durations_list$scenario <- as.factor("XI_02A4")
aux_data_index_4_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_index_4_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_4_uncleanable_transient_durations_list <- subset(aux_data_index_4_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_index_4)==0) {
#   aux_data_index_4_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_4_persistent_durations_list <- as.data.frame(persistent_durations_list_index_4) 
# }
# aux_data_index_4_persistent_durations_list$scenario <- as.factor("XI_02A4")
# aux_data_index_4_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_index_4_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(persistent_long_durations_list_index_4$duration)==0) {
#   aux_data_index_4_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_4_excess_durations_list <- as.data.frame(excess_durations_list_index_4) 
# }
# aux_data_index_4_excess_durations_list$scenario <- as.factor("XI_02A4")
# aux_data_index_4_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_index_4_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_index_4$duration)==0) {
  aux_data_index_4_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_4_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_index_4) 
}
aux_data_index_4_long_persistent_durations_list$scenario <- as.factor("XI_02A4")
aux_data_index_4_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_index_4_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_4_long_persistent_durations_list <- subset(aux_data_index_4_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_index_4$duration)==0) {
  aux_data_index_4_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_4_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_index_4) 
}
aux_data_index_4_short_persistent_durations_list$scenario <- as.factor("XI_02A4")
aux_data_index_4_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_index_4_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_4_short_persistent_durations_list <- subset(aux_data_index_4_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_index_4$duration)==0) {
  aux_data_index_4_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_4_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_index_4) 
}
aux_data_index_4_uncleanable_persistent_durations_list$scenario <- as.factor("XI_02A4")
aux_data_index_4_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_index_4_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_4_uncleanable_persistent_durations_list <- subset(aux_data_index_4_uncleanable_persistent_durations_list, select=-c(agent,iteration))

agent_list_areas <- as.vector(agents_list_index_4$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_index_4$min_duration_10min)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_index_4$mean_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$q1_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$median_duration_10min)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$q3_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$max_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$contamination_events_10min)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$times_persistent_10min)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$min_persistent_duration_10min)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$mean_persistent_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$q1_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$median_persistent_duration_10min)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$q3_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$max_persistent_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$mean_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_4$balanced_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_02A4")

aux_data_index_4_10min <- aux_data

aux_data_index_4_10min_durations_all <- aux_data_index_4_10min[which(aux_data_index_4_10min$type=="Minimum Duration (All)" | aux_data_index_4_10min$type=="Mean Duration (All)" | aux_data_index_4_10min$type=="C. Duration Q1 (All)" | aux_data_index_4_10min$type=="Median Duration (All)" | aux_data_index_4_10min$type=="C. Duration Q3 (All)" | aux_data_index_4_10min$type=="Maximum Duration (All)"),]

aux_data_index_4_10min_durations_per <- aux_data_index_4_10min[which(aux_data_index_4_10min$type=="Minimum Duration (Per)" | aux_data_index_4_10min$type=="Mean Duration (Per)" | aux_data_index_4_10min$type=="C. Duration Q1 (Per)" | aux_data_index_4_10min$type=="Median Duration (Per)" | aux_data_index_4_10min$type=="C. Duration Q3 (Per)" | aux_data_index_4_10min$type=="Maximum Duration (Per)"),]

aux_data_index_4_10min_freq_count <- aux_data_index_4_10min[which(aux_data_index_4_10min$type=="Times Contaminated" | aux_data_index_4_10min$type=="Times Persistent"),]

aux_data_index_4_10min_mean_per_freq <- aux_data_index_4_10min[which(aux_data_index_4_10min$type=="Mean Times Persistent (Overall)" | aux_data_index_4_10min$type=="Mean Times Persistent (Per It.)"),]

aux_data_index_4_10min_durations_list <- Facility_B_durations_index_4
aux_data_index_4_10min_durations_list$scenario <- as.factor("XI_02A4")
aux_data_index_4_10min_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_index_4_10min)==0) {
#   aux_data_index_4_10min_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_4_10min_transient_durations_list <- as.data.frame(transient_durations_list_index_4_10min) 
# }
# aux_data_index_4_10min_transient_durations_list$scenario <- as.factor("XI_02A4")
# aux_data_index_4_10min_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_index_4_10min_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_index_4_10min$duration)==0) {
  aux_data_index_4_10min_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_4_10min_long_transient_durations_list <- as.data.frame(transient_long_durations_list_index_4_10min) 
}
aux_data_index_4_10min_long_transient_durations_list$scenario <- as.factor("XI_02A4")
aux_data_index_4_10min_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_index_4_10min_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_4_10min_long_transient_durations_list <- subset(aux_data_index_4_10min_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_index_4_10min$duration)==0) {
  aux_data_index_4_10min_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_4_10min_short_transient_durations_list <- as.data.frame(transient_short_durations_list_index_4_10min) 
}
aux_data_index_4_10min_short_transient_durations_list$scenario <- as.factor("XI_02A4")
aux_data_index_4_10min_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_index_4_10min_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_4_10min_short_transient_durations_list <- subset(aux_data_index_4_10min_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_index_4_10min$duration)==0) {
  aux_data_index_4_10min_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_4_10min_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_index_4_10min) 
}
aux_data_index_4_10min_uncleanable_transient_durations_list$scenario <- as.factor("XI_02A4")
aux_data_index_4_10min_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_index_4_10min_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_4_10min_uncleanable_transient_durations_list <- subset(aux_data_index_4_10min_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_index_4_10min)==0) {
#   aux_data_index_4_10min_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_4_10min_persistent_durations_list <- as.data.frame(persistent_durations_list_index_4_10min) 
# }
# aux_data_index_4_10min_persistent_durations_list$scenario <- as.factor("XI_02A4")
# aux_data_index_4_10min_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_index_4_10min_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(excess_durations_list_index_4_10min)==0) {
#   aux_data_index_4_10min_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_4_10min_excess_durations_list <- as.data.frame(excess_durations_list_index_4_10min) 
# }
# aux_data_index_4_10min_excess_durations_list$scenario <- as.factor("XI_02A4")
# aux_data_index_4_10min_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_index_4_10min_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_index_4_10min$duration)==0) {
  aux_data_index_4_10min_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_4_10min_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_index_4_10min) 
}
aux_data_index_4_10min_long_persistent_durations_list$scenario <- as.factor("XI_02A4")
aux_data_index_4_10min_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_index_4_10min_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_4_10min_long_persistent_durations_list <- subset(aux_data_index_4_10min_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_index_4_10min$duration)==0) {
  aux_data_index_4_10min_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_4_10min_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_index_4_10min) 
}
aux_data_index_4_10min_short_persistent_durations_list$scenario <- as.factor("XI_02A4")
aux_data_index_4_10min_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_index_4_10min_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_4_10min_short_persistent_durations_list <- subset(aux_data_index_4_10min_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_index_4_10min$duration)==0) {
  aux_data_index_4_10min_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_4_10min_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_index_4_10min) 
}
aux_data_index_4_10min_uncleanable_persistent_durations_list$scenario <- as.factor("XI_02A4")
aux_data_index_4_10min_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_index_4_10min_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_4_10min_uncleanable_persistent_durations_list <- subset(aux_data_index_4_10min_uncleanable_persistent_durations_list, select=-c(agent,iteration))

#XI_02A5####
agent_list_areas <- as.vector(agents_list_index_5$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_index_5$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_index_5$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_02A5")

aux_data_index_5 <- aux_data

aux_data_index_5_durations_all <- aux_data_index_5[which(aux_data_index_5$type=="Minimum Duration (All)" | aux_data_index_5$type=="Mean Duration (All)" | aux_data_index_5$type=="C. Duration Q1 (All)" | aux_data_index_5$type=="Median Duration (All)" | aux_data_index_5$type=="C. Duration Q3 (All)" | aux_data_index_5$type=="Maximum Duration (All)"),]

aux_data_index_5_durations_per <- aux_data_index_5[which(aux_data_index_5$type=="Minimum Duration (Per)" | aux_data_index_5$type=="Mean Duration (Per)" | aux_data_index_5$type=="C. Duration Q1 (Per)" | aux_data_index_5$type=="Median Duration (Per)" | aux_data_index_5$type=="C. Duration Q3 (Per)" | aux_data_index_5$type=="Maximum Duration (Per)"),]

aux_data_index_5_freq_count <- aux_data_index_5[which(aux_data_index_5$type=="Times Contaminated" | aux_data_index_5$type=="Times Persistent"),]

aux_data_index_5_mean_per_freq <- aux_data_index_5[which(aux_data_index_5$type=="Mean Times Persistent (Overall)" | aux_data_index_5$type=="Mean Times Persistent (Per It.)"),]

aux_data_index_5_durations_list <- Facility_B_durations_index_5
aux_data_index_5_durations_list$scenario <- as.factor("XI_02A5")
aux_data_index_5_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_index_5)==0) {
#   aux_data_index_5_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_5_transient_durations_list <- as.data.frame(transient_durations_list_index_5)
# }
# aux_data_index_5_transient_durations_list$scenario <- as.factor("XI_02A5")
# aux_data_index_5_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_index_5_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_index_5$duration)==0) {
  aux_data_index_5_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_5_long_transient_durations_list <- as.data.frame(transient_long_durations_list_index_5) 
}
aux_data_index_5_long_transient_durations_list$scenario <- as.factor("XI_02A5")
aux_data_index_5_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_index_5_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_5_long_transient_durations_list <- subset(aux_data_index_5_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_index_5$duration)==0) {
  aux_data_index_5_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_5_short_transient_durations_list <- as.data.frame(transient_short_durations_list_index_5) 
}
aux_data_index_5_short_transient_durations_list$scenario <- as.factor("XI_02A5")
aux_data_index_5_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_index_5_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_5_short_transient_durations_list <- subset(aux_data_index_5_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_index_5$duration)==0) {
  aux_data_index_5_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_5_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_index_5) 
}
aux_data_index_5_uncleanable_transient_durations_list$scenario <- as.factor("XI_02A5")
aux_data_index_5_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_index_5_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_5_uncleanable_transient_durations_list <- subset(aux_data_index_5_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_index_5)==0) {
#   aux_data_index_5_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_5_persistent_durations_list <- as.data.frame(persistent_durations_list_index_5) 
# }
# aux_data_index_5_persistent_durations_list$scenario <- as.factor("XI_02A5")
# aux_data_index_5_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_index_5_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(persistent_long_durations_list_index_5$duration)==0) {
#   aux_data_index_5_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_5_excess_durations_list <- as.data.frame(excess_durations_list_index_5) 
# }
# aux_data_index_5_excess_durations_list$scenario <- as.factor("XI_02A5")
# aux_data_index_5_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_index_5_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_index_5$duration)==0) {
  aux_data_index_5_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_5_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_index_5) 
}
aux_data_index_5_long_persistent_durations_list$scenario <- as.factor("XI_02A5")
aux_data_index_5_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_index_5_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_5_long_persistent_durations_list <- subset(aux_data_index_5_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_index_5$duration)==0) {
  aux_data_index_5_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_5_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_index_5) 
}
aux_data_index_5_short_persistent_durations_list$scenario <- as.factor("XI_02A5")
aux_data_index_5_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_index_5_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_5_short_persistent_durations_list <- subset(aux_data_index_5_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_index_5$duration)==0) {
  aux_data_index_5_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_5_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_index_5) 
}
aux_data_index_5_uncleanable_persistent_durations_list$scenario <- as.factor("XI_02A5")
aux_data_index_5_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_index_5_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_5_uncleanable_persistent_durations_list <- subset(aux_data_index_5_uncleanable_persistent_durations_list, select=-c(agent,iteration))

agent_list_areas <- as.vector(agents_list_index_5$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_index_5$min_duration_10min)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_index_5$mean_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$q1_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$median_duration_10min)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$q3_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$max_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$contamination_events_10min)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$times_persistent_10min)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$min_persistent_duration_10min)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$mean_persistent_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$q1_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$median_persistent_duration_10min)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$q3_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$max_persistent_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$mean_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_5$balanced_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_02A5")

aux_data_index_5_10min <- aux_data

aux_data_index_5_10min_durations_all <- aux_data_index_5_10min[which(aux_data_index_5_10min$type=="Minimum Duration (All)" | aux_data_index_5_10min$type=="Mean Duration (All)" | aux_data_index_5_10min$type=="C. Duration Q1 (All)" | aux_data_index_5_10min$type=="Median Duration (All)" | aux_data_index_5_10min$type=="C. Duration Q3 (All)" | aux_data_index_5_10min$type=="Maximum Duration (All)"),]

aux_data_index_5_10min_durations_per <- aux_data_index_5_10min[which(aux_data_index_5_10min$type=="Minimum Duration (Per)" | aux_data_index_5_10min$type=="Mean Duration (Per)" | aux_data_index_5_10min$type=="C. Duration Q1 (Per)" | aux_data_index_5_10min$type=="Median Duration (Per)" | aux_data_index_5_10min$type=="C. Duration Q3 (Per)" | aux_data_index_5_10min$type=="Maximum Duration (Per)"),]

aux_data_index_5_10min_freq_count <- aux_data_index_5_10min[which(aux_data_index_5_10min$type=="Times Contaminated" | aux_data_index_5_10min$type=="Times Persistent"),]

aux_data_index_5_10min_mean_per_freq <- aux_data_index_5_10min[which(aux_data_index_5_10min$type=="Mean Times Persistent (Overall)" | aux_data_index_5_10min$type=="Mean Times Persistent (Per It.)"),]

aux_data_index_5_10min_durations_list <- Facility_B_durations_index_5
aux_data_index_5_10min_durations_list$scenario <- as.factor("XI_02A5")
aux_data_index_5_10min_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_index_5_10min)==0) {
#   aux_data_index_5_10min_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_5_10min_transient_durations_list <- as.data.frame(transient_durations_list_index_5_10min) 
# }
# aux_data_index_5_10min_transient_durations_list$scenario <- as.factor("XI_02A5")
# aux_data_index_5_10min_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_index_5_10min_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_index_5_10min$duration)==0) {
  aux_data_index_5_10min_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_5_10min_long_transient_durations_list <- as.data.frame(transient_long_durations_list_index_5_10min) 
}
aux_data_index_5_10min_long_transient_durations_list$scenario <- as.factor("XI_02A5")
aux_data_index_5_10min_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_index_5_10min_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_5_10min_long_transient_durations_list <- subset(aux_data_index_5_10min_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_index_5_10min$duration)==0) {
  aux_data_index_5_10min_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_5_10min_short_transient_durations_list <- as.data.frame(transient_short_durations_list_index_5_10min) 
}
aux_data_index_5_10min_short_transient_durations_list$scenario <- as.factor("XI_02A5")
aux_data_index_5_10min_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_index_5_10min_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_5_10min_short_transient_durations_list <- subset(aux_data_index_5_10min_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_index_5_10min$duration)==0) {
  aux_data_index_5_10min_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_5_10min_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_index_5_10min) 
}
aux_data_index_5_10min_uncleanable_transient_durations_list$scenario <- as.factor("XI_02A5")
aux_data_index_5_10min_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_index_5_10min_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_5_10min_uncleanable_transient_durations_list <- subset(aux_data_index_5_10min_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_index_5_10min)==0) {
#   aux_data_index_5_10min_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_5_10min_persistent_durations_list <- as.data.frame(persistent_durations_list_index_5_10min) 
# }
# aux_data_index_5_10min_persistent_durations_list$scenario <- as.factor("XI_02A5")
# aux_data_index_5_10min_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_index_5_10min_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(excess_durations_list_index_5_10min)==0) {
#   aux_data_index_5_10min_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_5_10min_excess_durations_list <- as.data.frame(excess_durations_list_index_5_10min) 
# }
# aux_data_index_5_10min_excess_durations_list$scenario <- as.factor("XI_02A5")
# aux_data_index_5_10min_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_index_5_10min_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_index_5_10min$duration)==0) {
  aux_data_index_5_10min_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_5_10min_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_index_5_10min) 
}
aux_data_index_5_10min_long_persistent_durations_list$scenario <- as.factor("XI_02A5")
aux_data_index_5_10min_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_index_5_10min_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_5_10min_long_persistent_durations_list <- subset(aux_data_index_5_10min_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_index_5_10min$duration)==0) {
  aux_data_index_5_10min_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_5_10min_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_index_5_10min) 
}
aux_data_index_5_10min_short_persistent_durations_list$scenario <- as.factor("XI_02A5")
aux_data_index_5_10min_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_index_5_10min_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_5_10min_short_persistent_durations_list <- subset(aux_data_index_5_10min_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_index_5_10min$duration)==0) {
  aux_data_index_5_10min_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_5_10min_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_index_5_10min) 
}
aux_data_index_5_10min_uncleanable_persistent_durations_list$scenario <- as.factor("XI_02A5")
aux_data_index_5_10min_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_index_5_10min_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_5_10min_uncleanable_persistent_durations_list <- subset(aux_data_index_5_10min_uncleanable_persistent_durations_list, select=-c(agent,iteration))

#XI_02A6####
agent_list_areas <- as.vector(agents_list_index_6$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_index_6$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_index_6$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_02A6")

aux_data_index_6 <- aux_data

aux_data_index_6_durations_all <- aux_data_index_6[which(aux_data_index_6$type=="Minimum Duration (All)" | aux_data_index_6$type=="Mean Duration (All)" | aux_data_index_6$type=="C. Duration Q1 (All)" | aux_data_index_6$type=="Median Duration (All)" | aux_data_index_6$type=="C. Duration Q3 (All)" | aux_data_index_6$type=="Maximum Duration (All)"),]

aux_data_index_6_durations_per <- aux_data_index_6[which(aux_data_index_6$type=="Minimum Duration (Per)" | aux_data_index_6$type=="Mean Duration (Per)" | aux_data_index_6$type=="C. Duration Q1 (Per)" | aux_data_index_6$type=="Median Duration (Per)" | aux_data_index_6$type=="C. Duration Q3 (Per)" | aux_data_index_6$type=="Maximum Duration (Per)"),]

aux_data_index_6_freq_count <- aux_data_index_6[which(aux_data_index_6$type=="Times Contaminated" | aux_data_index_6$type=="Times Persistent"),]

aux_data_index_6_mean_per_freq <- aux_data_index_6[which(aux_data_index_6$type=="Mean Times Persistent (Overall)" | aux_data_index_6$type=="Mean Times Persistent (Per It.)"),]

aux_data_index_6_durations_list <- Facility_B_durations_index_6
aux_data_index_6_durations_list$scenario <- as.factor("XI_02A6")
aux_data_index_6_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_index_6)==0) {
#   aux_data_index_6_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_6_transient_durations_list <- as.data.frame(transient_durations_list_index_6)
# }
# aux_data_index_6_transient_durations_list$scenario <- as.factor("XI_02A6")
# aux_data_index_6_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_index_6_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_index_6$duration)==0) {
  aux_data_index_6_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_6_long_transient_durations_list <- as.data.frame(transient_long_durations_list_index_6) 
}
aux_data_index_6_long_transient_durations_list$scenario <- as.factor("XI_02A6")
aux_data_index_6_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_index_6_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_6_long_transient_durations_list <- subset(aux_data_index_6_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_index_6$duration)==0) {
  aux_data_index_6_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_6_short_transient_durations_list <- as.data.frame(transient_short_durations_list_index_6) 
}
aux_data_index_6_short_transient_durations_list$scenario <- as.factor("XI_02A6")
aux_data_index_6_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_index_6_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_6_short_transient_durations_list <- subset(aux_data_index_6_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_index_6$duration)==0) {
  aux_data_index_6_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_6_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_index_6) 
}
aux_data_index_6_uncleanable_transient_durations_list$scenario <- as.factor("XI_02A6")
aux_data_index_6_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_index_6_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_6_uncleanable_transient_durations_list <- subset(aux_data_index_6_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_index_6)==0) {
#   aux_data_index_6_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_6_persistent_durations_list <- as.data.frame(persistent_durations_list_index_6) 
# }
# aux_data_index_6_persistent_durations_list$scenario <- as.factor("XI_02A6")
# aux_data_index_6_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_index_6_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(excess_durations_list_index_6$duration)==0) {
#   aux_data_index_6_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_6_excess_durations_list <- as.data.frame(excess_durations_list_index_6) 
# }
# aux_data_index_6_excess_durations_list$scenario <- as.factor("XI_02A6")
# aux_data_index_6_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_index_6_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_index_6$duration)==0) {
  aux_data_index_6_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_6_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_index_6) 
}
aux_data_index_6_long_persistent_durations_list$scenario <- as.factor("XI_02A6")
aux_data_index_6_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_index_6_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_6_long_persistent_durations_list <- subset(aux_data_index_6_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_index_6$duration)==0) {
  aux_data_index_6_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_6_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_index_6) 
}
aux_data_index_6_short_persistent_durations_list$scenario <- as.factor("XI_02A6")
aux_data_index_6_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_index_6_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_6_short_persistent_durations_list <- subset(aux_data_index_6_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_index_6$duration)==0) {
  aux_data_index_6_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_6_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_index_6) 
}
aux_data_index_6_uncleanable_persistent_durations_list$scenario <- as.factor("XI_02A6")
aux_data_index_6_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_index_6_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_6_uncleanable_persistent_durations_list <- subset(aux_data_index_6_uncleanable_persistent_durations_list, select=-c(agent,iteration))

agent_list_areas <- as.vector(agents_list_index_6$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_index_6$min_duration_10min)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_index_6$mean_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$q1_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$median_duration_10min)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$q3_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$max_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$contamination_events_10min)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$times_persistent_10min)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$min_persistent_duration_10min)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$mean_persistent_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$q1_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$median_persistent_duration_10min)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$q3_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$max_persistent_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$mean_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_index_6$balanced_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("XI_02A6")

aux_data_index_6_10min <- aux_data

aux_data_index_6_10min_durations_all <- aux_data_index_6_10min[which(aux_data_index_6_10min$type=="Minimum Duration (All)" | aux_data_index_6_10min$type=="Mean Duration (All)" | aux_data_index_6_10min$type=="C. Duration Q1 (All)" | aux_data_index_6_10min$type=="Median Duration (All)" | aux_data_index_6_10min$type=="C. Duration Q3 (All)" | aux_data_index_6_10min$type=="Maximum Duration (All)"),]

aux_data_index_6_10min_durations_per <- aux_data_index_6_10min[which(aux_data_index_6_10min$type=="Minimum Duration (Per)" | aux_data_index_6_10min$type=="Mean Duration (Per)" | aux_data_index_6_10min$type=="C. Duration Q1 (Per)" | aux_data_index_6_10min$type=="Median Duration (Per)" | aux_data_index_6_10min$type=="C. Duration Q3 (Per)" | aux_data_index_6_10min$type=="Maximum Duration (Per)"),]

aux_data_index_6_10min_freq_count <- aux_data_index_6_10min[which(aux_data_index_6_10min$type=="Times Contaminated" | aux_data_index_6_10min$type=="Times Persistent"),]

aux_data_index_6_10min_mean_per_freq <- aux_data_index_6_10min[which(aux_data_index_6_10min$type=="Mean Times Persistent (Overall)" | aux_data_index_6_10min$type=="Mean Times Persistent (Per It.)"),]

aux_data_index_6_10min_durations_list <- Facility_B_durations_index_6
aux_data_index_6_10min_durations_list$scenario <- as.factor("XI_02A6")
aux_data_index_6_10min_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_index_6_10min)==0) {
#   aux_data_index_6_10min_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_6_10min_transient_durations_list <- as.data.frame(transient_durations_list_index_6_10min) 
# }
# aux_data_index_6_10min_transient_durations_list$scenario <- as.factor("XI_02A6")
# aux_data_index_6_10min_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_index_6_10min_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_index_6_10min$duration)==0) {
  aux_data_index_6_10min_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_6_10min_long_transient_durations_list <- as.data.frame(transient_long_durations_list_index_6_10min) 
}
aux_data_index_6_10min_long_transient_durations_list$scenario <- as.factor("XI_02A6")
aux_data_index_6_10min_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_index_6_10min_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_6_10min_long_transient_durations_list <- subset(aux_data_index_6_10min_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_index_6_10min$duration)==0) {
  aux_data_index_6_10min_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_6_10min_short_transient_durations_list <- as.data.frame(transient_short_durations_list_index_6_10min) 
}
aux_data_index_6_10min_short_transient_durations_list$scenario <- as.factor("XI_02A6")
aux_data_index_6_10min_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_index_6_10min_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_6_10min_short_transient_durations_list <- subset(aux_data_index_6_10min_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_index_6_10min$duration)==0) {
  aux_data_index_6_10min_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_6_10min_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_index_6_10min) 
}
aux_data_index_6_10min_uncleanable_transient_durations_list$scenario <- as.factor("XI_02A6")
aux_data_index_6_10min_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_index_6_10min_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_6_10min_uncleanable_transient_durations_list <- subset(aux_data_index_6_10min_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_index_6_10min)==0) {
#   aux_data_index_6_10min_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_6_10min_persistent_durations_list <- as.data.frame(persistent_durations_list_index_6_10min) 
# }
# aux_data_index_6_10min_persistent_durations_list$scenario <- as.factor("XI_02A6")
# aux_data_index_6_10min_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_index_6_10min_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(excess_durations_list_index_6_10min)==0) {
#   aux_data_index_6_10min_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_index_6_10min_excess_durations_list <- as.data.frame(excess_durations_list_index_6_10min) 
# }
# aux_data_index_6_10min_excess_durations_list$scenario <- as.factor("XI_02A6")
# aux_data_index_6_10min_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_index_6_10min_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_index_6_10min$duration)==0) {
  aux_data_index_6_10min_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_6_10min_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_index_6_10min) 
}
aux_data_index_6_10min_long_persistent_durations_list$scenario <- as.factor("XI_02A6")
aux_data_index_6_10min_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_index_6_10min_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_6_10min_long_persistent_durations_list <- subset(aux_data_index_6_10min_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_index_6_10min$duration)==0) {
  aux_data_index_6_10min_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_6_10min_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_index_6_10min) 
}
aux_data_index_6_10min_short_persistent_durations_list$scenario <- as.factor("XI_02A6")
aux_data_index_6_10min_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_index_6_10min_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_6_10min_short_persistent_durations_list <- subset(aux_data_index_6_10min_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_index_6_10min$duration)==0) {
  aux_data_index_6_10min_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_index_6_10min_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_index_6_10min) 
}
aux_data_index_6_10min_uncleanable_persistent_durations_list$scenario <- as.factor("XI_02A6")
aux_data_index_6_10min_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_index_6_10min_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_index_6_10min_uncleanable_persistent_durations_list <- subset(aux_data_index_6_10min_uncleanable_persistent_durations_list, select=-c(agent,iteration))

#EC_01####
agent_list_areas <- as.vector(agents_list_crate_prev_75pc$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_crate_prev_75pc$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("EC_01")

aux_data_crate_prev_75pc <- aux_data

aux_data_crate_prev_75pc_durations_all <- aux_data_crate_prev_75pc[which(aux_data_crate_prev_75pc$type=="Minimum Duration (All)" | aux_data_crate_prev_75pc$type=="Mean Duration (All)" | aux_data_crate_prev_75pc$type=="C. Duration Q1 (All)" | aux_data_crate_prev_75pc$type=="Median Duration (All)" | aux_data_crate_prev_75pc$type=="C. Duration Q3 (All)" | aux_data_crate_prev_75pc$type=="Maximum Duration (All)"),]

aux_data_crate_prev_75pc_durations_per <- aux_data_crate_prev_75pc[which(aux_data_crate_prev_75pc$type=="Minimum Duration (Per)" | aux_data_crate_prev_75pc$type=="Mean Duration (Per)" | aux_data_crate_prev_75pc$type=="C. Duration Q1 (Per)" | aux_data_crate_prev_75pc$type=="Median Duration (Per)" | aux_data_crate_prev_75pc$type=="C. Duration Q3 (Per)" | aux_data_crate_prev_75pc$type=="Maximum Duration (Per)"),]

aux_data_crate_prev_75pc_freq_count <- aux_data_crate_prev_75pc[which(aux_data_crate_prev_75pc$type=="Times Contaminated" | aux_data_crate_prev_75pc$type=="Times Persistent"),]

aux_data_crate_prev_75pc_mean_per_freq <- aux_data_crate_prev_75pc[which(aux_data_crate_prev_75pc$type=="Mean Times Persistent (Overall)" | aux_data_crate_prev_75pc$type=="Mean Times Persistent (Per It.)"),]

aux_data_crate_prev_75pc_durations_list <- Facility_B_durations_crate_prev_75pc
aux_data_crate_prev_75pc_durations_list$scenario <- as.factor("EC_01")
aux_data_crate_prev_75pc_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_crate_prev_75pc)==0) {
#   aux_data_crate_prev_75pc_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_75pc_transient_durations_list <- as.data.frame(transient_durations_list_crate_prev_75pc)
# }
# aux_data_crate_prev_75pc_transient_durations_list$scenario <- as.factor("EC_01")
# aux_data_crate_prev_75pc_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_crate_prev_75pc_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_crate_prev_75pc$duration)==0) {
  aux_data_crate_prev_75pc_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_75pc_long_transient_durations_list <- as.data.frame(transient_long_durations_list_crate_prev_75pc) 
}
aux_data_crate_prev_75pc_long_transient_durations_list$scenario <- as.factor("EC_01")
aux_data_crate_prev_75pc_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_crate_prev_75pc_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_75pc_long_transient_durations_list <- subset(aux_data_crate_prev_75pc_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_crate_prev_75pc$duration)==0) {
  aux_data_crate_prev_75pc_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_75pc_short_transient_durations_list <- as.data.frame(transient_short_durations_list_crate_prev_75pc) 
}
aux_data_crate_prev_75pc_short_transient_durations_list$scenario <- as.factor("EC_01")
aux_data_crate_prev_75pc_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_crate_prev_75pc_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_75pc_short_transient_durations_list <- subset(aux_data_crate_prev_75pc_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_crate_prev_75pc$duration)==0) {
  aux_data_crate_prev_75pc_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_75pc_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_crate_prev_75pc) 
}
aux_data_crate_prev_75pc_uncleanable_transient_durations_list$scenario <- as.factor("EC_01")
aux_data_crate_prev_75pc_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_crate_prev_75pc_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_75pc_uncleanable_transient_durations_list <- subset(aux_data_crate_prev_75pc_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_crate_prev_75pc)==0) {
#   aux_data_crate_prev_75pc_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_75pc_persistent_durations_list <- as.data.frame(persistent_durations_list_crate_prev_75pc) 
# }
# aux_data_crate_prev_75pc_persistent_durations_list$scenario <- as.factor("EC_01")
# aux_data_crate_prev_75pc_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_crate_prev_75pc_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(persistent_long_durations_list_crate_prev_75pc$duration)==0) {
#   aux_data_crate_prev_75pc_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_75pc_excess_durations_list <- as.data.frame(excess_durations_list_crate_prev_75pc) 
# }
# aux_data_crate_prev_75pc_excess_durations_list$scenario <- as.factor("EC_01")
# aux_data_crate_prev_75pc_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_crate_prev_75pc_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_crate_prev_75pc$duration)==0) {
  aux_data_crate_prev_75pc_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_75pc_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_crate_prev_75pc) 
}
aux_data_crate_prev_75pc_long_persistent_durations_list$scenario <- as.factor("EC_01")
aux_data_crate_prev_75pc_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_crate_prev_75pc_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_75pc_long_persistent_durations_list <- subset(aux_data_crate_prev_75pc_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_crate_prev_75pc$duration)==0) {
  aux_data_crate_prev_75pc_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_75pc_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_crate_prev_75pc) 
}
aux_data_crate_prev_75pc_short_persistent_durations_list$scenario <- as.factor("EC_01")
aux_data_crate_prev_75pc_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_crate_prev_75pc_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_75pc_short_persistent_durations_list <- subset(aux_data_crate_prev_75pc_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_crate_prev_75pc$duration)==0) {
  aux_data_crate_prev_75pc_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_75pc_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_crate_prev_75pc) 
}
aux_data_crate_prev_75pc_uncleanable_persistent_durations_list$scenario <- as.factor("EC_01")
aux_data_crate_prev_75pc_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_crate_prev_75pc_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_75pc_uncleanable_persistent_durations_list <- subset(aux_data_crate_prev_75pc_uncleanable_persistent_durations_list, select=-c(agent,iteration))

agent_list_areas <- as.vector(agents_list_crate_prev_75pc$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_crate_prev_75pc$min_duration_10min)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$mean_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$q1_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$median_duration_10min)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$q3_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$max_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$contamination_events_10min)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$times_persistent_10min)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$min_persistent_duration_10min)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$mean_persistent_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$q1_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$median_persistent_duration_10min)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$q3_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$max_persistent_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$mean_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_75pc$balanced_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("EC_01")

aux_data_crate_prev_75pc_10min <- aux_data

aux_data_crate_prev_75pc_10min_durations_all <- aux_data_crate_prev_75pc_10min[which(aux_data_crate_prev_75pc_10min$type=="Minimum Duration (All)" | aux_data_crate_prev_75pc_10min$type=="Mean Duration (All)" | aux_data_crate_prev_75pc_10min$type=="C. Duration Q1 (All)" | aux_data_crate_prev_75pc_10min$type=="Median Duration (All)" | aux_data_crate_prev_75pc_10min$type=="C. Duration Q3 (All)" | aux_data_crate_prev_75pc_10min$type=="Maximum Duration (All)"),]

aux_data_crate_prev_75pc_10min_durations_per <- aux_data_crate_prev_75pc_10min[which(aux_data_crate_prev_75pc_10min$type=="Minimum Duration (Per)" | aux_data_crate_prev_75pc_10min$type=="Mean Duration (Per)" | aux_data_crate_prev_75pc_10min$type=="C. Duration Q1 (Per)" | aux_data_crate_prev_75pc_10min$type=="Median Duration (Per)" | aux_data_crate_prev_75pc_10min$type=="C. Duration Q3 (Per)" | aux_data_crate_prev_75pc_10min$type=="Maximum Duration (Per)"),]

aux_data_crate_prev_75pc_10min_freq_count <- aux_data_crate_prev_75pc_10min[which(aux_data_crate_prev_75pc_10min$type=="Times Contaminated" | aux_data_crate_prev_75pc_10min$type=="Times Persistent"),]

aux_data_crate_prev_75pc_10min_mean_per_freq <- aux_data_crate_prev_75pc_10min[which(aux_data_crate_prev_75pc_10min$type=="Mean Times Persistent (Overall)" | aux_data_crate_prev_75pc_10min$type=="Mean Times Persistent (Per It.)"),]

aux_data_crate_prev_75pc_10min_durations_list <- Facility_B_durations_crate_prev_75pc
aux_data_crate_prev_75pc_10min_durations_list$scenario <- as.factor("EC_01")
aux_data_crate_prev_75pc_10min_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_crate_prev_75pc_10min)==0) {
#   aux_data_crate_prev_75pc_10min_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_75pc_10min_transient_durations_list <- as.data.frame(transient_durations_list_crate_prev_75pc_10min) 
# }
# aux_data_crate_prev_75pc_10min_transient_durations_list$scenario <- as.factor("EC_01")
# aux_data_crate_prev_75pc_10min_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_crate_prev_75pc_10min_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_crate_prev_75pc_10min$duration)==0) {
  aux_data_crate_prev_75pc_10min_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_75pc_10min_long_transient_durations_list <- as.data.frame(transient_long_durations_list_crate_prev_75pc_10min) 
}
aux_data_crate_prev_75pc_10min_long_transient_durations_list$scenario <- as.factor("EC_01")
aux_data_crate_prev_75pc_10min_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_crate_prev_75pc_10min_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_75pc_10min_long_transient_durations_list <- subset(aux_data_crate_prev_75pc_10min_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_crate_prev_75pc_10min$duration)==0) {
  aux_data_crate_prev_75pc_10min_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_75pc_10min_short_transient_durations_list <- as.data.frame(transient_short_durations_list_crate_prev_75pc_10min) 
}
aux_data_crate_prev_75pc_10min_short_transient_durations_list$scenario <- as.factor("EC_01")
aux_data_crate_prev_75pc_10min_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_crate_prev_75pc_10min_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_75pc_10min_short_transient_durations_list <- subset(aux_data_crate_prev_75pc_10min_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_crate_prev_75pc_10min$duration)==0) {
  aux_data_crate_prev_75pc_10min_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_75pc_10min_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_crate_prev_75pc_10min) 
}
aux_data_crate_prev_75pc_10min_uncleanable_transient_durations_list$scenario <- as.factor("EC_01")
aux_data_crate_prev_75pc_10min_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_crate_prev_75pc_10min_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_75pc_10min_uncleanable_transient_durations_list <- subset(aux_data_crate_prev_75pc_10min_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_crate_prev_75pc_10min)==0) {
#   aux_data_crate_prev_75pc_10min_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_75pc_10min_persistent_durations_list <- as.data.frame(persistent_durations_list_crate_prev_75pc_10min) 
# }
# aux_data_crate_prev_75pc_10min_persistent_durations_list$scenario <- as.factor("EC_01")
# aux_data_crate_prev_75pc_10min_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_crate_prev_75pc_10min_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(excess_durations_list_crate_prev_75pc_10min)==0) {
#   aux_data_crate_prev_75pc_10min_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_75pc_10min_excess_durations_list <- as.data.frame(excess_durations_list_crate_prev_75pc_10min) 
# }
# aux_data_crate_prev_75pc_10min_excess_durations_list$scenario <- as.factor("EC_01")
# aux_data_crate_prev_75pc_10min_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_crate_prev_75pc_10min_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_crate_prev_75pc_10min$duration)==0) {
  aux_data_crate_prev_75pc_10min_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_75pc_10min_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_crate_prev_75pc_10min) 
}
aux_data_crate_prev_75pc_10min_long_persistent_durations_list$scenario <- as.factor("EC_01")
aux_data_crate_prev_75pc_10min_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_crate_prev_75pc_10min_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_75pc_10min_long_persistent_durations_list <- subset(aux_data_crate_prev_75pc_10min_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_crate_prev_75pc_10min$duration)==0) {
  aux_data_crate_prev_75pc_10min_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_75pc_10min_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_crate_prev_75pc_10min) 
}
aux_data_crate_prev_75pc_10min_short_persistent_durations_list$scenario <- as.factor("EC_01")
aux_data_crate_prev_75pc_10min_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_crate_prev_75pc_10min_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_75pc_10min_short_persistent_durations_list <- subset(aux_data_crate_prev_75pc_10min_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_crate_prev_75pc_10min$duration)==0) {
  aux_data_crate_prev_75pc_10min_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_75pc_10min_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_crate_prev_75pc_10min) 
}
aux_data_crate_prev_75pc_10min_uncleanable_persistent_durations_list$scenario <- as.factor("EC_01")
aux_data_crate_prev_75pc_10min_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_crate_prev_75pc_10min_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_75pc_10min_uncleanable_persistent_durations_list <- subset(aux_data_crate_prev_75pc_10min_uncleanable_persistent_durations_list, select=-c(agent,iteration))

#EC_02####
agent_list_areas <- as.vector(agents_list_crate_prev_50pc$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_crate_prev_50pc$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("EC_02")

aux_data_crate_prev_50pc <- aux_data

aux_data_crate_prev_50pc_durations_all <- aux_data_crate_prev_50pc[which(aux_data_crate_prev_50pc$type=="Minimum Duration (All)" | aux_data_crate_prev_50pc$type=="Mean Duration (All)" | aux_data_crate_prev_50pc$type=="C. Duration Q1 (All)" | aux_data_crate_prev_50pc$type=="Median Duration (All)" | aux_data_crate_prev_50pc$type=="C. Duration Q3 (All)" | aux_data_crate_prev_50pc$type=="Maximum Duration (All)"),]

aux_data_crate_prev_50pc_durations_per <- aux_data_crate_prev_50pc[which(aux_data_crate_prev_50pc$type=="Minimum Duration (Per)" | aux_data_crate_prev_50pc$type=="Mean Duration (Per)" | aux_data_crate_prev_50pc$type=="C. Duration Q1 (Per)" | aux_data_crate_prev_50pc$type=="Median Duration (Per)" | aux_data_crate_prev_50pc$type=="C. Duration Q3 (Per)" | aux_data_crate_prev_50pc$type=="Maximum Duration (Per)"),]

aux_data_crate_prev_50pc_freq_count <- aux_data_crate_prev_50pc[which(aux_data_crate_prev_50pc$type=="Times Contaminated" | aux_data_crate_prev_50pc$type=="Times Persistent"),]

aux_data_crate_prev_50pc_mean_per_freq <- aux_data_crate_prev_50pc[which(aux_data_crate_prev_50pc$type=="Mean Times Persistent (Overall)" | aux_data_crate_prev_50pc$type=="Mean Times Persistent (Per It.)"),]

aux_data_crate_prev_50pc_durations_list <- Facility_B_durations_crate_prev_50pc
aux_data_crate_prev_50pc_durations_list$scenario <- as.factor("EC_02")
aux_data_crate_prev_50pc_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_crate_prev_50pc)==0) {
#   aux_data_crate_prev_50pc_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_50pc_transient_durations_list <- as.data.frame(transient_durations_list_crate_prev_50pc)
# }
# aux_data_crate_prev_50pc_transient_durations_list$scenario <- as.factor("EC_02")
# aux_data_crate_prev_50pc_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_crate_prev_50pc_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_crate_prev_50pc$duration)==0) {
  aux_data_crate_prev_50pc_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_50pc_long_transient_durations_list <- as.data.frame(transient_long_durations_list_crate_prev_50pc) 
}
aux_data_crate_prev_50pc_long_transient_durations_list$scenario <- as.factor("EC_02")
aux_data_crate_prev_50pc_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_crate_prev_50pc_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_50pc_long_transient_durations_list <- subset(aux_data_crate_prev_50pc_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_crate_prev_50pc$duration)==0) {
  aux_data_crate_prev_50pc_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_50pc_short_transient_durations_list <- as.data.frame(transient_short_durations_list_crate_prev_50pc) 
}
aux_data_crate_prev_50pc_short_transient_durations_list$scenario <- as.factor("EC_02")
aux_data_crate_prev_50pc_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_crate_prev_50pc_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_50pc_short_transient_durations_list <- subset(aux_data_crate_prev_50pc_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_crate_prev_50pc$duration)==0) {
  aux_data_crate_prev_50pc_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_50pc_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_crate_prev_50pc) 
}
aux_data_crate_prev_50pc_uncleanable_transient_durations_list$scenario <- as.factor("EC_02")
aux_data_crate_prev_50pc_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_crate_prev_50pc_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_50pc_uncleanable_transient_durations_list <- subset(aux_data_crate_prev_50pc_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_crate_prev_50pc)==0) {
#   aux_data_crate_prev_50pc_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_50pc_persistent_durations_list <- as.data.frame(persistent_durations_list_crate_prev_50pc) 
# }
# aux_data_crate_prev_50pc_persistent_durations_list$scenario <- as.factor("EC_02")
# aux_data_crate_prev_50pc_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_crate_prev_50pc_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(persistent_long_durations_list_crate_prev_50pc$duration)==0) {
#   aux_data_crate_prev_50pc_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_50pc_excess_durations_list <- as.data.frame(excess_durations_list_crate_prev_50pc) 
# }
# aux_data_crate_prev_50pc_excess_durations_list$scenario <- as.factor("EC_02")
# aux_data_crate_prev_50pc_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_crate_prev_50pc_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_crate_prev_50pc$duration)==0) {
  aux_data_crate_prev_50pc_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_50pc_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_crate_prev_50pc) 
}
aux_data_crate_prev_50pc_long_persistent_durations_list$scenario <- as.factor("EC_02")
aux_data_crate_prev_50pc_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_crate_prev_50pc_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_50pc_long_persistent_durations_list <- subset(aux_data_crate_prev_50pc_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_crate_prev_50pc$duration)==0) {
  aux_data_crate_prev_50pc_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_50pc_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_crate_prev_50pc) 
}
aux_data_crate_prev_50pc_short_persistent_durations_list$scenario <- as.factor("EC_02")
aux_data_crate_prev_50pc_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_crate_prev_50pc_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_50pc_short_persistent_durations_list <- subset(aux_data_crate_prev_50pc_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_crate_prev_50pc$duration)==0) {
  aux_data_crate_prev_50pc_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_50pc_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_crate_prev_50pc) 
}
aux_data_crate_prev_50pc_uncleanable_persistent_durations_list$scenario <- as.factor("EC_02")
aux_data_crate_prev_50pc_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_crate_prev_50pc_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_50pc_uncleanable_persistent_durations_list <- subset(aux_data_crate_prev_50pc_uncleanable_persistent_durations_list, select=-c(agent,iteration))

agent_list_areas <- as.vector(agents_list_crate_prev_50pc$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_crate_prev_50pc$min_duration_10min)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$mean_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$q1_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$median_duration_10min)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$q3_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$max_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$contamination_events_10min)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$times_persistent_10min)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$min_persistent_duration_10min)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$mean_persistent_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$q1_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$median_persistent_duration_10min)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$q3_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$max_persistent_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$mean_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_50pc$balanced_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("EC_02")

aux_data_crate_prev_50pc_10min <- aux_data

aux_data_crate_prev_50pc_10min_durations_all <- aux_data_crate_prev_50pc_10min[which(aux_data_crate_prev_50pc_10min$type=="Minimum Duration (All)" | aux_data_crate_prev_50pc_10min$type=="Mean Duration (All)" | aux_data_crate_prev_50pc_10min$type=="C. Duration Q1 (All)" | aux_data_crate_prev_50pc_10min$type=="Median Duration (All)" | aux_data_crate_prev_50pc_10min$type=="C. Duration Q3 (All)" | aux_data_crate_prev_50pc_10min$type=="Maximum Duration (All)"),]

aux_data_crate_prev_50pc_10min_durations_per <- aux_data_crate_prev_50pc_10min[which(aux_data_crate_prev_50pc_10min$type=="Minimum Duration (Per)" | aux_data_crate_prev_50pc_10min$type=="Mean Duration (Per)" | aux_data_crate_prev_50pc_10min$type=="C. Duration Q1 (Per)" | aux_data_crate_prev_50pc_10min$type=="Median Duration (Per)" | aux_data_crate_prev_50pc_10min$type=="C. Duration Q3 (Per)" | aux_data_crate_prev_50pc_10min$type=="Maximum Duration (Per)"),]

aux_data_crate_prev_50pc_10min_freq_count <- aux_data_crate_prev_50pc_10min[which(aux_data_crate_prev_50pc_10min$type=="Times Contaminated" | aux_data_crate_prev_50pc_10min$type=="Times Persistent"),]

aux_data_crate_prev_50pc_10min_mean_per_freq <- aux_data_crate_prev_50pc_10min[which(aux_data_crate_prev_50pc_10min$type=="Mean Times Persistent (Overall)" | aux_data_crate_prev_50pc_10min$type=="Mean Times Persistent (Per It.)"),]

aux_data_crate_prev_50pc_10min_durations_list <- Facility_B_durations_crate_prev_50pc
aux_data_crate_prev_50pc_10min_durations_list$scenario <- as.factor("EC_02")
aux_data_crate_prev_50pc_10min_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_crate_prev_50pc_10min)==0) {
#   aux_data_crate_prev_50pc_10min_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_50pc_10min_transient_durations_list <- as.data.frame(transient_durations_list_crate_prev_50pc_10min) 
# }
# aux_data_crate_prev_50pc_10min_transient_durations_list$scenario <- as.factor("EC_02")
# aux_data_crate_prev_50pc_10min_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_crate_prev_50pc_10min_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_crate_prev_50pc_10min$duration)==0) {
  aux_data_crate_prev_50pc_10min_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_50pc_10min_long_transient_durations_list <- as.data.frame(transient_long_durations_list_crate_prev_50pc_10min) 
}
aux_data_crate_prev_50pc_10min_long_transient_durations_list$scenario <- as.factor("EC_02")
aux_data_crate_prev_50pc_10min_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_crate_prev_50pc_10min_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_50pc_10min_long_transient_durations_list <- subset(aux_data_crate_prev_50pc_10min_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_crate_prev_50pc_10min$duration)==0) {
  aux_data_crate_prev_50pc_10min_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_50pc_10min_short_transient_durations_list <- as.data.frame(transient_short_durations_list_crate_prev_50pc_10min) 
}
aux_data_crate_prev_50pc_10min_short_transient_durations_list$scenario <- as.factor("EC_02")
aux_data_crate_prev_50pc_10min_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_crate_prev_50pc_10min_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_50pc_10min_short_transient_durations_list <- subset(aux_data_crate_prev_50pc_10min_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_crate_prev_50pc_10min$duration)==0) {
  aux_data_crate_prev_50pc_10min_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_50pc_10min_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_crate_prev_50pc_10min) 
}
aux_data_crate_prev_50pc_10min_uncleanable_transient_durations_list$scenario <- as.factor("EC_02")
aux_data_crate_prev_50pc_10min_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_crate_prev_50pc_10min_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_50pc_10min_uncleanable_transient_durations_list <- subset(aux_data_crate_prev_50pc_10min_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_crate_prev_50pc_10min)==0) {
#   aux_data_crate_prev_50pc_10min_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_50pc_10min_persistent_durations_list <- as.data.frame(persistent_durations_list_crate_prev_50pc_10min) 
# }
# aux_data_crate_prev_50pc_10min_persistent_durations_list$scenario <- as.factor("EC_02")
# aux_data_crate_prev_50pc_10min_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_crate_prev_50pc_10min_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(excess_durations_list_crate_prev_50pc_10min)==0) {
#   aux_data_crate_prev_50pc_10min_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_50pc_10min_excess_durations_list <- as.data.frame(excess_durations_list_crate_prev_50pc_10min) 
# }
# aux_data_crate_prev_50pc_10min_excess_durations_list$scenario <- as.factor("EC_02")
# aux_data_crate_prev_50pc_10min_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_crate_prev_50pc_10min_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_crate_prev_50pc_10min$duration)==0) {
  aux_data_crate_prev_50pc_10min_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_50pc_10min_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_crate_prev_50pc_10min) 
}
aux_data_crate_prev_50pc_10min_long_persistent_durations_list$scenario <- as.factor("EC_02")
aux_data_crate_prev_50pc_10min_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_crate_prev_50pc_10min_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_50pc_10min_long_persistent_durations_list <- subset(aux_data_crate_prev_50pc_10min_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_crate_prev_50pc_10min$duration)==0) {
  aux_data_crate_prev_50pc_10min_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_50pc_10min_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_crate_prev_50pc_10min) 
}
aux_data_crate_prev_50pc_10min_short_persistent_durations_list$scenario <- as.factor("EC_02")
aux_data_crate_prev_50pc_10min_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_crate_prev_50pc_10min_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_50pc_10min_short_persistent_durations_list <- subset(aux_data_crate_prev_50pc_10min_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_crate_prev_50pc_10min$duration)==0) {
  aux_data_crate_prev_50pc_10min_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_50pc_10min_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_crate_prev_50pc_10min) 
}
aux_data_crate_prev_50pc_10min_uncleanable_persistent_durations_list$scenario <- as.factor("EC_02")
aux_data_crate_prev_50pc_10min_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_crate_prev_50pc_10min_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_50pc_10min_uncleanable_persistent_durations_list <- subset(aux_data_crate_prev_50pc_10min_uncleanable_persistent_durations_list, select=-c(agent,iteration))

#EC_03####
agent_list_areas <- as.vector(agents_list_crate_prev_25pc$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_crate_prev_25pc$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("EC_03")

aux_data_crate_prev_25pc <- aux_data

aux_data_crate_prev_25pc_durations_all <- aux_data_crate_prev_25pc[which(aux_data_crate_prev_25pc$type=="Minimum Duration (All)" | aux_data_crate_prev_25pc$type=="Mean Duration (All)" | aux_data_crate_prev_25pc$type=="C. Duration Q1 (All)" | aux_data_crate_prev_25pc$type=="Median Duration (All)" | aux_data_crate_prev_25pc$type=="C. Duration Q3 (All)" | aux_data_crate_prev_25pc$type=="Maximum Duration (All)"),]

aux_data_crate_prev_25pc_durations_per <- aux_data_crate_prev_25pc[which(aux_data_crate_prev_25pc$type=="Minimum Duration (Per)" | aux_data_crate_prev_25pc$type=="Mean Duration (Per)" | aux_data_crate_prev_25pc$type=="C. Duration Q1 (Per)" | aux_data_crate_prev_25pc$type=="Median Duration (Per)" | aux_data_crate_prev_25pc$type=="C. Duration Q3 (Per)" | aux_data_crate_prev_25pc$type=="Maximum Duration (Per)"),]

aux_data_crate_prev_25pc_freq_count <- aux_data_crate_prev_25pc[which(aux_data_crate_prev_25pc$type=="Times Contaminated" | aux_data_crate_prev_25pc$type=="Times Persistent"),]

aux_data_crate_prev_25pc_mean_per_freq <- aux_data_crate_prev_25pc[which(aux_data_crate_prev_25pc$type=="Mean Times Persistent (Overall)" | aux_data_crate_prev_25pc$type=="Mean Times Persistent (Per It.)"),]

aux_data_crate_prev_25pc_durations_list <- Facility_B_durations_crate_prev_25pc
aux_data_crate_prev_25pc_durations_list$scenario <- as.factor("EC_03")
aux_data_crate_prev_25pc_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_crate_prev_25pc)==0) {
#   aux_data_crate_prev_25pc_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_25pc_transient_durations_list <- as.data.frame(transient_durations_list_crate_prev_25pc)
# }
# aux_data_crate_prev_25pc_transient_durations_list$scenario <- as.factor("EC_03")
# aux_data_crate_prev_25pc_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_crate_prev_25pc_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_crate_prev_25pc$duration)==0) {
  aux_data_crate_prev_25pc_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_25pc_long_transient_durations_list <- as.data.frame(transient_long_durations_list_crate_prev_25pc) 
}
aux_data_crate_prev_25pc_long_transient_durations_list$scenario <- as.factor("EC_03")
aux_data_crate_prev_25pc_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_crate_prev_25pc_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_25pc_long_transient_durations_list <- subset(aux_data_crate_prev_25pc_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_crate_prev_25pc$duration)==0) {
  aux_data_crate_prev_25pc_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_25pc_short_transient_durations_list <- as.data.frame(transient_short_durations_list_crate_prev_25pc) 
}
aux_data_crate_prev_25pc_short_transient_durations_list$scenario <- as.factor("EC_03")
aux_data_crate_prev_25pc_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_crate_prev_25pc_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_25pc_short_transient_durations_list <- subset(aux_data_crate_prev_25pc_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_crate_prev_25pc$duration)==0) {
  aux_data_crate_prev_25pc_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_25pc_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_crate_prev_25pc) 
}
aux_data_crate_prev_25pc_uncleanable_transient_durations_list$scenario <- as.factor("EC_03")
aux_data_crate_prev_25pc_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_crate_prev_25pc_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_25pc_uncleanable_transient_durations_list <- subset(aux_data_crate_prev_25pc_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_crate_prev_25pc)==0) {
#   aux_data_crate_prev_25pc_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_25pc_persistent_durations_list <- as.data.frame(persistent_durations_list_crate_prev_25pc) 
# }
# aux_data_crate_prev_25pc_persistent_durations_list$scenario <- as.factor("EC_03")
# aux_data_crate_prev_25pc_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_crate_prev_25pc_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(persistent_long_durations_list_crate_prev_25pc$duration)==0) {
#   aux_data_crate_prev_25pc_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_25pc_excess_durations_list <- as.data.frame(excess_durations_list_crate_prev_25pc) 
# }
# aux_data_crate_prev_25pc_excess_durations_list$scenario <- as.factor("EC_03")
# aux_data_crate_prev_25pc_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_crate_prev_25pc_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_crate_prev_25pc$duration)==0) {
  aux_data_crate_prev_25pc_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_25pc_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_crate_prev_25pc) 
}
aux_data_crate_prev_25pc_long_persistent_durations_list$scenario <- as.factor("EC_03")
aux_data_crate_prev_25pc_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_crate_prev_25pc_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_25pc_long_persistent_durations_list <- subset(aux_data_crate_prev_25pc_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_crate_prev_25pc$duration)==0) {
  aux_data_crate_prev_25pc_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_25pc_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_crate_prev_25pc) 
}
aux_data_crate_prev_25pc_short_persistent_durations_list$scenario <- as.factor("EC_03")
aux_data_crate_prev_25pc_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_crate_prev_25pc_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_25pc_short_persistent_durations_list <- subset(aux_data_crate_prev_25pc_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_crate_prev_25pc$duration)==0) {
  aux_data_crate_prev_25pc_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_25pc_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_crate_prev_25pc) 
}
aux_data_crate_prev_25pc_uncleanable_persistent_durations_list$scenario <- as.factor("EC_03")
aux_data_crate_prev_25pc_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_crate_prev_25pc_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_25pc_uncleanable_persistent_durations_list <- subset(aux_data_crate_prev_25pc_uncleanable_persistent_durations_list, select=-c(agent,iteration))

agent_list_areas <- as.vector(agents_list_crate_prev_25pc$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_crate_prev_25pc$min_duration_10min)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$mean_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$q1_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$median_duration_10min)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$q3_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$max_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$contamination_events_10min)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$times_persistent_10min)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$min_persistent_duration_10min)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$mean_persistent_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$q1_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$median_persistent_duration_10min)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$q3_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$max_persistent_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$mean_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_25pc$balanced_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("EC_03")

aux_data_crate_prev_25pc_10min <- aux_data

aux_data_crate_prev_25pc_10min_durations_all <- aux_data_crate_prev_25pc_10min[which(aux_data_crate_prev_25pc_10min$type=="Minimum Duration (All)" | aux_data_crate_prev_25pc_10min$type=="Mean Duration (All)" | aux_data_crate_prev_25pc_10min$type=="C. Duration Q1 (All)" | aux_data_crate_prev_25pc_10min$type=="Median Duration (All)" | aux_data_crate_prev_25pc_10min$type=="C. Duration Q3 (All)" | aux_data_crate_prev_25pc_10min$type=="Maximum Duration (All)"),]

aux_data_crate_prev_25pc_10min_durations_per <- aux_data_crate_prev_25pc_10min[which(aux_data_crate_prev_25pc_10min$type=="Minimum Duration (Per)" | aux_data_crate_prev_25pc_10min$type=="Mean Duration (Per)" | aux_data_crate_prev_25pc_10min$type=="C. Duration Q1 (Per)" | aux_data_crate_prev_25pc_10min$type=="Median Duration (Per)" | aux_data_crate_prev_25pc_10min$type=="C. Duration Q3 (Per)" | aux_data_crate_prev_25pc_10min$type=="Maximum Duration (Per)"),]

aux_data_crate_prev_25pc_10min_freq_count <- aux_data_crate_prev_25pc_10min[which(aux_data_crate_prev_25pc_10min$type=="Times Contaminated" | aux_data_crate_prev_25pc_10min$type=="Times Persistent"),]

aux_data_crate_prev_25pc_10min_mean_per_freq <- aux_data_crate_prev_25pc_10min[which(aux_data_crate_prev_25pc_10min$type=="Mean Times Persistent (Overall)" | aux_data_crate_prev_25pc_10min$type=="Mean Times Persistent (Per It.)"),]

aux_data_crate_prev_25pc_10min_durations_list <- Facility_B_durations_crate_prev_25pc
aux_data_crate_prev_25pc_10min_durations_list$scenario <- as.factor("EC_03")
aux_data_crate_prev_25pc_10min_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_crate_prev_25pc_10min)==0) {
#   aux_data_crate_prev_25pc_10min_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_25pc_10min_transient_durations_list <- as.data.frame(transient_durations_list_crate_prev_25pc_10min) 
# }
# aux_data_crate_prev_25pc_10min_transient_durations_list$scenario <- as.factor("EC_03")
# aux_data_crate_prev_25pc_10min_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_crate_prev_25pc_10min_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_crate_prev_25pc_10min$duration)==0) {
  aux_data_crate_prev_25pc_10min_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_25pc_10min_long_transient_durations_list <- as.data.frame(transient_long_durations_list_crate_prev_25pc_10min) 
}
aux_data_crate_prev_25pc_10min_long_transient_durations_list$scenario <- as.factor("EC_03")
aux_data_crate_prev_25pc_10min_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_crate_prev_25pc_10min_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_25pc_10min_long_transient_durations_list <- subset(aux_data_crate_prev_25pc_10min_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_crate_prev_25pc_10min$duration)==0) {
  aux_data_crate_prev_25pc_10min_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_25pc_10min_short_transient_durations_list <- as.data.frame(transient_short_durations_list_crate_prev_25pc_10min) 
}
aux_data_crate_prev_25pc_10min_short_transient_durations_list$scenario <- as.factor("EC_03")
aux_data_crate_prev_25pc_10min_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_crate_prev_25pc_10min_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_25pc_10min_short_transient_durations_list <- subset(aux_data_crate_prev_25pc_10min_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_crate_prev_25pc_10min$duration)==0) {
  aux_data_crate_prev_25pc_10min_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_25pc_10min_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_crate_prev_25pc_10min) 
}
aux_data_crate_prev_25pc_10min_uncleanable_transient_durations_list$scenario <- as.factor("EC_03")
aux_data_crate_prev_25pc_10min_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_crate_prev_25pc_10min_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_25pc_10min_uncleanable_transient_durations_list <- subset(aux_data_crate_prev_25pc_10min_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_crate_prev_25pc_10min)==0) {
#   aux_data_crate_prev_25pc_10min_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_25pc_10min_persistent_durations_list <- as.data.frame(persistent_durations_list_crate_prev_25pc_10min) 
# }
# aux_data_crate_prev_25pc_10min_persistent_durations_list$scenario <- as.factor("EC_03")
# aux_data_crate_prev_25pc_10min_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_crate_prev_25pc_10min_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(excess_durations_list_crate_prev_25pc_10min)==0) {
#   aux_data_crate_prev_25pc_10min_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_25pc_10min_excess_durations_list <- as.data.frame(excess_durations_list_crate_prev_25pc_10min) 
# }
# aux_data_crate_prev_25pc_10min_excess_durations_list$scenario <- as.factor("EC_03")
# aux_data_crate_prev_25pc_10min_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_crate_prev_25pc_10min_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_crate_prev_25pc_10min$duration)==0) {
  aux_data_crate_prev_25pc_10min_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_25pc_10min_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_crate_prev_25pc_10min) 
}
aux_data_crate_prev_25pc_10min_long_persistent_durations_list$scenario <- as.factor("EC_03")
aux_data_crate_prev_25pc_10min_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_crate_prev_25pc_10min_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_25pc_10min_long_persistent_durations_list <- subset(aux_data_crate_prev_25pc_10min_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_crate_prev_25pc_10min$duration)==0) {
  aux_data_crate_prev_25pc_10min_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_25pc_10min_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_crate_prev_25pc_10min) 
}
aux_data_crate_prev_25pc_10min_short_persistent_durations_list$scenario <- as.factor("EC_03")
aux_data_crate_prev_25pc_10min_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_crate_prev_25pc_10min_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_25pc_10min_short_persistent_durations_list <- subset(aux_data_crate_prev_25pc_10min_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_crate_prev_25pc_10min$duration)==0) {
  aux_data_crate_prev_25pc_10min_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_25pc_10min_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_crate_prev_25pc_10min) 
}
aux_data_crate_prev_25pc_10min_uncleanable_persistent_durations_list$scenario <- as.factor("EC_03")
aux_data_crate_prev_25pc_10min_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_crate_prev_25pc_10min_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_25pc_10min_uncleanable_persistent_durations_list <- subset(aux_data_crate_prev_25pc_10min_uncleanable_persistent_durations_list, select=-c(agent,iteration))

#EC_04####
agent_list_areas <- as.vector(agents_list_crate_prev_0pc$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_crate_prev_0pc$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("EC_04")

aux_data_crate_prev_0pc <- aux_data

aux_data_crate_prev_0pc_durations_all <- aux_data_crate_prev_0pc[which(aux_data_crate_prev_0pc$type=="Minimum Duration (All)" | aux_data_crate_prev_0pc$type=="Mean Duration (All)" | aux_data_crate_prev_0pc$type=="C. Duration Q1 (All)" | aux_data_crate_prev_0pc$type=="Median Duration (All)" | aux_data_crate_prev_0pc$type=="C. Duration Q3 (All)" | aux_data_crate_prev_0pc$type=="Maximum Duration (All)"),]

aux_data_crate_prev_0pc_durations_per <- aux_data_crate_prev_0pc[which(aux_data_crate_prev_0pc$type=="Minimum Duration (Per)" | aux_data_crate_prev_0pc$type=="Mean Duration (Per)" | aux_data_crate_prev_0pc$type=="C. Duration Q1 (Per)" | aux_data_crate_prev_0pc$type=="Median Duration (Per)" | aux_data_crate_prev_0pc$type=="C. Duration Q3 (Per)" | aux_data_crate_prev_0pc$type=="Maximum Duration (Per)"),]

aux_data_crate_prev_0pc_freq_count <- aux_data_crate_prev_0pc[which(aux_data_crate_prev_0pc$type=="Times Contaminated" | aux_data_crate_prev_0pc$type=="Times Persistent"),]

aux_data_crate_prev_0pc_mean_per_freq <- aux_data_crate_prev_0pc[which(aux_data_crate_prev_0pc$type=="Mean Times Persistent (Overall)" | aux_data_crate_prev_0pc$type=="Mean Times Persistent (Per It.)"),]

aux_data_crate_prev_0pc_durations_list <- Facility_B_durations_crate_prev_0pc
aux_data_crate_prev_0pc_durations_list$scenario <- as.factor("EC_04")
aux_data_crate_prev_0pc_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_crate_prev_0pc)==0) {
#   aux_data_crate_prev_0pc_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_0pc_transient_durations_list <- as.data.frame(transient_durations_list_crate_prev_0pc)
# }
# aux_data_crate_prev_0pc_transient_durations_list$scenario <- as.factor("EC_04")
# aux_data_crate_prev_0pc_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_crate_prev_0pc_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_crate_prev_0pc$duration)==0) {
  aux_data_crate_prev_0pc_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_0pc_long_transient_durations_list <- as.data.frame(transient_long_durations_list_crate_prev_0pc) 
}
aux_data_crate_prev_0pc_long_transient_durations_list$scenario <- as.factor("EC_04")
aux_data_crate_prev_0pc_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_crate_prev_0pc_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_0pc_long_transient_durations_list <- subset(aux_data_crate_prev_0pc_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_crate_prev_0pc$duration)==0) {
  aux_data_crate_prev_0pc_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_0pc_short_transient_durations_list <- as.data.frame(transient_short_durations_list_crate_prev_0pc) 
}
aux_data_crate_prev_0pc_short_transient_durations_list$scenario <- as.factor("EC_04")
aux_data_crate_prev_0pc_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_crate_prev_0pc_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_0pc_short_transient_durations_list <- subset(aux_data_crate_prev_0pc_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_crate_prev_0pc$duration)==0) {
  aux_data_crate_prev_0pc_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_0pc_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_crate_prev_0pc) 
}
aux_data_crate_prev_0pc_uncleanable_transient_durations_list$scenario <- as.factor("EC_04")
aux_data_crate_prev_0pc_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_crate_prev_0pc_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_0pc_uncleanable_transient_durations_list <- subset(aux_data_crate_prev_0pc_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_crate_prev_0pc)==0) {
#   aux_data_crate_prev_0pc_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_0pc_persistent_durations_list <- as.data.frame(persistent_durations_list_crate_prev_0pc) 
# }
# aux_data_crate_prev_0pc_persistent_durations_list$scenario <- as.factor("EC_04")
# aux_data_crate_prev_0pc_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_crate_prev_0pc_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(persistent_long_durations_list_crate_prev_0pc$duration)==0) {
#   aux_data_crate_prev_0pc_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_0pc_excess_durations_list <- as.data.frame(excess_durations_list_crate_prev_0pc) 
# }
# aux_data_crate_prev_0pc_excess_durations_list$scenario <- as.factor("EC_04")
# aux_data_crate_prev_0pc_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_crate_prev_0pc_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_crate_prev_0pc$duration)==0) {
  aux_data_crate_prev_0pc_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_0pc_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_crate_prev_0pc) 
}
aux_data_crate_prev_0pc_long_persistent_durations_list$scenario <- as.factor("EC_04")
aux_data_crate_prev_0pc_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_crate_prev_0pc_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_0pc_long_persistent_durations_list <- subset(aux_data_crate_prev_0pc_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_crate_prev_0pc$duration)==0) {
  aux_data_crate_prev_0pc_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_0pc_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_crate_prev_0pc) 
}
aux_data_crate_prev_0pc_short_persistent_durations_list$scenario <- as.factor("EC_04")
aux_data_crate_prev_0pc_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_crate_prev_0pc_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_0pc_short_persistent_durations_list <- subset(aux_data_crate_prev_0pc_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_crate_prev_0pc$duration)==0) {
  aux_data_crate_prev_0pc_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_0pc_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_crate_prev_0pc) 
}
aux_data_crate_prev_0pc_uncleanable_persistent_durations_list$scenario <- as.factor("EC_04")
aux_data_crate_prev_0pc_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_crate_prev_0pc_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_0pc_uncleanable_persistent_durations_list <- subset(aux_data_crate_prev_0pc_uncleanable_persistent_durations_list, select=-c(agent,iteration))

agent_list_areas <- as.vector(agents_list_crate_prev_0pc$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_crate_prev_0pc$min_duration_10min)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$mean_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$q1_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$median_duration_10min)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$q3_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$max_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$contamination_events_10min)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$times_persistent_10min)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$min_persistent_duration_10min)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$mean_persistent_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$q1_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$median_persistent_duration_10min)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$q3_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$max_persistent_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$mean_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_crate_prev_0pc$balanced_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("EC_04")

aux_data_crate_prev_0pc_10min <- aux_data

aux_data_crate_prev_0pc_10min_durations_all <- aux_data_crate_prev_0pc_10min[which(aux_data_crate_prev_0pc_10min$type=="Minimum Duration (All)" | aux_data_crate_prev_0pc_10min$type=="Mean Duration (All)" | aux_data_crate_prev_0pc_10min$type=="C. Duration Q1 (All)" | aux_data_crate_prev_0pc_10min$type=="Median Duration (All)" | aux_data_crate_prev_0pc_10min$type=="C. Duration Q3 (All)" | aux_data_crate_prev_0pc_10min$type=="Maximum Duration (All)"),]

aux_data_crate_prev_0pc_10min_durations_per <- aux_data_crate_prev_0pc_10min[which(aux_data_crate_prev_0pc_10min$type=="Minimum Duration (Per)" | aux_data_crate_prev_0pc_10min$type=="Mean Duration (Per)" | aux_data_crate_prev_0pc_10min$type=="C. Duration Q1 (Per)" | aux_data_crate_prev_0pc_10min$type=="Median Duration (Per)" | aux_data_crate_prev_0pc_10min$type=="C. Duration Q3 (Per)" | aux_data_crate_prev_0pc_10min$type=="Maximum Duration (Per)"),]

aux_data_crate_prev_0pc_10min_freq_count <- aux_data_crate_prev_0pc_10min[which(aux_data_crate_prev_0pc_10min$type=="Times Contaminated" | aux_data_crate_prev_0pc_10min$type=="Times Persistent"),]

aux_data_crate_prev_0pc_10min_mean_per_freq <- aux_data_crate_prev_0pc_10min[which(aux_data_crate_prev_0pc_10min$type=="Mean Times Persistent (Overall)" | aux_data_crate_prev_0pc_10min$type=="Mean Times Persistent (Per It.)"),]

aux_data_crate_prev_0pc_10min_durations_list <- Facility_B_durations_crate_prev_0pc
aux_data_crate_prev_0pc_10min_durations_list$scenario <- as.factor("EC_04")
aux_data_crate_prev_0pc_10min_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_crate_prev_0pc_10min)==0) {
#   aux_data_crate_prev_0pc_10min_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_0pc_10min_transient_durations_list <- as.data.frame(transient_durations_list_crate_prev_0pc_10min) 
# }
# aux_data_crate_prev_0pc_10min_transient_durations_list$scenario <- as.factor("EC_04")
# aux_data_crate_prev_0pc_10min_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_crate_prev_0pc_10min_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_crate_prev_0pc_10min$duration)==0) {
  aux_data_crate_prev_0pc_10min_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_0pc_10min_long_transient_durations_list <- as.data.frame(transient_long_durations_list_crate_prev_0pc_10min) 
}
aux_data_crate_prev_0pc_10min_long_transient_durations_list$scenario <- as.factor("EC_04")
aux_data_crate_prev_0pc_10min_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_crate_prev_0pc_10min_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_0pc_10min_long_transient_durations_list <- subset(aux_data_crate_prev_0pc_10min_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_crate_prev_0pc_10min$duration)==0) {
  aux_data_crate_prev_0pc_10min_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_0pc_10min_short_transient_durations_list <- as.data.frame(transient_short_durations_list_crate_prev_0pc_10min) 
}
aux_data_crate_prev_0pc_10min_short_transient_durations_list$scenario <- as.factor("EC_04")
aux_data_crate_prev_0pc_10min_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_crate_prev_0pc_10min_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_0pc_10min_short_transient_durations_list <- subset(aux_data_crate_prev_0pc_10min_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_crate_prev_0pc_10min$duration)==0) {
  aux_data_crate_prev_0pc_10min_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_0pc_10min_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_crate_prev_0pc_10min) 
}
aux_data_crate_prev_0pc_10min_uncleanable_transient_durations_list$scenario <- as.factor("EC_04")
aux_data_crate_prev_0pc_10min_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_crate_prev_0pc_10min_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_0pc_10min_uncleanable_transient_durations_list <- subset(aux_data_crate_prev_0pc_10min_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_crate_prev_0pc_10min)==0) {
#   aux_data_crate_prev_0pc_10min_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_0pc_10min_persistent_durations_list <- as.data.frame(persistent_durations_list_crate_prev_0pc_10min) 
# }
# aux_data_crate_prev_0pc_10min_persistent_durations_list$scenario <- as.factor("EC_04")
# aux_data_crate_prev_0pc_10min_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_crate_prev_0pc_10min_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(excess_durations_list_crate_prev_0pc_10min)==0) {
#   aux_data_crate_prev_0pc_10min_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_0pc_10min_excess_durations_list <- as.data.frame(excess_durations_list_crate_prev_0pc_10min) 
# }
# aux_data_crate_prev_0pc_10min_excess_durations_list$scenario <- as.factor("EC_04")
# aux_data_crate_prev_0pc_10min_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_crate_prev_0pc_10min_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_crate_prev_0pc_10min$duration)==0) {
  aux_data_crate_prev_0pc_10min_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_0pc_10min_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_crate_prev_0pc_10min) 
}
aux_data_crate_prev_0pc_10min_long_persistent_durations_list$scenario <- as.factor("EC_04")
aux_data_crate_prev_0pc_10min_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_crate_prev_0pc_10min_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_0pc_10min_long_persistent_durations_list <- subset(aux_data_crate_prev_0pc_10min_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_crate_prev_0pc_10min$duration)==0) {
  aux_data_crate_prev_0pc_10min_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_crate_prev_0pc_10min_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_crate_prev_0pc_10min) 
}
aux_data_crate_prev_0pc_10min_short_persistent_durations_list$scenario <- as.factor("EC_04")
aux_data_crate_prev_0pc_10min_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_crate_prev_0pc_10min_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_crate_prev_0pc_10min_short_persistent_durations_list <- subset(aux_data_crate_prev_0pc_10min_short_persistent_durations_list, select=-c(agent,iteration))

# if (length(persistent_uncleanable_durations_list_crate_prev_0pc_10min$duration)==0) {
#   aux_data_crate_prev_0pc_10min_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_crate_prev_0pc_10min_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_crate_prev_0pc_10min) 
# }
# aux_data_crate_prev_0pc_10min_uncleanable_persistent_durations_list$scenario <- as.factor("EC_04")
# aux_data_crate_prev_0pc_10min_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
# colnames(aux_data_crate_prev_0pc_10min_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
# aux_data_crate_prev_0pc_10min_uncleanable_persistent_durations_list <- subset(aux_data_crate_prev_0pc_10min_uncleanable_persistent_durations_list, select=-c(agent,iteration))

#AI_02####
agent_list_areas <- as.vector(agents_list_prob_intervention$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_prob_intervention$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_prob_intervention$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("AI_02")

aux_data_prob_intervention <- aux_data

aux_data_prob_intervention_durations_all <- aux_data_prob_intervention[which(aux_data_prob_intervention$type=="Minimum Duration (All)" | aux_data_prob_intervention$type=="Mean Duration (All)" | aux_data_prob_intervention$type=="C. Duration Q1 (All)" | aux_data_prob_intervention$type=="Median Duration (All)" | aux_data_prob_intervention$type=="C. Duration Q3 (All)" | aux_data_prob_intervention$type=="Maximum Duration (All)"),]

aux_data_prob_intervention_durations_per <- aux_data_prob_intervention[which(aux_data_prob_intervention$type=="Minimum Duration (Per)" | aux_data_prob_intervention$type=="Mean Duration (Per)" | aux_data_prob_intervention$type=="C. Duration Q1 (Per)" | aux_data_prob_intervention$type=="Median Duration (Per)" | aux_data_prob_intervention$type=="C. Duration Q3 (Per)" | aux_data_prob_intervention$type=="Maximum Duration (Per)"),]

aux_data_prob_intervention_freq_count <- aux_data_prob_intervention[which(aux_data_prob_intervention$type=="Times Contaminated" | aux_data_prob_intervention$type=="Times Persistent"),]

aux_data_prob_intervention_mean_per_freq <- aux_data_prob_intervention[which(aux_data_prob_intervention$type=="Mean Times Persistent (Overall)" | aux_data_prob_intervention$type=="Mean Times Persistent (Per It.)"),]

aux_data_prob_intervention_durations_list <- Facility_B_durations_prob_intervention
aux_data_prob_intervention_durations_list$scenario <- as.factor("AI_02")
aux_data_prob_intervention_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_prob_intervention)==0) {
#   aux_data_prob_intervention_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_prob_intervention_transient_durations_list <- as.data.frame(transient_durations_list_prob_intervention)
# }
# aux_data_prob_intervention_transient_durations_list$scenario <- as.factor("AI_02")
# aux_data_prob_intervention_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_prob_intervention_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_prob_intervention$duration)==0) {
  aux_data_prob_intervention_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_prob_intervention_long_transient_durations_list <- as.data.frame(transient_long_durations_list_prob_intervention) 
}
aux_data_prob_intervention_long_transient_durations_list$scenario <- as.factor("AI_02")
aux_data_prob_intervention_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_prob_intervention_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_prob_intervention_long_transient_durations_list <- subset(aux_data_prob_intervention_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_prob_intervention$duration)==0) {
  aux_data_prob_intervention_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_prob_intervention_short_transient_durations_list <- as.data.frame(transient_short_durations_list_prob_intervention) 
}
aux_data_prob_intervention_short_transient_durations_list$scenario <- as.factor("AI_02")
aux_data_prob_intervention_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_prob_intervention_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_prob_intervention_short_transient_durations_list <- subset(aux_data_prob_intervention_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_prob_intervention$duration)==0) {
  aux_data_prob_intervention_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_prob_intervention_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_prob_intervention) 
}
aux_data_prob_intervention_uncleanable_transient_durations_list$scenario <- as.factor("AI_02")
aux_data_prob_intervention_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_prob_intervention_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_prob_intervention_uncleanable_transient_durations_list <- subset(aux_data_prob_intervention_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_prob_intervention)==0) {
#   aux_data_prob_intervention_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_prob_intervention_persistent_durations_list <- as.data.frame(persistent_durations_list_prob_intervention) 
# }
# aux_data_prob_intervention_persistent_durations_list$scenario <- as.factor("AI_02")
# aux_data_prob_intervention_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_prob_intervention_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(persistent_long_durations_list_prob_intervention$duration)==0) {
#   aux_data_prob_intervention_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_prob_intervention_excess_durations_list <- as.data.frame(excess_durations_list_prob_intervention) 
# }
# aux_data_prob_intervention_excess_durations_list$scenario <- as.factor("AI_02")
# aux_data_prob_intervention_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_prob_intervention_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_prob_intervention$duration)==0) {
  aux_data_prob_intervention_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_prob_intervention_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_prob_intervention) 
}
aux_data_prob_intervention_long_persistent_durations_list$scenario <- as.factor("AI_02")
aux_data_prob_intervention_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_prob_intervention_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_prob_intervention_long_persistent_durations_list <- subset(aux_data_prob_intervention_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_prob_intervention$duration)==0) {
  aux_data_prob_intervention_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_prob_intervention_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_prob_intervention) 
}
aux_data_prob_intervention_short_persistent_durations_list$scenario <- as.factor("AI_02")
aux_data_prob_intervention_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_prob_intervention_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_prob_intervention_short_persistent_durations_list <- subset(aux_data_prob_intervention_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_prob_intervention$duration)==0) {
  aux_data_prob_intervention_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_prob_intervention_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_prob_intervention) 
}
aux_data_prob_intervention_uncleanable_persistent_durations_list$scenario <- as.factor("AI_02")
aux_data_prob_intervention_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_prob_intervention_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_prob_intervention_uncleanable_persistent_durations_list <- subset(aux_data_prob_intervention_uncleanable_persistent_durations_list, select=-c(agent,iteration))

agent_list_areas <- as.vector(agents_list_prob_intervention$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_prob_intervention$min_duration_10min)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_prob_intervention$mean_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$q1_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$median_duration_10min)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$q3_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$max_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$contamination_events_10min)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$times_persistent_10min)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$min_persistent_duration_10min)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$mean_persistent_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$q1_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$median_persistent_duration_10min)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$q3_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$max_persistent_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$mean_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_prob_intervention$balanced_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("AI_02")

aux_data_prob_intervention_10min <- aux_data

aux_data_prob_intervention_10min_durations_all <- aux_data_prob_intervention_10min[which(aux_data_prob_intervention_10min$type=="Minimum Duration (All)" | aux_data_prob_intervention_10min$type=="Mean Duration (All)" | aux_data_prob_intervention_10min$type=="C. Duration Q1 (All)" | aux_data_prob_intervention_10min$type=="Median Duration (All)" | aux_data_prob_intervention_10min$type=="C. Duration Q3 (All)" | aux_data_prob_intervention_10min$type=="Maximum Duration (All)"),]

aux_data_prob_intervention_10min_durations_per <- aux_data_prob_intervention_10min[which(aux_data_prob_intervention_10min$type=="Minimum Duration (Per)" | aux_data_prob_intervention_10min$type=="Mean Duration (Per)" | aux_data_prob_intervention_10min$type=="C. Duration Q1 (Per)" | aux_data_prob_intervention_10min$type=="Median Duration (Per)" | aux_data_prob_intervention_10min$type=="C. Duration Q3 (Per)" | aux_data_prob_intervention_10min$type=="Maximum Duration (Per)"),]

aux_data_prob_intervention_10min_freq_count <- aux_data_prob_intervention_10min[which(aux_data_prob_intervention_10min$type=="Times Contaminated" | aux_data_prob_intervention_10min$type=="Times Persistent"),]

aux_data_prob_intervention_10min_mean_per_freq <- aux_data_prob_intervention_10min[which(aux_data_prob_intervention_10min$type=="Mean Times Persistent (Overall)" | aux_data_prob_intervention_10min$type=="Mean Times Persistent (Per It.)"),]

aux_data_prob_intervention_10min_durations_list <- Facility_B_durations_prob_intervention
aux_data_prob_intervention_10min_durations_list$scenario <- as.factor("AI_02")
aux_data_prob_intervention_10min_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_prob_intervention_10min)==0) {
#   aux_data_prob_intervention_10min_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_prob_intervention_10min_transient_durations_list <- as.data.frame(transient_durations_list_prob_intervention_10min) 
# }
# aux_data_prob_intervention_10min_transient_durations_list$scenario <- as.factor("AI_02")
# aux_data_prob_intervention_10min_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_prob_intervention_10min_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_prob_intervention_10min$duration)==0) {
  aux_data_prob_intervention_10min_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_prob_intervention_10min_long_transient_durations_list <- as.data.frame(transient_long_durations_list_prob_intervention_10min) 
}
aux_data_prob_intervention_10min_long_transient_durations_list$scenario <- as.factor("AI_02")
aux_data_prob_intervention_10min_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_prob_intervention_10min_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_prob_intervention_10min_long_transient_durations_list <- subset(aux_data_prob_intervention_10min_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_prob_intervention_10min$duration)==0) {
  aux_data_prob_intervention_10min_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_prob_intervention_10min_short_transient_durations_list <- as.data.frame(transient_short_durations_list_prob_intervention_10min) 
}
aux_data_prob_intervention_10min_short_transient_durations_list$scenario <- as.factor("AI_02")
aux_data_prob_intervention_10min_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_prob_intervention_10min_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_prob_intervention_10min_short_transient_durations_list <- subset(aux_data_prob_intervention_10min_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_prob_intervention_10min$duration)==0) {
  aux_data_prob_intervention_10min_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_prob_intervention_10min_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_prob_intervention_10min) 
}
aux_data_prob_intervention_10min_uncleanable_transient_durations_list$scenario <- as.factor("AI_02")
aux_data_prob_intervention_10min_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_prob_intervention_10min_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_prob_intervention_10min_uncleanable_transient_durations_list <- subset(aux_data_prob_intervention_10min_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_prob_intervention_10min)==0) {
#   aux_data_prob_intervention_10min_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_prob_intervention_10min_persistent_durations_list <- as.data.frame(persistent_durations_list_prob_intervention_10min) 
# }
# aux_data_prob_intervention_10min_persistent_durations_list$scenario <- as.factor("AI_02")
# aux_data_prob_intervention_10min_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_prob_intervention_10min_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(excess_durations_list_prob_intervention_10min)==0) {
#   aux_data_prob_intervention_10min_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_prob_intervention_10min_excess_durations_list <- as.data.frame(excess_durations_list_prob_intervention_10min) 
# }
# aux_data_prob_intervention_10min_excess_durations_list$scenario <- as.factor("AI_02")
# aux_data_prob_intervention_10min_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_prob_intervention_10min_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_prob_intervention_10min$duration)==0) {
  aux_data_prob_intervention_10min_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_prob_intervention_10min_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_prob_intervention_10min) 
}
aux_data_prob_intervention_10min_long_persistent_durations_list$scenario <- as.factor("AI_02")
aux_data_prob_intervention_10min_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_prob_intervention_10min_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_prob_intervention_10min_long_persistent_durations_list <- subset(aux_data_prob_intervention_10min_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_prob_intervention_10min$duration)==0) {
  aux_data_prob_intervention_10min_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_prob_intervention_10min_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_prob_intervention_10min) 
}
aux_data_prob_intervention_10min_short_persistent_durations_list$scenario <- as.factor("AI_02")
aux_data_prob_intervention_10min_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_prob_intervention_10min_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_prob_intervention_10min_short_persistent_durations_list <- subset(aux_data_prob_intervention_10min_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_prob_intervention_10min$duration)==0) {
  aux_data_prob_intervention_10min_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_prob_intervention_10min_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_prob_intervention_10min) 
}
aux_data_prob_intervention_10min_uncleanable_persistent_durations_list$scenario <- as.factor("AI_02")
aux_data_prob_intervention_10min_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_prob_intervention_10min_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_prob_intervention_10min_uncleanable_persistent_durations_list <- subset(aux_data_prob_intervention_10min_uncleanable_persistent_durations_list, select=-c(agent,iteration))

#AI_03####
agent_list_areas <- as.vector(agents_list_partial_prob_intervention$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_partial_prob_intervention$min_duration)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$mean_duration)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$q1_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$median_duration)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$q3_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$max_duration)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$contamination_events)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$times_persistent)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$min_persistent_duration)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$mean_persistent_duration)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$q1_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$median_persistent_duration)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$q3_persistent_duration)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$max_persistent_duration)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$mean_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$balanced_times_persistent)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("AI_03")

aux_data_partial_prob_intervention <- aux_data

aux_data_partial_prob_intervention_durations_all <- aux_data_partial_prob_intervention[which(aux_data_partial_prob_intervention$type=="Minimum Duration (All)" | aux_data_partial_prob_intervention$type=="Mean Duration (All)" | aux_data_partial_prob_intervention$type=="C. Duration Q1 (All)" | aux_data_partial_prob_intervention$type=="Median Duration (All)" | aux_data_partial_prob_intervention$type=="C. Duration Q3 (All)" | aux_data_partial_prob_intervention$type=="Maximum Duration (All)"),]

aux_data_partial_prob_intervention_durations_per <- aux_data_partial_prob_intervention[which(aux_data_partial_prob_intervention$type=="Minimum Duration (Per)" | aux_data_partial_prob_intervention$type=="Mean Duration (Per)" | aux_data_partial_prob_intervention$type=="C. Duration Q1 (Per)" | aux_data_partial_prob_intervention$type=="Median Duration (Per)" | aux_data_partial_prob_intervention$type=="C. Duration Q3 (Per)" | aux_data_partial_prob_intervention$type=="Maximum Duration (Per)"),]

aux_data_partial_prob_intervention_freq_count <- aux_data_partial_prob_intervention[which(aux_data_partial_prob_intervention$type=="Times Contaminated" | aux_data_partial_prob_intervention$type=="Times Persistent"),]

aux_data_partial_prob_intervention_mean_per_freq <- aux_data_partial_prob_intervention[which(aux_data_partial_prob_intervention$type=="Mean Times Persistent (Overall)" | aux_data_partial_prob_intervention$type=="Mean Times Persistent (Per It.)"),]

aux_data_partial_prob_intervention_durations_list <- Facility_B_durations_partial_prob_intervention
aux_data_partial_prob_intervention_durations_list$scenario <- as.factor("AI_03")
aux_data_partial_prob_intervention_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_partial_prob_intervention)==0) {
#   aux_data_partial_prob_intervention_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_partial_prob_intervention_transient_durations_list <- as.data.frame(transient_durations_list_partial_prob_intervention)
# }
# aux_data_partial_prob_intervention_transient_durations_list$scenario <- as.factor("AI_03")
# aux_data_partial_prob_intervention_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_partial_prob_intervention_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_partial_prob_intervention$duration)==0) {
  aux_data_partial_prob_intervention_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_partial_prob_intervention_long_transient_durations_list <- as.data.frame(transient_long_durations_list_partial_prob_intervention) 
}
aux_data_partial_prob_intervention_long_transient_durations_list$scenario <- as.factor("AI_03")
aux_data_partial_prob_intervention_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_partial_prob_intervention_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_partial_prob_intervention_long_transient_durations_list <- subset(aux_data_partial_prob_intervention_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_partial_prob_intervention$duration)==0) {
  aux_data_partial_prob_intervention_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_partial_prob_intervention_short_transient_durations_list <- as.data.frame(transient_short_durations_list_partial_prob_intervention) 
}
aux_data_partial_prob_intervention_short_transient_durations_list$scenario <- as.factor("AI_03")
aux_data_partial_prob_intervention_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_partial_prob_intervention_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_partial_prob_intervention_short_transient_durations_list <- subset(aux_data_partial_prob_intervention_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_partial_prob_intervention$duration)==0) {
  aux_data_partial_prob_intervention_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_partial_prob_intervention_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_partial_prob_intervention) 
}
aux_data_partial_prob_intervention_uncleanable_transient_durations_list$scenario <- as.factor("AI_03")
aux_data_partial_prob_intervention_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_partial_prob_intervention_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_partial_prob_intervention_uncleanable_transient_durations_list <- subset(aux_data_partial_prob_intervention_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_partial_prob_intervention)==0) {
#   aux_data_partial_prob_intervention_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_partial_prob_intervention_persistent_durations_list <- as.data.frame(persistent_durations_list_partial_prob_intervention) 
# }
# aux_data_partial_prob_intervention_persistent_durations_list$scenario <- as.factor("AI_03")
# aux_data_partial_prob_intervention_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_partial_prob_intervention_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(persistent_long_durations_list_partial_prob_intervention$duration)==0) {
#   aux_data_partial_prob_intervention_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_partial_prob_intervention_excess_durations_list <- as.data.frame(excess_durations_list_partial_prob_intervention) 
# }
# aux_data_partial_prob_intervention_excess_durations_list$scenario <- as.factor("AI_03")
# aux_data_partial_prob_intervention_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_partial_prob_intervention_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_partial_prob_intervention$duration)==0) {
  aux_data_partial_prob_intervention_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_partial_prob_intervention_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_partial_prob_intervention) 
}
aux_data_partial_prob_intervention_long_persistent_durations_list$scenario <- as.factor("AI_03")
aux_data_partial_prob_intervention_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_partial_prob_intervention_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_partial_prob_intervention_long_persistent_durations_list <- subset(aux_data_partial_prob_intervention_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_partial_prob_intervention$duration)==0) {
  aux_data_partial_prob_intervention_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_partial_prob_intervention_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_partial_prob_intervention) 
}
aux_data_partial_prob_intervention_short_persistent_durations_list$scenario <- as.factor("AI_03")
aux_data_partial_prob_intervention_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_partial_prob_intervention_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_partial_prob_intervention_short_persistent_durations_list <- subset(aux_data_partial_prob_intervention_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_partial_prob_intervention$duration)==0) {
  aux_data_partial_prob_intervention_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_partial_prob_intervention_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_partial_prob_intervention) 
}
aux_data_partial_prob_intervention_uncleanable_persistent_durations_list$scenario <- as.factor("AI_03")
aux_data_partial_prob_intervention_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_partial_prob_intervention_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_partial_prob_intervention_uncleanable_persistent_durations_list <- subset(aux_data_partial_prob_intervention_uncleanable_persistent_durations_list, select=-c(agent,iteration))

agent_list_areas <- as.vector(agents_list_partial_prob_intervention$area)
agent_list_areas[which(agent_list_areas!="loading" & agent_list_areas!="cleaning" & agent_list_areas!="sorting" & agent_list_areas!="reject" & agent_list_areas!="bag-packing" & agent_list_areas!="tray-packing")] <- "other"

aux_data <- as.data.frame(agents_list_partial_prob_intervention$min_duration_10min)
aux_data$type <- as.factor("Minimum Duration (All)")
aux_data$area <- agent_list_areas
aux_data <- aux_data[order(aux_data$area),]
aux_data <- aux_data[,!(names(aux_data) %in% "area")]
rownames(aux_data) <- NULL
aux_data$id <- seq(1:225)
colnames(aux_data) <- c("value", "type", "id")

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$mean_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$q1_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$median_duration_10min)
aux_data_2$type <- as.factor("Median Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$q3_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$max_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (All)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$contamination_events_10min)
aux_data_2$type <- as.factor("Times Contaminated")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$times_persistent_10min)
aux_data_2$type <- as.factor("Times Persistent")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$min_persistent_duration_10min)
aux_data_2$type <- as.factor("Minimum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$mean_persistent_duration_10min)
aux_data_2$type <- as.factor("Mean Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$q1_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q1 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$median_persistent_duration_10min)
aux_data_2$type <- as.factor("Median Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$q3_persistent_duration_10min)
aux_data_2$type <- as.factor("C. Duration Q3 (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$max_persistent_duration_10min)
aux_data_2$type <- as.factor("Maximum Duration (Per)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$mean_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Overall)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data_2 <- as.data.frame(agents_list_partial_prob_intervention$balanced_times_persistent_10min)
aux_data_2$type <- as.factor("Mean Times Persistent (Per It.)")
aux_data_2$area <- agent_list_areas
aux_data_2 <- aux_data_2[order(aux_data_2$area),]
aux_data_2 <- aux_data_2[,!(names(aux_data_2) %in% "area")]
rownames(aux_data_2) <- NULL
aux_data_2$id <- seq(1:225)
colnames(aux_data_2) <- c("value", "type", "id")

aux_data <- rbind(aux_data, aux_data_2)

aux_data$scenario <- as.factor("AI_03")

aux_data_partial_prob_intervention_10min <- aux_data

aux_data_partial_prob_intervention_10min_durations_all <- aux_data_partial_prob_intervention_10min[which(aux_data_partial_prob_intervention_10min$type=="Minimum Duration (All)" | aux_data_partial_prob_intervention_10min$type=="Mean Duration (All)" | aux_data_partial_prob_intervention_10min$type=="C. Duration Q1 (All)" | aux_data_partial_prob_intervention_10min$type=="Median Duration (All)" | aux_data_partial_prob_intervention_10min$type=="C. Duration Q3 (All)" | aux_data_partial_prob_intervention_10min$type=="Maximum Duration (All)"),]

aux_data_partial_prob_intervention_10min_durations_per <- aux_data_partial_prob_intervention_10min[which(aux_data_partial_prob_intervention_10min$type=="Minimum Duration (Per)" | aux_data_partial_prob_intervention_10min$type=="Mean Duration (Per)" | aux_data_partial_prob_intervention_10min$type=="C. Duration Q1 (Per)" | aux_data_partial_prob_intervention_10min$type=="Median Duration (Per)" | aux_data_partial_prob_intervention_10min$type=="C. Duration Q3 (Per)" | aux_data_partial_prob_intervention_10min$type=="Maximum Duration (Per)"),]

aux_data_partial_prob_intervention_10min_freq_count <- aux_data_partial_prob_intervention_10min[which(aux_data_partial_prob_intervention_10min$type=="Times Contaminated" | aux_data_partial_prob_intervention_10min$type=="Times Persistent"),]

aux_data_partial_prob_intervention_10min_mean_per_freq <- aux_data_partial_prob_intervention_10min[which(aux_data_partial_prob_intervention_10min$type=="Mean Times Persistent (Overall)" | aux_data_partial_prob_intervention_10min$type=="Mean Times Persistent (Per It.)"),]

aux_data_partial_prob_intervention_10min_durations_list <- Facility_B_durations_partial_prob_intervention
aux_data_partial_prob_intervention_10min_durations_list$scenario <- as.factor("AI_03")
aux_data_partial_prob_intervention_10min_durations_list$type <- as.factor("All")

# if (length(transient_durations_list_partial_prob_intervention_10min)==0) {
#   aux_data_partial_prob_intervention_10min_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_partial_prob_intervention_10min_transient_durations_list <- as.data.frame(transient_durations_list_partial_prob_intervention_10min) 
# }
# aux_data_partial_prob_intervention_10min_transient_durations_list$scenario <- as.factor("AI_03")
# aux_data_partial_prob_intervention_10min_transient_durations_list$type <- as.factor("Transient")
# colnames(aux_data_partial_prob_intervention_10min_transient_durations_list) <- c("duration", "scenario","type")

if (length(transient_long_durations_list_partial_prob_intervention_10min$duration)==0) {
  aux_data_partial_prob_intervention_10min_long_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_partial_prob_intervention_10min_long_transient_durations_list <- as.data.frame(transient_long_durations_list_partial_prob_intervention_10min) 
}
aux_data_partial_prob_intervention_10min_long_transient_durations_list$scenario <- as.factor("AI_03")
aux_data_partial_prob_intervention_10min_long_transient_durations_list$type <- as.factor("Transient (Long)")
colnames(aux_data_partial_prob_intervention_10min_long_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_partial_prob_intervention_10min_long_transient_durations_list <- subset(aux_data_partial_prob_intervention_10min_long_transient_durations_list, select=-c(agent,iteration))

if (length(transient_short_durations_list_partial_prob_intervention_10min$duration)==0) {
  aux_data_partial_prob_intervention_10min_short_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_partial_prob_intervention_10min_short_transient_durations_list <- as.data.frame(transient_short_durations_list_partial_prob_intervention_10min) 
}
aux_data_partial_prob_intervention_10min_short_transient_durations_list$scenario <- as.factor("AI_03")
aux_data_partial_prob_intervention_10min_short_transient_durations_list$type <- as.factor("Transient (Short)")
colnames(aux_data_partial_prob_intervention_10min_short_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_partial_prob_intervention_10min_short_transient_durations_list <- subset(aux_data_partial_prob_intervention_10min_short_transient_durations_list, select=-c(agent,iteration))

if (length(transient_uncleanable_durations_list_partial_prob_intervention_10min$duration)==0) {
  aux_data_partial_prob_intervention_10min_uncleanable_transient_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_partial_prob_intervention_10min_uncleanable_transient_durations_list <- as.data.frame(transient_uncleanable_durations_list_partial_prob_intervention_10min) 
}
aux_data_partial_prob_intervention_10min_uncleanable_transient_durations_list$scenario <- as.factor("AI_03")
aux_data_partial_prob_intervention_10min_uncleanable_transient_durations_list$type <- as.factor("Transient (Uncleanable)")
colnames(aux_data_partial_prob_intervention_10min_uncleanable_transient_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_partial_prob_intervention_10min_uncleanable_transient_durations_list <- subset(aux_data_partial_prob_intervention_10min_uncleanable_transient_durations_list, select=-c(agent,iteration))

# if (length(persistent_durations_list_partial_prob_intervention_10min)==0) {
#   aux_data_partial_prob_intervention_10min_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_partial_prob_intervention_10min_persistent_durations_list <- as.data.frame(persistent_durations_list_partial_prob_intervention_10min) 
# }
# aux_data_partial_prob_intervention_10min_persistent_durations_list$scenario <- as.factor("AI_03")
# aux_data_partial_prob_intervention_10min_persistent_durations_list$type <- as.factor("Persistent")
# colnames(aux_data_partial_prob_intervention_10min_persistent_durations_list) <- c("duration", "scenario","type")
# 
# if (length(excess_durations_list_partial_prob_intervention_10min)==0) {
#   aux_data_partial_prob_intervention_10min_excess_durations_list <- as.data.frame(t(c(NA,NA,NA)))
# } else {
#   aux_data_partial_prob_intervention_10min_excess_durations_list <- as.data.frame(excess_durations_list_partial_prob_intervention_10min)
# }
# aux_data_partial_prob_intervention_10min_excess_durations_list$scenario <- as.factor("AI_03")
# aux_data_partial_prob_intervention_10min_excess_durations_list$type <- as.factor("Remainder")
# colnames(aux_data_partial_prob_intervention_10min_excess_durations_list) <- c("duration", "scenario","type")

if (length(persistent_long_durations_list_partial_prob_intervention_10min$duration)==0) {
  aux_data_partial_prob_intervention_10min_long_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_partial_prob_intervention_10min_long_persistent_durations_list <- as.data.frame(persistent_long_durations_list_partial_prob_intervention_10min) 
}
aux_data_partial_prob_intervention_10min_long_persistent_durations_list$scenario <- as.factor("AI_03")
aux_data_partial_prob_intervention_10min_long_persistent_durations_list$type <- as.factor("Persistent (Long)")
colnames(aux_data_partial_prob_intervention_10min_long_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_partial_prob_intervention_10min_long_persistent_durations_list <- subset(aux_data_partial_prob_intervention_10min_long_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_short_durations_list_partial_prob_intervention_10min$duration)==0) {
  aux_data_partial_prob_intervention_10min_short_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_partial_prob_intervention_10min_short_persistent_durations_list <- as.data.frame(persistent_short_durations_list_partial_prob_intervention_10min) 
}
aux_data_partial_prob_intervention_10min_short_persistent_durations_list$scenario <- as.factor("AI_03")
aux_data_partial_prob_intervention_10min_short_persistent_durations_list$type <- as.factor("Persistent (Short)")
colnames(aux_data_partial_prob_intervention_10min_short_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_partial_prob_intervention_10min_short_persistent_durations_list <- subset(aux_data_partial_prob_intervention_10min_short_persistent_durations_list, select=-c(agent,iteration))

if (length(persistent_uncleanable_durations_list_partial_prob_intervention_10min$duration)==0) {
  aux_data_partial_prob_intervention_10min_uncleanable_persistent_durations_list <- as.data.frame(t(c(NA,NA,NA)))
} else {
  aux_data_partial_prob_intervention_10min_uncleanable_persistent_durations_list <- as.data.frame(persistent_uncleanable_durations_list_partial_prob_intervention_10min) 
}
aux_data_partial_prob_intervention_10min_uncleanable_persistent_durations_list$scenario <- as.factor("AI_03")
aux_data_partial_prob_intervention_10min_uncleanable_persistent_durations_list$type <- as.factor("Persistent (Uncleanable)")
colnames(aux_data_partial_prob_intervention_10min_uncleanable_persistent_durations_list) <- c("duration", "agent", "iteration", "scenario","type")
aux_data_partial_prob_intervention_10min_uncleanable_persistent_durations_list <- subset(aux_data_partial_prob_intervention_10min_uncleanable_persistent_durations_list, select=-c(agent,iteration))

#Combine Aux Data####
aux_data_corrective_actions_short_transient_durations_list <- rbind(
  aux_data_baseline_short_transient_durations_list,
  aux_data_crate_prev_0pc_short_transient_durations_list,
  aux_data_prob_intervention_short_transient_durations_list,
  aux_data_partial_prob_intervention_short_transient_durations_list
)

aux_data_corrective_actions_long_transient_durations_list <- rbind(
  aux_data_baseline_long_transient_durations_list,
  aux_data_crate_prev_0pc_long_transient_durations_list,
  aux_data_prob_intervention_long_transient_durations_list,
  aux_data_partial_prob_intervention_long_transient_durations_list
)

aux_data_corrective_actions_uncleanable_transient_durations_list <- rbind(
  aux_data_baseline_uncleanable_transient_durations_list,
  aux_data_crate_prev_0pc_uncleanable_transient_durations_list,
  aux_data_prob_intervention_uncleanable_transient_durations_list,
  aux_data_partial_prob_intervention_uncleanable_transient_durations_list
)

aux_data_corrective_actions_short_persistent_durations_list <- rbind(
  aux_data_baseline_short_persistent_durations_list,
  aux_data_crate_prev_0pc_short_persistent_durations_list,
  aux_data_prob_intervention_short_persistent_durations_list,
  aux_data_partial_prob_intervention_short_persistent_durations_list
)

aux_data_corrective_actions_long_persistent_durations_list <- rbind(
  aux_data_baseline_long_persistent_durations_list,
  aux_data_crate_prev_0pc_long_persistent_durations_list,
  aux_data_prob_intervention_long_persistent_durations_list,
  aux_data_partial_prob_intervention_long_persistent_durations_list
)

aux_data_corrective_actions_uncleanable_persistent_durations_list <- rbind(
  aux_data_baseline_uncleanable_persistent_durations_list,
  aux_data_crate_prev_0pc_uncleanable_persistent_durations_list,
  aux_data_prob_intervention_uncleanable_persistent_durations_list,
  aux_data_partial_prob_intervention_uncleanable_persistent_durations_list
)

aux_data_corrective_actions_durations_list <- rbind(
  aux_data_corrective_actions_short_transient_durations_list,
  aux_data_corrective_actions_long_transient_durations_list,
  aux_data_corrective_actions_uncleanable_transient_durations_list,
  aux_data_corrective_actions_short_persistent_durations_list,
  aux_data_corrective_actions_long_persistent_durations_list,
  aux_data_corrective_actions_uncleanable_persistent_durations_list
)

aux_data_investigation_short_transient_durations_list <- rbind(
  aux_data_baseline_short_transient_durations_list,
  aux_data_no_niches_short_transient_durations_list,
  aux_data_index_1_short_transient_durations_list,
  aux_data_index_2_short_transient_durations_list,
  aux_data_index_3_short_transient_durations_list,
  aux_data_index_4_short_transient_durations_list,
  aux_data_index_5_short_transient_durations_list,
  aux_data_index_6_short_transient_durations_list
)

aux_data_investigation_long_transient_durations_list <- rbind(
  aux_data_baseline_long_transient_durations_list,
  aux_data_no_niches_long_transient_durations_list,
  aux_data_index_1_long_transient_durations_list,
  aux_data_index_2_long_transient_durations_list,
  aux_data_index_3_long_transient_durations_list,
  aux_data_index_4_long_transient_durations_list,
  aux_data_index_5_long_transient_durations_list,
  aux_data_index_6_long_transient_durations_list
)

aux_data_investigation_uncleanable_transient_durations_list <- rbind(
  aux_data_baseline_uncleanable_transient_durations_list,
  aux_data_no_niches_uncleanable_transient_durations_list,
  aux_data_index_1_uncleanable_transient_durations_list,
  aux_data_index_2_uncleanable_transient_durations_list,
  aux_data_index_3_uncleanable_transient_durations_list,
  aux_data_index_4_uncleanable_transient_durations_list,
  aux_data_index_5_uncleanable_transient_durations_list,
  aux_data_index_6_uncleanable_transient_durations_list
)

aux_data_investigation_short_persistent_durations_list <- rbind(
  aux_data_baseline_short_persistent_durations_list,
  aux_data_no_niches_short_persistent_durations_list,
  aux_data_index_1_short_persistent_durations_list,
  aux_data_index_2_short_persistent_durations_list,
  aux_data_index_3_short_persistent_durations_list,
  aux_data_index_4_short_persistent_durations_list,
  aux_data_index_5_short_persistent_durations_list,
  aux_data_index_6_short_persistent_durations_list
)

aux_data_investigation_long_persistent_durations_list <- rbind(
  aux_data_baseline_long_persistent_durations_list,
  aux_data_no_niches_long_persistent_durations_list,
  aux_data_index_1_long_persistent_durations_list,
  aux_data_index_2_long_persistent_durations_list,
  aux_data_index_3_long_persistent_durations_list,
  aux_data_index_4_long_persistent_durations_list,
  aux_data_index_5_long_persistent_durations_list,
  aux_data_index_6_long_persistent_durations_list
)

aux_data_investigation_uncleanable_persistent_durations_list <- rbind(
  aux_data_baseline_uncleanable_persistent_durations_list,
  aux_data_no_niches_uncleanable_persistent_durations_list,
  aux_data_index_1_uncleanable_persistent_durations_list,
  aux_data_index_2_uncleanable_persistent_durations_list,
  aux_data_index_3_uncleanable_persistent_durations_list,
  aux_data_index_4_uncleanable_persistent_durations_list,
  aux_data_index_5_uncleanable_persistent_durations_list,
  aux_data_index_6_uncleanable_persistent_durations_list
)

aux_data_investigation_durations_list <- rbind(
  aux_data_investigation_short_transient_durations_list,
  aux_data_investigation_long_transient_durations_list,
  aux_data_investigation_uncleanable_transient_durations_list,
  aux_data_investigation_short_persistent_durations_list,
  aux_data_investigation_long_persistent_durations_list,
  aux_data_investigation_uncleanable_persistent_durations_list
)

levels(aux_data_corrective_actions_durations_list$scenario) <- c("Baseline","Corrective Action 4", "Corrective Action 5", "Corrective Action 6")
levels(aux_data_investigation_durations_list$scenario) <- c("Baseline","No Niches", "Index Case B1", "Index Case B2", "Index Case B3", "Index Case B4", "Index Case B5", "Index Case B6")

aux_dataset_corrective_actions <- rbind(
  aux_data_baseline_mean_per_freq,
  aux_data_crate_prev_0pc_mean_per_freq,
  aux_data_prob_intervention_mean_per_freq,
  aux_data_partial_prob_intervention_mean_per_freq
)
aux_dataset_corrective_actions <- aux_dataset_corrective_actions[which(aux_dataset_corrective_actions$type == "Mean Times Persistent (Per It.)"),]

aux_dataset_investigation <- rbind(
  aux_data_baseline_mean_per_freq,
  aux_data_no_niches_mean_per_freq,
  aux_data_index_1_mean_per_freq,
  aux_data_index_2_mean_per_freq,
  aux_data_index_3_mean_per_freq,
  aux_data_index_4_mean_per_freq,
  aux_data_index_5_mean_per_freq,
  aux_data_index_6_mean_per_freq
)
aux_dataset_investigation <- aux_dataset_investigation[which(aux_dataset_investigation$type == "Mean Times Persistent (Per It.)"),]
```
        
```{r Figure 5 and Figure 7}
aux_dataset_corrective_actions <- rbind(
  aux_data_baseline_mean_per_freq,
  aux_data_crate_prev_0pc_mean_per_freq,
  aux_data_prob_intervention_mean_per_freq,
  aux_data_partial_prob_intervention_mean_per_freq
)
aux_dataset_corrective_actions <- aux_dataset_corrective_actions[which(aux_dataset_corrective_actions$type == "Mean Times Persistent (Per It.)"),]

aux_dataset_investigation <- rbind(
  aux_data_baseline_mean_per_freq,
  aux_data_no_niches_mean_per_freq,
  aux_data_index_1_mean_per_freq,
  aux_data_index_2_mean_per_freq,
  aux_data_index_3_mean_per_freq,
  aux_data_index_4_mean_per_freq,
  aux_data_index_5_mean_per_freq,
  aux_data_index_6_mean_per_freq
)
aux_dataset_investigation <- aux_dataset_investigation[which(aux_dataset_investigation$type == "Mean Times Persistent (Per It.)"),]

# mine_heatmap_corretive_actions <- ggplot() +
#   geom_tile(
#     data = aux_dataset_corrective_actions,
#     mapping = aes(
#       x = scenario,
#       y = id,
#       fill = value
#     )
#   ) +
#   scale_fill_gradient(name = "Mean Contamination Frequency", low = "white", high = "black") +
#   geom_hline(yintercept = c(0, 28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.4) +
#   scale_x_discrete(labels = c("Baseline","Corrective Action 4", "Corrective Action 5", "Corrective Action 6")) +
#   scale_y_continuous(breaks = c(0, 28, 49, 59, 82, 102, 225)+0.5, labels = c("", "cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
#   xlab(label = "Scenario") +
#   ylab(label = "Agent Functional Group") +
#   ggtitle("B") +
#   theme_minimal() +
#   theme(
#     legend.position = "bottom",
#     axis.text.x = element_text(color = "grey20", size = 12, angle = 45, hjust = 1, vjust = 1, face = "plain"),
#     axis.text.y = element_text(angle = 45, size = 12),
#     axis.title.x = element_text(color = "grey20", size = 15, face = "plain"),
#     axis.title.y = element_text(color = "grey20", size = 15, face = "plain"),
#     # panel.grid.major = element_blank(),
#     panel.grid.minor = element_blank(),
#     legend.text=element_text(size=16, angle = 45, hjust = .5, vjust = .5)
#   )
# 
# mine_heatmap_investigation <- ggplot() +
#   geom_tile(
#     data = aux_dataset_investigation,
#     mapping = aes(
#       x = scenario,
#       y = id,
#       fill = value
#     )
#   ) +
#   scale_fill_gradient(name = "Mean Contamination Frequency", low = "white", high = "black") +
#   geom_hline(yintercept = c(0, 28, 49, 59, 82, 102, 225)+0.5, linetype="dashed", size = 0.4) +
#   scale_x_discrete(labels = c("Baseline","No Niches", "Index Case B1", "Index Case B2", "Index Case B3", "Index Case B4", "Index Case B5", "Index Case B6")) +
#   scale_y_continuous(breaks = c(0, 28, 49, 59, 82, 102, 225)+0.5, labels = c("", "cleaning", "loading", "other", "reject", "sorting", "tray-packing")) +
#   xlab(label = "Scenario") +
#   ylab(label = "Agent Functional Group") +
#   ggtitle("B") +
#   theme_minimal() +
#   theme(
#     legend.position = "bottom",
#     axis.text.x = element_text(color = "grey20", size = 12, angle = 45, hjust = 1, vjust = 1, face = "plain"),
#     axis.text.y = element_text(angle = 45, size = 12),
#     axis.title.x = element_text(color = "grey20", size = 15, face = "plain"),
#     axis.title.y = element_text(color = "grey20", size = 15, face = "plain"),
#     # panel.grid.major = element_blank(),
#     panel.grid.minor = element_blank(),
#     legend.text=element_text(size=16, angle = 45, hjust = .5, vjust = .5)
#   )
# ggsave("Mean_Contamination_Corrective_Actions_Facility_B.tiff", plot = mine_heatmap_corretive_actions, device = "tiff", width = 15, height = 27, units = "cm", dpi = 600, compression = "lzw")
# ggsave("Mean_Contamination_Investigation_Facility_B.tiff", plot = mine_heatmap_investigation, device = "tiff", width = 15, height = 27, units = "cm", dpi = 600, compression = "lzw")
```

```{r Figure 4 and Figure 6}
aux_data_corrective_actions_short_transient_durations_list <- rbind(
  aux_data_baseline_short_transient_durations_list,
  aux_data_crate_prev_0pc_short_transient_durations_list,
  aux_data_prob_intervention_short_transient_durations_list,
  aux_data_partial_prob_intervention_short_transient_durations_list
)

aux_data_corrective_actions_long_transient_durations_list <- rbind(
  aux_data_baseline_long_transient_durations_list,
  aux_data_crate_prev_0pc_long_transient_durations_list,
  aux_data_prob_intervention_long_transient_durations_list,
  aux_data_partial_prob_intervention_long_transient_durations_list
)

aux_data_corrective_actions_uncleanable_transient_durations_list <- rbind(
  aux_data_baseline_uncleanable_transient_durations_list,
  aux_data_crate_prev_0pc_uncleanable_transient_durations_list,
  aux_data_prob_intervention_uncleanable_transient_durations_list,
  aux_data_partial_prob_intervention_uncleanable_transient_durations_list
)

aux_data_corrective_actions_short_persistent_durations_list <- rbind(
  aux_data_baseline_short_persistent_durations_list,
  aux_data_crate_prev_0pc_short_persistent_durations_list,
  aux_data_prob_intervention_short_persistent_durations_list,
  aux_data_partial_prob_intervention_short_persistent_durations_list
)

aux_data_corrective_actions_long_persistent_durations_list <- rbind(
  aux_data_baseline_long_persistent_durations_list,
  aux_data_crate_prev_0pc_long_persistent_durations_list,
  aux_data_prob_intervention_long_persistent_durations_list,
  aux_data_partial_prob_intervention_long_persistent_durations_list
)

aux_data_corrective_actions_uncleanable_persistent_durations_list <- rbind(
  aux_data_baseline_uncleanable_persistent_durations_list,
  aux_data_crate_prev_0pc_uncleanable_persistent_durations_list,
  aux_data_prob_intervention_uncleanable_persistent_durations_list,
  aux_data_partial_prob_intervention_uncleanable_persistent_durations_list
)

aux_data_corrective_actions_durations_list <- rbind(
  aux_data_corrective_actions_short_transient_durations_list,
  aux_data_corrective_actions_long_transient_durations_list,
  aux_data_corrective_actions_uncleanable_transient_durations_list,
  aux_data_corrective_actions_short_persistent_durations_list,
  aux_data_corrective_actions_long_persistent_durations_list,
  aux_data_corrective_actions_uncleanable_persistent_durations_list
)

aux_data_investigation_short_transient_durations_list <- rbind(
  aux_data_baseline_short_transient_durations_list,
  aux_data_no_niches_short_transient_durations_list,
  aux_data_index_1_short_transient_durations_list,
  aux_data_index_2_short_transient_durations_list,
  aux_data_index_3_short_transient_durations_list,
  aux_data_index_4_short_transient_durations_list,
  aux_data_index_5_short_transient_durations_list,
  aux_data_index_6_short_transient_durations_list
)

aux_data_investigation_long_transient_durations_list <- rbind(
  aux_data_baseline_long_transient_durations_list,
  aux_data_no_niches_long_transient_durations_list,
  aux_data_index_1_long_transient_durations_list,
  aux_data_index_2_long_transient_durations_list,
  aux_data_index_3_long_transient_durations_list,
  aux_data_index_4_long_transient_durations_list,
  aux_data_index_5_long_transient_durations_list,
  aux_data_index_6_long_transient_durations_list
)

aux_data_investigation_uncleanable_transient_durations_list <- rbind(
  aux_data_baseline_uncleanable_transient_durations_list,
  aux_data_no_niches_uncleanable_transient_durations_list,
  aux_data_index_1_uncleanable_transient_durations_list,
  aux_data_index_2_uncleanable_transient_durations_list,
  aux_data_index_3_uncleanable_transient_durations_list,
  aux_data_index_4_uncleanable_transient_durations_list,
  aux_data_index_5_uncleanable_transient_durations_list,
  aux_data_index_6_uncleanable_transient_durations_list
)

aux_data_investigation_short_persistent_durations_list <- rbind(
  aux_data_baseline_short_persistent_durations_list,
  aux_data_no_niches_short_persistent_durations_list,
  aux_data_index_1_short_persistent_durations_list,
  aux_data_index_2_short_persistent_durations_list,
  aux_data_index_3_short_persistent_durations_list,
  aux_data_index_4_short_persistent_durations_list,
  aux_data_index_5_short_persistent_durations_list,
  aux_data_index_6_short_persistent_durations_list
)

aux_data_investigation_long_persistent_durations_list <- rbind(
  aux_data_baseline_long_persistent_durations_list,
  aux_data_no_niches_long_persistent_durations_list,
  aux_data_index_1_long_persistent_durations_list,
  aux_data_index_2_long_persistent_durations_list,
  aux_data_index_3_long_persistent_durations_list,
  aux_data_index_4_long_persistent_durations_list,
  aux_data_index_5_long_persistent_durations_list,
  aux_data_index_6_long_persistent_durations_list
)

aux_data_investigation_uncleanable_persistent_durations_list <- rbind(
  aux_data_baseline_uncleanable_persistent_durations_list,
  aux_data_no_niches_uncleanable_persistent_durations_list,
  aux_data_index_1_uncleanable_persistent_durations_list,
  aux_data_index_2_uncleanable_persistent_durations_list,
  aux_data_index_3_uncleanable_persistent_durations_list,
  aux_data_index_4_uncleanable_persistent_durations_list,
  aux_data_index_5_uncleanable_persistent_durations_list,
  aux_data_index_6_uncleanable_persistent_durations_list
)

aux_data_investigation_durations_list <- rbind(
  aux_data_investigation_short_transient_durations_list,
  aux_data_investigation_long_transient_durations_list,
  aux_data_investigation_uncleanable_transient_durations_list,
  aux_data_investigation_short_persistent_durations_list,
  aux_data_investigation_long_persistent_durations_list,
  aux_data_investigation_uncleanable_persistent_durations_list
)

levels(aux_data_corrective_actions_durations_list$scenario) <- c("Baseline","Corrective Action 4", "Corrective Action 5", "Corrective Action 6")
levels(aux_data_investigation_durations_list$scenario) <- c("Baseline","No Niches", "Index Case B1", "Index Case B2", "Index Case B3", "Index Case B4", "Index Case B5", "Index Case B6")

# boxplot_corrective_actions <- ggplot() +
#   geom_boxplot_pattern(
#     data = aux_data_corrective_actions_durations_list,
#     mapping = aes(
#             x = type,
#             y = duration,
#             pattern = scenario,
#             pattern_angle = scenario),
#     fill = "white",
#         colour = "black",
#         pattern_spacing = 0.01,
#         pattern_fill = "black",
#         pattern_colour = "black"
#   ) +
#   scale_x_discrete(labels = c("Transient (D)","Transient (W)", "Transient (U)", "Persistent (D)","Persistent (W)", "Persistent (U)"), drop = FALSE) +
#   scale_y_continuous(breaks = c(0,seq(167, 1343, by = 168)),labels = c("0","1","2","3","4","5","6","7","8")) +
#   xlab("Contamination Event Type") +
#   ylab("Duration (Weeks)") +
#   ggtitle("B") +
#   theme_bw() +
#   theme(
#     legend.position = c(0.25,0.5),
#     plot.title = element_text(size=20),
#     axis.text.x = element_text(size=12),
#     axis.text.y = element_text(size=15),
#     axis.title.x = element_text(size=20),
#     axis.title.y = element_text(size=20)
#   )
# 
# boxplot_investigation <- ggplot() +
#   geom_boxplot_pattern(
#         data = aux_data_investigation_durations_list,
#         mapping = aes(
#             x = type,
#             y = duration,
#             pattern = scenario,
#             pattern_angle = scenario),
#         fill = "white",
#         colour = "black",
#         pattern_spacing = 0.01,
#         pattern_fill = "black",
#         pattern_colour = "black"
#         ) +
#   scale_x_discrete(labels = c("Transient (D)","Transient (W)", "Transient (U)", "Persistent (D)","Persistent (W)", "Persistent (U)"), drop = FALSE) +
#   scale_y_continuous(breaks = c(0,seq(167, 1343, by = 168)),labels = c("0","1","2","3","4","5","6","7","8")) +
#   xlab("Contamination Event Type") +
#   ylab("Duration (Weeks)") +
#   ggtitle("B") +
#   theme_bw() +
#   theme(
#     legend.position = c(0.25,0.65),
#     plot.title = element_text(size=20),
#     axis.text.x = element_text(size=12),
#     axis.text.y = element_text(size=15),
#     axis.title.x = element_text(size=20),
#     axis.title.y = element_text(size=20)
#   )
# ggsave("Contamination_Durations_Corrective_Actions_Facility_B.tiff", plot = boxplot_corrective_actions, device = "tiff", width = 20, height = 12, units = "cm", dpi = 600, compression = "lzw")
# ggsave("Contamination_Durations_Investigation_Facility_B.tiff", plot = boxplot_investigation, device = "tiff", width = 20, height = 12, units = "cm", dpi = 600, compression = "lzw")

# ggplot() +
#   geom_boxplot(
#     data = aux_data_corrective_actions_durations_list,
#     mapping = aes(
#       x = type,
#       y = duration,
#       fill = scenario
#     )
#     # position = position_dodge(preserve = 'single')
#   ) +
#   scale_x_discrete(labels = c("Transient (D)","Transient (W)", "Transient (U)", "Persistent (D)","Persistent (W)", "Persistent (U)"), drop = FALSE) +
#   scale_y_continuous(breaks = c(0,seq(167, 1343, by = 168)),labels = c("0","1","2","3","4","5","6","7","8")) +
#   scale_fill_manual(name = "Scenario", labels = c("Baseline","Corrective Action 4", "Corrective Action 5", "Corrective Action 6"), values = c("black","grey100","grey90","grey80"), drop = FALSE) +
#   xlab("Contamination Event Type") +
#   ylab("Duration (Weeks)") +
#   ggtitle("B") +
#   theme_bw() +
#   theme(
#     legend.position = c(0.25,0.5),
#     plot.title = element_text(size=20),
#     axis.text.x = element_text(size=12),
#     axis.text.y = element_text(size=15),
#     axis.title.x = element_text(size=20),
#     axis.title.y = element_text(size=20)
#   )
# 
# ggplot() +
#   geom_boxplot(
#     data = aux_data_corrective_actions_durations_list,
#     mapping = aes(
#       x = type,
#       y = duration,
#       fill = scenario
#     )
#     # position = position_dodge(preserve = 'single')
#   ) +
#   scale_x_discrete(labels = c("Transient (D)","Transient (W)", "Transient (U)", "Persistent (D)","Persistent (W)", "Persistent (U)"), drop = FALSE) +
#   scale_y_continuous(breaks = c(0,seq(167, 1343, by = 168)),labels = c("0","1","2","3","4","5","6","7","8")) +
#   xlab("Contamination Event Type") +
#   ylab("Duration (Weeks)") +
#   ggtitle("B") +
#   theme_bw() +
#   theme(
#     legend.position = c(0.25,0.5),
#     plot.title = element_text(size=20),
#     axis.text.x = element_text(size=12),
#     axis.text.y = element_text(size=15),
#     axis.title.x = element_text(size=20),
#     axis.title.y = element_text(size=20)
#   )
# 
# 
# ggplot() +
#   geom_boxplot(
#     data = aux_data_investigation_durations_list,
#     mapping = aes(
#       x = type,
#       y = duration,
#       fill = scenario
#     )
#     # position = position_dodge(preserve = 'single')
#   ) +
#   scale_x_discrete(labels = c("Transient (D)","Transient (W)", "Transient (U)", "Persistent (D)","Persistent (W)", "Persistent (U)"), drop = FALSE) +
#   scale_y_continuous(breaks = c(0,seq(167, 1343, by = 168)),labels = c("0","1","2","3","4","5","6","7","8")) +
#   scale_fill_manual(name = "Scenario", labels = c("Baseline","No Niches", "Index Case B1", "Index Case B2", "Index Case B3", "Index Case B4", "Index Case B5", "Index Case B6"), values = c("black","grey100","grey90","grey80","grey70","grey60","grey50","grey40","grey30"), drop = FALSE) +
#   xlab("Contamination Event Type") +
#   ylab("Duration (Weeks)") +
#   ggtitle("B") +
#   theme_bw() +
#   theme(
#     legend.position = c(0.25,0.65),
#     plot.title = element_text(size=20),
#     axis.text.x = element_text(size=12),
#     axis.text.y = element_text(size=15),
#     axis.title.x = element_text(size=20),
#     axis.title.y = element_text(size=20)
#   )
# 
# ggplot() +
#   geom_boxplot(
#     data = aux_data_investigation_durations_list,
#     mapping = aes(
#       x = type,
#       y = duration,
#       fill = scenario
#     )
#     # position = position_dodge(preserve = 'single')
#   ) +
#   scale_x_discrete(labels = c("Transient (D)","Transient (W)", "Transient (U)", "Persistent (D)","Persistent (W)", "Persistent (U)"), drop = FALSE) +
#   scale_y_continuous(breaks = c(0,seq(167, 1343, by = 168)),labels = c("0","1","2","3","4","5","6","7","8")) +
#   # scale_fill_manual(name = "Scenario", labels = c("Baseline","No Niches", "Index Case B1", "Index Case B2", "Index Case B3", "Index Case B4", "Index Case B5", "Index Case B6"), drop = FALSE) +
#   xlab("Contamination Event Type") +
#   ylab("Duration (Weeks)") +
#   ggtitle("B") +
#   theme_bw() +
#   theme(
#     legend.position = c(0.25,0.65),
#     plot.title = element_text(size=20),
#     axis.text.x = element_text(size=12),
#     axis.text.y = element_text(size=15),
#     axis.title.x = element_text(size=20),
#     axis.title.y = element_text(size=20)
#   )
```

```{r Export Figure Data}
#Run import and Aux chunks first!
#Primary Figures
write.csv(baseline_allwed_prev,paste0(getwd(),'/Facility_B_Baseline_Prev.csv'), row.names = FALSE)
write.csv(baseline_allwed_concs,paste0(getwd(),'/Facility_B_Baseline_Concs.csv'), row.names = FALSE)
write.csv(rbind(baseline_w1wed_prev,baseline_w8wed_prev),paste0(getwd(),'/Facility_B_Baseline_1and8_Prev.csv'), row.names = FALSE)
write.csv(rbind(baseline_w1wed_concs,baseline_w8wed_concs),paste0(getwd(),'/Facility_B_Baseline_1and8_Prev.csv'), row.names = FALSE)
write.csv(aux_data_investigation_durations_list,paste0(getwd(),'/Facility_B_Durations_Investigation.csv'), row.names = FALSE)
write.csv(aux_dataset_investigation,paste0(getwd(),'/Facility_B_Frequency_Investigation.csv'), row.names = FALSE)
write.csv(aux_data_corrective_actions_durations_list,paste0(getwd(),'/Facility_B_Durations_Corrective_Actions.csv'), row.names = FALSE)
write.csv(aux_dataset_corrective_actions,paste0(getwd(),'/Facility_B_Frequency_Corrective_Actions.csv'), row.names = FALSE)
write.csv(data_matrix_melted,paste0(getwd(),'/Facility_B_wk8_Sensitivity_Matrix.csv'), row.names = TRUE)
#Supplemental Figure Data
write.csv(crate_prev_75pc_allwed_prev,paste0(getwd(),'/Facility_B_EC_01_Prev.csv'), row.names = FALSE)
write.csv(crate_prev_50pc_allwed_prev,paste0(getwd(),'/Facility_B_EC_02_Prev.csv'), row.names = FALSE)
write.csv(crate_prev_25pc_allwed_prev,paste0(getwd(),'/Facility_B_EC_03_Prev.csv'), row.names = FALSE)
write.csv(crate_prev_0pc_allwed_prev,paste0(getwd(),'/Facility_B_EC_04_Prev.csv'), row.names = FALSE)
write.csv(prob_intervention_allwed_prev,paste0(getwd(),'/Facility_B_AI_02_Prev.csv'), row.names = FALSE)
write.csv(partial_prob_intervention_allwed_prev,paste0(getwd(),'/Facility_B_AI_03_Prev.csv'), row.names = FALSE)
write.csv(connections_intervention_allwed_prev,paste0(getwd(),'/Facility_B_AI_04_Prev.csv'), row.names = FALSE)
write.csv(aux_data_supplemental_durations_list,paste0(getwd(),'/Facility_B_Durations_Supplemental.csv'), row.names = FALSE)
```

```{r Supplemental Figures}
figure <- ggarrange(ggplot(crate_prev_75pc_allwed_prev, aes(x=week, y=prevalence, fill=water)) + 
                      geom_boxplot() +
                      xlab('') +
                      ylab('Prevalence %') +
                      ylim(0,100) +
                      # ggtitle("B") +
                      scale_fill_manual(values=c("black","white")) +
                      theme(legend.position = "none") +
                      theme(axis.text.x = element_text(size = 11, angle = 0, hjust = .5, vjust = .5, face = "plain"),
                            axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
                            axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")))
annotate_figure(
  figure,
  fig.lab = "B",
  fig.lab.face = "bold",
  top = text_grob("", size = 20),
  bottom = text_grob("Week", size = 20, y = 1)
)

figure <- ggarrange(ggplot(crate_prev_50pc_allwed_prev, aes(x=week, y=prevalence, fill=water)) + 
                      geom_boxplot() +
                      xlab('') +
                      ylab('Prevalence %') +
                      ylim(0,100) +
                      # ggtitle("B") +
                      scale_fill_manual(values=c("black","white")) +
                      theme(legend.position = "none") +
                      theme(axis.text.x = element_text(size = 11, angle = 0, hjust = .5, vjust = .5, face = "plain"),
                            axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
                            axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")))
annotate_figure(
  figure,
  fig.lab = "B",
  fig.lab.face = "bold",
  top = text_grob("", size = 20),
  bottom = text_grob("Week", size = 20, y = 1)
)

figure <- ggarrange(ggplot(crate_prev_25pc_allwed_prev, aes(x=week, y=prevalence, fill=water)) + 
                      geom_boxplot() +
                      xlab('') +
                      ylab('Prevalence %') +
                      ylim(0,100) +
                      # ggtitle("B") +
                      scale_fill_manual(values=c("black","white")) +
                      theme(legend.position = "none") +
                      theme(axis.text.x = element_text(size = 11, angle = 0, hjust = .5, vjust = .5, face = "plain"),
                            axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
                            axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")))
annotate_figure(
  figure,
  fig.lab = "B",
  fig.lab.face = "bold",
  top = text_grob("", size = 20),
  bottom = text_grob("Week", size = 20, y = 1)
)

figure <- ggarrange(ggplot(crate_prev_0pc_allwed_prev, aes(x=week, y=prevalence, fill=water)) + 
                      geom_boxplot() +
                      xlab('') +
                      ylab('Prevalence %') +
                      ylim(0,100) +
                      # ggtitle("B") +
                      scale_fill_manual(values=c("black","white")) +
                      theme(legend.position = "none") +
                      theme(axis.text.x = element_text(size = 11, angle = 0, hjust = .5, vjust = .5, face = "plain"),
                            axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
                            axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")))
annotate_figure(
  figure,
  fig.lab = "B",
  fig.lab.face = "bold",
  top = text_grob("", size = 20),
  bottom = text_grob("Week", size = 20, y = 1)
)

figure <- ggarrange(ggplot(prob_intervention_allwed_prev, aes(x=week, y=prevalence, fill=water)) + 
                      geom_boxplot() +
                      xlab('') +
                      ylab('Prevalence %') +
                      ylim(0,100) +
                      # ggtitle("B") +
                      scale_fill_manual(values=c("black","white")) +
                      theme(legend.position = "none") +
                      theme(axis.text.x = element_text(size = 11, angle = 0, hjust = .5, vjust = .5, face = "plain"),
                            axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
                            axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")))
annotate_figure(
  figure,
  fig.lab = "B",
  fig.lab.face = "bold",
  top = text_grob("", size = 20),
  bottom = text_grob("Week", size = 20, y = 1)
)

figure <- ggarrange(ggplot(partial_prob_intervention_allwed_prev, aes(x=week, y=prevalence, fill=water)) + 
                      geom_boxplot() +
                      xlab('') +
                      ylab('Prevalence %') +
                      ylim(0,100) +
                      # ggtitle("B") +
                      scale_fill_manual(values=c("black","white")) +
                      theme(legend.position = "none") +
                      theme(axis.text.x = element_text(size = 11, angle = 0, hjust = .5, vjust = .5, face = "plain"),
                            axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
                            axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")))
annotate_figure(
  figure,
  fig.lab = "B",
  fig.lab.face = "bold",
  top = text_grob("", size = 20),
  bottom = text_grob("Week", size = 20, y = 1)
)

figure <- ggarrange(ggplot(connections_intervention_allwed_prev, aes(x=week, y=prevalence, fill=water)) + 
                      geom_boxplot() +
                      xlab('') +
                      ylab('Prevalence %') +
                      ylim(0,100) +
                      # ggtitle("B") +
                      scale_fill_manual(values=c("black","white")) +
                      theme(legend.position = "none") +
                      theme(axis.text.x = element_text(size = 11, angle = 0, hjust = .5, vjust = .5, face = "plain"),
                            axis.title.x = element_text(color = "grey20", size = 20, angle = 0, hjust = .5, vjust = 0, face = "plain"),
                            axis.title.y = element_text(color = "grey20", size = 20, angle = 90, hjust = .5, vjust = .5, face = "plain")))
annotate_figure(
  figure,
  fig.lab = "B",
  fig.lab.face = "bold",
  top = text_grob("", size = 20),
  bottom = text_grob("Week", size = 20, y = 1)
)
```